var YN=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Noe=YN((Zoe,Wf)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var so=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ah(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function V_(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return t[r]}})}),n}var B_={exports:{}},Gg={},W_={exports:{}},Ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uh=Symbol.for("react.element"),GN=Symbol.for("react.portal"),KN=Symbol.for("react.fragment"),XN=Symbol.for("react.strict_mode"),qN=Symbol.for("react.profiler"),QN=Symbol.for("react.provider"),ZN=Symbol.for("react.context"),JN=Symbol.for("react.forward_ref"),eL=Symbol.for("react.suspense"),tL=Symbol.for("react.memo"),nL=Symbol.for("react.lazy"),KE=Symbol.iterator;function rL(t){return t===null||typeof t!="object"?null:(t=KE&&t[KE]||t["@@iterator"],typeof t=="function"?t:null)}var U_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z_=Object.assign,j_={};function Qa(t,e,n){this.props=t,this.context=e,this.refs=j_,this.updater=n||U_}Qa.prototype.isReactComponent={};Qa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Qa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Y_(){}Y_.prototype=Qa.prototype;function nS(t,e,n){this.props=t,this.context=e,this.refs=j_,this.updater=n||U_}var rS=nS.prototype=new Y_;rS.constructor=nS;z_(rS,Qa.prototype);rS.isPureReactComponent=!0;var XE=Array.isArray,G_=Object.prototype.hasOwnProperty,oS={current:null},K_={key:!0,ref:!0,__self:!0,__source:!0};function X_(t,e,n){var r,o={},i=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(i=""+e.key),e)G_.call(e,r)&&!K_.hasOwnProperty(r)&&(o[r]=e[r]);var l=arguments.length-2;if(l===1)o.children=n;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];o.children=a}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)o[r]===void 0&&(o[r]=l[r]);return{$$typeof:uh,type:t,key:i,ref:s,props:o,_owner:oS.current}}function oL(t,e){return{$$typeof:uh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function iS(t){return typeof t=="object"&&t!==null&&t.$$typeof===uh}function iL(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var qE=/\/+/g;function vp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?iL(""+t.key):e.toString(36)}function cf(t,e,n,r,o){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case uh:case GN:s=!0}}if(s)return s=t,o=o(s),t=r===""?"."+vp(s,0):r,XE(o)?(n="",t!=null&&(n=t.replace(qE,"$&/")+"/"),cf(o,e,n,"",function(u){return u})):o!=null&&(iS(o)&&(o=oL(o,n+(!o.key||s&&s.key===o.key?"":(""+o.key).replace(qE,"$&/")+"/")+t)),e.push(o)),1;if(s=0,r=r===""?".":r+":",XE(t))for(var l=0;l<t.length;l++){i=t[l];var a=r+vp(i,l);s+=cf(i,e,n,a,o)}else if(a=rL(t),typeof a=="function")for(t=a.call(t),l=0;!(i=t.next()).done;)i=i.value,a=r+vp(i,l++),s+=cf(i,e,n,a,o);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Bh(t,e,n){if(t==null)return t;var r=[],o=0;return cf(t,r,"","",function(i){return e.call(n,i,o++)}),r}function sL(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Xn={current:null},hf={transition:null},lL={ReactCurrentDispatcher:Xn,ReactCurrentBatchConfig:hf,ReactCurrentOwner:oS};Ze.Children={map:Bh,forEach:function(t,e,n){Bh(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Bh(t,function(){e++}),e},toArray:function(t){return Bh(t,function(e){return e})||[]},only:function(t){if(!iS(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ze.Component=Qa;Ze.Fragment=KN;Ze.Profiler=qN;Ze.PureComponent=nS;Ze.StrictMode=XN;Ze.Suspense=eL;Ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lL;Ze.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=z_({},t.props),o=t.key,i=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,s=oS.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(a in e)G_.call(e,a)&&!K_.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:uh,type:t.type,key:o,ref:i,props:r,_owner:s}};Ze.createContext=function(t){return t={$$typeof:ZN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:QN,_context:t},t.Consumer=t};Ze.createElement=X_;Ze.createFactory=function(t){var e=X_.bind(null,t);return e.type=t,e};Ze.createRef=function(){return{current:null}};Ze.forwardRef=function(t){return{$$typeof:JN,render:t}};Ze.isValidElement=iS;Ze.lazy=function(t){return{$$typeof:nL,_payload:{_status:-1,_result:t},_init:sL}};Ze.memo=function(t,e){return{$$typeof:tL,type:t,compare:e===void 0?null:e}};Ze.startTransition=function(t){var e=hf.transition;hf.transition={};try{t()}finally{hf.transition=e}};Ze.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ze.useCallback=function(t,e){return Xn.current.useCallback(t,e)};Ze.useContext=function(t){return Xn.current.useContext(t)};Ze.useDebugValue=function(){};Ze.useDeferredValue=function(t){return Xn.current.useDeferredValue(t)};Ze.useEffect=function(t,e){return Xn.current.useEffect(t,e)};Ze.useId=function(){return Xn.current.useId()};Ze.useImperativeHandle=function(t,e,n){return Xn.current.useImperativeHandle(t,e,n)};Ze.useInsertionEffect=function(t,e){return Xn.current.useInsertionEffect(t,e)};Ze.useLayoutEffect=function(t,e){return Xn.current.useLayoutEffect(t,e)};Ze.useMemo=function(t,e){return Xn.current.useMemo(t,e)};Ze.useReducer=function(t,e,n){return Xn.current.useReducer(t,e,n)};Ze.useRef=function(t){return Xn.current.useRef(t)};Ze.useState=function(t){return Xn.current.useState(t)};Ze.useSyncExternalStore=function(t,e,n){return Xn.current.useSyncExternalStore(t,e,n)};Ze.useTransition=function(){return Xn.current.useTransition()};Ze.version="18.2.0";W_.exports=Ze;var ch=W_.exports;const tn=ah(ch);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aL=ch,uL=Symbol.for("react.element"),cL=Symbol.for("react.fragment"),hL=Object.prototype.hasOwnProperty,dL=aL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fL={key:!0,ref:!0,__self:!0,__source:!0};function q_(t,e,n){var r,o={},i=null,s=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)hL.call(e,r)&&!fL.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)o[r]===void 0&&(o[r]=e[r]);return{$$typeof:uL,type:t,key:i,ref:s,props:o,_owner:dL.current}}Gg.Fragment=cL;Gg.jsx=q_;Gg.jsxs=q_;B_.exports=Gg;var we=B_.exports,tv={},Q_={exports:{}},Er={},Z_={exports:{}},J_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(b,d){var m=b.length;b.push(d);e:for(;0<m;){var v=m-1>>>1,_=b[v];if(0<o(_,d))b[v]=d,b[m]=_,m=v;else break e}}function n(b){return b.length===0?null:b[0]}function r(b){if(b.length===0)return null;var d=b[0],m=b.pop();if(m!==d){b[0]=m;e:for(var v=0,_=b.length,I=_>>>1;v<I;){var H=2*(v+1)-1,K=b[H],W=H+1,Q=b[W];if(0>o(K,m))W<_&&0>o(Q,K)?(b[v]=Q,b[W]=m,v=W):(b[v]=K,b[H]=m,v=H);else if(W<_&&0>o(Q,m))b[v]=Q,b[W]=m,v=W;else break e}}return d}function o(b,d){var m=b.sortIndex-d.sortIndex;return m!==0?m:b.id-d.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var a=[],u=[],c=1,h=null,f=3,g=!1,p=!1,y=!1,E=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(b){for(var d=n(u);d!==null;){if(d.callback===null)r(u);else if(d.startTime<=b)r(u),d.sortIndex=d.expirationTime,e(a,d);else break;d=n(u)}}function T(b){if(y=!1,S(b),!p)if(n(a)!==null)p=!0,Ne(x);else{var d=n(u);d!==null&&Ae(T,d.startTime-b)}}function x(b,d){p=!1,y&&(y=!1,w(U),U=-1),g=!0;var m=f;try{for(S(d),h=n(a);h!==null&&(!(h.expirationTime>d)||b&&!Z());){var v=h.callback;if(typeof v=="function"){h.callback=null,f=h.priorityLevel;var _=v(h.expirationTime<=d);d=t.unstable_now(),typeof _=="function"?h.callback=_:h===n(a)&&r(a),S(d)}else r(a);h=n(a)}if(h!==null)var I=!0;else{var H=n(u);H!==null&&Ae(T,H.startTime-d),I=!1}return I}finally{h=null,f=m,g=!1}}var A=!1,D=null,U=-1,j=5,z=-1;function Z(){return!(t.unstable_now()-z<j)}function re(){if(D!==null){var b=t.unstable_now();z=b;var d=!0;try{d=D(!0,b)}finally{d?ne():(A=!1,D=null)}}else A=!1}var ne;if(typeof C=="function")ne=function(){C(re)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,Re=ue.port2;ue.port1.onmessage=re,ne=function(){Re.postMessage(null)}}else ne=function(){E(re,0)};function Ne(b){D=b,A||(A=!0,ne())}function Ae(b,d){U=E(function(){b(t.unstable_now())},d)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(b){b.callback=null},t.unstable_continueExecution=function(){p||g||(p=!0,Ne(x))},t.unstable_forceFrameRate=function(b){0>b||125<b?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<b?Math.floor(1e3/b):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(a)},t.unstable_next=function(b){switch(f){case 1:case 2:case 3:var d=3;break;default:d=f}var m=f;f=d;try{return b()}finally{f=m}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(b,d){switch(b){case 1:case 2:case 3:case 4:case 5:break;default:b=3}var m=f;f=b;try{return d()}finally{f=m}},t.unstable_scheduleCallback=function(b,d,m){var v=t.unstable_now();switch(typeof m=="object"&&m!==null?(m=m.delay,m=typeof m=="number"&&0<m?v+m:v):m=v,b){case 1:var _=-1;break;case 2:_=250;break;case 5:_=1073741823;break;case 4:_=1e4;break;default:_=5e3}return _=m+_,b={id:c++,callback:d,priorityLevel:b,startTime:m,expirationTime:_,sortIndex:-1},m>v?(b.sortIndex=m,e(u,b),n(a)===null&&b===n(u)&&(y?(w(U),U=-1):y=!0,Ae(T,m-v))):(b.sortIndex=_,e(a,b),p||g||(p=!0,Ne(x))),b},t.unstable_shouldYield=Z,t.unstable_wrapCallback=function(b){var d=f;return function(){var m=f;f=d;try{return b.apply(this,arguments)}finally{f=m}}}})(J_);Z_.exports=J_;var gL=Z_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eO=ch,Sr=gL;function oe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var tO=new Set,xc={};function Rl(t,e){Da(t,e),Da(t+"Capture",e)}function Da(t,e){for(xc[t]=e,t=0;t<e.length;t++)tO.add(e[t])}var yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nv=Object.prototype.hasOwnProperty,mL=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,QE={},ZE={};function pL(t){return nv.call(ZE,t)?!0:nv.call(QE,t)?!1:mL.test(t)?ZE[t]=!0:(QE[t]=!0,!1)}function wL(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function CL(t,e,n,r){if(e===null||typeof e>"u"||wL(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qn(t,e,n,r,o,i,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=s}var yn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){yn[t]=new qn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];yn[e]=new qn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){yn[t]=new qn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){yn[t]=new qn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){yn[t]=new qn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){yn[t]=new qn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){yn[t]=new qn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){yn[t]=new qn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){yn[t]=new qn(t,5,!1,t.toLowerCase(),null,!1,!1)});var sS=/[\-:]([a-z])/g;function lS(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(sS,lS);yn[e]=new qn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(sS,lS);yn[e]=new qn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(sS,lS);yn[e]=new qn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){yn[t]=new qn(t,1,!1,t.toLowerCase(),null,!1,!1)});yn.xlinkHref=new qn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){yn[t]=new qn(t,1,!1,t.toLowerCase(),null,!0,!0)});function aS(t,e,n,r){var o=yn.hasOwnProperty(e)?yn[e]:null;(o!==null?o.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(CL(e,n,o,r)&&(n=null),r||o===null?pL(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=n===null?o.type===3?!1:"":n:(e=o.attributeName,r=o.attributeNamespace,n===null?t.removeAttribute(e):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var xi=eO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wh=Symbol.for("react.element"),sa=Symbol.for("react.portal"),la=Symbol.for("react.fragment"),uS=Symbol.for("react.strict_mode"),rv=Symbol.for("react.profiler"),nO=Symbol.for("react.provider"),rO=Symbol.for("react.context"),cS=Symbol.for("react.forward_ref"),ov=Symbol.for("react.suspense"),iv=Symbol.for("react.suspense_list"),hS=Symbol.for("react.memo"),Ki=Symbol.for("react.lazy"),oO=Symbol.for("react.offscreen"),JE=Symbol.iterator;function hu(t){return t===null||typeof t!="object"?null:(t=JE&&t[JE]||t["@@iterator"],typeof t=="function"?t:null)}var Wt=Object.assign,yp;function Yu(t){if(yp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);yp=e&&e[1]||""}return`
`+yp+t}var Sp=!1;function Rp(t,e){if(!t||Sp)return"";Sp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var o=u.stack.split(`
`),i=r.stack.split(`
`),s=o.length-1,l=i.length-1;1<=s&&0<=l&&o[s]!==i[l];)l--;for(;1<=s&&0<=l;s--,l--)if(o[s]!==i[l]){if(s!==1||l!==1)do if(s--,l--,0>l||o[s]!==i[l]){var a=`
`+o[s].replace(" at new "," at ");return t.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",t.displayName)),a}while(1<=s&&0<=l);break}}}finally{Sp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Yu(t):""}function vL(t){switch(t.tag){case 5:return Yu(t.type);case 16:return Yu("Lazy");case 13:return Yu("Suspense");case 19:return Yu("SuspenseList");case 0:case 2:case 15:return t=Rp(t.type,!1),t;case 11:return t=Rp(t.type.render,!1),t;case 1:return t=Rp(t.type,!0),t;default:return""}}function sv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case la:return"Fragment";case sa:return"Portal";case rv:return"Profiler";case uS:return"StrictMode";case ov:return"Suspense";case iv:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case rO:return(t.displayName||"Context")+".Consumer";case nO:return(t._context.displayName||"Context")+".Provider";case cS:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case hS:return e=t.displayName||null,e!==null?e:sv(t.type)||"Memo";case Ki:e=t._payload,t=t._init;try{return sv(t(e))}catch{}}return null}function yL(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sv(e);case 8:return e===uS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Rs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function iO(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function SL(t){var e=iO(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(s){r=""+s,i.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Uh(t){t._valueTracker||(t._valueTracker=SL(t))}function sO(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=iO(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Uf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function lv(t,e){var n=e.checked;return Wt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function eT(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Rs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function lO(t,e){e=e.checked,e!=null&&aS(t,"checked",e,!1)}function av(t,e){lO(t,e);var n=Rs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?uv(t,e.type,n):e.hasOwnProperty("defaultValue")&&uv(t,e.type,Rs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function tT(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function uv(t,e,n){(e!=="number"||Uf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Gu=Array.isArray;function Ea(t,e,n,r){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Rs(n),e=null,o=0;o<t.length;o++){if(t[o].value===n){t[o].selected=!0,r&&(t[o].defaultSelected=!0);return}e!==null||t[o].disabled||(e=t[o])}e!==null&&(e.selected=!0)}}function cv(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(oe(91));return Wt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function nT(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(oe(92));if(Gu(n)){if(1<n.length)throw Error(oe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Rs(n)}}function aO(t,e){var n=Rs(e.value),r=Rs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function rT(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function uO(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hv(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?uO(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var zh,cO=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,o){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,o)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(zh=zh||document.createElement("div"),zh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=zh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function _c(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var oc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},RL=["Webkit","ms","Moz","O"];Object.keys(oc).forEach(function(t){RL.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),oc[e]=oc[t]})});function hO(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||oc.hasOwnProperty(t)&&oc[t]?(""+e).trim():e+"px"}function dO(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=hO(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,o):t[n]=o}}var bL=Wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dv(t,e){if(e){if(bL[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(oe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(oe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(oe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(oe(62))}}function fv(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gv=null;function dS(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var mv=null,Ta=null,Ma=null;function oT(t){if(t=fh(t)){if(typeof mv!="function")throw Error(oe(280));var e=t.stateNode;e&&(e=Zg(e),mv(t.stateNode,t.type,e))}}function fO(t){Ta?Ma?Ma.push(t):Ma=[t]:Ta=t}function gO(){if(Ta){var t=Ta,e=Ma;if(Ma=Ta=null,oT(t),e)for(t=0;t<e.length;t++)oT(e[t])}}function mO(t,e){return t(e)}function pO(){}var bp=!1;function wO(t,e,n){if(bp)return t(e,n);bp=!0;try{return mO(t,e,n)}finally{bp=!1,(Ta!==null||Ma!==null)&&(pO(),gO())}}function Oc(t,e){var n=t.stateNode;if(n===null)return null;var r=Zg(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(oe(231,e,typeof n));return n}var pv=!1;if(yi)try{var du={};Object.defineProperty(du,"passive",{get:function(){pv=!0}}),window.addEventListener("test",du,du),window.removeEventListener("test",du,du)}catch{pv=!1}function EL(t,e,n,r,o,i,s,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var ic=!1,zf=null,jf=!1,wv=null,TL={onError:function(t){ic=!0,zf=t}};function ML(t,e,n,r,o,i,s,l,a){ic=!1,zf=null,EL.apply(TL,arguments)}function xL(t,e,n,r,o,i,s,l,a){if(ML.apply(this,arguments),ic){if(ic){var u=zf;ic=!1,zf=null}else throw Error(oe(198));jf||(jf=!0,wv=u)}}function bl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function CO(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function iT(t){if(bl(t)!==t)throw Error(oe(188))}function _L(t){var e=t.alternate;if(!e){if(e=bl(t),e===null)throw Error(oe(188));return e!==t?null:t}for(var n=t,r=e;;){var o=n.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return iT(o),t;if(i===r)return iT(o),e;i=i.sibling}throw Error(oe(188))}if(n.return!==r.return)n=o,r=i;else{for(var s=!1,l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s){for(l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s)throw Error(oe(189))}}if(n.alternate!==r)throw Error(oe(190))}if(n.tag!==3)throw Error(oe(188));return n.stateNode.current===n?t:e}function vO(t){return t=_L(t),t!==null?yO(t):null}function yO(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=yO(t);if(e!==null)return e;t=t.sibling}return null}var SO=Sr.unstable_scheduleCallback,sT=Sr.unstable_cancelCallback,OL=Sr.unstable_shouldYield,IL=Sr.unstable_requestPaint,qt=Sr.unstable_now,AL=Sr.unstable_getCurrentPriorityLevel,fS=Sr.unstable_ImmediatePriority,RO=Sr.unstable_UserBlockingPriority,Yf=Sr.unstable_NormalPriority,HL=Sr.unstable_LowPriority,bO=Sr.unstable_IdlePriority,Kg=null,Lo=null;function PL(t){if(Lo&&typeof Lo.onCommitFiberRoot=="function")try{Lo.onCommitFiberRoot(Kg,t,void 0,(t.current.flags&128)===128)}catch{}}var lo=Math.clz32?Math.clz32:NL,kL=Math.log,DL=Math.LN2;function NL(t){return t>>>=0,t===0?32:31-(kL(t)/DL|0)|0}var jh=64,Yh=4194304;function Ku(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Gf(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,o=t.suspendedLanes,i=t.pingedLanes,s=n&268435455;if(s!==0){var l=s&~o;l!==0?r=Ku(l):(i&=s,i!==0&&(r=Ku(i)))}else s=n&~o,s!==0?r=Ku(s):i!==0&&(r=Ku(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&o)&&(o=r&-r,i=e&-e,o>=i||o===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-lo(e),o=1<<n,r|=t[n],e&=~o;return r}function LL(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function FL(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,o=t.expirationTimes,i=t.pendingLanes;0<i;){var s=31-lo(i),l=1<<s,a=o[s];a===-1?(!(l&n)||l&r)&&(o[s]=LL(l,e)):a<=e&&(t.expiredLanes|=l),i&=~l}}function Cv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function EO(){var t=jh;return jh<<=1,!(jh&4194240)&&(jh=64),t}function Ep(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function hh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-lo(e),t[e]=n}function $L(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var o=31-lo(n),i=1<<o;e[o]=0,r[o]=-1,t[o]=-1,n&=~i}}function gS(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-lo(n),o=1<<r;o&e|t[r]&e&&(t[r]|=e),n&=~o}}var dt=0;function TO(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var MO,mS,xO,_O,OO,vv=!1,Gh=[],ls=null,as=null,us=null,Ic=new Map,Ac=new Map,Qi=[],VL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function lT(t,e){switch(t){case"focusin":case"focusout":ls=null;break;case"dragenter":case"dragleave":as=null;break;case"mouseover":case"mouseout":us=null;break;case"pointerover":case"pointerout":Ic.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ac.delete(e.pointerId)}}function fu(t,e,n,r,o,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},e!==null&&(e=fh(e),e!==null&&mS(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),t)}function BL(t,e,n,r,o){switch(e){case"focusin":return ls=fu(ls,t,e,n,r,o),!0;case"dragenter":return as=fu(as,t,e,n,r,o),!0;case"mouseover":return us=fu(us,t,e,n,r,o),!0;case"pointerover":var i=o.pointerId;return Ic.set(i,fu(Ic.get(i)||null,t,e,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Ac.set(i,fu(Ac.get(i)||null,t,e,n,r,o)),!0}return!1}function IO(t){var e=tl(t.target);if(e!==null){var n=bl(e);if(n!==null){if(e=n.tag,e===13){if(e=CO(n),e!==null){t.blockedOn=e,OO(t.priority,function(){xO(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function df(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=yv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);gv=r,n.target.dispatchEvent(r),gv=null}else return e=fh(n),e!==null&&mS(e),t.blockedOn=n,!1;e.shift()}return!0}function aT(t,e,n){df(t)&&n.delete(e)}function WL(){vv=!1,ls!==null&&df(ls)&&(ls=null),as!==null&&df(as)&&(as=null),us!==null&&df(us)&&(us=null),Ic.forEach(aT),Ac.forEach(aT)}function gu(t,e){t.blockedOn===e&&(t.blockedOn=null,vv||(vv=!0,Sr.unstable_scheduleCallback(Sr.unstable_NormalPriority,WL)))}function Hc(t){function e(o){return gu(o,t)}if(0<Gh.length){gu(Gh[0],t);for(var n=1;n<Gh.length;n++){var r=Gh[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ls!==null&&gu(ls,t),as!==null&&gu(as,t),us!==null&&gu(us,t),Ic.forEach(e),Ac.forEach(e),n=0;n<Qi.length;n++)r=Qi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Qi.length&&(n=Qi[0],n.blockedOn===null);)IO(n),n.blockedOn===null&&Qi.shift()}var xa=xi.ReactCurrentBatchConfig,Kf=!0;function UL(t,e,n,r){var o=dt,i=xa.transition;xa.transition=null;try{dt=1,pS(t,e,n,r)}finally{dt=o,xa.transition=i}}function zL(t,e,n,r){var o=dt,i=xa.transition;xa.transition=null;try{dt=4,pS(t,e,n,r)}finally{dt=o,xa.transition=i}}function pS(t,e,n,r){if(Kf){var o=yv(t,e,n,r);if(o===null)kp(t,e,r,Xf,n),lT(t,r);else if(BL(o,t,e,n,r))r.stopPropagation();else if(lT(t,r),e&4&&-1<VL.indexOf(t)){for(;o!==null;){var i=fh(o);if(i!==null&&MO(i),i=yv(t,e,n,r),i===null&&kp(t,e,r,Xf,n),i===o)break;o=i}o!==null&&r.stopPropagation()}else kp(t,e,r,null,n)}}var Xf=null;function yv(t,e,n,r){if(Xf=null,t=dS(r),t=tl(t),t!==null)if(e=bl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=CO(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Xf=t,null}function AO(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(AL()){case fS:return 1;case RO:return 4;case Yf:case HL:return 16;case bO:return 536870912;default:return 16}default:return 16}}var ts=null,wS=null,ff=null;function HO(){if(ff)return ff;var t,e=wS,n=e.length,r,o="value"in ts?ts.value:ts.textContent,i=o.length;for(t=0;t<n&&e[t]===o[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===o[i-r];r++);return ff=o.slice(t,1<r?1-r:void 0)}function gf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Kh(){return!0}function uT(){return!1}function Tr(t){function e(n,r,o,i,s){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Kh:uT,this.isPropagationStopped=uT,this}return Wt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Kh)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Kh)},persist:function(){},isPersistent:Kh}),e}var Za={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},CS=Tr(Za),dh=Wt({},Za,{view:0,detail:0}),jL=Tr(dh),Tp,Mp,mu,Xg=Wt({},dh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vS,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==mu&&(mu&&t.type==="mousemove"?(Tp=t.screenX-mu.screenX,Mp=t.screenY-mu.screenY):Mp=Tp=0,mu=t),Tp)},movementY:function(t){return"movementY"in t?t.movementY:Mp}}),cT=Tr(Xg),YL=Wt({},Xg,{dataTransfer:0}),GL=Tr(YL),KL=Wt({},dh,{relatedTarget:0}),xp=Tr(KL),XL=Wt({},Za,{animationName:0,elapsedTime:0,pseudoElement:0}),qL=Tr(XL),QL=Wt({},Za,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ZL=Tr(QL),JL=Wt({},Za,{data:0}),hT=Tr(JL),eF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rF(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=nF[t])?!!e[t]:!1}function vS(){return rF}var oF=Wt({},dh,{key:function(t){if(t.key){var e=eF[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=gf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?tF[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vS,charCode:function(t){return t.type==="keypress"?gf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?gf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),iF=Tr(oF),sF=Wt({},Xg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dT=Tr(sF),lF=Wt({},dh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vS}),aF=Tr(lF),uF=Wt({},Za,{propertyName:0,elapsedTime:0,pseudoElement:0}),cF=Tr(uF),hF=Wt({},Xg,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),dF=Tr(hF),fF=[9,13,27,32],yS=yi&&"CompositionEvent"in window,sc=null;yi&&"documentMode"in document&&(sc=document.documentMode);var gF=yi&&"TextEvent"in window&&!sc,PO=yi&&(!yS||sc&&8<sc&&11>=sc),fT=String.fromCharCode(32),gT=!1;function kO(t,e){switch(t){case"keyup":return fF.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function DO(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var aa=!1;function mF(t,e){switch(t){case"compositionend":return DO(e);case"keypress":return e.which!==32?null:(gT=!0,fT);case"textInput":return t=e.data,t===fT&&gT?null:t;default:return null}}function pF(t,e){if(aa)return t==="compositionend"||!yS&&kO(t,e)?(t=HO(),ff=wS=ts=null,aa=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return PO&&e.locale!=="ko"?null:e.data;default:return null}}var wF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!wF[t.type]:e==="textarea"}function NO(t,e,n,r){fO(r),e=qf(e,"onChange"),0<e.length&&(n=new CS("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var lc=null,Pc=null;function CF(t){GO(t,0)}function qg(t){var e=ha(t);if(sO(e))return t}function vF(t,e){if(t==="change")return e}var LO=!1;if(yi){var _p;if(yi){var Op="oninput"in document;if(!Op){var pT=document.createElement("div");pT.setAttribute("oninput","return;"),Op=typeof pT.oninput=="function"}_p=Op}else _p=!1;LO=_p&&(!document.documentMode||9<document.documentMode)}function wT(){lc&&(lc.detachEvent("onpropertychange",FO),Pc=lc=null)}function FO(t){if(t.propertyName==="value"&&qg(Pc)){var e=[];NO(e,Pc,t,dS(t)),wO(CF,e)}}function yF(t,e,n){t==="focusin"?(wT(),lc=e,Pc=n,lc.attachEvent("onpropertychange",FO)):t==="focusout"&&wT()}function SF(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return qg(Pc)}function RF(t,e){if(t==="click")return qg(e)}function bF(t,e){if(t==="input"||t==="change")return qg(e)}function EF(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var uo=typeof Object.is=="function"?Object.is:EF;function kc(t,e){if(uo(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!nv.call(e,o)||!uo(t[o],e[o]))return!1}return!0}function CT(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function vT(t,e){var n=CT(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=CT(n)}}function $O(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?$O(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function VO(){for(var t=window,e=Uf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Uf(t.document)}return e}function SS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function TF(t){var e=VO(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&$O(n.ownerDocument.documentElement,n)){if(r!==null&&SS(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!t.extend&&i>r&&(o=r,r=i,i=o),o=vT(n,i);var s=vT(n,r);o&&s&&(t.rangeCount!==1||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var MF=yi&&"documentMode"in document&&11>=document.documentMode,ua=null,Sv=null,ac=null,Rv=!1;function yT(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Rv||ua==null||ua!==Uf(r)||(r=ua,"selectionStart"in r&&SS(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ac&&kc(ac,r)||(ac=r,r=qf(Sv,"onSelect"),0<r.length&&(e=new CS("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ua)))}function Xh(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ca={animationend:Xh("Animation","AnimationEnd"),animationiteration:Xh("Animation","AnimationIteration"),animationstart:Xh("Animation","AnimationStart"),transitionend:Xh("Transition","TransitionEnd")},Ip={},BO={};yi&&(BO=document.createElement("div").style,"AnimationEvent"in window||(delete ca.animationend.animation,delete ca.animationiteration.animation,delete ca.animationstart.animation),"TransitionEvent"in window||delete ca.transitionend.transition);function Qg(t){if(Ip[t])return Ip[t];if(!ca[t])return t;var e=ca[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in BO)return Ip[t]=e[n];return t}var WO=Qg("animationend"),UO=Qg("animationiteration"),zO=Qg("animationstart"),jO=Qg("transitionend"),YO=new Map,ST="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _s(t,e){YO.set(t,e),Rl(e,[t])}for(var Ap=0;Ap<ST.length;Ap++){var Hp=ST[Ap],xF=Hp.toLowerCase(),_F=Hp[0].toUpperCase()+Hp.slice(1);_s(xF,"on"+_F)}_s(WO,"onAnimationEnd");_s(UO,"onAnimationIteration");_s(zO,"onAnimationStart");_s("dblclick","onDoubleClick");_s("focusin","onFocus");_s("focusout","onBlur");_s(jO,"onTransitionEnd");Da("onMouseEnter",["mouseout","mouseover"]);Da("onMouseLeave",["mouseout","mouseover"]);Da("onPointerEnter",["pointerout","pointerover"]);Da("onPointerLeave",["pointerout","pointerover"]);Rl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Rl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Rl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Rl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Rl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Rl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),OF=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xu));function RT(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,xL(r,e,void 0,t),t.currentTarget=null}function GO(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],o=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var s=r.length-1;0<=s;s--){var l=r[s],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==i&&o.isPropagationStopped())break e;RT(o,l,u),i=a}else for(s=0;s<r.length;s++){if(l=r[s],a=l.instance,u=l.currentTarget,l=l.listener,a!==i&&o.isPropagationStopped())break e;RT(o,l,u),i=a}}}if(jf)throw t=wv,jf=!1,wv=null,t}function Tt(t,e){var n=e[xv];n===void 0&&(n=e[xv]=new Set);var r=t+"__bubble";n.has(r)||(KO(e,t,2,!1),n.add(r))}function Pp(t,e,n){var r=0;e&&(r|=4),KO(n,t,r,e)}var qh="_reactListening"+Math.random().toString(36).slice(2);function Dc(t){if(!t[qh]){t[qh]=!0,tO.forEach(function(n){n!=="selectionchange"&&(OF.has(n)||Pp(n,!1,t),Pp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[qh]||(e[qh]=!0,Pp("selectionchange",!1,e))}}function KO(t,e,n,r){switch(AO(e)){case 1:var o=UL;break;case 4:o=zL;break;default:o=pS}n=o.bind(null,e,n,t),o=void 0,!pv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),r?o!==void 0?t.addEventListener(e,n,{capture:!0,passive:o}):t.addEventListener(e,n,!0):o!==void 0?t.addEventListener(e,n,{passive:o}):t.addEventListener(e,n,!1)}function kp(t,e,n,r,o){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var l=r.stateNode.containerInfo;if(l===o||l.nodeType===8&&l.parentNode===o)break;if(s===4)for(s=r.return;s!==null;){var a=s.tag;if((a===3||a===4)&&(a=s.stateNode.containerInfo,a===o||a.nodeType===8&&a.parentNode===o))return;s=s.return}for(;l!==null;){if(s=tl(l),s===null)return;if(a=s.tag,a===5||a===6){r=i=s;continue e}l=l.parentNode}}r=r.return}wO(function(){var u=i,c=dS(n),h=[];e:{var f=YO.get(t);if(f!==void 0){var g=CS,p=t;switch(t){case"keypress":if(gf(n)===0)break e;case"keydown":case"keyup":g=iF;break;case"focusin":p="focus",g=xp;break;case"focusout":p="blur",g=xp;break;case"beforeblur":case"afterblur":g=xp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=cT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=GL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=aF;break;case WO:case UO:case zO:g=qL;break;case jO:g=cF;break;case"scroll":g=jL;break;case"wheel":g=dF;break;case"copy":case"cut":case"paste":g=ZL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=dT}var y=(e&4)!==0,E=!y&&t==="scroll",w=y?f!==null?f+"Capture":null:f;y=[];for(var C=u,S;C!==null;){S=C;var T=S.stateNode;if(S.tag===5&&T!==null&&(S=T,w!==null&&(T=Oc(C,w),T!=null&&y.push(Nc(C,T,S)))),E)break;C=C.return}0<y.length&&(f=new g(f,p,null,n,c),h.push({event:f,listeners:y}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",f&&n!==gv&&(p=n.relatedTarget||n.fromElement)&&(tl(p)||p[Si]))break e;if((g||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,g?(p=n.relatedTarget||n.toElement,g=u,p=p?tl(p):null,p!==null&&(E=bl(p),p!==E||p.tag!==5&&p.tag!==6)&&(p=null)):(g=null,p=u),g!==p)){if(y=cT,T="onMouseLeave",w="onMouseEnter",C="mouse",(t==="pointerout"||t==="pointerover")&&(y=dT,T="onPointerLeave",w="onPointerEnter",C="pointer"),E=g==null?f:ha(g),S=p==null?f:ha(p),f=new y(T,C+"leave",g,n,c),f.target=E,f.relatedTarget=S,T=null,tl(c)===u&&(y=new y(w,C+"enter",p,n,c),y.target=S,y.relatedTarget=E,T=y),E=T,g&&p)t:{for(y=g,w=p,C=0,S=y;S;S=Dl(S))C++;for(S=0,T=w;T;T=Dl(T))S++;for(;0<C-S;)y=Dl(y),C--;for(;0<S-C;)w=Dl(w),S--;for(;C--;){if(y===w||w!==null&&y===w.alternate)break t;y=Dl(y),w=Dl(w)}y=null}else y=null;g!==null&&bT(h,f,g,y,!1),p!==null&&E!==null&&bT(h,E,p,y,!0)}}e:{if(f=u?ha(u):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var x=vF;else if(mT(f))if(LO)x=bF;else{x=SF;var A=yF}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(x=RF);if(x&&(x=x(t,u))){NO(h,x,n,c);break e}A&&A(t,f,u),t==="focusout"&&(A=f._wrapperState)&&A.controlled&&f.type==="number"&&uv(f,"number",f.value)}switch(A=u?ha(u):window,t){case"focusin":(mT(A)||A.contentEditable==="true")&&(ua=A,Sv=u,ac=null);break;case"focusout":ac=Sv=ua=null;break;case"mousedown":Rv=!0;break;case"contextmenu":case"mouseup":case"dragend":Rv=!1,yT(h,n,c);break;case"selectionchange":if(MF)break;case"keydown":case"keyup":yT(h,n,c)}var D;if(yS)e:{switch(t){case"compositionstart":var U="onCompositionStart";break e;case"compositionend":U="onCompositionEnd";break e;case"compositionupdate":U="onCompositionUpdate";break e}U=void 0}else aa?kO(t,n)&&(U="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(U="onCompositionStart");U&&(PO&&n.locale!=="ko"&&(aa||U!=="onCompositionStart"?U==="onCompositionEnd"&&aa&&(D=HO()):(ts=c,wS="value"in ts?ts.value:ts.textContent,aa=!0)),A=qf(u,U),0<A.length&&(U=new hT(U,t,null,n,c),h.push({event:U,listeners:A}),D?U.data=D:(D=DO(n),D!==null&&(U.data=D)))),(D=gF?mF(t,n):pF(t,n))&&(u=qf(u,"onBeforeInput"),0<u.length&&(c=new hT("onBeforeInput","beforeinput",null,n,c),h.push({event:c,listeners:u}),c.data=D))}GO(h,e)})}function Nc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function qf(t,e){for(var n=e+"Capture",r=[];t!==null;){var o=t,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=Oc(t,n),i!=null&&r.unshift(Nc(t,i,o)),i=Oc(t,e),i!=null&&r.push(Nc(t,i,o))),t=t.return}return r}function Dl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function bT(t,e,n,r,o){for(var i=e._reactName,s=[];n!==null&&n!==r;){var l=n,a=l.alternate,u=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&u!==null&&(l=u,o?(a=Oc(n,i),a!=null&&s.unshift(Nc(n,a,l))):o||(a=Oc(n,i),a!=null&&s.push(Nc(n,a,l)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var IF=/\r\n?/g,AF=/\u0000|\uFFFD/g;function ET(t){return(typeof t=="string"?t:""+t).replace(IF,`
`).replace(AF,"")}function Qh(t,e,n){if(e=ET(e),ET(t)!==e&&n)throw Error(oe(425))}function Qf(){}var bv=null,Ev=null;function Tv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Mv=typeof setTimeout=="function"?setTimeout:void 0,HF=typeof clearTimeout=="function"?clearTimeout:void 0,TT=typeof Promise=="function"?Promise:void 0,PF=typeof queueMicrotask=="function"?queueMicrotask:typeof TT<"u"?function(t){return TT.resolve(null).then(t).catch(kF)}:Mv;function kF(t){setTimeout(function(){throw t})}function Dp(t,e){var n=e,r=0;do{var o=n.nextSibling;if(t.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){t.removeChild(o),Hc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);Hc(e)}function cs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function MT(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ja=Math.random().toString(36).slice(2),Po="__reactFiber$"+Ja,Lc="__reactProps$"+Ja,Si="__reactContainer$"+Ja,xv="__reactEvents$"+Ja,DF="__reactListeners$"+Ja,NF="__reactHandles$"+Ja;function tl(t){var e=t[Po];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Si]||n[Po]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=MT(t);t!==null;){if(n=t[Po])return n;t=MT(t)}return e}t=n,n=t.parentNode}return null}function fh(t){return t=t[Po]||t[Si],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ha(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(oe(33))}function Zg(t){return t[Lc]||null}var _v=[],da=-1;function Os(t){return{current:t}}function xt(t){0>da||(t.current=_v[da],_v[da]=null,da--)}function St(t,e){da++,_v[da]=t.current,t.current=e}var bs={},Pn=Os(bs),lr=Os(!1),hl=bs;function Na(t,e){var n=t.type.contextTypes;if(!n)return bs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in n)o[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function ar(t){return t=t.childContextTypes,t!=null}function Zf(){xt(lr),xt(Pn)}function xT(t,e,n){if(Pn.current!==bs)throw Error(oe(168));St(Pn,e),St(lr,n)}function XO(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in e))throw Error(oe(108,yL(t)||"Unknown",o));return Wt({},n,r)}function Jf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||bs,hl=Pn.current,St(Pn,t),St(lr,lr.current),!0}function _T(t,e,n){var r=t.stateNode;if(!r)throw Error(oe(169));n?(t=XO(t,e,hl),r.__reactInternalMemoizedMergedChildContext=t,xt(lr),xt(Pn),St(Pn,t)):xt(lr),St(lr,n)}var ci=null,Jg=!1,Np=!1;function qO(t){ci===null?ci=[t]:ci.push(t)}function LF(t){Jg=!0,qO(t)}function Is(){if(!Np&&ci!==null){Np=!0;var t=0,e=dt;try{var n=ci;for(dt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ci=null,Jg=!1}catch(o){throw ci!==null&&(ci=ci.slice(t+1)),SO(fS,Is),o}finally{dt=e,Np=!1}}return null}var fa=[],ga=0,eg=null,tg=0,kr=[],Dr=0,dl=null,hi=1,di="";function Zs(t,e){fa[ga++]=tg,fa[ga++]=eg,eg=t,tg=e}function QO(t,e,n){kr[Dr++]=hi,kr[Dr++]=di,kr[Dr++]=dl,dl=t;var r=hi;t=di;var o=32-lo(r)-1;r&=~(1<<o),n+=1;var i=32-lo(e)+o;if(30<i){var s=o-o%5;i=(r&(1<<s)-1).toString(32),r>>=s,o-=s,hi=1<<32-lo(e)+o|n<<o|r,di=i+t}else hi=1<<i|n<<o|r,di=t}function RS(t){t.return!==null&&(Zs(t,1),QO(t,1,0))}function bS(t){for(;t===eg;)eg=fa[--ga],fa[ga]=null,tg=fa[--ga],fa[ga]=null;for(;t===dl;)dl=kr[--Dr],kr[Dr]=null,di=kr[--Dr],kr[Dr]=null,hi=kr[--Dr],kr[Dr]=null}var yr=null,Cr=null,Ht=!1,no=null;function ZO(t,e){var n=Lr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function OT(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,yr=t,Cr=cs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,yr=t,Cr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=dl!==null?{id:hi,overflow:di}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Lr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,yr=t,Cr=null,!0):!1;default:return!1}}function Ov(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Iv(t){if(Ht){var e=Cr;if(e){var n=e;if(!OT(t,e)){if(Ov(t))throw Error(oe(418));e=cs(n.nextSibling);var r=yr;e&&OT(t,e)?ZO(r,n):(t.flags=t.flags&-4097|2,Ht=!1,yr=t)}}else{if(Ov(t))throw Error(oe(418));t.flags=t.flags&-4097|2,Ht=!1,yr=t}}}function IT(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;yr=t}function Zh(t){if(t!==yr)return!1;if(!Ht)return IT(t),Ht=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Tv(t.type,t.memoizedProps)),e&&(e=Cr)){if(Ov(t))throw JO(),Error(oe(418));for(;e;)ZO(t,e),e=cs(e.nextSibling)}if(IT(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(oe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Cr=cs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Cr=null}}else Cr=yr?cs(t.stateNode.nextSibling):null;return!0}function JO(){for(var t=Cr;t;)t=cs(t.nextSibling)}function La(){Cr=yr=null,Ht=!1}function ES(t){no===null?no=[t]:no.push(t)}var FF=xi.ReactCurrentBatchConfig;function eo(t,e){if(t&&t.defaultProps){e=Wt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var ng=Os(null),rg=null,ma=null,TS=null;function MS(){TS=ma=rg=null}function xS(t){var e=ng.current;xt(ng),t._currentValue=e}function Av(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function _a(t,e){rg=t,TS=ma=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(sr=!0),t.firstContext=null)}function Vr(t){var e=t._currentValue;if(TS!==t)if(t={context:t,memoizedValue:e,next:null},ma===null){if(rg===null)throw Error(oe(308));ma=t,rg.dependencies={lanes:0,firstContext:t}}else ma=ma.next=t;return e}var nl=null;function _S(t){nl===null?nl=[t]:nl.push(t)}function eI(t,e,n,r){var o=e.interleaved;return o===null?(n.next=n,_S(e)):(n.next=o.next,o.next=n),e.interleaved=n,Ri(t,r)}function Ri(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Xi=!1;function OS(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tI(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ci(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function hs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,rt&2){var o=r.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),r.pending=e,Ri(t,n)}return o=r.interleaved,o===null?(e.next=e,_S(r)):(e.next=o.next,o.next=e),r.interleaved=e,Ri(t,n)}function mf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,gS(t,n)}}function AT(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?o=i=s:i=i.next=s,n=n.next}while(n!==null);i===null?o=i=e:i=i.next=e}else o=i=e;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function og(t,e,n,r){var o=t.updateQueue;Xi=!1;var i=o.firstBaseUpdate,s=o.lastBaseUpdate,l=o.shared.pending;if(l!==null){o.shared.pending=null;var a=l,u=a.next;a.next=null,s===null?i=u:s.next=u,s=a;var c=t.alternate;c!==null&&(c=c.updateQueue,l=c.lastBaseUpdate,l!==s&&(l===null?c.firstBaseUpdate=u:l.next=u,c.lastBaseUpdate=a))}if(i!==null){var h=o.baseState;s=0,c=u=a=null,l=i;do{var f=l.lane,g=l.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var p=t,y=l;switch(f=e,g=n,y.tag){case 1:if(p=y.payload,typeof p=="function"){h=p.call(g,h,f);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=y.payload,f=typeof p=="function"?p.call(g,h,f):p,f==null)break e;h=Wt({},h,f);break e;case 2:Xi=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=o.effects,f===null?o.effects=[l]:f.push(l))}else g={eventTime:g,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},c===null?(u=c=g,a=h):c=c.next=g,s|=f;if(l=l.next,l===null){if(l=o.shared.pending,l===null)break;f=l,l=f.next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}while(1);if(c===null&&(a=h),o.baseState=a,o.firstBaseUpdate=u,o.lastBaseUpdate=c,e=o.shared.interleaved,e!==null){o=e;do s|=o.lane,o=o.next;while(o!==e)}else i===null&&(o.shared.lanes=0);gl|=s,t.lanes=s,t.memoizedState=h}}function HT(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(oe(191,o));o.call(r)}}}var nI=new eO.Component().refs;function Hv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Wt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var em={isMounted:function(t){return(t=t._reactInternals)?bl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Gn(),o=fs(t),i=Ci(r,o);i.payload=e,n!=null&&(i.callback=n),e=hs(t,i,o),e!==null&&(ao(e,t,o,r),mf(e,t,o))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Gn(),o=fs(t),i=Ci(r,o);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=hs(t,i,o),e!==null&&(ao(e,t,o,r),mf(e,t,o))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Gn(),r=fs(t),o=Ci(n,r);o.tag=2,e!=null&&(o.callback=e),e=hs(t,o,r),e!==null&&(ao(e,t,r,n),mf(e,t,r))}};function PT(t,e,n,r,o,i,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,s):e.prototype&&e.prototype.isPureReactComponent?!kc(n,r)||!kc(o,i):!0}function rI(t,e,n){var r=!1,o=bs,i=e.contextType;return typeof i=="object"&&i!==null?i=Vr(i):(o=ar(e)?hl:Pn.current,r=e.contextTypes,i=(r=r!=null)?Na(t,o):bs),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=em,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=i),e}function kT(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&em.enqueueReplaceState(e,e.state,null)}function Pv(t,e,n,r){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs=nI,OS(t);var i=e.contextType;typeof i=="object"&&i!==null?o.context=Vr(i):(i=ar(e)?hl:Pn.current,o.context=Na(t,i)),o.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Hv(t,e,i,n),o.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&em.enqueueReplaceState(o,o.state,null),og(t,n,o,r),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308)}function pu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(oe(309));var r=n.stateNode}if(!r)throw Error(oe(147,t));var o=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(s){var l=o.refs;l===nI&&(l=o.refs={}),s===null?delete l[i]:l[i]=s},e._stringRef=i,e)}if(typeof t!="string")throw Error(oe(284));if(!n._owner)throw Error(oe(290,t))}return t}function Jh(t,e){throw t=Object.prototype.toString.call(e),Error(oe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function DT(t){var e=t._init;return e(t._payload)}function oI(t){function e(w,C){if(t){var S=w.deletions;S===null?(w.deletions=[C],w.flags|=16):S.push(C)}}function n(w,C){if(!t)return null;for(;C!==null;)e(w,C),C=C.sibling;return null}function r(w,C){for(w=new Map;C!==null;)C.key!==null?w.set(C.key,C):w.set(C.index,C),C=C.sibling;return w}function o(w,C){return w=gs(w,C),w.index=0,w.sibling=null,w}function i(w,C,S){return w.index=S,t?(S=w.alternate,S!==null?(S=S.index,S<C?(w.flags|=2,C):S):(w.flags|=2,C)):(w.flags|=1048576,C)}function s(w){return t&&w.alternate===null&&(w.flags|=2),w}function l(w,C,S,T){return C===null||C.tag!==6?(C=Up(S,w.mode,T),C.return=w,C):(C=o(C,S),C.return=w,C)}function a(w,C,S,T){var x=S.type;return x===la?c(w,C,S.props.children,T,S.key):C!==null&&(C.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===Ki&&DT(x)===C.type)?(T=o(C,S.props),T.ref=pu(w,C,S),T.return=w,T):(T=Sf(S.type,S.key,S.props,null,w.mode,T),T.ref=pu(w,C,S),T.return=w,T)}function u(w,C,S,T){return C===null||C.tag!==4||C.stateNode.containerInfo!==S.containerInfo||C.stateNode.implementation!==S.implementation?(C=zp(S,w.mode,T),C.return=w,C):(C=o(C,S.children||[]),C.return=w,C)}function c(w,C,S,T,x){return C===null||C.tag!==7?(C=ul(S,w.mode,T,x),C.return=w,C):(C=o(C,S),C.return=w,C)}function h(w,C,S){if(typeof C=="string"&&C!==""||typeof C=="number")return C=Up(""+C,w.mode,S),C.return=w,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Wh:return S=Sf(C.type,C.key,C.props,null,w.mode,S),S.ref=pu(w,null,C),S.return=w,S;case sa:return C=zp(C,w.mode,S),C.return=w,C;case Ki:var T=C._init;return h(w,T(C._payload),S)}if(Gu(C)||hu(C))return C=ul(C,w.mode,S,null),C.return=w,C;Jh(w,C)}return null}function f(w,C,S,T){var x=C!==null?C.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return x!==null?null:l(w,C,""+S,T);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Wh:return S.key===x?a(w,C,S,T):null;case sa:return S.key===x?u(w,C,S,T):null;case Ki:return x=S._init,f(w,C,x(S._payload),T)}if(Gu(S)||hu(S))return x!==null?null:c(w,C,S,T,null);Jh(w,S)}return null}function g(w,C,S,T,x){if(typeof T=="string"&&T!==""||typeof T=="number")return w=w.get(S)||null,l(C,w,""+T,x);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Wh:return w=w.get(T.key===null?S:T.key)||null,a(C,w,T,x);case sa:return w=w.get(T.key===null?S:T.key)||null,u(C,w,T,x);case Ki:var A=T._init;return g(w,C,S,A(T._payload),x)}if(Gu(T)||hu(T))return w=w.get(S)||null,c(C,w,T,x,null);Jh(C,T)}return null}function p(w,C,S,T){for(var x=null,A=null,D=C,U=C=0,j=null;D!==null&&U<S.length;U++){D.index>U?(j=D,D=null):j=D.sibling;var z=f(w,D,S[U],T);if(z===null){D===null&&(D=j);break}t&&D&&z.alternate===null&&e(w,D),C=i(z,C,U),A===null?x=z:A.sibling=z,A=z,D=j}if(U===S.length)return n(w,D),Ht&&Zs(w,U),x;if(D===null){for(;U<S.length;U++)D=h(w,S[U],T),D!==null&&(C=i(D,C,U),A===null?x=D:A.sibling=D,A=D);return Ht&&Zs(w,U),x}for(D=r(w,D);U<S.length;U++)j=g(D,w,U,S[U],T),j!==null&&(t&&j.alternate!==null&&D.delete(j.key===null?U:j.key),C=i(j,C,U),A===null?x=j:A.sibling=j,A=j);return t&&D.forEach(function(Z){return e(w,Z)}),Ht&&Zs(w,U),x}function y(w,C,S,T){var x=hu(S);if(typeof x!="function")throw Error(oe(150));if(S=x.call(S),S==null)throw Error(oe(151));for(var A=x=null,D=C,U=C=0,j=null,z=S.next();D!==null&&!z.done;U++,z=S.next()){D.index>U?(j=D,D=null):j=D.sibling;var Z=f(w,D,z.value,T);if(Z===null){D===null&&(D=j);break}t&&D&&Z.alternate===null&&e(w,D),C=i(Z,C,U),A===null?x=Z:A.sibling=Z,A=Z,D=j}if(z.done)return n(w,D),Ht&&Zs(w,U),x;if(D===null){for(;!z.done;U++,z=S.next())z=h(w,z.value,T),z!==null&&(C=i(z,C,U),A===null?x=z:A.sibling=z,A=z);return Ht&&Zs(w,U),x}for(D=r(w,D);!z.done;U++,z=S.next())z=g(D,w,U,z.value,T),z!==null&&(t&&z.alternate!==null&&D.delete(z.key===null?U:z.key),C=i(z,C,U),A===null?x=z:A.sibling=z,A=z);return t&&D.forEach(function(re){return e(w,re)}),Ht&&Zs(w,U),x}function E(w,C,S,T){if(typeof S=="object"&&S!==null&&S.type===la&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Wh:e:{for(var x=S.key,A=C;A!==null;){if(A.key===x){if(x=S.type,x===la){if(A.tag===7){n(w,A.sibling),C=o(A,S.props.children),C.return=w,w=C;break e}}else if(A.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===Ki&&DT(x)===A.type){n(w,A.sibling),C=o(A,S.props),C.ref=pu(w,A,S),C.return=w,w=C;break e}n(w,A);break}else e(w,A);A=A.sibling}S.type===la?(C=ul(S.props.children,w.mode,T,S.key),C.return=w,w=C):(T=Sf(S.type,S.key,S.props,null,w.mode,T),T.ref=pu(w,C,S),T.return=w,w=T)}return s(w);case sa:e:{for(A=S.key;C!==null;){if(C.key===A)if(C.tag===4&&C.stateNode.containerInfo===S.containerInfo&&C.stateNode.implementation===S.implementation){n(w,C.sibling),C=o(C,S.children||[]),C.return=w,w=C;break e}else{n(w,C);break}else e(w,C);C=C.sibling}C=zp(S,w.mode,T),C.return=w,w=C}return s(w);case Ki:return A=S._init,E(w,C,A(S._payload),T)}if(Gu(S))return p(w,C,S,T);if(hu(S))return y(w,C,S,T);Jh(w,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,C!==null&&C.tag===6?(n(w,C.sibling),C=o(C,S),C.return=w,w=C):(n(w,C),C=Up(S,w.mode,T),C.return=w,w=C),s(w)):n(w,C)}return E}var Fa=oI(!0),iI=oI(!1),gh={},Fo=Os(gh),Fc=Os(gh),$c=Os(gh);function rl(t){if(t===gh)throw Error(oe(174));return t}function IS(t,e){switch(St($c,e),St(Fc,t),St(Fo,gh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:hv(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=hv(e,t)}xt(Fo),St(Fo,e)}function $a(){xt(Fo),xt(Fc),xt($c)}function sI(t){rl($c.current);var e=rl(Fo.current),n=hv(e,t.type);e!==n&&(St(Fc,t),St(Fo,n))}function AS(t){Fc.current===t&&(xt(Fo),xt(Fc))}var Lt=Os(0);function ig(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Lp=[];function HS(){for(var t=0;t<Lp.length;t++)Lp[t]._workInProgressVersionPrimary=null;Lp.length=0}var pf=xi.ReactCurrentDispatcher,Fp=xi.ReactCurrentBatchConfig,fl=0,Bt=null,sn=null,dn=null,sg=!1,uc=!1,Vc=0,$F=0;function bn(){throw Error(oe(321))}function PS(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!uo(t[n],e[n]))return!1;return!0}function kS(t,e,n,r,o,i){if(fl=i,Bt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,pf.current=t===null||t.memoizedState===null?UF:zF,t=n(r,o),uc){i=0;do{if(uc=!1,Vc=0,25<=i)throw Error(oe(301));i+=1,dn=sn=null,e.updateQueue=null,pf.current=jF,t=n(r,o)}while(uc)}if(pf.current=lg,e=sn!==null&&sn.next!==null,fl=0,dn=sn=Bt=null,sg=!1,e)throw Error(oe(300));return t}function DS(){var t=Vc!==0;return Vc=0,t}function Oo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?Bt.memoizedState=dn=t:dn=dn.next=t,dn}function Br(){if(sn===null){var t=Bt.alternate;t=t!==null?t.memoizedState:null}else t=sn.next;var e=dn===null?Bt.memoizedState:dn.next;if(e!==null)dn=e,sn=t;else{if(t===null)throw Error(oe(310));sn=t,t={memoizedState:sn.memoizedState,baseState:sn.baseState,baseQueue:sn.baseQueue,queue:sn.queue,next:null},dn===null?Bt.memoizedState=dn=t:dn=dn.next=t}return dn}function Bc(t,e){return typeof e=="function"?e(t):e}function $p(t){var e=Br(),n=e.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=t;var r=sn,o=r.baseQueue,i=n.pending;if(i!==null){if(o!==null){var s=o.next;o.next=i.next,i.next=s}r.baseQueue=o=i,n.pending=null}if(o!==null){i=o.next,r=r.baseState;var l=s=null,a=null,u=i;do{var c=u.lane;if((fl&c)===c)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=h,s=r):a=a.next=h,Bt.lanes|=c,gl|=c}u=u.next}while(u!==null&&u!==i);a===null?s=r:a.next=l,uo(r,e.memoizedState)||(sr=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=a,n.lastRenderedState=r}if(t=n.interleaved,t!==null){o=t;do i=o.lane,Bt.lanes|=i,gl|=i,o=o.next;while(o!==t)}else o===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Vp(t){var e=Br(),n=e.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=t;var r=n.dispatch,o=n.pending,i=e.memoizedState;if(o!==null){n.pending=null;var s=o=o.next;do i=t(i,s.action),s=s.next;while(s!==o);uo(i,e.memoizedState)||(sr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function lI(){}function aI(t,e){var n=Bt,r=Br(),o=e(),i=!uo(r.memoizedState,o);if(i&&(r.memoizedState=o,sr=!0),r=r.queue,NS(hI.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||dn!==null&&dn.memoizedState.tag&1){if(n.flags|=2048,Wc(9,cI.bind(null,n,r,o,e),void 0,null),fn===null)throw Error(oe(349));fl&30||uI(n,e,o)}return o}function uI(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Bt.updateQueue,e===null?(e={lastEffect:null,stores:null},Bt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function cI(t,e,n,r){e.value=n,e.getSnapshot=r,dI(e)&&fI(t)}function hI(t,e,n){return n(function(){dI(e)&&fI(t)})}function dI(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!uo(t,n)}catch{return!0}}function fI(t){var e=Ri(t,1);e!==null&&ao(e,t,1,-1)}function NT(t){var e=Oo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bc,lastRenderedState:t},e.queue=t,t=t.dispatch=WF.bind(null,Bt,t),[e.memoizedState,t]}function Wc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Bt.updateQueue,e===null?(e={lastEffect:null,stores:null},Bt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function gI(){return Br().memoizedState}function wf(t,e,n,r){var o=Oo();Bt.flags|=t,o.memoizedState=Wc(1|e,n,void 0,r===void 0?null:r)}function tm(t,e,n,r){var o=Br();r=r===void 0?null:r;var i=void 0;if(sn!==null){var s=sn.memoizedState;if(i=s.destroy,r!==null&&PS(r,s.deps)){o.memoizedState=Wc(e,n,i,r);return}}Bt.flags|=t,o.memoizedState=Wc(1|e,n,i,r)}function LT(t,e){return wf(8390656,8,t,e)}function NS(t,e){return tm(2048,8,t,e)}function mI(t,e){return tm(4,2,t,e)}function pI(t,e){return tm(4,4,t,e)}function wI(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function CI(t,e,n){return n=n!=null?n.concat([t]):null,tm(4,4,wI.bind(null,e,t),n)}function LS(){}function vI(t,e){var n=Br();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&PS(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function yI(t,e){var n=Br();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&PS(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function SI(t,e,n){return fl&21?(uo(n,e)||(n=EO(),Bt.lanes|=n,gl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,sr=!0),t.memoizedState=n)}function VF(t,e){var n=dt;dt=n!==0&&4>n?n:4,t(!0);var r=Fp.transition;Fp.transition={};try{t(!1),e()}finally{dt=n,Fp.transition=r}}function RI(){return Br().memoizedState}function BF(t,e,n){var r=fs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},bI(t))EI(e,n);else if(n=eI(t,e,n,r),n!==null){var o=Gn();ao(n,t,r,o),TI(n,e,r)}}function WF(t,e,n){var r=fs(t),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(bI(t))EI(e,o);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var s=e.lastRenderedState,l=i(s,n);if(o.hasEagerState=!0,o.eagerState=l,uo(l,s)){var a=e.interleaved;a===null?(o.next=o,_S(e)):(o.next=a.next,a.next=o),e.interleaved=o;return}}catch{}finally{}n=eI(t,e,o,r),n!==null&&(o=Gn(),ao(n,t,r,o),TI(n,e,r))}}function bI(t){var e=t.alternate;return t===Bt||e!==null&&e===Bt}function EI(t,e){uc=sg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function TI(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,gS(t,n)}}var lg={readContext:Vr,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useInsertionEffect:bn,useLayoutEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useMutableSource:bn,useSyncExternalStore:bn,useId:bn,unstable_isNewReconciler:!1},UF={readContext:Vr,useCallback:function(t,e){return Oo().memoizedState=[t,e===void 0?null:e],t},useContext:Vr,useEffect:LT,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,wf(4194308,4,wI.bind(null,e,t),n)},useLayoutEffect:function(t,e){return wf(4194308,4,t,e)},useInsertionEffect:function(t,e){return wf(4,2,t,e)},useMemo:function(t,e){var n=Oo();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Oo();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=BF.bind(null,Bt,t),[r.memoizedState,t]},useRef:function(t){var e=Oo();return t={current:t},e.memoizedState=t},useState:NT,useDebugValue:LS,useDeferredValue:function(t){return Oo().memoizedState=t},useTransition:function(){var t=NT(!1),e=t[0];return t=VF.bind(null,t[1]),Oo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Bt,o=Oo();if(Ht){if(n===void 0)throw Error(oe(407));n=n()}else{if(n=e(),fn===null)throw Error(oe(349));fl&30||uI(r,e,n)}o.memoizedState=n;var i={value:n,getSnapshot:e};return o.queue=i,LT(hI.bind(null,r,i,t),[t]),r.flags|=2048,Wc(9,cI.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Oo(),e=fn.identifierPrefix;if(Ht){var n=di,r=hi;n=(r&~(1<<32-lo(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Vc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=$F++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},zF={readContext:Vr,useCallback:vI,useContext:Vr,useEffect:NS,useImperativeHandle:CI,useInsertionEffect:mI,useLayoutEffect:pI,useMemo:yI,useReducer:$p,useRef:gI,useState:function(){return $p(Bc)},useDebugValue:LS,useDeferredValue:function(t){var e=Br();return SI(e,sn.memoizedState,t)},useTransition:function(){var t=$p(Bc)[0],e=Br().memoizedState;return[t,e]},useMutableSource:lI,useSyncExternalStore:aI,useId:RI,unstable_isNewReconciler:!1},jF={readContext:Vr,useCallback:vI,useContext:Vr,useEffect:NS,useImperativeHandle:CI,useInsertionEffect:mI,useLayoutEffect:pI,useMemo:yI,useReducer:Vp,useRef:gI,useState:function(){return Vp(Bc)},useDebugValue:LS,useDeferredValue:function(t){var e=Br();return sn===null?e.memoizedState=t:SI(e,sn.memoizedState,t)},useTransition:function(){var t=Vp(Bc)[0],e=Br().memoizedState;return[t,e]},useMutableSource:lI,useSyncExternalStore:aI,useId:RI,unstable_isNewReconciler:!1};function Va(t,e){try{var n="",r=e;do n+=vL(r),r=r.return;while(r);var o=n}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:o,digest:null}}function Bp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function kv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var YF=typeof WeakMap=="function"?WeakMap:Map;function MI(t,e,n){n=Ci(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ug||(ug=!0,zv=r),kv(t,e)},n}function xI(t,e,n){n=Ci(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var o=e.value;n.payload=function(){return r(o)},n.callback=function(){kv(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){kv(t,e),typeof r!="function"&&(ds===null?ds=new Set([this]):ds.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function FT(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new YF;var o=new Set;r.set(e,o)}else o=r.get(e),o===void 0&&(o=new Set,r.set(e,o));o.has(n)||(o.add(n),t=s$.bind(null,t,e,n),e.then(t,t))}function $T(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function VT(t,e,n,r,o){return t.mode&1?(t.flags|=65536,t.lanes=o,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ci(-1,1),e.tag=2,hs(n,e,1))),n.lanes|=1),t)}var GF=xi.ReactCurrentOwner,sr=!1;function Un(t,e,n,r){e.child=t===null?iI(e,null,n,r):Fa(e,t.child,n,r)}function BT(t,e,n,r,o){n=n.render;var i=e.ref;return _a(e,o),r=kS(t,e,n,r,i,o),n=DS(),t!==null&&!sr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,bi(t,e,o)):(Ht&&n&&RS(e),e.flags|=1,Un(t,e,r,o),e.child)}function WT(t,e,n,r,o){if(t===null){var i=n.type;return typeof i=="function"&&!jS(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,_I(t,e,i,r,o)):(t=Sf(n.type,null,r,e,e.mode,o),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&o)){var s=i.memoizedProps;if(n=n.compare,n=n!==null?n:kc,n(s,r)&&t.ref===e.ref)return bi(t,e,o)}return e.flags|=1,t=gs(i,r),t.ref=e.ref,t.return=e,e.child=t}function _I(t,e,n,r,o){if(t!==null){var i=t.memoizedProps;if(kc(i,r)&&t.ref===e.ref)if(sr=!1,e.pendingProps=r=i,(t.lanes&o)!==0)t.flags&131072&&(sr=!0);else return e.lanes=t.lanes,bi(t,e,o)}return Dv(t,e,n,r,o)}function OI(t,e,n){var r=e.pendingProps,o=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},St(wa,mr),mr|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,St(wa,mr),mr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,St(wa,mr),mr|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,St(wa,mr),mr|=r;return Un(t,e,o,n),e.child}function II(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Dv(t,e,n,r,o){var i=ar(n)?hl:Pn.current;return i=Na(e,i),_a(e,o),n=kS(t,e,n,r,i,o),r=DS(),t!==null&&!sr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,bi(t,e,o)):(Ht&&r&&RS(e),e.flags|=1,Un(t,e,n,o),e.child)}function UT(t,e,n,r,o){if(ar(n)){var i=!0;Jf(e)}else i=!1;if(_a(e,o),e.stateNode===null)Cf(t,e),rI(e,n,r),Pv(e,n,r,o),r=!0;else if(t===null){var s=e.stateNode,l=e.memoizedProps;s.props=l;var a=s.context,u=n.contextType;typeof u=="object"&&u!==null?u=Vr(u):(u=ar(n)?hl:Pn.current,u=Na(e,u));var c=n.getDerivedStateFromProps,h=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==r||a!==u)&&kT(e,s,r,u),Xi=!1;var f=e.memoizedState;s.state=f,og(e,r,s,o),a=e.memoizedState,l!==r||f!==a||lr.current||Xi?(typeof c=="function"&&(Hv(e,n,c,r),a=e.memoizedState),(l=Xi||PT(e,n,l,r,f,a,u))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),s.props=r,s.state=a,s.context=u,r=l):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,tI(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:eo(e.type,l),s.props=u,h=e.pendingProps,f=s.context,a=n.contextType,typeof a=="object"&&a!==null?a=Vr(a):(a=ar(n)?hl:Pn.current,a=Na(e,a));var g=n.getDerivedStateFromProps;(c=typeof g=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==h||f!==a)&&kT(e,s,r,a),Xi=!1,f=e.memoizedState,s.state=f,og(e,r,s,o);var p=e.memoizedState;l!==h||f!==p||lr.current||Xi?(typeof g=="function"&&(Hv(e,n,g,r),p=e.memoizedState),(u=Xi||PT(e,n,u,r,f,p,a)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,a),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,a)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),s.props=r,s.state=p,s.context=a,r=u):(typeof s.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Nv(t,e,n,r,i,o)}function Nv(t,e,n,r,o,i){II(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return o&&_T(e,n,!1),bi(t,e,i);r=e.stateNode,GF.current=e;var l=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=Fa(e,t.child,null,i),e.child=Fa(e,null,l,i)):Un(t,e,l,i),e.memoizedState=r.state,o&&_T(e,n,!0),e.child}function AI(t){var e=t.stateNode;e.pendingContext?xT(t,e.pendingContext,e.pendingContext!==e.context):e.context&&xT(t,e.context,!1),IS(t,e.containerInfo)}function zT(t,e,n,r,o){return La(),ES(o),e.flags|=256,Un(t,e,n,r),e.child}var Lv={dehydrated:null,treeContext:null,retryLane:0};function Fv(t){return{baseLanes:t,cachePool:null,transitions:null}}function HI(t,e,n){var r=e.pendingProps,o=Lt.current,i=!1,s=(e.flags&128)!==0,l;if((l=s)||(l=t!==null&&t.memoizedState===null?!1:(o&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(o|=1),St(Lt,o&1),t===null)return Iv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,i?(r=e.mode,i=e.child,s={mode:"hidden",children:s},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=om(s,r,0,null),t=ul(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Fv(n),e.memoizedState=Lv,t):FS(e,s));if(o=t.memoizedState,o!==null&&(l=o.dehydrated,l!==null))return KF(t,e,s,r,l,o,n);if(i){i=r.fallback,s=e.mode,o=t.child,l=o.sibling;var a={mode:"hidden",children:r.children};return!(s&1)&&e.child!==o?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=gs(o,a),r.subtreeFlags=o.subtreeFlags&14680064),l!==null?i=gs(l,i):(i=ul(i,s,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,s=t.child.memoizedState,s=s===null?Fv(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=t.childLanes&~n,e.memoizedState=Lv,r}return i=t.child,t=i.sibling,r=gs(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function FS(t,e){return e=om({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ed(t,e,n,r){return r!==null&&ES(r),Fa(e,t.child,null,n),t=FS(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function KF(t,e,n,r,o,i,s){if(n)return e.flags&256?(e.flags&=-257,r=Bp(Error(oe(422))),ed(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,o=e.mode,r=om({mode:"visible",children:r.children},o,0,null),i=ul(i,o,s,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Fa(e,t.child,null,s),e.child.memoizedState=Fv(s),e.memoizedState=Lv,i);if(!(e.mode&1))return ed(t,e,s,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(oe(419)),r=Bp(i,r,void 0),ed(t,e,s,r)}if(l=(s&t.childLanes)!==0,sr||l){if(r=fn,r!==null){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|s)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,Ri(t,o),ao(r,t,o,-1))}return zS(),r=Bp(Error(oe(421))),ed(t,e,s,r)}return o.data==="$?"?(e.flags|=128,e.child=t.child,e=l$.bind(null,t),o._reactRetry=e,null):(t=i.treeContext,Cr=cs(o.nextSibling),yr=e,Ht=!0,no=null,t!==null&&(kr[Dr++]=hi,kr[Dr++]=di,kr[Dr++]=dl,hi=t.id,di=t.overflow,dl=e),e=FS(e,r.children),e.flags|=4096,e)}function jT(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Av(t.return,e,n)}function Wp(t,e,n,r,o){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function PI(t,e,n){var r=e.pendingProps,o=r.revealOrder,i=r.tail;if(Un(t,e,r.children,n),r=Lt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&jT(t,n,e);else if(t.tag===19)jT(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(St(Lt,r),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;n!==null;)t=n.alternate,t!==null&&ig(t)===null&&(o=n),n=n.sibling;n=o,n===null?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),Wp(e,!1,o,n,i);break;case"backwards":for(n=null,o=e.child,e.child=null;o!==null;){if(t=o.alternate,t!==null&&ig(t)===null){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}Wp(e,!0,n,null,i);break;case"together":Wp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Cf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function bi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),gl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(oe(153));if(e.child!==null){for(t=e.child,n=gs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=gs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function XF(t,e,n){switch(e.tag){case 3:AI(e),La();break;case 5:sI(e);break;case 1:ar(e.type)&&Jf(e);break;case 4:IS(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,o=e.memoizedProps.value;St(ng,r._currentValue),r._currentValue=o;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(St(Lt,Lt.current&1),e.flags|=128,null):n&e.child.childLanes?HI(t,e,n):(St(Lt,Lt.current&1),t=bi(t,e,n),t!==null?t.sibling:null);St(Lt,Lt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return PI(t,e,n);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),St(Lt,Lt.current),r)break;return null;case 22:case 23:return e.lanes=0,OI(t,e,n)}return bi(t,e,n)}var kI,$v,DI,NI;kI=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};$v=function(){};DI=function(t,e,n,r){var o=t.memoizedProps;if(o!==r){t=e.stateNode,rl(Fo.current);var i=null;switch(n){case"input":o=lv(t,o),r=lv(t,r),i=[];break;case"select":o=Wt({},o,{value:void 0}),r=Wt({},r,{value:void 0}),i=[];break;case"textarea":o=cv(t,o),r=cv(t,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Qf)}dv(n,r);var s;n=null;for(u in o)if(!r.hasOwnProperty(u)&&o.hasOwnProperty(u)&&o[u]!=null)if(u==="style"){var l=o[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(xc.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var a=r[u];if(l=o!=null?o[u]:void 0,r.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(s in l)!l.hasOwnProperty(s)||a&&a.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in a)a.hasOwnProperty(s)&&l[s]!==a[s]&&(n||(n={}),n[s]=a[s])}else n||(i||(i=[]),i.push(u,n)),n=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(i=i||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(i=i||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(xc.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&Tt("scroll",t),i||l===a||(i=[])):(i=i||[]).push(u,a))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};NI=function(t,e,n,r){n!==r&&(e.flags|=4)};function wu(t,e){if(!Ht)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function En(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=t,o=o.sibling;else for(o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=t,o=o.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function qF(t,e,n){var r=e.pendingProps;switch(bS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return En(e),null;case 1:return ar(e.type)&&Zf(),En(e),null;case 3:return r=e.stateNode,$a(),xt(lr),xt(Pn),HS(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Zh(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,no!==null&&(Gv(no),no=null))),$v(t,e),En(e),null;case 5:AS(e);var o=rl($c.current);if(n=e.type,t!==null&&e.stateNode!=null)DI(t,e,n,r,o),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(oe(166));return En(e),null}if(t=rl(Fo.current),Zh(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Po]=e,r[Lc]=i,t=(e.mode&1)!==0,n){case"dialog":Tt("cancel",r),Tt("close",r);break;case"iframe":case"object":case"embed":Tt("load",r);break;case"video":case"audio":for(o=0;o<Xu.length;o++)Tt(Xu[o],r);break;case"source":Tt("error",r);break;case"img":case"image":case"link":Tt("error",r),Tt("load",r);break;case"details":Tt("toggle",r);break;case"input":eT(r,i),Tt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Tt("invalid",r);break;case"textarea":nT(r,i),Tt("invalid",r)}dv(n,i),o=null;for(var s in i)if(i.hasOwnProperty(s)){var l=i[s];s==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Qh(r.textContent,l,t),o=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Qh(r.textContent,l,t),o=["children",""+l]):xc.hasOwnProperty(s)&&l!=null&&s==="onScroll"&&Tt("scroll",r)}switch(n){case"input":Uh(r),tT(r,i,!0);break;case"textarea":Uh(r),rT(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Qf)}r=o,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=o.nodeType===9?o:o.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=uO(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[Po]=e,t[Lc]=r,kI(t,e,!1,!1),e.stateNode=t;e:{switch(s=fv(n,r),n){case"dialog":Tt("cancel",t),Tt("close",t),o=r;break;case"iframe":case"object":case"embed":Tt("load",t),o=r;break;case"video":case"audio":for(o=0;o<Xu.length;o++)Tt(Xu[o],t);o=r;break;case"source":Tt("error",t),o=r;break;case"img":case"image":case"link":Tt("error",t),Tt("load",t),o=r;break;case"details":Tt("toggle",t),o=r;break;case"input":eT(t,r),o=lv(t,r),Tt("invalid",t);break;case"option":o=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},o=Wt({},r,{value:void 0}),Tt("invalid",t);break;case"textarea":nT(t,r),o=cv(t,r),Tt("invalid",t);break;default:o=r}dv(n,o),l=o;for(i in l)if(l.hasOwnProperty(i)){var a=l[i];i==="style"?dO(t,a):i==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&cO(t,a)):i==="children"?typeof a=="string"?(n!=="textarea"||a!=="")&&_c(t,a):typeof a=="number"&&_c(t,""+a):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(xc.hasOwnProperty(i)?a!=null&&i==="onScroll"&&Tt("scroll",t):a!=null&&aS(t,i,a,s))}switch(n){case"input":Uh(t),tT(t,r,!1);break;case"textarea":Uh(t),rT(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Rs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ea(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ea(t,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(t.onclick=Qf)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return En(e),null;case 6:if(t&&e.stateNode!=null)NI(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(oe(166));if(n=rl($c.current),rl(Fo.current),Zh(e)){if(r=e.stateNode,n=e.memoizedProps,r[Po]=e,(i=r.nodeValue!==n)&&(t=yr,t!==null))switch(t.tag){case 3:Qh(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Qh(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Po]=e,e.stateNode=r}return En(e),null;case 13:if(xt(Lt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ht&&Cr!==null&&e.mode&1&&!(e.flags&128))JO(),La(),e.flags|=98560,i=!1;else if(i=Zh(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(oe(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(oe(317));i[Po]=e}else La(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;En(e),i=!1}else no!==null&&(Gv(no),no=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Lt.current&1?ln===0&&(ln=3):zS())),e.updateQueue!==null&&(e.flags|=4),En(e),null);case 4:return $a(),$v(t,e),t===null&&Dc(e.stateNode.containerInfo),En(e),null;case 10:return xS(e.type._context),En(e),null;case 17:return ar(e.type)&&Zf(),En(e),null;case 19:if(xt(Lt),i=e.memoizedState,i===null)return En(e),null;if(r=(e.flags&128)!==0,s=i.rendering,s===null)if(r)wu(i,!1);else{if(ln!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=ig(t),s!==null){for(e.flags|=128,wu(i,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,t=s.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return St(Lt,Lt.current&1|2),e.child}t=t.sibling}i.tail!==null&&qt()>Ba&&(e.flags|=128,r=!0,wu(i,!1),e.lanes=4194304)}else{if(!r)if(t=ig(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),wu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!Ht)return En(e),null}else 2*qt()-i.renderingStartTime>Ba&&n!==1073741824&&(e.flags|=128,r=!0,wu(i,!1),e.lanes=4194304);i.isBackwards?(s.sibling=e.child,e.child=s):(n=i.last,n!==null?n.sibling=s:e.child=s,i.last=s)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=qt(),e.sibling=null,n=Lt.current,St(Lt,r?n&1|2:n&1),e):(En(e),null);case 22:case 23:return US(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?mr&1073741824&&(En(e),e.subtreeFlags&6&&(e.flags|=8192)):En(e),null;case 24:return null;case 25:return null}throw Error(oe(156,e.tag))}function QF(t,e){switch(bS(e),e.tag){case 1:return ar(e.type)&&Zf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return $a(),xt(lr),xt(Pn),HS(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return AS(e),null;case 13:if(xt(Lt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(oe(340));La()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return xt(Lt),null;case 4:return $a(),null;case 10:return xS(e.type._context),null;case 22:case 23:return US(),null;case 24:return null;default:return null}}var td=!1,On=!1,ZF=typeof WeakSet=="function"?WeakSet:Set,ve=null;function pa(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Yt(t,e,r)}else n.current=null}function Vv(t,e,n){try{n()}catch(r){Yt(t,e,r)}}var YT=!1;function JF(t,e){if(bv=Kf,t=VO(),SS(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var s=0,l=-1,a=-1,u=0,c=0,h=t,f=null;t:for(;;){for(var g;h!==n||o!==0&&h.nodeType!==3||(l=s+o),h!==i||r!==0&&h.nodeType!==3||(a=s+r),h.nodeType===3&&(s+=h.nodeValue.length),(g=h.firstChild)!==null;)f=h,h=g;for(;;){if(h===t)break t;if(f===n&&++u===o&&(l=s),f===i&&++c===r&&(a=s),(g=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=g}n=l===-1||a===-1?null:{start:l,end:a}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ev={focusedElem:t,selectionRange:n},Kf=!1,ve=e;ve!==null;)if(e=ve,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ve=t;else for(;ve!==null;){e=ve;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var y=p.memoizedProps,E=p.memoizedState,w=e.stateNode,C=w.getSnapshotBeforeUpdate(e.elementType===e.type?y:eo(e.type,y),E);w.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(T){Yt(e,e.return,T)}if(t=e.sibling,t!==null){t.return=e.return,ve=t;break}ve=e.return}return p=YT,YT=!1,p}function cc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&t)===t){var i=o.destroy;o.destroy=void 0,i!==void 0&&Vv(e,n,i)}o=o.next}while(o!==r)}}function nm(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Bv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function LI(t){var e=t.alternate;e!==null&&(t.alternate=null,LI(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Po],delete e[Lc],delete e[xv],delete e[DF],delete e[NF])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function FI(t){return t.tag===5||t.tag===3||t.tag===4}function GT(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||FI(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Wv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Qf));else if(r!==4&&(t=t.child,t!==null))for(Wv(t,e,n),t=t.sibling;t!==null;)Wv(t,e,n),t=t.sibling}function Uv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Uv(t,e,n),t=t.sibling;t!==null;)Uv(t,e,n),t=t.sibling}var Cn=null,to=!1;function Di(t,e,n){for(n=n.child;n!==null;)$I(t,e,n),n=n.sibling}function $I(t,e,n){if(Lo&&typeof Lo.onCommitFiberUnmount=="function")try{Lo.onCommitFiberUnmount(Kg,n)}catch{}switch(n.tag){case 5:On||pa(n,e);case 6:var r=Cn,o=to;Cn=null,Di(t,e,n),Cn=r,to=o,Cn!==null&&(to?(t=Cn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Cn.removeChild(n.stateNode));break;case 18:Cn!==null&&(to?(t=Cn,n=n.stateNode,t.nodeType===8?Dp(t.parentNode,n):t.nodeType===1&&Dp(t,n),Hc(t)):Dp(Cn,n.stateNode));break;case 4:r=Cn,o=to,Cn=n.stateNode.containerInfo,to=!0,Di(t,e,n),Cn=r,to=o;break;case 0:case 11:case 14:case 15:if(!On&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&Vv(n,e,s),o=o.next}while(o!==r)}Di(t,e,n);break;case 1:if(!On&&(pa(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Yt(n,e,l)}Di(t,e,n);break;case 21:Di(t,e,n);break;case 22:n.mode&1?(On=(r=On)||n.memoizedState!==null,Di(t,e,n),On=r):Di(t,e,n);break;default:Di(t,e,n)}}function KT(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ZF),e.forEach(function(r){var o=a$.bind(null,t,r);n.has(r)||(n.add(r),r.then(o,o))})}}function Yr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var i=t,s=e,l=s;e:for(;l!==null;){switch(l.tag){case 5:Cn=l.stateNode,to=!1;break e;case 3:Cn=l.stateNode.containerInfo,to=!0;break e;case 4:Cn=l.stateNode.containerInfo,to=!0;break e}l=l.return}if(Cn===null)throw Error(oe(160));$I(i,s,o),Cn=null,to=!1;var a=o.alternate;a!==null&&(a.return=null),o.return=null}catch(u){Yt(o,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)VI(e,t),e=e.sibling}function VI(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Yr(e,t),wo(t),r&4){try{cc(3,t,t.return),nm(3,t)}catch(y){Yt(t,t.return,y)}try{cc(5,t,t.return)}catch(y){Yt(t,t.return,y)}}break;case 1:Yr(e,t),wo(t),r&512&&n!==null&&pa(n,n.return);break;case 5:if(Yr(e,t),wo(t),r&512&&n!==null&&pa(n,n.return),t.flags&32){var o=t.stateNode;try{_c(o,"")}catch(y){Yt(t,t.return,y)}}if(r&4&&(o=t.stateNode,o!=null)){var i=t.memoizedProps,s=n!==null?n.memoizedProps:i,l=t.type,a=t.updateQueue;if(t.updateQueue=null,a!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&lO(o,i),fv(l,s);var u=fv(l,i);for(s=0;s<a.length;s+=2){var c=a[s],h=a[s+1];c==="style"?dO(o,h):c==="dangerouslySetInnerHTML"?cO(o,h):c==="children"?_c(o,h):aS(o,c,h,u)}switch(l){case"input":av(o,i);break;case"textarea":aO(o,i);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?Ea(o,!!i.multiple,g,!1):f!==!!i.multiple&&(i.defaultValue!=null?Ea(o,!!i.multiple,i.defaultValue,!0):Ea(o,!!i.multiple,i.multiple?[]:"",!1))}o[Lc]=i}catch(y){Yt(t,t.return,y)}}break;case 6:if(Yr(e,t),wo(t),r&4){if(t.stateNode===null)throw Error(oe(162));o=t.stateNode,i=t.memoizedProps;try{o.nodeValue=i}catch(y){Yt(t,t.return,y)}}break;case 3:if(Yr(e,t),wo(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Hc(e.containerInfo)}catch(y){Yt(t,t.return,y)}break;case 4:Yr(e,t),wo(t);break;case 13:Yr(e,t),wo(t),o=t.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(BS=qt())),r&4&&KT(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(On=(u=On)||c,Yr(e,t),On=u):Yr(e,t),wo(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(ve=t,c=t.child;c!==null;){for(h=ve=c;ve!==null;){switch(f=ve,g=f.child,f.tag){case 0:case 11:case 14:case 15:cc(4,f,f.return);break;case 1:pa(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(y){Yt(r,n,y)}}break;case 5:pa(f,f.return);break;case 22:if(f.memoizedState!==null){qT(h);continue}}g!==null?(g.return=f,ve=g):qT(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{o=h.stateNode,u?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,a=h.memoizedProps.style,s=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=hO("display",s))}catch(y){Yt(t,t.return,y)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(y){Yt(t,t.return,y)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Yr(e,t),wo(t),r&4&&KT(t);break;case 21:break;default:Yr(e,t),wo(t)}}function wo(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(FI(n)){var r=n;break e}n=n.return}throw Error(oe(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(_c(o,""),r.flags&=-33);var i=GT(t);Uv(t,i,o);break;case 3:case 4:var s=r.stateNode.containerInfo,l=GT(t);Wv(t,l,s);break;default:throw Error(oe(161))}}catch(a){Yt(t,t.return,a)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function e$(t,e,n){ve=t,BI(t)}function BI(t,e,n){for(var r=(t.mode&1)!==0;ve!==null;){var o=ve,i=o.child;if(o.tag===22&&r){var s=o.memoizedState!==null||td;if(!s){var l=o.alternate,a=l!==null&&l.memoizedState!==null||On;l=td;var u=On;if(td=s,(On=a)&&!u)for(ve=o;ve!==null;)s=ve,a=s.child,s.tag===22&&s.memoizedState!==null?QT(o):a!==null?(a.return=s,ve=a):QT(o);for(;i!==null;)ve=i,BI(i),i=i.sibling;ve=o,td=l,On=u}XT(t)}else o.subtreeFlags&8772&&i!==null?(i.return=o,ve=i):XT(t)}}function XT(t){for(;ve!==null;){var e=ve;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:On||nm(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!On)if(n===null)r.componentDidMount();else{var o=e.elementType===e.type?n.memoizedProps:eo(e.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&HT(e,i,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}HT(e,s,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break;case"img":a.src&&(n.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Hc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}On||e.flags&512&&Bv(e)}catch(f){Yt(e,e.return,f)}}if(e===t){ve=null;break}if(n=e.sibling,n!==null){n.return=e.return,ve=n;break}ve=e.return}}function qT(t){for(;ve!==null;){var e=ve;if(e===t){ve=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ve=n;break}ve=e.return}}function QT(t){for(;ve!==null;){var e=ve;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{nm(4,e)}catch(a){Yt(e,n,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var o=e.return;try{r.componentDidMount()}catch(a){Yt(e,o,a)}}var i=e.return;try{Bv(e)}catch(a){Yt(e,i,a)}break;case 5:var s=e.return;try{Bv(e)}catch(a){Yt(e,s,a)}}}catch(a){Yt(e,e.return,a)}if(e===t){ve=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ve=l;break}ve=e.return}}var t$=Math.ceil,ag=xi.ReactCurrentDispatcher,$S=xi.ReactCurrentOwner,$r=xi.ReactCurrentBatchConfig,rt=0,fn=null,nn=null,vn=0,mr=0,wa=Os(0),ln=0,Uc=null,gl=0,rm=0,VS=0,hc=null,ir=null,BS=0,Ba=1/0,si=null,ug=!1,zv=null,ds=null,nd=!1,ns=null,cg=0,dc=0,jv=null,vf=-1,yf=0;function Gn(){return rt&6?qt():vf!==-1?vf:vf=qt()}function fs(t){return t.mode&1?rt&2&&vn!==0?vn&-vn:FF.transition!==null?(yf===0&&(yf=EO()),yf):(t=dt,t!==0||(t=window.event,t=t===void 0?16:AO(t.type)),t):1}function ao(t,e,n,r){if(50<dc)throw dc=0,jv=null,Error(oe(185));hh(t,n,r),(!(rt&2)||t!==fn)&&(t===fn&&(!(rt&2)&&(rm|=n),ln===4&&Zi(t,vn)),ur(t,r),n===1&&rt===0&&!(e.mode&1)&&(Ba=qt()+500,Jg&&Is()))}function ur(t,e){var n=t.callbackNode;FL(t,e);var r=Gf(t,t===fn?vn:0);if(r===0)n!==null&&sT(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&sT(n),e===1)t.tag===0?LF(ZT.bind(null,t)):qO(ZT.bind(null,t)),PF(function(){!(rt&6)&&Is()}),n=null;else{switch(TO(r)){case 1:n=fS;break;case 4:n=RO;break;case 16:n=Yf;break;case 536870912:n=bO;break;default:n=Yf}n=XI(n,WI.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function WI(t,e){if(vf=-1,yf=0,rt&6)throw Error(oe(327));var n=t.callbackNode;if(Oa()&&t.callbackNode!==n)return null;var r=Gf(t,t===fn?vn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=hg(t,r);else{e=r;var o=rt;rt|=2;var i=zI();(fn!==t||vn!==e)&&(si=null,Ba=qt()+500,al(t,e));do try{o$();break}catch(l){UI(t,l)}while(1);MS(),ag.current=i,rt=o,nn!==null?e=0:(fn=null,vn=0,e=ln)}if(e!==0){if(e===2&&(o=Cv(t),o!==0&&(r=o,e=Yv(t,o))),e===1)throw n=Uc,al(t,0),Zi(t,r),ur(t,qt()),n;if(e===6)Zi(t,r);else{if(o=t.current.alternate,!(r&30)&&!n$(o)&&(e=hg(t,r),e===2&&(i=Cv(t),i!==0&&(r=i,e=Yv(t,i))),e===1))throw n=Uc,al(t,0),Zi(t,r),ur(t,qt()),n;switch(t.finishedWork=o,t.finishedLanes=r,e){case 0:case 1:throw Error(oe(345));case 2:Js(t,ir,si);break;case 3:if(Zi(t,r),(r&130023424)===r&&(e=BS+500-qt(),10<e)){if(Gf(t,0)!==0)break;if(o=t.suspendedLanes,(o&r)!==r){Gn(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=Mv(Js.bind(null,t,ir,si),e);break}Js(t,ir,si);break;case 4:if(Zi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,o=-1;0<r;){var s=31-lo(r);i=1<<s,s=e[s],s>o&&(o=s),r&=~i}if(r=o,r=qt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*t$(r/1960))-r,10<r){t.timeoutHandle=Mv(Js.bind(null,t,ir,si),r);break}Js(t,ir,si);break;case 5:Js(t,ir,si);break;default:throw Error(oe(329))}}}return ur(t,qt()),t.callbackNode===n?WI.bind(null,t):null}function Yv(t,e){var n=hc;return t.current.memoizedState.isDehydrated&&(al(t,e).flags|=256),t=hg(t,e),t!==2&&(e=ir,ir=n,e!==null&&Gv(e)),t}function Gv(t){ir===null?ir=t:ir.push.apply(ir,t)}function n$(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!uo(i(),o))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zi(t,e){for(e&=~VS,e&=~rm,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-lo(e),r=1<<n;t[n]=-1,e&=~r}}function ZT(t){if(rt&6)throw Error(oe(327));Oa();var e=Gf(t,0);if(!(e&1))return ur(t,qt()),null;var n=hg(t,e);if(t.tag!==0&&n===2){var r=Cv(t);r!==0&&(e=r,n=Yv(t,r))}if(n===1)throw n=Uc,al(t,0),Zi(t,e),ur(t,qt()),n;if(n===6)throw Error(oe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Js(t,ir,si),ur(t,qt()),null}function WS(t,e){var n=rt;rt|=1;try{return t(e)}finally{rt=n,rt===0&&(Ba=qt()+500,Jg&&Is())}}function ml(t){ns!==null&&ns.tag===0&&!(rt&6)&&Oa();var e=rt;rt|=1;var n=$r.transition,r=dt;try{if($r.transition=null,dt=1,t)return t()}finally{dt=r,$r.transition=n,rt=e,!(rt&6)&&Is()}}function US(){mr=wa.current,xt(wa)}function al(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,HF(n)),nn!==null)for(n=nn.return;n!==null;){var r=n;switch(bS(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Zf();break;case 3:$a(),xt(lr),xt(Pn),HS();break;case 5:AS(r);break;case 4:$a();break;case 13:xt(Lt);break;case 19:xt(Lt);break;case 10:xS(r.type._context);break;case 22:case 23:US()}n=n.return}if(fn=t,nn=t=gs(t.current,null),vn=mr=e,ln=0,Uc=null,VS=rm=gl=0,ir=hc=null,nl!==null){for(e=0;e<nl.length;e++)if(n=nl[e],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,i=n.pending;if(i!==null){var s=i.next;i.next=o,r.next=s}n.pending=r}nl=null}return t}function UI(t,e){do{var n=nn;try{if(MS(),pf.current=lg,sg){for(var r=Bt.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}sg=!1}if(fl=0,dn=sn=Bt=null,uc=!1,Vc=0,$S.current=null,n===null||n.return===null){ln=1,Uc=e,nn=null;break}e:{var i=t,s=n.return,l=n,a=e;if(e=vn,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,c=l,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var g=$T(s);if(g!==null){g.flags&=-257,VT(g,s,l,i,e),g.mode&1&&FT(i,u,e),e=g,a=u;var p=e.updateQueue;if(p===null){var y=new Set;y.add(a),e.updateQueue=y}else p.add(a);break e}else{if(!(e&1)){FT(i,u,e),zS();break e}a=Error(oe(426))}}else if(Ht&&l.mode&1){var E=$T(s);if(E!==null){!(E.flags&65536)&&(E.flags|=256),VT(E,s,l,i,e),ES(Va(a,l));break e}}i=a=Va(a,l),ln!==4&&(ln=2),hc===null?hc=[i]:hc.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=MI(i,a,e);AT(i,w);break e;case 1:l=a;var C=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof C.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(ds===null||!ds.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var T=xI(i,l,e);AT(i,T);break e}}i=i.return}while(i!==null)}YI(n)}catch(x){e=x,nn===n&&n!==null&&(nn=n=n.return);continue}break}while(1)}function zI(){var t=ag.current;return ag.current=lg,t===null?lg:t}function zS(){(ln===0||ln===3||ln===2)&&(ln=4),fn===null||!(gl&268435455)&&!(rm&268435455)||Zi(fn,vn)}function hg(t,e){var n=rt;rt|=2;var r=zI();(fn!==t||vn!==e)&&(si=null,al(t,e));do try{r$();break}catch(o){UI(t,o)}while(1);if(MS(),rt=n,ag.current=r,nn!==null)throw Error(oe(261));return fn=null,vn=0,ln}function r$(){for(;nn!==null;)jI(nn)}function o$(){for(;nn!==null&&!OL();)jI(nn)}function jI(t){var e=KI(t.alternate,t,mr);t.memoizedProps=t.pendingProps,e===null?YI(t):nn=e,$S.current=null}function YI(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=QF(n,e),n!==null){n.flags&=32767,nn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ln=6,nn=null;return}}else if(n=qF(n,e,mr),n!==null){nn=n;return}if(e=e.sibling,e!==null){nn=e;return}nn=e=t}while(e!==null);ln===0&&(ln=5)}function Js(t,e,n){var r=dt,o=$r.transition;try{$r.transition=null,dt=1,i$(t,e,n,r)}finally{$r.transition=o,dt=r}return null}function i$(t,e,n,r){do Oa();while(ns!==null);if(rt&6)throw Error(oe(327));n=t.finishedWork;var o=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(oe(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if($L(t,i),t===fn&&(nn=fn=null,vn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||nd||(nd=!0,XI(Yf,function(){return Oa(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=$r.transition,$r.transition=null;var s=dt;dt=1;var l=rt;rt|=4,$S.current=null,JF(t,n),VI(n,t),TF(Ev),Kf=!!bv,Ev=bv=null,t.current=n,e$(n),IL(),rt=l,dt=s,$r.transition=i}else t.current=n;if(nd&&(nd=!1,ns=t,cg=o),i=t.pendingLanes,i===0&&(ds=null),PL(n.stateNode),ur(t,qt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)o=e[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(ug)throw ug=!1,t=zv,zv=null,t;return cg&1&&t.tag!==0&&Oa(),i=t.pendingLanes,i&1?t===jv?dc++:(dc=0,jv=t):dc=0,Is(),null}function Oa(){if(ns!==null){var t=TO(cg),e=$r.transition,n=dt;try{if($r.transition=null,dt=16>t?16:t,ns===null)var r=!1;else{if(t=ns,ns=null,cg=0,rt&6)throw Error(oe(331));var o=rt;for(rt|=4,ve=t.current;ve!==null;){var i=ve,s=i.child;if(ve.flags&16){var l=i.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(ve=u;ve!==null;){var c=ve;switch(c.tag){case 0:case 11:case 15:cc(8,c,i)}var h=c.child;if(h!==null)h.return=c,ve=h;else for(;ve!==null;){c=ve;var f=c.sibling,g=c.return;if(LI(c),c===u){ve=null;break}if(f!==null){f.return=g,ve=f;break}ve=g}}}var p=i.alternate;if(p!==null){var y=p.child;if(y!==null){p.child=null;do{var E=y.sibling;y.sibling=null,y=E}while(y!==null)}}ve=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,ve=s;else e:for(;ve!==null;){if(i=ve,i.flags&2048)switch(i.tag){case 0:case 11:case 15:cc(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,ve=w;break e}ve=i.return}}var C=t.current;for(ve=C;ve!==null;){s=ve;var S=s.child;if(s.subtreeFlags&2064&&S!==null)S.return=s,ve=S;else e:for(s=C;ve!==null;){if(l=ve,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:nm(9,l)}}catch(x){Yt(l,l.return,x)}if(l===s){ve=null;break e}var T=l.sibling;if(T!==null){T.return=l.return,ve=T;break e}ve=l.return}}if(rt=o,Is(),Lo&&typeof Lo.onPostCommitFiberRoot=="function")try{Lo.onPostCommitFiberRoot(Kg,t)}catch{}r=!0}return r}finally{dt=n,$r.transition=e}}return!1}function JT(t,e,n){e=Va(n,e),e=MI(t,e,1),t=hs(t,e,1),e=Gn(),t!==null&&(hh(t,1,e),ur(t,e))}function Yt(t,e,n){if(t.tag===3)JT(t,t,n);else for(;e!==null;){if(e.tag===3){JT(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ds===null||!ds.has(r))){t=Va(n,t),t=xI(e,t,1),e=hs(e,t,1),t=Gn(),e!==null&&(hh(e,1,t),ur(e,t));break}}e=e.return}}function s$(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Gn(),t.pingedLanes|=t.suspendedLanes&n,fn===t&&(vn&n)===n&&(ln===4||ln===3&&(vn&130023424)===vn&&500>qt()-BS?al(t,0):VS|=n),ur(t,e)}function GI(t,e){e===0&&(t.mode&1?(e=Yh,Yh<<=1,!(Yh&130023424)&&(Yh=4194304)):e=1);var n=Gn();t=Ri(t,e),t!==null&&(hh(t,e,n),ur(t,n))}function l$(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),GI(t,n)}function a$(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,o=t.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(oe(314))}r!==null&&r.delete(e),GI(t,n)}var KI;KI=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||lr.current)sr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return sr=!1,XF(t,e,n);sr=!!(t.flags&131072)}else sr=!1,Ht&&e.flags&1048576&&QO(e,tg,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Cf(t,e),t=e.pendingProps;var o=Na(e,Pn.current);_a(e,n),o=kS(null,e,r,t,o,n);var i=DS();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ar(r)?(i=!0,Jf(e)):i=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,OS(e),o.updater=em,e.stateNode=o,o._reactInternals=e,Pv(e,r,t,n),e=Nv(null,e,r,!0,i,n)):(e.tag=0,Ht&&i&&RS(e),Un(null,e,o,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Cf(t,e),t=e.pendingProps,o=r._init,r=o(r._payload),e.type=r,o=e.tag=c$(r),t=eo(r,t),o){case 0:e=Dv(null,e,r,t,n);break e;case 1:e=UT(null,e,r,t,n);break e;case 11:e=BT(null,e,r,t,n);break e;case 14:e=WT(null,e,r,eo(r.type,t),n);break e}throw Error(oe(306,r,""))}return e;case 0:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:eo(r,o),Dv(t,e,r,o,n);case 1:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:eo(r,o),UT(t,e,r,o,n);case 3:e:{if(AI(e),t===null)throw Error(oe(387));r=e.pendingProps,i=e.memoizedState,o=i.element,tI(t,e),og(e,r,null,n);var s=e.memoizedState;if(r=s.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){o=Va(Error(oe(423)),e),e=zT(t,e,r,n,o);break e}else if(r!==o){o=Va(Error(oe(424)),e),e=zT(t,e,r,n,o);break e}else for(Cr=cs(e.stateNode.containerInfo.firstChild),yr=e,Ht=!0,no=null,n=iI(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(La(),r===o){e=bi(t,e,n);break e}Un(t,e,r,n)}e=e.child}return e;case 5:return sI(e),t===null&&Iv(e),r=e.type,o=e.pendingProps,i=t!==null?t.memoizedProps:null,s=o.children,Tv(r,o)?s=null:i!==null&&Tv(r,i)&&(e.flags|=32),II(t,e),Un(t,e,s,n),e.child;case 6:return t===null&&Iv(e),null;case 13:return HI(t,e,n);case 4:return IS(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Fa(e,null,r,n):Un(t,e,r,n),e.child;case 11:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:eo(r,o),BT(t,e,r,o,n);case 7:return Un(t,e,e.pendingProps,n),e.child;case 8:return Un(t,e,e.pendingProps.children,n),e.child;case 12:return Un(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,o=e.pendingProps,i=e.memoizedProps,s=o.value,St(ng,r._currentValue),r._currentValue=s,i!==null)if(uo(i.value,s)){if(i.children===o.children&&!lr.current){e=bi(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){s=i.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(i.tag===1){a=Ci(-1,n&-n),a.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?a.next=a:(a.next=c.next,c.next=a),u.pending=a}}i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),Av(i.return,n,e),l.lanes|=n;break}a=a.next}}else if(i.tag===10)s=i.type===e.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(oe(341));s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Av(s,n,e),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===e){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Un(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,r=e.pendingProps.children,_a(e,n),o=Vr(o),r=r(o),e.flags|=1,Un(t,e,r,n),e.child;case 14:return r=e.type,o=eo(r,e.pendingProps),o=eo(r.type,o),WT(t,e,r,o,n);case 15:return _I(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:eo(r,o),Cf(t,e),e.tag=1,ar(r)?(t=!0,Jf(e)):t=!1,_a(e,n),rI(e,r,o),Pv(e,r,o,n),Nv(null,e,r,!0,t,n);case 19:return PI(t,e,n);case 22:return OI(t,e,n)}throw Error(oe(156,e.tag))};function XI(t,e){return SO(t,e)}function u$(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lr(t,e,n,r){return new u$(t,e,n,r)}function jS(t){return t=t.prototype,!(!t||!t.isReactComponent)}function c$(t){if(typeof t=="function")return jS(t)?1:0;if(t!=null){if(t=t.$$typeof,t===cS)return 11;if(t===hS)return 14}return 2}function gs(t,e){var n=t.alternate;return n===null?(n=Lr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Sf(t,e,n,r,o,i){var s=2;if(r=t,typeof t=="function")jS(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case la:return ul(n.children,o,i,e);case uS:s=8,o|=8;break;case rv:return t=Lr(12,n,e,o|2),t.elementType=rv,t.lanes=i,t;case ov:return t=Lr(13,n,e,o),t.elementType=ov,t.lanes=i,t;case iv:return t=Lr(19,n,e,o),t.elementType=iv,t.lanes=i,t;case oO:return om(n,o,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case nO:s=10;break e;case rO:s=9;break e;case cS:s=11;break e;case hS:s=14;break e;case Ki:s=16,r=null;break e}throw Error(oe(130,t==null?t:typeof t,""))}return e=Lr(s,n,e,o),e.elementType=t,e.type=r,e.lanes=i,e}function ul(t,e,n,r){return t=Lr(7,t,r,e),t.lanes=n,t}function om(t,e,n,r){return t=Lr(22,t,r,e),t.elementType=oO,t.lanes=n,t.stateNode={isHidden:!1},t}function Up(t,e,n){return t=Lr(6,t,null,e),t.lanes=n,t}function zp(t,e,n){return e=Lr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function h$(t,e,n,r,o){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ep(0),this.expirationTimes=Ep(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ep(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function YS(t,e,n,r,o,i,s,l,a){return t=new h$(t,e,n,l,a),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Lr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},OS(i),t}function d$(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:sa,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function qI(t){if(!t)return bs;t=t._reactInternals;e:{if(bl(t)!==t||t.tag!==1)throw Error(oe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ar(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(oe(171))}if(t.tag===1){var n=t.type;if(ar(n))return XO(t,n,e)}return e}function QI(t,e,n,r,o,i,s,l,a){return t=YS(n,r,!0,t,o,i,s,l,a),t.context=qI(null),n=t.current,r=Gn(),o=fs(n),i=Ci(r,o),i.callback=e??null,hs(n,i,o),t.current.lanes=o,hh(t,o,r),ur(t,r),t}function im(t,e,n,r){var o=e.current,i=Gn(),s=fs(o);return n=qI(n),e.context===null?e.context=n:e.pendingContext=n,e=Ci(i,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=hs(o,e,s),t!==null&&(ao(t,o,s,i),mf(t,o,s)),s}function dg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function e1(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function GS(t,e){e1(t,e),(t=t.alternate)&&e1(t,e)}function f$(){return null}var ZI=typeof reportError=="function"?reportError:function(t){console.error(t)};function KS(t){this._internalRoot=t}sm.prototype.render=KS.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(oe(409));im(t,e,null,null)};sm.prototype.unmount=KS.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ml(function(){im(null,t,null,null)}),e[Si]=null}};function sm(t){this._internalRoot=t}sm.prototype.unstable_scheduleHydration=function(t){if(t){var e=_O();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Qi.length&&e!==0&&e<Qi[n].priority;n++);Qi.splice(n,0,t),n===0&&IO(t)}};function XS(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function lm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function t1(){}function g$(t,e,n,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var u=dg(s);i.call(u)}}var s=QI(e,r,t,0,null,!1,!1,"",t1);return t._reactRootContainer=s,t[Si]=s.current,Dc(t.nodeType===8?t.parentNode:t),ml(),s}for(;o=t.lastChild;)t.removeChild(o);if(typeof r=="function"){var l=r;r=function(){var u=dg(a);l.call(u)}}var a=YS(t,0,!1,null,null,!1,!1,"",t1);return t._reactRootContainer=a,t[Si]=a.current,Dc(t.nodeType===8?t.parentNode:t),ml(function(){im(e,a,n,r)}),a}function am(t,e,n,r,o){var i=n._reactRootContainer;if(i){var s=i;if(typeof o=="function"){var l=o;o=function(){var a=dg(s);l.call(a)}}im(e,s,t,o)}else s=g$(n,e,t,o,r);return dg(s)}MO=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ku(e.pendingLanes);n!==0&&(gS(e,n|1),ur(e,qt()),!(rt&6)&&(Ba=qt()+500,Is()))}break;case 13:ml(function(){var r=Ri(t,1);if(r!==null){var o=Gn();ao(r,t,1,o)}}),GS(t,1)}};mS=function(t){if(t.tag===13){var e=Ri(t,134217728);if(e!==null){var n=Gn();ao(e,t,134217728,n)}GS(t,134217728)}};xO=function(t){if(t.tag===13){var e=fs(t),n=Ri(t,e);if(n!==null){var r=Gn();ao(n,t,e,r)}GS(t,e)}};_O=function(){return dt};OO=function(t,e){var n=dt;try{return dt=t,e()}finally{dt=n}};mv=function(t,e,n){switch(e){case"input":if(av(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var o=Zg(r);if(!o)throw Error(oe(90));sO(r),av(r,o)}}}break;case"textarea":aO(t,n);break;case"select":e=n.value,e!=null&&Ea(t,!!n.multiple,e,!1)}};mO=WS;pO=ml;var m$={usingClientEntryPoint:!1,Events:[fh,ha,Zg,fO,gO,WS]},Cu={findFiberByHostInstance:tl,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},p$={bundleType:Cu.bundleType,version:Cu.version,rendererPackageName:Cu.rendererPackageName,rendererConfig:Cu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=vO(t),t===null?null:t.stateNode},findFiberByHostInstance:Cu.findFiberByHostInstance||f$,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rd.isDisabled&&rd.supportsFiber)try{Kg=rd.inject(p$),Lo=rd}catch{}}Er.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=m$;Er.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!XS(e))throw Error(oe(200));return d$(t,e,null,n)};Er.createRoot=function(t,e){if(!XS(t))throw Error(oe(299));var n=!1,r="",o=ZI;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=YS(t,1,!1,null,null,n,!1,r,o),t[Si]=e.current,Dc(t.nodeType===8?t.parentNode:t),new KS(e)};Er.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(oe(188)):(t=Object.keys(t).join(","),Error(oe(268,t)));return t=vO(e),t=t===null?null:t.stateNode,t};Er.flushSync=function(t){return ml(t)};Er.hydrate=function(t,e,n){if(!lm(e))throw Error(oe(200));return am(null,t,e,!0,n)};Er.hydrateRoot=function(t,e,n){if(!XS(t))throw Error(oe(405));var r=n!=null&&n.hydratedSources||null,o=!1,i="",s=ZI;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=QI(e,null,t,1,n??null,o,!1,i,s),t[Si]=e.current,Dc(t),r)for(t=0;t<r.length;t++)n=r[t],o=n._getVersion,o=o(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,o]:e.mutableSourceEagerHydrationData.push(n,o);return new sm(e)};Er.render=function(t,e,n){if(!lm(e))throw Error(oe(200));return am(null,t,e,!1,n)};Er.unmountComponentAtNode=function(t){if(!lm(t))throw Error(oe(40));return t._reactRootContainer?(ml(function(){am(null,null,t,!1,function(){t._reactRootContainer=null,t[Si]=null})}),!0):!1};Er.unstable_batchedUpdates=WS;Er.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!lm(n))throw Error(oe(200));if(t==null||t._reactInternals===void 0)throw Error(oe(38));return am(t,e,n,!1,r)};Er.version="18.2.0-next-9e3b772b8-20220608";function JI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(JI)}catch(t){console.error(t)}}JI(),Q_.exports=Er;var eA=Q_.exports;const tA=ah(eA);var n1=eA;tv.createRoot=n1.createRoot,tv.hydrateRoot=n1.hydrateRoot;var od=function(t){return t&&t.Math===Math&&t},Dn=od(typeof globalThis=="object"&&globalThis)||od(typeof window=="object"&&window)||od(typeof self=="object"&&self)||od(typeof so=="object"&&so)||function(){return this}()||so||Function("return this")(),qS={},Ur=function(t){try{return!!t()}catch{return!0}},w$=Ur,Bo=!w$(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),C$=Ur,um=!C$(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),v$=um,id=Function.prototype.call,cm=v$?id.bind(id):function(){return id.apply(id,arguments)},nA={},rA={}.propertyIsEnumerable,oA=Object.getOwnPropertyDescriptor,y$=oA&&!rA.call({1:2},1);nA.f=y$?function(e){var n=oA(this,e);return!!n&&n.enumerable}:rA;var QS=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},iA=um,sA=Function.prototype,Kv=sA.call,S$=iA&&sA.bind.bind(Kv,Kv),Qn=iA?S$:function(t){return function(){return Kv.apply(t,arguments)}},lA=Qn,R$=lA({}.toString),b$=lA("".slice),eu=function(t){return b$(R$(t),8,-1)},E$=Qn,T$=Ur,M$=eu,jp=Object,x$=E$("".split),_$=T$(function(){return!jp("z").propertyIsEnumerable(0)})?function(t){return M$(t)==="String"?x$(t,""):jp(t)}:jp,aA=function(t){return t==null},O$=aA,I$=TypeError,uA=function(t){if(O$(t))throw I$("Can't call method on "+t);return t},A$=_$,H$=uA,hm=function(t){return A$(H$(t))},Xv=typeof document=="object"&&document.all,P$=typeof Xv>"u"&&Xv!==void 0,cA={all:Xv,IS_HTMLDDA:P$},hA=cA,k$=hA.all,Sn=hA.IS_HTMLDDA?function(t){return typeof t=="function"||t===k$}:function(t){return typeof t=="function"},r1=Sn,dA=cA,D$=dA.all,El=dA.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:r1(t)||t===D$}:function(t){return typeof t=="object"?t!==null:r1(t)},Yp=Dn,N$=Sn,L$=function(t){return N$(t)?t:void 0},mh=function(t,e){return arguments.length<2?L$(Yp[t]):Yp[t]&&Yp[t][e]},F$=Qn,fA=F$({}.isPrototypeOf),ZS=typeof navigator<"u"&&String(navigator.userAgent)||"",gA=Dn,Gp=ZS,o1=gA.process,i1=gA.Deno,s1=o1&&o1.versions||i1&&i1.version,l1=s1&&s1.v8,ro,fg;l1&&(ro=l1.split("."),fg=ro[0]>0&&ro[0]<4?1:+(ro[0]+ro[1]));!fg&&Gp&&(ro=Gp.match(/Edge\/(\d+)/),(!ro||ro[1]>=74)&&(ro=Gp.match(/Chrome\/(\d+)/),ro&&(fg=+ro[1])));var $$=fg,a1=$$,V$=Ur,B$=Dn,W$=B$.String,JS=!!Object.getOwnPropertySymbols&&!V$(function(){var t=Symbol("symbol detection");return!W$(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&a1&&a1<41}),U$=JS,mA=U$&&!Symbol.sham&&typeof Symbol.iterator=="symbol",z$=mh,j$=Sn,Y$=fA,G$=mA,K$=Object,e0=G$?function(t){return typeof t=="symbol"}:function(t){var e=z$("Symbol");return j$(e)&&Y$(e.prototype,K$(t))},X$=String,pA=function(t){try{return X$(t)}catch{return"Object"}},q$=Sn,Q$=pA,Z$=TypeError,t0=function(t){if(q$(t))return t;throw Z$(Q$(t)+" is not a function")},J$=t0,eV=aA,tV=function(t,e){var n=t[e];return eV(n)?void 0:J$(n)},Kp=cm,Xp=Sn,qp=El,nV=TypeError,rV=function(t,e){var n,r;if(e==="string"&&Xp(n=t.toString)&&!qp(r=Kp(n,t))||Xp(n=t.valueOf)&&!qp(r=Kp(n,t))||e!=="string"&&Xp(n=t.toString)&&!qp(r=Kp(n,t)))return r;throw nV("Can't convert object to primitive value")},wA={exports:{}},u1=Dn,oV=Object.defineProperty,n0=function(t,e){try{oV(u1,t,{value:e,configurable:!0,writable:!0})}catch{u1[t]=e}return e},iV=Dn,sV=n0,c1="__core-js_shared__",lV=iV[c1]||sV(c1,{}),r0=lV,h1=r0;(wA.exports=function(t,e){return h1[t]||(h1[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.32.2",mode:"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.2/LICENSE",source:"https://github.com/zloirock/core-js"});var CA=wA.exports,aV=uA,uV=Object,dm=function(t){return uV(aV(t))},cV=Qn,hV=dm,dV=cV({}.hasOwnProperty),_i=Object.hasOwn||function(e,n){return dV(hV(e),n)},fV=Qn,gV=0,mV=Math.random(),pV=fV(1 .toString),vA=function(t){return"Symbol("+(t===void 0?"":t)+")_"+pV(++gV+mV,36)},wV=Dn,CV=CA,d1=_i,vV=vA,yV=JS,SV=mA,Ca=wV.Symbol,Qp=CV("wks"),RV=SV?Ca.for||Ca:Ca&&Ca.withoutSetter||vV,fm=function(t){return d1(Qp,t)||(Qp[t]=yV&&d1(Ca,t)?Ca[t]:RV("Symbol."+t)),Qp[t]},bV=cm,f1=El,g1=e0,EV=tV,TV=rV,MV=fm,xV=TypeError,_V=MV("toPrimitive"),OV=function(t,e){if(!f1(t)||g1(t))return t;var n=EV(t,_V),r;if(n){if(e===void 0&&(e="default"),r=bV(n,t,e),!f1(r)||g1(r))return r;throw xV("Can't convert object to primitive value")}return e===void 0&&(e="number"),TV(t,e)},IV=OV,AV=e0,yA=function(t){var e=IV(t,"string");return AV(e)?e:e+""},HV=Dn,m1=El,qv=HV.document,PV=m1(qv)&&m1(qv.createElement),o0=function(t){return PV?qv.createElement(t):{}},kV=Bo,DV=Ur,NV=o0,SA=!kV&&!DV(function(){return Object.defineProperty(NV("div"),"a",{get:function(){return 7}}).a!==7}),LV=Bo,FV=cm,$V=nA,VV=QS,BV=hm,WV=yA,UV=_i,zV=SA,p1=Object.getOwnPropertyDescriptor;qS.f=LV?p1:function(e,n){if(e=BV(e),n=WV(n),zV)try{return p1(e,n)}catch{}if(UV(e,n))return VV(!FV($V.f,e,n),e[n])};var Tl={},jV=Bo,YV=Ur,RA=jV&&YV(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),GV=El,KV=String,XV=TypeError,ph=function(t){if(GV(t))return t;throw XV(KV(t)+" is not an object")},qV=Bo,QV=SA,ZV=RA,sd=ph,w1=yA,JV=TypeError,Zp=Object.defineProperty,eB=Object.getOwnPropertyDescriptor,Jp="enumerable",ew="configurable",tw="writable";Tl.f=qV?ZV?function(e,n,r){if(sd(e),n=w1(n),sd(r),typeof e=="function"&&n==="prototype"&&"value"in r&&tw in r&&!r[tw]){var o=eB(e,n);o&&o[tw]&&(e[n]=r.value,r={configurable:ew in r?r[ew]:o[ew],enumerable:Jp in r?r[Jp]:o[Jp],writable:!1})}return Zp(e,n,r)}:Zp:function(e,n,r){if(sd(e),n=w1(n),sd(r),QV)try{return Zp(e,n,r)}catch{}if("get"in r||"set"in r)throw JV("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var tB=Bo,nB=Tl,rB=QS,wh=tB?function(t,e,n){return nB.f(t,e,rB(1,n))}:function(t,e,n){return t[e]=n,t},bA={exports:{}},Qv=Bo,oB=_i,EA=Function.prototype,iB=Qv&&Object.getOwnPropertyDescriptor,i0=oB(EA,"name"),sB=i0&&(function(){}).name==="something",lB=i0&&(!Qv||Qv&&iB(EA,"name").configurable),aB={EXISTS:i0,PROPER:sB,CONFIGURABLE:lB},uB=Qn,cB=Sn,Zv=r0,hB=uB(Function.toString);cB(Zv.inspectSource)||(Zv.inspectSource=function(t){return hB(t)});var dB=Zv.inspectSource,fB=Dn,gB=Sn,C1=fB.WeakMap,mB=gB(C1)&&/native code/.test(String(C1)),pB=CA,wB=vA,v1=pB("keys"),TA=function(t){return v1[t]||(v1[t]=wB(t))},s0={},CB=mB,MA=Dn,vB=El,yB=wh,nw=_i,rw=r0,SB=TA,RB=s0,y1="Object already initialized",Jv=MA.TypeError,bB=MA.WeakMap,gg,zc,mg,EB=function(t){return mg(t)?zc(t):gg(t,{})},TB=function(t){return function(e){var n;if(!vB(e)||(n=zc(e)).type!==t)throw Jv("Incompatible receiver, "+t+" required");return n}};if(CB||rw.state){var Co=rw.state||(rw.state=new bB);Co.get=Co.get,Co.has=Co.has,Co.set=Co.set,gg=function(t,e){if(Co.has(t))throw Jv(y1);return e.facade=t,Co.set(t,e),e},zc=function(t){return Co.get(t)||{}},mg=function(t){return Co.has(t)}}else{var Nl=SB("state");RB[Nl]=!0,gg=function(t,e){if(nw(t,Nl))throw Jv(y1);return e.facade=t,yB(t,Nl,e),e},zc=function(t){return nw(t,Nl)?t[Nl]:{}},mg=function(t){return nw(t,Nl)}}var MB={set:gg,get:zc,has:mg,enforce:EB,getterFor:TB},l0=Qn,xB=Ur,_B=Sn,ld=_i,ey=Bo,OB=aB.CONFIGURABLE,IB=dB,xA=MB,AB=xA.enforce,HB=xA.get,S1=String,Rf=Object.defineProperty,PB=l0("".slice),kB=l0("".replace),DB=l0([].join),NB=ey&&!xB(function(){return Rf(function(){},"length",{value:8}).length!==8}),LB=String(String).split("String"),FB=bA.exports=function(t,e,n){PB(S1(e),0,7)==="Symbol("&&(e="["+kB(S1(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!ld(t,"name")||OB&&t.name!==e)&&(ey?Rf(t,"name",{value:e,configurable:!0}):t.name=e),NB&&n&&ld(n,"arity")&&t.length!==n.arity&&Rf(t,"length",{value:n.arity});try{n&&ld(n,"constructor")&&n.constructor?ey&&Rf(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=AB(t);return ld(r,"source")||(r.source=DB(LB,typeof e=="string"?e:"")),t};Function.prototype.toString=FB(function(){return _B(this)&&HB(this).source||IB(this)},"toString");var $B=bA.exports,VB=Sn,BB=Tl,WB=$B,UB=n0,zB=function(t,e,n,r){r||(r={});var o=r.enumerable,i=r.name!==void 0?r.name:e;if(VB(n)&&WB(n,i,r),r.global)o?t[e]=n:UB(e,n);else{try{r.unsafe?t[e]&&(o=!0):delete t[e]}catch{}o?t[e]=n:BB.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},_A={},jB=Math.ceil,YB=Math.floor,GB=Math.trunc||function(e){var n=+e;return(n>0?YB:jB)(n)},KB=GB,a0=function(t){var e=+t;return e!==e||e===0?0:KB(e)},XB=a0,qB=Math.max,QB=Math.min,ZB=function(t,e){var n=XB(t);return n<0?qB(n+e,0):QB(n,e)},JB=a0,eW=Math.min,tW=function(t){return t>0?eW(JB(t),9007199254740991):0},nW=tW,gm=function(t){return nW(t.length)},rW=hm,oW=ZB,iW=gm,R1=function(t){return function(e,n,r){var o=rW(e),i=iW(o),s=oW(r,i),l;if(t&&n!==n){for(;i>s;)if(l=o[s++],l!==l)return!0}else for(;i>s;s++)if((t||s in o)&&o[s]===n)return t||s||0;return!t&&-1}},sW={includes:R1(!0),indexOf:R1(!1)},lW=Qn,ow=_i,aW=hm,uW=sW.indexOf,cW=s0,b1=lW([].push),OA=function(t,e){var n=aW(t),r=0,o=[],i;for(i in n)!ow(cW,i)&&ow(n,i)&&b1(o,i);for(;e.length>r;)ow(n,i=e[r++])&&(~uW(o,i)||b1(o,i));return o},u0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],hW=OA,dW=u0,fW=dW.concat("length","prototype");_A.f=Object.getOwnPropertyNames||function(e){return hW(e,fW)};var IA={};IA.f=Object.getOwnPropertySymbols;var gW=mh,mW=Qn,pW=_A,wW=IA,CW=ph,vW=mW([].concat),yW=gW("Reflect","ownKeys")||function(e){var n=pW.f(CW(e)),r=wW.f;return r?vW(n,r(e)):n},E1=_i,SW=yW,RW=qS,bW=Tl,AA=function(t,e,n){for(var r=SW(e),o=bW.f,i=RW.f,s=0;s<r.length;s++){var l=r[s];!E1(t,l)&&!(n&&E1(n,l))&&o(t,l,i(e,l))}},EW=Ur,TW=Sn,MW=/#|\.prototype\./,Ch=function(t,e){var n=_W[xW(t)];return n===IW?!0:n===OW?!1:TW(e)?EW(e):!!e},xW=Ch.normalize=function(t){return String(t).replace(MW,".").toLowerCase()},_W=Ch.data={},OW=Ch.NATIVE="N",IW=Ch.POLYFILL="P",AW=Ch,iw=Dn,HW=qS.f,PW=wh,kW=zB,DW=n0,NW=AA,LW=AW,Ml=function(t,e){var n=t.target,r=t.global,o=t.stat,i,s,l,a,u,c;if(r?s=iw:o?s=iw[n]||DW(n,{}):s=(iw[n]||{}).prototype,s)for(l in e){if(u=e[l],t.dontCallGetSet?(c=HW(s,l),a=c&&c.value):a=s[l],i=LW(r?l:n+(o?".":"#")+l,t.forced),!i&&a!==void 0){if(typeof u==typeof a)continue;NW(u,a)}(t.sham||a&&a.sham)&&PW(u,"sham",!0),kW(s,l,u,t)}},FW=eu,HA=Array.isArray||function(e){return FW(e)==="Array"},$W=Bo,VW=HA,BW=TypeError,WW=Object.getOwnPropertyDescriptor,UW=$W&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),PA=UW?function(t,e){if(VW(t)&&!WW(t,"length").writable)throw BW("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},zW=TypeError,jW=9007199254740991,kA=function(t){if(t>jW)throw zW("Maximum allowed index exceeded");return t},YW=Ml,GW=dm,KW=gm,XW=PA,qW=kA,QW=Ur,ZW=QW(function(){return[].push.call({length:4294967296},1)!==4294967297}),JW=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},e2=ZW||!JW();YW({target:"Array",proto:!0,arity:1,forced:e2},{push:function(e){var n=GW(this),r=KW(n),o=arguments.length;qW(r+o);for(var i=0;i<o;i++)n[r]=arguments[i],r++;return XW(n,r),r}});var t2=um,DA=Function.prototype,T1=DA.apply,M1=DA.call,mm=typeof Reflect=="object"&&Reflect.apply||(t2?M1.bind(T1):function(){return M1.apply(T1,arguments)}),n2=Qn,r2=t0,o2=function(t,e,n){try{return n2(r2(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},i2=Sn,s2=String,l2=TypeError,a2=function(t){if(typeof t=="object"||i2(t))return t;throw l2("Can't set "+s2(t)+" as a prototype")},u2=o2,c2=ph,h2=a2,NA=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=u2(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(o,i){return c2(o),h2(i),t?n(o,i):o.__proto__=i,o}}():void 0),d2=Tl.f,f2=function(t,e,n){n in t||d2(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},g2=Sn,m2=El,x1=NA,p2=function(t,e,n){var r,o;return x1&&g2(r=e.constructor)&&r!==n&&m2(o=r.prototype)&&o!==n.prototype&&x1(t,o),t},w2=fm,C2=w2("toStringTag"),LA={};LA[C2]="z";var v2=String(LA)==="[object z]",y2=v2,S2=Sn,bf=eu,R2=fm,b2=R2("toStringTag"),E2=Object,T2=bf(function(){return arguments}())==="Arguments",M2=function(t,e){try{return t[e]}catch{}},x2=y2?bf:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=M2(e=E2(t),b2))=="string"?n:T2?bf(e):(r=bf(e))==="Object"&&S2(e.callee)?"Arguments":r},_2=x2,O2=String,FA=function(t){if(_2(t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return O2(t)},I2=FA,A2=function(t,e){return t===void 0?arguments.length<2?"":e:I2(t)},H2=El,P2=wh,k2=function(t,e){H2(e)&&"cause"in e&&P2(t,"cause",e.cause)},D2=Qn,$A=Error,N2=D2("".replace),L2=function(t){return String($A(t).stack)}("zxcasd"),VA=/\n\s*at [^:]*:[^\n]*/,F2=VA.test(L2),$2=function(t,e){if(F2&&typeof t=="string"&&!$A.prepareStackTrace)for(;e--;)t=N2(t,VA,"");return t},V2=Ur,B2=QS,W2=!V2(function(){var t=Error("a");return"stack"in t?(Object.defineProperty(t,"stack",B2(1,7)),t.stack!==7):!0}),U2=wh,z2=$2,j2=W2,_1=Error.captureStackTrace,Y2=function(t,e,n,r){j2&&(_1?_1(t,e):U2(t,"stack",z2(n,r)))},O1=mh,G2=_i,I1=wh,K2=fA,A1=NA,H1=AA,P1=f2,X2=p2,q2=A2,Q2=k2,Z2=Y2,J2=Bo,eU=function(t,e,n,r){var o="stackTraceLimit",i=r?2:1,s=t.split("."),l=s[s.length-1],a=O1.apply(null,s);if(a){var u=a.prototype;if(G2(u,"cause")&&delete u.cause,!n)return a;var c=O1("Error"),h=e(function(f,g){var p=q2(r?g:f,void 0),y=r?new a(f):new a;return p!==void 0&&I1(y,"message",p),Z2(y,h,y.stack,2),this&&K2(u,this)&&X2(y,this,h),arguments.length>i&&Q2(y,arguments[i]),y});h.prototype=u,l!=="Error"?A1?A1(h,c):H1(h,c,{name:!0}):J2&&o in a&&(P1(h,a,o),P1(h,a,"prepareStackTrace")),H1(h,a);try{u.name!==l&&I1(u,"name",l),u.constructor=h}catch{}return h}},BA=Ml,tU=Dn,Wo=mm,WA=eU,ty="WebAssembly",k1=tU[ty],pg=Error("e",{cause:7}).cause!==7,xl=function(t,e){var n={};n[t]=WA(t,e,pg),BA({global:!0,constructor:!0,arity:1,forced:pg},n)},c0=function(t,e){if(k1&&k1[t]){var n={};n[t]=WA(ty+"."+t,e,pg),BA({target:ty,stat:!0,constructor:!0,arity:1,forced:pg},n)}};xl("Error",function(t){return function(n){return Wo(t,this,arguments)}});xl("EvalError",function(t){return function(n){return Wo(t,this,arguments)}});xl("RangeError",function(t){return function(n){return Wo(t,this,arguments)}});xl("ReferenceError",function(t){return function(n){return Wo(t,this,arguments)}});xl("SyntaxError",function(t){return function(n){return Wo(t,this,arguments)}});xl("TypeError",function(t){return function(n){return Wo(t,this,arguments)}});xl("URIError",function(t){return function(n){return Wo(t,this,arguments)}});c0("CompileError",function(t){return function(n){return Wo(t,this,arguments)}});c0("LinkError",function(t){return function(n){return Wo(t,this,arguments)}});c0("RuntimeError",function(t){return function(n){return Wo(t,this,arguments)}});var nU=eu,rU=Qn,oU=function(t){if(nU(t)==="Function")return rU(t)},D1=oU,iU=t0,sU=um,lU=D1(D1.bind),aU=function(t,e){return iU(t),e===void 0?t:sU?lU(t,e):function(){return t.apply(e,arguments)}},uU=mh,UA=uU("document","documentElement"),cU=Qn,h0=cU([].slice),hU=TypeError,zA=function(t,e){if(t<e)throw hU("Not enough arguments");return t},dU=ZS,fU=/(?:ipad|iphone|ipod).*applewebkit/i.test(dU),gU=Dn,mU=eu,pU=mU(gU.process)==="process",vr=Dn,wU=mm,CU=aU,N1=Sn,vU=_i,jA=Ur,L1=UA,yU=h0,F1=o0,SU=zA,RU=fU,bU=pU,ny=vr.setImmediate,ry=vr.clearImmediate,EU=vr.process,sw=vr.Dispatch,TU=vr.Function,$1=vr.MessageChannel,MU=vr.String,lw=0,fc={},V1="onreadystatechange",jc,Ps,aw,uw;jA(function(){jc=vr.location});var d0=function(t){if(vU(fc,t)){var e=fc[t];delete fc[t],e()}},cw=function(t){return function(){d0(t)}},B1=function(t){d0(t.data)},W1=function(t){vr.postMessage(MU(t),jc.protocol+"//"+jc.host)};(!ny||!ry)&&(ny=function(e){SU(arguments.length,1);var n=N1(e)?e:TU(e),r=yU(arguments,1);return fc[++lw]=function(){wU(n,void 0,r)},Ps(lw),lw},ry=function(e){delete fc[e]},bU?Ps=function(t){EU.nextTick(cw(t))}:sw&&sw.now?Ps=function(t){sw.now(cw(t))}:$1&&!RU?(aw=new $1,uw=aw.port2,aw.port1.onmessage=B1,Ps=CU(uw.postMessage,uw)):vr.addEventListener&&N1(vr.postMessage)&&!vr.importScripts&&jc&&jc.protocol!=="file:"&&!jA(W1)?(Ps=W1,vr.addEventListener("message",B1,!1)):V1 in F1("script")?Ps=function(t){L1.appendChild(F1("script"))[V1]=function(){L1.removeChild(this),d0(t)}}:Ps=function(t){setTimeout(cw(t),0)});var YA={set:ny,clear:ry},xU=Ml,_U=Dn,U1=YA.clear;xU({global:!0,bind:!0,enumerable:!0,forced:_U.clearImmediate!==U1},{clearImmediate:U1});var OU=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",GA=Dn,IU=mm,AU=Sn,HU=OU,PU=ZS,kU=h0,DU=zA,NU=GA.Function,LU=/MSIE .\./.test(PU)||HU&&function(){var t=GA.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),FU=function(t,e){var n=e?2:1;return LU?function(r,o){var i=DU(arguments.length,1)>n,s=AU(r)?r:NU(r),l=i?kU(arguments,n):[],a=i?function(){IU(s,this,l)}:s;return e?t(a,o):t(a)}:t},$U=Ml,KA=Dn,z1=YA.set,VU=FU,j1=KA.setImmediate?VU(z1,!1):z1;$U({global:!0,bind:!0,enumerable:!0,forced:KA.setImmediate!==j1},{setImmediate:j1});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function Ji(t){"@babel/helpers - typeof";return Ji=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ji(t)}function oy(t,e){return oy=Object.setPrototypeOf||function(r,o){return r.__proto__=o,r},oy(t,e)}function BU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ef(t,e,n){return BU()?Ef=Reflect.construct:Ef=function(o,i,s){var l=[null];l.push.apply(l,i);var a=Function.bind.apply(o,l),u=new a;return s&&oy(u,s.prototype),u},Ef.apply(null,arguments)}function Zr(t){return WU(t)||UU(t)||zU(t)||jU()}function WU(t){if(Array.isArray(t))return iy(t)}function UU(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function zU(t,e){if(t){if(typeof t=="string")return iy(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iy(t,e)}}function iy(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function jU(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var YU=Object.hasOwnProperty,Y1=Object.setPrototypeOf,GU=Object.isFrozen,KU=Object.getPrototypeOf,XU=Object.getOwnPropertyDescriptor,Kn=Object.freeze,co=Object.seal,qU=Object.create,XA=typeof Reflect<"u"&&Reflect,wg=XA.apply,sy=XA.construct;wg||(wg=function(e,n,r){return e.apply(n,r)});Kn||(Kn=function(e){return e});co||(co=function(e){return e});sy||(sy=function(e,n){return Ef(e,Zr(n))});var QU=Wr(Array.prototype.forEach),G1=Wr(Array.prototype.pop),vu=Wr(Array.prototype.push),Tf=Wr(String.prototype.toLowerCase),hw=Wr(String.prototype.toString),ZU=Wr(String.prototype.match),Gr=Wr(String.prototype.replace),JU=Wr(String.prototype.indexOf),ez=Wr(String.prototype.trim),$n=Wr(RegExp.prototype.test),dw=tz(TypeError);function Wr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return wg(t,e,r)}}function tz(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return sy(t,n)}}function Ge(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:Tf,Y1&&Y1(t,null);for(var o=e.length;o--;){var i=e[o];if(typeof i=="string"){var s=n(i);s!==i&&(GU(e)||(e[o]=s),i=s)}t[i]=!0}return t}function ks(t){var e=qU(null),n;for(n in t)wg(YU,t,[n])===!0&&(e[n]=t[n]);return e}function ad(t,e){for(;t!==null;){var n=XU(t,e);if(n){if(n.get)return Wr(n.get);if(typeof n.value=="function")return Wr(n.value)}t=KU(t)}function r(o){return console.warn("fallback value for",o),null}return r}var K1=Kn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),fw=Kn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),gw=Kn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),nz=Kn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mw=Kn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),rz=Kn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),X1=Kn(["#text"]),q1=Kn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),pw=Kn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Q1=Kn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ud=Kn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),oz=co(/\{\{[\w\W]*|[\w\W]*\}\}/gm),iz=co(/<%[\w\W]*|[\w\W]*%>/gm),sz=co(/\${[\w\W]*}/gm),lz=co(/^data-[\-\w.\u00B7-\uFFFF]/),az=co(/^aria-[\-\w]+$/),uz=co(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),cz=co(/^(?:\w+script|data):/i),hz=co(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),dz=co(/^html$/i),fz=function(){return typeof window>"u"?null:window},gz=function(e,n){if(Ji(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(r=n.currentScript.getAttribute(o));var i="dompurify"+(r?"#"+r:"");try{return e.createPolicy(i,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function qA(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fz(),e=function(F){return qA(F)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,o=t.DocumentFragment,i=t.HTMLTemplateElement,s=t.Node,l=t.Element,a=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,h=t.HTMLFormElement,f=t.DOMParser,g=t.trustedTypes,p=l.prototype,y=ad(p,"cloneNode"),E=ad(p,"nextSibling"),w=ad(p,"childNodes"),C=ad(p,"parentNode");if(typeof i=="function"){var S=r.createElement("template");S.content&&S.content.ownerDocument&&(r=S.content.ownerDocument)}var T=gz(g,n),x=T?T.createHTML(""):"",A=r,D=A.implementation,U=A.createNodeIterator,j=A.createDocumentFragment,z=A.getElementsByTagName,Z=n.importNode,re={};try{re=ks(r).documentMode?r.documentMode:{}}catch{}var ne={};e.isSupported=typeof C=="function"&&D&&D.createHTMLDocument!==void 0&&re!==9;var ue=oz,Re=iz,Ne=sz,Ae=lz,b=az,d=cz,m=hz,v=uz,_=null,I=Ge({},[].concat(Zr(K1),Zr(fw),Zr(gw),Zr(mw),Zr(X1))),H=null,K=Ge({},[].concat(Zr(q1),Zr(pw),Zr(Q1),Zr(ud))),W=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,J=null,q=!0,fe=!0,Oe=!1,xe=!0,_e=!1,X=!1,Ye=!1,Ve=!1,Ee=!1,De=!1,be=!1,R=!0,M=!1,P="user-content-",B=!0,k=!1,V={},N=null,L=Ge({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Y=null,$=Ge({},["audio","video","img","source","image","track"]),G=null,le=Ge({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ge="http://www.w3.org/1998/Math/MathML",Se="http://www.w3.org/2000/svg",Ie="http://www.w3.org/1999/xhtml",Fe=Ie,yt=!1,Xe=null,at=Ge({},[ge,Se,Ie],hw),It,kl=["application/xhtml+xml","text/html"],uu="text/html",zt,mn=null,Hs=r.createElement("form"),Fn=function(F){return F instanceof RegExp||F instanceof Function},on=function(F){mn&&mn===F||((!F||Ji(F)!=="object")&&(F={}),F=ks(F),It=kl.indexOf(F.PARSER_MEDIA_TYPE)===-1?It=uu:It=F.PARSER_MEDIA_TYPE,zt=It==="application/xhtml+xml"?hw:Tf,_="ALLOWED_TAGS"in F?Ge({},F.ALLOWED_TAGS,zt):I,H="ALLOWED_ATTR"in F?Ge({},F.ALLOWED_ATTR,zt):K,Xe="ALLOWED_NAMESPACES"in F?Ge({},F.ALLOWED_NAMESPACES,hw):at,G="ADD_URI_SAFE_ATTR"in F?Ge(ks(le),F.ADD_URI_SAFE_ATTR,zt):le,Y="ADD_DATA_URI_TAGS"in F?Ge(ks($),F.ADD_DATA_URI_TAGS,zt):$,N="FORBID_CONTENTS"in F?Ge({},F.FORBID_CONTENTS,zt):L,Q="FORBID_TAGS"in F?Ge({},F.FORBID_TAGS,zt):{},J="FORBID_ATTR"in F?Ge({},F.FORBID_ATTR,zt):{},V="USE_PROFILES"in F?F.USE_PROFILES:!1,q=F.ALLOW_ARIA_ATTR!==!1,fe=F.ALLOW_DATA_ATTR!==!1,Oe=F.ALLOW_UNKNOWN_PROTOCOLS||!1,xe=F.ALLOW_SELF_CLOSE_IN_ATTR!==!1,_e=F.SAFE_FOR_TEMPLATES||!1,X=F.WHOLE_DOCUMENT||!1,Ee=F.RETURN_DOM||!1,De=F.RETURN_DOM_FRAGMENT||!1,be=F.RETURN_TRUSTED_TYPE||!1,Ve=F.FORCE_BODY||!1,R=F.SANITIZE_DOM!==!1,M=F.SANITIZE_NAMED_PROPS||!1,B=F.KEEP_CONTENT!==!1,k=F.IN_PLACE||!1,v=F.ALLOWED_URI_REGEXP||v,Fe=F.NAMESPACE||Ie,W=F.CUSTOM_ELEMENT_HANDLING||{},F.CUSTOM_ELEMENT_HANDLING&&Fn(F.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=F.CUSTOM_ELEMENT_HANDLING.tagNameCheck),F.CUSTOM_ELEMENT_HANDLING&&Fn(F.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=F.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),F.CUSTOM_ELEMENT_HANDLING&&typeof F.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(W.allowCustomizedBuiltInElements=F.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),_e&&(fe=!1),De&&(Ee=!0),V&&(_=Ge({},Zr(X1)),H=[],V.html===!0&&(Ge(_,K1),Ge(H,q1)),V.svg===!0&&(Ge(_,fw),Ge(H,pw),Ge(H,ud)),V.svgFilters===!0&&(Ge(_,gw),Ge(H,pw),Ge(H,ud)),V.mathMl===!0&&(Ge(_,mw),Ge(H,Q1),Ge(H,ud))),F.ADD_TAGS&&(_===I&&(_=ks(_)),Ge(_,F.ADD_TAGS,zt)),F.ADD_ATTR&&(H===K&&(H=ks(H)),Ge(H,F.ADD_ATTR,zt)),F.ADD_URI_SAFE_ATTR&&Ge(G,F.ADD_URI_SAFE_ATTR,zt),F.FORBID_CONTENTS&&(N===L&&(N=ks(N)),Ge(N,F.FORBID_CONTENTS,zt)),B&&(_["#text"]=!0),X&&Ge(_,["html","head","body"]),_.table&&(Ge(_,["tbody"]),delete Q.tbody),Kn&&Kn(F),mn=F)},Rt=Ge({},["mi","mo","mn","ms","mtext"]),VE=Ge({},["foreignobject","desc","title","annotation-xml"]),WN=Ge({},["title","style","font","a","script"]),$h=Ge({},fw);Ge($h,gw),Ge($h,nz);var pp=Ge({},mw);Ge(pp,rz);var UN=function(F){var se=C(F);(!se||!se.tagName)&&(se={namespaceURI:Fe,tagName:"template"});var ce=Tf(F.tagName),lt=Tf(se.tagName);return Xe[F.namespaceURI]?F.namespaceURI===Se?se.namespaceURI===Ie?ce==="svg":se.namespaceURI===ge?ce==="svg"&&(lt==="annotation-xml"||Rt[lt]):!!$h[ce]:F.namespaceURI===ge?se.namespaceURI===Ie?ce==="math":se.namespaceURI===Se?ce==="math"&&VE[lt]:!!pp[ce]:F.namespaceURI===Ie?se.namespaceURI===Se&&!VE[lt]||se.namespaceURI===ge&&!Rt[lt]?!1:!pp[ce]&&(WN[ce]||!$h[ce]):!!(It==="application/xhtml+xml"&&Xe[F.namespaceURI]):!1},Yo=function(F){vu(e.removed,{element:F});try{F.parentNode.removeChild(F)}catch{try{F.outerHTML=x}catch{F.remove()}}},wp=function(F,se){try{vu(e.removed,{attribute:se.getAttributeNode(F),from:se})}catch{vu(e.removed,{attribute:null,from:se})}if(se.removeAttribute(F),F==="is"&&!H[F])if(Ee||De)try{Yo(se)}catch{}else try{se.setAttribute(F,"")}catch{}},BE=function(F){var se,ce;if(Ve)F="<remove></remove>"+F;else{var lt=ZU(F,/^[\r\n\t ]+/);ce=lt&&lt[0]}It==="application/xhtml+xml"&&Fe===Ie&&(F='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+F+"</body></html>");var Jn=T?T.createHTML(F):F;if(Fe===Ie)try{se=new f().parseFromString(Jn,It)}catch{}if(!se||!se.documentElement){se=D.createDocument(Fe,"template",null);try{se.documentElement.innerHTML=yt?x:Jn}catch{}}var Rn=se.body||se.documentElement;return F&&ce&&Rn.insertBefore(r.createTextNode(ce),Rn.childNodes[0]||null),Fe===Ie?z.call(se,X?"html":"body")[0]:X?se.documentElement:Rn},WE=function(F){return U.call(F.ownerDocument||F,F,a.SHOW_ELEMENT|a.SHOW_COMMENT|a.SHOW_TEXT,null,!1)},zN=function(F){return F instanceof h&&(typeof F.nodeName!="string"||typeof F.textContent!="string"||typeof F.removeChild!="function"||!(F.attributes instanceof c)||typeof F.removeAttribute!="function"||typeof F.setAttribute!="function"||typeof F.namespaceURI!="string"||typeof F.insertBefore!="function"||typeof F.hasChildNodes!="function")},cu=function(F){return Ji(s)==="object"?F instanceof s:F&&Ji(F)==="object"&&typeof F.nodeType=="number"&&typeof F.nodeName=="string"},Go=function(F,se,ce){ne[F]&&QU(ne[F],function(lt){lt.call(e,se,ce,mn)})},UE=function(F){var se;if(Go("beforeSanitizeElements",F,null),zN(F)||$n(/[\u0080-\uFFFF]/,F.nodeName))return Yo(F),!0;var ce=zt(F.nodeName);if(Go("uponSanitizeElement",F,{tagName:ce,allowedTags:_}),F.hasChildNodes()&&!cu(F.firstElementChild)&&(!cu(F.content)||!cu(F.content.firstElementChild))&&$n(/<[/\w]/g,F.innerHTML)&&$n(/<[/\w]/g,F.textContent)||ce==="select"&&$n(/<template/i,F.innerHTML))return Yo(F),!0;if(!_[ce]||Q[ce]){if(!Q[ce]&&jE(ce)&&(W.tagNameCheck instanceof RegExp&&$n(W.tagNameCheck,ce)||W.tagNameCheck instanceof Function&&W.tagNameCheck(ce)))return!1;if(B&&!N[ce]){var lt=C(F)||F.parentNode,Jn=w(F)||F.childNodes;if(Jn&&lt)for(var Rn=Jn.length,pn=Rn-1;pn>=0;--pn)lt.insertBefore(y(Jn[pn],!0),E(F))}return Yo(F),!0}return F instanceof l&&!UN(F)||(ce==="noscript"||ce==="noembed"||ce==="noframes")&&$n(/<\/no(script|embed|frames)/i,F.innerHTML)?(Yo(F),!0):(_e&&F.nodeType===3&&(se=F.textContent,se=Gr(se,ue," "),se=Gr(se,Re," "),se=Gr(se,Ne," "),F.textContent!==se&&(vu(e.removed,{element:F.cloneNode()}),F.textContent=se)),Go("afterSanitizeElements",F,null),!1)},zE=function(F,se,ce){if(R&&(se==="id"||se==="name")&&(ce in r||ce in Hs))return!1;if(!(fe&&!J[se]&&$n(Ae,se))){if(!(q&&$n(b,se))){if(!H[se]||J[se]){if(!(jE(F)&&(W.tagNameCheck instanceof RegExp&&$n(W.tagNameCheck,F)||W.tagNameCheck instanceof Function&&W.tagNameCheck(F))&&(W.attributeNameCheck instanceof RegExp&&$n(W.attributeNameCheck,se)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(se))||se==="is"&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&$n(W.tagNameCheck,ce)||W.tagNameCheck instanceof Function&&W.tagNameCheck(ce))))return!1}else if(!G[se]){if(!$n(v,Gr(ce,m,""))){if(!((se==="src"||se==="xlink:href"||se==="href")&&F!=="script"&&JU(ce,"data:")===0&&Y[F])){if(!(Oe&&!$n(d,Gr(ce,m,"")))){if(ce)return!1}}}}}}return!0},jE=function(F){return F.indexOf("-")>0},YE=function(F){var se,ce,lt,Jn;Go("beforeSanitizeAttributes",F,null);var Rn=F.attributes;if(Rn){var pn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:H};for(Jn=Rn.length;Jn--;){se=Rn[Jn];var Vh=se,cn=Vh.name,Cp=Vh.namespaceURI;if(ce=cn==="value"?se.value:ez(se.value),lt=zt(cn),pn.attrName=lt,pn.attrValue=ce,pn.keepAttr=!0,pn.forceKeepAttr=void 0,Go("uponSanitizeAttribute",F,pn),ce=pn.attrValue,!pn.forceKeepAttr&&(wp(cn,F),!!pn.keepAttr)){if(!xe&&$n(/\/>/i,ce)){wp(cn,F);continue}_e&&(ce=Gr(ce,ue," "),ce=Gr(ce,Re," "),ce=Gr(ce,Ne," "));var GE=zt(F.nodeName);if(zE(GE,lt,ce)){if(M&&(lt==="id"||lt==="name")&&(wp(cn,F),ce=P+ce),T&&Ji(g)==="object"&&typeof g.getAttributeType=="function"&&!Cp)switch(g.getAttributeType(GE,lt)){case"TrustedHTML":{ce=T.createHTML(ce);break}case"TrustedScriptURL":{ce=T.createScriptURL(ce);break}}try{Cp?F.setAttributeNS(Cp,cn,ce):F.setAttribute(cn,ce),G1(e.removed)}catch{}}}}Go("afterSanitizeAttributes",F,null)}},jN=function Te(F){var se,ce=WE(F);for(Go("beforeSanitizeShadowDOM",F,null);se=ce.nextNode();)Go("uponSanitizeShadowNode",se,null),!UE(se)&&(se.content instanceof o&&Te(se.content),YE(se));Go("afterSanitizeShadowDOM",F,null)};return e.sanitize=function(Te){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},se,ce,lt,Jn,Rn;if(yt=!Te,yt&&(Te="<!-->"),typeof Te!="string"&&!cu(Te))if(typeof Te.toString=="function"){if(Te=Te.toString(),typeof Te!="string")throw dw("dirty is not a string, aborting")}else throw dw("toString is not a function");if(!e.isSupported){if(Ji(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Te=="string")return t.toStaticHTML(Te);if(cu(Te))return t.toStaticHTML(Te.outerHTML)}return Te}if(Ye||on(F),e.removed=[],typeof Te=="string"&&(k=!1),k){if(Te.nodeName){var pn=zt(Te.nodeName);if(!_[pn]||Q[pn])throw dw("root node is forbidden and cannot be sanitized in-place")}}else if(Te instanceof s)se=BE("<!---->"),ce=se.ownerDocument.importNode(Te,!0),ce.nodeType===1&&ce.nodeName==="BODY"||ce.nodeName==="HTML"?se=ce:se.appendChild(ce);else{if(!Ee&&!_e&&!X&&Te.indexOf("<")===-1)return T&&be?T.createHTML(Te):Te;if(se=BE(Te),!se)return Ee?null:be?x:""}se&&Ve&&Yo(se.firstChild);for(var Vh=WE(k?Te:se);lt=Vh.nextNode();)lt.nodeType===3&&lt===Jn||UE(lt)||(lt.content instanceof o&&jN(lt.content),YE(lt),Jn=lt);if(Jn=null,k)return Te;if(Ee){if(De)for(Rn=j.call(se.ownerDocument);se.firstChild;)Rn.appendChild(se.firstChild);else Rn=se;return(H.shadowroot||H.shadowrootmod)&&(Rn=Z.call(n,Rn,!0)),Rn}var cn=X?se.outerHTML:se.innerHTML;return X&&_["!doctype"]&&se.ownerDocument&&se.ownerDocument.doctype&&se.ownerDocument.doctype.name&&$n(dz,se.ownerDocument.doctype.name)&&(cn="<!DOCTYPE "+se.ownerDocument.doctype.name+`>
`+cn),_e&&(cn=Gr(cn,ue," "),cn=Gr(cn,Re," "),cn=Gr(cn,Ne," ")),T&&be?T.createHTML(cn):cn},e.setConfig=function(Te){on(Te),Ye=!0},e.clearConfig=function(){mn=null,Ye=!1},e.isValidAttribute=function(Te,F,se){mn||on({});var ce=zt(Te),lt=zt(F);return zE(ce,lt,se)},e.addHook=function(Te,F){typeof F=="function"&&(ne[Te]=ne[Te]||[],vu(ne[Te],F))},e.removeHook=function(Te){if(ne[Te])return G1(ne[Te])},e.removeHooks=function(Te){ne[Te]&&(ne[Te]=[])},e.removeAllHooks=function(){ne={}},e}var mz=qA();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var QA;function ee(){return QA.apply(null,arguments)}function pz(t){QA=t}function ho(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function cl(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function it(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function f0(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(it(t,e))return!1;return!0}function rr(t){return t===void 0}function Ei(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function vh(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function ZA(t,e){var n=[],r,o=t.length;for(r=0;r<o;++r)n.push(e(t[r],r));return n}function rs(t,e){for(var n in e)it(e,n)&&(t[n]=e[n]);return it(e,"toString")&&(t.toString=e.toString),it(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Uo(t,e,n,r){return RH(t,e,n,r,!0).utc()}function wz(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ze(t){return t._pf==null&&(t._pf=wz()),t._pf}var ly;Array.prototype.some?ly=Array.prototype.some:ly=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function g0(t){if(t._isValid==null){var e=ze(t),n=ly.call(e.parsedDateParts,function(o){return o!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function pm(t){var e=Uo(NaN);return t!=null?rs(ze(e),t):ze(e).userInvalidated=!0,e}var Z1=ee.momentProperties=[],ww=!1;function m0(t,e){var n,r,o,i=Z1.length;if(rr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),rr(e._i)||(t._i=e._i),rr(e._f)||(t._f=e._f),rr(e._l)||(t._l=e._l),rr(e._strict)||(t._strict=e._strict),rr(e._tzm)||(t._tzm=e._tzm),rr(e._isUTC)||(t._isUTC=e._isUTC),rr(e._offset)||(t._offset=e._offset),rr(e._pf)||(t._pf=ze(e)),rr(e._locale)||(t._locale=e._locale),i>0)for(n=0;n<i;n++)r=Z1[n],o=e[r],rr(o)||(t[r]=o);return t}function yh(t){m0(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),ww===!1&&(ww=!0,ee.updateOffset(this),ww=!1)}function fo(t){return t instanceof yh||t!=null&&t._isAMomentObject!=null}function JA(t){ee.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function zr(t,e){var n=!0;return rs(function(){if(ee.deprecationHandler!=null&&ee.deprecationHandler(null,t),n){var r=[],o,i,s,l=arguments.length;for(i=0;i<l;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(s in arguments[0])it(arguments[0],s)&&(o+=s+": "+arguments[0][s]+", ");o=o.slice(0,-2)}else o=arguments[i];r.push(o)}JA(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var J1={};function eH(t,e){ee.deprecationHandler!=null&&ee.deprecationHandler(t,e),J1[t]||(JA(e),J1[t]=!0)}ee.suppressDeprecationWarnings=!1;ee.deprecationHandler=null;function zo(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function Cz(t){var e,n;for(n in t)it(t,n)&&(e=t[n],zo(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ay(t,e){var n=rs({},t),r;for(r in e)it(e,r)&&(cl(t[r])&&cl(e[r])?(n[r]={},rs(n[r],t[r]),rs(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)it(t,r)&&!it(e,r)&&cl(t[r])&&(n[r]=rs({},n[r]));return n}function p0(t){t!=null&&this.set(t)}var uy;Object.keys?uy=Object.keys:uy=function(t){var e,n=[];for(e in t)it(t,e)&&n.push(e);return n};var vz={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function yz(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return zo(r)?r.call(e,n):r}function Vo(t,e,n){var r=""+Math.abs(t),o=e-r.length,i=t>=0;return(i?n?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+r}var w0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,cd=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Cw={},Ia={};function Me(t,e,n,r){var o=r;typeof r=="string"&&(o=function(){return this[r]()}),t&&(Ia[t]=o),e&&(Ia[e[0]]=function(){return Vo(o.apply(this,arguments),e[1],e[2])}),n&&(Ia[n]=function(){return this.localeData().ordinal(o.apply(this,arguments),t)})}function Sz(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Rz(t){var e=t.match(w0),n,r;for(n=0,r=e.length;n<r;n++)Ia[e[n]]?e[n]=Ia[e[n]]:e[n]=Sz(e[n]);return function(o){var i="",s;for(s=0;s<r;s++)i+=zo(e[s])?e[s].call(o,t):e[s];return i}}function Mf(t,e){return t.isValid()?(e=tH(e,t.localeData()),Cw[e]=Cw[e]||Rz(e),Cw[e](t)):t.localeData().invalidDate()}function tH(t,e){var n=5;function r(o){return e.longDateFormat(o)||o}for(cd.lastIndex=0;n>=0&&cd.test(t);)t=t.replace(cd,r),cd.lastIndex=0,n-=1;return t}var bz={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Ez(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(w0).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var Tz="Invalid date";function Mz(){return this._invalidDate}var xz="%d",_z=/\d{1,2}/;function Oz(t){return this._ordinal.replace("%d",t)}var Iz={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Az(t,e,n,r){var o=this._relativeTime[n];return zo(o)?o(t,e,n,r):o.replace(/%d/i,t)}function Hz(t,e){var n=this._relativeTime[t>0?"future":"past"];return zo(n)?n(e):n.replace(/%s/i,e)}var gc={};function Nn(t,e){var n=t.toLowerCase();gc[n]=gc[n+"s"]=gc[e]=t}function jr(t){return typeof t=="string"?gc[t]||gc[t.toLowerCase()]:void 0}function C0(t){var e={},n,r;for(r in t)it(t,r)&&(n=jr(r),n&&(e[n]=t[r]));return e}var nH={};function Ln(t,e){nH[t]=e}function Pz(t){var e=[],n;for(n in t)it(t,n)&&e.push({unit:n,priority:nH[n]});return e.sort(function(r,o){return r.priority-o.priority}),e}function wm(t){return t%4===0&&t%100!==0||t%400===0}function Nr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Qe(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Nr(e)),n}function tu(t,e){return function(n){return n!=null?(rH(this,t,n),ee.updateOffset(this,e),this):Cg(this,t)}}function Cg(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function rH(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&wm(t.year())&&t.month()===1&&t.date()===29?(n=Qe(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),bm(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function kz(t){return t=jr(t),zo(this[t])?this[t]():this}function Dz(t,e){if(typeof t=="object"){t=C0(t);var n=Pz(t),r,o=n.length;for(r=0;r<o;r++)this[n[r].unit](t[n[r].unit])}else if(t=jr(t),zo(this[t]))return this[t](e);return this}var oH=/\d/,Mr=/\d\d/,iH=/\d{3}/,v0=/\d{4}/,Cm=/[+-]?\d{6}/,Ot=/\d\d?/,sH=/\d\d\d\d?/,lH=/\d\d\d\d\d\d?/,vm=/\d{1,3}/,y0=/\d{1,4}/,ym=/[+-]?\d{1,6}/,nu=/\d+/,Sm=/[+-]?\d+/,Nz=/Z|[+-]\d\d:?\d\d/gi,Rm=/Z|[+-]\d\d(?::?\d\d)?/gi,Lz=/[+-]?\d+(\.\d{1,3})?/,Sh=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,vg;vg={};function Ce(t,e,n){vg[t]=zo(e)?e:function(r,o){return r&&n?n:e}}function Fz(t,e){return it(vg,t)?vg[t](e._strict,e._locale):new RegExp($z(t))}function $z(t){return pr(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,o,i){return n||r||o||i}))}function pr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var cy={};function ft(t,e){var n,r=e,o;for(typeof t=="string"&&(t=[t]),Ei(e)&&(r=function(i,s){s[e]=Qe(i)}),o=t.length,n=0;n<o;n++)cy[t[n]]=r}function Rh(t,e){ft(t,function(n,r,o,i){o._w=o._w||{},e(n,o._w,o,i)})}function Vz(t,e,n){e!=null&&it(cy,t)&&cy[t](e,n._a,n,t)}var An=0,fi=1,ko=2,an=3,oo=4,gi=5,ol=6,Bz=7,Wz=8;function Uz(t,e){return(t%e+e)%e}var Xt;Array.prototype.indexOf?Xt=Array.prototype.indexOf:Xt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function bm(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=Uz(e,12);return t+=(e-n)/12,n===1?wm(t)?29:28:31-n%7%2}Me("M",["MM",2],"Mo",function(){return this.month()+1});Me("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Me("MMMM",0,0,function(t){return this.localeData().months(this,t)});Nn("month","M");Ln("month",8);Ce("M",Ot);Ce("MM",Ot,Mr);Ce("MMM",function(t,e){return e.monthsShortRegex(t)});Ce("MMMM",function(t,e){return e.monthsRegex(t)});ft(["M","MM"],function(t,e){e[fi]=Qe(t)-1});ft(["MMM","MMMM"],function(t,e,n,r){var o=n._locale.monthsParse(t,r,n._strict);o!=null?e[fi]=o:ze(n).invalidMonth=t});var zz="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),aH="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),uH=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,jz=Sh,Yz=Sh;function Gz(t,e){return t?ho(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||uH).test(e)?"format":"standalone"][t.month()]:ho(this._months)?this._months:this._months.standalone}function Kz(t,e){return t?ho(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[uH.test(e)?"format":"standalone"][t.month()]:ho(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Xz(t,e,n){var r,o,i,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)i=Uo([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(i,"").toLocaleLowerCase();return n?e==="MMM"?(o=Xt.call(this._shortMonthsParse,s),o!==-1?o:null):(o=Xt.call(this._longMonthsParse,s),o!==-1?o:null):e==="MMM"?(o=Xt.call(this._shortMonthsParse,s),o!==-1?o:(o=Xt.call(this._longMonthsParse,s),o!==-1?o:null)):(o=Xt.call(this._longMonthsParse,s),o!==-1?o:(o=Xt.call(this._shortMonthsParse,s),o!==-1?o:null))}function qz(t,e,n){var r,o,i;if(this._monthsParseExact)return Xz.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(o=Uo([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[r]=new RegExp(i.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function cH(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Qe(e);else if(e=t.localeData().monthsParse(e),!Ei(e))return t}return n=Math.min(t.date(),bm(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function hH(t){return t!=null?(cH(this,t),ee.updateOffset(this,!0),this):Cg(this,"Month")}function Qz(){return bm(this.year(),this.month())}function Zz(t){return this._monthsParseExact?(it(this,"_monthsRegex")||dH.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(it(this,"_monthsShortRegex")||(this._monthsShortRegex=jz),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Jz(t){return this._monthsParseExact?(it(this,"_monthsRegex")||dH.call(this),t?this._monthsStrictRegex:this._monthsRegex):(it(this,"_monthsRegex")||(this._monthsRegex=Yz),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function dH(){function t(s,l){return l.length-s.length}var e=[],n=[],r=[],o,i;for(o=0;o<12;o++)i=Uo([2e3,o]),e.push(this.monthsShort(i,"")),n.push(this.months(i,"")),r.push(this.months(i,"")),r.push(this.monthsShort(i,""));for(e.sort(t),n.sort(t),r.sort(t),o=0;o<12;o++)e[o]=pr(e[o]),n[o]=pr(n[o]);for(o=0;o<24;o++)r[o]=pr(r[o]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Me("Y",0,0,function(){var t=this.year();return t<=9999?Vo(t,4):"+"+t});Me(0,["YY",2],0,function(){return this.year()%100});Me(0,["YYYY",4],0,"year");Me(0,["YYYYY",5],0,"year");Me(0,["YYYYYY",6,!0],0,"year");Nn("year","y");Ln("year",1);Ce("Y",Sm);Ce("YY",Ot,Mr);Ce("YYYY",y0,v0);Ce("YYYYY",ym,Cm);Ce("YYYYYY",ym,Cm);ft(["YYYYY","YYYYYY"],An);ft("YYYY",function(t,e){e[An]=t.length===2?ee.parseTwoDigitYear(t):Qe(t)});ft("YY",function(t,e){e[An]=ee.parseTwoDigitYear(t)});ft("Y",function(t,e){e[An]=parseInt(t,10)});function mc(t){return wm(t)?366:365}ee.parseTwoDigitYear=function(t){return Qe(t)+(Qe(t)>68?1900:2e3)};var fH=tu("FullYear",!0);function ej(){return wm(this.year())}function tj(t,e,n,r,o,i,s){var l;return t<100&&t>=0?(l=new Date(t+400,e,n,r,o,i,s),isFinite(l.getFullYear())&&l.setFullYear(t)):l=new Date(t,e,n,r,o,i,s),l}function Yc(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function yg(t,e,n){var r=7+e-n,o=(7+Yc(t,0,r).getUTCDay()-e)%7;return-o+r-1}function gH(t,e,n,r,o){var i=(7+n-r)%7,s=yg(t,r,o),l=1+7*(e-1)+i+s,a,u;return l<=0?(a=t-1,u=mc(a)+l):l>mc(t)?(a=t+1,u=l-mc(t)):(a=t,u=l),{year:a,dayOfYear:u}}function Gc(t,e,n){var r=yg(t.year(),e,n),o=Math.floor((t.dayOfYear()-r-1)/7)+1,i,s;return o<1?(s=t.year()-1,i=o+vi(s,e,n)):o>vi(t.year(),e,n)?(i=o-vi(t.year(),e,n),s=t.year()+1):(s=t.year(),i=o),{week:i,year:s}}function vi(t,e,n){var r=yg(t,e,n),o=yg(t+1,e,n);return(mc(t)-r+o)/7}Me("w",["ww",2],"wo","week");Me("W",["WW",2],"Wo","isoWeek");Nn("week","w");Nn("isoWeek","W");Ln("week",5);Ln("isoWeek",5);Ce("w",Ot);Ce("ww",Ot,Mr);Ce("W",Ot);Ce("WW",Ot,Mr);Rh(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Qe(t)});function nj(t){return Gc(t,this._week.dow,this._week.doy).week}var rj={dow:0,doy:6};function oj(){return this._week.dow}function ij(){return this._week.doy}function sj(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function lj(t){var e=Gc(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Me("d",0,"do","day");Me("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Me("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Me("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Me("e",0,0,"weekday");Me("E",0,0,"isoWeekday");Nn("day","d");Nn("weekday","e");Nn("isoWeekday","E");Ln("day",11);Ln("weekday",11);Ln("isoWeekday",11);Ce("d",Ot);Ce("e",Ot);Ce("E",Ot);Ce("dd",function(t,e){return e.weekdaysMinRegex(t)});Ce("ddd",function(t,e){return e.weekdaysShortRegex(t)});Ce("dddd",function(t,e){return e.weekdaysRegex(t)});Rh(["dd","ddd","dddd"],function(t,e,n,r){var o=n._locale.weekdaysParse(t,r,n._strict);o!=null?e.d=o:ze(n).invalidWeekday=t});Rh(["d","e","E"],function(t,e,n,r){e[r]=Qe(t)});function aj(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function uj(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function S0(t,e){return t.slice(e,7).concat(t.slice(0,e))}var cj="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),mH="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),hj="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),dj=Sh,fj=Sh,gj=Sh;function mj(t,e){var n=ho(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?S0(n,this._week.dow):t?n[t.day()]:n}function pj(t){return t===!0?S0(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function wj(t){return t===!0?S0(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function Cj(t,e,n){var r,o,i,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)i=Uo([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(i,"").toLocaleLowerCase();return n?e==="dddd"?(o=Xt.call(this._weekdaysParse,s),o!==-1?o:null):e==="ddd"?(o=Xt.call(this._shortWeekdaysParse,s),o!==-1?o:null):(o=Xt.call(this._minWeekdaysParse,s),o!==-1?o:null):e==="dddd"?(o=Xt.call(this._weekdaysParse,s),o!==-1||(o=Xt.call(this._shortWeekdaysParse,s),o!==-1)?o:(o=Xt.call(this._minWeekdaysParse,s),o!==-1?o:null)):e==="ddd"?(o=Xt.call(this._shortWeekdaysParse,s),o!==-1||(o=Xt.call(this._weekdaysParse,s),o!==-1)?o:(o=Xt.call(this._minWeekdaysParse,s),o!==-1?o:null)):(o=Xt.call(this._minWeekdaysParse,s),o!==-1||(o=Xt.call(this._weekdaysParse,s),o!==-1)?o:(o=Xt.call(this._shortWeekdaysParse,s),o!==-1?o:null))}function vj(t,e,n){var r,o,i;if(this._weekdaysParseExact)return Cj.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(o=Uo([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[r]=new RegExp(i.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function yj(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=aj(t,this.localeData()),this.add(t-e,"d")):e}function Sj(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function Rj(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=uj(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function bj(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||R0.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(it(this,"_weekdaysRegex")||(this._weekdaysRegex=dj),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function Ej(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||R0.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(it(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=fj),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Tj(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||R0.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(it(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=gj),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function R0(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],o=[],i,s,l,a,u;for(i=0;i<7;i++)s=Uo([2e3,1]).day(i),l=pr(this.weekdaysMin(s,"")),a=pr(this.weekdaysShort(s,"")),u=pr(this.weekdays(s,"")),e.push(l),n.push(a),r.push(u),o.push(l),o.push(a),o.push(u);e.sort(t),n.sort(t),r.sort(t),o.sort(t),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function b0(){return this.hours()%12||12}function Mj(){return this.hours()||24}Me("H",["HH",2],0,"hour");Me("h",["hh",2],0,b0);Me("k",["kk",2],0,Mj);Me("hmm",0,0,function(){return""+b0.apply(this)+Vo(this.minutes(),2)});Me("hmmss",0,0,function(){return""+b0.apply(this)+Vo(this.minutes(),2)+Vo(this.seconds(),2)});Me("Hmm",0,0,function(){return""+this.hours()+Vo(this.minutes(),2)});Me("Hmmss",0,0,function(){return""+this.hours()+Vo(this.minutes(),2)+Vo(this.seconds(),2)});function pH(t,e){Me(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}pH("a",!0);pH("A",!1);Nn("hour","h");Ln("hour",13);function wH(t,e){return e._meridiemParse}Ce("a",wH);Ce("A",wH);Ce("H",Ot);Ce("h",Ot);Ce("k",Ot);Ce("HH",Ot,Mr);Ce("hh",Ot,Mr);Ce("kk",Ot,Mr);Ce("hmm",sH);Ce("hmmss",lH);Ce("Hmm",sH);Ce("Hmmss",lH);ft(["H","HH"],an);ft(["k","kk"],function(t,e,n){var r=Qe(t);e[an]=r===24?0:r});ft(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});ft(["h","hh"],function(t,e,n){e[an]=Qe(t),ze(n).bigHour=!0});ft("hmm",function(t,e,n){var r=t.length-2;e[an]=Qe(t.substr(0,r)),e[oo]=Qe(t.substr(r)),ze(n).bigHour=!0});ft("hmmss",function(t,e,n){var r=t.length-4,o=t.length-2;e[an]=Qe(t.substr(0,r)),e[oo]=Qe(t.substr(r,2)),e[gi]=Qe(t.substr(o)),ze(n).bigHour=!0});ft("Hmm",function(t,e,n){var r=t.length-2;e[an]=Qe(t.substr(0,r)),e[oo]=Qe(t.substr(r))});ft("Hmmss",function(t,e,n){var r=t.length-4,o=t.length-2;e[an]=Qe(t.substr(0,r)),e[oo]=Qe(t.substr(r,2)),e[gi]=Qe(t.substr(o))});function xj(t){return(t+"").toLowerCase().charAt(0)==="p"}var _j=/[ap]\.?m?\.?/i,Oj=tu("Hours",!0);function Ij(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var CH={calendar:vz,longDateFormat:bz,invalidDate:Tz,ordinal:xz,dayOfMonthOrdinalParse:_z,relativeTime:Iz,months:zz,monthsShort:aH,week:rj,weekdays:cj,weekdaysMin:hj,weekdaysShort:mH,meridiemParse:_j},At={},yu={},Kc;function Aj(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function eM(t){return t&&t.toLowerCase().replace("_","-")}function Hj(t){for(var e=0,n,r,o,i;e<t.length;){for(i=eM(t[e]).split("-"),n=i.length,r=eM(t[e+1]),r=r?r.split("-"):null;n>0;){if(o=Em(i.slice(0,n).join("-")),o)return o;if(r&&r.length>=n&&Aj(i,r)>=n-1)break;n--}e++}return Kc}function Pj(t){return t.match("^[^/\\\\]*$")!=null}function Em(t){var e=null,n;if(At[t]===void 0&&typeof Wf<"u"&&Wf&&Wf.exports&&Pj(t))try{e=Kc._abbr,n=require,n("./locale/"+t),ms(e)}catch{At[t]=null}return At[t]}function ms(t,e){var n;return t&&(rr(e)?n=Oi(t):n=E0(t,e),n?Kc=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Kc._abbr}function E0(t,e){if(e!==null){var n,r=CH;if(e.abbr=t,At[t]!=null)eH("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=At[t]._config;else if(e.parentLocale!=null)if(At[e.parentLocale]!=null)r=At[e.parentLocale]._config;else if(n=Em(e.parentLocale),n!=null)r=n._config;else return yu[e.parentLocale]||(yu[e.parentLocale]=[]),yu[e.parentLocale].push({name:t,config:e}),null;return At[t]=new p0(ay(r,e)),yu[t]&&yu[t].forEach(function(o){E0(o.name,o.config)}),ms(t),At[t]}else return delete At[t],null}function kj(t,e){if(e!=null){var n,r,o=CH;At[t]!=null&&At[t].parentLocale!=null?At[t].set(ay(At[t]._config,e)):(r=Em(t),r!=null&&(o=r._config),e=ay(o,e),r==null&&(e.abbr=t),n=new p0(e),n.parentLocale=At[t],At[t]=n),ms(t)}else At[t]!=null&&(At[t].parentLocale!=null?(At[t]=At[t].parentLocale,t===ms()&&ms(t)):At[t]!=null&&delete At[t]);return At[t]}function Oi(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Kc;if(!ho(t)){if(e=Em(t),e)return e;t=[t]}return Hj(t)}function Dj(){return uy(At)}function T0(t){var e,n=t._a;return n&&ze(t).overflow===-2&&(e=n[fi]<0||n[fi]>11?fi:n[ko]<1||n[ko]>bm(n[An],n[fi])?ko:n[an]<0||n[an]>24||n[an]===24&&(n[oo]!==0||n[gi]!==0||n[ol]!==0)?an:n[oo]<0||n[oo]>59?oo:n[gi]<0||n[gi]>59?gi:n[ol]<0||n[ol]>999?ol:-1,ze(t)._overflowDayOfYear&&(e<An||e>ko)&&(e=ko),ze(t)._overflowWeeks&&e===-1&&(e=Bz),ze(t)._overflowWeekday&&e===-1&&(e=Wz),ze(t).overflow=e),t}var Nj=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Lj=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Fj=/Z|[+-]\d\d(?::?\d\d)?/,hd=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],vw=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],$j=/^\/?Date\((-?\d+)/i,Vj=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Bj={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function vH(t){var e,n,r=t._i,o=Nj.exec(r)||Lj.exec(r),i,s,l,a,u=hd.length,c=vw.length;if(o){for(ze(t).iso=!0,e=0,n=u;e<n;e++)if(hd[e][1].exec(o[1])){s=hd[e][0],i=hd[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(o[3]){for(e=0,n=c;e<n;e++)if(vw[e][1].exec(o[3])){l=(o[2]||" ")+vw[e][0];break}if(l==null){t._isValid=!1;return}}if(!i&&l!=null){t._isValid=!1;return}if(o[4])if(Fj.exec(o[4]))a="Z";else{t._isValid=!1;return}t._f=s+(l||"")+(a||""),x0(t)}else t._isValid=!1}function Wj(t,e,n,r,o,i){var s=[Uj(t),aH.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(o,10)];return i&&s.push(parseInt(i,10)),s}function Uj(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function zj(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function jj(t,e,n){if(t){var r=mH.indexOf(t),o=new Date(e[0],e[1],e[2]).getDay();if(r!==o)return ze(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function Yj(t,e,n){if(t)return Bj[t];if(e)return 0;var r=parseInt(n,10),o=r%100,i=(r-o)/100;return i*60+o}function yH(t){var e=Vj.exec(zj(t._i)),n;if(e){if(n=Wj(e[4],e[3],e[2],e[5],e[6],e[7]),!jj(e[1],n,t))return;t._a=n,t._tzm=Yj(e[8],e[9],e[10]),t._d=Yc.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),ze(t).rfc2822=!0}else t._isValid=!1}function Gj(t){var e=$j.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(vH(t),t._isValid===!1)delete t._isValid;else return;if(yH(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:ee.createFromInputFallback(t)}ee.createFromInputFallback=zr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function oa(t,e,n){return t??e??n}function Kj(t){var e=new Date(ee.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function M0(t){var e,n,r=[],o,i,s;if(!t._d){for(o=Kj(t),t._w&&t._a[ko]==null&&t._a[fi]==null&&Xj(t),t._dayOfYear!=null&&(s=oa(t._a[An],o[An]),(t._dayOfYear>mc(s)||t._dayOfYear===0)&&(ze(t)._overflowDayOfYear=!0),n=Yc(s,0,t._dayOfYear),t._a[fi]=n.getUTCMonth(),t._a[ko]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=o[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[an]===24&&t._a[oo]===0&&t._a[gi]===0&&t._a[ol]===0&&(t._nextDay=!0,t._a[an]=0),t._d=(t._useUTC?Yc:tj).apply(null,r),i=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[an]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==i&&(ze(t).weekdayMismatch=!0)}}function Xj(t){var e,n,r,o,i,s,l,a,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(i=1,s=4,n=oa(e.GG,t._a[An],Gc(_t(),1,4).year),r=oa(e.W,1),o=oa(e.E,1),(o<1||o>7)&&(a=!0)):(i=t._locale._week.dow,s=t._locale._week.doy,u=Gc(_t(),i,s),n=oa(e.gg,t._a[An],u.year),r=oa(e.w,u.week),e.d!=null?(o=e.d,(o<0||o>6)&&(a=!0)):e.e!=null?(o=e.e+i,(e.e<0||e.e>6)&&(a=!0)):o=i),r<1||r>vi(n,i,s)?ze(t)._overflowWeeks=!0:a!=null?ze(t)._overflowWeekday=!0:(l=gH(n,r,o,i,s),t._a[An]=l.year,t._dayOfYear=l.dayOfYear)}ee.ISO_8601=function(){};ee.RFC_2822=function(){};function x0(t){if(t._f===ee.ISO_8601){vH(t);return}if(t._f===ee.RFC_2822){yH(t);return}t._a=[],ze(t).empty=!0;var e=""+t._i,n,r,o,i,s,l=e.length,a=0,u,c;for(o=tH(t._f,t._locale).match(w0)||[],c=o.length,n=0;n<c;n++)i=o[n],r=(e.match(Fz(i,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&ze(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),a+=r.length),Ia[i]?(r?ze(t).empty=!1:ze(t).unusedTokens.push(i),Vz(i,r,t)):t._strict&&!r&&ze(t).unusedTokens.push(i);ze(t).charsLeftOver=l-a,e.length>0&&ze(t).unusedInput.push(e),t._a[an]<=12&&ze(t).bigHour===!0&&t._a[an]>0&&(ze(t).bigHour=void 0),ze(t).parsedDateParts=t._a.slice(0),ze(t).meridiem=t._meridiem,t._a[an]=qj(t._locale,t._a[an],t._meridiem),u=ze(t).era,u!==null&&(t._a[An]=t._locale.erasConvertYear(u,t._a[An])),M0(t),T0(t)}function qj(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function Qj(t){var e,n,r,o,i,s,l=!1,a=t._f.length;if(a===0){ze(t).invalidFormat=!0,t._d=new Date(NaN);return}for(o=0;o<a;o++)i=0,s=!1,e=m0({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[o],x0(e),g0(e)&&(s=!0),i+=ze(e).charsLeftOver,i+=ze(e).unusedTokens.length*10,ze(e).score=i,l?i<r&&(r=i,n=e):(r==null||i<r||s)&&(r=i,n=e,s&&(l=!0));rs(t,n||e)}function Zj(t){if(!t._d){var e=C0(t._i),n=e.day===void 0?e.date:e.day;t._a=ZA([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),M0(t)}}function Jj(t){var e=new yh(T0(SH(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function SH(t){var e=t._i,n=t._f;return t._locale=t._locale||Oi(t._l),e===null||n===void 0&&e===""?pm({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),fo(e)?new yh(T0(e)):(vh(e)?t._d=e:ho(n)?Qj(t):n?x0(t):eY(t),g0(t)||(t._d=null),t))}function eY(t){var e=t._i;rr(e)?t._d=new Date(ee.now()):vh(e)?t._d=new Date(e.valueOf()):typeof e=="string"?Gj(t):ho(e)?(t._a=ZA(e.slice(0),function(n){return parseInt(n,10)}),M0(t)):cl(e)?Zj(t):Ei(e)?t._d=new Date(e):ee.createFromInputFallback(t)}function RH(t,e,n,r,o){var i={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(cl(t)&&f0(t)||ho(t)&&t.length===0)&&(t=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=n,i._i=t,i._f=e,i._strict=r,Jj(i)}function _t(t,e,n,r){return RH(t,e,n,r,!1)}var tY=zr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=_t.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:pm()}),nY=zr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=_t.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:pm()});function bH(t,e){var n,r;if(e.length===1&&ho(e[0])&&(e=e[0]),!e.length)return _t();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function rY(){var t=[].slice.call(arguments,0);return bH("isBefore",t)}function oY(){var t=[].slice.call(arguments,0);return bH("isAfter",t)}var iY=function(){return Date.now?Date.now():+new Date},Su=["year","quarter","month","week","day","hour","minute","second","millisecond"];function sY(t){var e,n=!1,r,o=Su.length;for(e in t)if(it(t,e)&&!(Xt.call(Su,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<o;++r)if(t[Su[r]]){if(n)return!1;parseFloat(t[Su[r]])!==Qe(t[Su[r]])&&(n=!0)}return!0}function lY(){return this._isValid}function aY(){return mo(NaN)}function Tm(t){var e=C0(t),n=e.year||0,r=e.quarter||0,o=e.month||0,i=e.week||e.isoWeek||0,s=e.day||0,l=e.hour||0,a=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=sY(e),this._milliseconds=+c+u*1e3+a*6e4+l*1e3*60*60,this._days=+s+i*7,this._months=+o+r*3+n*12,this._data={},this._locale=Oi(),this._bubble()}function xf(t){return t instanceof Tm}function hy(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function uY(t,e,n){var r=Math.min(t.length,e.length),o=Math.abs(t.length-e.length),i=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&Qe(t[s])!==Qe(e[s]))&&i++;return i+o}function EH(t,e){Me(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Vo(~~(n/60),2)+e+Vo(~~n%60,2)})}EH("Z",":");EH("ZZ","");Ce("Z",Rm);Ce("ZZ",Rm);ft(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=_0(Rm,t)});var cY=/([\+\-]|\d\d)/gi;function _0(t,e){var n=(e||"").match(t),r,o,i;return n===null?null:(r=n[n.length-1]||[],o=(r+"").match(cY)||["-",0,0],i=+(o[1]*60)+Qe(o[2]),i===0?0:o[0]==="+"?i:-i)}function O0(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(fo(t)||vh(t)?t.valueOf():_t(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),ee.updateOffset(n,!1),n):_t(t).local()}function dy(t){return-Math.round(t._d.getTimezoneOffset())}ee.updateOffset=function(){};function hY(t,e,n){var r=this._offset||0,o;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=_0(Rm,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(o=dy(this)),this._offset=t,this._isUTC=!0,o!=null&&this.add(o,"m"),r!==t&&(!e||this._changeInProgress?xH(this,mo(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ee.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:dy(this)}function dY(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function fY(t){return this.utcOffset(0,t)}function gY(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(dy(this),"m")),this}function mY(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=_0(Nz,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function pY(t){return this.isValid()?(t=t?_t(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function wY(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function CY(){if(!rr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return m0(t,this),t=SH(t),t._a?(e=t._isUTC?Uo(t._a):_t(t._a),this._isDSTShifted=this.isValid()&&uY(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function vY(){return this.isValid()?!this._isUTC:!1}function yY(){return this.isValid()?this._isUTC:!1}function TH(){return this.isValid()?this._isUTC&&this._offset===0:!1}var SY=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,RY=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function mo(t,e){var n=t,r=null,o,i,s;return xf(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Ei(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=SY.exec(t))?(o=r[1]==="-"?-1:1,n={y:0,d:Qe(r[ko])*o,h:Qe(r[an])*o,m:Qe(r[oo])*o,s:Qe(r[gi])*o,ms:Qe(hy(r[ol]*1e3))*o}):(r=RY.exec(t))?(o=r[1]==="-"?-1:1,n={y:Ds(r[2],o),M:Ds(r[3],o),w:Ds(r[4],o),d:Ds(r[5],o),h:Ds(r[6],o),m:Ds(r[7],o),s:Ds(r[8],o)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=bY(_t(n.from),_t(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),i=new Tm(n),xf(t)&&it(t,"_locale")&&(i._locale=t._locale),xf(t)&&it(t,"_isValid")&&(i._isValid=t._isValid),i}mo.fn=Tm.prototype;mo.invalid=aY;function Ds(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function tM(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function bY(t,e){var n;return t.isValid()&&e.isValid()?(e=O0(e,t),t.isBefore(e)?n=tM(t,e):(n=tM(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function MH(t,e){return function(n,r){var o,i;return r!==null&&!isNaN(+r)&&(eH(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=r,r=i),o=mo(n,r),xH(this,o,t),this}}function xH(t,e,n,r){var o=e._milliseconds,i=hy(e._days),s=hy(e._months);t.isValid()&&(r=r??!0,s&&cH(t,Cg(t,"Month")+s*n),i&&rH(t,"Date",Cg(t,"Date")+i*n),o&&t._d.setTime(t._d.valueOf()+o*n),r&&ee.updateOffset(t,i||s))}var EY=MH(1,"add"),TY=MH(-1,"subtract");function _H(t){return typeof t=="string"||t instanceof String}function MY(t){return fo(t)||vh(t)||_H(t)||Ei(t)||_Y(t)||xY(t)||t===null||t===void 0}function xY(t){var e=cl(t)&&!f0(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,s=r.length;for(o=0;o<s;o+=1)i=r[o],n=n||it(t,i);return e&&n}function _Y(t){var e=ho(t),n=!1;return e&&(n=t.filter(function(r){return!Ei(r)&&_H(t)}).length===0),e&&n}function OY(t){var e=cl(t)&&!f0(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<r.length;o+=1)i=r[o],n=n||it(t,i);return e&&n}function IY(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function AY(t,e){arguments.length===1&&(arguments[0]?MY(arguments[0])?(t=arguments[0],e=void 0):OY(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||_t(),r=O0(n,this).startOf("day"),o=ee.calendarFormat(this,r)||"sameElse",i=e&&(zo(e[o])?e[o].call(this,n):e[o]);return this.format(i||this.localeData().calendar(o,this,_t(n)))}function HY(){return new yh(this)}function PY(t,e){var n=fo(t)?t:_t(t);return this.isValid()&&n.isValid()?(e=jr(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function kY(t,e){var n=fo(t)?t:_t(t);return this.isValid()&&n.isValid()?(e=jr(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function DY(t,e,n,r){var o=fo(t)?t:_t(t),i=fo(e)?e:_t(e);return this.isValid()&&o.isValid()&&i.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(o,n):!this.isBefore(o,n))&&(r[1]===")"?this.isBefore(i,n):!this.isAfter(i,n))):!1}function NY(t,e){var n=fo(t)?t:_t(t),r;return this.isValid()&&n.isValid()?(e=jr(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function LY(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function FY(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function $Y(t,e,n){var r,o,i;if(!this.isValid())return NaN;if(r=O0(t,this),!r.isValid())return NaN;switch(o=(r.utcOffset()-this.utcOffset())*6e4,e=jr(e),e){case"year":i=_f(this,r)/12;break;case"month":i=_f(this,r);break;case"quarter":i=_f(this,r)/3;break;case"second":i=(this-r)/1e3;break;case"minute":i=(this-r)/6e4;break;case"hour":i=(this-r)/36e5;break;case"day":i=(this-r-o)/864e5;break;case"week":i=(this-r-o)/6048e5;break;default:i=this-r}return n?i:Nr(i)}function _f(t,e){if(t.date()<e.date())return-_f(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),o,i;return e-r<0?(o=t.clone().add(n-1,"months"),i=(e-r)/(r-o)):(o=t.clone().add(n+1,"months"),i=(e-r)/(o-r)),-(n+i)||0}ee.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ee.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function VY(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function BY(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Mf(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):zo(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Mf(n,"Z")):Mf(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function WY(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,o,i;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=e+'[")]',this.format(n+r+o+i)}function UY(t){t||(t=this.isUtc()?ee.defaultFormatUtc:ee.defaultFormat);var e=Mf(this,t);return this.localeData().postformat(e)}function zY(t,e){return this.isValid()&&(fo(t)&&t.isValid()||_t(t).isValid())?mo({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function jY(t){return this.from(_t(),t)}function YY(t,e){return this.isValid()&&(fo(t)&&t.isValid()||_t(t).isValid())?mo({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function GY(t){return this.to(_t(),t)}function OH(t){var e;return t===void 0?this._locale._abbr:(e=Oi(t),e!=null&&(this._locale=e),this)}var IH=zr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function AH(){return this._locale}var Sg=1e3,Aa=60*Sg,Rg=60*Aa,HH=(365*400+97)*24*Rg;function Ha(t,e){return(t%e+e)%e}function PH(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-HH:new Date(t,e,n).valueOf()}function kH(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-HH:Date.UTC(t,e,n)}function KY(t){var e,n;if(t=jr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?kH:PH,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Ha(e+(this._isUTC?0:this.utcOffset()*Aa),Rg);break;case"minute":e=this._d.valueOf(),e-=Ha(e,Aa);break;case"second":e=this._d.valueOf(),e-=Ha(e,Sg);break}return this._d.setTime(e),ee.updateOffset(this,!0),this}function XY(t){var e,n;if(t=jr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?kH:PH,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Rg-Ha(e+(this._isUTC?0:this.utcOffset()*Aa),Rg)-1;break;case"minute":e=this._d.valueOf(),e+=Aa-Ha(e,Aa)-1;break;case"second":e=this._d.valueOf(),e+=Sg-Ha(e,Sg)-1;break}return this._d.setTime(e),ee.updateOffset(this,!0),this}function qY(){return this._d.valueOf()-(this._offset||0)*6e4}function QY(){return Math.floor(this.valueOf()/1e3)}function ZY(){return new Date(this.valueOf())}function JY(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function eG(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function tG(){return this.isValid()?this.toISOString():null}function nG(){return g0(this)}function rG(){return rs({},ze(this))}function oG(){return ze(this).overflow}function iG(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Me("N",0,0,"eraAbbr");Me("NN",0,0,"eraAbbr");Me("NNN",0,0,"eraAbbr");Me("NNNN",0,0,"eraName");Me("NNNNN",0,0,"eraNarrow");Me("y",["y",1],"yo","eraYear");Me("y",["yy",2],0,"eraYear");Me("y",["yyy",3],0,"eraYear");Me("y",["yyyy",4],0,"eraYear");Ce("N",I0);Ce("NN",I0);Ce("NNN",I0);Ce("NNNN",pG);Ce("NNNNN",wG);ft(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var o=n._locale.erasParse(t,r,n._strict);o?ze(n).era=o:ze(n).invalidEra=t});Ce("y",nu);Ce("yy",nu);Ce("yyy",nu);Ce("yyyy",nu);Ce("yo",CG);ft(["y","yy","yyy","yyyy"],An);ft(["yo"],function(t,e,n,r){var o;n._locale._eraYearOrdinalRegex&&(o=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[An]=n._locale.eraYearOrdinalParse(t,o):e[An]=parseInt(t,10)});function sG(t,e){var n,r,o,i=this._eras||Oi("en")._eras;for(n=0,r=i.length;n<r;++n){switch(typeof i[n].since){case"string":o=ee(i[n].since).startOf("day"),i[n].since=o.valueOf();break}switch(typeof i[n].until){case"undefined":i[n].until=1/0;break;case"string":o=ee(i[n].until).startOf("day").valueOf(),i[n].until=o.valueOf();break}}return i}function lG(t,e,n){var r,o,i=this.eras(),s,l,a;for(t=t.toUpperCase(),r=0,o=i.length;r<o;++r)if(s=i[r].name.toUpperCase(),l=i[r].abbr.toUpperCase(),a=i[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(l===t)return i[r];break;case"NNNN":if(s===t)return i[r];break;case"NNNNN":if(a===t)return i[r];break}else if([s,l,a].indexOf(t)>=0)return i[r]}function aG(t,e){var n=t.since<=t.until?1:-1;return e===void 0?ee(t.since).year():ee(t.since).year()+(e-t.offset)*n}function uG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function cG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function hG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function dG(){var t,e,n,r,o=this.localeData().eras();for(t=0,e=o.length;t<e;++t)if(n=o[t].since<=o[t].until?1:-1,r=this.clone().startOf("day").valueOf(),o[t].since<=r&&r<=o[t].until||o[t].until<=r&&r<=o[t].since)return(this.year()-ee(o[t].since).year())*n+o[t].offset;return this.year()}function fG(t){return it(this,"_erasNameRegex")||A0.call(this),t?this._erasNameRegex:this._erasRegex}function gG(t){return it(this,"_erasAbbrRegex")||A0.call(this),t?this._erasAbbrRegex:this._erasRegex}function mG(t){return it(this,"_erasNarrowRegex")||A0.call(this),t?this._erasNarrowRegex:this._erasRegex}function I0(t,e){return e.erasAbbrRegex(t)}function pG(t,e){return e.erasNameRegex(t)}function wG(t,e){return e.erasNarrowRegex(t)}function CG(t,e){return e._eraYearOrdinalRegex||nu}function A0(){var t=[],e=[],n=[],r=[],o,i,s=this.eras();for(o=0,i=s.length;o<i;++o)e.push(pr(s[o].name)),t.push(pr(s[o].abbr)),n.push(pr(s[o].narrow)),r.push(pr(s[o].name)),r.push(pr(s[o].abbr)),r.push(pr(s[o].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Me(0,["gg",2],0,function(){return this.weekYear()%100});Me(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Mm(t,e){Me(0,[t,t.length],0,e)}Mm("gggg","weekYear");Mm("ggggg","weekYear");Mm("GGGG","isoWeekYear");Mm("GGGGG","isoWeekYear");Nn("weekYear","gg");Nn("isoWeekYear","GG");Ln("weekYear",1);Ln("isoWeekYear",1);Ce("G",Sm);Ce("g",Sm);Ce("GG",Ot,Mr);Ce("gg",Ot,Mr);Ce("GGGG",y0,v0);Ce("gggg",y0,v0);Ce("GGGGG",ym,Cm);Ce("ggggg",ym,Cm);Rh(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Qe(t)});Rh(["gg","GG"],function(t,e,n,r){e[r]=ee.parseTwoDigitYear(t)});function vG(t){return DH.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function yG(t){return DH.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function SG(){return vi(this.year(),1,4)}function RG(){return vi(this.isoWeekYear(),1,4)}function bG(){var t=this.localeData()._week;return vi(this.year(),t.dow,t.doy)}function EG(){var t=this.localeData()._week;return vi(this.weekYear(),t.dow,t.doy)}function DH(t,e,n,r,o){var i;return t==null?Gc(this,r,o).year:(i=vi(t,r,o),e>i&&(e=i),TG.call(this,t,e,n,r,o))}function TG(t,e,n,r,o){var i=gH(t,e,n,r,o),s=Yc(i.year,0,i.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Me("Q",0,"Qo","quarter");Nn("quarter","Q");Ln("quarter",7);Ce("Q",oH);ft("Q",function(t,e){e[fi]=(Qe(t)-1)*3});function MG(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Me("D",["DD",2],"Do","date");Nn("date","D");Ln("date",9);Ce("D",Ot);Ce("DD",Ot,Mr);Ce("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});ft(["D","DD"],ko);ft("Do",function(t,e){e[ko]=Qe(t.match(Ot)[0])});var NH=tu("Date",!0);Me("DDD",["DDDD",3],"DDDo","dayOfYear");Nn("dayOfYear","DDD");Ln("dayOfYear",4);Ce("DDD",vm);Ce("DDDD",iH);ft(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Qe(t)});function xG(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Me("m",["mm",2],0,"minute");Nn("minute","m");Ln("minute",14);Ce("m",Ot);Ce("mm",Ot,Mr);ft(["m","mm"],oo);var _G=tu("Minutes",!1);Me("s",["ss",2],0,"second");Nn("second","s");Ln("second",15);Ce("s",Ot);Ce("ss",Ot,Mr);ft(["s","ss"],gi);var OG=tu("Seconds",!1);Me("S",0,0,function(){return~~(this.millisecond()/100)});Me(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Me(0,["SSS",3],0,"millisecond");Me(0,["SSSS",4],0,function(){return this.millisecond()*10});Me(0,["SSSSS",5],0,function(){return this.millisecond()*100});Me(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Me(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Me(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Me(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Nn("millisecond","ms");Ln("millisecond",16);Ce("S",vm,oH);Ce("SS",vm,Mr);Ce("SSS",vm,iH);var os,LH;for(os="SSSS";os.length<=9;os+="S")Ce(os,nu);function IG(t,e){e[ol]=Qe(("0."+t)*1e3)}for(os="S";os.length<=9;os+="S")ft(os,IG);LH=tu("Milliseconds",!1);Me("z",0,0,"zoneAbbr");Me("zz",0,0,"zoneName");function AG(){return this._isUTC?"UTC":""}function HG(){return this._isUTC?"Coordinated Universal Time":""}var ie=yh.prototype;ie.add=EY;ie.calendar=AY;ie.clone=HY;ie.diff=$Y;ie.endOf=XY;ie.format=UY;ie.from=zY;ie.fromNow=jY;ie.to=YY;ie.toNow=GY;ie.get=kz;ie.invalidAt=oG;ie.isAfter=PY;ie.isBefore=kY;ie.isBetween=DY;ie.isSame=NY;ie.isSameOrAfter=LY;ie.isSameOrBefore=FY;ie.isValid=nG;ie.lang=IH;ie.locale=OH;ie.localeData=AH;ie.max=nY;ie.min=tY;ie.parsingFlags=rG;ie.set=Dz;ie.startOf=KY;ie.subtract=TY;ie.toArray=JY;ie.toObject=eG;ie.toDate=ZY;ie.toISOString=BY;ie.inspect=WY;typeof Symbol<"u"&&Symbol.for!=null&&(ie[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ie.toJSON=tG;ie.toString=VY;ie.unix=QY;ie.valueOf=qY;ie.creationData=iG;ie.eraName=uG;ie.eraNarrow=cG;ie.eraAbbr=hG;ie.eraYear=dG;ie.year=fH;ie.isLeapYear=ej;ie.weekYear=vG;ie.isoWeekYear=yG;ie.quarter=ie.quarters=MG;ie.month=hH;ie.daysInMonth=Qz;ie.week=ie.weeks=sj;ie.isoWeek=ie.isoWeeks=lj;ie.weeksInYear=bG;ie.weeksInWeekYear=EG;ie.isoWeeksInYear=SG;ie.isoWeeksInISOWeekYear=RG;ie.date=NH;ie.day=ie.days=yj;ie.weekday=Sj;ie.isoWeekday=Rj;ie.dayOfYear=xG;ie.hour=ie.hours=Oj;ie.minute=ie.minutes=_G;ie.second=ie.seconds=OG;ie.millisecond=ie.milliseconds=LH;ie.utcOffset=hY;ie.utc=fY;ie.local=gY;ie.parseZone=mY;ie.hasAlignedHourOffset=pY;ie.isDST=wY;ie.isLocal=vY;ie.isUtcOffset=yY;ie.isUtc=TH;ie.isUTC=TH;ie.zoneAbbr=AG;ie.zoneName=HG;ie.dates=zr("dates accessor is deprecated. Use date instead.",NH);ie.months=zr("months accessor is deprecated. Use month instead",hH);ie.years=zr("years accessor is deprecated. Use year instead",fH);ie.zone=zr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",dY);ie.isDSTShifted=zr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",CY);function PG(t){return _t(t*1e3)}function kG(){return _t.apply(null,arguments).parseZone()}function FH(t){return t}var st=p0.prototype;st.calendar=yz;st.longDateFormat=Ez;st.invalidDate=Mz;st.ordinal=Oz;st.preparse=FH;st.postformat=FH;st.relativeTime=Az;st.pastFuture=Hz;st.set=Cz;st.eras=sG;st.erasParse=lG;st.erasConvertYear=aG;st.erasAbbrRegex=gG;st.erasNameRegex=fG;st.erasNarrowRegex=mG;st.months=Gz;st.monthsShort=Kz;st.monthsParse=qz;st.monthsRegex=Jz;st.monthsShortRegex=Zz;st.week=nj;st.firstDayOfYear=ij;st.firstDayOfWeek=oj;st.weekdays=mj;st.weekdaysMin=wj;st.weekdaysShort=pj;st.weekdaysParse=vj;st.weekdaysRegex=bj;st.weekdaysShortRegex=Ej;st.weekdaysMinRegex=Tj;st.isPM=xj;st.meridiem=Ij;function bg(t,e,n,r){var o=Oi(),i=Uo().set(r,e);return o[n](i,t)}function $H(t,e,n){if(Ei(t)&&(e=t,t=void 0),t=t||"",e!=null)return bg(t,e,n,"month");var r,o=[];for(r=0;r<12;r++)o[r]=bg(t,r,n,"month");return o}function H0(t,e,n,r){typeof t=="boolean"?(Ei(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Ei(e)&&(n=e,e=void 0),e=e||"");var o=Oi(),i=t?o._week.dow:0,s,l=[];if(n!=null)return bg(e,(n+i)%7,r,"day");for(s=0;s<7;s++)l[s]=bg(e,(s+i)%7,r,"day");return l}function DG(t,e){return $H(t,e,"months")}function NG(t,e){return $H(t,e,"monthsShort")}function LG(t,e,n){return H0(t,e,n,"weekdays")}function FG(t,e,n){return H0(t,e,n,"weekdaysShort")}function $G(t,e,n){return H0(t,e,n,"weekdaysMin")}ms("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Qe(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});ee.lang=zr("moment.lang is deprecated. Use moment.locale instead.",ms);ee.langData=zr("moment.langData is deprecated. Use moment.localeData instead.",Oi);var Ko=Math.abs;function VG(){var t=this._data;return this._milliseconds=Ko(this._milliseconds),this._days=Ko(this._days),this._months=Ko(this._months),t.milliseconds=Ko(t.milliseconds),t.seconds=Ko(t.seconds),t.minutes=Ko(t.minutes),t.hours=Ko(t.hours),t.months=Ko(t.months),t.years=Ko(t.years),this}function VH(t,e,n,r){var o=mo(e,n);return t._milliseconds+=r*o._milliseconds,t._days+=r*o._days,t._months+=r*o._months,t._bubble()}function BG(t,e){return VH(this,t,e,1)}function WG(t,e){return VH(this,t,e,-1)}function nM(t){return t<0?Math.floor(t):Math.ceil(t)}function UG(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,o,i,s,l,a;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=nM(fy(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,o=Nr(t/1e3),r.seconds=o%60,i=Nr(o/60),r.minutes=i%60,s=Nr(i/60),r.hours=s%24,e+=Nr(s/24),a=Nr(BH(e)),n+=a,e-=nM(fy(a)),l=Nr(n/12),n%=12,r.days=e,r.months=n,r.years=l,this}function BH(t){return t*4800/146097}function fy(t){return t*146097/4800}function zG(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=jr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+BH(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(fy(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function jG(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Qe(this._months/12)*31536e6:NaN}function Ii(t){return function(){return this.as(t)}}var YG=Ii("ms"),GG=Ii("s"),KG=Ii("m"),XG=Ii("h"),qG=Ii("d"),QG=Ii("w"),ZG=Ii("M"),JG=Ii("Q"),e3=Ii("y");function t3(){return mo(this)}function n3(t){return t=jr(t),this.isValid()?this[t+"s"]():NaN}function _l(t){return function(){return this.isValid()?this._data[t]:NaN}}var r3=_l("milliseconds"),o3=_l("seconds"),i3=_l("minutes"),s3=_l("hours"),l3=_l("days"),a3=_l("months"),u3=_l("years");function c3(){return Nr(this.days()/7)}var li=Math.round,va={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function h3(t,e,n,r,o){return o.relativeTime(e||1,!!n,t,r)}function d3(t,e,n,r){var o=mo(t).abs(),i=li(o.as("s")),s=li(o.as("m")),l=li(o.as("h")),a=li(o.as("d")),u=li(o.as("M")),c=li(o.as("w")),h=li(o.as("y")),f=i<=n.ss&&["s",i]||i<n.s&&["ss",i]||s<=1&&["m"]||s<n.m&&["mm",s]||l<=1&&["h"]||l<n.h&&["hh",l]||a<=1&&["d"]||a<n.d&&["dd",a];return n.w!=null&&(f=f||c<=1&&["w"]||c<n.w&&["ww",c]),f=f||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],f[2]=e,f[3]=+t>0,f[4]=r,h3.apply(null,f)}function f3(t){return t===void 0?li:typeof t=="function"?(li=t,!0):!1}function g3(t,e){return va[t]===void 0?!1:e===void 0?va[t]:(va[t]=e,t==="s"&&(va.ss=e-1),!0)}function m3(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=va,o,i;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},va,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),o=this.localeData(),i=d3(this,!n,r,o),n&&(i=o.pastFuture(+this,i)),o.postformat(i)}var yw=Math.abs;function Ll(t){return(t>0)-(t<0)||+t}function xm(){if(!this.isValid())return this.localeData().invalidDate();var t=yw(this._milliseconds)/1e3,e=yw(this._days),n=yw(this._months),r,o,i,s,l=this.asSeconds(),a,u,c,h;return l?(r=Nr(t/60),o=Nr(r/60),t%=60,r%=60,i=Nr(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",a=l<0?"-":"",u=Ll(this._months)!==Ll(l)?"-":"",c=Ll(this._days)!==Ll(l)?"-":"",h=Ll(this._milliseconds)!==Ll(l)?"-":"",a+"P"+(i?u+i+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(o||r||t?"T":"")+(o?h+o+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var tt=Tm.prototype;tt.isValid=lY;tt.abs=VG;tt.add=BG;tt.subtract=WG;tt.as=zG;tt.asMilliseconds=YG;tt.asSeconds=GG;tt.asMinutes=KG;tt.asHours=XG;tt.asDays=qG;tt.asWeeks=QG;tt.asMonths=ZG;tt.asQuarters=JG;tt.asYears=e3;tt.valueOf=jG;tt._bubble=UG;tt.clone=t3;tt.get=n3;tt.milliseconds=r3;tt.seconds=o3;tt.minutes=i3;tt.hours=s3;tt.days=l3;tt.weeks=c3;tt.months=a3;tt.years=u3;tt.humanize=m3;tt.toISOString=xm;tt.toString=xm;tt.toJSON=xm;tt.locale=OH;tt.localeData=AH;tt.toIsoString=zr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",xm);tt.lang=IH;Me("X",0,0,"unix");Me("x",0,0,"valueOf");Ce("x",Sm);Ce("X",Lz);ft("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});ft("x",function(t,e,n){n._d=new Date(Qe(t))});//! moment.js
ee.version="2.29.4";pz(_t);ee.fn=ie;ee.min=rY;ee.max=oY;ee.now=iY;ee.utc=Uo;ee.unix=PG;ee.months=DG;ee.isDate=vh;ee.locale=ms;ee.invalid=pm;ee.duration=mo;ee.isMoment=fo;ee.weekdays=LG;ee.parseZone=kG;ee.localeData=Oi;ee.isDuration=xf;ee.monthsShort=NG;ee.weekdaysMin=$G;ee.defineLocale=E0;ee.updateLocale=kj;ee.locales=Dj;ee.weekdaysShort=FG;ee.normalizeUnits=jr;ee.relativeTimeRounding=f3;ee.relativeTimeThreshold=g3;ee.calendarFormat=IY;ee.prototype=ie;ee.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const p3=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));function WH(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function gy(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function pc(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let o=0;o<n;o++)for(let i=0;i<r;i++)e[i]||(e[i]=[]),e[i][o]=t[o][i];return e}function Gt(t,e,n,r){let o=-1,i=t,s=n;Array.isArray(t)||(i=Array.from(t));const l=i.length;for(r&&l&&(o+=1,s=i[o]),o+=1;o<l;)s=e(s,i[o],o,i),o+=1;return s}function Rr(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const o=r.length,i=[];let s=-1;for(;n<o;){const l=r[n];e(l,n,r)&&(s+=1,i[s]=l),n+=1}return i}function We(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const o=r.length,i=[];let s=-1;for(;n<o;){const l=r[n];s+=1,i[s]=e(l,n,r),n+=1}return i}function O(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const o=r.length;for(;n<o&&e(r[n],n,r)!==!1;)n+=1;return t}function UH(t){return Gt(t,(e,n)=>e+n,0)}function w3(t){return Gt(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function C3(t){return Gt(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function v3(t){return t.length?UH(t)/t.length:0}function zH(t){return Gt(t,(e,n)=>e.concat(Array.isArray(n)?zH(n):n),[])}function P0(t){const e=[];return O(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function my(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...o]=[...e];let i=r;return O(o,s=>{i=i.filter(l=>!s.includes(l))}),i}function y3(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...o]=[...e];let i=r;return O(o,s=>{i=i.filter(l=>s.includes(l))}),i}function S3(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...o]=[...e],i=new Set(r);return O(o,s=>{O(s,l=>{i.has(l)||i.add(l)})}),Array.from(i)}function py(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const R3=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:v3,arrayEach:O,arrayFilter:Rr,arrayFlatten:zH,arrayMap:We,arrayMax:w3,arrayMin:C3,arrayReduce:Gt,arraySum:UH,arrayUnique:P0,extendArray:gy,getDifferenceOfArrays:my,getIntersectionOfArrays:y3,getUnionOfArrays:S3,pivot:pc,stringToArray:py,to2dArray:WH},Symbol.toStringTag,{value:"Module"}));function ht(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Gt(t,(i,s,l)=>{const a=s.replace(/\r?\n\s*/g,""),u=n[l]?n[l]:"";return i+a+u},"").trim()}function Vt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function he(t){return typeof t<"u"}function vt(t){return typeof t>"u"}function rn(t){return t===null||t===""||vt(t)}function jH(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const qu="length",wc=t=>parseInt(t,16),rM=t=>parseInt(t,10),Eg=(t,e,n)=>t.substr(e,n),Cc=t=>t.codePointAt(0)-65,wy=t=>`${t}`.replace(/\-/g,""),b3=t=>wc(Eg(wy(t),wc("12"),Cc("F")))/(wc(Eg(wy(t),Cc("B"),~~![][qu]))||9),E3=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let oM=!1;const iM={invalid:()=>ht`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ht`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ht`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},sM={invalid:()=>ht`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ht`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ht`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function YH(t,e){const n=!rn(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",o="0.0.0-next-ff8465d-20231006";let i,s="invalid",l="invalid";t=wy(t||"");const a=T3(t);if(n||r||a)if(a){const u=ee("31/08/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=b3(t);i=ee((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",l="expired"):(s="valid",l="valid")}else r?(s="non_commercial",l="valid"):(s="invalid",l="invalid");else s="missing",l="missing";if(E3()&&(s="valid",l="valid"),!oM&&s!=="valid"&&(iM[s]({keyValidityDate:i,hotVersion:o})&&console[s==="non_commercial"?"info":"warn"](iM[s]({keyValidityDate:i,hotVersion:o})),oM=!0),l!=="valid"&&e.parentNode&&sM[l]({keyValidityDate:i,hotVersion:o})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=sM[l]({keyValidityDate:i,hotVersion:o}),e.parentNode.insertBefore(c,e.nextSibling)}}function T3(t){let e=[][qu],n=e;if(t[qu]!==Cc("Z"))return!1;for(let r="",o="B<H4P+".split(""),i=Cc(o.shift());i;i=Cc(o.shift()||"A"))--i<""[qu]?n=n|(rM(`${rM(wc(r)+(wc(Eg(t,Math.abs(i),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Eg(t,i,i?o[qu]===1?9:8:6);return n===e}const M3=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:YH,isDefined:he,isEmpty:rn,isRegExp:jH,isUndefined:vt,stringify:Vt},Symbol.toStringTag,{value:"Module"}));function Hn(t){return t[0].toUpperCase()+t.substr(1)}function x3(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let o=n.length;for(;o;){o-=1;const i=Vt(n[o]).toLowerCase();t.indexOf(i)===-1&&t.push(i)}return t.length===1}function k0(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function D0(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function N0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function Cy(t){return _m(`${t}`,{ALLOWED_TAGS:[]})}function _m(t,e){return mz.sanitize(t,e)}const _3=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:x3,isPercentValue:D0,randomString:k0,sanitize:_m,stripTags:Cy,substitute:N0,toUpperCaseFirst:Hn},Symbol.toStringTag,{value:"Module"})),Om=t=>["tabindex",t],O3=()=>["role","treegrid"],io=()=>["role","presentation"],I3=()=>["role","gridcell"],A3=()=>["role","rowheader"],H3=()=>["role","columnheader"],GH=()=>["role","row"],P3=()=>["role","menu"],k3=()=>["role","menuitem"],D3=()=>["role","combobox"],N3=()=>["role","listbox"],L3=()=>["role","option"],F3=()=>["scope","col"],$3=()=>["scope","row"],V3=()=>["type","text"],B3=t=>["aria-label",t],ru=()=>["aria-hidden","true"],W3=()=>["aria-disabled","true"],U3=()=>["aria-multiselectable","true"],L0=()=>["aria-haspopup","listbox"],KH=t=>["aria-rowcount",t],XH=t=>["aria-colcount",t],qH=t=>["aria-rowindex",t],F0=t=>["aria-colindex",t],Fr=t=>["aria-expanded",t],z3=t=>["aria-sort",t],lM=()=>["aria-readonly","true"],aM=()=>["aria-invalid","true"],j3=t=>["aria-checked",t],vy=()=>["aria-selected","true"],Y3=()=>["aria-autocomplete","list"],G3=t=>["aria-controls",t],K3=t=>["aria-activedescendant",t],X3=t=>["aria-live",t],q3=t=>["aria-relevant",t],Q3=t=>["aria-setsize",t],Z3=t=>["aria-posinset",t];function QH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,o=t;for(;o!==null;){if(n===e){r=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(n+=1,o=o.parentNode)}return r}function ZH(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function JH(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Xc(t){return JH(t)&&t.parent}function J3(t){return!!Object.getPrototypeOf(t.parent)}function ps(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:o}=Node;let i=t;for(;i!=null&&i!==n;){const{nodeType:s,nodeName:l}=i;if(s===r&&(e.includes(l)||e.includes(i)))return i;const{host:a}=i;a&&s===o?i=a:i=i.parentNode}return null}function Qu(t,e,n){const r=[];let o=t;for(;o&&(o=ps(o,e,n),!(!o||n&&!n.contains(o)));)r.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;const i=r.length;return i?r[i-1]:null}function ws(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function eP(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Yi(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function tP(t){return!t||!t.length?[]:t.filter(e=>!!e)}function nP(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(o=>{const i=o instanceof RegExp;return i&&e&&n.push(o),!i})),e?{regexFree:r,regexes:n}:r}function Pe(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function te(t,e){typeof e=="string"&&(e=e.split(" ")),e=tP(e),e.length>0&&t.classList.add(...e)}function ke(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=nP(e,!0);n=tP(n),n.length>0&&t.classList.remove(...n),r.forEach(o=>{t.classList.forEach(i=>{o.test(i)&&t.classList.remove(i)})})}function He(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function bh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=nP(e,!0);n.forEach(o=>{o!==""&&t.removeAttribute(o)}),r.forEach(o=>{t.getAttributeNames().forEach(i=>{o.test(i)&&t.removeAttribute(i)})})}function $0(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)$0(e[n])}}function go(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const rP=/(<(.*)>|&(.*);)/;function Ol(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;rP.test(e)?t.innerHTML=n?_m(e):e:Es(t,e)}function Es(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(go(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function pl(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return pl(n.host.impl);if(n.host)return pl(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(Ti(n).display==="none")return!1;n=n.parentNode}return!0}function Qt(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let o=t,i,s,l;for(i=o.offsetLeft,s=o.offsetTop,l=o;(o=o.offsetParent)&&!(o===e.body||!("offsetLeft"in o));)i+=o.offsetLeft,s+=o.offsetTop,l=o;return l&&l.style.position==="fixed"&&(i+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:i,top:s}}function V0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Im(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function qc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?V0(e):t.scrollTop}function Tg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Im(e):t.scrollLeft}function Qc(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let o=t.parentNode;for(;o&&o.style&&e.body!==o;){let{overflow:i,overflowX:s,overflowY:l}=o.style;if([i,s,l].includes("scroll"))return o;if({overflow:i,overflowX:s,overflowY:l}=n.getComputedStyle(o),r.includes(i)||r.includes(s)||r.includes(l)||o.clientHeight<=o.scrollHeight+1&&(r.includes(l)||r.includes(i))||o.clientWidth<=o.scrollWidth+1&&(r.includes(s)||r.includes(i)))return o;o=o.parentNode}return n}function wl(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const o=Ti(r,n),i=["scroll","hidden","auto"],s=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),a=o.getPropertyValue("overflow-x");if(i.includes(s)||i.includes(l)||i.includes(a))return r;r=r.parentNode}return n}function Wa(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const o=Ti(t,n);if(o[e]!==""&&o[e]!==void 0)return o[e]}function e4(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function Ti(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function ct(t){return t.offsetWidth}function kt(t){return t.offsetHeight}function mi(t){return t.clientHeight||t.innerHeight}function vc(t){return t.clientWidth||t.innerWidth}function t4(t,e,n){t.addEventListener(e,n,!1)}function n4(t,e,n){t.removeEventListener(e,n,!1)}function B0(t){return t.selectionStart?t.selectionStart:0}function oP(t){return t.selectionEnd?t.selectionEnd:0}function r4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function yy(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Eh(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const o=t.parentNode,i=o.style.display;o.style.display="block",t.setSelectionRange(e,n),o.style.display=i}}}let Sw;function o4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let o=e.offsetWidth;return r===o&&(o=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-o}function un(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Sw===void 0&&(Sw=o4(t)),Sw}function iP(t){return t.offsetWidth!==t.clientWidth}function sP(t){return t.offsetHeight!==t.clientHeight}function Am(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function i4(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Th(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Zc(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Hm(t){return Zc(t)&&t.hasAttribute("data-hot-input")===!1}function s4(t){const e=t.ownerDocument.activeElement;Hm(e)||t.select()}function W0(t){return!t.parentNode}function lP(t,e){new IntersectionObserver((r,o)=>{r.forEach(i=>{i.isIntersecting&&t.offsetParent!==null&&(e(),o.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function U0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,o=r.createRange(),i=r.defaultView.getSelection();He(t,"contenteditable",!0),n&&He(t,...ru()),e&&te(t,"invisibleSelection"),o.selectNodeContents(t),i.removeAllRanges(),i.addRange(o)}function z0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&ke(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function aP(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;U0(t,n),e(),z0(t,n)}const l4=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:rP,addClass:te,addEvent:t4,clearTextSelection:yy,closest:ps,closestDown:Qu,empty:go,fastInnerHTML:Ol,fastInnerText:Es,getCaretPosition:B0,getComputedStyle:Ti,getCssTransform:i4,getFrameElement:JH,getParent:QH,getParentWindow:Xc,getScrollLeft:Tg,getScrollTop:qc,getScrollableElement:Qc,getScrollbarWidth:un,getSelectionEndPosition:oP,getSelectionText:r4,getStyle:Wa,getTrimmingContainer:wl,getWindowScrollLeft:Im,getWindowScrollTop:V0,hasAccessToParentWindow:J3,hasClass:Pe,hasHorizontalScrollbar:sP,hasVerticalScrollbar:iP,index:eP,innerHeight:mi,innerWidth:vc,isChildOf:ws,isDetached:W0,isInput:Zc,isOutsideInput:Hm,isThisHotChild:ZH,isVisible:pl,makeElementContentEditableAndSelectItsContent:U0,matchesCSSRules:e4,observeVisibilityChangeOnce:lP,offset:Qt,outerHeight:kt,outerWidth:ct,overlayContainsElement:Yi,removeAttribute:bh,removeClass:ke,removeContentEditableFromElementAndDeselect:z0,removeEvent:n4,removeTextNodes:$0,resetCssTransform:Th,runWithSelectedContendEditableElement:aP,selectElementIfAllowed:s4,setAttribute:He,setCaretPosition:Eh,setOverlayPosition:Am},Symbol.toStringTag,{value:"Module"}));function wt(t){return typeof t=="function"}function uP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let o=null;function i(){for(var s=arguments.length,l=new Array(s),a=0;a<s;a++)l[a]=arguments[a];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,l)):(o&&clearTimeout(o),o=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,l),n=0,o=void 0},h)),r}return i}function a4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=uP(t,e);let o=n;function i(){o=n}function s(){for(var l=arguments.length,a=new Array(l),u=0;u<l;u++)a[u]=arguments[u];return o?(o-=1,t.apply(this,a)):r.apply(this,a)}return s.clearHits=i,s}function j0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function o(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return o}function u4(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...o]=e;return function(){for(var s=arguments.length,l=new Array(s),a=0;a<s;a++)l[a]=arguments[a];return Gt(o,(u,c)=>c(u),r.apply(this,l))}}function Y0(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return t.apply(this,n.concat(s))}}function cP(t){const e=t.length;function n(r){return function(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];const a=r.concat(s);let u;return a.length>=e?u=t.apply(this,a):u=n(a),u}}return n([])}function c4(t){const e=t.length;function n(r){return function(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];const a=r.concat(s.reverse());let u;return a.length>=e?u=t.apply(this,a):u=n(a),u}}return n([])}function Mg(t,e,n,r,o,i,s,l){return he(l)?t.call(e,n,r,o,i,s,l):he(s)?t.call(e,n,r,o,i,s):he(i)?t.call(e,n,r,o,i):he(o)?t.call(e,n,r,o):he(r)?t.call(e,n,r):he(n)?t.call(e,n):t.call(e)}const h4=Object.freeze(Object.defineProperty({__proto__:null,curry:cP,curryRight:c4,debounce:j0,fastCall:Mg,isFunction:wt,partial:Y0,pipe:u4,throttle:uP,throttleAfterHits:a4},Symbol.toStringTag,{value:"Module"}));var d4=Qn,uM=HA,f4=Sn,cM=eu,g4=FA,hM=d4([].push),m4=function(t){if(f4(t))return t;if(uM(t)){for(var e=t.length,n=[],r=0;r<e;r++){var o=t[r];typeof o=="string"?hM(n,o):(typeof o=="number"||cM(o)==="Number"||cM(o)==="String")&&hM(n,g4(o))}var i=n.length,s=!0;return function(l,a){if(s)return s=!1,a;if(uM(this))return a;for(var u=0;u<i;u++)if(n[u]===l)return a}}},p4=Ml,hP=mh,dP=mm,w4=cm,Mh=Qn,fP=Ur,dM=Sn,fM=e0,gP=h0,C4=m4,v4=JS,y4=String,Cs=hP("JSON","stringify"),dd=Mh(/./.exec),gM=Mh("".charAt),S4=Mh("".charCodeAt),R4=Mh("".replace),b4=Mh(1 .toString),E4=/[\uD800-\uDFFF]/g,mM=/^[\uD800-\uDBFF]$/,pM=/^[\uDC00-\uDFFF]$/,wM=!v4||fP(function(){var t=hP("Symbol")("stringify detection");return Cs([t])!=="[null]"||Cs({a:t})!=="{}"||Cs(Object(t))!=="{}"}),CM=fP(function(){return Cs("\uDF06\uD834")!=='"\\udf06\\ud834"'||Cs("\uDEAD")!=='"\\udead"'}),T4=function(t,e){var n=gP(arguments),r=C4(e);if(!(!dM(r)&&(t===void 0||fM(t))))return n[1]=function(o,i){if(dM(r)&&(i=w4(r,this,y4(o),i)),!fM(i))return i},dP(Cs,null,n)},M4=function(t,e,n){var r=gM(n,e-1),o=gM(n,e+1);return dd(mM,t)&&!dd(pM,o)||dd(pM,t)&&!dd(mM,r)?"\\u"+b4(S4(t,0),16):t};Cs&&p4({target:"JSON",stat:!0,arity:3,forced:wM||CM},{stringify:function(e,n,r){var o=gP(arguments),i=dP(wM?T4:Cs,null,o);return CM&&typeof i=="string"?R4(i,E4,M4):i}});function Ua(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ue(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Ua(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Ua(n[0])]:e[r]=[]:e[r]=null)})),e}function Ai(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Zt(t,e,n){const r=Array.isArray(n);return Ue(e,(o,i)=>{(r===!1||n.includes(i))&&(t[i]=o)}),t}function xh(t,e){Ue(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),xh(t[r],e[r])):t[r]=e[r]})}function kn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Yn(t){const e={};return Ue(t,(n,r)=>{e[r]=n}),e}function gt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return O(n,o=>{t.MIXINS.push(o.MIXIN_NAME),Ue(o,(i,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof i=="function")t.prototype[s]=i;else{const l=function(c,h){const f=`_${c}`,g=p=>{let y=p;return(Array.isArray(y)||$e(y))&&(y=kn(y)),y};return function(){return this[f]===void 0&&(this[f]=g(h)),this[f]}},a=function(c){const h=`_${c}`;return function(f){this[h]=f}};Object.defineProperty(t.prototype,s,{get:l(s,i),set:a(s),configurable:!0})}})}),t}function Pm(t,e){return JSON.stringify(t)===JSON.stringify(e)}function $e(t){return Object.prototype.toString.call(t)==="[object Object]"}function jo(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ue(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function mP(t,e){const n=e.split(".");let r=t;return Ue(n,o=>{if(r=r[o],r===void 0)return r=void 0,!1}),r}function Of(t,e,n){const r=e.split(".");let o=t;r.forEach((i,s)=>{s!==r.length-1?(Pt(o,i)||(o[i]={}),o=o[i]):o[i]=n})}function km(t){if(!$e(t))return 0;const e=function(n){let r=0;return $e(n)?Ue(n,(o,i)=>{i!=="__children"&&(r+=e(o))}):r+=1,r};return e(t)}function Cl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(o){this._touched=!0,this[n]=o},enumerable:!0,configurable:!0}),r}function Pt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const x4=Object.freeze(Object.defineProperty({__proto__:null,clone:Yn,createObjectPropListener:Cl,deepClone:kn,deepExtend:xh,deepObjectSize:km,defineGetter:jo,duckSchema:Ua,extend:Zt,getProperty:mP,hasOwnProperty:Pt,inherit:Ai,isObject:$e,isObjectEqual:Pm,mixin:gt,objectEach:Ue,setProperty:Of},Symbol.toStringTag,{value:"Module"})),Hr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Hi={chrome:Hr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Hr(t=>/CriOS/.test(t)),edge:Hr(t=>/Edge/.test(t)),edgeWebKit:Hr(t=>/EdgiOS/.test(t)),firefox:Hr(t=>/Firefox/.test(t)),firefoxWebKit:Hr(t=>/FxiOS/.test(t)),mobile:Hr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Hr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},ou={mac:Hr(t=>/^Mac/.test(t)),win:Hr(t=>/^Win/.test(t)),linux:Hr(t=>/^Linux/.test(t)),ios:Hr(t=>/iPhone|iPad|iPod/i.test(t))};function pP(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ue(Hi,n=>{let{test:r}=n;return void r(t,e)})}function wP(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ue(ou,e=>{let{test:n}=e;return void n(t)})}pP();wP();function G0(){return Hi.chrome.value}function CP(){return Hi.chromeWebKit.value}function If(){return Hi.firefox.value}function vP(){return Hi.firefoxWebKit.value}function K0(){return Hi.safari.value}function yP(){return Hi.edge.value}function _4(){return Hi.edgeWebKit.value}function pi(){return Hi.mobile.value}function X0(){return ou.ios.value}function q0(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&ou.mac.value}function Sy(){return ou.win.value}function xg(){return ou.mac.value}function O4(){return ou.linux.value}const I4=Object.freeze(Object.defineProperty({__proto__:null,isChrome:G0,isChromeWebKit:CP,isEdge:yP,isEdgeWebKit:_4,isFirefox:If,isFirefoxWebKit:vP,isIOS:X0,isIpadOS:q0,isLinuxOS:O4,isMacOS:xg,isMobileBrowser:pi,isSafari:K0,isWindowsOS:Sy,setBrowserMeta:pP,setPlatformMeta:wP},Symbol.toStringTag,{value:"Module"})),pe={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:If()?182:174,AUDIO_MUTE:If()?181:173,AUDIO_UP:If()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},A4=[pe.ALT,pe.ARROW_DOWN,pe.ARROW_LEFT,pe.ARROW_RIGHT,pe.ARROW_UP,pe.AUDIO_DOWN,pe.AUDIO_MUTE,pe.AUDIO_UP,pe.BACKSPACE,pe.CAPS_LOCK,pe.DELETE,pe.END,pe.ENTER,pe.ESCAPE,pe.F1,pe.F2,pe.F3,pe.F4,pe.F5,pe.F6,pe.F7,pe.F8,pe.F9,pe.F10,pe.F11,pe.F12,pe.F13,pe.F14,pe.F15,pe.F16,pe.F17,pe.F18,pe.F19,pe.HOME,pe.INSERT,pe.MEDIA_NEXT,pe.MEDIA_PLAY_PAUSE,pe.MEDIA_PREV,pe.MEDIA_STOP,pe.NULL,pe.NUM_LOCK,pe.PAGE_DOWN,pe.PAGE_UP,pe.PAUSE,pe.SCROLL_LOCK,pe.SHIFT,pe.TAB];function SP(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Q0(t){return A4.includes(t)}function H4(t){const e=[];return xg()?e.push(pe.COMMAND_LEFT,pe.COMMAND_RIGHT,pe.COMMAND_FIREFOX):e.push(pe.CONTROL),e.includes(t)}function RP(t){return[pe.CONTROL,pe.COMMAND_LEFT,pe.COMMAND_RIGHT,pe.COMMAND_FIREFOX].includes(t)}function za(t,e){const n=e.split("|");let r=!1;return O(n,o=>{if(t===pe[o])return r=!0,!1}),r}const P4=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:pe,isCtrlKey:H4,isCtrlMetaKey:RP,isFunctionKey:Q0,isKey:za,isPrintableChar:SP},Symbol.toStringTag,{value:"Module"}));function br(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function es(t){return t.isImmediatePropagationEnabled===!1}function Ts(t){return t.button===2}function Dm(t){return t.button===0}function bP(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const k4=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:es,isLeftClick:Dm,isRightClick:Ts,offsetRelativeTo:bP,stopImmediatePropagation:br},Symbol.toStringTag,{value:"Module"}));function Ct(){he(console)&&console.warn(...arguments)}function Z0(){he(console)&&console.error(...arguments)}const Fl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],D4=ht`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Rw=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),bw=new Map([["beforeRemoveCellClassNames",'The hook "beforeRemoveCellClassNames" is deprecated and will be removed in the next major release.']]);class EP{static getSingleton(){return L4()}constructor(){this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return O(Fl,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))O(n,o=>this.add(e,o,r));else{Rw.has(e)&&Ct(N0(D4,{hookName:e,removedInVersion:Rw.get(e)})),bw.has(e)&&Ct(bw.get(e));const o=this.getBucket(r);if(typeof o[e]>"u"&&(this.register(e),o[e]=[]),n.skip=!1,o[e].indexOf(n)===-1){let i=!1;n.initialHook&&O(o[e],(s,l)=>{if(s.initialHook)return o[e][l]=n,i=!0,!1}),i||o[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?O(n,o=>this.once(e,o,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const o=this.getBucket(r);return typeof o[e]<"u"&&o[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,o,i,s,l,a){{const u=this.globalBucket[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=Mg(u[h],e,r,o,i,s,l,a);f!==void 0&&(r=f),u[h]&&u[h].runOnce&&this.remove(n,u[h]),h+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=Mg(u[h],e,r,o,i,s,l,a);f!==void 0&&(r=f),u[h]&&u[h].runOnce&&this.remove(n,u[h],e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ue(this.getBucket(e),(n,r,o)=>o[r].length=0)}register(e){this.isRegistered(e)||Fl.push(e)}deregister(e){this.isRegistered(e)&&Fl.splice(Fl.indexOf(e),1)}isDeprecated(e){return bw.has(e)||Rw.has(e)}isRegistered(e){return Fl.indexOf(e)>=0}getRegistered(){return Fl}}const N4=new EP;function L4(){return N4}const me=EP,Ew=new Map;function po(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Ew.has(t)||Ew.set(t,new Map);const e=Ew.get(t);function n(l,a){e.set(l,a)}function r(l){return e.get(l)}function o(l){return e.has(l)}function i(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:o,getNames:i,getValues:s}}const Ry=new WeakMap,{register:F4,getItem:TP,hasItem:MP,getNames:$4,getValues:$oe}=po("editors");function V4(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},me.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function xP(t,e){let n;if(typeof t=="function")Ry.get(t)||or(null,t),n=Ry.get(t);else if(typeof t=="string")n=TP(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function _g(t){if(typeof t=="function")return t;if(!MP(t))throw Error(`No registered editor found under "${t}" name`);return TP(t).getConstructor()}function or(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new V4(e);typeof t=="string"&&F4(t,n),Ry.set(e,n)}let Af=0;class B4{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function i(s){r.call(this,W4(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:i,options:o,eventManager:this}),e.addEventListener(n,i,o),Af+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=this.context.eventListeners.length,s;for(;i;)if(i-=1,s=this.context.eventListeners[i],s.event===n&&s.element===e){if(r&&r!==s.callback||o&&s.eventManager!==this)continue;this.context.eventListeners.splice(i,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Af-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Af-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,o=e;r||(r=e.ownerDocument?e.ownerDocument:e,o=r.defaultView);const i={bubbles:!0,cancelable:n!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function W4(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),br(this)},t}const Dt=B4;function U4(){return Af}const Nm="editorManager.navigation";class by{constructor(e,n,r){this.instance=e,this.tableMeta=n,this.selection=r,this.eventManager=new Dt(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.addHook("afterDocumentKeyDown",o=>this.onAfterDocumentKeyDown(o)),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",o=>{!this.destroyed&&this.instance.isListening()&&this.openEditor("",o)}),this.instance.view._wt.update("onCellDblClick",(o,i,s)=>this.onCellDblClick(o,i,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,a=>{a&&this.prepareEditor()});return}const{highlight:e}=this.instance.getSelectedRangeLast();if(e.isHeader())return;const{row:n,col:r}=e,o=this.instance.runHooks("modifyGetCellCoords",n,r);let i=n,s=r;if(Array.isArray(o)&&([i,s]=o),this.cellProperties=this.instance.getCellMeta(i,s),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.instance.getCell(n,r,!0);if(l){const a=this.instance.getCellEditor(this.cellProperties),u=this.instance.colToProp(s),c=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(i),s);this.activeEditor=xP(a,this.instance),this.activeEditor.prepare(n,r,u,l,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.instance.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.instance.getSelectedRangeLast();if(!e)return!1;const n=this.instance.getCellEditor(this.cellProperties),{row:r,col:o}=e.highlight,{rowIndexMapper:i,columnIndexMapper:s}=this.instance,l=i.isHidden(this.instance.toPhysicalRow(r))||s.isHidden(this.instance.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!n||l)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}onAfterDocumentKeyDown(e){const n=this.instance.getSelectedRangeLast();if(!this.instance.isListening()||!n||n.highlight.isHeader()||es(e))return;const{keyCode:r}=e,o=(e.ctrlKey||e.metaKey)&&!e.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Q0(r)&&!RP(r)&&!o&&!this.isEditorOpened()){const s=this.instance.getShortcutManager().getContext("editor"),l={runOnlyIf:()=>he(this.instance.getSelected()),group:Nm};s.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.instance.selection.transformStart(0,-1*this.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.instance.selection.transformStart(0,this.instance.getDirectionFactor())}}],l),this.openEditor("",e)}}onCellDblClick(e,n,r){r.nodeName==="TD"&&this.openEditor(null,e,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}const vM=new WeakMap;by.getInstance=function(t,e,n){let r=vM.get(t);return r||(r=new by(t,e,n),vM.set(t,r)),r};const z4=by;function fd(t,e){_P(t,e),e.add(t)}function gd(t,e,n){_P(t,e),e.set(t,n)}function _P(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ya(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Mn(t,e){var n=OP(t,e,"get");return j4(t,n)}function j4(t,e){return e.get?e.get.call(t):e.value}function Ru(t,e,n){var r=OP(t,e,"set");return Y4(t,r,n),n}function OP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Y4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const is=Object.freeze({CELL:"cell",MIXED:"mixed"});var gr=new WeakMap,md=new WeakMap,pd=new WeakMap,wd=new WeakMap,Ey=new WeakSet,Ty=new WeakSet,yM=new WeakSet,SM=new WeakSet;class G4{constructor(e){var n=this;fd(this,SM),fd(this,yM),fd(this,Ty),fd(this,Ey),gd(this,gr,{writable:!0,value:void 0}),gd(this,md,{writable:!0,value:void 0}),gd(this,pd,{writable:!0,value:50}),gd(this,wd,{writable:!0,value:null});const r=e.getSettings();Ru(this,gr,e),Ru(this,md,r.imeFastEdit?is.MIXED:is.CELL),Mn(this,gr).addHook("afterUpdateSettings",function(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return ya(n,SM,X4).call(n,...i)}),Mn(this,gr).addHook("afterSelection",function(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return ya(n,yM,K4).call(n,...i)})}getFocusMode(){return Mn(this,md)}setFocusMode(e){Object.values(is).includes(e)?Ru(this,md,e):Ct(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Mn(this,pd)}setRefocusDelay(e){Ru(this,pd,e)}setRefocusElementGetter(e){Ru(this,wd,e)}getRefocusElement(){if(typeof Mn(this,wd)=="function")return Mn(this,wd).call(this);var e;return(e=Mn(this,gr).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){var n;const r=ya(this,Ey,IP).call(this),o=e||ya(this,Ty,AP).call(this);let i=Mn(this,gr).runHooks("modifyFocusedElement",r.row,r.col,o);i instanceof HTMLElement||(i=o),i&&!((n=Mn(this,gr).getActiveEditor())!==null&&n!==void 0&&n.isOpened())&&i.focus({preventScroll:!0})}refocusToEditorTextarea(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Mn(this,pd);const n=this.getRefocusElement();Mn(this,gr).getSettings().imeFastEdit&&n&&Mn(this,gr)._registerTimeout(()=>{n.select()},e)}}function IP(){return Mn(this,gr).getSelectedRangeLast().highlight}function AP(){const t=ya(this,Ey,IP).call(this);return Mn(this,gr).getCell(t.row,t.col,!0)}function K4(){const t=ya(this,Ty,AP).call(this),{activeElement:e}=Mn(this,gr).rootDocument;e&&Hm(e)&&e.blur(),this.focusOnHighlightedCell(t),this.getFocusMode()===is.MIXED&&t.nodeName==="TD"&&Mn(this,gr).addHookOnce("afterSelectionEnd",()=>{this.refocusToEditorTextarea()})}function X4(t){t.imeFastEdit&&this.getFocusMode()!==is.MIXED?this.setFocusMode(is.MIXED):!t.imeFastEdit&&this.getFocusMode()!==is.CELL&&this.setFocusMode(is.CELL)}const HP={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},q4=new RegExp(Object.keys(HP).map(t=>`(${t})`).join("|"),"gi");function Q4(t){return(t&&t.nodeName||"")==="TABLE"}function My(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],o=t.getData(...r),i=o.length,s=i>0?o[0].length:0,l=["<table>","</table>"],a=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let f=0;f<i;f+=1){const g=e&&f===0,p=[];for(let E=0;E<s;E+=1){const w=!g&&n&&E===0;let C="";if(g)C=`<th>${t.getColHeader(E-c)}</th>`;else if(w)C=`<th>${t.getRowHeader(f-h)}</th>`;else{const S=o[f][E],{hidden:T,rowspan:x,colspan:A}=t.getCellMeta(f-h,E-c);if(!T){const D=[];if(x&&D.push(`rowspan="${x}"`),A&&D.push(`colspan="${A}"`),rn(S))C=`<td ${D.join(" ")}></td>`;else{const U=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");C=`<td ${D.join(" ")}>${U}</td>`}}}p.push(C)}const y=["<tr>",...p,"</tr>"].join("");g?a.splice(1,0,y):u.splice(-1,0,y)}return l.splice(1,0,a.join(""),u.join("")),l.join("")}function xy(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const o=t[r],i=o.length,s=[];r===0&&n.push("<tbody>");for(let l=0;l<i;l+=1){const a=o[l],u=rn(a)?"":a.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function PP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),o=e.createElement("div");r.appendChild(o);let i=t;if(typeof i=="string"){const S=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,T=>{const x=T.match(/<td\b[^>]*?>/g)[0],A=T.substring(x.length,T.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${x}${A}</td>`});o.insertAdjacentHTML("afterbegin",`${S}`),i=o.querySelector("table")}if(!i||!Q4(i))return;const s=o.querySelector('meta[name$="enerator"]'),l=i.querySelector("tbody th")!==null,a=i.querySelector("tr"),u=a?Array.from(a.cells).reduce((S,T)=>S+T.colSpan,0)-(l?1:0):0,c=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[];let f=!1,g=0,p=0;if(i.tHead){const S=Array.from(i.tHead.rows).filter(T=>{const x=T.querySelector("td")!==null;return x&&h.push(T),!x});g=S.length,f=g>0,g>1?n.nestedHeaders=Array.from(S).reduce((T,x)=>{const A=Array.from(x.cells).reduce((D,U,j)=>{if(l&&j===0)return D;const{colSpan:z,innerHTML:Z}=U,re=z>1?{label:Z,colspan:z}:Z;return D.push(re),D},[]);return T.push(A),T},[]):f&&(n.colHeaders=Array.from(S[0].children).reduce((T,x,A)=>(l&&A===0||T.push(x.innerHTML),T),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const y=[...h,...Array.from(i.tBodies).reduce((S,T)=>(S.push(...Array.from(T.rows)),S),[]),...c];p=y.length;const E=new Array(p);for(let S=0;S<p;S++)E[S]=new Array(u);const w=[],C=[];for(let S=0;S<p;S++){const T=y[S],x=Array.from(T.cells),A=x.length;for(let D=0;D<A;D++){const U=x[D],{nodeName:j,innerHTML:z,rowSpan:Z,colSpan:re}=U,ne=E[S].findIndex(ue=>ue===void 0);if(j==="TD"){if(Z>1||re>1){for(let Ae=S;Ae<S+Z;Ae++)if(Ae<p)for(let b=ne;b<ne+re;b++)E[Ae][b]=null;const Re=U.getAttribute("style");Re&&Re.includes("mso-ignore:colspan")||w.push({col:ne,row:S,rowspan:Z,colspan:re})}let ue="";s&&/excel/gi.test(s.content)?ue=z.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ue=z.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),E[S][ne]=ue.replace(q4,Re=>HP[Re])}else C.push(z)}}return w.length&&(n.mergeCells=w),C.length&&(n.rowHeaders=C),E.length&&(n.data=E),n}const Z4=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:xy,htmlToGridSettings:PP,instanceToHTML:My},Symbol.toStringTag,{value:"Module"}));function jn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(o=>`\\${o}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function kP(t){return jn(t,[","])}function ye(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function Og(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function J0(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function wr(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const J4=Object.freeze(Object.defineProperty({__proto__:null,clamp:wr,isNumeric:jn,isNumericLike:kP,rangeEach:ye,rangeEachReverse:Og,valueAccordingPercent:J0},Symbol.toStringTag,{value:"Module"})),_y="asc",e6="desc",RM=new Map([[_y,[-1,1]],[e6,[1,-1]]]),t6=t=>`The priority '${t}' is already declared in a map.`,n6=t=>`The priority '${t}' is not a number.`;function r6(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=wt(t)?t:t6,e=wt(e)?e:n6;function r(i,s){if(!jn(i))throw new Error(e(i));if(n.has(i))throw new Error(t(i));n.set(i,s)}function o(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_y;const[s,l]=RM.get(i)||RM.get(_y);return[...n].sort((a,u)=>a[0]<u[0]?s:l).map(a=>a[1])}return{addItem:r,getItems:o}}const o6=t=>`The id '${t}' is already declared in a map.`;function Lm(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=wt(t)?t:o6;function n(u,c){if(a(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function o(){e.clear()}function i(u){const[c]=l().find(h=>{let[f,g]=h;return u===g?f:!1})||[null];return c}function s(u){return e.get(u)}function l(){return[...e]}function a(u){return e.has(u)}return{addItem:n,clear:o,getId:i,getItem:s,getItems:l,hasItem:a,removeItem:r}}const i6=t=>`'${t}' value is already declared in a unique set.`;function s6(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=wt(t)?t:i6;function n(i){if(e.has(i))throw new Error(t(i));e.add(i)}function r(){return[...e]}function o(){e.clear()}return{addItem:n,clear:o,getItems:r}}const eR=t=>`There is already registered "${t}" plugin.`,l6=t=>`There is already registered plugin on priority "${t}".`,a6=t=>`The priority "${t}" is not a number.`,DP=r6({errorPriorityExists:l6,errorPriorityNaN:a6}),NP=s6({errorItemExists:eR}),Oy=Lm({errorIdExists:eR});function tR(){return[...DP.getItems(),...NP.getItems()]}function _h(t){const e=Hn(t);return Oy.getItem(e)}function u6(t){return!!_h(t)}function et(t,e,n){[t,e,n]=h6(t,e,n),_h(t)===void 0&&c6(t,e,n)}function c6(t,e,n){const r=Hn(t);if(Oy.hasItem(r))throw new Error(eR(r));n===void 0?NP.addItem(r):DP.addItem(n,r),Oy.addItem(r,e)}function h6(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:d6,getItem:f6,hasItem:LP,getNames:g6,getValues:Voe}=po("renderers");function Ig(t){if(typeof t=="function")return t;if(!LP(t))throw Error(`No registered renderer found under "${t}" name`);return f6(t)}function Io(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),d6(t,e)}const{register:m6,getItem:p6,hasItem:FP,getNames:w6,getValues:Boe}=po("validators");function nR(t){if(typeof t=="function")return t;if(!FP(t))throw Error(`No registered validator found under "${t}" name`);return p6(t)}function Sa(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),m6(t,e)}var $P={},C6=OA,v6=u0,y6=Object.keys||function(e){return C6(e,v6)},S6=Bo,R6=RA,b6=Tl,E6=ph,T6=hm,M6=y6;$P.f=S6&&!R6?Object.defineProperties:function(e,n){E6(e);for(var r=T6(n),o=M6(n),i=o.length,s=0,l;i>s;)b6.f(e,l=o[s++],r[l]);return e};var x6=ph,_6=$P,bM=u0,O6=s0,I6=UA,A6=o0,H6=TA,EM=">",TM="<",Iy="prototype",Ay="script",VP=H6("IE_PROTO"),Tw=function(){},BP=function(t){return TM+Ay+EM+t+TM+"/"+Ay+EM},MM=function(t){t.write(BP("")),t.close();var e=t.parentWindow.Object;return t=null,e},P6=function(){var t=A6("iframe"),e="java"+Ay+":",n;return t.style.display="none",I6.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(BP("document.F=Object")),n.close(),n.F},Cd,Hf=function(){try{Cd=new ActiveXObject("htmlfile")}catch{}Hf=typeof document<"u"?document.domain&&Cd?MM(Cd):P6():MM(Cd);for(var t=bM.length;t--;)delete Hf[Iy][bM[t]];return Hf()};O6[VP]=!0;var k6=Object.create||function(e,n){var r;return e!==null?(Tw[Iy]=x6(e),r=new Tw,Tw[Iy]=null,r[VP]=e):r=Hf(),n===void 0?r:_6.f(r,n)},D6=fm,N6=k6,L6=Tl.f,Hy=D6("unscopables"),Py=Array.prototype;Py[Hy]===void 0&&L6(Py,Hy,{configurable:!0,value:N6(null)});var WP=function(t){Py[Hy][t]=!0},F6=Ml,$6=dm,V6=gm,B6=a0,W6=WP;F6({target:"Array",proto:!0},{at:function(e){var n=$6(this),r=V6(n),o=B6(e),i=o>=0?o:r+o;return i<0||i>=r?void 0:n[i]}});W6("at");const el=1,In=2,$l=new WeakMap;class rR{static get DEFAULT_WIDTH(){return 50}constructor(){let{viewportSize:e,scrollOffset:n,totalItems:r,itemSizeFn:o,overrideFn:i,calculationType:s,stretchMode:l,stretchingItemWidthFn:a=c=>c,inlineStartOffset:u}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};$l.set(this,{viewportWidth:e,scrollOffset:n,totalColumns:r,columnWidthFn:o,overrideFn:i,calculationType:s,stretchingColumnWidthFn:a,inlineStartOffset:u}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}calculate(){let e=0,n=!0;const r=[];let o,i=0,s=0;const l=$l.get(this),a=l.calculationType,u=l.overrideFn,c=l.scrollOffset,h=Math.max(l.scrollOffset,0),f=l.totalColumns,g=l.viewportWidth,p=h>0?g+1:g;for(let C=0;C<f;C++)if(o=this._getColumnWidth(C),e<=h&&a!==In&&(this.startColumn=C,i=o),e>=h&&e+(a===In?o:0)<=h+p&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=C,i=o),this.endColumn=C),r.push(e),e+=o,s=o,a!==In&&(this.endColumn=C),e>=h+g){n=!1;break}const y=c+g-p,E=a===In?0:s,w=a===In?i:0;if(y<-1*l.inlineStartOffset||c>r.at(-1)+E||-1*l.scrollOffset-l.viewportWidth>-1*w?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===f-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){const C=r[this.endColumn]+o-r[this.startColumn-1];if((C<=g||a!==In)&&(this.startColumn-=1),C>g)break}a===el&&this.startColumn!==null&&u&&u(this),this.startPosition=r[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),f<this.endColumn&&(this.endColumn=f-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(this.stretch==="none")return;let n=e;this.totalTargetWidth=n;const r=$l.get(this),o=r.totalColumns;let i=0;for(let l=0;l<o;l++){const a=this._getColumnWidth(l),u=r.stretchingColumnWidthFn(void 0,l);typeof u=="number"?n-=u:i+=a}const s=n-i;if(this.stretch==="all"&&s>0)this.stretchAllRatio=n/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){const l=this._getColumnWidth(o-1),a=s+l;this.stretchLastWidth=a>=0?a:l}}getStretchedColumnWidth(e,n){let r=null;return this.stretch==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;const o=$l.get(this),i=o.totalColumns;if(!this.stretchAllColumnsWidth[e]){const s=Math.round(n*this.stretchAllRatio),l=o.stretchingColumnWidthFn(s,e);l===void 0?this.stretchAllColumnsWidth[e]=s:this.stretchAllColumnsWidth[e]=isNaN(l)?this._getColumnWidth(e):l}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let s=0;s<this.stretchAllColumnsWidth.length;s++)r+=this.stretchAllColumnsWidth[s];r!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const r=$l.get(this).totalColumns;return e===r-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=$l.get(this).columnWidthFn(e);return isNaN(n)&&(n=rR.DEFAULT_WIDTH),n}}const oR=rR,xM=new WeakMap;class iR{static get DEFAULT_HEIGHT(){return 23}constructor(){let{viewportSize:e,scrollOffset:n,totalItems:r,itemSizeFn:o,overrideFn:i,calculationType:s,scrollbarHeight:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};xM.set(this,{viewportHeight:e,scrollOffset:n,totalRows:r,rowHeightFn:o,overrideFn:i,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}calculate(){const e=xM.get(this),n=e.calculationType,r=e.overrideFn,o=e.rowHeightFn,i=e.scrollOffset,s=Math.max(e.scrollOffset,0),l=e.totalRows,a=e.viewportHeight,u=e.horizontalScrollbarHeight||0;let c=0,h=!0;const f=[];let g,p=0,y=0;for(let S=0;S<l;S++)if(g=o(S),isNaN(g)&&(g=iR.DEFAULT_HEIGHT),c<=s&&n!==In&&(this.startRow=S,p=g),c>=s&&c+(n===In?g:0)<=s+a-u&&(this.startRow===null&&(this.startRow=S,p=g),this.endRow=S),f.push(c),c+=g,y=g,n!==In&&(this.endRow=S),c>=s+a-u){h=!1;break}const E=i+a-u,w=n===In?p:0,C=n===In?0:y;if(E<w||i>f.at(-1)+C?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===l-1&&h)for(this.startRow=this.endRow;this.startRow>0;){const S=f[this.endRow]+g-f[this.startRow-1];if((S<=a-u||n!==In)&&(this.startRow-=1),S>=a-u)break}n===el&&this.startRow!==null&&r&&r(this),this.startPosition=f[this.startRow],this.startPosition===void 0&&(this.startPosition=null),l<this.endRow&&(this.endRow=l-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const UP=iR;function U6(t,e,n){z6(t,e),e.set(t,n)}function z6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _M(t,e,n){return e=j6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j6(t){var e=Y6(t,"string");return typeof e=="symbol"?e:String(e)}function Y6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bu(t,e){var n=zP(t,e,"get");return G6(t,n)}function G6(t,e){return e.get?e.get.call(t):e.value}function K6(t,e,n){var r=zP(t,e,"set");return X6(t,r,n),n}function zP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function X6(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ns=new WeakMap;class sR{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;_M(this,"row",null),_M(this,"col",null),U6(this,Ns,{writable:!0,value:!1}),K6(this,Ns,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:o,countColHeaders:i}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-i||this.col<-o||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isSouthEastOf(e){return this.row>=e.row&&(bu(this,Ns)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(bu(this,Ns)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(bu(this,Ns)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(bu(this,Ns)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}clone(){return new sR(this.row,this.col,bu(this,Ns))}toObject(){return{row:this.row,col:this.col}}}const No=sR;function q6(t,e,n){Q6(t,e),e.set(t,n)}function Q6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mw(t,e,n){return e=Z6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z6(t){var e=J6(t,"string");return typeof e=="symbol"?e:String(e)}function J6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vo(t,e){var n=jP(t,e,"get");return eK(t,n)}function eK(t,e){return e.get?e.get.call(t):e.value}function tK(t,e,n){var r=jP(t,e,"set");return nK(t,r,n),n}function jP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function nK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var _r=new WeakMap;class lR{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Mw(this,"highlight",null),Mw(this,"from",null),Mw(this,"to",null),q6(this,_r,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),tK(this,_r,o)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,o=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return o.row<=n&&i.row>=n&&o.col<=r&&i.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),o=this.getDirection(),i=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),l=Math.min(n.row,i.row),a=Math.min(n.col,i.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),h=this._createCellCoords(l,a),f=this._createCellCoords(u,c);return this.from=h,this.to=f,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return vo(this,_r)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return vo(this,_r)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return vo(this,_r)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return vo(this,_r)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return vo(this,_r)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return vo(this,_r)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return vo(this,_r)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return vo(this,_r)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,n){return n&&n.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,n){if(!(e instanceof No))return!1;if(n){const{from:r,to:o}=n;if(n.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},o=[];return n.top===r.top&&o.push("top"),n.right===r.right&&o.push("right"),n.bottom===r.bottom&&o.push("bottom"),n.left===r.left&&o.push("left"),o}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let o=e.row;o<=n.row;o++)for(let i=e.col;i<=n.col;i++)!(this.from.row===o&&this.from.col===i)&&!(this.to.row===o&&this.to.col===i)&&r.push(this._createCellCoords(o,i));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let o=e.row;o<=n.row;o++)for(let i=e.col;i<=n.col;i++)e.row===o&&e.col===i?r.push(e):n.row===o&&n.col===i?r.push(n):r.push(this._createCellCoords(o,i));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let o=n.row;o<=r.row;o++)for(let i=n.col;i<=r.col;i++)if(e(o,i)===!1)return}clone(){return new lR(this.highlight,this.from,this.to,vo(this,_r))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new No(e,n,vo(this,_r))}}const ja=lR;function Fm(t){return window.requestAnimationFrame(t)}function Jc(t){window.cancelAnimationFrame(t)}function aR(){return"ontouchstart"in window}let Vl;function YP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Vl||(typeof Intl=="object"?Vl=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Vl=(n,r)=>`${n}`.localeCompare(r):Vl=(n,r)=>n===r?0:n>r?-1:1,Vl)}const rK=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Jc,getComparisonFunction:YP,isTouchSupported:aR,requestAnimationFrame:Fm},Symbol.toStringTag,{value:"Module"})),Bl=new WeakMap;let oK=class{constructor(e,n,r,o,i,s){let l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;this.wtSettings=r,this.domBindings=n,this.wtTable=i,this.selectionManager=s,this.parent=l,this.eventManager=o,this.facadeGetter=e,Bl.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}registerEvents(){this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",r=>this.onContextMenu(r)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",r=>this.onMouseOver(r)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{this.eventManager.addEventListener(this.wtTable.holder,"touchstart",r=>this.onTouchStart(r)),this.eventManager.addEventListener(this.wtTable.holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),this.eventManager.addEventListener(this.wtTable.holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||this.wtSettings.getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,this.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},n=()=>{this.eventManager.addEventListener(this.wtTable.holder,"mouseup",r=>this.onMouseUp(r)),this.eventManager.addEventListener(this.wtTable.holder,"mousedown",r=>this.onMouseDown(r))};pi()?e():(aR()&&e(),n())}selectedCellWasTouched(e){const n=Bl.get(this),o=this.parentCell(e).coords;if(n.selectedCellBeforeTouchEnd&&o){const[i,s]=[o.row,n.selectedCellBeforeTouchEnd.from.row],[l,a]=[o.col,n.selectedCellBeforeTouchEnd.from.col];return i===s&&l===a}return!1}parentCell(e){const n={},r=this.wtTable.TABLE,o=Qu(e,["TD","TH"],r);return o?(n.coords=this.wtTable.getCoords(o),n.TD=o):Pe(e,"wtBorder")&&Pe(e,"current")?(n.coords=this.selectionManager.getFocusSelection().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):Pe(e,"wtBorder")&&Pe(e,"area")&&this.selectionManager.getAreaSelection().cellRange&&(n.coords=this.selectionManager.getAreaSelection().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}onMouseDown(e){const n=Bl.get(this),r=this.domBindings.rootDocument.activeElement,o=Y0(QH,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||o(0)===r||o(1)===r))return;const s=this.parentCell(i);Pe(i,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,i):s.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(n.dblClickOrigin[0]=s.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(()=>{n.dblClickOrigin[0]=null},1e3))}onContextMenu(e){if(this.wtSettings.has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!this.wtSettings.has("onCellMouseOver"))return;const n=this.wtTable.TABLE,r=Qu(e.target,["TD","TH"],n),o=this.parent||this;r&&r!==o.lastMouseOver&&ws(r,n)&&(o.lastMouseOver=r,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(r),r))}onMouseOut(e){if(!this.wtSettings.has("onCellMouseOut"))return;const n=this.wtTable.TABLE,r=Qu(e.target,["TD","TH"],n),o=Qu(e.relatedTarget,["TD","TH"],n),i=this.parent||this;r&&r!==o&&ws(r,n)&&(this.callListener("onCellMouseOut",e,this.wtTable.getCoords(r),r),o===null&&(i.lastMouseOver=null))}onMouseUp(e){const n=Bl.get(this),r=this.parentCell(e.target);r.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===n.dblClickOrigin[0]&&r.TD===n.dblClickOrigin[1]?(Pe(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):r.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=r.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(()=>{n.dblClickOrigin[1]=null},500)))}onTouchStart(e){const n=Bl.get(this);n.selectedCellBeforeTouchEnd=this.selectionManager.getFocusSelection().cellRange,this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,o=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,i=he(o)&&o.row>=0&&o.col>=0;if(e.cancelable&&i&&this.wtSettings.getSetting("isDataViewInstance")){const l=["A","BUTTON","INPUT"];X0()&&(CP()||vP())&&this.selectedCellWasTouched(r)&&!l.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,o){const i=this.wtSettings.getSettingPure(e);i&&i(n,r,o,this.facadeGetter())}destroy(){const e=Bl.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}};const GP=oK;class iK{constructor(e,n,r){this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const sK=iK;class lK{constructor(e,n,r){this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const aK=lK,uK=0,Ag=1,Hg=2;class OM{constructor(){this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}class cK{constructor(){this.size=new OM,this.workingSpace=uK,this.sharedSize=null}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof OM}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Ag,e.workingSpace=Hg,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Hg,e.workingSpace=Ag,this.sharedSize=e.getViewSize()}}class KP{constructor(e,n,r){this.rootNode=e,this.nodesPool=n,this.sizeSet=new cK,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let o=e.firstElementChild;for(;o;){if(o.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(Ag))break;o=o.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:o}=n.getViewSize();let i=this.getRenderedChildCount();for(;i<o;){const l=this.nodesPool();!r||r&&n.isPlaceOn(Hg)?e.appendChild(l):e.insertBefore(l,e.firstChild),i+=1}const s=r&&n.isPlaceOn(Ag);for(;i>o;)e.removeChild(s?e.firstChild:e.lastChild),i-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Hg)&&(r+=n.sharedSize.nextSize);let o=e.childNodes[r];if(o.tagName!==this.childNodeType){const i=this.nodesPool();e.replaceChild(i,o),o=i}this.collectedNodes.push(o),this.visualIndex+=1}end(){}}class XP extends KP{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}class hK{constructor(e){this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}class Oh{constructor(e,n){this.nodesPool=typeof e=="string"?new hK(e):null,this.nodeType=e,this.rootNode=n,this.table=null,this.renderedNodes=0}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}class dK extends Oh{constructor(){super("TH"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new XP(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:o,cells:i}=this.table;for(let s=0;s<e;s++){const l=this.table.renderedRowToSource(s),a=o.getRenderedNode(s);this.sourceRowIndex=l;const u=this.obtainOrderView(a),c=i.obtainOrderView(a);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<r;h++){u.render();const f=u.getCurrentNode();f.className="",f.removeAttribute("style"),this.table.isAriaEnabled()&&He(f,[A3(),$3(),F0(h+1),Om(-1)]),n[h](l,f,h)}u.end()}}}class fK extends Oh{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:o}=this.table,i=o+n;for(let l=0,a=e;l<a;l++){for(r=this.rootNode.childNodes[l],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<i;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let l=e;l<s;l++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&go(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&He(this.rootNode,[io()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:o,rowHeadersCount:i}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&He(s,[GH(),qH(n+1)]);for(let l=-1*i;l<o;l+=1){const a=this.table.renderedColumnToSource(l),u=s.childNodes[l+i];u.className="",u.removeAttribute("style"),this.table.isAriaEnabled()&&He(u,[F0(l+1+this.table.rowHeadersCount),Om(-1),...l<0?[io()]:[H3(),F3()]]),r[n](a,u,n)}}}}class gK extends Oh{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;for(let o=0;o<n;o++){const i=this.table.renderedColumnToSource(o),s=this.table.columnUtils.getHeaderWidth(i);this.rootNode.childNodes[o].style.width=`${s}px`}for(let o=0;o<e;o++){const i=this.table.renderedColumnToSource(o),s=this.table.columnUtils.getStretchedColumnWidth(i);this.rootNode.childNodes[o+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&te(r,"rowHeader")}}let IM=!1;class mK extends Oh{constructor(e){super("TR",e),this.orderView=new KP(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!IM&&e>1e3&&(IM=!0,Ct(ht`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&He(this.rootNode,[io()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let o=0;o<e;o++){this.orderView.render();const i=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(o);if(this.table.isAriaEnabled()){var n,r;He(i,[GH(),qH(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}class pK extends Oh{constructor(){super("TD"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new XP(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:o}=this.table;for(let l=0;l<e;l++){const a=this.table.renderedRowToSource(l),u=r.getRenderedNode(l);this.sourceRowIndex=a;const c=this.obtainOrderView(u),h=o.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<n;f++){c.render();const g=c.getCurrentNode(),p=this.table.renderedColumnToSource(f);if(Pe(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),bh(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(a,p,g),this.table.isAriaEnabled()){var i,s;He(g,[...g.hasAttribute("role")?[]:[I3()],Om(-1),F0(p+((i=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&i!==void 0?i:0)+1)])}}c.end()}}}class wK{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:o,cells:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=o,this.cells=i}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const o=n.getRenderedNode(r);if(o.firstChild){const i=this.renderedRowToSource(r),s=this.rowUtils.getHeight(i);s?o.firstChild.style.height=`${s-1}px`:o.firstChild.style.height=""}}}}class CK{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:o,rowUtils:i,columnUtils:s,cellRenderer:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new wK(e,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new dK,columnHeaders:new fK(n),colGroup:new gK(r),rows:new mK(o),cells:new pK}),this.renderer.setAxisUtils(i,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}class vK{constructor(e,n){this.dataAccessObject=e,this.wtSettings=n,this.headerWidths=new Map}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const n=this.dataAccessObject.wtViewport.columnsRenderCalculator;let r=this.getWidth(e);if(n){const o=n.getStretchedColumnWidth(e,r);o&&(r=o)}return r}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:n,wtViewport:r,cloneSource:o}=this.dataAccessObject,i=o?o.wtTable.holder:n.holder,s=i.offsetHeight<i.scrollHeight?un():0;let l=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-s),l=e.getSetting("onModifyRowHeaderWidth",l),l!=null){const a=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let c=0;c<a;c++){let h=Array.isArray(l)?l[c]:l;h=h??u,this.headerWidths.set(c,h)}}}}class yK{constructor(e,n){this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function yo(t,e,n){return e=SK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SK(t){var e=RK(t,"string");return typeof e=="symbol"?e:String(e)}function RK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bK{constructor(e,n,r,o,i){yo(this,"wtSettings",null),yo(this,"domBindings",void 0),yo(this,"TBODY",null),yo(this,"THEAD",null),yo(this,"COLGROUP",null),yo(this,"hasTableHeight",!0),yo(this,"hasTableWidth",!0),yo(this,"isTableVisible",!1),yo(this,"tableOffset",0),yo(this,"holderOffset",0),this.domBindings=r,this.isMaster=i==="master",this.name=i,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,$0(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new yK(this.dataAccessObject,this.wtSettings),this.columnUtils=new vK(this.dataAccessObject,this.wtSettings),this.tableRenderer=new CK({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pe(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&He(r,[io()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pe(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&He(r,[io()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pe(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&He(r.parentNode,[io()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&He(r,[io()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:o}=this.dataAccessObject,i=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),l=n.getSetting("rowHeaders"),a=l.length,u=n.getSetting("columnHeaders"),c=u.length;let h=!1,f=e;if(this.isMaster&&(this.holderOffset=Qt(this.holder),f=o.createRenderCalculators(f),a&&!n.getSetting("fixedColumnsStart"))){const p=r.inlineStartOverlay.getScrollPosition(),y=this.correctHeaderWidth;this.correctHeaderWidth=p!==0,y!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(h=r.updateStateOfRendering()),f)this.isMaster&&o.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=Qt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const p=i>0?this.getFirstRenderedRow():0,y=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new aK(p,i,c),this.columnFilter=new sK(y,s,a);let E=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const w={};this.wtSettings.getSetting("beforeDraw",!0,w),E=w.skipRender!==!0}if(E){this.tableRenderer.setHeaderContentRenderers(l,u),(this.is(Do)||this.is(vs))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let w;if(this.isMaster&&(w=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Do))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const C=ct(this.hider),S=ct(this.TABLE);C!==0&&S!==C&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),w!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Do)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let g=!1;return this.isMaster&&(g=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(g=r.bottomOverlay.resetFixedPosition()||g),g=r.inlineStartOverlay.resetFixedPosition()||g,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),g?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(f),h&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const o=this.wtSettings.getSetting("defaultRowHeight");let i,s,l;const a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,i=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(l=mi(s),(!i&&o<l||i<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),Array.isArray(a)?a[r]!==null&&a[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a[r]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(a[r]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a[r]||a))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=e.getSetting("columnHeaders");for(let i=0,s=o.length;i<s;i++)if(r[i]){if(!n[i]||n[i].childNodes.length===0)return;n[i].childNodes[0].style.height=`${r[i]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Do))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let o=0;o<r;o++){const i=this.rowFilter.renderedToSource(o);n.oversizedRows&&n.oversizedRows[i]&&(n.oversizedRows[i]=void 0)}}}getCell(e){let n=e.row,r=e.col;const o=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(o&&Array.isArray(o)&&([n,r]=o),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const i=this.getRow(n);if(!i&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(o=>{const i=o.childNodes[r];i&&n.push(i)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const o=this.rowFilter.sourceToRendered(e),i=o<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):o,l=(o<0?this.THEAD:this.TBODY).childNodes[i];return l==null?void 0:l.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let o=0;o<r;o++){const i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=i==null?void 0:i.childNodes[o];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=ps(n,["TD","TH"])),n===null)return null;const r=n.parentNode,o=r.parentNode;let i=eP(r),s=n.cellIndex;return Yi(Sl,n,this.wtRootElement)||Yi(vl,n,this.wtRootElement)?o.nodeName==="THEAD"&&(i-=o.childNodes.length):Yi(vs,n,this.wtRootElement)||Yi(Do,n,this.wtRootElement)?i=this.wtSettings.getSetting("totalRows")-o.childNodes.length+i:o===this.THEAD?i=this.rowFilter.visibleColHeadedRowToSourceRow(i):i=this.rowFilter.renderedToSource(i),Yi(Sl,n,this.wtRootElement)||Yi(yl,n,this.wtRootElement)||Yi(vs,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(i,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=mi(this.TBODY)-1;let o,i,s,l,a;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),o=this.getRowHeight(s),l=this.getTrForRow(s),a=l.querySelector("th"),a?i=mi(a):i=mi(l)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<i||o<i)&&(i+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=i)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ct(this.TABLE)}getHeight(){return kt(this.TABLE)}getTotalWidth(){const e=ct(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=kt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return pl(this.TABLE)}_modifyRowHeaderWidth(e){let n=wt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const iu=bK,EK="stickyRowsBottom",qP={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};jo(qP,"MIXIN_NAME",EK,{writable:!1,enumerable:!1});const QP=qP,TK="stickyColumnsStart",ZP={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};jo(ZP,"MIXIN_NAME",TK,{writable:!1,enumerable:!1});const uR=ZP;class cR extends iu{constructor(e,n,r,o){super(e,n,r,o,vs)}}gt(cR,QP);gt(cR,uR);const MK=cR,vl="top",Do="bottom",yl="inline_start",Sl="top_inline_start_corner",vs="bottom_inline_start_corner",xK=[vl,Do,yl,Sl,vs],_K=new Map([[vl,`ht_clone_${vl}`],[Do,`ht_clone_${Do}`],[yl,`ht_clone_${yl} ht_clone_left`],[Sl,`ht_clone_${Sl} ht_clone_top_left_corner`],[vs,`ht_clone_${vs} ht_clone_bottom_left_corner`]]);function xw(t,e,n){return e=OK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OK(t){var e=IK(t,"string");return typeof e=="symbol"?e:String(e)}function IK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AK{constructor(e){xw(this,"dataAccessObject",void 0),xw(this,"lastScrolledColumnPos",-1),xw(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,o,i){const s=this.scrollViewportHorizontally(e.col,r,i),l=this.scrollViewportVertically(e.row,n,o);return s||l}scrollViewportHorizontally(e,n,r){const{drawn:o,totalColumns:i}=this.dataAccessObject;if(!o||!Number.isInteger(e)||e<0||e>i)return!1;const s=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn(),a=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(a&&e<u)return!1;let h=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?h=c.scrollTo(e,a?e>this.lastScrolledColumnPos:n):(a&&(e<s||e>l)||!a)&&(h=c.scrollTo(e,a?e>l:n)),h&&(this.lastScrolledColumnPos=e),h}scrollViewportVertically(e,n,r){const{drawn:o,totalRows:i}=this.dataAccessObject;if(!o||!Number.isInteger(e)||e<0||e>i)return!1;const s=this.getFirstVisibleRow(),l=this.getLastVisibleRow(),a=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:h}=this.dataAccessObject;if(a&&(e<c||e>i-u-1))return!1;let f=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?f=h.scrollTo(e,a?e>this.lastScrolledRowPos:r):(a&&(e<s||e>l)||!a)&&(f=h.scrollTo(e,a?e>l:r)),f&&(this.lastScrolledRowPos=e),f}getFirstVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:o,fixedRowsTop:i,rootWindow:s}=this.dataAccessObject;let l=n.getFirstVisibleRow();if(e.mainTableScrollableElement===s){const a=Qt(n.wtRootElement),u=mi(n.hider),c=mi(s),h=qc(s,s);if(a.top+u-c<=h){let f=r.getColumnHeaderHeight();f+=e.sumCellSizes(0,i);for(let g=o;g>0;g--)if(f+=e.sumCellSizes(g-1,g),a.top+u-f<=h){l=g;break}}}return l}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:o,rootWindow:i}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===i){const l=Qt(n.wtRootElement),a=qc(i,i);if(l.top>a){const u=mi(i);let c=r.getColumnHeaderHeight();for(let h=1;h<=o;h++)if(c+=e.sumCellSizes(h-1,h),l.top+c-a>=u){s=h-2;break}}}return s}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:n,wtViewport:r,totalColumns:o,rootWindow:i}=this.dataAccessObject;let s=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===i){const l=Qt(n.wtRootElement),a=vc(n.hider),u=vc(i),c=Math.abs(Tg(i,i));if(l.left+a-u<=c){let h=r.getRowHeaderWidth();for(let f=o;f>0;f--)if(h+=e.sumCellSizes(f-1,f),l.left+a-h<=c){s=f;break}}}return s}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:o,totalColumns:i,rootWindow:s}=this.dataAccessObject;let l=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let u=null;if(a){const h=r.TABLE.getBoundingClientRect(),g=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(h.right-g)}else u=Qt(r.wtRootElement).left;const c=Math.abs(Tg(s,s));if(u>c){const h=vc(s);let f=o.getRowHeaderWidth();for(let g=1;g<=i;g++)if(f+=n.sumCellSizes(g-1,g),u+f-c>=h){l=g-2;break}}}return l}}const HK=AK;function Kr(t,e,n){return e=PK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PK(t){var e=kK(t,"string");return typeof e=="symbol"?e:String(e)}function kK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hR{get eventManager(){return new Dt(this)}constructor(e,n){Kr(this,"wtTable",void 0),Kr(this,"wtScroll",void 0),Kr(this,"wtViewport",void 0),Kr(this,"wtOverlays",void 0),Kr(this,"selectionManager",void 0),Kr(this,"wtEvent",void 0),Kr(this,"guid",`wt_${k0()}`),Kr(this,"drawInterrupted",!1),Kr(this,"drawn",!1),Kr(this,"domBindings",void 0),Kr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new HK(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Es(r,e[n])}])}}createCellCoords(e,n){return new No(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new ja(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<o&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-i){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,o,i){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,o,i)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function AM(t,e,n){return e=DK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DK(t){var e=NK(t,"string");return typeof e=="symbol"?e:String(e)}function NK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LK extends hR{constructor(e,n,r){super(e,n),AM(this,"cloneSource",void 0),AM(this,"cloneOverlay",void 0);const o=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new GP(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function FK(t,e,n){return e=$K(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $K(t){var e=VK(t,"string");return typeof e=="symbol"?e:String(e)}function VK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ih{constructor(e,n,r,o,i){FK(this,"wtSettings",null),jo(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=n,this.wtSettings=o;const{TABLE:s,hider:l,spreader:a,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=a,this.holder=u,this.wtRootElement=c,this.trimmingContainer=wl(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=wl(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Qc(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){Ct(`The provided element is not a child of the ${this.type} overlay`);return}const o=this.mainTableScrollableElement===this.domBindings.rootWindow,i=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),l=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),a=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(a),top:a.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return o?h=this.getRelativeCellPositionWithinWindow(s,i,c,u):h=this.getRelativeCellPositionWithinHolder(s,l,i,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,o){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,l=0;if(!n)s=o.start;else{let a=i.left;this.isRtl()&&(a=this.domBindings.rootWindow.innerWidth-(i.left+i.width+un())),s=a<=0?-1*a:0}return e?l=this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top:l=o.top,{start:r.start+s,top:r.top+l}}getRelativeCellPositionWithinHolder(e,n,r,o,i){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let l=0,a=0;if(r||(l=s.horizontal-i.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();a=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(a=s.vertical-i.top);return{start:o.start-l,top:o.top-a}}makeClone(){if(xK.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:o}=this.domBindings,i=r.createElement("DIV"),s=r.createElement("TABLE"),l=e.wtRootElement.parentNode;i.className=`${_K.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,n.getSetting("ariaTags")&&He(i,[io()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),i.appendChild(s),l.appendChild(i);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===vl||u==="vertical"&&this.type===yl?this.mainTableScrollableElement=o:o.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Qc(e.TABLE),new LK(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,o=n.style,i=e.parentNode.style;O([r,o,i],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class BK extends Ih{constructor(e,n,r,o,i,s){super(e,n,vs,r,o),this.bottomOverlay=i,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new MK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${i}px`,n.style.bottom=`${s}px`}else Th(n),this.repositionOverlay();let r=kt(this.clone.wtTable.TABLE);const o=ct(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${o}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let i=0;n.hasVerticalScroll()||(i+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(i+=un(r)),o.style.bottom=`${i}px`}}const WK="calculatedColumns",JP={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};jo(JP,"MIXIN_NAME",WK,{writable:!1,enumerable:!1});const dR=JP;class fR extends iu{constructor(e,n,r,o){super(e,n,r,o,Do)}}gt(fR,QP);gt(fR,dR);const UK=fR;function zK(t,e,n){return e=jK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jK(t){var e=YK(t,"string");return typeof e=="symbol"?e:String(e)}function YK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GK extends Ih{constructor(e,n,r,o){super(e,n,Do,r,o),zK(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new UK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const o=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!o||o!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const i=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let i=0;n.hasVerticalScroll()||(i+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(i+=un(r)),o.style.bottom=`${i}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(Im(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:o}=this.wot,i=o.getSetting("defaultRowHeight");let s=e,l=0;for(;s<n;){const a=r.getRowHeight(s);l+=a===void 0?i:a,s+=1}return l}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:o}=this.domBindings,i=un(r),l=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||a==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=i),c=Math.min(c,e.wtRootElement.scrollWidth),l.width=`${c}px`}else l.width="";this.clone.wtTable.holder.style.width=l.width;let u=kt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),l.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&i.offsetHeight!==i.clientHeight&&(s=un(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return qc(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const o=this.wot.wtTable.getTotalHeight(),i=this.clone.wtTable.getTotalHeight(),s=o-i,l=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-l+o,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,o=this.wtSettings.getSetting("columnHeaders");let i=!1;if((r||n===0)&&o.length>0){const s=this.wot.wtTable.holder.parentNode,l=Pe(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(te(s,"innerBorderBottom"),i=!l):(ke(s,"innerBorderBottom"),i=l)}return i}}const KK="calculatedRows",ek={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};jo(ek,"MIXIN_NAME",KK,{writable:!1,enumerable:!1});const tk=ek;class gR extends iu{constructor(e,n,r,o){super(e,n,r,o,yl)}}gt(gR,tk);gt(gR,uR);const XK=gR,qK="localHooks",nk={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,o,i,s){if(this._localHooks[t]){const l=this._localHooks[t].length;for(let a=0;a<l;a++)Mg(this._localHooks[t][a],this,e,n,r,o,i,s)}},clearLocalHooks(){return this._localHooks={},this}};jo(nk,"MIXIN_NAME",qK,{writable:!1,enumerable:!1});const cr=nk;let rk=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};gt(rk,cr);const QK=rk,ok="active-header",mR="header",pR="area",wR="focus",ZK="fill",JK="row",e8="column",t8="custom-selection",CR=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var n8=WP;n8("flat");function r8(t,e){ik(t,e),e.add(t)}function HM(t,e,n){ik(t,e),e.set(t,n)}function ik(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _w(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Kt(t,e){var n=sk(t,e,"get");return o8(t,n)}function o8(t,e){return e.get?e.get.call(t):e.value}function PM(t,e,n){var r=sk(t,e,"set");return i8(t,r,n),n}function sk(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function i8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Xr=new WeakMap,nr=new WeakMap,vd=new WeakSet;class s8{constructor(){r8(this,vd),HM(this,Xr,{writable:!0,value:void 0}),HM(this,nr,{writable:!0,value:void 0})}setActiveOverlay(e){return PM(this,nr,e),this}setActiveSelection(e){return PM(this,Xr,e),this}scan(){const e=Kt(this,Xr).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,o,i]=Kt(this,Xr).getCorners(),{wtTable:s}=Kt(this,nr),l=s.getRenderedColumnsCount(),a=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<l;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>i)){for(let f=-a;f<0;f++){if(f<n||f>o)continue;const g=f+a;let p=s.getColumnHeader(h,g);const y=Kt(this,nr).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:Kt(this,Xr).settings.selectionType,columnCursor:u,selectionWidth:i-r+1});y!==null&&(y!==h&&(p=s.getColumnHeader(y,g)),e(p))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,o,i]=Kt(this,Xr).getCorners(),{wtTable:s}=Kt(this,nr),l=s.getRenderedRowsCount(),a=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<l;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>o)){for(let f=-a;f<0;f++){if(f<r||f>i)continue;const g=f+a;let p=s.getRowHeader(h,g);const y=Kt(this,nr).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:Kt(this,Xr).settings.selectionType,rowCursor:u,selectionHeight:o-n+1});y!==null&&(y!==h&&(p=s.getRowHeader(y,g)),e(p))}u+=1}}}scanCellsRange(e){const[n,r,o,i]=Kt(this,Xr).getCorners(),{wtTable:s}=Kt(this,nr);_w(this,vd,Ow).call(this,(l,a)=>{if(l>=n&&l<=o&&a>=r&&a<=i){const u=s.getCell(Kt(this,nr).createCellCoords(l,a)),c=Kt(this,nr).getSetting("onAfterDrawSelection",l,a,Kt(this,Xr).settings.layerLevel);typeof c=="string"&&te(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=Kt(this,Xr).getCorners(),{wtTable:o}=Kt(this,nr);_w(this,vd,Ow).call(this,(i,s)=>{if(i>=n&&i<=r){const l=o.getCell(Kt(this,nr).createCellCoords(i,s));e(l)}})}scanColumnsInCellsRange(e){const[,n,,r]=Kt(this,Xr).getCorners(),{wtTable:o}=Kt(this,nr);_w(this,vd,Ow).call(this,(i,s)=>{if(s>=n&&s<=r){const l=o.getCell(Kt(this,nr).createCellCoords(i,s));e(l)}})}}function Ow(t){const{wtTable:e}=Kt(this,nr),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let o=0;o<n;o+=1){const i=e.rowFilter.renderedToSource(o);for(let s=0;s<r;s+=1)t(i,e.columnFilter.renderedToSource(s))}}class l8{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=CR,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const o=this.main.childNodes[n];this.eventManager.addEventListener(o,"mouseenter",i=>this.onMouseEnter(i,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),br(e);const r=this,o=this.wot.rootDocument.body,i=n.getBoundingClientRect();n.style.display="none";function s(a){if(a.clientY<Math.floor(i.top)||a.clientY>Math.ceil(i.top+i.height)||a.clientX<Math.floor(i.left)||a.clientX>Math.ceil(i.left+i.width))return!0}function l(a){s(a)&&(r.eventManager.removeEventListener(o,"mousemove",l),n.style.display="block")}this.eventManager.addEventListener(o,"mousemove",l)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(let l=0;l<5;l++){const a=r[l],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[a]&&this.settings[a].hide&&(u.className+=" hidden"),o=u.style,o.backgroundColor=this.settings[a]&&this.settings[a].color?this.settings[a].color:e.border.color,o.height=this.settings[a]&&this.settings[a].width?`${this.settings[a].width}px`:`${e.border.width}px`,o.width=this.settings[a]&&this.settings[a].width?`${this.settings[a].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),pi()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let s=i.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",i.bordersHolder=s,i.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const o={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Ue(o,(s,l)=>{this.selectionHandles.styles.bottomHitArea[l]=s,this.selectionHandles.styles.topHitArea[l]=s});const i={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Ue(i,(s,l)=>{this.selectionHandles.styles.bottom[l]=s,this.selectionHandles.styles.top[l]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,o,i,s){const a=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:f}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),p=parseInt(u.width,10),y=parseInt(c.width,10),E=this.wot.wtTable.getWidth(),w=this.wot.wtTable.getHeight();u.top=`${parseInt(r-p-1,10)}px`,u[a]=`${parseInt(o-p-1,10)}px`,c.top=`${parseInt(r-y/4*3,10)}px`,c[a]=`${parseInt(o-y/4*3,10)}px`;const C=Math.min(parseInt(o+i,10),E-p-g*2),S=Math.min(parseInt(o+i-y/4,10),E-y-g*2);h[a]=`${C}px`,f[a]=`${S}px`;const T=Math.min(parseInt(r+s,10),w-p-g*2),x=Math.min(parseInt(r+s-y/4,10),w-y-g*2);h.top=`${T}px`,f.top=`${x}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",f.display="none"):(h.display="block",f.display="block")):(u.display="none",h.display="none",c.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:o}=this.wot;let i,s,l,a,u,c;const h=n.getRenderedRowsCount();for(let b=0;b<h;b+=1){const d=n.rowFilter.renderedToSource(b);if(d>=e[0]&&d<=e[2]){i=d,u=e[0];break}}for(let b=h-1;b>=0;b-=1){const d=n.rowFilter.renderedToSource(b);if(d>=e[0]&&d<=e[2]){s=d;break}}const f=n.getRenderedColumnsCount();for(let b=0;b<f;b+=1){const d=n.columnFilter.renderedToSource(b);if(d>=e[1]&&d<=e[3]){l=d,c=e[1];break}}for(let b=f-1;b>=0;b-=1){const d=n.columnFilter.renderedToSource(b);if(d>=e[1]&&d<=e[3]){a=d;break}}if(i===void 0||l===void 0){this.disappear();return}let g=n.getCell(this.wot.createCellCoords(i,l));const p=i!==s||l!==a,y=p?n.getCell(this.wot.createCellCoords(s,a)):g,E=Qt(g),w=p?Qt(y):E,C=Qt(n.TABLE),S=ct(n.TABLE),T=E.top,x=E.left,A=this.wot.wtSettings.getSetting("rtlMode");let D=0,U=0;if(A){const b=ct(g),d=o.innerWidth-C.left-S;U=x+b-w.left,D=o.innerWidth-x-b-d-1}else U=w.left+ct(y)-x,D=x-C.left-1;if(this.isEntireColumnSelected(i,s)){const b=this.getDimensionsFromHeader("columns",l,a,u,C);let d=null;b&&([d,D,U]=b),d&&(g=d)}let j=T-C.top-1,z=w.top+kt(y)-T;if(this.isEntireRowSelected(l,a)){const b=this.getDimensionsFromHeader("rows",i,s,c,C);let d=null;b&&([d,j,z]=b),d&&(g=d)}const Z=Ti(g,o);parseInt(Z.borderTopWidth,10)>0&&(j+=1,z=z>0?z-1:0),parseInt(Z[A?"borderRightWidth":"borderLeftWidth"],10)>0&&(D+=1,U=U>0?U-1:0);const re=A?"right":"left";this.topStyle.top=`${j}px`,this.topStyle[re]=`${D}px`,this.topStyle.width=`${U}px`,this.topStyle.display="block",this.startStyle.top=`${j}px`,this.startStyle[re]=`${D}px`,this.startStyle.height=`${z}px`,this.startStyle.display="block";const ne=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${j+z-ne}px`,this.bottomStyle[re]=`${D}px`,this.bottomStyle.width=`${U}px`,this.bottomStyle.display="block",this.endStyle.top=`${j}px`,this.endStyle[re]=`${D+U-ne}px`,this.endStyle.height=`${z+1}px`,this.endStyle.display="block";let ue=this.settings.border.cornerVisible;ue=typeof ue=="function"?ue(this.settings.layerLevel):ue;const Re=this.wot.getSetting("onModifyGetCellCoords",s,a);let[Ne,Ae]=[s,a];if(Re&&Array.isArray(Re)&&([,,Ne,Ae]=Re),pi()||!ue||this.isPartRange(Ne,Ae))this.cornerStyle.display="none";else{this.cornerStyle.top=`${j+z+this.cornerCenterPointOffset-1}px`,this.cornerStyle[re]=`${D+U+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let b=wl(n.TABLE);const d=b===o;d&&(b=r.documentElement);const m=parseInt(this.cornerDefaultStyle.width,10)/2,v=parseInt(this.cornerDefaultStyle.height,10)/2;if(a===this.wot.getSetting("totalColumns")-1){const _=d?y.getBoundingClientRect().left:y.offsetLeft;let I=!1,H=0;A?(H=_-parseInt(this.cornerDefaultStyle.width,10)/2,I=H<0):(H=_+ct(y)+parseInt(this.cornerDefaultStyle.width,10)/2,I=H>=vc(b)),I&&(this.cornerStyle[re]=`${Math.floor(D+U+this.cornerCenterPointOffset-m)}px`,this.cornerStyle[A?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(d?y.getBoundingClientRect().top:y.offsetTop)+kt(y)+parseInt(this.cornerDefaultStyle.height,10)/2>=mi(b)&&(this.cornerStyle.top=`${Math.floor(j+z+this.cornerCenterPointOffset-v)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}pi()&&this.updateMultipleSelectionHandlesPosition(s,a,j,D,U,z)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,o,i){const{wtTable:s}=this.wot,l=s.wtRootElement.parentNode;let a=null,u=null,c=null,h=null,f=null,g=null,p=null,y=null;switch(e){case"rows":a=function(){return s.getRowHeader(...arguments)},u=function(){return kt(...arguments)},c="ht__selection--rows",g="top";break;case"columns":a=function(){return s.getColumnHeader(...arguments)},u=function(){return ct(...arguments)},c="ht__selection--columns",g="left";break}if(l.classList.contains(c)){const E=this.wot.getSetting("columnHeaders").length;if(p=a(n,E-o),y=a(r,E-o),!p||!y)return!1;const w=Qt(p),C=Qt(y);return p&&y&&(h=w[g]-i[g]-1,f=C[g]+u(y)-w[g]),[p,h,f]}return!1}changeBorderStyle(e,n){const r=this[e].style,o=n[e];!o||o.hide?te(this[e],"hidden"):(Pe(this[e],"hidden")&&ke(this[e],"hidden"),r.backgroundColor=o.color,(e==="top"||e==="bottom")&&(r.height=`${o.width}px`),(e==="start"||e==="end")&&(r.width=`${o.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?te(this[e],"hidden"):ke(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",pi()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const kM=l8;function a8(t,e){lk(t,e),e.add(t)}function Wl(t,e,n){lk(t,e),e.set(t,n)}function lk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u8(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Be(t,e){var n=ak(t,e,"get");return c8(t,n)}function c8(t,e){return e.get?e.get.call(t):e.value}function DM(t,e,n){var r=ak(t,e,"set");return h8(t,r,n),n}function ak(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function h8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Tn=new WeakMap,xn=new WeakMap,Iw=new WeakMap,Zu=new WeakMap,Aw=new WeakMap,Ls=new WeakMap,NM=new WeakSet;class d8{constructor(e){a8(this,NM),Wl(this,Tn,{writable:!0,value:void 0}),Wl(this,xn,{writable:!0,value:void 0}),Wl(this,Iw,{writable:!0,value:new s8}),Wl(this,Zu,{writable:!0,value:new WeakMap}),Wl(this,Aw,{writable:!0,value:new WeakSet}),Wl(this,Ls,{writable:!0,value:new Map}),DM(this,xn,e)}setActiveOverlay(e){return DM(this,Tn,e),Be(this,Iw).setActiveOverlay(Be(this,Tn)),Be(this,Zu).has(Be(this,Tn))||Be(this,Zu).set(Be(this,Tn),new Set),this}getFocusSelection(){return Be(this,xn)!==null?Be(this,xn).getFocus():null}getAreaSelection(){return Be(this,xn)!==null?Be(this,xn).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Be(this,Ls).has(e)){const r=Be(this,Ls).get(e);if(r.has(Be(this,Tn)))return r.get(Be(this,Tn));const o=new kM(Be(this,Tn),e.settings);return r.set(Be(this,Tn),o),o}const n=new kM(Be(this,Tn),e.settings);return Be(this,Ls).set(e,new Map([[Be(this,Tn),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Be(this,Ls).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Be(this,Ls).get(e).forEach(n=>n.destroy()),Be(this,Ls).delete(e)}render(e){if(Be(this,xn)===null)return;e&&u8(this,NM,f8).call(this);const n=Array.from(Be(this,xn)),r=new Map;for(let o=0;o<n.length;o++){const i=n[o],{className:s,createLayers:l,selectionType:a}=i.settings;Be(this,Aw).has(i)||(Be(this,Aw).add(i),i.addLocalHook("destroy",()=>this.destroyBorders(i)));const u=this.getBorderInstance(i);if(i.isEmpty()){u==null||u.disappear();continue}s&&Be(this,Iw).setActiveSelection(i).scan().forEach(f=>{if(r.has(f)){const g=r.get(f);g.has(s)&&l===!0?g.set(s,g.get(s)+1):g.set(s,1)}else r.set(f,new Map([[s,1]]))});const c=i.getCorners();Be(this,Tn).getSetting("onBeforeDrawBorders",c,a),u==null||u.appear(c)}r.forEach((o,i)=>{var s,l;const a=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(f,g)=>`${c}-${g+1}`)]}).flat();a.forEach(u=>Be(this,Zu).get(Be(this,Tn)).add(u)),te(i,a),i.nodeName==="TD"&&Array.isArray((s=Be(this,xn).options)===null||s===void 0?void 0:s.cellAttributes)?He(i,Be(this,xn).options.cellAttributes):i.nodeName==="TH"&&Array.isArray((l=Be(this,xn).options)===null||l===void 0?void 0:l.headerAttributes)&&He(i,Be(this,xn).options.headerAttributes)})}}function f8(){const t=Be(this,Zu).get(Be(this,Tn)),e=Be(this,Tn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,o;const i=Be(this,Tn).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=Be(this,xn).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=Be(this,xn).options.cellAttributes.map(l=>l[0])),Array.isArray((o=Be(this,xn).options)===null||o===void 0?void 0:o.headerAttributes)&&(s=[...s,...Be(this,xn).options.headerAttributes.map(l=>l[0])]);for(let l=0,a=i.length;l<a;l++)ke(i[l],n),bh(i[l],s)}),t.clear()}class g8 extends Ih{constructor(e,n,r,o){super(e,n,yl,r,o)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new XK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,o=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer===n&&(!o||o!=="horizontal")?(i=this.getOverlayOffset()*(this.isRtl()?-1:1),Am(r,`${i}px`,"0px")):(i=this.getScrollPosition(),Th(r));const s=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,V0(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let o=e,i=0;for(;o<n;)i+=this.wot.wtTable.getStretchedColumnWidth(o)||r,o+=1;return i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,o=un(n),s=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||l==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=o),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const a=ct(this.clone.wtTable.TABLE);s.width=`${a}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(CR.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const l=this.wot.wtTable.getColumnWidth(e),a=this.wot.wtViewport.getViewportWidth();l>a&&(n=!1)}return n&&i.offsetWidth!==i.clientWidth&&(s=un(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(Tg(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const o=this.wot.wtTable.getTotalWidth(),i=this.clone.wtTable.getTotalWidth(),s=o-i;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),o=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?ke(n,"emptyRows"):te(n,"emptyRows");let s=!1;if(o&&!r.length)te(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&r.length){const l=Pe(n,"innerBorderInlineStart");e?(te(n,"innerBorderLeft innerBorderInlineStart"),s=!l):(ke(n,"innerBorderLeft innerBorderInlineStart"),s=l)}return s}}const m8="stickyRowsTop",uk={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};jo(uk,"MIXIN_NAME",m8,{writable:!1,enumerable:!1});const ck=uk;class vR extends iu{constructor(e,n,r,o){super(e,n,r,o,Sl)}}gt(vR,ck);gt(vR,uR);const p8=vR;function LM(t,e,n){return e=w8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w8(t){var e=C8(t,"string");return typeof e=="symbol"?e:String(e)}function C8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v8 extends Ih{constructor(e,n,r,o,i,s){super(e,n,Sl,r,o),LM(this,"topOverlay",void 0),LM(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new p8(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),i=this.topOverlay.getOverlayOffset();Am(e,`${o}px`,`${i}px`)}else Th(e);let n=kt(this.clone.wtTable.TABLE);const r=ct(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class yR extends iu{constructor(e,n,r,o){super(e,n,r,o,vl)}}gt(yR,ck);gt(yR,dR);const y8=yR;function S8(t,e,n){return e=R8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R8(t){var e=b8(t,"string");return typeof e=="symbol"?e:String(e)}function b8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E8 extends Ih{constructor(e,n,r,o){super(e,n,vl,r,o),S8(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new y8(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let o=0,i=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:l}=this.wot,a=l.hider.getBoundingClientRect(),u=Math.ceil(a.bottom),c=e.offsetHeight;i=u===c,o=this.getOverlayOffset(),Am(e,"0px",`${o}px`)}else o=this.getScrollPosition(),Th(e);const s=this.adjustHeaderBordersPosition(o,i);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(Im(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let o=e,i=0;for(;o<n;){const s=this.wot.wtTable.getRowHeight(o);i+=s===void 0?r:s,o+=1}return i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,o=un(n),s=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||l==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=o),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let a=kt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(a=0),s.height=`${a}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(CR.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:o}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let l=this.getTableParentOffset(),a=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(a=un(this.domBindings.rootDocument)),n){const u=o.getSetting("fixedRowsBottom"),c=o.getSetting("totalRows");l+=this.sumCellSizes(0,e+1),l-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),l+=1}else l+=this.sumCellSizes(o.getSetting("fixedRowsTop"),e);return l+=a,this.setScrollPosition(l)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return qc(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const o=this.wot.wtTable.getTotalHeight(),i=this.clone.wtTable.getTotalHeight(),s=o-i;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?ke(r,"emptyColumns"):te(r,"emptyColumns");let i=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),l=this.cachedFixedRowsTop!==s,a=this.wtSettings.getSetting("columnHeaders");if((l||s===0)&&a.length>0){const u=Pe(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(te(r,"innerBorderTop"),i=!u):(ke(r,"innerBorderTop"),i=u)}}return i}}function Xo(t,e,n){return e=T8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T8(t){var e=M8(t,"string");return typeof e=="symbol"?e:String(e)}function M8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x8{constructor(e,n,r,o,i,s){Xo(this,"wot",null),Xo(this,"topOverlay",null),Xo(this,"bottomOverlay",null),Xo(this,"inlineStartOverlay",null),Xo(this,"topInlineStartCornerOverlay",null),Xo(this,"bottomInlineStartCornerOverlay",null),Xo(this,"browserLineHeight",void 0),Xo(this,"wtSettings",null),Xo(this,"resizeObserver",new ResizeObserver(c=>{Fm(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=o,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:l,rootWindow:a}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=un(l);const u=a.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Qc(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=a.scrollX,this.lastScrollY=a.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),o=parseInt(r.lineHeight,10),i=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=o||i}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new E8(...e),this.bottomOverlay=new GK(...e),this.inlineStartOverlay=new g8(...e),this.topInlineStartCornerOverlay=new v8(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new BK(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:o}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==o&&this.eventManager.addEventListener(o,"scroll",h=>this.onTableScroll(h),{passive:!0});const i=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,l=this.wtSettings.getSetting("preventWheel"),a={passive:s};(l||i||!G0())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,l),a),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:f}=h.clone.wtTable;this.eventManager.addEventListener(f,"wheel",g=>this.onCloneWheel(g,l),a)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(o!==n&&i!==n&&!e.target.contains(o)||r!==n&&i!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target,l=i!==r&&s!==r&&!s.contains(i),a=o!==r&&s!==r&&!s.contains(o);if(this.keyPressed&&(l||a))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=za(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const o=this.scrollVertically(n),i=this.scrollHorizontally(r);return o||i}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[o,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=o;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=o)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Qc(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,o=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,o=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),l=n.getColumnHeaderHeight(),a=r.hider.style;if(a.width=`${s+this.inlineStartOverlay.sumCellSizes(0,o)}px`,a.height=`${l+this.topOverlay.sumCellSizes(0,i)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:h,scrollWidth:f}=r.holder;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<f,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return O(n,o=>{o&&o.clone&&o.clone.wtTable.TABLE.contains(e)&&(r=o.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];O(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const _8=x8;function FM(t,e,n){return e=O8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O8(t){var e=I8(t,"string");return typeof e=="symbol"?e:String(e)}function I8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A8{constructor(e){FM(this,"settings",{}),FM(this,"defaults",Object.freeze(this.getDefaults())),Ue(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const o=this.getSetting("data",e,n);Es(r,o??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ue(e,(r,o)=>{this.settings[o]=r}):this.settings[e]=n,this}getSetting(e,n,r,o,i){return typeof this.settings[e]=="function"?this.settings[e](n,r,o,i):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class SR extends iu{constructor(e,n,r,o){super(e,n,r,o,"master")}alignOverlaysWithTrimmingContainer(){const e=wl(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,o=Wa(e,"height",n),i=Wa(e,"overflow",n),s=this.holder.style,{scrollWidth:l,scrollHeight:a}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(i)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?r.insertBefore(f,e.nextElementSibling):r.appendChild(f);const g=parseInt(Ti(f,n).height,10);r.removeChild(f),g===0&&(c=0)}c=Math.min(c,a),s.height=o==="auto"?"auto":`${c}px`,u=Math.min(u,l),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=pl(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",i=e.getSetting("columnHeaders").length;if(i&&!n.hasOversizedColumnHeadersMarked[r]){const l=e.getSetting("rowHeaders").length,a=this.getRenderedColumnsCount();for(let u=0;u<i;u++)for(let c=-1*l;c<a;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}gt(SR,tk);gt(SR,dR);const H8=SR;class P8{constructor(e,n,r,o,i){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=kt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,o=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),l=e.getSetting("preventOverflow"),a=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=a?u.right-i:u.left,h=i-c;let f,g;if(l)return ct(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?f=Math.min(h,i):f=Math.min(this.getContainerFillWidth(),h,i),o===r&&s>0&&this.sumColumnWidths(0,s-1)>f)return n.documentElement.clientWidth;if(o!==r&&(g=Wa(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(f,o.clientWidth);const p=e.getSetting("stretchH");return p==="none"||!p?Math.max(f,ct(this.wtTable.TABLE)):f}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,o=e;for(;o<n;)r+=this.wtTable.getColumnWidth(o),o+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return Qt(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=kt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,o=n.length;r<o;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let o=0,i=n.length;o<i;o++)r?(this.rowHeaderWidth+=ct(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:el;const{wtSettings:n,wtTable:r}=this;let o,i,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&e===el?o=1/0:o=this.getViewportHeight();let l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const a=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return a&&l>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,a),l+=s,o-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),o-=s),r.holder.clientHeight===r.holder.offsetHeight?i=0:i=un(this.domBindings.rootDocument),new UP({viewportSize:o,scrollOffset:l,totalItems:n.getSetting("totalRows"),itemSizeFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,scrollbarHeight:i})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:el;const{wtSettings:n,wtTable:r}=this;let o=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&i>=0){const l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);i+=l,o-=l}return r.holder.clientWidth!==r.holder.offsetWidth&&(o-=un(this.domBindings.rootDocument)),new oR({viewportSize:o,scrollOffset:i,totalItems:n.getSetting("totalColumns"),itemSizeFn:l=>r.getColumnWidth(l),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:(l,a)=>n.getSetting("onBeforeStretchingColumnWidth",l,a),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n){const r=this.createRowsCalculator(In),o=this.createColumnsCalculator(In);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(el),this.columnsRenderCalculator=this.createColumnsCalculator(el)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(In),this.columnsVisibleCalculator=this.createColumnsCalculator(In)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:o}=e;if(n===null&&r===null)return!o;const{startRow:i,endRow:s}=this.rowsRenderCalculator;return n<i||n===i&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:o}=e;if(n===null&&r===null)return!o;const{startColumn:i,endColumn:s}=this.columnsRenderCalculator;return n<i||n===i&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Ue(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const k8=P8;class D8 extends hR{constructor(e,n){super(e,new A8(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new H8(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new k8(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new d8(this.wtSettings.getSetting("selections")),this.wtEvent=new GP(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new _8(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ue(e,(o,i)=>{this.wtSettings.getSetting(i).length&&r.push(o),n.push(o)}),ke(this.wtTable.wtRootElement.parentNode,n),te(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class RR{constructor(e){e instanceof hR?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new RR(n);return()=>r},this._wot=new D8(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,o,i){return this._wot.scrollViewport(e,n,r,o,i)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,o,i){return this._wot.wtSettings.getSetting(e,n,r,o,i)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function $M(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:o,selection:i,controller:s,cellCoordsFactory:l}=t;const a=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();if(e&&a)o.row>=0&&o.col>=0&&!s.cell?i.setRangeEnd(o):(u||c)&&o.row>=0&&o.col>=0&&!s.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!s.column?i.setRangeEnd(l(a.to.row,o.col)):c&&o.col<0&&!s.row?i.setRangeEnd(l(o.row,a.to.col)):(!u&&!c&&o.col<0||u&&o.col<0)&&!s.row?i.selectRows(Math.max(a.from.row,0),o.row,o.col):(!u&&!c&&o.row<0||c&&o.row<0)&&!s.column&&i.selectColumns(Math.max(a.from.col,0),o.col,o.row);else{const h=!i.inInSelection(o),f=n||r&&h;o.row<0&&o.col>=0&&!s.column?f&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!s.row?f&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!s.cell?f&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function N8(t){let{isLeftClick:e,coords:n,selection:r,controller:o,cellCoordsFactory:i}=t;if(!e)return;const s=r.isSelectedByRowHeader(),l=r.isSelectedByColumnHeader(),a=r.tableProps.countCols(),u=r.tableProps.countRows();l&&!o.column?r.setRangeEnd(i(u-1,n.col)):s&&!o.row?r.setRangeEnd(i(n.row,a-1)):o.cell||r.setRangeEnd(n)}const L8=new Map([["mousedown",$M],["mouseover",N8],["touchstart",$M]]);function VM(t,e){let{coords:n,selection:r,controller:o,cellCoordsFactory:i}=e;L8.get(t.type)({coords:n,selection:r,controller:o,cellCoordsFactory:i,isShiftKey:t.shiftKey,isLeftClick:Dm(t)||t.type==="touchstart",isRightClick:Ts(t)})}const hk=new WeakMap,bR=Symbol("rootInstance");function F8(t){hk.set(t,!0)}function $8(t){return t===bR}function Pf(t){return hk.has(t)}function BM(t,e,n){V8(t,e),e.set(t,n)}function V8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ni(t,e,n){return e=B8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B8(t){var e=W8(t,"string");return typeof e=="symbol"?e:String(e)}function W8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WM(t,e){var n=dk(t,e,"get");return U8(t,n)}function U8(t,e){return e.get?e.get.call(t):e.value}function UM(t,e,n){var r=dk(t,e,"set");return z8(t,r,n),n}function dk(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function z8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Fs=new WeakMap;var Hw=new WeakMap,Pw=new WeakMap;class j8{constructor(e){Ni(this,"instance",void 0),Ni(this,"eventManager",void 0),Ni(this,"settings",void 0),Ni(this,"THEAD",void 0),Ni(this,"TBODY",void 0),Ni(this,"_wt",void 0),Ni(this,"activeWt",void 0),BM(this,Hw,{writable:!0,value:0}),BM(this,Pw,{writable:!0,value:0}),Ni(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new Dt(this.instance),this.settings=this.instance.getSettings(),Fs.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,o,i){return this._wt.scrollViewport(e,n,r,o,i)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const e=Fs.get(this),{rootElement:n,rootDocument:r}=this.instance,o=n.getAttribute("style");o&&n.setAttribute("data-originalstyle",o),te(n,"handsontable"),e.table=r.createElement("TABLE"),te(e.table,"htCore"),this.instance.getSettings().tableClassName&&te(e.table,this.instance.getSettings().tableClassName),this.settings.ariaTags&&(He(e.table,[io()]),He(n,[O3(),KH(this.instance.countRows()),XH(this.instance.countCols()),U3()])),this.THEAD=r.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}registerEvents(){const e=Fs.get(this),{rootElement:n,rootDocument:r,selection:o}=this.instance,i=r.documentElement;this.eventManager.addEventListener(n,"mousedown",s=>{if(e.selectionMouseDown=!0,!this.isTextSelectionAllowed(s.target)){const{rootWindow:l}=this.instance;yy(l),s.preventDefault(),l.focus()}}),this.eventManager.addEventListener(n,"mouseup",()=>{e.selectionMouseDown=!1}),this.eventManager.addEventListener(n,"mousemove",s=>{e.selectionMouseDown&&!this.isTextSelectionAllowed(s.target)&&(this.settings.fragmentSelection&&yy(this.instance.rootWindow),s.preventDefault())}),this.eventManager.addEventListener(i,"keyup",s=>{o.isInProgress()&&!s.shiftKey&&o.finish()}),this.eventManager.addEventListener(i,"mouseup",s=>{o.isInProgress()&&Dm(s)&&o.finish(),e.mouseDown=!1;const l=Hm(r.activeElement);l&&(l||!o.isSelected()&&!o.isSelectedByAnyHeader()&&!n.contains(s.target)&&!Ts(s))&&this.instance.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",s=>{o.isInProgress()&&Ts(s)&&(o.finish(),e.mouseDown=!1)}),this.eventManager.addEventListener(i,"touchend",()=>{o.isInProgress()&&o.finish(),e.mouseDown=!1}),this.eventManager.addEventListener(i,"mousedown",s=>{const l=s.target,a=s.x||s.clientX,u=s.y||s.clientY;let c=s.target;if(e.mouseDown||!n||!this.instance.view)return;const{holder:h}=this.instance.view._wt.wtTable;if(c===h){const g=un(r);if(r.elementFromPoint(a+g,u)!==h||r.elementFromPoint(a,u+g)!==h)return}else for(;c!==i;){if(c===null){if(s.isTargetWebComponent)break;return}if(c===n)return;c=c.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.instance.deselectCell():this.instance.destroyEditor(!1,!1)}),this.eventManager.addEventListener(e.table,"selectstart",s=>{this.settings.fragmentSelection||Zc(s.target)||s.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.instance._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,o=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),o===null&&(o=n),[r,o]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),o=e.getNearestNotHiddenIndex(r-1,-1);return o===null?0:e.getRenderableFromVisualIndex(o)+1}countRenderableColumns(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.instance.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.instance.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,o){if(isNaN(e)||e<0)return 0;const i=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(i);if(!Number.isInteger(s))return 0;let l=0;return n<0?l=s+1:n>0&&(l=o-s),l}countNotHiddenFixedColumnsStart(){const e=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.instance.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let o=e;o<=n;o++)this.instance.columnIndexMapper.getRenderableFromVisualIndex(o)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let o=e;o<=n;o++)this.instance.rowIndexMapper.getRenderableFromVisualIndex(o)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>n}initializeWalkontable(){const e=Fs.get(this),n={ariaTags:this.settings.ariaTags,rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,isDataViewInstance:()=>Pf(this.instance),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(s,l)=>this.instance.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,l)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||n.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||n.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const s=[];return this.instance.hasRowHeaders()&&s.push((l,a)=>{const u=l>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(l):l;this.appendRowHeader(u,a)}),this.instance.runHooks("afterGetRowHeaderRenderers",s),UM(this,Pw,s.length),s},columnHeaders:()=>{const s=[];return this.instance.hasColHeaders()&&s.push((l,a)=>{const u=l>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(l):l;this.appendColHeader(u,a)}),this.instance.runHooks("afterGetColumnHeaderRenderers",s),UM(this,Hw,s.length),s},columnWidth:s=>{const l=this.instance.columnIndexMapper.getVisualFromRenderableIndex(s);return this.instance.getColWidth(l===null?s:l)},rowHeight:s=>{const l=this.instance.rowIndexMapper.getVisualFromRenderableIndex(s);return this.instance.getRowHeight(l===null?s:l)},cellRenderer:(s,l,a)=>{const[u,c]=this.translateFromRenderableToVisualIndex(s,l),h=this.instance.runHooks("modifyGetCellCoords",u,c);let f=u,g=c;Array.isArray(h)&&([f,g]=h);const p=this.instance.getCellMeta(f,g),y=this.instance.colToProp(g);let E=this.instance.getDataAtRowProp(f,y);this.instance.hasHook("beforeValueRender")&&(E=this.instance.runHooks("beforeValueRender",E,p)),this.instance.runHooks("beforeRenderer",a,u,c,y,E,p),this.instance.getCellRenderer(p)(this.instance,a,u,c,y,E,p),this.instance.runHooks("afterRenderer",a,u,c,y,E,p)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onContainerElementResize:()=>{this.instance&&!this.instance.isDestroyed&&pl(this.instance.rootElement)&&this.instance.refreshDimensions()},onCellMouseDown:(s,l,a,u)=>{const c=this.translateFromRenderableToVisualCoords(l),h={row:!1,column:!1,cell:!1};this.instance.listen(),this.activeWt=u,e.mouseDown=!0,this.instance.runHooks("beforeOnCellMouseDown",s,c,a,h),!es(s)&&(VM(s,{coords:c,selection:this.instance.selection,controller:h,cellCoordsFactory:(f,g)=>this.instance._createCellCoords(f,g)}),this.instance.runHooks("afterOnCellMouseDown",s,c,a),this.activeWt=this._wt)},onCellContextMenu:(s,l,a,u)=>{const c=this.translateFromRenderableToVisualCoords(l);this.activeWt=u,e.mouseDown=!1,this.instance.selection.isInProgress()&&this.instance.selection.finish(),this.instance.runHooks("beforeOnCellContextMenu",s,c,a),!es(s)&&(this.instance.runHooks("afterOnCellContextMenu",s,c,a),this.activeWt=this._wt)},onCellMouseOut:(s,l,a,u)=>{const c=this.translateFromRenderableToVisualCoords(l);this.activeWt=u,this.instance.runHooks("beforeOnCellMouseOut",s,c,a),!es(s)&&(this.instance.runHooks("afterOnCellMouseOut",s,c,a),this.activeWt=this._wt)},onCellMouseOver:(s,l,a,u)=>{const c=this.translateFromRenderableToVisualCoords(l),h={row:!1,column:!1,cell:!1};this.activeWt=u,this.instance.runHooks("beforeOnCellMouseOver",s,c,a,h),!es(s)&&(e.mouseDown&&VM(s,{coords:c,selection:this.instance.selection,controller:h,cellCoordsFactory:(f,g)=>this.instance._createCellCoords(f,g)}),this.instance.runHooks("afterOnCellMouseOver",s,c,a),this.activeWt=this._wt)},onCellMouseUp:(s,l,a,u)=>{const c=this.translateFromRenderableToVisualCoords(l);this.activeWt=u,this.instance.runHooks("beforeOnCellMouseUp",s,c,a),!(es(s)||this.instance.isDestroyed)&&(this.instance.runHooks("afterOnCellMouseUp",s,c,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.instance.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.instance.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,l)=>this.beforeRender(s,l),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:s=>{const l=this.instance.rowIndexMapper,a=s<0;let u=s;return!a&&(u=l.getVisualFromRenderableIndex(s),u===null)?s:(u=this.instance.runHooks("beforeViewportScrollVertically",u),this.instance.runHooks("beforeViewportScroll"),a?u:l.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:s=>{const l=this.instance.columnIndexMapper,a=s<0;let u=s;return!a&&(u=l.getVisualFromRenderableIndex(s),u===null)?s:(u=this.instance.runHooks("beforeViewportScrollHorizontally",u),this.instance.runHooks("beforeViewportScroll"),a?u:l.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.instance.runHooks("afterScrollVertically"),this.instance.runHooks("afterScroll")},onScrollHorizontally:()=>{this.instance.runHooks("afterScrollHorizontally"),this.instance.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.instance.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,l,a)=>{const u=this.instance.rowIndexMapper,c=s<0;let h=s;c||(h=u.getVisualFromRenderableIndex(s));const f=this.instance.runHooks("beforeHighlightingRowHeader",h,l,a);return c?f:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(f,1))},onBeforeHighlightingColumnHeader:(s,l,a)=>{const u=this.instance.columnIndexMapper,c=s<0;let h=s;c||(h=u.getVisualFromRenderableIndex(s));const f=this.instance.runHooks("beforeHighlightingColumnHeader",h,l,a);return c?f:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(f,1))},onAfterDrawSelection:(s,l,a)=>{let u;const[c,h]=this.translateFromRenderableToVisualIndex(s,l),f=this.instance.selection.getSelectedRange();if(f.size()>0){const p=f.peekByIndex(a??0);u=[p.from.row,p.from.col,p.to.row,p.to.col]}return this.instance.runHooks("afterDrawSelection",c,h,u,a)},onBeforeDrawBorders:(s,l)=>{const[a,u,c,h]=s,f=[this.instance.rowIndexMapper.getVisualFromRenderableIndex(a),this.instance.columnIndexMapper.getVisualFromRenderableIndex(u),this.instance.rowIndexMapper.getVisualFromRenderableIndex(c),this.instance.columnIndexMapper.getVisualFromRenderableIndex(h)];return this.instance.runHooks("beforeDrawBorders",f,l)},onBeforeTouchScroll:()=>this.instance.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.instance.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(s,l)=>{const a=this.instance.columnIndexMapper.getVisualFromRenderableIndex(l);return this.instance.runHooks("beforeStretchingColumnWidth",s,a)},onModifyRowHeaderWidth:s=>this.instance.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,l,a)=>{const u=this.instance.rowIndexMapper,c=this.instance.columnIndexMapper,h=l>=0?c.getVisualFromRenderableIndex(l):l,f=s>=0?u.getVisualFromRenderableIndex(s):s,g=this.instance.runHooks("modifyGetCellCoords",f,h,a);if(Array.isArray(g)){const[p,y,E,w]=g;return[p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,1)):p,y>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(y,1)):y,E>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(E,-1)):E,w>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(w,-1)):w]}},viewportRowCalculatorOverride:s=>{let l=this.settings.viewportRowRenderingOffset;if(l==="auto"&&this.settings.fixedRowsTop&&(l=10),l>0||l==="auto"){const a=this.countRenderableRows(),u=s.startRow,c=s.endRow;if(typeof l=="number")s.startRow=Math.max(u-l,0),s.endRow=Math.min(c+l,a-1);else if(l==="auto"){const h=Math.ceil(c/a*12);s.startRow=Math.max(u-h,0),s.endRow=Math.min(c+h,a-1)}}this.instance.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let l=this.settings.viewportColumnRenderingOffset;if(l==="auto"&&this.settings.fixedColumnsStart&&(l=10),l>0||l==="auto"){const a=this.countRenderableColumns(),u=s.startColumn,c=s.endColumn;if(typeof l=="number"&&(s.startColumn=Math.max(u-l,0),s.endColumn=Math.min(c+l,a-1)),l==="auto"){const h=Math.ceil(c/a*6);s.startColumn=Math.max(u-h,0),s.endColumn=Math.min(c+h,a-1)}}this.instance.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.instance.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s}};this.instance.runHooks("beforeInitWalkontable",n),this._wt=new RR(n),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:o,height:i}=this.instance.rootElement.getBoundingClientRect();this.setLastSize(o,i),this.eventManager.addEventListener(r,"mousedown",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.instance.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Zc(e))return!0;const n=ws(e,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Fs.get(this).mouseDown}isSelectedOnlyCell(){var e,n;return(e=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.instance.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}afterRender(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!Pe(r,"relative")){go(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{const{rootDocument:r,getRowHeader:o}=this.instance,i=r.createElement("div"),s=r.createElement("span");i.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,o),i.appendChild(s),n.appendChild(i)}this.instance.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const i=n.firstChild;Pe(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),e,r,o):(go(n),this.appendColHeader(e,n,r,o))}else{const{rootDocument:i}=this.instance,s=i.createElement("div"),l=i.createElement("span");s.className="relative",l.className="colHeader",this.updateCellHeader(l,e,r,o),s.appendChild(l),n.appendChild(s)}this.instance.runHooks("afterGetColHeader",e,n,o)}updateCellHeader(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Pe(e,"colHeader")?i=s.wtTable.columnFilter.sourceToRendered(n):Pe(e,"rowHeader")&&(i=s.wtTable.rowFilter.sourceToRendered(n))),i>-1?Ol(e,r(n,o)):(Es(e,String.fromCharCode(160)),te(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){const r=Fs.get(this);[r.lastWidth,r.lastHeight]=[e,n]}getLastSize(){const e=Fs.get(this);return{width:e.lastWidth,height:e.lastHeight}}getFirstFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return WM(this,Hw)}getRowHeadersCount(){return WM(this,Pw)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}const Y8=j8,fk="ABCDEFGHIJKLMNOPQRSTUVWXYZ",ky=fk.length;function $m(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%ky,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/ky,10);return n}function G8(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=ky**r*(fk.indexOf(t[n])+1);return e-=1,e}function K8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,o;for(r=0;r<t;r++){const i=[];for(o=0;o<e;o++)i.push($m(o)+(r+1));n.push(i)}return n}function X8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,o;for(r=0;r<t;r++){const i={};for(o=0;o<e;o++)i[`prop${o}`]=$m(o)+(r+1);n.push(i)}return n}function q8(t,e){const n=[];let r;for(let o=0;o<t;o++){r=[];for(let i=0;i<e;i++)r.push("");n.push(r)}return n}function Dy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((o,i)=>{Array.isArray(o)?o.forEach((s,l)=>{r.push([i+e,l,s])}):Object.keys(o).forEach(s=>{r.push([i+e,s,o[s]])})}),r}function ER(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&$e(t[0])&&(e=km(t[0]))),e}function gk(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function mk(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const Q8=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:ER,createEmptySpreadsheetData:q8,createSpreadsheetData:K8,createSpreadsheetObjectData:X8,dataRowToChangesArray:Dy,isArrayOfArrays:gk,isArrayOfObjects:mk,spreadsheetColumnIndex:G8,spreadsheetColumnLabel:$m},Symbol.toStringTag,{value:"Module"}));class Z8{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.hot=e,this.data=n,this.dataType="array",this.colToProp=()=>{},this.propToCol=()=>{}}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return O(this.data,(r,o)=>{const i=this.getAtCell(o,e);n.push(i)}),n}getAtRow(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=n===void 0&&r===void 0;let s=null,l=null;if(s=this.modifyRowData(e),Array.isArray(s))l=[],i?s.forEach((a,u)=>{l[u]=this.getAtPhysicalCell(e,u,s)}):ye(n,r,a=>{l[a-n]=this.getAtPhysicalCell(e,a,s)});else if($e(s)||wt(s))if(o?l=[]:l={},!i||o){const u=this.countFirstRowKeys()-1;ye(0,u,c=>{const h=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(h)){const f=this.getAtPhysicalCell(e,h,s);o?l.push(f):Of(l,h,f)}})}else Ue(s,(a,u)=>{Of(l,u,this.getAtPhysicalCell(e,u,s))});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const o=Cl(r);this.hot.runHooks("modifySourceData",e,n,o,"set"),o.isTouched()&&(r=o.value)}Number.isInteger(n)?this.data[e][n]=r:Of(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let o=null;if(r&&(typeof n=="string"?o=mP(r,n):typeof n=="function"?o=n(r):o=r[n]),this.hot.hasHook("modifySourceData")){const i=Cl(o);this.hot.runHooks("modifySourceData",e,n,i,"get"),i.isTouched()&&(o=i.value)}return o}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,i=null,s=null,l=null,a=null;e===null||n===null?(o=!0,i=0,l=this.countRows()-1):(i=Math.min(e.row,n.row),s=Math.min(e.col,n.col),l=Math.max(e.row,n.row),a=Math.max(e.col,n.col));const u=[];return ye(i,l,c=>{u.push(o?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,a,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return ER(this.data)}destroy(){this.data=null,this.hot=null}}const J8=Z8;class Il{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.indexedValues=[],this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,wt(this.initValueOrFn)?ye(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):ye(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}gt(Il,cr);function TR(t,e,n,r){const o=n.length?n[0]:void 0;return[...t.slice(0,o),...n.map((i,s)=>wt(r)?r(i,s):r),...o===void 0?[]:t.slice(o)]}function MR(t,e){return Rr(t,(n,r)=>e.includes(r)===!1)}class As extends Il{insert(e,n){this.indexedValues=TR(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=MR(this.indexedValues,e),super.remove(e)}}class Vm extends As{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Gt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function xR(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function eh(t,e){return Rr(t,n=>e.includes(n)===!1)}function _R(t,e){return We(t,n=>n-e.filter(r=>r<n).length)}function OR(t,e){const n=e[0],r=e.length;return We(t,o=>o>=n?o+r:o)}function e5(t,e,n){return e=t5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t5(t){var e=n5(t,"string");return typeof e=="symbol"?e:String(e)}function n5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bm extends Il{constructor(){super(...arguments),e5(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=eh(this.orderOfIndexes,[e]),wt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=TR(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=OR(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=MR(this.indexedValues,e),this.orderOfIndexes=eh(this.orderOfIndexes,e),this.orderOfIndexes=_R(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Ah extends As{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Gt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const zM=new Map([["indexesSequence",{getListWithInsertedItems:xR,getListWithRemovedItems:eh}],["physicallyIndexed",{getListWithInsertedItems:TR,getListWithRemovedItems:MR}]]),pk=t=>{if(zM.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return zM.get(t)};class wk extends Il{constructor(){super(e=>e)}insert(e,n){const r=OR(this.indexedValues,n);this.indexedValues=xR(r,e,n),super.insert(e,n)}remove(e){const n=eh(this.indexedValues,e);this.indexedValues=_R(n,e),super.remove(e)}}const jM=new Map([["hiding",Vm],["index",Il],["linkedPhysicalIndexToValue",Bm],["physicalIndexToValue",As],["trimming",Ah]]);function r5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!jM.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(jM.get(t))(e)}let Ny=0;class IR{constructor(){this.collection=new Map}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),Ny+=1)}unregister(e){const n=this.collection.get(e);he(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),Ny-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return vt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}gt(IR,cr);function o5(){return Ny}class YM extends IR{constructor(e,n){super(),this.mergedValuesCache=[],this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=We(this.get(),i=>i.getValues()),r=[],o=he(n[0])&&n[0].length||0;for(let i=0;i<o;i+=1){const s=[];for(let l=0;l<this.getLength();l+=1)s.push(n[l][i]);r.push(s)}return We(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return he(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function i5(t,e,n){s5(t,e),e.set(t,n)}function s5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l5(t,e,n){var r=Ck(t,e,"set");return a5(t,r,n),n}function a5(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function u5(t,e){var n=Ck(t,e,"get");return c5(t,n)}function Ck(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function c5(t,e){return e.get?e.get.call(t):e.value}var kw=new WeakMap;class vk{constructor(){i5(this,kw,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(u5(this,kw)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){l5(this,kw,e)}}gt(vk,cr);function GM(t,e){const n=[];let r=0,o=0;for(;r<t.length&&o<e.length;r++,o++)t[r]!==e[o]&&n.push({op:"replace",index:o,oldValue:t[r],newValue:e[o]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;o<t.length;o++)n.push({op:"remove",index:o,oldValue:t[o],newValue:void 0});return n}function Eu(t,e,n){h5(t,e),e.set(t,n)}function h5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Or(t,e){var n=yk(t,e,"get");return d5(t,n)}function d5(t,e){return e.get?e.get.call(t):e.value}function yd(t,e,n){var r=yk(t,e,"set");return f5(t,r,n),n}function yk(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function f5(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Sd=new WeakMap,Tu=new WeakMap,Rd=new WeakMap,bd=new WeakMap,Ed=new WeakMap;class g5{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Eu(this,Sd,{writable:!0,value:new Set}),Eu(this,Tu,{writable:!0,value:[]}),Eu(this,Rd,{writable:!0,value:[]}),Eu(this,bd,{writable:!0,value:!1}),Eu(this,Ed,{writable:!0,value:!1}),yd(this,Ed,e??!1)}createObserver(){const e=new vk;return Or(this,Sd).add(e),e.addLocalHook("unsubscribe",()=>{Or(this,Sd).delete(e)}),e._writeInitialChanges(GM(Or(this,Tu),Or(this,Rd))),e}emit(e){let n=Or(this,Rd);(!Or(this,bd)||Or(this,Tu).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Or(this,Ed)):yd(this,Tu,new Array(e.length).fill(Or(this,Ed))),Or(this,bd)||(yd(this,bd,!0),n=Or(this,Tu)));const r=GM(n,e);Or(this,Sd).forEach(o=>o._write(r)),yd(this,Rd,e)}}class Ly{constructor(){this.indexesSequence=new wk,this.trimmingMapsCollection=new YM(e=>e.some(n=>n===!0),!1),this.hidingMapsCollection=new YM(e=>e.some(n=>n===!0),!1),this.variousMapsCollection=new IR,this.hidingChangesObservable=new g5({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,r5(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Ah?this.trimmingMapsCollection.register(e,n):n instanceof Vm?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return he(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return he(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return he(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return he(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const i=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=i.findIndex(l=>l>e):s=i.reverse().findIndex(l=>l<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:i[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(o=>o+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=We(e,u=>this.getPhysicalFromVisualIndex(u)),o=this.getNotTrimmedIndexesLength(),i=e.length,s=eh(this.getIndexesSequence(),r),l=s.filter(u=>this.isTrimmed(u)===!1);let a=s.indexOf(l[l.length-1])+1;if(n+i<o){const u=l[n];a=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(xR(s,a,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],o=he(r)?r:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=We(new Array(n).fill(o),(l,a)=>l+a);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,s),this.hidingMapsCollection.insertToEvery(i,s),this.variousMapsCollection.insertToEvery(i,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),o=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(o,n)}}}gt(Ly,cr);function m5(t,e){return Ue(e,(n,r)=>{vt(t[r])&&(t[r]=n)}),t}function Sk(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function Rk(t){he(t)&&Z0(ht`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function p5(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:w5,getValues:C5}=po("phraseFormatters");function v5(t,e){w5(t,e)}function y5(){return C5()}v5("pluralize",p5);const bk="ContextMenu:items",Le=bk,AR=`${Le}.noItems`,HR=`${Le}.insertRowAbove`,PR=`${Le}.insertRowBelow`,kR=`${Le}.insertColumnOnTheLeft`,DR=`${Le}.insertColumnOnTheRight`,NR=`${Le}.removeRow`,LR=`${Le}.removeColumn`,FR=`${Le}.undo`,$R=`${Le}.redo`,VR=`${Le}.readOnly`,BR=`${Le}.clearColumn`,WR=`${Le}.copy`,UR=`${Le}.copyWithHeaders`,zR=`${Le}.copyWithGroupHeaders`,jR=`${Le}.copyHeadersOnly`,YR=`${Le}.cut`,GR=`${Le}.freezeColumn`,KR=`${Le}.unfreezeColumn`,XR=`${Le}.mergeCells`,qR=`${Le}.unmergeCells`,QR=`${Le}.addComment`,ZR=`${Le}.editComment`,JR=`${Le}.removeComment`,eb=`${Le}.readOnlyComment`,tb=`${Le}.align`,nb=`${Le}.align.left`,rb=`${Le}.align.center`,ob=`${Le}.align.right`,ib=`${Le}.align.justify`,sb=`${Le}.align.top`,lb=`${Le}.align.middle`,ab=`${Le}.align.bottom`,ub=`${Le}.borders`,cb=`${Le}.borders.top`,hb=`${Le}.borders.right`,db=`${Le}.borders.bottom`,fb=`${Le}.borders.left`,gb=`${Le}.borders.remove`,mb=`${Le}.nestedHeaders.insertChildRow`,pb=`${Le}.nestedHeaders.detachFromParent`,wb=`${Le}.hideColumn`,Cb=`${Le}.showColumn`,vb=`${Le}.hideRow`,yb=`${Le}.showRow`,Zn="Filters:",Ut=`${Zn}conditions`,Wm=`${Ut}.none`,Sb=`${Ut}.isEmpty`,Rb=`${Ut}.isNotEmpty`,bb=`${Ut}.isEqualTo`,Eb=`${Ut}.isNotEqualTo`,Tb=`${Ut}.beginsWith`,Mb=`${Ut}.endsWith`,xb=`${Ut}.contains`,_b=`${Ut}.doesNotContain`,S5=`${Ut}.byValue`,Ob=`${Ut}.greaterThan`,Ib=`${Ut}.greaterThanOrEqualTo`,Ab=`${Ut}.lessThan`,Hb=`${Ut}.lessThanOrEqualTo`,Pb=`${Ut}.isBetween`,kb=`${Ut}.isNotBetween`,Db=`${Ut}.after`,Nb=`${Ut}.before`,Lb=`${Ut}.today`,Fb=`${Ut}.tomorrow`,$b=`${Ut}.yesterday`,Vb=`${Zn}labels.filterByCondition`,Bb=`${Zn}labels.filterByValue`,Wb=`${Zn}labels.conjunction`,Um=`${Zn}labels.disjunction`,Pg=`${Zn}values.blankCells`,Ub=`${Zn}buttons.selectAll`,zb=`${Zn}buttons.clear`,jb=`${Zn}buttons.ok`,Yb=`${Zn}buttons.cancel`,Gb=`${Zn}buttons.placeholder.search`,Kb=`${Zn}buttons.placeholder.value`,Xb=`${Zn}buttons.placeholder.secondValue`,R5=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:QR,CONTEXTMENU_ITEMS_ALIGNMENT:tb,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:ab,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:rb,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:ib,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:nb,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:lb,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:ob,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:sb,CONTEXTMENU_ITEMS_BORDERS:ub,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:db,CONTEXTMENU_ITEMS_BORDERS_LEFT:fb,CONTEXTMENU_ITEMS_BORDERS_RIGHT:hb,CONTEXTMENU_ITEMS_BORDERS_TOP:cb,CONTEXTMENU_ITEMS_CLEAR_COLUMN:BR,CONTEXTMENU_ITEMS_COPY:WR,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:jR,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:zR,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:UR,CONTEXTMENU_ITEMS_CUT:YR,CONTEXTMENU_ITEMS_EDIT_COMMENT:ZR,CONTEXTMENU_ITEMS_FREEZE_COLUMN:GR,CONTEXTMENU_ITEMS_HIDE_COLUMN:wb,CONTEXTMENU_ITEMS_HIDE_ROW:vb,CONTEXTMENU_ITEMS_INSERT_LEFT:kR,CONTEXTMENU_ITEMS_INSERT_RIGHT:DR,CONTEXTMENU_ITEMS_MERGE_CELLS:XR,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:pb,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:mb,CONTEXTMENU_ITEMS_NO_ITEMS:AR,CONTEXTMENU_ITEMS_READ_ONLY:VR,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:eb,CONTEXTMENU_ITEMS_REDO:$R,CONTEXTMENU_ITEMS_REMOVE_BORDERS:gb,CONTEXTMENU_ITEMS_REMOVE_COLUMN:LR,CONTEXTMENU_ITEMS_REMOVE_COMMENT:JR,CONTEXTMENU_ITEMS_REMOVE_ROW:NR,CONTEXTMENU_ITEMS_ROW_ABOVE:HR,CONTEXTMENU_ITEMS_ROW_BELOW:PR,CONTEXTMENU_ITEMS_SHOW_COLUMN:Cb,CONTEXTMENU_ITEMS_SHOW_ROW:yb,CONTEXTMENU_ITEMS_UNDO:FR,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:KR,CONTEXTMENU_ITEMS_UNMERGE_CELLS:qR,CONTEXT_MENU_ITEMS_NAMESPACE:bk,FILTERS_BUTTONS_CANCEL:Yb,FILTERS_BUTTONS_CLEAR:zb,FILTERS_BUTTONS_OK:jb,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Gb,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:Xb,FILTERS_BUTTONS_PLACEHOLDER_VALUE:Kb,FILTERS_BUTTONS_SELECT_ALL:Ub,FILTERS_CONDITIONS_AFTER:Db,FILTERS_CONDITIONS_BEFORE:Nb,FILTERS_CONDITIONS_BEGINS_WITH:Tb,FILTERS_CONDITIONS_BETWEEN:Pb,FILTERS_CONDITIONS_BY_VALUE:S5,FILTERS_CONDITIONS_CONTAINS:xb,FILTERS_CONDITIONS_EMPTY:Sb,FILTERS_CONDITIONS_ENDS_WITH:Mb,FILTERS_CONDITIONS_EQUAL:bb,FILTERS_CONDITIONS_GREATER_THAN:Ob,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Ib,FILTERS_CONDITIONS_LESS_THAN:Ab,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Hb,FILTERS_CONDITIONS_NAMESPACE:Ut,FILTERS_CONDITIONS_NONE:Wm,FILTERS_CONDITIONS_NOT_BETWEEN:kb,FILTERS_CONDITIONS_NOT_CONTAIN:_b,FILTERS_CONDITIONS_NOT_EMPTY:Rb,FILTERS_CONDITIONS_NOT_EQUAL:Eb,FILTERS_CONDITIONS_TODAY:Lb,FILTERS_CONDITIONS_TOMORROW:Fb,FILTERS_CONDITIONS_YESTERDAY:$b,FILTERS_DIVS_FILTER_BY_CONDITION:Vb,FILTERS_DIVS_FILTER_BY_VALUE:Bb,FILTERS_LABELS_CONJUNCTION:Wb,FILTERS_LABELS_DISJUNCTION:Um,FILTERS_NAMESPACE:Zn,FILTERS_VALUES_BLANK_CELLS:Pg},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const b5={languageCode:"en-US",[AR]:"No available options",[HR]:"Insert row above",[PR]:"Insert row below",[kR]:"Insert column left",[DR]:"Insert column right",[NR]:["Remove row","Remove rows"],[LR]:["Remove column","Remove columns"],[FR]:"Undo",[$R]:"Redo",[VR]:"Read only",[BR]:"Clear column",[tb]:"Alignment",[nb]:"Left",[rb]:"Center",[ob]:"Right",[ib]:"Justify",[sb]:"Top",[lb]:"Middle",[ab]:"Bottom",[GR]:"Freeze column",[KR]:"Unfreeze column",[ub]:"Borders",[cb]:"Top",[hb]:"Right",[db]:"Bottom",[fb]:"Left",[gb]:"Remove border(s)",[QR]:"Add comment",[ZR]:"Edit comment",[JR]:"Delete comment",[eb]:"Read-only comment",[XR]:"Merge cells",[qR]:"Unmerge cells",[WR]:"Copy",[UR]:["Copy with header","Copy with headers"],[zR]:["Copy with group header","Copy with group headers"],[jR]:["Copy header only","Copy headers only"],[YR]:"Cut",[mb]:"Insert child row",[pb]:"Detach from parent",[wb]:["Hide column","Hide columns"],[Cb]:["Show column","Show columns"],[vb]:["Hide row","Hide rows"],[yb]:["Show row","Show rows"],[Wm]:"None",[Sb]:"Is empty",[Rb]:"Is not empty",[bb]:"Is equal to",[Eb]:"Is not equal to",[Tb]:"Begins with",[Mb]:"Ends with",[xb]:"Contains",[_b]:"Does not contain",[Ob]:"Greater than",[Ib]:"Greater than or equal to",[Ab]:"Less than",[Hb]:"Less than or equal to",[Pb]:"Is between",[kb]:"Is not between",[Db]:"After",[Nb]:"Before",[Lb]:"Today",[Fb]:"Tomorrow",[$b]:"Yesterday",[Pg]:"Blank cells",[Vb]:"Filter by condition",[Bb]:"Filter by value",[Wb]:"And",[Um]:"Or",[Ub]:"Select all",[zb]:"Clear",[jb]:"OK",[Yb]:"Cancel",[Gb]:"Search",[Kb]:"Value",[Xb]:"Second value"},Ek=b5,E5=R5,Fy=Ek.languageCode,{register:T5,getItem:Tk,hasItem:M5,getValues:x5}=po("languagesDictionaries");Mk(Ek);function Mk(t,e){let n=t,r=e;return $e(t)&&(r=t,n=r.languageCode),_5(n,r),T5(n,kn(r)),kn(r)}function _5(t,e){t!==Fy&&m5(e,Tk(Fy))}function xk(t){return qb(t)?kn(Tk(t)):null}function qb(t){return M5(t)}function O5(){return x5()}function _k(t,e,n){const r=xk(t);if(r===null)return null;const o=r[e];if(vt(o))return null;const i=I5(o,n);return Array.isArray(i)?i[0]:i}function I5(t,e){let n=t;return O(y5(),r=>{n=r(t,e)}),n}function A5(t){let e=Sk(t);return qb(e)||(e=Fy,Rk(t)),e}function H5(t,e,n){return e=P5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P5(t){var e=k5(t,"string");return typeof e=="symbol"?e:String(e)}function k5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D5 extends QK{constructor(e,n){super(e,null),H5(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,o=this.getNearestNotHiddenCoords(n,1),i=this.getNearestNotHiddenCoords(r,-1);return o===null||i===null?null:((o.row>i.row||o.col>i.col)&&(o=n,i=r),this.settings.createCellRange(o,o,i))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const o=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(o===null)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return i===null?null:this.settings.createCellCoords(o,i)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,o=e.getHorizontalDirection()==="W-E"?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((i===null||i.col===null||i.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,o)),s!==null&&e.overlaps(s)){const l=e.highlight.clone();if(l.row>=0&&(l.row=s.row),l.col>=0&&(l.col=s.col),this.cellRange===null){const a=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(a)}e.setHighlight(l)}return this.settings.selectionType==="focus"&&i!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),o=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||o.row===null||o.col===null?null:this.settings.createCellRange(r,r,o)}}const Pi=D5;function Dw(t){let{activeHeaderClassName:e,...n}=t;return new Pi({className:e,...n,selectionType:ok})}function N5(t){let{areaCornerVisible:e,...n}=t;return new Pi({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:pR})}function L5(t){let{...e}=t;return new Pi({className:"highlight",...e,selectionType:pR})}function F5(t){let{columnClassName:e,...n}=t;return new Pi({className:e,...n,selectionType:e8})}function $5(t){let{cellCornerVisible:e,...n}=t;return new Pi({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:wR})}function V5(t){let{border:e,visualCellRange:n,...r}=t;return new Pi({...e,...r,selectionType:t8},n)}function B5(t){let{...e}=t;return new Pi({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:ZK})}function KM(t){let{headerClassName:e,...n}=t;return new Pi({className:e,...n,selectionType:mR})}function W5(t){let{rowClassName:e,...n}=t;return new Pi({className:e,...n,selectionType:JK})}let Ok;function U5(t,e){z5(t,e),e.add(t)}function z5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function er(t,e,n){return e=j5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j5(t){var e=Y5(t,"string");return typeof e=="symbol"?e:String(e)}function Y5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var So=new WeakSet;Ok=Symbol.iterator;class G5{constructor(e){U5(this,So),er(this,"options",void 0),er(this,"layerLevel",0),er(this,"focus",void 0),er(this,"fill",void 0),er(this,"layeredAreas",new Map),er(this,"areas",new Map),er(this,"rowHeaders",new Map),er(this,"columnHeaders",new Map),er(this,"activeRowHeaders",new Map),er(this,"activeColumnHeaders",new Map),er(this,"activeCornerHeaders",new Map),er(this,"rowHighlights",new Map),er(this,"columnHighlights",new Map),er(this,"customSelections",[]),this.options=e,this.focus=$5(e),this.fill=B5(e)}isEnabledFor(e,n){let r=e;e===wR&&(r="current");let o=!1;return n.isCell()&&(o=this.options.disabledCellSelection(n.row,n.col)),typeof o=="string"&&(o=[o]),o===!1||Array.isArray(o)&&!o.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return qo(this,So,Qo).call(this,this.layeredAreas,N5)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return qo(this,So,Qo).call(this,this.areas,L5)}getAreas(){return[...this.areas.values()]}createRowHeader(){return qo(this,So,Qo).call(this,this.rowHeaders,KM)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return qo(this,So,Qo).call(this,this.columnHeaders,KM)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return qo(this,So,Qo).call(this,this.activeRowHeaders,Dw)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return qo(this,So,Qo).call(this,this.activeColumnHeaders,Dw)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return qo(this,So,Qo).call(this,this.activeCornerHeaders,Dw)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return qo(this,So,Qo).call(this,this.rowHighlights,W5)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return qo(this,So,Qo).call(this,this.columnHighlights,F5)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(V5({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),O(this.areas.values(),e=>void e.clear()),O(this.layeredAreas.values(),e=>void e.clear()),O(this.rowHeaders.values(),e=>void e.clear()),O(this.columnHeaders.values(),e=>void e.clear()),O(this.activeRowHeaders.values(),e=>void e.clear()),O(this.activeColumnHeaders.values(),e=>void e.clear()),O(this.activeCornerHeaders.values(),e=>void e.clear()),O(this.rowHighlights.values(),e=>void e.clear()),O(this.columnHighlights.values(),e=>void e.clear())}[Ok](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Qo(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const K5=G5;class X5{constructor(e){this.ranges=[],this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const q5=X5;function Mu(t,e){Ik(t,e),e.add(t)}function Nw(t,e,n){Ik(t,e),e.set(t,n)}function Ik(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nt(t,e){var n=Ak(t,e,"get");return Q5(t,n)}function Q5(t,e){return e.get?e.get.call(t):e.value}function xo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function $y(t,e,n){var r=Ak(t,e,"set");return Z5(t,r,n),n}function Ak(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Z5(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Td=new WeakMap,pt=new WeakMap,Ms=new WeakMap,Lw=new WeakSet,Fw=new WeakSet,Vy=new WeakSet,$w=new WeakSet,Vw=new WeakSet;class Hk{constructor(e,n){Mu(this,Vw),Mu(this,$w),Mu(this,Vy),Mu(this,Fw),Mu(this,Lw),Nw(this,Td,{writable:!0,value:void 0}),Nw(this,pt,{writable:!0,value:void 0}),Nw(this,Ms,{writable:!0,value:{x:0,y:0}}),$y(this,Td,e),$y(this,pt,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;xo(this,Lw,XM).call(this,{x:nt(this,pt).navigableHeaders()?nt(this,pt).countRowHeaders():0,y:nt(this,pt).navigableHeaders()?nt(this,pt).countColHeaders():0});const o=nt(this,pt).createCellCoords(e,n);let i=nt(this,Td).current().highlight;const s=nt(this,pt).visualToRenderableCoords(i);let l=0,a=0;if(this.runLocalHooks("beforeTransformStart",o),s.row!==null&&s.col!==null){const{width:u,height:c}=xo(this,Vy,Pk).call(this),{x:h,y:f}=xo(this,$w,QM).call(this,i),g=nt(this,pt).fixedRowsBottom(),p=nt(this,pt).minSpareRows(),y=nt(this,pt).minSpareCols(),E=nt(this,pt).autoWrapRow(),w=nt(this,pt).autoWrapCol(),C={row:f+o.row,col:h+o.col};if(C.row>=c){if(r&&p>0&&g===0)this.runLocalHooks("insertRowRequire",nt(this,pt).countRenderableRows());else if(w){const A=C.col+1;C.row=C.row-c,C.col=A>=u?A-u:A}}else if(C.row<0&&w){const A=C.col-1;C.row=c+C.row,C.col=A<0?u+A:A}if(C.col>=u){if(r&&y>0)this.runLocalHooks("insertColRequire",nt(this,pt).countRenderableColumns());else if(E){const A=C.row+1;C.row=A>=c?A-c:A,C.col=C.col-u}}else if(C.col<0&&E){const A=C.row-1;C.row=A<0?c+A:A,C.col=u+C.col}const S=nt(this,pt).createCellCoords(C.row,C.col),{rowDir:T,colDir:x}=xo(this,Fw,qM).call(this,S);l=T,a=x,i=xo(this,Vw,ZM).call(this,S)}return this.runLocalHooks("afterTransformStart",i,l,a),i}transformEnd(e,n){xo(this,Lw,XM).call(this,{x:nt(this,pt).navigableHeaders()?nt(this,pt).countRowHeaders():0,y:nt(this,pt).navigableHeaders()?nt(this,pt).countColHeaders():0});const r=nt(this,pt).createCellCoords(e,n),o=nt(this,Td).current(),i=nt(this,pt).visualToRenderableCoords(o.highlight),s=o.to.clone();let l=0,a=0;if(this.runLocalHooks("beforeTransformEnd",r),i.row!==null&&i.col!==null){const{x:u,y:c}=xo(this,$w,QM).call(this,o.to),h={row:c+r.row,col:u+r.col},f=nt(this,pt).createCellCoords(h.row,h.col),{rowDir:g,colDir:p}=xo(this,Fw,qM).call(this,f);l=g,a=p;const y=xo(this,Vw,ZM).call(this,f);r.row===0&&r.col!==0?s.col=y.col:r.row!==0&&r.col===0?s.row=y.row:(s.row=y.row,s.col=y.col)}return this.runLocalHooks("afterTransformEnd",s,l,a),s}}function XM(t){let{x:e,y:n}=t;$y(this,Ms,{x:e,y:n})}function qM(t){const{width:e,height:n}=xo(this,Vy,Pk).call(this);let r=0,o=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(o=-1,t.col=0):t.col>0&&t.col>=e&&(o=1,t.col=e-1),{rowDir:r,colDir:o}}function Pk(){return{width:nt(this,Ms).x+nt(this,pt).countRenderableColumns(),height:nt(this,Ms).y+nt(this,pt).countRenderableRows()}}function QM(t){const{row:e,col:n}=nt(this,pt).visualToRenderableCoords(t);return{x:nt(this,Ms).x+n,y:nt(this,Ms).y+e}}function ZM(t){return t.col=t.col-nt(this,Ms).x,t.row=t.row-nt(this,Ms).y,nt(this,pt).renderableToVisualCoords(t)}gt(Hk,cr);const J5=Hk,zm=0,jm=1,kk=2,Qb=3,e9=[Qb,kk],t9=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Bw=Symbol("root"),JM=Symbol("child");function Ya(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bw;if(e!==Bw&&e!==JM)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===Bw;let o=zm;if(n){const i=t[0];t.length===0?o=jm:r&&i instanceof ja?o=Qb:r&&Array.isArray(i)?o=Ya(i,JM):t.length>=2&&t.length<=4&&!t.some((l,a)=>!t9[a].includes(typeof l))&&(o=kk)}return o}function th(t){let{keepDirection:e=!1,propToCol:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!e9.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(r){const o=t===Qb;let i=o?r.from.row:r[0],s=o?r.from.col:r[1],l=o?r.to.row:r[2],a=o?r.to.col:r[3];if(typeof n=="function"&&(typeof s=="string"&&(s=n(s)),typeof a=="string"&&(a=n(a))),vt(l)&&(l=i),vt(a)&&(a=s),!e){const h=i,f=s,g=l,p=a;i=Math.min(h,g),s=Math.min(f,p),l=Math.max(h,g),a=Math.max(f,p)}const u=new No(i,s),c=new No(l,a);return new ja(u,u,c)}}function n9(t){const e=Ya(t);if(e===zm||e===jm)return[];const n=th(e),r=new Set;O(t,s=>{const{from:l,to:a}=n(s),u=Math.max(l.col,0),c=a.col-u+1;O(Array.from(new Array(c),(h,f)=>u+f),h=>{r.has(h)||r.add(h)})});const o=Array.from(r).sort((s,l)=>s-l);return Gt(o,(s,l,a,u)=>(a!==0&&l===u[a-1]+1?s[s.length-1][1]+=1:s.push([l,1]),s),[])}function r9(t){const e=Ya(t);if(e===zm||e===jm)return[];const n=th(e),r=new Set;O(t,s=>{const{from:l,to:a}=n(s),u=Math.max(l.row,0),c=a.row-u+1;O(Array.from(new Array(c),(h,f)=>u+f),h=>{r.has(h)||r.add(h)})});const o=Array.from(r).sort((s,l)=>s-l);return Gt(o,(s,l,a,u)=>(a!==0&&l===u[a-1]+1?s[s.length-1][1]+=1:s.push([l,1]),s),[])}function o9(t,e,n){i9(t,e),e.set(t,n)}function i9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Li(t,e,n){return e=s9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s9(t){var e=l9(t,"string");return typeof e=="symbol"?e:String(e)}function l9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ex(t,e,n){var r=Dk(t,e,"set");return a9(t,r,n),n}function a9(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function tx(t,e){var n=Dk(t,e,"get");return u9(t,n)}function Dk(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function u9(t,e){return e.get?e.get.call(t):e.value}var xu=new WeakMap;class Nk{constructor(e,n){var r=this;Li(this,"settings",void 0),Li(this,"tableProps",void 0),Li(this,"inProgress",!1),Li(this,"selectedRange",new q5((o,i,s)=>this.tableProps.createCellRange(o,i,s))),Li(this,"highlight",void 0),Li(this,"transformation",void 0),Li(this,"selectedByRowHeader",new Set),Li(this,"selectedByColumnHeader",new Set),o9(this,xu,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new K5({headerClassName:e.currentHeaderClassName,headerAttributes:[vy()],activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[vy()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(o,i)=>this.tableProps.isDisabledCellSelection(o,i),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:o=>this.tableProps.visualToRenderableCoords(o),renderableToVisualCoords:o=>this.tableProps.renderableToVisualCoords(o),createCellCoords:(o,i)=>this.tableProps.createCellCoords(o,i),createCellRange:(o,i,s)=>this.tableProps.createCellRange(o,i,s)}),this.transformation=new J5(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:o=>this.tableProps.visualToRenderableCoords(o),renderableToVisualCoords:o=>this.tableProps.renderableToVisualCoords(o),createCellCoords:(o,i)=>this.tableProps.createCellCoords(o,i),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...i)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...i)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...i)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...i)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...i)}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return r.runLocalHooks("insertColRequire",...i)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const i=this.settings.selectionMode==="multiple",s=vt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,l=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,l),(!i||i&&!s&&vt(n))&&this.selectedRange.clear(),this.selectedRange.add(l).current().setHighlight(o.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),o=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||o>0)&&(r===0&&n.col<0&&!i||o===0&&n.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const l=this.highlight.getFocus();l.clear(),this.highlight.isEnabledFor(wR,s.highlight)&&l.add(this.selectedRange.current().highlight).commit().syncWith(s);const a=this.getLayerLevel();a<this.highlight.layerLevel&&(O(this.highlight.getAreas(),C=>void C.clear()),O(this.highlight.getLayeredAreas(),C=>void C.clear()),O(this.highlight.getRowHeaders(),C=>void C.clear()),O(this.highlight.getColumnHeaders(),C=>void C.clear()),O(this.highlight.getActiveRowHeaders(),C=>void C.clear()),O(this.highlight.getActiveColumnHeaders(),C=>void C.clear()),O(this.highlight.getActiveCornerHeaders(),C=>void C.clear()),O(this.highlight.getRowHighlights(),C=>void C.clear()),O(this.highlight.getColumnHighlights(),C=>void C.clear())),this.highlight.useLayerLevel(a);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),h=this.highlight.createRowHeader(),f=this.highlight.createColumnHeader(),g=this.highlight.createActiveRowHeader(),p=this.highlight.createActiveColumnHeader(),y=this.highlight.createActiveCornerHeader(),E=this.highlight.createRowHighlight(),w=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),h.clear(),f.clear(),g.clear(),p.clear(),y.clear(),E.clear(),w.clear(),this.highlight.isEnabledFor(pR,s.highlight)&&(this.isMultiple()||a>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),a===1)){const C=this.selectedRange.previous();this.highlight.useLayerLevel(a-1),this.highlight.createArea().add(C.from).commit().syncWith(C),this.highlight.createLayeredArea().add(C.from).commit().syncWith(C),this.highlight.useLayerLevel(a)}if(this.highlight.isEnabledFor(mR,s.highlight)){if(!s.isSingleHeader()){const T=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),x=this.tableProps.createCellCoords(s.to.row,-1),A=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),D=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(h.add(T).commit(),f.add(A).commit(),E.add(T).commit(),w.add(A).commit()):(h.add(T).add(x).commit(),f.add(A).add(D).commit(),E.add(T).add(x).commit(),w.add(A).add(D).commit())}const C=!tx(this,xu)&&this.isEntireRowSelected()&&(o>0&&o===s.getWidth()||o===0&&this.isSelectedByRowHeader()),S=!tx(this,xu)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());C&&g.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),S&&p.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),C&&S&&y.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=Cl(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=o=>{const{col:i}=o.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),l=this.tableProps.countCols();return(s>0&&i<0||s===0)&&o.getWidth()===l};if(e===-1)return Array.from(this.selectedRange).some(o=>n(o));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=o=>{const{row:i}=o.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),l=this.tableProps.countRows();return(s>0&&i<0||s===0)&&o.getHeight()===l};if(e===-1)return Array.from(this.selectedRange).some(o=>n(o));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),s=this.tableProps.countCols(),l=this.tableProps.countRowHeaders(),a=this.tableProps.countColHeaders(),u=n?-a:0,c=r?-l:0;if(u===0&&c===0&&(i===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:g}=o;ex(this,xu,g),f&&Number.isInteger(f==null?void 0:f.row)&&Number.isInteger(f==null?void 0:f.col)&&(h=this.tableProps.createCellCoords(wr(f.row,u,i-1),wr(f.col,c,s-1)));const p=this.tableProps.createCellCoords(u,c),y=this.tableProps.createCellCoords(i-1,s-1);this.clear(),this.setRangeStartOnly(p,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.finish(),ex(this,xu,!1)}selectCells(e){const n=Ya(e);if(n===jm)return!1;if(n===zm)throw new Error(ht`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=th(n,{propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,i={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},s=!e.some(l=>{const a=r(l),u=a.isValid(i);return!(u&&!a.containsHeaders()||u&&a.containsHeaders()&&a.isSingleHeader())});return s&&(this.clear(),O(e,l=>{const{from:a,to:u}=r(l);this.setRangeStartOnly(a.clone(),!1),this.setRangeEnd(u.clone()),this.finish()})),s}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const o=typeof e=="string"?this.tableProps.propToCol(e):e,i=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),l=this.tableProps.countCols(),a=this.tableProps.countColHeaders(),u=a===0?0:-a,c=new No(u,o),h=new No(s-1,i),f=new ja(c,c,h).isValid({countRows:s,countCols:l,countRowHeaders:0,countColHeaders:a});if(f){const g=a===0?0:wr(r,u,-1),p=s-1,y=this.tableProps.createCellCoords(g,o),E=this.tableProps.createCellCoords(p,i),w=this.tableProps.createCellCoords(wr(r,u,s-1),o);this.runLocalHooks("beforeSelectColumns",y,E,w),y.row=g,E.row=p,this.setRangeStartOnly(y,void 0,w),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectColumns",y,E,w),this.finish()}return f}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const o=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),l=s===0?0:-s,a=new No(e,l),u=new No(n,i-1),c=new ja(a,a,u).isValid({countRows:o,countCols:i,countRowHeaders:s,countColHeaders:0});if(c){const h=s===0?0:wr(r,l,-1),f=i-1,g=this.tableProps.createCellCoords(e,h),p=this.tableProps.createCellCoords(n,f),y=this.tableProps.createCellCoords(e,wr(r,l,i-1));this.runLocalHooks("beforeSelectRows",g,p,y),g.col=h,p.col=f,this.setRangeStartOnly(g,void 0,y),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.runLocalHooks("afterSelectRows",g,p,y),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(o=>{o.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);const i=this.highlight.createArea(),s=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),a=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();i.commit(),s.commit(),l.commit(),a.commit(),u.commit(),c.commit(),h.commit(),f.commit(),g.commit()}this.highlight.useLayerLevel(r)}}gt(Nk,cr);const c9=Nk,nx=/^(\r\n|\n\r|\r|\n)/,h9=/^[^\t\r\n]+/,rx=/^\t/;function d9(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,o;for(;t.length>0&&o!==t.length;)if(o=t.length,t.match(rx))t=t.replace(rx,""),n+=1,e[r][n]="";else if(t.match(nx))t=t.replace(nx,""),n=0,r+=1,e[r]=[""];else{let i="";if(t.startsWith('"')){let s=0,l=!0;for(;l;){const a=t.slice(0,1);a==='"'&&(s+=1),i+=a,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,a=>new Array(Math.floor(a.length/2)).fill('"').join(""))}else{const s=t.match(h9);i=s?s[0]:"",t=t.slice(i.length)}e[r][n]=i}return e}function yc(t){let e,n,r,o,i="",s;for(e=0,n=t.length;e<n;e+=1){for(o=t[e].length,r=0;r<o;r+=1)r>0&&(i+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?i+=`"${s.replace(/"/g,'""')}"`:i+=s:s==null?i+="":i+=s;e!==n-1&&(i+=`
`)}return i}class Ra{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){this.instance=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let o=0,i=0,s=!1;if(typeof n=="function"){const l=km(e);o=l>0?l:this.countFirstRowKeys(),s=!0}else{const l=this.tableMeta.maxCols;o=Math.min(l,n.length)}for(r=0;r<o;r++){const l=s?n(r):n[r];if($e(l)){if(typeof l.data<"u"){const a=s?i:r;this.colToPropCache[a]=l.data,this.propToColCache.set(l.data,a)}i+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return ER(this.dataSource)}recursiveDuckColumns(e,n,r){let o=n,i=r,s;return typeof o>"u"&&(o=0,i=""),typeof e=="object"&&!Array.isArray(e)&&Ue(e,(l,a)=>{l===null?(s=i+a,this.colToPropCache.push(s),this.propToColCache.set(s,o),o+=1):o=this.recursiveDuckColumns(l,o,`${a}.`)}),o}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.instance.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&he(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(he(n))return this.instance.toVisualColumn(n);const r=this.instance.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Ua(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:o="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=this.instance.countSourceRows();let s=i,l=0,a=e;if((typeof a!="number"||a>=i)&&(a=i),a<this.instance.countRows()&&(s=this.instance.toPhysicalRow(a)),this.instance.runHooks("beforeCreateRow",a,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,f=[];for(;l<n&&i+l<c;){let p=null;this.instance.dataType==="array"?this.tableMeta.dataSchema?p=kn(this.getSchema()):(p=[],ye(h-1,()=>p.push(null))):this.instance.dataType==="function"?p=this.tableMeta.dataSchema(a+l):(p={},xh(p,this.getSchema())),f.push(p),l+=1}this.instance.rowIndexMapper.insertIndexes(a,l),o==="below"&&(s=Math.min(s+1,i)),this.spliceData(s,0,f);const g=this.instance.toVisualRow(s);return this.instance.countSourceRows()===f.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),l>0&&(e==null?this.metaManager.createRow(null,l):r!=="auto"&&this.metaManager.createRow(s,n)),this.instance.runHooks("afterCreateRow",g,l,r),this.instance.forceFullRender=!0,{delta:l,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:o="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,s=this.tableMeta.maxCols,l=this.instance.countSourceCols();let a=e;if((typeof a!="number"||a>=l)&&(a=l),this.instance.runHooks("beforeCreateCol",a,n,r)===!1)return{delta:0};let c=l;a<this.instance.countCols()&&(c=this.instance.toPhysicalColumn(a));const h=this.instance.countSourceRows();let f=this.instance.countCols(),g=0,p=c;o==="end"&&(p=Math.min(p+1,l));const y=p;for(;g<n&&f<s;){if(typeof a!="number"||a>=f)if(h>0)for(let w=0;w<h;w+=1)typeof i[w]>"u"&&(i[w]=[]),i[w].push(null);else i.push([null]);else for(let w=0;w<h;w++)i[w].splice(p,0,null);g+=1,p+=1,f+=1}this.instance.columnIndexMapper.insertIndexes(a,g),g>0&&(e==null?this.metaManager.createColumn(null,g):r!=="auto"&&this.metaManager.createColumn(y,n));const E=this.instance.toVisualColumn(y);return this.instance.runHooks("afterCreateCol",E,g,r),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:y}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(e)?e:-n;const i=this.visualRowsToPhysical(o,n),s=this.instance.countSourceRows();if(o=(s+o)%s,this.instance.runHooks("beforeRemoveRow",o,i.length,i,r)===!1)return!1;const a=i.length;if(this.filterData(o,a,i),o<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(i);const c=he(this.tableMeta.columns)||he(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}return i.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.instance.runHooks("afterRemoveRow",o,a,i,r),this.instance.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let o=typeof e!="number"?-n:e;o=(this.instance.countCols()+o)%this.instance.countCols();const i=this.visualColumnsToPhysical(o,n),s=i.slice(0).sort((h,f)=>f-h);if(this.instance.runHooks("beforeRemoveCol",o,n,i,r)===!1)return!1;let a=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)a&&i[0]!==i[h]-h&&(a=!1);if(a)for(let h=0,f=this.instance.countSourceRows();h<f;h++)c[h].splice(i[0],n),h===0&&this.metaManager.removeColumn(i[0],n);else for(let h=0,f=this.instance.countSourceRows();h<f;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(i),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,n,i,r),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const o=this.instance.getDataAtCol(e),i=o.slice(n,n+r),s=o.slice(n+r);for(var l=arguments.length,a=new Array(l>3?l-3:0),u=3;u<l;u++)a[u-3]=arguments[u];gy(a,s);let c=0;for(;c<r;)a.push(null),c+=1;return WH(a),this.instance.populateFromArray(n,e,a,null,null,"spliceCol"),i}spliceRow(e,n,r){const o=this.instance.getSourceDataAtRow(e),i=o.slice(n,n+r),s=o.slice(n+r);for(var l=arguments.length,a=new Array(l>3?l-3:0),u=3;u<l;u++)a[u-3]=arguments[u];gy(a,s);let c=0;for(;c<r;)a.push(null),c+=1;return this.instance.populateFromArray(e,n,[a],null,null,"spliceRow"),i}spliceData(e,n,r){if(this.instance.runHooks("beforeDataSplice",e,n,r)!==!1){const i=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,i.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let o=this.instance.runHooks("filterData",e,n,r);Array.isArray(o)===!1&&(o=this.dataSource.filter((i,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}get(e,n){const r=this.instance.toPhysicalRow(e);let o=this.dataSource[r];const i=this.instance.runHooks("modifyRowData",r);o=isNaN(i)?i:o;let s=null;if(o&&o.hasOwnProperty&&Pt(o,n))s=o[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let a=o;if(!a)return null;for(let u=0,c=l.length;u<c;u++)if(a=a[l[u]],typeof a>"u")return null;s=a}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.instance.hasHook("modifyData")){const l=Cl(s);this.instance.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(s=l.value)}return s}getCopyable(e,n){return this.instance.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const o=this.instance.toPhysicalRow(e);let i=r,s=this.dataSource[o];const l=this.instance.runHooks("modifyRowData",o);if(s=isNaN(l)?l:s,this.instance.hasHook("modifyData")){const a=Cl(i);this.instance.runHooks("modifyData",o,this.propToCol(n),a,"set"),a.isTouched()&&(i=a.value)}if(s&&s.hasOwnProperty&&Pt(s,n))s[n]=i;else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let u=s,c=0,h;for(c=0,h=a.length-1;c<h;c++)typeof u[a[c]]>"u"&&(u[a[c]]={}),u=u[a[c]];u[a[c]]=i}else typeof n=="function"?n(this.dataSource.slice(o,o+1)[0],i):s[n]=i}visualRowsToPhysical(e,n){const r=this.instance.countSourceRows(),o=[];let i=(r+e)%r,s=n,l;for(;i<r&&s;)l=this.instance.toPhysicalRow(i),o.push(l),s-=1,i+=1;return o}visualColumnsToPhysical(e,n){const r=this.instance.countCols(),o=[];let i=(r+e)%r,s=n;for(;i<r&&s;){const l=this.instance.toPhysicalColumn(i);o.push(l),s-=1,i+=1}return o}clear(){for(let e=0;e<this.instance.countSourceRows();e++)for(let n=0;n<this.instance.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(e,n,Ra.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const o=[];let i,s,l;const a=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(a===0||u===0)return[];const c=r===Ra.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(a-1,0),Math.max(e.row,n.row)),f=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(i=Math.min(e.row,n.row);i<=h;i++){l=[];const g=i>=0?this.instance.toPhysicalRow(i):i;for(s=Math.min(e.col,n.col);s<=f&&g!==null;s++)l.push(c.call(this,i,this.colToProp(s)));g!==null&&o.push(l)}return o}getText(e,n){return yc(this.getRange(e,n,Ra.DESTINATION_RENDERER))}getCopyableText(e,n){return yc(this.getRange(e,n,Ra.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const f9=Ra,{register:g9,getItem:m9,hasItem:Lk,getNames:p9,getValues:zoe}=po("cellTypes");function Zb(t){if(!Lk(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return m9(t)}function Ar(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:o}=e;n&&or(t,n),r&&Io(t,r),o&&Sa(t,o),g9(t,e)}function w9(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Pt(e,t)}function Ym(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?Zb(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ue(e,(i,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!$e(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const o={};Ue(r,(i,s)=>{if(w9(s,n)){var l;o[s]=i,(l=t._automaticallyAssignedMetaProps)===null||l===void 0||l.add(s)}}),Zt(t,o)}function C9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Ai(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function kf(t){return Number.isInteger(t)&&t>=0}function Df(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Md(t){return t==null}const Fk=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),rn(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,o;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),rn(r)===!1)return typeof r=="object"?(o=this.getCellMeta(t,e),Pm(this.getSchema()[o.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,disableTabNavigation:!1,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function v9(){return class{}}class y9{constructor(e){this.metaCtor=v9(),this.meta=this.metaCtor.prototype,Zt(this.meta,Fk()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;Zt(this.meta,e),Ym(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}class S9{constructor(e){const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){Zt(this.meta,e),Ym(this.meta,e,e)}}class By{constructor(e){this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}obtain(e){Df(()=>kf(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const o=this.holes.values().next().value;this.holes.delete(o),this.data[o]=r,this.index[e]=o}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Df(()=>kf(e)||Md(e),"Expecting an unsigned number or null/undefined argument.");const r=[],o=this.data.length;for(let s=0;s<n;s++)r.push(o+s),this.data.push(void 0);const i=Md(e)?this.index.length:e;this.index=[...this.index.slice(0,i),...r,...this.index.slice(i)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Df(()=>kf(e)||Md(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Md(e)?this.index.length-n:e,n);for(let o=0;o<r.length;o++){const i=r[o];typeof i=="number"&&this.holes.add(i)}}size(){return this.data.length-this.holes.size}values(){return Rr(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const o=this._getKeyByStorageIndex(r);o!==-1&&e.push([o,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}const R9=["data","width"];class b9{constructor(e){this.globalMeta=e,this.metas=new By(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);Zt(r,n),Ym(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return C9(this.globalMeta.getMetaConstructor(),R9).prototype}}class E9{constructor(e){this.columnMeta=e,this.metas=new By(()=>this._createRow())}updateMeta(e,n,r){const o=this.getMeta(e,n);Zt(o,r),Ym(o,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const o=this.metas.obtain(e).obtain(n);return r===void 0?o:o[r]}setMeta(e,n,r,o){var i;const s=this.metas.obtain(e).obtain(n);(i=s._automaticallyAssignedMetaProps)===null||i===void 0||i.delete(r),s[r]=o}removeMeta(e,n,r){const o=this.metas.obtain(e).obtain(n);delete o[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)e.push(...n[r].values());return e}getMetasAtRow(e){Df(()=>kf(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new By(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class $k{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new y9(e),this.tableMeta=new S9(this.globalMeta),this.columnMeta=new b9(this.globalMeta),this.cellMeta=new E9(this.columnMeta),r.forEach(o=>new o(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:o,visualColumn:i}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=o,s.visualCol=i,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,o){this.cellMeta.setMeta(e,n,r,o)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}gt($k,cr);function ox(t,e,n,r){const{hotInstance:o,dataMap:i,dataSource:s,internalSource:l,source:a,metaManager:u,firstRun:c}=r,h=Hn(l),f=o.getSettings();Array.isArray(f.dataSchema)?o.dataType="array":wt(f.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),t=o.runHooks(`before${h}`,t,c,a);const g=new f9(o,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const p=g.getSchema();t=[];let y,E=0,w=0;for(E=0,w=f.startRows;E<w;E++)if((o.dataType==="object"||o.dataType==="function")&&f.dataSchema)y=kn(p),t.push(y);else if(o.dataType==="array")y=kn(p[0]),t.push(y);else{y=[];for(let C=0,S=f.startCols;C<S;C++)y.push(null);t.push(y)}}else throw new Error(`${l} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(o.dataType="array"),f.data=t,g.dataSource=t,s.data=t,s.dataType=o.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),n(g),o.runHooks(`after${h}`,t,c,a),c||(o.runHooks("afterChange",null,l),o.render()),o.getSettings().ariaTags&&He(o.rootElement,[KH(o.countRows()),XH(o.countCols())])}class T9{constructor(e){this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),me.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:o}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(o))return;const{visualRow:i,visualCol:s}=e,l=this.metaManager.hot,a=l.colToProp(s);e.prop=a,l.runHooks("beforeGetCellMeta",i,s,e);const u=Pt(e,"type")?e.type:null;let c=wt(e.cells)?e.cells(r,o,a):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,o,c),l.runHooks("afterGetCellMeta",i,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(o)}}class M9{constructor(e){this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["ariaTags",{onChange(n,r,o){if(!o)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,o){if(!o)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]]),this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:o=()=>{}}=e,i=typeof r=="string",s=i?r:n,l=`_${s}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,l,o),i&&this.installPropWatcher(r,l,o)})}installPropWatcher(e,n,r){const o=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(i){const s=!o.usageTracker.has(e);o.usageTracker.add(e),r.call(o,e,i,s),this[n]=i},enumerable:!0,configurable:!0})}}const Vk="gridDefault",Jb="editorManager.handlingEditor",x9={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(t.getShortcutManager().isCtrlPressed()),r.moveSelectionAfterEnter(n.includes("shift"))}},_9={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},O9={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},I9={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:o}=t.getSelectedRangeLast();o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),br(e))}};function A9(){return[x9,_9,O9,I9]}const H9={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},P9={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const o=t._createCellCoords(r,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(o.row-i,t.countRows()-1);t.selection.setRangeEnd(o),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},k9={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},D9={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},N9={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},L9={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:o,to:i}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const l=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(o.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,i.col))}}},F9={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},$9={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},V9={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:o,to:i}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const l=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(o.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(i.row,l))}}},B9={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:o,to:i}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const l=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(o.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(i.row,l))}}},W9={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:o,to:i}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const l=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(o.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,i.col))}}},U9={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},z9={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},j9={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const o=t._createCellCoords(r,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(o.row-i,0);t.selection.setRangeEnd(o),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function Y9(){return[H9,P9,k9,D9,N9,L9,F9,$9,V9,B9,W9,U9,z9,j9]}const G9={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},K9={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+n;r===t.countRows()-1?o=1:r+o>t.countRows()&&(o=t.countRows()-r-1),t.selection.transformStart(o,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},X9={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},q9={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col,!0)}},Q9={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},Z9={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},J9={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},e7={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,o=parseInt(t.getSettings().fixedRowsBottom,10),i=n.getNearestNotHiddenIndex(t.countRows()-o-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(i,s))}},t7={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},n7={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),o=t.getSelectedRangeLast().highlight.row,i=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(o,i))}},r7={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let o=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);o===null&&(o=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,o))}},o7={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let o=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);o===null&&(o=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,o))}},i7={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},s7={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,o=parseInt(t.getSettings().fixedRowsTop,10),i=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(o,1),l=r.getNearestNotHiddenIndex(i,1);e.setRangeStart(t._createCellCoords(s,l))}},l7={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},a7={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let o=-(t.countVisibleRows()+n);r===-n?o=-1:r+o<n&&(o=-(r+n)),t.selection.transformStart(o,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function u7(){return[G9,K9,X9,q9,Q9,Z9,J9,e7,t7,n7,r7,o7,i7,s7,l7,a7]}const c7={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},h7={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,o=t.view.getLastFullyVisibleRow()+1,i=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),l=t._createCellCoords(o,i);if(!t._createCellRange(s,s,l).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},d7={name:"selectAll",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},f7={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),o=t.getDataAtCell(n,r),i=new Map;for(let s=0;s<e.length;s++)e[s].forAll((l,a)=>{if(l>=0&&a>=0&&(l!==n||a!==r)){const{readOnly:u}=t.getCellMeta(l,a);u||i.set(`${l}x${a}`,[l,a,o])}});t.setDataAtCell(Array.from(i.values()))}},g7=[...A9(),...Y9(),...u7(),c7,h7,d7,f7];function Bk(t){const e={};return g7.forEach(n=>{let{name:r,callback:o}=n;e[r]=function(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return o(t,...s)}}),e}function m7(t){const e=t.getShortcutManager().addContext("editor"),n=Bk(t),r={group:Jb};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(o,i)=>n.editorCloseAndSave(o,i)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function p7(t){const e=t.getShortcutManager().addContext("grid"),n=Bk(t),r={runOnlyIf:()=>{const{navigableHeaders:o}=t.getSettings();return he(t.getSelected())&&(o||!o&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:Vk};e.addShortcuts([{keys:[["F2"]],callback:o=>n.editorFastOpen(o)},{keys:[["Enter"],["Enter","Shift"]],callback:(o,i)=>n.editorOpen(o,i)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Jb,runOnlyIf:()=>he(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"],["Control/Meta","Shift","Space"]],callback:()=>n.selectAll()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function w7(t){[m7,p7].forEach(e=>e(t))}function C7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=ix(t),o=ix(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),o.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(o),{activate(){t._registerTimeout(()=>{r.tabIndex=0,o.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,o.tabIndex=-1},10)}}}function ix(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&He(n,[io()]),n}function v7(t){let e;const{activate:n,deactivate:r}=C7(t,{onFocusFromTop(){var o;const i=(o=e)!==null&&o!==void 0?o:sx(t);i&&(t.runHooks("modifyFocusOnTabNavigation","from_above",i),t.selectCell(i.row,i.col)),t.listen()},onFocusFromBottom(){var o;const i=(o=e)!==null&&o!==void 0?o:lx(t);i&&(t.runHooks("modifyFocusOnTabNavigation","from_below",i),t.selectCell(i.row,i.col)),t.listen()}});t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",()=>{var o;e=(o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight}),t.getShortcutManager().getContext("grid").addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:o=>{var i;const{disableTabNavigation:s,autoWrapRow:l}=t.getSettings();if(s)return t.deselectCell(),t.unlisten(),!1;const a=t.selection.isSelected(),u=(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight,c=sx(t),h=lx(t);return l||(c.row=u.row,h.row=u.row),o.shiftKey&&(!a||u.isEqual(c))||!o.shiftKey&&(!a||u.isEqual(h))?(t.deselectCell(),t.unlisten(),!1):!0},runOnlyIf:()=>!t.getSettings().minSpareCols,preventDefault:!1,stopPropagation:!1,position:"before",relativeToGroup:Vk,group:"focusCatcher"})}function sx(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let o=r&&t.countColHeaders()>0?-t.countColHeaders():0,i=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return o===0&&(o=e.getVisualFromRenderableIndex(o)),i===0&&(i=n.getVisualFromRenderableIndex(i)),o===null||i===null?null:t._createCellCoords(o,i)}function lx(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:o}=t,{navigableHeaders:i}=t.getSettings();let s=r.getRenderableIndexesLength()-1,l=o.getRenderableIndexesLength()-1;if(s<0){if(!i||t.countColHeaders()===0)return null;s=-1}if(l<0){if(!i||t.countColHeaders()===0)return null;l=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=o.getVisualFromRenderableIndex(l))!==null&&n!==void 0?n:l)}const ax=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),xd=t=>t.map(e=>{const n=e.toLowerCase();return ax.has(n)?ax.get(n):n}).sort().join("+"),y7=t=>t.split("+"),ux=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),Ww=t=>{let{key:e,code:n}=t;return(ux.test(n)?n.replace(ux,"$1"):e).toLowerCase()},Wk=Symbol("shortcut-context");function Uk(t){return $e(t)&&t.__kindOf===Wk}const S7=t=>{const e=Lm({errorIdExists:a=>`The "${a}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:a,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:f=!1,preventDefault:g=!0,stopPropagation:p=!1,relativeToGroup:y,position:E,forwardToContext:w}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(vt(c))throw new Error("You need to define the shortcut's group.");if(wt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(a)===!1)throw new Error(ht`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const C={callback:u,group:c,runOnlyIf:h,captureCtrl:f,preventDefault:g,stopPropagation:p};he(y)&&([C.relativeToGroup,C.position]=[y,E]),Uk(w)&&(C.forwardToContext=w),a.forEach(S=>{const T=xd(S);if(e.hasItem(T)){const A=e.getItem(T);let D=A.findIndex(U=>U.group===y);D!==-1?E==="before"?D-=1:D+=1:D=A.length,A.splice(D,0,C)}else e.addItem(T,[C])})},r=function(a){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};a.forEach(c=>{Ue(u,(h,f)=>{Object.prototype.hasOwnProperty.call(c,f)===!1&&(c[f]=u[f])}),n(c)})},o=a=>{const u=xd(a);e.removeItem(u)};return{__kindOf:Wk,addShortcut:n,addShortcuts:r,getShortcuts:a=>{const u=xd(a),c=e.getItem(u);return he(c)?c.slice():[]},hasShortcut:a=>{const u=xd(a);return e.hasItem(u)},removeShortcutsByKeys:o,removeShortcutsByGroup:a=>{e.getItems().forEach(c=>{let[h,f]=c;const g=f.filter(p=>p.group!==a);g.length===0?o(y7(h)):(f.length=0,f.push(...g))})}}};function R7(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const b7=["meta","alt","shift","control"],_u=R7();let _d=0;function E7(t,e,n,r,o){const i=g=>b7.includes(g),s=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=[];return g.altKey&&y.push("alt"),p&&(g.ctrlKey||g.metaKey)?y.push("control/meta"):(g.ctrlKey&&y.push("control"),g.metaKey&&y.push("meta")),g.shiftKey&&y.push("shift"),y},l=g=>{if(e(g)===!1)return;const p=n(g);if(g.keyCode===229||p===!1||es(g))return;const y=Ww(g);let E=[];i(y)||(E=s(g));const w=[y].concat(E);!o(g,w)&&(xg()&&E.includes("meta")||!xg()&&E.includes("control"))&&o(g,[y].concat(s(g,!0))),r(g)},a=g=>{const p=Ww(g);i(p)&&_u.press(p)},u=g=>{const p=Ww(g);i(p)&&_u.release(p)},c=()=>{_u.releaseAll()};return{mount:()=>{let g=t;for(_d+=1;g;)_d===1&&(g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("keyup",u)),g.document.documentElement.addEventListener("keydown",l),g.document.documentElement.addEventListener("blur",c),g=Xc(g)},unmount:()=>{let g=t;for(_d-=1;g;)_d===0&&(g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("keyup",u)),g.document.documentElement.removeEventListener("keydown",l),g.document.documentElement.removeEventListener("blur",c),g=Xc(g)},isPressed:g=>_u.isPressed(g),releasePressedKeys:()=>_u.releaseAll()}}const T7=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:o}=t;const i=Lm({errorIdExists:p=>`The "${p}" context name is already registered.`});let s="grid";const l=p=>{const y=S7(p);return i.addItem(p,y),y},a=()=>s,u=p=>i.getItem(p),c=p=>{if(!i.hasItem(p))throw new Error(ht`You've tried to activate the "${p}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=p};let h=!1;const f=function(p,y){let E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a();const w=Uk(E)?E:u(E);let C=!1;if(!w.hasShortcut(y))return C;const S=w.getShortcuts(y);for(let T=0;T<S.length;T++){const{callback:x,runOnlyIf:A,preventDefault:D,stopPropagation:U,captureCtrl:j,forwardToContext:z}=S[T];if(A(p)!==!1){if(h=j,C=x(p,y)===!1,h=!1,D&&p.preventDefault(),U&&(br(p),p.stopPropagation()),C)break;z&&f(p,y,z)}}return C},g=E7(e,n,r,o,f);return g.mount(),{addContext:l,getActiveContextName:a,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};let Uw=null;const zw=new Map;function zk(t,e){var n,r=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=this;const l=new Dt(s);let a,u,c,h,f,g=!0;$8(o)&&F8(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",y=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=A5(e.language);const E=new $k(s,e,[T9,M9]),w=E.getTableMeta(),C=E.getGlobalMeta(),S=Lm();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Pf(this)&&YH(e.licenseKey,t),this.guid=`ht_${k0()}`,zw.set(this.guid,this),this.columnIndexMapper=new Ly,this.rowIndexMapper=new Ly,this.columnIndexMapper.addLocalHook("indexesSequenceChange",d=>{s.runHooks("afterColumnSequenceChange",d)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",d=>{s.runHooks("afterRowSequenceChange",d)}),u=new J8(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const T=d=>{const{row:m,col:v}=d;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,v>=0?s.columnIndexMapper.getRenderableFromVisualIndex(v):v)},x=d=>{const{row:m,col:v}=d;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,v>=0?s.columnIndexMapper.getVisualFromRenderableIndex(v):v)};let A=new c9(w,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:d=>a.propToCol(d),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(d,m)=>s._createCellCoords(d,m),createCellRange:(d,m,v)=>s._createCellRange(d,m,v),visualToRenderableCoords:T,renderableToVisualCoords:x,isDisabledCellSelection:(d,m)=>s.getCellMeta(d,m).disableVisualSelection});this.selection=A;const D=d=>{let{hiddenIndexesChanged:m}=d;m&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",D),this.rowIndexMapper.addLocalHook("cacheUpdated",D),this.selection.addLocalHook("beforeHighlightSet",()=>{this.runHooks("beforeSelectionHighlightSet")}),this.selection.addLocalHook("beforeSetRangeStart",d=>{this.runHooks("beforeSetRangeStart",d)}),this.selection.addLocalHook("beforeSetRangeStartOnly",d=>{this.runHooks("beforeSetRangeStartOnly",d)}),this.selection.addLocalHook("beforeSetRangeEnd",d=>{this.runHooks("beforeSetRangeEnd",d)}),this.selection.addLocalHook("afterSetRangeEnd",d=>{const m=Cl(!1),v=this.selection.getSelectedRange(),{from:_,to:I}=v.current(),H=v.size()-1;this.runHooks("afterSelection",_.row,_.col,I.row,I.col,m,H),this.runHooks("afterSelectionByProp",_.row,s.colToProp(_.col),I.row,s.colToProp(I.col),m,H);let K=!0;i&&(K=!1),m.isTouched()&&(K=!m.value);const W=this.selection.selectedRange.current(),Q=this.selection.isSelectedByAnyHeader(),J=this.selection.isSelectedByRowHeader(),q=this.selection.isSelectedByColumnHeader();if(K!==!1)if(Q)J?this.scrollViewportTo({row:d.row}):q&&this.scrollViewportTo({col:d.col});else if(W&&!this.selection.isMultiple()){const{row:fe,col:Oe}=W.from;fe<0&&Oe>=0?this.scrollViewportTo({col:Oe}):Oe<0&&fe>=0?this.scrollViewportTo({row:fe}):this.scrollViewportTo({row:fe,col:Oe})}else this.scrollViewportTo(d.toObject());J&&q?te(this.rootElement,["ht__selection--rows","ht__selection--columns"]):J?(ke(this.rootElement,"ht__selection--columns"),te(this.rootElement,"ht__selection--rows")):q?(ke(this.rootElement,"ht__selection--rows"),te(this.rootElement,"ht__selection--columns")):ke(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",d=>{const m=d.length-1,{from:v,to:_}=d[m];this.runHooks("afterSelectionEnd",v.row,v.col,_.row,_.col,m),this.runHooks("afterSelectionEndByProp",v.row,s.colToProp(v.col),_.row,s.colToProp(_.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",d=>{const m=this.runHooks("afterIsMultipleSelection",d.value);d.value&&(d.value=m)}),this.selection.addLocalHook("beforeSelectColumns",function(){for(var d=arguments.length,m=new Array(d),v=0;v<d;v++)m[v]=arguments[v];return r.runHooks("beforeSelectColumns",...m)}),this.selection.addLocalHook("afterSelectColumns",function(){for(var d=arguments.length,m=new Array(d),v=0;v<d;v++)m[v]=arguments[v];return r.runHooks("afterSelectColumns",...m)}),this.selection.addLocalHook("beforeSelectRows",function(){for(var d=arguments.length,m=new Array(d),v=0;v<d;v++)m[v]=arguments[v];return r.runHooks("beforeSelectRows",...m)}),this.selection.addLocalHook("afterSelectRows",function(){for(var d=arguments.length,m=new Array(d),v=0;v<d;v++)m[v]=arguments[v];return r.runHooks("afterSelectRows",...m)}),this.selection.addLocalHook("beforeModifyTransformStart",d=>{this.runHooks("modifyTransformStart",d)}),this.selection.addLocalHook("afterModifyTransformStart",(d,m,v)=>{this.runHooks("afterModifyTransformStart",d,m,v)}),this.selection.addLocalHook("beforeModifyTransformEnd",d=>{this.runHooks("modifyTransformEnd",d)}),this.selection.addLocalHook("afterModifyTransformEnd",(d,m,v)=>{this.runHooks("afterModifyTransformEnd",d,m,v)}),this.selection.addLocalHook("afterDeselect",()=>{h.destroyEditor(),this._refreshBorders(),ke(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",d=>{this.alter("insert_row_above",d,1,"auto")}),this.selection.addLocalHook("insertColRequire",d=>{this.alter("insert_col_start",d,1,"auto")}),c={alter(d,m){var v,_;let I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,H=arguments.length>3?arguments[3]:void 0,K=arguments.length>4?arguments[4]:void 0;const W=Q=>{if(Q.length===0)return[];const J=[...Q];return J.sort((fe,Oe)=>{let[xe]=fe,[_e]=Oe;return xe===_e?0:xe>_e?1:-1}),Gt(J,(fe,Oe)=>{let[xe,_e]=Oe;const X=fe[fe.length-1],[Ye,Ve]=X,Ee=Ye+Ve;if(xe<=Ee){const De=Math.max(_e-(Ee-xe),0);X[1]+=De}else fe.push([xe,_e]);return fe},[J[0]])};switch(d){case"insert_row_below":case"insert_row_above":const Q=s.countSourceRows();if(w.maxRows===Q)return;const J=d==="insert_row_below"?"below":"above";m=(v=m)!==null&&v!==void 0?v:J==="below"?Q:0;const{delta:q,startPhysicalIndex:fe}=a.createRow(m,I,{source:H,mode:J});if(q){const Ve=A.selectedRange.current(),Ee=Ve==null?void 0:Ve.from,De=Ee==null?void 0:Ee.row,be=s.toVisualRow(fe);if(A.isSelectedByCorner())A.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(he(De)&&De>=be){const{row:R,col:M}=Ve.to;let P=Ee.col;A.isSelectedByRowHeader()&&(P=-1),A.getSelectedRange().pop(),A.setRangeStartOnly(s._createCellCoords(De+q,P),!0),A.setRangeEnd(s._createCellCoords(R+q,M))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Oe=d==="insert_col_end"?"end":"start";m=(_=m)!==null&&_!==void 0?_:Oe==="end"?s.countSourceCols():0;const{delta:xe,startPhysicalIndex:_e}=a.createCol(m,I,{source:H,mode:Oe});if(xe){if(Array.isArray(w.colHeaders)){const R=[s.toVisualColumn(_e),0];R.length+=xe,Array.prototype.splice.apply(w.colHeaders,R)}const Ve=A.selectedRange.current(),Ee=Ve==null?void 0:Ve.from,De=Ee==null?void 0:Ee.col,be=s.toVisualColumn(_e);if(A.isSelectedByCorner())A.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(he(De)&&De>=be){const{row:R,col:M}=Ve.to;let P=Ee.row;A.isSelectedByColumnHeader()&&(P=-1),A.getSelectedRange().pop(),A.setRangeStartOnly(s._createCellCoords(P,De+xe),!0),A.setRangeEnd(s._createCellCoords(R,M+xe))}else s._refreshBorders()}break;case"remove_row":const X=Ve=>{let Ee=0;O(Ve,De=>{let[be,R]=De;const M=rn(be)?s.countRows()-1:Math.max(be-Ee,0);if(Number.isInteger(be)&&(be=Math.max(be-Ee,0)),!a.removeRow(be,R,H))return;const B=s.countRows(),k=w.fixedRowsTop;k>=M+1&&(w.fixedRowsTop-=Math.min(R,k-M));const V=w.fixedRowsBottom;V&&M>=B-V&&(w.fixedRowsBottom-=Math.min(R,V)),Ee+=R})};Array.isArray(m)?X(W(m)):X([[m,I]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const Ye=Ve=>{let Ee=0;O(Ve,De=>{let[be,R]=De;const M=rn(be)?s.countCols()-1:Math.max(be-Ee,0);let P=s.toPhysicalColumn(M);if(Number.isInteger(be)&&(be=Math.max(be-Ee,0)),!a.removeCol(be,R,H))return;const k=w.fixedColumnsStart;k>=M+1&&(w.fixedColumnsStart-=Math.min(R,k-M)),Array.isArray(w.colHeaders)&&(typeof P>"u"&&(P=-1),w.colHeaders.splice(P,R)),Ee+=R})};Array.isArray(m)?Ye(W(m)):Ye([[m,I]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${d}"`)}K||c.adjustRowsAndCols()},adjustRowsAndCols(){const d=w.minRows,m=w.minSpareRows,v=w.minCols,_=w.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&A.deselect(),d){const I=s.countRows();I<d&&a.createRow(I,d-I,{source:"auto"})}if(m){const I=s.countEmptyRows(!0);if(I<m){const H=m-I,K=Math.min(H,w.maxRows-s.countSourceRows());a.createRow(s.countRows(),K,{source:"auto"})}}{let I;(v||_)&&(I=s.countEmptyCols(!0));let H=s.countCols();if(v&&!w.columns&&H<v){const K=v-H;I+=K,a.createCol(H,K,{source:"auto"})}if(_&&!w.columns&&s.dataType==="array"&&I<_){H=s.countCols();const K=_-I,W=Math.min(K,w.maxCols-H);a.createCol(H,W,{source:"auto"})}}if(A.isSelected()){const I=s.countRows(),H=s.countCols();O(A.selectedRange,K=>{let W=!1,Q=K.from.row,J=K.from.col,q=K.to.row,fe=K.to.col;Q>I-1?(Q=I-1,W=!0,q>Q&&(q=Q)):q>I-1&&(q=I-1,W=!0,Q>q&&(Q=q)),J>H-1?(J=H-1,W=!0,fe>J&&(fe=J)):fe>H-1&&(fe=H-1,W=!0,J>fe&&(J=fe)),W&&s.selectCell(Q,J,q,fe)})}s.view&&s.view.adjustElementsSize()},populateFromArray(d,m,v,_,I){let H,K,W,Q;const J=[],q={},fe=[],Oe=d.row,xe=d.col;if(K=m.length,K===0)return!1;let _e=0,X=0;switch($e(v)&&(_e=v.col-xe+1,X=v.row-Oe+1),I){case"shift_down":const Ye=pc(m),Ve=Ye.length,Ee=Math.max(Ve,_e),De=s.getData().slice(Oe),be=pc(De).slice(xe,xe+Ee);for(W=0;W<Ee;W+=1)if(W<Ve){for(H=0,K=Ye[W].length;H<X-K;H+=1)Ye[W].push(Ye[W][H%K]);W<be.length?fe.push(Ye[W].concat(be[W])):fe.push(Ye[W].concat(new Array(De.length).fill(null)))}else fe.push(Ye[W%Ve].concat(be[W]));s.populateFromArray(Oe,xe,pc(fe));break;case"shift_right":const R=m.length,M=Math.max(R,X),P=s.getData().slice(Oe).map(G=>G.slice(xe));for(H=0;H<M;H+=1)if(H<R){for(W=0,Q=m[H].length;W<_e-Q;W+=1)m[H].push(m[H][W%Q]);if(H<P.length)for(let G=0;G<P[H].length;G+=1)m[H].push(P[H][G]);else m[H].push(...new Array(P[0].length).fill(null))}else m.push(m[H%K].slice(0,M).concat(P[H]));s.populateFromArray(Oe,xe,m);break;case"overwrite":default:q.row=d.row,q.col=d.col;let B=0,k=0,V=!0,N;const L=function(le){let ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Se=m[le%m.length];return ge!==null?Se[ge%Se.length]:Se},Y=m.length,$=v?v.row-d.row+1:0;for(v?K=$:K=Math.max(Y,$),H=0;H<K&&!(v&&q.row>v.row&&$>Y||!w.allowInsertRow&&q.row>s.countRows()-1||q.row>=w.maxRows);H++){const G=H-B,le=L(G).length,ge=v?v.col-d.col+1:0;if(v?Q=ge:Q=Math.max(le,ge),q.col=d.col,N=s.getCellMeta(q.row,q.col),(_==="CopyPaste.paste"||_==="Autofill.fill")&&N.skipRowOnPaste){B+=1,q.row+=1,K+=1;continue}for(k=0,W=0;W<Q&&!(v&&q.col>v.col&&ge>le||!w.allowInsertColumn&&q.col>s.countCols()-1||q.col>=w.maxCols);W++){if(N=s.getCellMeta(q.row,q.col),(_==="CopyPaste.paste"||_==="Autofill.fill")&&N.skipColumnOnPaste){k+=1,q.col+=1,Q+=1;continue}if(N.readOnly&&_!=="UndoRedo.undo"){q.col+=1;continue}const Se=W-k;let Ie=L(G,Se),Fe=s.getDataAtCell(q.row,q.col);if(Ie!==null&&typeof Ie=="object")if(Array.isArray(Ie)&&Fe===null&&(Fe=[]),Fe===null||typeof Fe!="object")V=!1;else{const yt=Ua(Array.isArray(Fe)?Fe:Fe[0]||Fe),Xe=Ua(Array.isArray(Ie)?Ie:Ie[0]||Ie);Pm(yt,Xe)||Array.isArray(yt)&&Array.isArray(Xe)?Ie=kn(Ie):V=!1}else Fe!==null&&typeof Fe=="object"&&(V=!1);V&&J.push([q.row,q.col,Ie]),V=!0,q.col+=1}q.row+=1}s.setDataAtCell(J,null,null,_||"populateFromArray");break}}};function U(d){const m=Sk(d);qb(m)?(s.runHooks("beforeLanguageChange",m),C.language=m,s.runHooks("afterLanguageChange",m)):Rk(d)}function j(d,m){const v=d==="className"?s.rootElement:s.table;if(g)te(v,m);else{let _=[],I=[];C[d]&&(_=Array.isArray(C[d])?C[d]:py(C[d])),m&&(I=Array.isArray(m)?m:py(m));const H=my(_,I),K=my(I,_);H.length&&ke(v,H),K.length&&te(v,K)}C[d]=m}this.init=function(){u.setData(w.data),s.runHooks("beforeInit"),(pi()||q0())&&te(s.rootElement,"mobile"),this.updateSettings(w,!0),this.view=new Y8(this),h=z4.getInstance(s,w,A),f=new G4(s),Pf(this)&&v7(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&s.rootElement.offsetParent===null&&lP(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof g=="object"&&(s.runHooks("afterChange",g[0],g[1]),g=!1),s.runHooks("afterInit")};function z(){let d=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,d=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&d===!1&&(d=!0,this.onQueueEmpty(this.valid))}}}function Z(d){const m=d.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):d}function re(d,m,v){if(!d.length)return;const _=s.getActiveEditor(),I=new z;let H=!0;I.onQueueEmpty=K=>{_&&H&&_.cancelChanges(),v(K)};for(let K=d.length-1;K>=0;K--){const[W,Q,,J]=d[K],q=a.propToCol(Q),fe=s.getCellMeta(W,q);fe.type==="numeric"&&typeof J=="string"&&kP(J)&&(d[K][3]=Z(J)),s.getCellValidator(fe)&&(I.addValidatorToQueue(),s.validateCell(d[K][3],fe,function(Oe,xe){return function(_e){if(typeof _e!="boolean")throw new Error("Validation error: result is not boolean");if(_e===!1&&xe.allowInvalid===!1){H=!1,d.splice(Oe,1),xe.valid=!0;const X=s.getCell(xe.visualRow,xe.visualCol);X!==null&&ke(X,w.invalidCellClassName)}I.removeValidatorFormQueue()}}(K,fe),m))}I.checkIfQueueIsEmpty()}function ne(d,m){let v=d.length-1;if(v<0)return;for(;v>=0;v--){let I=!1;if(d[v]===null){d.splice(v,1);continue}if(!((d[v][2]===null||d[v][2]===void 0)&&(d[v][3]===null||d[v][3]===void 0))){if(w.allowInsertRow)for(;d[v][0]>s.countRows()-1;){const{delta:H}=a.createRow(void 0,void 0,{source:m});if(H===0){I=!0;break}}if(s.dataType==="array"&&(!w.columns||w.columns.length===0)&&w.allowInsertColumn)for(;a.propToCol(d[v][1])>s.countCols()-1;){const{delta:H}=a.createCol(void 0,void 0,{source:m});if(H===0){I=!0;break}}I||a.set(d[v][0],d[v][1],d[v][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",d,m),h.lockEditor(),s._refreshBorders(null),h.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",d,m||"edit");const _=s.getActiveEditor();_&&he(_.refreshValue)&&_.refreshValue()}this._createCellCoords=function(d,m){return s.view._wt.createCellCoords(d,m)},this._createCellRange=function(d,m,v){return s.view._wt.createCellRange(d,m,v)},this.validateCell=function(d,m,v,_){let I=s.getCellValidator(m);function H(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){v(K);return}const Q=m.visualCol,J=m.visualRow,q=s.getCell(J,Q,!0);if(q&&q.nodeName!=="TH"){const fe=s.rowIndexMapper.getRenderableFromVisualIndex(J),Oe=s.columnIndexMapper.getRenderableFromVisualIndex(Q);s.view._wt.getSetting("cellRenderer",fe,Oe,q)}v(K)}jH(I)&&(I=function(K){return function(W,Q){Q(K.test(W))}}(I)),wt(I)?(d=s.runHooks("beforeValidate",d,m.visualRow,m.prop,_),s._registerImmediate(()=>{I.call(m,d,K=>{s&&(K=s.runHooks("afterValidate",K,d,m.visualRow,m.prop,_),m.valid=K,H(K),s.runHooks("postAfterValidate",K,d,m.visualRow,m.prop,_))})})):s._registerImmediate(()=>{m.valid=!0,H(m.valid,!1)})};function ue(d,m,v){return Array.isArray(d)?d:[[d,m,v]]}function Re(d,m){const v=s.getActiveEditor(),_=s.runHooks("beforeChange",d,m||"edit"),I=d.filter(H=>H!==null);return _===!1||I.length===0?(v&&v.cancelChanges(),[]):I}this.setDataAtCell=function(d,m,v,_){const I=ue(d,m,v),H=[];let K=_,W,Q,J;for(W=0,Q=I.length;W<Q;W++){if(typeof I[W]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof I[W][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");I[W][1]>=this.countCols()?J=I[W][1]:J=a.colToProp(I[W][1]),H.push([I[W][0],J,u.getAtCell(this.toPhysicalRow(I[W][0]),I[W][1]),I[W][2]])}!K&&typeof d=="object"&&(K=m);const q=Re(H,_);s.runHooks("afterSetDataAtCell",q,K),re(q,K,()=>{ne(q,K)})},this.setDataAtRowProp=function(d,m,v,_){const I=ue(d,m,v),H=[];let K=_,W,Q;for(W=0,Q=I.length;W<Q;W++)H.push([I[W][0],I[W][1],u.getAtCell(this.toPhysicalRow(I[W][0]),I[W][1]),I[W][2]]);!K&&typeof d=="object"&&(K=m);const J=Re(H,_);s.runHooks("afterSetDataAtRowProp",J,K),re(J,K,()=>{ne(J,K)})},this.listen=function(){s&&!s.isListening()&&(zw.forEach(d=>{s!==d&&d.unlisten()}),Uw=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Uw=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Uw===s.guid},this.destroyEditor=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(d,m)},this.populateFromArray=function(d,m,v,_,I,H,K){if(!(typeof v=="object"&&typeof v[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const W=typeof _=="number"?s._createCellCoords(_,I):null;return c.populateFromArray(s._createCellCoords(d,m),v,W,H,K)},this.spliceCol=function(d,m,v){for(var _=arguments.length,I=new Array(_>3?_-3:0),H=3;H<_;H++)I[H-3]=arguments[H];return a.spliceCol(d,m,v,...I)},this.spliceRow=function(d,m,v){for(var _=arguments.length,I=new Array(_>3?_-3:0),H=3;H<_;H++)I[H-3]=arguments[H];return a.spliceRow(d,m,v,...I)},this.getSelected=function(){if(A.isSelected())return We(A.getSelectedRange(),d=>{let{from:m,to:v}=d;return[m.row,m.col,v.row,v.col]})},this.getSelectedLast=function(){const d=this.getSelected();let m;return d&&d.length>0&&(m=d[d.length-1]),m},this.getSelectedRange=function(){if(A.isSelected())return Array.from(A.getSelectedRange())},this.getSelectedRangeLast=function(){const d=this.getSelectedRange();let m;return d&&d.length>0&&(m=d[d.length-1]),m},this.emptySelectedCells=function(d){if(!A.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];O(A.getSelectedRange(),v=>{if(v.isSingleHeader())return;const _=v.getTopStartCorner(),I=v.getBottomEndCorner();ye(_.row,I.row,H=>{ye(_.col,I.col,K=>{this.getCellMeta(H,K).readOnly||m.push([H,K,null])})})}),m.length>0&&this.setDataAtCell(m,d)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const d=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(d,0),!this.isRenderSuspended()&&d===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(h.lockEditor(),this._refreshBorders(null),h.unlockEditor()))},this.batchRender=function(d){this.suspendRender();const m=d();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||d)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const v=d();return this.resumeExecution(m),v},this.batch=function(d){this.suspendRender(),this.suspendExecution();const m=d();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const{width:d,height:m}=s.view.getLastSize(),{width:v,height:_}=s.rootElement.getBoundingClientRect(),I=v!==d||_!==m;s.runHooks("beforeRefreshDimensions",{width:d,height:m},{width:v,height:_},I)!==!1&&((I||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(v,_),s.render()),s.runHooks("afterRefreshDimensions",{width:d,height:m},{width:v,height:_},I))},this.updateData=function(d,m){ox(d,v=>{a=v},v=>{a=v,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:a,dataSource:u,internalSource:"updateData",source:m,metaManager:E,firstRun:g})},this.loadData=function(d,m){ox(d,v=>{a=v},()=>{E.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),g&&(g=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:u,internalSource:"loadData",source:m,metaManager:E,firstRun:g})},this.getInitialColumnCount=function(){const d=w.columns;let m=0;if(Array.isArray(d))m=d.length;else if(wt(d))if(s.dataType==="array"){const v=this.countSourceCols();for(let _=0;_<v;_+=1)d(_)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=a.colToPropCache.length);else if(he(w.dataSchema)){const v=a.getSchema();m=Array.isArray(v)?v.length:km(v)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(d,m,v,_){return vt(d)?a.getAll():a.getRange(s._createCellCoords(d,m),s._createCellCoords(v,_),a.DESTINATION_RENDERER)},this.getCopyableText=function(d,m,v,_){return a.getCopyableText(s._createCellCoords(d,m),s._createCellCoords(v,_))},this.getCopyableData=function(d,m){return a.getCopyable(d,a.colToProp(m))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=(g?s.loadData:s.updateData).bind(this);let _=!1,I,H;if(he(d.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(he(d.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(he(d.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(I in d)I==="data"||(I==="language"?U(d.language):I==="className"?j("className",d.className):I==="tableClassName"&&s.table?(j("tableClassName",d.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):me.getSingleton().isRegistered(I)||me.getSingleton().isDeprecated(I)?(wt(d[I])||Array.isArray(d[I]))&&(d[I].initialHook=!0,s.addHook(I,d[I])):!m&&Pt(d,I)&&(C[I]=d[I]));d.data===void 0&&w.data===void 0?v(null,"updateSettings"):d.data!==void 0?v(d.data,"updateSettings"):d.columns!==void 0&&(a.createMap(),s.initIndexMappers());const K=s.countCols(),W=w.columns;if(W&&wt(W)&&(_=!0),(d.cell!==void 0||d.cells!==void 0||d.columns!==void 0)&&E.clearCache(),K>0)for(I=0,H=0;I<K;I++){if(W){const q=_?W(I):W[H];q&&E.updateColumnMeta(H,q)}H+=1}he(d.cell)&&Ue(d.cell,q=>{s.setCellMetaObject(q.row,q.col,q)}),s.runHooks("afterCellMetaReset");let Q=s.rootElement.style.height;Q!==""&&(Q=parseInt(s.rootElement.style.height,10));let J=d.height;if(wt(J)&&(J=J()),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),J===null){const q=s.rootElement.getAttribute("data-initialstyle");q&&(q.indexOf("height")>-1||q.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",q):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else J!==void 0&&(s.rootElement.style.height=isNaN(J)?`${J}`:`${J}px`,s.rootElement.style.overflow="hidden");if(typeof d.width<"u"){let q=d.width;wt(q)&&(q=q()),s.rootElement.style.width=isNaN(q)?`${q}`:`${q}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",d)),c.adjustRowsAndCols(),s.view&&!g&&(s.forceFullRender=!0,h.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),h.unlockEditor()),!m&&s.view&&(Q===""||J===""||J===void 0)&&Q!==J&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const d=s.getSelectedLast();if(w.getValue){if(wt(w.getValue))return w.getValue.call(s);if(d)return s.getData()[d[0][0]][w.getValue]}else if(d)return s.getDataAtCell(d[0],d[1])},this.getSettings=function(){return w},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(d,m,v,_,I){c.alter(d,m,v,_,I)},this.getCell=function(d,m){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=m,I=d;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;_=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(d>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(d)))return null;I=this.rowIndexMapper.getRenderableFromVisualIndex(d)}return I===null||_===null?null:s.view.getCellAtCoords(s._createCellCoords(I,_),v)},this.getCoords=function(d){const m=this.view._wt.wtTable.getCoords(d);if(m===null)return null;const{row:v,col:_}=m;let I=v,H=_;return v>=0&&(I=this.rowIndexMapper.getVisualFromRenderableIndex(v)),_>=0&&(H=this.columnIndexMapper.getVisualFromRenderableIndex(_)),s._createCellCoords(I,H)},this.colToProp=function(d){return a.colToProp(d)},this.propToCol=function(d){return a.propToCol(d)},this.toVisualRow=d=>this.rowIndexMapper.getVisualFromPhysicalIndex(d),this.toVisualColumn=d=>this.columnIndexMapper.getVisualFromPhysicalIndex(d),this.toPhysicalRow=d=>this.rowIndexMapper.getPhysicalFromVisualIndex(d),this.toPhysicalColumn=d=>this.columnIndexMapper.getPhysicalFromVisualIndex(d),this.getDataAtCell=function(d,m){return a.get(d,a.colToProp(m))},this.getDataAtRowProp=function(d,m){return a.get(d,m)},this.getDataAtCol=function(d){const m=[],v=a.getRange(s._createCellCoords(0,d),s._createCellCoords(w.data.length-1,d),a.DESTINATION_RENDERER);for(let _=0;_<v.length;_+=1)for(let I=0;I<v[_].length;I+=1)m.push(v[_][I]);return m},this.getDataAtProp=function(d){const m=[],v=a.getRange(s._createCellCoords(0,a.propToCol(d)),s._createCellCoords(w.data.length-1,a.propToCol(d)),a.DESTINATION_RENDERER);for(let _=0;_<v.length;_+=1)for(let I=0;I<v[_].length;I+=1)m.push(v[_][I]);return m},this.getSourceData=function(d,m,v,_){let I;return d===void 0?I=u.getData():I=u.getByRange(s._createCellCoords(d,m),s._createCellCoords(v,_)),I},this.getSourceDataArray=function(d,m,v,_){let I;return d===void 0?I=u.getData(!0):I=u.getByRange(s._createCellCoords(d,m),s._createCellCoords(v,_),!0),I},this.getSourceDataAtCol=function(d){return u.getAtColumn(d)},this.setSourceDataAtCell=function(d,m,v,_){const I=ue(d,m,v),H=this.hasHook("afterSetSourceDataAtCell"),K=[];H&&O(I,Q=>{let[J,q,fe]=Q;K.push([J,q,u.getAtCell(J,q),fe])}),O(I,Q=>{let[J,q,fe]=Q;u.setAtCell(J,q,fe)}),H&&this.runHooks("afterSetSourceDataAtCell",K,_),this.render();const W=s.getActiveEditor();W&&he(W.refreshValue)&&W.refreshValue()},this.getSourceDataAtRow=function(d){return u.getAtRow(d)},this.getSourceDataAtCell=function(d,m){return u.getAtCell(d,m)},this.getDataAtRow=function(d){return a.getRange(s._createCellCoords(d,0),s._createCellCoords(d,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(d,m,v,_){const I=d===void 0?[0,0,this.countRows(),this.countCols()]:[d,m,v,_],[H,K]=I;let[,,W,Q]=I,J=null,q=null;W===void 0&&(W=H),Q===void 0&&(Q=K);let fe="mixed";return ye(Math.max(Math.min(H,W),0),Math.max(H,W),Oe=>{let xe=!0;return ye(Math.max(Math.min(K,Q),0),Math.max(K,Q),_e=>(q=this.getCellMeta(Oe,_e).type,J?xe=J===q:J=q,xe)),fe=xe?q:"mixed",xe}),fe},this.removeCellMeta=function(d,m,v){const[_,I]=[this.toPhysicalRow(d),this.toPhysicalColumn(m)];let H=E.getCellMetaKeyValue(_,I,v);s.runHooks("beforeRemoveCellMeta",d,m,v,H)!==!1&&(E.removeCellMeta(_,I,v),s.runHooks("afterRemoveCellMeta",d,m,v,H)),H=null},this.spliceCellsMeta=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var v=arguments.length,_=new Array(v>2?v-2:0),I=2;I<v;I++)_[I-2]=arguments[I];if(_.length>0&&!Array.isArray(_[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&E.removeRow(this.toPhysicalRow(d),m),_.length>0&&O(_.reverse(),H=>{E.createRow(this.toPhysicalRow(d)),O(H,(K,W)=>this.setCellMetaObject(d,W,K))}),s.render()},this.setCellMetaObject=function(d,m,v){typeof v=="object"&&Ue(v,(_,I)=>{this.setCellMeta(d,m,I,_)})},this.setCellMeta=function(d,m,v,_){if(s.runHooks("beforeSetCellMeta",d,m,v,_)===!1)return;let H=d,K=m;d<this.countRows()&&(H=this.toPhysicalRow(d)),m<this.countCols()&&(K=this.toPhysicalColumn(m)),E.setCellMeta(H,K,v,_),s.runHooks("afterSetCellMeta",d,m,v,_)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(d,m){let v=this.toPhysicalRow(d),_=this.toPhysicalColumn(m);return v===null&&(v=d),_===null&&(_=m),E.getCellMeta(v,_,{visualRow:d,visualColumn:m})},this.getCellMetaAtRow=function(d){return E.getCellsMetaAtRow(d)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||w.columns)},this.getCellRenderer=function(d,m){const v=typeof d=="number"?s.getCellMeta(d,m).renderer:d.renderer;return typeof v=="string"?Ig(v):vt(v)?Ig("text"):v},this.getCellEditor=function(d,m){const v=typeof d=="number"?s.getCellMeta(d,m).editor:d.editor;return typeof v=="string"?_g(v):vt(v)?_g("text"):v},this.getCellValidator=function(d,m){const v=typeof d=="number"?s.getCellMeta(d,m).validator:d.validator;return typeof v=="string"?nR(v):v},this.validateCells=function(d){this._validateCells(d)},this.validateRows=function(d,m){if(!Array.isArray(d))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,d)},this.validateColumns=function(d,m){if(!Array.isArray(d))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,d)},this._validateCells=function(d,m,v){const _=new z;d&&(_.onQueueEmpty=d);let I=s.countRows()-1;for(;I>=0;){if(m!==void 0&&m.indexOf(I)===-1){I-=1;continue}let H=s.countCols()-1;for(;H>=0;){if(v!==void 0&&v.indexOf(H)===-1){H-=1;continue}_.addValidatorToQueue(),s.validateCell(s.getDataAtCell(I,H),s.getCellMeta(I,H),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(_.valid=!1),_.removeValidatorFormQueue()},"validateCells"),H-=1}I-=1}_.checkIfQueueIsEmpty()},this.getRowHeader=function(d){let m=w.rowHeaders,v=d;return v!==void 0&&(v=s.runHooks("modifyRowHeader",v)),v===void 0?(m=[],ye(s.countRows()-1,_=>{m.push(s.getRowHeader(_))})):Array.isArray(m)&&m[v]!==void 0?m=m[v]:wt(m)?m=m(v):m&&typeof m!="string"&&typeof m!="number"&&(m=v+1),m},this.hasRowHeaders=function(){return!!w.rowHeaders},this.hasColHeaders=function(){if(w.colHeaders!==void 0&&w.colHeaders!==null)return!!w.colHeaders;for(let d=0,m=s.countCols();d<m;d++)if(s.getColHeader(d))return!0;return!1},this.getColHeader=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const v=s.runHooks("modifyColHeader",d);if(v===void 0){const W=[],Q=s.countCols();for(let J=0;J<Q;J++)W.push(s.getColHeader(J));return W}let _=w.colHeaders;const I=function(W){const Q=[],J=s.countCols();let q=0;for(;q<J;q++)wt(w.columns)&&w.columns(q)&&Q.push(q);return Q[W]},H=s.toPhysicalColumn(v),K=I(H);return w.colHeaders===!1?_=null:w.columns&&wt(w.columns)&&w.columns(K)&&w.columns(K).title?_=w.columns(K).title:w.columns&&w.columns[H]&&w.columns[H].title?_=w.columns[H].title:Array.isArray(w.colHeaders)&&w.colHeaders[H]!==void 0?_=w.colHeaders[H]:wt(w.colHeaders)?_=w.colHeaders(H):w.colHeaders&&typeof w.colHeaders!="string"&&typeof w.colHeaders!="number"&&(_=$m(v)),_=s.runHooks("modifyColumnHeaderValue",_,d,m),_},this._getColWidthFromSettings=function(d){let m;if(d>=0&&(m=s.getCellMeta(0,d).width),(m===void 0||m===w.width)&&(m=w.colWidths),m!=null){switch(typeof m){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(d){let m=s._getColWidthFromSettings(d);return m=s.runHooks("modifyColWidth",m,d),m===void 0&&(m=oR.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(d){let m=w.rowHeights;if(m!=null){switch(typeof m){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(d){let m=s._getRowHeightFromSettings(d);return m=s.runHooks("modifyRowHeight",m,d),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const d=w.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(d,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Og(s.countRows()-1,v=>{if(s.isEmptyRow(v))m+=1;else if(d===!0)return!1}),m},this.countEmptyCols=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Og(s.countCols()-1,v=>{if(s.isEmptyCol(v))m+=1;else if(d===!0)return!1}),m},this.isEmptyRow=function(d){return w.isEmptyRow.call(s,d)},this.isEmptyCol=function(d){return w.isEmptyCol.call(s,d)},this.selectCell=function(d,m,v,_){let I=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,H=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return vt(d)||vt(m)?!1:this.selectCells([[d,m,v,_]],I,H)},this.selectCells=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(i=!0);const _=A.selectCells(d);return _&&v&&s.listen(),i=!1,_},this.selectColumns=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,v=arguments.length>2?arguments[2]:void 0;return A.selectColumns(d,m,v)},this.selectRows=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,v=arguments.length>2?arguments[2]:void 0;return A.selectRows(d,m,v)},this.deselectCell=function(){A.deselect()},this.selectAll=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,v=arguments.length>2?arguments[2]:void 0;i=!0,A.selectAll(d,m,v),i=!1};const Ne=(d,m)=>d.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(){let{row:d,col:m,verticalSnap:v,horizontalSnap:_,considerHiddenIndexes:I}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},H,K,W,Q;v!==void 0&&(H=v==="top",K=!H),_!==void 0&&(W=_==="start",Q=!W);let J=d,q=m;if(I===void 0||I){const xe=Number.isInteger(d)&&d>=0,_e=Number.isInteger(m)&&m>=0,X=xe?Ne(this.rowIndexMapper,d):void 0,Ye=_e?Ne(this.columnIndexMapper,m):void 0;if(X===null||Ye===null)return!1;J=xe?s.rowIndexMapper.getRenderableFromVisualIndex(X):d,q=_e?s.columnIndexMapper.getRenderableFromVisualIndex(Ye):m}const fe=Number.isInteger(J),Oe=Number.isInteger(q);return fe&&J>=0&&Oe&&q>=0?s.view.scrollViewport(s._createCellCoords(J,q),H,Q,K,W):fe&&J>=0&&(Oe&&q<0||!Oe)?s.view.scrollViewportVertically(J,H,K):Oe&&q>=0&&(fe&&J<0||!fe)?s.view.scrollViewportHorizontally(q,Q,W):!1},this.scrollToFocusedCell=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",d);const{highlight:m}=this.getSelectedRangeLast();this.scrollViewportTo(m.toObject())?this.view.render():(this.removeHook("afterScroll",d),this._registerImmediate(()=>d()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),E.clearCache(),zw.delete(this.guid),Pf(s)){const d=this.rootDocument.querySelector(".hot-display-license-info");d&&d.parentNode.removeChild(d)}go(s.rootElement),l.destroy(),h&&h.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),S.getItems().forEach(d=>{let[,m]=d;m.destroy()}),S.clear(),s.runHooks("afterDestroy")},!0),me.getSingleton().destroy(s),Ue(s,(d,m,v)=>{wt(d)?v[m]=Ae(m):m!=="guid"&&(v[m]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,c=null,A=null,h=null,s=null};function Ae(d){return()=>{throw new Error(`The "${d}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getPlugin=function(d){const m=Hn(d);return m==="UndoRedo"?this.undoRedo:S.getItem(m)},this.getPluginName=function(d){return d===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(d)},this.getInstance=function(){return s},this.addHook=function(d,m){me.getSingleton().add(d,m,s)},this.hasHook=function(d){return me.getSingleton().has(d,s)||me.getSingleton().has(d)},this.addHookOnce=function(d,m){me.getSingleton().once(d,m,s)},this.removeHook=function(d,m){me.getSingleton().remove(d,m,s)},this.runHooks=function(d,m,v,_,I,H,K){return me.getSingleton().run(s,d,m,v,_,I,H,K)},this.getTranslatedPhrase=function(d,m){return _k(w.language,d,m)},this.toHTML=()=>My(this),this.toTableElement=()=>{const d=this.rootDocument.createElement("div");return d.insertAdjacentHTML("afterbegin",My(this)),d.firstElementChild},this.timeouts=[],this._registerTimeout=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,v=d;typeof v=="function"&&(v=setTimeout(v,m)),this.timeouts.push(v)},this._clearTimeouts=function(){O(this.timeouts,d=>{clearTimeout(d)})},this.immediates=[],this._registerImmediate=function(d){this.immediates.push(setImmediate(d))},this._clearImmediates=function(){O(this.immediates,d=>{clearImmediate(d)})},this._refreshBorders=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.destroyEditor(d),s.view.render(),m&&A.isSelected()&&h.prepareEditor()},this._getEditorManager=function(){return h},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const b=T7({handleEvent(){return s.isListening()},beforeKeyDown:d=>this.runHooks("beforeKeyDown",d),afterKeyDown:d=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",d)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",d=>{d.ctrlKey===!1&&d.metaKey===!1&&b.releasePressedKeys()}),this.getShortcutManager=function(){return b},this.getFocusManager=function(){return f},tR().forEach(d=>{const m=_h(d);S.addItem(d,new m(this))}),w7(s),b.setActiveContextName("grid"),me.getSingleton().run(s,"construct")}const M7="hooksRefRegisterer",jk={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){O(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ue(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};jo(jk,"MIXIN_NAME",M7,{writable:!1,enumerable:!1});const x7=jk,_7="base",en=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Wy="baseEditor";class su{static get EDITOR_TYPE(){return _7}constructor(e){this.hot=e,this.instance=e,this.state=en.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,o,i,s){this.TD=o,this.row=e,this.col=n,this.prop=r,this.originalValue=i,this.cellProperties=s,this.state=en.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,o,i,s;if(n){const h=this.hot.getSelectedLast();r=Math.max(Math.min(h[0],h[2]),0),o=Math.max(Math.min(h[1],h[3]),0),i=Math.max(h[0],h[2]),s=Math.max(h[1],h[3])}else[r,o,i,s]=[this.row,this.col,null,null];const l=this.hot.runHooks("modifyGetCellCoords",r,o);Array.isArray(l)&&([r,o]=l);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>he(this.hot.getSelected()),group:Wy};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,o,e,i,s,"edit")}beginEditing(e,n){if(this.state!==en.VIRGIN)return;const r=this.hot,o=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(o,i)),this.state=en.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Vt(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let o;if(r){const l=this._closeCallback;this._closeCallback=a=>{l&&l(a),r(a),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(Wy),s.removeShortcutsByGroup(Nm),this.state===en.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===en.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const l=this.getValue();this.cellProperties.trimWhitespace?o=[[typeof l=="string"?String.prototype.trim.call(l||""):l]]:o=[[l]],this.state=en.WAITING,this.saveValue(o,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",a=>{this.state=en.FINISHED,this.discardEditor(a)}):(this.state=en.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=en.FINISHED,this.discardEditor()}discardEditor(e){this.state===en.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=en.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=en.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===en.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:o}=this.hot.view._wt,i=this.hot.rootWindow,s=Qt(n),l=ct(n),a=Qt(this.hot.rootElement),u=ct(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,f=c!==i?c.scrollTop:0,g=h!==i?h.scrollLeft:0,p=i.innerWidth-a.left-u,{wtTable:y}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,E=y.name,w=["master","inline_start"].includes(E)?f:0,C=["master","top","bottom"].includes(E)?g:0,S=s.top===a.top?0:1;let T=s.top-a.top-S-w,x=0;this.hot.isRtl()?x=i.innerWidth-s.left-l-p-1+C:x=s.left-a.left-1-C,["top","top_inline_start_corner"].includes(E)&&(T+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(E)&&(x+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const A=this.hot.hasColHeaders(),D=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),U=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),z=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(A&&D<=0||D===z)&&(T+=1),U<=0&&(x+=1);const Z=o.rowsRenderCalculator.startPosition,re=o.columnsRenderCalculator.startPosition,ne=Math.abs(r.inlineStartOverlay.getScrollPosition()),ue=r.topOverlay.getScrollPosition(),Re=un(this.hot.rootDocument);let Ne=n.offsetTop;if(["inline_start","master"].includes(E)&&(Ne+=Z-ue),["bottom","bottom_inline_start_corner"].includes(E)){const{wtViewport:J,wtTable:q}=r.bottomOverlay.clone;Ne+=J.getWorkspaceHeight()-q.getHeight()-Re}let Ae=n.offsetLeft;this.hot.isRtl()?(Ae>=0?Ae=y.getWidth()-n.offsetLeft:Ae=Math.abs(Ae),Ae+=re-ne-l):["top","master","bottom"].includes(E)&&(Ae+=re-ne);const b=Ti(this.TD,this.hot.rootWindow),d=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",m=parseInt(b[d],10)>0?0:1,v=parseInt(b.borderTopWidth,10)>0?0:1,_=ct(n)+m,I=kt(n)+v,H=iP(c)?Re:0,K=sP(h)?Re:0,W=this.hot.view.maximumVisibleElementWidth(Ae)-H+m,Q=Math.max(this.hot.view.maximumVisibleElementHeight(Ne)-K+v,23);return{top:T,start:x,height:I,maxHeight:Q,width:_,maxWidth:W}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}gt(su,x7);function O7(){var t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,n=document.body,r=document.createTextNode(""),o=document.createElement("SPAN"),i=function(f,g,p){f.addEventListener(g,p,!1)},s=function(f,g,p){f.removeEventListener(g,p,!1)},l=function(f){var g,p;f?/^[a-zA-Z \.,\\\/\|0-9]$/.test(f)||(f="."):f="",r.textContent!==void 0?r.textContent=e.value+f:r.data=e.value+f,o.style.position="absolute",o.style.fontSize=h(e).fontSize,o.style.fontFamily=h(e).fontFamily,o.style.whiteSpace="pre",n.appendChild(o),g=o.clientWidth+2,n.removeChild(o),e.style.height=t.minHeight+"px",t.minWidth>g?e.style.width=t.minWidth+"px":g>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=g+"px",p=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>p?e.style.height=t.minHeight+"px":t.maxHeight<p?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=p+"px"},a=function(){window.setTimeout(l,0)},u=function(f){if(f&&f.minHeight)if(f.minHeight=="inherit")t.minHeight=e.clientHeight;else{var g=parseInt(f.minHeight);isNaN(g)||(t.minHeight=g)}if(f&&f.maxHeight)if(f.maxHeight=="inherit")t.maxHeight=e.clientHeight;else{var p=parseInt(f.maxHeight);isNaN(p)||(t.maxHeight=p)}if(f&&f.minWidth)if(f.minWidth=="inherit")t.minWidth=e.clientWidth;else{var y=parseInt(f.minWidth);isNaN(y)||(t.minWidth=y)}if(f&&f.maxWidth)if(f.maxWidth=="inherit")t.maxWidth=e.clientWidth;else{var E=parseInt(f.maxWidth);isNaN(E)||(t.maxWidth=E)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))},c=function(f,g,p){e=f,u(g),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),p&&(i(e,"change",l),i(e,"cut",a),i(e,"paste",a),i(e,"drop",a),i(e,"keydown",a),i(e,"focus",l),i(e,"compositionstart",a),i(e,"compositionupdate",a),i(e,"compositionend",a)),l()};function h(f){return f.currentStyle||document.defaultView.getComputedStyle(f)}return{init:function(f,g,p){c(f,g,p)},unObserve:function(){s(e,"change",l),s(e,"cut",a),s(e,"paste",a),s(e,"drop",a),s(e,"keydown",a),s(e,"focus",l),s(e,"compositionstart",a),s(e,"compositionupdate",a),s(e,"compositionend",a)},resize:l}}function cx(t,e){const n=B0(e),r=e.value.split(`
`);let o=n,i=0;for(let s=0;s<r.length;s++){const l=r[s];s!==0&&(i+=r[s-1].length+1);const a=i+l.length;if(t==="home"?o=i:t==="end"&&(o=a),n<=a)break}Eh(e,o)}const I7="ht_editor_visible",Od="ht_editor_hidden",hx="textEditor",A7="text";class Al extends su{static get EDITOR_TYPE(){return A7}constructor(e){super(e),this.eventManager=new Dt(this),this.autoResize=O7(),this.TEXTAREA=void 0,this.textareaStyle=void 0,this.TEXTAREA_PARENT=void 0,this.textareaParentStyle=void 0,this.layerClass=void 0,this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",n=>this.onAfterDocumentKeyDown(n)),this.registerShortcuts()}close(){this.autoResize.unObserve(),ZH(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(e,n,r,o,i,s){const l=this.state;if(super.prepare(e,n,r,o,i,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:a}=s;a&&(this.TEXTAREA.value=""),l!==en.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===en.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Eh(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),He(this.TEXTAREA,[["data-hot-input",""],Om(-1)]),this.hot.getSettings().ariaTags&&He(this.TEXTAREA,[ru()]),te(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),te(this.TEXTAREA_PARENT,"handsontableInputHolder"),Pe(this.TEXTAREA_PARENT,this.layerClass)&&ke(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,Od),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){yP()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ke(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,Od)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;ye(e.length-1,r=>{const o=e[r];if(Pe(o,"handsontableEditor"))return n=!0,!1}),Pe(this.TEXTAREA_PARENT,Od)&&ke(this.TEXTAREA_PARENT,Od),n?(this.layerClass=I7,te(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),te(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==en.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:o,maxWidth:i,height:s,maxHeight:l}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const a=Ti(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=a.fontSize,this.TEXTAREA.style.fontFamily=a.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=Ti(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),f=o-c,g=s-h,p=i-c,y=l-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,p),minHeight:Math.min(g,y),maxWidth:p,maxHeight:y},!0)}bindEvents(){X0()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===en.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===en.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>he(this.hot.getSelected()),group:hx},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"]],callback:i=>{const s=this.hot.getSettings(),l=typeof s.tabMoves=="function"?s.tabMoves(i):s.tabMoves;this.hot.selection.transformStart(l.row,l.col,!0)}},{keys:[["Shift","Tab"]],callback:i=>{const s=this.hot.getSettings(),l=typeof s.tabMoves=="function"?s.tabMoves(i):s.tabMoves;this.hot.selection.transformStart(-l.row,-l.col)}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:i=>!this.hot.selection.isMultiple()&&!i.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(i,s)=>{let[l]=s;cx(l,this.TEXTAREA)}},{keys:[["End"]],callback:(i,s)=>{let[l]=s;cx(l,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}}],r)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(Nm),n.removeShortcutsByGroup(hx),n.removeShortcutsByGroup(Wy)}onAfterDocumentKeyDown(e){[pe.ARROW_UP,pe.ARROW_RIGHT,pe.ARROW_DOWN,pe.ARROW_LEFT].indexOf(e.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}const H7="base";function Hh(t,e,n,r,o,i,s){const l=s.ariaTags,a=[],u=[],c=[],h=[];s.className&&te(e,s.className),s.readOnly?(a.push(s.readOnlyCellClassName),l&&h.push(lM())):l&&c.push(lM()[0]),s.valid===!1&&s.invalidCellClassName?(a.push(s.invalidCellClassName),l&&h.push(aM())):(u.push(s.invalidCellClassName),l&&c.push(aM()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&a.push(s.noWordWrapClassName),!i&&s.placeholder&&a.push(s.placeholderCellClassName),ke(e,u),te(e,a),bh(e,c),He(e,h)}Hh.RENDERER_TYPE=H7;const P7="text";function ki(t,e,n,r,o,i,s){Hh.apply(this,[t,e,n,r,o,i,s]);let l=i;if(!l&&s.placeholder&&(l=s.placeholder),l=Vt(l),s.trimWhitespace&&(l=l.trim()),s.rendererTemplate){go(e);const a=t.rootDocument.createElement("TEMPLATE");a.setAttribute("bind","{{}}"),a.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(a),a.model=t.getSourceDataAtRow(n),e.appendChild(a)}else Es(e,l)}ki.RENDERER_TYPE=P7;const k7="text",Yk={CELL_TYPE:k7,editor:Al,renderer:ki};Ar(Yk);ae.editors={BaseEditor:su};function ae(t,e){const n=new zk(t,e||{},bR);return n.init(),n}ae.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new zk(t,e,bR)};ae.DefaultSettings=Fk();ae.hooks=me.getSingleton();ae.CellCoords=No;ae.CellRange=ja;ae.packageName="handsontable";ae.buildDate="06/10/2023 13:27:42";ae.version="0.0.0-next-ff8465d-20231006";ae.languages={dictionaryKeys:E5,getLanguageDictionary:xk,getLanguagesDictionaries:O5,registerLanguageDictionary:Mk,getTranslatedPhrase:_k};function dx(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function D7(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?dx(Object(n),!0).forEach(function(r){N7(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dx(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function nh(t){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nh(t)}function Ga(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Kk(r.key),r)}}function Ka(t,e,n){return e&&fx(t.prototype,e),n&&fx(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function N7(t,e,n){return e=Kk(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rh(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Uy(t,e)}function kg(t){return kg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},kg(t)}function Uy(t,e){return Uy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},Uy(t,e)}function L7(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gk(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function F7(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gk(t)}function oh(t){var e=L7();return function(){var r=kg(t),o;if(e){var i=kg(this).constructor;o=Reflect.construct(r,arguments,i)}else o=r.apply(this,arguments);return F7(this,o)}}function $7(t){return V7(t)||B7(t)||W7(t)||U7()}function V7(t){if(Array.isArray(t))return zy(t)}function B7(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function W7(t,e){if(t){if(typeof t=="string")return zy(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zy(t,e)}}function zy(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function U7(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kk(t){var e=z7(t,"string");return typeof e=="symbol"?e:String(e)}var jw=null,j7="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",Y7="The Handsontable instance bound to this component was destroyed and cannot be used properly.",Dg="global",G7="hot-wrapper-editor-container";function K7(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function jy(t,e){var n=tn.Children.toArray(t),r=tn.Children.count(t),o=null;return r!==0&&(r===1&&n[0].props[e]?o=n[0]:o=n.find(function(i){return i.props[e]!==void 0})),o||null}function Xk(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function qk(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=arguments.length>1?arguments[1]:void 0;if(e===null)return null;var n=Zk(e.props,!1);return n.className="".concat(G7," ").concat(n.className),tA.createPortal(tn.createElement("div",Object.assign({},n),e),t.body)}function Qk(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Dg,r=jy(t,"hot-editor"),o=Xk(r);return r?tn.cloneElement(r,{emitEditorInstance:function(s,l){e.get(o)||e.set(o,new Map);var a=e.get(o);a.set(l??Dg,s)},editorColumnScope:n,isEditor:!0}):null}function X7(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;n||(n=document),jw||(jw=n.createDocumentFragment());var r=n.createElement("DIV");jw.appendChild(r);var o=tn.cloneElement(t,D7({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:tA.createPortal(o,r,"".concat(e.row,"-").concat(e.col,"-").concat(Math.random())),portalContainer:r}}function Zk(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}var Jk=function(){function t(){Ga(this,t)}return Ka(t,null,[{key:"getSettings",value:function(n){var r={};if(n.settings){var o=n.settings;for(var i in o)o.hasOwnProperty(i)&&(r[i]=o[i])}for(var s in n)s!=="settings"&&s!=="children"&&n.hasOwnProperty(s)&&(r[s]=n[s]);return r}}]),t}(),_o=function(t){rh(n,t);var e=oh(n);function n(){return Ga(this,n),e.apply(this,arguments)}return Ka(n,[{key:"getSettingsProps",value:function(){var o=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(i){return!o.internalProps.includes(i)}).reduce(function(i,s){return i[s]=o.props[s],i},{})}},{key:"getLocalEditorElement",value:function(){return Qk(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var o=this.props._getChildElementByType(this.props.children,"hot-renderer"),i=this.getLocalEditorElement();this.columnSettings=Jk.getSettings(this.getSettingsProps()),o!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(o),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),i!==null&&(this.columnSettings.editor=this.props._getEditorClass(i,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var o=this.props._getOwnerDocument(),i=qk(o,this.getLocalEditorElement());return tn.createElement(tn.Fragment,null,i)}}]),n}(tn.Component),q7=function(t){rh(n,t);var e=oh(n);function n(){var r;return Ga(this,n),r=e.apply(this,arguments),r.state={portals:[]},r}return Ka(n,[{key:"render",value:function(){return tn.createElement(tn.Fragment,null,this.state.portals)}}]),n}(tn.Component),Q7="0.0.0-next-ff8465d-20231006";function eE(t,e){return e={exports:{}},t(e,e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gn=typeof Symbol=="function"&&Symbol.for,tE=gn?Symbol.for("react.element"):60103,nE=gn?Symbol.for("react.portal"):60106,Gm=gn?Symbol.for("react.fragment"):60107,Km=gn?Symbol.for("react.strict_mode"):60108,Xm=gn?Symbol.for("react.profiler"):60114,qm=gn?Symbol.for("react.provider"):60109,Qm=gn?Symbol.for("react.context"):60110,rE=gn?Symbol.for("react.async_mode"):60111,Zm=gn?Symbol.for("react.concurrent_mode"):60111,Jm=gn?Symbol.for("react.forward_ref"):60112,ep=gn?Symbol.for("react.suspense"):60113,Z7=gn?Symbol.for("react.suspense_list"):60120,tp=gn?Symbol.for("react.memo"):60115,np=gn?Symbol.for("react.lazy"):60116,J7=gn?Symbol.for("react.block"):60121,eX=gn?Symbol.for("react.fundamental"):60117,tX=gn?Symbol.for("react.responder"):60118,nX=gn?Symbol.for("react.scope"):60119;function xr(t){if(nh(t)==="object"&&t!==null){var e=t.$$typeof;switch(e){case tE:switch(t=t.type,t){case rE:case Zm:case Gm:case Xm:case Km:case ep:return t;default:switch(t=t&&t.$$typeof,t){case Qm:case Jm:case np:case tp:case qm:return t;default:return e}}case nE:return e}}}function eD(t){return xr(t)===Zm}var rX=rE,oX=Zm,iX=Qm,sX=qm,lX=tE,aX=Jm,uX=Gm,cX=np,hX=tp,dX=nE,fX=Xm,gX=Km,mX=ep,pX=function(e){return eD(e)||xr(e)===rE},wX=eD,CX=function(e){return xr(e)===Qm},vX=function(e){return xr(e)===qm},yX=function(e){return nh(e)==="object"&&e!==null&&e.$$typeof===tE},SX=function(e){return xr(e)===Jm},RX=function(e){return xr(e)===Gm},bX=function(e){return xr(e)===np},EX=function(e){return xr(e)===tp},TX=function(e){return xr(e)===nE},MX=function(e){return xr(e)===Xm},xX=function(e){return xr(e)===Km},_X=function(e){return xr(e)===ep},OX=function(e){return typeof e=="string"||typeof e=="function"||e===Gm||e===Zm||e===Xm||e===Km||e===ep||e===Z7||nh(e)==="object"&&e!==null&&(e.$$typeof===np||e.$$typeof===tp||e.$$typeof===qm||e.$$typeof===Qm||e.$$typeof===Jm||e.$$typeof===eX||e.$$typeof===tX||e.$$typeof===nX||e.$$typeof===J7)},IX=xr,AX={AsyncMode:rX,ConcurrentMode:oX,ContextConsumer:iX,ContextProvider:sX,Element:lX,ForwardRef:aX,Fragment:uX,Lazy:cX,Memo:hX,Portal:dX,Profiler:fX,StrictMode:gX,Suspense:mX,isAsyncMode:pX,isConcurrentMode:wX,isContextConsumer:CX,isContextProvider:vX,isElement:yX,isForwardRef:SX,isFragment:RX,isLazy:bX,isMemo:EX,isPortal:TX,isProfiler:MX,isStrictMode:xX,isSuspense:_X,isValidElementType:OX,typeOf:IX},mt=eE(function(t,e){});mt.AsyncMode;mt.ConcurrentMode;mt.ContextConsumer;mt.ContextProvider;mt.Element;mt.ForwardRef;mt.Fragment;mt.Lazy;mt.Memo;mt.Portal;mt.Profiler;mt.StrictMode;mt.Suspense;mt.isAsyncMode;mt.isConcurrentMode;mt.isContextConsumer;mt.isContextProvider;mt.isElement;mt.isForwardRef;mt.isFragment;mt.isLazy;mt.isMemo;mt.isPortal;mt.isProfiler;mt.isStrictMode;mt.isSuspense;mt.isValidElementType;mt.typeOf;eE(function(t){t.exports=AX});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var gx=Object.getOwnPropertySymbols,HX=Object.prototype.hasOwnProperty,PX=Object.prototype.propertyIsEnumerable;function kX(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function DX(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(e).map(function(i){return e[i]});if(r.join("")!=="0123456789")return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(i){o[i]=i}),Object.keys(Object.assign({},o)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}DX();var NX="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",LX=NX;Function.call.bind(Object.prototype.hasOwnProperty);function tD(){}function nD(){}nD.resetWarningCache=tD;var FX=function(){function e(o,i,s,l,a,u){if(u!==LX){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function n(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:n,element:e,elementType:e,instanceOf:n,node:e,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:nD,resetWarningCache:tD};return r.PropTypes=r,r},$X=eE(function(t){t.exports=FX()}),Yw=$X,rD=function(t){rh(n,t);var e=oh(n);function n(){var r;return Ga(this,n),r=e.apply(this,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCacheArray=[],r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return Ka(n,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(Y7),null)},set:function(o){this.__hotInstance=o}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(o){this.hotElementRef=o}},{key:"getRendererWrapper",value:function(o){var i=this;return function(s,l,a,u,c,h,f){var g=i.getRenderedCellCache();if(g.has("".concat(a,"-").concat(u))&&(l.innerHTML=g.get("".concat(a,"-").concat(u)).innerHTML),l&&!l.getAttribute("ghost-table")){for(var p=X7(o,{TD:l,row:a,col:u,prop:c,value:h,cellProperties:f,isRenderer:!0},l.ownerDocument),y=p.portal,E=p.portalContainer;l.firstChild;)l.removeChild(l.firstChild);l.appendChild(E),i.portalCacheArray.push(y)}return g.set("".concat(a,"-").concat(u),l),l}}},{key:"getEditorClass",value:function(o){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Dg,l=Xk(o),a=(i=this.getEditorCache().get(l))===null||i===void 0?void 0:i.get(s);return this.makeEditorClass(a)}},{key:"makeEditorClass",value:function(o){var i=function(s){rh(a,s);var l=oh(a);function a(u){var c;return Ga(this,a),c=l.call(this,u),o.hotCustomEditorInstance=Gk(c),c.editorComponent=o,c}return Ka(a,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),a}(ae.editors.BaseEditor);return Object.getOwnPropertyNames(ae.editors.BaseEditor.prototype).forEach(function(s){s!=="constructor"&&(i.prototype[s]=function(){for(var l,a=arguments.length,u=new Array(a),c=0;c<a;c++)u[c]=arguments[c];return(l=o[s]).call.apply(l,[o].concat(u))})}),i}},{key:"getGlobalRendererElement",value:function(){return jy(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return Qk(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var o=Jk.getSettings(this.props),i=this.getGlobalRendererElement(),s=this.getGlobalEditorElement();return o.columns=this.columnSettings.length?this.columnSettings:o.columns,s?o.editor=this.getEditorClass(s,Dg):o.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),i?(o.renderer=this.getRendererWrapper(i),this.componentRendererColumns.set("global",!0)):o.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),o}},{key:"displayAutoSizeWarning",value:function(o){var i,s;this.hotInstance&&((i=this.hotInstance.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.enabled||(s=this.hotInstance.getPlugin("autoColumnSize"))!==null&&s!==void 0&&s.enabled)&&this.componentRendererColumns.size>0&&K7(j7)}},{key:"setHotColumnSettings",value:function(o,i){this.columnSettings[i]=o}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var o=this;this.renderersPortalManager.setState({portals:$7(this.portalCacheArray)},function(){o.portalCacheArray=[]})}},{key:"updateHot",value:function(o){this.hotInstance&&this.hotInstance.updateSettings(o,!1)}},{key:"setRenderersPortalManagerRef",value:function(o){this.renderersPortalManager=o}},{key:"componentDidMount",value:function(){var o=this,i=this.createNewGlobalSettings();this.hotInstance=new ae.Core(this.hotElementRef,i),this.hotInstance.addHook("beforeViewRender",function(){return o.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return o.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(i)}},{key:"componentDidUpdate",value:function(){this.clearCache();var o=this.createNewGlobalSettings();this.updateHot(o),this.displayAutoSizeWarning(o)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var o=this,i=Zk(this.props),s=function(h){return h.type===_o},l=tn.Children.toArray(this.props.children),a=l.filter(function(c){return s(c)}).map(function(c,h){return tn.cloneElement(c,{_componentRendererColumns:o.componentRendererColumns,_emitColumnSettings:o.setHotColumnSettings.bind(o),_columnIndex:h,_getChildElementByType:jy.bind(o),_getRendererWrapper:o.getRendererWrapper.bind(o),_getEditorClass:o.getEditorClass.bind(o),_getOwnerDocument:o.getOwnerDocument.bind(o),_getEditorCache:o.getEditorCache.bind(o),children:c.props.children})}),u=qk(this.getOwnerDocument(),this.getGlobalEditorElement());return tn.createElement(tn.Fragment,null,tn.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},i),a),tn.createElement(q7,{ref:this.setRenderersPortalManagerRef.bind(this)}),u)}}],[{key:"version",get:function(){return Q7}}]),n}(tn.Component);rD.propTypes={style:Yw.object,id:Yw.string,className:Yw.string};tn.Component;const mx="handsontableEditor",VX="handsontable";class oE extends Al{static get EDITOR_TYPE(){return VX}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Eh(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,o,i,s){super.prepare(e,n,r,o,i,s);const l=this,a={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&l.setValue(h),l.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Zt(a,s.handsontable),this.htOptions=a}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const o=this.htEditor.getValue();o!==void 0&&this.setValue(o)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:mx,relativeToGroup:Nm,position:"before"},o=(i,s)=>{const l=this.htEditor;if(i!==void 0&&(i<0||l.flipped&&i>l.countRows()-1?l.deselectCell():l.selectCell(i,0),l.getData().length))return s.preventDefault(),br(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:i=>{const s=this.htEditor;let l,a;return!s.getSelectedLast()&&s.flipped?l=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(a=s.getSelectedLast()[0],l=Math.max(0,a-1)):(a=s.getSelectedLast()[0],l=a-1)),o(l,i)},preventDefault:!1},{keys:[["ArrowDown"]],callback:i=>{const s=this.htEditor;let l,a;if(!s.getSelectedLast()&&!s.flipped)l=0;else if(s.getSelectedLast()){if(s.flipped)l=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;a=s.getSelectedLast()[0],l=Math.min(u,a+1)}}return o(l,i)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(mx)}}function BX(t,e,n){return e=WX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WX(t){var e=UX(t,"string");return typeof e=="symbol"?e:String(e)}function UX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Id=new WeakMap,zX="autocomplete";class iE extends oE{static get EDITOR_TYPE(){return zX}constructor(e){super(e),BX(this,"sortByRelevance",function(n,r,o){const i=[],s=[],l=n.length;let a=r.length,u,c,h,f;if(l===0){for(h=0;h<a;h++)s.push(h);return s}for(h=0;h<a;h++){if(c=Cy(Vt(r[h])),o)f=c.indexOf(n);else{const g=this.cellProperties.locale;f=c.toLocaleLowerCase(g).indexOf(n.toLocaleLowerCase(g))}f!==-1&&(u=c.length-f-l,i.push({baseIndex:h,index:f,charsLeft:u,value:c}))}for(i.sort((g,p)=>{if(p.index===-1)return-1;if(g.index===-1)return 1;if(g.index<p.index)return-1;if(p.index<g.index)return 1;if(g.index===p.index){if(g.charsLeft<p.charsLeft)return-1;if(g.charsLeft>p.charsLeft)return 1}return 0}),h=0,a=i.length;h<a;h++)s.push(i[h].baseIndex);return s}),this.query=null,this.strippedChoices=[],this.rawChoices=[],Id.set(this,{skipOne:!1,isMacOS:this.hot.rootWindow.navigator.platform.indexOf("Mac")>-1,idPrefix:e.guid.slice(0,9)})}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return he(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),te(this.htContainer,"autocompleteEditor"),te(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&He(this.TEXTAREA,[V3(),D3(),L0(),Y3()])}prepare(e,n,r,o,i,s){const l=Id.get(this);super.prepare(e,n,r,o,i,s),this.hot.getSettings().ariaTags&&He(this.TEXTAREA,[Fr("false"),G3(`${l.idPrefix}-listbox-${e}-${n}`)])}open(){const e=Id.get(this);super.open();const n=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,r=this.hot.getSettings().ariaTags,o=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=o==null?void 0:o.length,{row:s,col:l}=this;this.showEditableElement(),this.focus();let a=un();a===0&&e.isMacOS&&(a+=15),this.addHook("beforeKeyDown",u=>this.onBeforeKeyDown(u)),this.htEditor.updateSettings({colWidths:n?[ct(this.TEXTAREA)-2]:void 0,width:n?ct(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(u,c,h,f,g,p,y)=>{ki(u,c,h,f,g,p,y);const{filteringCaseSensitive:E,allowHtml:w,locale:C}=this.cellProperties,S=this.query;let T=Vt(p),x,A;T&&!w&&(x=E===!0?T.indexOf(S):T.toLocaleLowerCase(C).indexOf(S.toLocaleLowerCase(C)),x!==-1&&(A=T.substr(x,S.length),T=T.replace(A,`<strong>${A}</strong>`))),r&&He(c,[L3(),...o?[Q3(i)]:[],...o?[Z3(o.indexOf(p)+1)]:[],["id",`${this.htEditor.rootElement.id}_${h}-${f}`]]),c.innerHTML=T},afterSelection:(u,c)=>{if(r){const h=this.htEditor.getCell(u,c,!0);He(h,[vy()]),He(this.TEXTAREA,...K3(h.id))}}}),r&&(He(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...io()),He(this.htEditor.rootElement,[N3(),X3("polite"),q3("text"),["id",`${e.idPrefix}-listbox-${s}-${l}`]]),He(this.TEXTAREA,...Fr("true"))),e.skipOne&&(e.skipOne=!1),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&He(this.TEXTAREA,[Fr("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=B0(this.TEXTAREA),r=oP(this.TEXTAREA),o=this.cellProperties.sortByRelevance,i=this.cellProperties.filter;let s=null,l=null,a=e;o&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),a,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(i===!1)u&&(l=s[0]);else{const c=[];for(let h=0,f=a.length;h<f&&!(o&&u<=h);h++)u?c.push(a[s[h]]):c.push(a[h]);l=0,a=c}this.strippedChoices=a,this.htEditor.loadData(pc([a])),a.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(l)),this.hot.listen(),Eh(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=wl(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const o=Qt(this.TEXTAREA),i=kt(this.TEXTAREA),s=this.getDropdownHeight(),l=e.scrollTop,a=kt(this.hot.view._wt.wtTable.THEAD),u=Qt(e),c=o.top-u.top-a+l,h=e.scrollHeight-c-a-i,f=s>h&&c>h;return f?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(f?c:h,s),f}limitDropdownIfNeeded(e,n){if(n>e){let r=0,o=0,i=0,s=null;do i=this.htEditor.getRowHeight(o)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=i,o+=1;while(r<e);s=r-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-i)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+un(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=We(e,i=>Vt(i));return We(r,i=>n?i:Cy(i))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let o=!1;return e===pe.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(o=!0),e===pe.ARROW_UP&&r.row>-1&&(o=!0),o}onBeforeKeyDown(e){const n=Id.get(this);if(n.skipOne=!1,SP(e.keyCode)||e.keyCode===pe.BACKSPACE||e.keyCode===pe.DELETE||e.keyCode===pe.INSERT){let r=10;if(e.keyCode===pe.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value),n.skipOne=!0},r)}}}const jX="checkbox";class oD extends su{static get EDITOR_TYPE(){return jX}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');Pe(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var iD={exports:{}};const YX=V_(p3);/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(n,r){var o;{try{o=YX}catch{}t.exports=r(o)}})(so,function(n){var r=typeof n=="function",o=!!window.addEventListener,i=window.document,s=window.setTimeout,l=function(b,d,m,v){o?b.addEventListener(d,m,!!v):b.attachEvent("on"+d,m)},a=function(b,d,m,v){o?b.removeEventListener(d,m,!!v):b.detachEvent("on"+d,m)},u=function(b){return b.trim?b.trim():b.replace(/^\s+|\s+$/g,"")},c=function(b,d){return(" "+b.className+" ").indexOf(" "+d+" ")!==-1},h=function(b,d){c(b,d)||(b.className=b.className===""?d:b.className+" "+d)},f=function(b,d){b.className=u((" "+b.className+" ").replace(" "+d+" "," "))},g=function(b){return/Array/.test(Object.prototype.toString.call(b))},p=function(b){return/Date/.test(Object.prototype.toString.call(b))&&!isNaN(b.getTime())},y=function(b){var d=b.getDay();return d===0||d===6},E=function(b){return b%4===0&&b%100!==0||b%400===0},w=function(b,d){return[31,E(b)?29:28,31,30,31,30,31,31,30,31,30,31][d]},C=function(b){p(b)&&b.setHours(0,0,0,0)},S=function(b,d){return b.getTime()===d.getTime()},T=function(b,d,m){var v,_;for(v in d)_=b[v]!==void 0,_&&typeof d[v]=="object"&&d[v]!==null&&d[v].nodeName===void 0?p(d[v])?m&&(b[v]=new Date(d[v].getTime())):g(d[v])?m&&(b[v]=d[v].slice(0)):b[v]=T({},d[v],m):(m||!_)&&(b[v]=d[v]);return b},x=function(b,d,m){var v;i.createEvent?(v=i.createEvent("HTMLEvents"),v.initEvent(d,!0,!1),v=T(v,m),b.dispatchEvent(v)):i.createEventObject&&(v=i.createEventObject(),v=T(v,m),b.fireEvent("on"+d,v))},A=function(b){return b.month<0&&(b.year-=Math.ceil(Math.abs(b.month)/12),b.month+=12),b.month>11&&(b.year+=Math.floor(Math.abs(b.month)/12),b.month-=12),b},D={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},U=function(b,d,m){for(d+=b.firstDay;d>=7;)d-=7;return m?b.i18n.weekdaysShort[d]:b.i18n.weekdays[d]},j=function(b){var d=[],m="false";if(b.isEmpty)if(b.showDaysInNextAndPreviousMonths)d.push("is-outside-current-month"),b.enableSelectionDaysInNextAndPreviousMonths||d.push("is-selection-disabled");else return'<td class="is-empty"></td>';return b.isDisabled&&d.push("is-disabled"),b.isToday&&d.push("is-today"),b.isSelected&&(d.push("is-selected"),m="true"),b.hasEvent&&d.push("has-event"),b.isInRange&&d.push("is-inrange"),b.isStartRange&&d.push("is-startrange"),b.isEndRange&&d.push("is-endrange"),'<td data-day="'+b.day+'" class="'+d.join(" ")+'" aria-selected="'+m+'"><button class="pika-button pika-day" type="button" data-pika-year="'+b.year+'" data-pika-month="'+b.month+'" data-pika-day="'+b.day+'">'+b.day+"</button></td>"},z=function(b,d){b.setHours(0,0,0,0);var m=b.getDate(),v=b.getDay(),_=d,I=_-1,H=7,K=function(fe){return(fe+H-1)%H};b.setDate(m+I-K(v));var W=new Date(b.getFullYear(),0,_),Q=24*60*60*1e3,J=(b.getTime()-W.getTime())/Q,q=1+Math.round((J-I+K(W.getDay()))/H);return q},Z=function(b,d,m,v){var _=new Date(m,d,b),I=r?n(_).isoWeek():z(_,v);return'<td class="pika-week">'+I+"</td>"},re=function(b,d,m,v){return'<tr class="pika-row'+(m?" pick-whole-week":"")+(v?" is-selected":"")+'">'+(d?b.reverse():b).join("")+"</tr>"},ne=function(b){return"<tbody>"+b.join("")+"</tbody>"},ue=function(b){var d,m=[];for(b.showWeekNumber&&m.push("<th></th>"),d=0;d<7;d++)m.push('<th scope="col"><abbr title="'+U(b,d)+'">'+U(b,d,!0)+"</abbr></th>");return"<thead><tr>"+(b.isRTL?m.reverse():m).join("")+"</tr></thead>"},Re=function(b,d,m,v,_,I){var H,K,W,Q=b._o,J=m===Q.minYear,q=m===Q.maxYear,fe='<div id="'+I+'" class="pika-title" role="heading" aria-live="assertive">',Oe,xe,_e=!0,X=!0;for(W=[],H=0;H<12;H++)W.push('<option value="'+(m===_?H-d:12+H-d)+'"'+(H===v?' selected="selected"':"")+(J&&H<Q.minMonth||q&&H>Q.maxMonth?' disabled="disabled"':"")+">"+Q.i18n.months[H]+"</option>");for(Oe='<div class="pika-label">'+Q.i18n.months[v]+'<select class="pika-select pika-select-month" tabindex="-1">'+W.join("")+"</select></div>",g(Q.yearRange)?(H=Q.yearRange[0],K=Q.yearRange[1]+1):(H=m-Q.yearRange,K=1+m+Q.yearRange),W=[];H<K&&H<=Q.maxYear;H++)H>=Q.minYear&&W.push('<option value="'+H+'"'+(H===m?' selected="selected"':"")+">"+H+"</option>");return xe='<div class="pika-label">'+m+Q.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+W.join("")+"</select></div>",Q.showMonthAfterYear?fe+=xe+Oe:fe+=Oe+xe,J&&(v===0||Q.minMonth>=v)&&(_e=!1),q&&(v===11||Q.maxMonth<=v)&&(X=!1),d===0&&(fe+='<button class="pika-prev'+(_e?"":" is-disabled")+'" type="button">'+Q.i18n.previousMonth+"</button>"),d===b._o.numberOfMonths-1&&(fe+='<button class="pika-next'+(X?"":" is-disabled")+'" type="button">'+Q.i18n.nextMonth+"</button>"),fe+="</div>"},Ne=function(b,d,m){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+m+'">'+ue(b)+ne(d)+"</table>"},Ae=function(b){var d=this,m=d.config(b);d._onMouseDown=function(_){if(d._v){_=_||window.event;var I=_.target||_.srcElement;if(I)if(c(I,"is-disabled")||(c(I,"pika-button")&&!c(I,"is-empty")&&!c(I.parentNode,"is-disabled")?(d.setDate(new Date(I.getAttribute("data-pika-year"),I.getAttribute("data-pika-month"),I.getAttribute("data-pika-day"))),m.bound&&s(function(){d.hide(),m.blurFieldOnSelect&&m.field&&m.field.blur()},100)):c(I,"pika-prev")?d.prevMonth():c(I,"pika-next")&&d.nextMonth()),c(I,"pika-select"))d._c=!0;else if(_.preventDefault)_.preventDefault();else return _.returnValue=!1,!1}},d._onChange=function(_){_=_||window.event;var I=_.target||_.srcElement;I&&(c(I,"pika-select-month")?d.gotoMonth(I.value):c(I,"pika-select-year")&&d.gotoYear(I.value))},d._onKeyChange=function(_){if(_=_||window.event,d.isVisible())switch(_.keyCode){case 13:case 27:m.field&&m.field.blur();break;case 37:d.adjustDate("subtract",1);break;case 38:d.adjustDate("subtract",7);break;case 39:d.adjustDate("add",1);break;case 40:d.adjustDate("add",7);break;case 8:case 46:d.setDate(null);break}},d._parseFieldValue=function(){if(m.parse)return m.parse(m.field.value,m.format);if(r){var _=n(m.field.value,m.format,m.formatStrict);return _&&_.isValid()?_.toDate():null}else return new Date(Date.parse(m.field.value))},d._onInputChange=function(_){var I;_.firedBy!==d&&(I=d._parseFieldValue(),p(I)&&d.setDate(I),d._v||d.show())},d._onInputFocus=function(){d.show()},d._onInputClick=function(){d.show()},d._onInputBlur=function(){var _=i.activeElement;do if(c(_,"pika-single"))return;while(_=_.parentNode);d._c||(d._b=s(function(){d.hide()},50)),d._c=!1},d._onClick=function(_){_=_||window.event;var I=_.target||_.srcElement,H=I;if(I){!o&&c(I,"pika-select")&&(I.onchange||(I.setAttribute("onchange","return;"),l(I,"change",d._onChange)));do if(c(H,"pika-single")||H===m.trigger)return;while(H=H.parentNode);d._v&&I!==m.trigger&&H!==m.trigger&&d.hide()}},d.el=i.createElement("div"),d.el.className="pika-single"+(m.isRTL?" is-rtl":"")+(m.theme?" "+m.theme:""),l(d.el,"mousedown",d._onMouseDown,!0),l(d.el,"touchend",d._onMouseDown,!0),l(d.el,"change",d._onChange),m.keyboardInput&&l(i,"keydown",d._onKeyChange),m.field&&(m.container?m.container.appendChild(d.el):m.bound?i.body.appendChild(d.el):m.field.parentNode.insertBefore(d.el,m.field.nextSibling),l(m.field,"change",d._onInputChange),m.defaultDate||(m.defaultDate=d._parseFieldValue(),m.setDefaultDate=!0));var v=m.defaultDate;p(v)?m.setDefaultDate?d.setDate(v,!0):d.gotoDate(v):d.gotoDate(new Date),m.bound?(this.hide(),d.el.className+=" is-bound",l(m.trigger,"click",d._onInputClick),l(m.trigger,"focus",d._onInputFocus),l(m.trigger,"blur",d._onInputBlur)):this.show()};return Ae.prototype={config:function(b){this._o||(this._o=T({},D,!0));var d=T(this._o,b,!0);d.isRTL=!!d.isRTL,d.field=d.field&&d.field.nodeName?d.field:null,d.theme=typeof d.theme=="string"&&d.theme?d.theme:null,d.bound=!!(d.bound!==void 0?d.field&&d.bound:d.field),d.trigger=d.trigger&&d.trigger.nodeName?d.trigger:d.field,d.disableWeekends=!!d.disableWeekends,d.disableDayFn=typeof d.disableDayFn=="function"?d.disableDayFn:null;var m=parseInt(d.numberOfMonths,10)||1;if(d.numberOfMonths=m>4?4:m,p(d.minDate)||(d.minDate=!1),p(d.maxDate)||(d.maxDate=!1),d.minDate&&d.maxDate&&d.maxDate<d.minDate&&(d.maxDate=d.minDate=!1),d.minDate&&this.setMinDate(d.minDate),d.maxDate&&this.setMaxDate(d.maxDate),g(d.yearRange)){var v=new Date().getFullYear()-10;d.yearRange[0]=parseInt(d.yearRange[0],10)||v,d.yearRange[1]=parseInt(d.yearRange[1],10)||v}else d.yearRange=Math.abs(parseInt(d.yearRange,10))||D.yearRange,d.yearRange>100&&(d.yearRange=100);return d},toString:function(b){return b=b||this._o.format,p(this._d)?this._o.toString?this._o.toString(this._d,b):r?n(this._d).format(b):this._d.toDateString():""},getMoment:function(){return r?n(this._d):null},setMoment:function(b,d){r&&n.isMoment(b)&&this.setDate(b.toDate(),d)},getDate:function(){return p(this._d)?new Date(this._d.getTime()):null},setDate:function(b,d){if(!b)return this._d=null,this._o.field&&(this._o.field.value="",x(this._o.field,"change",{firedBy:this})),this.draw();if(typeof b=="string"&&(b=new Date(Date.parse(b))),!!p(b)){var m=this._o.minDate,v=this._o.maxDate;p(m)&&b<m?b=m:p(v)&&b>v&&(b=v),this._d=new Date(b.getTime()),C(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),x(this._o.field,"change",{firedBy:this})),!d&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(b){var d=!0;if(p(b)){if(this.calendars){var m=new Date(this.calendars[0].year,this.calendars[0].month,1),v=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),_=b.getTime();v.setMonth(v.getMonth()+1),v.setDate(v.getDate()-1),d=_<m.getTime()||v.getTime()<_}d&&(this.calendars=[{month:b.getMonth(),year:b.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(b,d){var m=this.getDate()||new Date,v=parseInt(d)*24*60*60*1e3,_;b==="add"?_=new Date(m.valueOf()+v):b==="subtract"&&(_=new Date(m.valueOf()-v)),this.setDate(_)},adjustCalendars:function(){this.calendars[0]=A(this.calendars[0]);for(var b=1;b<this._o.numberOfMonths;b++)this.calendars[b]=A({month:this.calendars[0].month+b,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(b){isNaN(b)||(this.calendars[0].month=parseInt(b,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(b){isNaN(b)||(this.calendars[0].year=parseInt(b,10),this.adjustCalendars())},setMinDate:function(b){b instanceof Date?(C(b),this._o.minDate=b,this._o.minYear=b.getFullYear(),this._o.minMonth=b.getMonth()):(this._o.minDate=D.minDate,this._o.minYear=D.minYear,this._o.minMonth=D.minMonth,this._o.startRange=D.startRange),this.draw()},setMaxDate:function(b){b instanceof Date?(C(b),this._o.maxDate=b,this._o.maxYear=b.getFullYear(),this._o.maxMonth=b.getMonth()):(this._o.maxDate=D.maxDate,this._o.maxYear=D.maxYear,this._o.maxMonth=D.maxMonth,this._o.endRange=D.endRange),this.draw()},setStartRange:function(b){this._o.startRange=b},setEndRange:function(b){this._o.endRange=b},draw:function(b){if(!(!this._v&&!b)){var d=this._o,m=d.minYear,v=d.maxYear,_=d.minMonth,I=d.maxMonth,H="",K;this._y<=m&&(this._y=m,!isNaN(_)&&this._m<_&&(this._m=_)),this._y>=v&&(this._y=v,!isNaN(I)&&this._m>I&&(this._m=I));for(var W=0;W<d.numberOfMonths;W++)K="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),H+='<div class="pika-lendar">'+Re(this,W,this.calendars[W].year,this.calendars[W].month,this.calendars[0].year,K)+this.render(this.calendars[W].year,this.calendars[W].month,K)+"</div>";this.el.innerHTML=H,d.bound&&d.field.type!=="hidden"&&s(function(){d.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),d.bound&&d.field.setAttribute("aria-label",d.ariaLabel)}},adjustPosition:function(){var b,d,m,v,_,I,H,K,W,Q,J,q;if(!this._o.container){if(this.el.style.position="absolute",b=this._o.trigger,d=b,m=this.el.offsetWidth,v=this.el.offsetHeight,_=window.innerWidth||i.documentElement.clientWidth,I=window.innerHeight||i.documentElement.clientHeight,H=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,J=!0,q=!0,typeof b.getBoundingClientRect=="function")Q=b.getBoundingClientRect(),K=Q.left+window.pageXOffset,W=Q.bottom+window.pageYOffset;else for(K=d.offsetLeft,W=d.offsetTop+d.offsetHeight;d=d.offsetParent;)K+=d.offsetLeft,W+=d.offsetTop;(this._o.reposition&&K+m>_||this._o.position.indexOf("right")>-1&&K-m+b.offsetWidth>0)&&(K=K-m+b.offsetWidth,J=!1),(this._o.reposition&&W+v>I+H||this._o.position.indexOf("top")>-1&&W-v-b.offsetHeight>0)&&(W=W-v-b.offsetHeight,q=!1),this.el.style.left=K+"px",this.el.style.top=W+"px",h(this.el,J?"left-aligned":"right-aligned"),h(this.el,q?"bottom-aligned":"top-aligned"),f(this.el,J?"right-aligned":"left-aligned"),f(this.el,q?"top-aligned":"bottom-aligned")}},render:function(b,d,m){var v=this._o,_=new Date,I=w(b,d),H=new Date(b,d,1).getDay(),K=[],W=[];C(_),v.firstDay>0&&(H-=v.firstDay,H<0&&(H+=7));for(var Q=d===0?11:d-1,J=d===11?0:d+1,q=d===0?b-1:b,fe=d===11?b+1:b,Oe=w(q,Q),xe=I+H,_e=xe;_e>7;)_e-=7;xe+=7-_e;for(var X=!1,Ye=0,Ve=0;Ye<xe;Ye++){var Ee=new Date(b,d,1+(Ye-H)),De=p(this._d)?S(Ee,this._d):!1,be=S(Ee,_),R=v.events.indexOf(Ee.toDateString())!==-1,M=Ye<H||Ye>=I+H,P=1+(Ye-H),B=d,k=b,V=v.startRange&&S(v.startRange,Ee),N=v.endRange&&S(v.endRange,Ee),L=v.startRange&&v.endRange&&v.startRange<Ee&&Ee<v.endRange,Y=v.minDate&&Ee<v.minDate||v.maxDate&&Ee>v.maxDate||v.disableWeekends&&y(Ee)||v.disableDayFn&&v.disableDayFn(Ee);M&&(Ye<H?(P=Oe+P,B=Q,k=q):(P=P-I,B=J,k=fe));var $={day:P,month:B,year:k,hasEvent:R,isSelected:De,isToday:be,isDisabled:Y,isEmpty:M,isStartRange:V,isEndRange:N,isInRange:L,showDaysInNextAndPreviousMonths:v.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:v.enableSelectionDaysInNextAndPreviousMonths};v.pickWholeWeek&&De&&(X=!0),W.push(j($)),++Ve===7&&(v.showWeekNumber&&W.unshift(Z(Ye-H,d,b,v.firstWeekOfYearMinDays)),K.push(re(W,v.isRTL,v.pickWholeWeek,X)),W=[],Ve=0,X=!1)}return Ne(v,K,m)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),f(this.el,"is-hidden"),this._o.bound&&(l(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var b=this._v;b!==!1&&(this._o.bound&&a(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),h(this.el,"is-hidden"),this._v=!1,b!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var b=this._o;this.hide(),a(this.el,"mousedown",this._onMouseDown,!0),a(this.el,"touchend",this._onMouseDown,!0),a(this.el,"change",this._onChange),b.keyboardInput&&a(i,"keydown",this._onKeyChange),b.field&&(a(b.field,"change",this._onInputChange),b.bound&&(a(b.trigger,"click",this._onInputClick),a(b.trigger,"focus",this._onInputFocus),a(b.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Ae})})(iD);var GX=iD.exports;const px=ah(GX),sD="date",wx="dateEditor";class lD extends Al{static get EDITOR_TYPE(){return sD}constructor(e){super(e),this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,this.$datePicker=null}init(){if(typeof ee!="function")throw new Error("You need to include moment.js to your project.");if(typeof px!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.instance.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),te(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),new Dt(this).addEventListener(this.datePicker,"mousedown",n=>n.stopPropagation())}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,o,i,s){super.prepare(e,n,r,o,i,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),r.addShortcut({keys:[["Enter"]],callback:o=>{o.stopPropagation()},group:wx})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(()=>{this.instance._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(wx),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const r=this.originalValue;r!==void 0&&this.setValue(r)}super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.instance.view.isMouseDown(),i=e?Q0(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new px(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+kt(this.TD)}px`;let l=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?l=n.right-ct(this.datePicker):l=n.left,this.datePickerStyle.left=`${l}px`,this.originalValue?(s=this.originalValue,ee(s,r,!0).isValid()&&this.$datePicker.setMoment(ee(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!o&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,ee(s,r,!0).isValid()&&this.$datePicker.setMoment(ee(s,r),!0),!i&&!o&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&xh(n,this.cellProperties.datePickerConfig);const r=n.onSelect,o=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=i=>{let s=i;isNaN(s.getTime())||(s=ee(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),this.hideDatepicker(),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},n}}const KX="dropdown";class sE extends iE{static get EDITOR_TYPE(){return KX}prepare(e,n,r,o,i,s){super.prepare(e,n,r,o,i,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}me.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===sE&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const XX="numeric";class aD extends Al{static get EDITOR_TYPE(){return XX}}const qX="password";class uD extends Al{static get EDITOR_TYPE(){return qX}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,go(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Gw="ht_editor_visible",Cx="selectEditor",QX="select";class cD extends su{static get EDITOR_TYPE(){return QX}init(){this.select=this.hot.rootDocument.createElement("SELECT"),te(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Pe(this.select,Gw)&&ke(this.select,Gw),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,o,i,s){super.prepare(e,n,r,o,i,s);const l=this.cellProperties.selectOptions;let a;typeof l=="function"?a=this.prepareOptions(l(this.row,this.col,this.prop)):a=this.prepareOptions(l),go(this.select),Ue(a,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Ol(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,o=e.length;r<o;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==en.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:o}=this.getEditedCellRect(),i=this.select.style;i.height=`${o}px`,i.width=`${r}px`,i.top=`${e}px`,i[this.hot.isRtl()?"right":"left"]=`${n}px`,i.margin="0px",te(this.select,Gw)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:Cx};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const o=this.select.selectedIndex-1;o>=0&&(this.select[o].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const o=this.select.selectedIndex+1;o<=this.select.length-1&&(this.select[o].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Cx)}}const ZX="time";class hD extends Al{static get EDITOR_TYPE(){return ZX}prepare(e,n,r,o,i,s){super.prepare(e,n,r,o,i,s),this.TEXTAREA.dir="ltr"}}function JX(){or(su),or(iE),or(oD),or(lD),or(sE),or(oE),or(aD),or(uD),or(cD),or(Al),or(hD)}const eq="html";function lE(t,e,n,r,o,i,s){Hh.apply(this,[t,e,n,r,o,i,s]),Ol(e,i??"",!1)}lE.RENDERER_TYPE=eq;const tq="autocomplete";function lu(t,e,n,r,o,i,s){const{rootDocument:l}=t,a=s.allowHtml?lE:ki,u=l.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...ru()),u.appendChild(l.createTextNode(String.fromCharCode(9660))),a.apply(this,[t,e,n,r,o,i,s]),e.firstChild||e.appendChild(l.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),te(e,"htAutocomplete"),c&&e.setAttribute(...L0()),!t.acArrowListener){const h=new Dt(t);t.acArrowListener=function(f){Pe(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}lu.RENDERER_TYPE=tq;const vx=new WeakMap,yx=new WeakMap,nq="htBadValue",Xa="data-row",qa="data-col",rq="checkboxRenderer",dD="checkbox";me.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:o,row:i,column:s,prop:l}=e;if(o===dD){if(r){const{value:a,property:u}=r;let c=n;if(a)c=typeof a=="function"?a(i,s,l,n):a;else if(u){const h=this.getDataAtRowProp(i,u);c=h!==null?h:n}t=c}return t}});function aE(t,e,n,r,o,i,s){const{rootDocument:l}=t,a=t.getSettings().ariaTags;Hh.apply(this,[t,e,n,r,o,i,s]),oq(t);let u=iq(l);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),go(e),i===s.checkedTemplate||Vt(i).toLocaleLowerCase(s.locale)===Vt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:i===s.uncheckedTemplate||Vt(i).toLocaleLowerCase(s.locale)===Vt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:rn(i)?te(u,"noValue"):(u.style.display="none",te(u,nq),h=!0),u.setAttribute(Xa,n),u.setAttribute(qa,r),a&&He(e,[j3(u.checked)]),!h&&c){let y="";if(c.value)y=typeof c.value=="function"?c.value.call(this,n,r,o,i):c.value;else if(c.property){const w=t.getDataAtRowProp(n,c.property);y=w!==null?w:""}const E=sq(l,y,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(E),e.appendChild(u)):(E.appendChild(u),u=E):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(E)):(E.insertBefore(u,E.firstChild),u=E))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(l.createTextNode("#bad-value#")),vx.has(t)||(vx.set(t,!0),f());function f(){const E=t.getShortcutManager().getContext("grid"),w={group:rq};E.addShortcuts([{keys:[["space"]],callback:()=>(g(),!p())},{keys:[["enter"]],callback:()=>(g(),!p()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!p()),relativeToGroup:Jb,position:"before"}],w)}function g(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const E=t.getSelectedRange();if(E)for(let w=0;w<E.length;w++){const{row:C,col:S}=E[w].getTopStartCorner(),{row:T,col:x}=E[w].getBottomEndCorner(),A=[];for(let D=C;D<=T;D+=1)for(let U=S;U<=x;U+=1){const j=t.getCellMeta(D,U);if(j.type!=="checkbox")return;if(j.readOnly===!0)continue;typeof j.checkedTemplate>"u"&&(j.checkedTemplate=!0),typeof j.uncheckedTemplate>"u"&&(j.uncheckedTemplate=!1);const z=t.getDataAtCell(D,U);y===!1?[j.checkedTemplate,j.checkedTemplate.toString()].includes(z)?A.push([D,U,j.uncheckedTemplate]):[j.uncheckedTemplate,j.uncheckedTemplate.toString(),null,void 0].includes(z)&&A.push([D,U,j.checkedTemplate]):A.push([D,U,j.uncheckedTemplate])}A.length>0&&t.setDataAtCell(A)}}function p(){const y=t.getSelectedRange();if(y){for(let E=0;E<y.length;E++){const w=y[E].getTopStartCorner(),C=y[E].getBottomEndCorner();for(let S=w.row;S<=C.row;S++)for(let T=w.col;T<=C.col;T++){const x=t.getCellMeta(S,T);if(x.type!=="checkbox")return!1;const A=t.getCell(S,T);if(A==null)return!0;if(A.querySelectorAll("input[type=checkbox]").length>0&&!x.readOnly)return!0}}return!1}}}aE.RENDERER_TYPE=dD;function oq(t){let e=yx.get(t);if(!e){const{rootElement:n}=t;e=new Dt(t),e.addEventListener(n,"click",r=>aq(r,t)),e.addEventListener(n,"mouseup",r=>lq(r,t)),e.addEventListener(n,"change",r=>uq(r,t)),yx.set(t,e)}return e}function iq(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function sq(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function lq(t,e){const{target:n}=t;uE(n)&&(!n.hasAttribute(Xa)||!n.hasAttribute(qa)||setTimeout(e.listen,10))}function aq(t,e){const{target:n}=t;if(!uE(n)||!n.hasAttribute(Xa)||!n.hasAttribute(qa))return;const r=parseInt(n.getAttribute(Xa),10),o=parseInt(n.getAttribute(qa),10);e.getCellMeta(r,o).readOnly&&t.preventDefault()}function uq(t,e){const{target:n}=t;if(!uE(n)||!n.hasAttribute(Xa)||!n.hasAttribute(qa))return;const r=parseInt(n.getAttribute(Xa),10),o=parseInt(n.getAttribute(qa),10),i=e.getCellMeta(r,o);if(!i.readOnly){let s=null;t.target.checked?s=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:s=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,e.setDataAtCell(r,o,s)}}function uE(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}function Ad(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fD={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,o,i){function s(u,c){if(!o[u]){if(!r[u]){var h=typeof Ad=="function"&&Ad;if(!c&&h)return h(u,!0);if(l)return l(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var g=o[u]={exports:{}};r[u][0].call(g.exports,function(p){return s(r[u][1][p]||p)},g,g.exports,n,r,o,i)}return o[u].exports}for(var l=typeof Ad=="function"&&Ad,a=0;a<i.length;a++)s(i[a]);return s}({1:[function(n,r,o){(function(i){var s,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",f=1e14,g=14,p=9007199254740991,y=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],E=1e7,w=1e9;function C(j){var z=0|j;return 0<j||j===z?z:z-1}function S(j){for(var z,Z,re=1,ne=j.length,ue=j[0]+"";re<ne;){for(z=j[re++]+"",Z=g-z.length;Z--;z="0"+z);ue+=z}for(ne=ue.length;ue.charCodeAt(--ne)===48;);return ue.slice(0,ne+1||1)}function T(j,z){var Z,re,ne=j.c,ue=z.c,Re=j.s,Ne=z.s,Ae=j.e,b=z.e;if(!Re||!Ne)return null;if(Z=ne&&!ne[0],re=ue&&!ue[0],Z||re)return Z?re?0:-Ne:Re;if(Re!=Ne)return Re;if(Z=Re<0,re=Ae==b,!ne||!ue)return re?0:!ne^Z?1:-1;if(!re)return b<Ae^Z?1:-1;for(Ne=(Ae=ne.length)<(b=ue.length)?Ae:b,Re=0;Re<Ne;Re++)if(ne[Re]!=ue[Re])return ne[Re]>ue[Re]^Z?1:-1;return Ae==b?0:b<Ae^Z?1:-1}function x(j,z,Z,re){if(j<z||Z<j||j!==(j<0?a(j):u(j)))throw Error(c+(re||"Argument")+(typeof j=="number"?j<z||Z<j?" out of range: ":" not an integer: ":" not a primitive number: ")+String(j))}function A(j){var z=j.c.length-1;return C(j.e/g)==z&&j.c[z]%2!=0}function D(j,z){return(1<j.length?j.charAt(0)+"."+j.slice(1):j)+(z<0?"e":"e+")+z}function U(j,z,Z){var re,ne;if(z<0){for(ne=Z+".";++z;ne+=Z);j=ne+j}else if(++z>(re=j.length)){for(ne=Z,z-=re;--z;ne+=Z);j+=ne}else z<re&&(j=j.slice(0,z)+"."+j.slice(z));return j}(s=function j(z){var Z,re,ne,ue,Re,Ne,Ae,b,d,m,v=X.prototype={constructor:X,toString:null,valueOf:null},_=new X(1),I=20,H=4,K=-7,W=21,Q=-1e7,J=1e7,q=!1,fe=1,Oe=0,xe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},_e="0123456789abcdefghijklmnopqrstuvwxyz";function X(R,M){var P,B,k,V,N,L,Y,$,G=this;if(!(G instanceof X))return new X(R,M);if(M==null){if(R instanceof X)return G.s=R.s,G.e=R.e,void(G.c=(R=R.c)?R.slice():R);if((L=typeof R=="number")&&0*R==0){if(G.s=1/R<0?(R=-R,-1):1,R===~~R){for(V=0,N=R;10<=N;N/=10,V++);return G.e=V,void(G.c=[R])}$=String(R)}else{if($=String(R),!l.test($))return ne(G,$,L);G.s=$.charCodeAt(0)==45?($=$.slice(1),-1):1}-1<(V=$.indexOf("."))&&($=$.replace(".","")),0<(N=$.search(/e/i))?(V<0&&(V=N),V+=+$.slice(N+1),$=$.substring(0,N)):V<0&&(V=$.length)}else{if(x(M,2,_e.length,"Base"),$=String(R),M==10)return De(G=new X(R instanceof X?R:$),I+G.e+1,H);if(L=typeof R=="number"){if(0*R!=0)return ne(G,$,L,M);if(G.s=1/R<0?($=$.slice(1),-1):1,X.DEBUG&&15<$.replace(/^0\.0*|\./,"").length)throw Error(h+R);L=!1}else G.s=$.charCodeAt(0)===45?($=$.slice(1),-1):1;for(P=_e.slice(0,M),V=N=0,Y=$.length;N<Y;N++)if(P.indexOf(B=$.charAt(N))<0){if(B=="."){if(V<N){V=Y;continue}}else if(!k&&($==$.toUpperCase()&&($=$.toLowerCase())||$==$.toLowerCase()&&($=$.toUpperCase()))){k=!0,N=-1,V=0;continue}return ne(G,String(R),L,M)}-1<(V=($=re($,M,10,G.s)).indexOf("."))?$=$.replace(".",""):V=$.length}for(N=0;$.charCodeAt(N)===48;N++);for(Y=$.length;$.charCodeAt(--Y)===48;);if($=$.slice(N,++Y)){if(Y-=N,L&&X.DEBUG&&15<Y&&(p<R||R!==u(R)))throw Error(h+G.s*R);if(J<(V=V-N-1))G.c=G.e=null;else if(V<Q)G.c=[G.e=0];else{if(G.e=V,G.c=[],N=(V+1)%g,V<0&&(N+=g),N<Y){for(N&&G.c.push(+$.slice(0,N)),Y-=g;N<Y;)G.c.push(+$.slice(N,N+=g));$=$.slice(N),N=g-$.length}else N-=Y;for(;N--;$+="0");G.c.push(+$)}}else G.c=[G.e=0]}function Ye(R,M,P,B){var k,V,N,L,Y;if(P==null?P=H:x(P,0,8),!R.c)return R.toString();if(k=R.c[0],N=R.e,M==null)Y=S(R.c),Y=B==1||B==2&&(N<=K||W<=N)?D(Y,N):U(Y,N,"0");else if(V=(R=De(new X(R),M,P)).e,L=(Y=S(R.c)).length,B==1||B==2&&(M<=V||V<=K)){for(;L<M;Y+="0",L++);Y=D(Y,V)}else if(M-=N,Y=U(Y,V,"0"),L<V+1){if(0<--M)for(Y+=".";M--;Y+="0");}else if(0<(M+=V-L))for(V+1==L&&(Y+=".");M--;Y+="0");return R.s<0&&k?"-"+Y:Y}function Ve(R,M){for(var P,B=1,k=new X(R[0]);B<R.length;B++){if(!(P=new X(R[B])).s){k=P;break}M.call(k,P)&&(k=P)}return k}function Ee(R,M,P){for(var B=1,k=M.length;!M[--k];M.pop());for(k=M[0];10<=k;k/=10,B++);return(P=B+P*g-1)>J?R.c=R.e=null:R.c=P<Q?[R.e=0]:(R.e=P,M),R}function De(R,M,P,B){var k,V,N,L,Y,$,G,le=R.c,ge=y;if(le){e:{for(k=1,L=le[0];10<=L;L/=10,k++);if((V=M-k)<0)V+=g,N=M,G=(Y=le[$=0])/ge[k-N-1]%10|0;else if(($=a((V+1)/g))>=le.length){if(!B)break e;for(;le.length<=$;le.push(0));Y=G=0,N=(V%=g)-g+(k=1)}else{for(Y=L=le[$],k=1;10<=L;L/=10,k++);G=(N=(V%=g)-g+k)<0?0:Y/ge[k-N-1]%10|0}if(B=B||M<0||le[$+1]!=null||(N<0?Y:Y%ge[k-N-1]),B=P<4?(G||B)&&(P==0||P==(R.s<0?3:2)):5<G||G==5&&(P==4||B||P==6&&(0<V?0<N?Y/ge[k-N]:0:le[$-1])%10&1||P==(R.s<0?8:7)),M<1||!le[0])return le.length=0,B?(M-=R.e+1,le[0]=ge[(g-M%g)%g],R.e=-M||0):le[0]=R.e=0,R;if(V==0?(le.length=$,L=1,$--):(le.length=$+1,L=ge[g-V],le[$]=0<N?u(Y/ge[k-N]%ge[N])*L:0),B)for(;;){if($==0){for(V=1,N=le[0];10<=N;N/=10,V++);for(N=le[0]+=L,L=1;10<=N;N/=10,L++);V!=L&&(R.e++,le[0]==f&&(le[0]=1));break}if(le[$]+=L,le[$]!=f)break;le[$--]=0,L=1}for(V=le.length;le[--V]===0;le.pop());}R.e>J?R.c=R.e=null:R.e<Q&&(R.c=[R.e=0])}return R}function be(R){var M,P=R.e;return P===null?R.toString():(M=S(R.c),M=P<=K||W<=P?D(M,P):U(M,P,"0"),R.s<0?"-"+M:M)}return X.clone=j,X.ROUND_UP=0,X.ROUND_DOWN=1,X.ROUND_CEIL=2,X.ROUND_FLOOR=3,X.ROUND_HALF_UP=4,X.ROUND_HALF_DOWN=5,X.ROUND_HALF_EVEN=6,X.ROUND_HALF_CEIL=7,X.ROUND_HALF_FLOOR=8,X.EUCLID=9,X.config=X.set=function(R){var M,P;if(R!=null){if(typeof R!="object")throw Error(c+"Object expected: "+R);if(R.hasOwnProperty(M="DECIMAL_PLACES")&&(x(P=R[M],0,w,M),I=P),R.hasOwnProperty(M="ROUNDING_MODE")&&(x(P=R[M],0,8,M),H=P),R.hasOwnProperty(M="EXPONENTIAL_AT")&&((P=R[M])&&P.pop?(x(P[0],-w,0,M),x(P[1],0,w,M),K=P[0],W=P[1]):(x(P,-w,w,M),K=-(W=P<0?-P:P))),R.hasOwnProperty(M="RANGE"))if((P=R[M])&&P.pop)x(P[0],-w,-1,M),x(P[1],1,w,M),Q=P[0],J=P[1];else{if(x(P,-w,w,M),!P)throw Error(c+M+" cannot be zero: "+P);Q=-(J=P<0?-P:P)}if(R.hasOwnProperty(M="CRYPTO")){if((P=R[M])!==!!P)throw Error(c+M+" not true or false: "+P);if(P){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw q=!P,Error(c+"crypto unavailable");q=P}else q=P}if(R.hasOwnProperty(M="MODULO_MODE")&&(x(P=R[M],0,9,M),fe=P),R.hasOwnProperty(M="POW_PRECISION")&&(x(P=R[M],0,w,M),Oe=P),R.hasOwnProperty(M="FORMAT")){if(typeof(P=R[M])!="object")throw Error(c+M+" not an object: "+P);xe=P}if(R.hasOwnProperty(M="ALPHABET")){if(typeof(P=R[M])!="string"||/^.$|[+-.\s]|(.).*\1/.test(P))throw Error(c+M+" invalid: "+P);_e=P}}return{DECIMAL_PLACES:I,ROUNDING_MODE:H,EXPONENTIAL_AT:[K,W],RANGE:[Q,J],CRYPTO:q,MODULO_MODE:fe,POW_PRECISION:Oe,FORMAT:xe,ALPHABET:_e}},X.isBigNumber=function(R){return R instanceof X||R&&R._isBigNumber===!0||!1},X.maximum=X.max=function(){return Ve(arguments,v.lt)},X.minimum=X.min=function(){return Ve(arguments,v.gt)},X.random=(ue=9007199254740992,Re=Math.random()*ue&2097151?function(){return u(Math.random()*ue)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(R){var M,P,B,k,V,N=0,L=[],Y=new X(_);if(R==null?R=I:x(R,0,w),k=a(R/g),q)if(crypto.getRandomValues){for(M=crypto.getRandomValues(new Uint32Array(k*=2));N<k;)9e15<=(V=131072*M[N]+(M[N+1]>>>11))?(P=crypto.getRandomValues(new Uint32Array(2)),M[N]=P[0],M[N+1]=P[1]):(L.push(V%1e14),N+=2);N=k/2}else{if(!crypto.randomBytes)throw q=!1,Error(c+"crypto unavailable");for(M=crypto.randomBytes(k*=7);N<k;)9e15<=(V=281474976710656*(31&M[N])+1099511627776*M[N+1]+4294967296*M[N+2]+16777216*M[N+3]+(M[N+4]<<16)+(M[N+5]<<8)+M[N+6])?crypto.randomBytes(7).copy(M,N):(L.push(V%1e14),N+=7);N=k/7}if(!q)for(;N<k;)(V=Re())<9e15&&(L[N++]=V%1e14);for(k=L[--N],R%=g,k&&R&&(V=y[g-R],L[N]=u(k/V)*V);L[N]===0;L.pop(),N--);if(N<0)L=[B=0];else{for(B=-1;L[0]===0;L.splice(0,1),B-=g);for(N=1,V=L[0];10<=V;V/=10,N++);N<g&&(B-=g-N)}return Y.e=B,Y.c=L,Y}),X.sum=function(){for(var R=1,M=arguments,P=new X(M[0]);R<M.length;)P=P.plus(M[R++]);return P},re=function(){var R="0123456789";function M(P,B,k,V){for(var N,L,Y=[0],$=0,G=P.length;$<G;){for(L=Y.length;L--;Y[L]*=B);for(Y[0]+=V.indexOf(P.charAt($++)),N=0;N<Y.length;N++)Y[N]>k-1&&(Y[N+1]==null&&(Y[N+1]=0),Y[N+1]+=Y[N]/k|0,Y[N]%=k)}return Y.reverse()}return function(P,B,k,V,N){var L,Y,$,G,le,ge,Se,Ie,Fe=P.indexOf("."),yt=I,Xe=H;for(0<=Fe&&(G=Oe,Oe=0,P=P.replace(".",""),ge=(Ie=new X(B)).pow(P.length-Fe),Oe=G,Ie.c=M(U(S(ge.c),ge.e,"0"),10,k,R),Ie.e=Ie.c.length),$=G=(Se=M(P,B,k,N?(L=_e,R):(L=R,_e))).length;Se[--G]==0;Se.pop());if(!Se[0])return L.charAt(0);if(Fe<0?--$:(ge.c=Se,ge.e=$,ge.s=V,Se=(ge=Z(ge,Ie,yt,Xe,k)).c,le=ge.r,$=ge.e),Fe=Se[Y=$+yt+1],G=k/2,le=le||Y<0||Se[Y+1]!=null,le=Xe<4?(Fe!=null||le)&&(Xe==0||Xe==(ge.s<0?3:2)):G<Fe||Fe==G&&(Xe==4||le||Xe==6&&1&Se[Y-1]||Xe==(ge.s<0?8:7)),Y<1||!Se[0])P=le?U(L.charAt(1),-yt,L.charAt(0)):L.charAt(0);else{if(Se.length=Y,le)for(--k;++Se[--Y]>k;)Se[Y]=0,Y||(++$,Se=[1].concat(Se));for(G=Se.length;!Se[--G];);for(Fe=0,P="";Fe<=G;P+=L.charAt(Se[Fe++]));P=U(P,$,L.charAt(0))}return P}}(),Z=function(){function R(B,k,V){var N,L,Y,$,G=0,le=B.length,ge=k%E,Se=k/E|0;for(B=B.slice();le--;)G=((L=ge*(Y=B[le]%E)+(N=Se*Y+($=B[le]/E|0)*ge)%E*E+G)/V|0)+(N/E|0)+Se*$,B[le]=L%V;return G&&(B=[G].concat(B)),B}function M(B,k,V,N){var L,Y;if(V!=N)Y=N<V?1:-1;else for(L=Y=0;L<V;L++)if(B[L]!=k[L]){Y=B[L]>k[L]?1:-1;break}return Y}function P(B,k,V,N){for(var L=0;V--;)B[V]-=L,L=B[V]<k[V]?1:0,B[V]=L*N+B[V]-k[V];for(;!B[0]&&1<B.length;B.splice(0,1));}return function(B,k,V,N,L){var Y,$,G,le,ge,Se,Ie,Fe,yt,Xe,at,It,kl,uu,zt,mn,Hs,Fn=B.s==k.s?1:-1,on=B.c,Rt=k.c;if(!(on&&on[0]&&Rt&&Rt[0]))return new X(B.s&&k.s&&(on?!Rt||on[0]!=Rt[0]:Rt)?on&&on[0]==0||!Rt?0*Fn:Fn/0:NaN);for(yt=(Fe=new X(Fn)).c=[],Fn=V+($=B.e-k.e)+1,L||(L=f,$=C(B.e/g)-C(k.e/g),Fn=Fn/g|0),G=0;Rt[G]==(on[G]||0);G++);if(Rt[G]>(on[G]||0)&&$--,Fn<0)yt.push(1),le=!0;else{for(uu=on.length,mn=Rt.length,Fn+=2,1<(ge=u(L/(Rt[G=0]+1)))&&(Rt=R(Rt,ge,L),on=R(on,ge,L),mn=Rt.length,uu=on.length),kl=mn,at=(Xe=on.slice(0,mn)).length;at<mn;Xe[at++]=0);Hs=Rt.slice(),Hs=[0].concat(Hs),zt=Rt[0],Rt[1]>=L/2&&zt++;do{if(ge=0,(Y=M(Rt,Xe,mn,at))<0){if(It=Xe[0],mn!=at&&(It=It*L+(Xe[1]||0)),1<(ge=u(It/zt)))for(L<=ge&&(ge=L-1),Ie=(Se=R(Rt,ge,L)).length,at=Xe.length;M(Se,Xe,Ie,at)==1;)ge--,P(Se,mn<Ie?Hs:Rt,Ie,L),Ie=Se.length,Y=1;else ge==0&&(Y=ge=1),Ie=(Se=Rt.slice()).length;if(Ie<at&&(Se=[0].concat(Se)),P(Xe,Se,at,L),at=Xe.length,Y==-1)for(;M(Rt,Xe,mn,at)<1;)ge++,P(Xe,mn<at?Hs:Rt,at,L),at=Xe.length}else Y===0&&(ge++,Xe=[0]);yt[G++]=ge,Xe[0]?Xe[at++]=on[kl]||0:(Xe=[on[kl]],at=1)}while((kl++<uu||Xe[0]!=null)&&Fn--);le=Xe[0]!=null,yt[0]||yt.splice(0,1)}if(L==f){for(G=1,Fn=yt[0];10<=Fn;Fn/=10,G++);De(Fe,V+(Fe.e=G+$*g-1)+1,N,le)}else Fe.e=$,Fe.r=+le;return Fe}}(),Ne=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ae=/^([^.]+)\.$/,b=/^\.([^.]+)$/,d=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ne=function(R,M,P,B){var k,V=P?M:M.replace(m,"");if(d.test(V))R.s=isNaN(V)?null:V<0?-1:1,R.c=R.e=null;else{if(!P&&(V=V.replace(Ne,function(N,L,Y){return k=(Y=Y.toLowerCase())=="x"?16:Y=="b"?2:8,B&&B!=k?N:L}),B&&(k=B,V=V.replace(Ae,"$1").replace(b,"0.$1")),M!=V))return new X(V,k);if(X.DEBUG)throw Error(c+"Not a"+(B?" base "+B:"")+" number: "+M);R.c=R.e=R.s=null}},v.absoluteValue=v.abs=function(){var R=new X(this);return R.s<0&&(R.s=1),R},v.comparedTo=function(R,M){return T(this,new X(R,M))},v.decimalPlaces=v.dp=function(R,M){var P,B,k;if(R!=null)return x(R,0,w),M==null?M=H:x(M,0,8),De(new X(this),R+this.e+1,M);if(!(P=this.c))return null;if(B=((k=P.length-1)-C(this.e/g))*g,k=P[k])for(;k%10==0;k/=10,B--);return B<0&&(B=0),B},v.dividedBy=v.div=function(R,M){return Z(this,new X(R,M),I,H)},v.dividedToIntegerBy=v.idiv=function(R,M){return Z(this,new X(R,M),0,1)},v.exponentiatedBy=v.pow=function(R,M){var P,B,k,V,N,L,Y,$,G=this;if((R=new X(R)).c&&!R.isInteger())throw Error(c+"Exponent not an integer: "+be(R));if(M!=null&&(M=new X(M)),N=14<R.e,!G.c||!G.c[0]||G.c[0]==1&&!G.e&&G.c.length==1||!R.c||!R.c[0])return $=new X(Math.pow(+be(G),N?2-A(R):+be(R))),M?$.mod(M):$;if(L=R.s<0,M){if(M.c?!M.c[0]:!M.s)return new X(NaN);(B=!L&&G.isInteger()&&M.isInteger())&&(G=G.mod(M))}else{if(9<R.e&&(0<G.e||G.e<-1||(G.e==0?1<G.c[0]||N&&24e7<=G.c[1]:G.c[0]<8e13||N&&G.c[0]<=9999975e7)))return V=G.s<0&&A(R)?-0:0,-1<G.e&&(V=1/V),new X(L?1/V:V);Oe&&(V=a(Oe/g+2))}for(Y=N?(P=new X(.5),L&&(R.s=1),A(R)):(k=Math.abs(+be(R)))%2,$=new X(_);;){if(Y){if(!($=$.times(G)).c)break;V?$.c.length>V&&($.c.length=V):B&&($=$.mod(M))}if(k){if((k=u(k/2))===0)break;Y=k%2}else if(De(R=R.times(P),R.e+1,1),14<R.e)Y=A(R);else{if((k=+be(R))==0)break;Y=k%2}G=G.times(G),V?G.c&&G.c.length>V&&(G.c.length=V):B&&(G=G.mod(M))}return B?$:(L&&($=_.div($)),M?$.mod(M):V?De($,Oe,H,void 0):$)},v.integerValue=function(R){var M=new X(this);return R==null?R=H:x(R,0,8),De(M,M.e+1,R)},v.isEqualTo=v.eq=function(R,M){return T(this,new X(R,M))===0},v.isFinite=function(){return!!this.c},v.isGreaterThan=v.gt=function(R,M){return 0<T(this,new X(R,M))},v.isGreaterThanOrEqualTo=v.gte=function(R,M){return(M=T(this,new X(R,M)))===1||M===0},v.isInteger=function(){return!!this.c&&C(this.e/g)>this.c.length-2},v.isLessThan=v.lt=function(R,M){return T(this,new X(R,M))<0},v.isLessThanOrEqualTo=v.lte=function(R,M){return(M=T(this,new X(R,M)))===-1||M===0},v.isNaN=function(){return!this.s},v.isNegative=function(){return this.s<0},v.isPositive=function(){return 0<this.s},v.isZero=function(){return!!this.c&&this.c[0]==0},v.minus=function(R,M){var P,B,k,V,N=this,L=N.s;if(M=(R=new X(R,M)).s,!L||!M)return new X(NaN);if(L!=M)return R.s=-M,N.plus(R);var Y=N.e/g,$=R.e/g,G=N.c,le=R.c;if(!Y||!$){if(!G||!le)return G?(R.s=-M,R):new X(le?N:NaN);if(!G[0]||!le[0])return le[0]?(R.s=-M,R):new X(G[0]?N:H==3?-0:0)}if(Y=C(Y),$=C($),G=G.slice(),L=Y-$){for((k=(V=L<0)?(L=-L,G):($=Y,le)).reverse(),M=L;M--;k.push(0));k.reverse()}else for(B=(V=(L=G.length)<(M=le.length))?L:M,L=M=0;M<B;M++)if(G[M]!=le[M]){V=G[M]<le[M];break}if(V&&(k=G,G=le,le=k,R.s=-R.s),0<(M=(B=le.length)-(P=G.length)))for(;M--;G[P++]=0);for(M=f-1;L<B;){if(G[--B]<le[B]){for(P=B;P&&!G[--P];G[P]=M);--G[P],G[B]+=f}G[B]-=le[B]}for(;G[0]==0;G.splice(0,1),--$);return G[0]?Ee(R,G,$):(R.s=H==3?-1:1,R.c=[R.e=0],R)},v.modulo=v.mod=function(R,M){var P,B,k=this;return R=new X(R,M),!k.c||!R.s||R.c&&!R.c[0]?new X(NaN):!R.c||k.c&&!k.c[0]?new X(k):(fe==9?(B=R.s,R.s=1,P=Z(k,R,0,3),R.s=B,P.s*=B):P=Z(k,R,0,fe),(R=k.minus(P.times(R))).c[0]||fe!=1||(R.s=k.s),R)},v.multipliedBy=v.times=function(R,M){var P,B,k,V,N,L,Y,$,G,le,ge,Se,Ie,Fe,yt,Xe=this,at=Xe.c,It=(R=new X(R,M)).c;if(!(at&&It&&at[0]&&It[0]))return!Xe.s||!R.s||at&&!at[0]&&!It||It&&!It[0]&&!at?R.c=R.e=R.s=null:(R.s*=Xe.s,at&&It?(R.c=[0],R.e=0):R.c=R.e=null),R;for(B=C(Xe.e/g)+C(R.e/g),R.s*=Xe.s,(Y=at.length)<(le=It.length)&&(Ie=at,at=It,It=Ie,k=Y,Y=le,le=k),k=Y+le,Ie=[];k--;Ie.push(0));for(Fe=f,yt=E,k=le;0<=--k;){for(P=0,ge=It[k]%yt,Se=It[k]/yt|0,V=k+(N=Y);k<V;)P=(($=ge*($=at[--N]%yt)+(L=Se*$+(G=at[N]/yt|0)*ge)%yt*yt+Ie[V]+P)/Fe|0)+(L/yt|0)+Se*G,Ie[V--]=$%Fe;Ie[V]=P}return P?++B:Ie.splice(0,1),Ee(R,Ie,B)},v.negated=function(){var R=new X(this);return R.s=-R.s||null,R},v.plus=function(R,M){var P,B=this,k=B.s;if(M=(R=new X(R,M)).s,!k||!M)return new X(NaN);if(k!=M)return R.s=-M,B.minus(R);var V=B.e/g,N=R.e/g,L=B.c,Y=R.c;if(!V||!N){if(!L||!Y)return new X(k/0);if(!L[0]||!Y[0])return Y[0]?R:new X(L[0]?B:0*k)}if(V=C(V),N=C(N),L=L.slice(),k=V-N){for((P=0<k?(N=V,Y):(k=-k,L)).reverse();k--;P.push(0));P.reverse()}for((k=L.length)-(M=Y.length)<0&&(P=Y,Y=L,L=P,M=k),k=0;M;)k=(L[--M]=L[M]+Y[M]+k)/f|0,L[M]=f===L[M]?0:L[M]%f;return k&&(L=[k].concat(L),++N),Ee(R,L,N)},v.precision=v.sd=function(R,M){var P,B,k;if(R!=null&&R!==!!R)return x(R,1,w),M==null?M=H:x(M,0,8),De(new X(this),R,M);if(!(P=this.c))return null;if(B=(k=P.length-1)*g+1,k=P[k]){for(;k%10==0;k/=10,B--);for(k=P[0];10<=k;k/=10,B++);}return R&&this.e+1>B&&(B=this.e+1),B},v.shiftedBy=function(R){return x(R,-p,p),this.times("1e"+R)},v.squareRoot=v.sqrt=function(){var R,M,P,B,k,V=this,N=V.c,L=V.s,Y=V.e,$=I+4,G=new X("0.5");if(L!==1||!N||!N[0])return new X(!L||L<0&&(!N||N[0])?NaN:N?V:1/0);if((P=(L=Math.sqrt(+be(V)))==0||L==1/0?(((M=S(N)).length+Y)%2==0&&(M+="0"),L=Math.sqrt(+M),Y=C((Y+1)/2)-(Y<0||Y%2),new X(M=L==1/0?"1e"+Y:(M=L.toExponential()).slice(0,M.indexOf("e")+1)+Y)):new X(L+"")).c[0]){for((L=(Y=P.e)+$)<3&&(L=0);;)if(k=P,P=G.times(k.plus(Z(V,k,$,1))),S(k.c).slice(0,L)===(M=S(P.c)).slice(0,L)){if(P.e<Y&&--L,(M=M.slice(L-3,L+1))!="9999"&&(B||M!="4999")){+M&&(+M.slice(1)||M.charAt(0)!="5")||(De(P,P.e+I+2,1),R=!P.times(P).eq(V));break}if(!B&&(De(k,k.e+I+2,0),k.times(k).eq(V))){P=k;break}$+=4,L+=4,B=1}}return De(P,P.e+I+1,H,R)},v.toExponential=function(R,M){return R!=null&&(x(R,0,w),R++),Ye(this,R,M,1)},v.toFixed=function(R,M){return R!=null&&(x(R,0,w),R=R+this.e+1),Ye(this,R,M)},v.toFormat=function(R,M,P){var B;if(P==null)R!=null&&M&&typeof M=="object"?(P=M,M=null):R&&typeof R=="object"?(P=R,R=M=null):P=xe;else if(typeof P!="object")throw Error(c+"Argument not an object: "+P);if(B=this.toFixed(R,M),this.c){var k,V=B.split("."),N=+P.groupSize,L=+P.secondaryGroupSize,Y=P.groupSeparator||"",$=V[0],G=V[1],le=this.s<0,ge=le?$.slice(1):$,Se=ge.length;if(L&&(k=N,N=L,Se-=L=k),0<N&&0<Se){for(k=Se%N||N,$=ge.substr(0,k);k<Se;k+=N)$+=Y+ge.substr(k,N);0<L&&($+=Y+ge.slice(k)),le&&($="-"+$)}B=G?$+(P.decimalSeparator||"")+((L=+P.fractionGroupSize)?G.replace(new RegExp("\\d{"+L+"}\\B","g"),"$&"+(P.fractionGroupSeparator||"")):G):$}return(P.prefix||"")+B+(P.suffix||"")},v.toFraction=function(R){var M,P,B,k,V,N,L,Y,$,G,le,ge,Se=this,Ie=Se.c;if(R!=null&&(!(L=new X(R)).isInteger()&&(L.c||L.s!==1)||L.lt(_)))throw Error(c+"Argument "+(L.isInteger()?"out of range: ":"not an integer: ")+be(L));if(!Ie)return new X(Se);for(M=new X(_),$=P=new X(_),B=Y=new X(_),ge=S(Ie),V=M.e=ge.length-Se.e-1,M.c[0]=y[(N=V%g)<0?g+N:N],R=!R||0<L.comparedTo(M)?0<V?M:$:L,N=J,J=1/0,L=new X(ge),Y.c[0]=0;G=Z(L,M,0,1),(k=P.plus(G.times(B))).comparedTo(R)!=1;)P=B,B=k,$=Y.plus(G.times(k=$)),Y=k,M=L.minus(G.times(k=M)),L=k;return k=Z(R.minus(P),B,0,1),Y=Y.plus(k.times($)),P=P.plus(k.times(B)),Y.s=$.s=Se.s,le=Z($,B,V*=2,H).minus(Se).abs().comparedTo(Z(Y,P,V,H).minus(Se).abs())<1?[$,B]:[Y,P],J=N,le},v.toNumber=function(){return+be(this)},v.toPrecision=function(R,M){return R!=null&&x(R,1,w),Ye(this,R,M,2)},v.toString=function(R){var M,P=this,B=P.s,k=P.e;return k===null?B?(M="Infinity",B<0&&(M="-"+M)):M="NaN":(M=R==null?k<=K||W<=k?D(S(P.c),k):U(S(P.c),k,"0"):R===10?U(S((P=De(new X(P),I+k+1,H)).c),P.e,"0"):(x(R,2,_e.length,"Base"),re(U(S(P.c),k,"0"),10,R,B,!0)),B<0&&P.c[0]&&(M="-"+M)),M},v.valueOf=v.toJSON=function(){return be(this)},v._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(v[Symbol.toStringTag]="BigNumber",v[Symbol.for("nodejs.util.inspect.custom")]=v.valueOf),z!=null&&X.set(z),X}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=s)})(this)},{}],2:[function(n,r,o){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var s=i%10;return~~(i%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,o){function i(C,S){return function(T){if(Array.isArray(T))return T}(C)||function(T,x){var A=[],D=!0,U=!1,j=void 0;try{for(var z,Z=T[Symbol.iterator]();!(D=(z=Z.next()).done)&&(A.push(z.value),!x||A.length!==x);D=!0);}catch(re){U=!0,j=re}finally{try{D||Z.return==null||Z.return()}finally{if(U)throw j}}return A}(C,S)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),l=n("./validating"),a=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function f(C){var S=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},T=2<arguments.length?arguments[2]:void 0;if(typeof S=="string"&&(S=a.parseFormat(S)),!l.validateFormat(S))return"ERROR: invalid format";var x=S.prefix||"",A=S.postfix||"",D=function(U,j,z){switch(j.output){case"currency":return j=w(j,s.currentCurrencyDefaultFormat()),function(_e,X,Ye){var Ve=Ye.currentCurrency(),Ee=Object.assign({},h,X),De=void 0,be="",R=!!Ee.totalLength||!!Ee.forceAverage||Ee.average,M=X.currencyPosition||Ve.position,P=X.currencySymbol||Ve.symbol;Ee.spaceSeparated&&(be=" "),M==="infix"&&(De=be+P+be);var B=E({instance:_e,providedFormat:X,state:Ye,decimalSeparator:De});return M==="prefix"&&(B=_e._value<0&&Ee.negative==="sign"?"-".concat(be).concat(P).concat(B.slice(1)):P+be+B),M&&M!=="postfix"||(B=B+(be=R?"":be)+P),B}(U,j,s);case"percent":return j=w(j,s.currentPercentageDefaultFormat()),function(_e,X,Ye,Ve){var Ee=X.prefixSymbol,De=E({instance:Ve(100*_e._value),providedFormat:X,state:Ye}),be=Object.assign({},h,X);return Ee?"%".concat(be.spaceSeparated?" ":"").concat(De):"".concat(De).concat(be.spaceSeparated?" ":"","%")}(U,j,s,z);case"byte":return j=w(j,s.currentByteDefaultFormat()),_=U,H=s,K=z,W=(I=j).base||"binary",Q=c[W],J=g(_._value,Q.suffixes,Q.scale),q=J.value,fe=J.suffix,Oe=E({instance:K(q),providedFormat:I,state:H,defaults:H.currentByteDefaultFormat()}),xe=H.currentAbbreviations(),"".concat(Oe).concat(xe.spaced?" ":"").concat(fe);case"time":return j=w(j,s.currentTimeDefaultFormat()),b=U,d=Math.floor(b._value/60/60),m=Math.floor((b._value-60*d*60)/60),v=Math.round(b._value-60*d*60-60*m),"".concat(d,":").concat(m<10?"0":"").concat(m,":").concat(v<10?"0":"").concat(v);case"ordinal":return j=w(j,s.currentOrdinalDefaultFormat()),Z=U,re=j,ue=(ne=s).currentOrdinal(),Re=Object.assign({},h,re),Ne=E({instance:Z,providedFormat:re,state:ne}),Ae=ue(Z._value),"".concat(Ne).concat(Re.spaceSeparated?" ":"").concat(Ae);case"number":default:return E({instance:U,providedFormat:j,numbro:z})}var Z,re,ne,ue,Re,Ne,Ae,b,d,m,v,_,I,H,K,W,Q,J,q,fe,Oe,xe}(C,S,T);return D=(D=x+D)+A}function g(C,S,T){var x=S[0],A=Math.abs(C);if(T<=A){for(var D=1;D<S.length;++D){var U=Math.pow(T,D),j=Math.pow(T,D+1);if(U<=A&&A<j){x=S[D],C/=U;break}}x===S[0]&&(C/=Math.pow(T,S.length-1),x=S[S.length-1])}return{value:C,suffix:x}}function p(C){for(var S="",T=0;T<C;T++)S+="0";return S}function y(C,S){return C.toString().indexOf("e")!==-1?function(T,x){var A=T.toString(),D=i(A.split("e"),2),U=D[0],j=D[1],z=i(U.split("."),2),Z=z[0],re=z[1],ne=re===void 0?"":re;if(0<+j)A=Z+ne+p(j-ne.length);else{var ue=".";ue=+Z<0?"-0".concat(ue):"0".concat(ue);var Re=(p(-j-1)+Math.abs(Z)+ne).substr(0,x);Re.length<x&&(Re+=p(x-Re.length)),A=ue+Re}return 0<+j&&0<x&&(A+=".".concat(p(x))),A}(C,S):(Math.round(+"".concat(C,"e+").concat(S))/Math.pow(10,S)).toFixed(S)}function E(C){var S=C.instance,T=C.providedFormat,x=C.state,A=x===void 0?s:x,D=C.decimalSeparator,U=C.defaults,j=U===void 0?A.currentDefaults():U,z=S._value;if(z===0&&A.hasZeroFormat())return A.getZeroFormat();if(!isFinite(z))return z.toString();var Z,re,ne,ue,Re,Ne,Ae,b,d=Object.assign({},h,j,T),m=d.totalLength,v=m?0:d.characteristic,_=d.optionalCharacteristic,I=d.forceAverage,H=!!m||!!I||d.average,K=m?-1:H&&T.mantissa===void 0?0:d.mantissa,W=!m&&(T.optionalMantissa===void 0?K===-1:d.optionalMantissa),Q=d.trimMantissa,J=d.thousandSeparated,q=d.spaceSeparated,fe=d.negative,Oe=d.forceSign,xe=d.exponential,_e="";if(H){var X=function(R){var M=R.value,P=R.forceAverage,B=R.abbreviations,k=R.spaceSeparated,V=k!==void 0&&k,N=R.totalLength,L=N===void 0?0:N,Y="",$=Math.abs(M),G=-1;if($>=Math.pow(10,12)&&!P||P==="trillion"?(Y=B.trillion,M/=Math.pow(10,12)):$<Math.pow(10,12)&&$>=Math.pow(10,9)&&!P||P==="billion"?(Y=B.billion,M/=Math.pow(10,9)):$<Math.pow(10,9)&&$>=Math.pow(10,6)&&!P||P==="million"?(Y=B.million,M/=Math.pow(10,6)):($<Math.pow(10,6)&&$>=Math.pow(10,3)&&!P||P==="thousand")&&(Y=B.thousand,M/=Math.pow(10,3)),Y&&(Y=(V?" ":"")+Y),L){var le=M.toString().split(".")[0];G=Math.max(L-le.length,0)}return{value:M,abbreviation:Y,mantissaPrecision:G}}({value:z,forceAverage:I,abbreviations:A.currentAbbreviations(),spaceSeparated:q,totalLength:m});z=X.value,_e+=X.abbreviation,m&&(K=X.mantissaPrecision)}if(xe){var Ye=(re=(Z={value:z,characteristicPrecision:v}).value,ne=Z.characteristicPrecision,ue=ne===void 0?0:ne,Re=i(re.toExponential().split("e"),2),Ne=Re[0],Ae=Re[1],b=+Ne,ue&&1<ue&&(b*=Math.pow(10,ue-1),Ae=0<=(Ae=+Ae-(ue-1))?"+".concat(Ae):Ae),{value:b,abbreviation:"e".concat(Ae)});z=Ye.value,_e=Ye.abbreviation+_e}var Ve,Ee,De,be=function(R,M,P,B,k){if(B===-1)return R;var V=y(M,B),N=i(V.toString().split("."),2),L=N[0],Y=N[1],$=Y===void 0?"":Y;if($.match(/^0+$/)&&(P||k))return L;var G=$.match(/0+$/);return k&&G?"".concat(L,".").concat($.toString().slice(0,G.index)):V.toString()}(z.toString(),z,W,K,Q);return be=function(R,M,P,B,k){var V=B.currentDelimiters(),N=V.thousands;k=k||V.decimal;var L=V.thousandsSize||3,Y=R.toString(),$=Y.split(".")[0],G=Y.split(".")[1];return P&&(M<0&&($=$.slice(1)),function(le,ge){for(var Se=[],Ie=0,Fe=le;0<Fe;Fe--)Ie===ge&&(Se.unshift(Fe),Ie=0),Ie++;return Se}($.length,L).forEach(function(le,ge){$=$.slice(0,le+ge)+N+$.slice(le+ge)}),M<0&&($="-".concat($))),Y=G?$+k+G:$}(be=function(R,M,P,B){var k=R,V=i(k.toString().split("."),2),N=V[0],L=V[1];if(N.match(/^-?0$/)&&P)return L?"".concat(N.replace("0",""),".").concat(L):N.replace("0","");if(N.length<B)for(var Y=B-N.length,$=0;$<Y;$++)k="0".concat(k);return k.toString()}(be,0,_,v),z,J,A,D),(H||xe)&&(be=be+_e),(Oe||z<0)&&(Ve=be,De=fe,be=(Ee=z)===0?Ve:+Ve==0?Ve.replace("-",""):0<Ee?"+".concat(Ve):De==="sign"?Ve:"(".concat(Ve.replace("-",""),")")),be}function w(C,S){if(!C)return S;var T=Object.keys(C);return T.length===1&&T[0]==="output"?S:C}r.exports=function(C){return{format:function(){for(var S=arguments.length,T=new Array(S),x=0;x<S;x++)T[x]=arguments[x];return f.apply(void 0,T.concat([C]))},getByteUnit:function(){for(var S=arguments.length,T=new Array(S),x=0;x<S;x++)T[x]=arguments[x];return(function(A){var D=c.general;return g(A._value,D.suffixes,D.scale).suffix}).apply(void 0,T.concat([C]))},getBinaryByteUnit:function(){for(var S=arguments.length,T=new Array(S),x=0;x<S;x++)T[x]=arguments[x];return(function(A){var D=c.binary;return g(A._value,D.suffixes,D.scale).suffix}).apply(void 0,T.concat([C]))},getDecimalByteUnit:function(){for(var S=arguments.length,T=new Array(S),x=0;x<S;x++)T[x]=arguments[x];return(function(A){var D=c.decimal;return g(A._value,D.suffixes,D.scale).suffix}).apply(void 0,T.concat([C]))},formatOrDefault:w}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,o){var i=n("./en-US"),s=n("./validating"),l=n("./parsing"),a={},u=void 0,c={},h=null,f={};function g(y){u=y}function p(){return c[u]}a.languages=function(){return Object.assign({},c)},a.currentLanguage=function(){return u},a.currentCurrency=function(){return p().currency},a.currentAbbreviations=function(){return p().abbreviations},a.currentDelimiters=function(){return p().delimiters},a.currentOrdinal=function(){return p().ordinal},a.currentDefaults=function(){return Object.assign({},p().defaults,f)},a.currentOrdinalDefaultFormat=function(){return Object.assign({},a.currentDefaults(),p().ordinalFormat)},a.currentByteDefaultFormat=function(){return Object.assign({},a.currentDefaults(),p().byteFormat)},a.currentPercentageDefaultFormat=function(){return Object.assign({},a.currentDefaults(),p().percentageFormat)},a.currentCurrencyDefaultFormat=function(){return Object.assign({},a.currentDefaults(),p().currencyFormat)},a.currentTimeDefaultFormat=function(){return Object.assign({},a.currentDefaults(),p().timeFormat)},a.setDefaults=function(y){y=l.parseFormat(y),s.validateFormat(y)&&(f=y)},a.getZeroFormat=function(){return h},a.setZeroFormat=function(y){return h=typeof y=="string"?y:null},a.hasZeroFormat=function(){return h!==null},a.languageData=function(y){if(y){if(c[y])return c[y];throw new Error('Unknown tag "'.concat(y,'"'))}return p()},a.registerLanguage=function(y){var E=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(y))throw new Error("Invalid language data");c[y.languageTag]=y,E&&g(y.languageTag)},a.setLanguage=function(y){var E=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!c[y]){var w=y.split("-")[0],C=Object.keys(c).find(function(S){return S.split("-")[0]===w});return c[C]?void g(C):void g(E)}g(y)},a.registerLanguage(i),u=i.languageTag,r.exports=a},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,o){r.exports=function(i){return{loadLanguagesInNode:function(s){return l=i,void s.forEach(function(a){var u=void 0;try{u=n("../languages/".concat(a))}catch{console.error('Unable to load "'.concat(a,'". No matching language file found.'))}u&&l.registerLanguage(u)});var l}}}},{}],6:[function(n,r,o){var i=n("bignumber.js");function s(l,a,u){var c=new i(l._value),h=a;return u.isNumbro(a)&&(h=a._value),h=new i(h),l._value=c.minus(h).toNumber(),l}r.exports=function(l){return{add:function(a,u){return h=u,f=l,g=new i((c=a)._value),p=h,f.isNumbro(h)&&(p=h._value),p=new i(p),c._value=g.plus(p).toNumber(),c;var c,h,f,g,p},subtract:function(a,u){return s(a,u,l)},multiply:function(a,u){return h=u,f=l,g=new i((c=a)._value),p=h,f.isNumbro(h)&&(p=h._value),p=new i(p),c._value=g.times(p).toNumber(),c;var c,h,f,g,p},divide:function(a,u){return h=u,f=l,g=new i((c=a)._value),p=h,f.isNumbro(h)&&(p=h._value),p=new i(p),c._value=g.dividedBy(p).toNumber(),c;var c,h,f,g,p},set:function(a,u){return c=a,f=h=u,l.isNumbro(h)&&(f=h._value),c._value=f,c;var c,h,f},difference:function(a,u){return c=u,s(f=(h=l)(a._value),c,h),Math.abs(f._value);var c,h,f}}}},{"bignumber.js":1}],7:[function(n,r,o){function i(E,w){for(var C=0;C<w.length;C++){var S=w[C];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(E,S.key,S)}}var s=n("./globalState"),l=n("./validating"),a=n("./loading")(y),u=n("./unformatting"),c=n("./formatting")(y),h=n("./manipulating")(y),f=n("./parsing"),g=function(){function E(S){(function(T,x){if(!(T instanceof x))throw new TypeError("Cannot call a class as a function")})(this,E),this._value=S}var w,C;return w=E,(C=[{key:"clone",value:function(){return y(this._value)}},{key:"format",value:function(){var S=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,S)}},{key:"formatCurrency",value:function(S){return typeof S=="string"&&(S=f.parseFormat(S)),(S=c.formatOrDefault(S,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,S)}},{key:"formatTime",value:function(){var S=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return S.output="time",c.format(this,S)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(S){return h.difference(this,S)}},{key:"add",value:function(S){return h.add(this,S)}},{key:"subtract",value:function(S){return h.subtract(this,S)}},{key:"multiply",value:function(S){return h.multiply(this,S)}},{key:"divide",value:function(S){return h.divide(this,S)}},{key:"set",value:function(S){return h.set(this,p(S))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(w.prototype,C),E}();function p(E){var w=E;return y.isNumbro(E)?w=E._value:typeof E=="string"?w=y.unformat(E):isNaN(E)&&(w=NaN),w}function y(E){return new g(p(E))}y.version="2.1.2",y.isNumbro=function(E){return E instanceof g},y.language=s.currentLanguage,y.registerLanguage=s.registerLanguage,y.setLanguage=s.setLanguage,y.languages=s.languages,y.languageData=s.languageData,y.zeroFormat=s.setZeroFormat,y.defaultFormat=s.currentDefaults,y.setDefaults=s.setDefaults,y.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,y.validate=l.validate,y.loadLanguagesInNode=a.loadLanguagesInNode,y.unformat=u.unformat,r.exports=y},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,o){r.exports={parseFormat:function(i){var s,l,a,u,c,h,f,g,p,y,E,w,C,S,T,x,A,D,U,j,z=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(l=z,i=(a=(s=i).match(/^{([^}]*)}/))?(l.prefix=a[1],s.slice(a[0].length)):s,c=z,function(Z,re){if(Z.indexOf("$")===-1){if(Z.indexOf("%")===-1)return Z.indexOf("bd")!==-1?(re.output="byte",re.base="general"):Z.indexOf("b")!==-1?(re.output="byte",re.base="binary"):Z.indexOf("d")!==-1?(re.output="byte",re.base="decimal"):Z.indexOf(":")===-1?Z.indexOf("o")!==-1&&(re.output="ordinal"):re.output="time";re.output="percent"}else re.output="currency"}(i=(h=(u=i).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,z),f=z,(g=i.match(/[1-9]+[0-9]*/))&&(f.totalLength=+g[0]),p=z,(y=i.split(".")[0].match(/0+/))&&(p.characteristic=y[0].length),function(Z,re){if(Z.indexOf(".")!==-1){var ne=Z.split(".")[0];re.optionalCharacteristic=ne.indexOf("0")===-1}}(i,z),E=z,i.indexOf("a")!==-1&&(E.average=!0),C=z,(w=i).indexOf("K")!==-1?C.forceAverage="thousand":w.indexOf("M")!==-1?C.forceAverage="million":w.indexOf("B")!==-1?C.forceAverage="billion":w.indexOf("T")!==-1&&(C.forceAverage="trillion"),function(Z,re){var ne=Z.split(".")[1];if(ne){var ue=ne.match(/0+/);ue&&(re.mantissa=ue[0].length)}}(i,z),T=z,(S=i).match(/\[\.]/)?T.optionalMantissa=!0:S.match(/\./)&&(T.optionalMantissa=!1),x=z,i.indexOf(",")!==-1&&(x.thousandSeparated=!0),A=z,i.indexOf(" ")!==-1&&(A.spaceSeparated=!0),U=z,(D=i).match(/^\+?\([^)]*\)$/)&&(U.negative="parenthesis"),D.match(/^\+?-/)&&(U.negative="sign"),j=z,i.match(/^\+/)&&(j.forceSign=!0),z)}}},{}],9:[function(n,r,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(a){return a.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function l(a,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length?arguments[5]:void 0,p=6<arguments.length?arguments[6]:void 0;if(a!=="")return a===f?0:function y(E,w){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=3<arguments.length?arguments[3]:void 0,T=4<arguments.length?arguments[4]:void 0,x=5<arguments.length?arguments[5]:void 0,A=6<arguments.length?arguments[6]:void 0;if(!isNaN(+E))return+E;var D="",U=E.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(U!==E)return-1*y(U,w,C,S,T,x,A);for(var j=0;j<i.length;j++){var z=i[j];if((D=E.replace(z.key,""))!==E)return y(D,w,C,S,T,x,A)*z.factor}if((D=E.replace("%",""))!==E)return y(D,w,C,S,T,x,A)/100;var Z=parseFloat(E);if(!isNaN(Z)){var re=S(Z);if(re&&re!=="."&&(D=E.replace(new RegExp("".concat(s(re),"$")),""))!==E)return y(D,w,C,S,T,x,A);var ne={};Object.keys(x).forEach(function(m){ne[x[m]]=m});for(var ue=Object.keys(ne).sort().reverse(),Re=ue.length,Ne=0;Ne<Re;Ne++){var Ae=ue[Ne],b=ne[Ae];if((D=E.replace(Ae,""))!==E){var d=void 0;switch(b){case"thousand":d=Math.pow(10,3);break;case"million":d=Math.pow(10,6);break;case"billion":d=Math.pow(10,9);break;case"trillion":d=Math.pow(10,12)}return y(D,w,C,S,T,x,A)*d}}}}(function(y,E){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=y.replace(w,"");return C=(C=C.replace(new RegExp("([0-9])".concat(s(E.thousands),"([0-9])"),"g"),"$1$2")).replace(E.decimal,".")}(a,u,c),u,c,h,f,g,p)}r.exports={unformat:function(a,u){var c,h,f,g=n("./globalState"),p=g.currentDelimiters(),y=g.currentCurrency().symbol,E=g.currentOrdinal(),w=g.getZeroFormat(),C=g.currentAbbreviations(),S=void 0;if(typeof a=="string")S=function(T,x){if(!T.indexOf(":")||x.thousands===":")return!1;var A=T.split(":");if(A.length!==3)return!1;var D=+A[0],U=+A[1],j=+A[2];return!isNaN(D)&&!isNaN(U)&&!isNaN(j)}(a,p)?(c=a.split(":"),h=+c[0],f=+c[1],+c[2]+60*f+3600*h):l(a,p,y,E,w,C,u);else{if(typeof a!="number")return;S=a}if(S!==void 0)return S}}},{"./globalState":4}],10:[function(n,r,o){function i(p){return function(y){if(Array.isArray(y)){for(var E=0,w=new Array(y.length);E<y.length;E++)w[E]=y[E];return w}}(p)||function(y){if(Symbol.iterator in Object(y)||Object.prototype.toString.call(y)==="[object Arguments]")return Array.from(y)}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(p){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(p)}var l=n("./unformatting"),a=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(p,y){return y.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(p){return p.output==="byte"}},characteristic:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(p){return 0<=p},message:"value must be positive"},{restriction:function(p,y){return!y.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(p,y){return y.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(p){return p.match(a)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(p){return!!l.unformat(p)}function f(p,y,E){var w=3<arguments.length&&arguments[3]!==void 0&&arguments[3],C=Object.keys(p).map(function(S){if(!y[S])return console.error("".concat(E," Invalid key: ").concat(S)),!1;var T=p[S],x=y[S];if(typeof x=="string"&&(x={type:x}),x.type==="format"){if(!f(T,u,"[Validate ".concat(S,"]"),!0))return!1}else if(s(T)!==x.type)return console.error("".concat(E," ").concat(S,' type mismatched: "').concat(x.type,'" expected, "').concat(s(T),'" provided')),!1;if(x.restrictions&&x.restrictions.length)for(var A=x.restrictions.length,D=0;D<A;D++){var U=x.restrictions[D],j=U.restriction,z=U.message;if(!j(T,p))return console.error("".concat(E," ").concat(S," invalid value: ").concat(z)),!1}return x.restriction&&!x.restriction(T,p)?(console.error("".concat(E," ").concat(S," invalid value: ").concat(x.message)),!1):x.validValues&&x.validValues.indexOf(T)===-1?(console.error("".concat(E," ").concat(S," invalid value: must be among ").concat(JSON.stringify(x.validValues),', "').concat(T,'" provided')),!1):!(x.children&&!f(T,x.children,"[Validate ".concat(S,"]")))});return w||C.push.apply(C,i(Object.keys(y).map(function(S){var T=y[S];if(typeof T=="string"&&(T={type:T}),T.mandatory){var x=T.mandatory;if(typeof x=="function"&&(x=x(p)),x&&p[S]===void 0)return console.error("".concat(E,' Missing mandatory key "').concat(S,'"')),!1}return!0}))),C.reduce(function(S,T){return S&&T},!0)}function g(p){return f(p,u,"[Validate format]")}r.exports={validate:function(p,y){var E=h(p),w=g(y);return E&&w},validateFormat:g,validateInput:h,validateLanguage:function(p){return f(p,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(fD);var cq=fD.exports;const $s=ah(cq),hq="numeric";function cE(t,e,n,r,o,i,s){let l=i;if(jn(l)){const a=s.numericFormat,u=a&&a.culture||"-",c=a&&a.pattern,h=s.className||"",f=h.length?h.split(" "):[];if(typeof u<"u"&&!$s.languages()[u]){const g=u.replace("-",""),p=$s.allLanguages?$s.allLanguages[u]:$s[g];p&&$s.registerLanguage(p)}$s.setLanguage(u),l=$s(l).format(c||"0"),f.indexOf("htLeft")<0&&f.indexOf("htCenter")<0&&f.indexOf("htRight")<0&&f.indexOf("htJustify")<0&&f.push("htRight"),f.indexOf("htNumeric")<0&&f.push("htNumeric"),s.className=f.join(" "),e.dir="ltr"}ki(t,e,n,r,o,l,s)}cE.RENDERER_TYPE=hq;const dq="password";function hE(t,e,n,r,o,i,s){ki.apply(this,[t,e,n,r,o,i,s]);const l=s.hashLength||e.innerHTML.length,a=s.hashSymbol||"*";let u="";ye(l-1,()=>{u+=a}),Ol(e,u)}hE.RENDERER_TYPE=dq;const fq="time";function dE(t,e,n,r,o,i,s){ki.apply(this,[t,e,n,r,o,i,s]),e.dir="ltr"}dE.RENDERER_TYPE=fq;function gq(){Io(lu),Io(Hh),Io(aE),Io(lE),Io(cE),Io(hE),Io(ki),Io(dE)}const mq="autocomplete";function rp(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,Sx(n,e)):Sx(n,e)(this.source):e(!0)}rp.VALIDATOR_TYPE=mq;function Sx(t,e){const n=t;return function(r){let o=!1;for(let i=0,s=r.length;i<s;i++)if(n===r[i]){o=!0;break}e(o)}}function gD(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const pq=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:gD},Symbol.toStringTag,{value:"Module"})),wq="date";function fE(t,e){const n=xP(sD,this.instance);let r=t,o=!0;r==null&&(r="");let i=ee(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=ee(new Date(r)).isValid()||i;if(this.allowEmpty&&r===""&&(s=!0,i=!0),s||(o=!1),!s&&i&&(o=!0),s&&!i)if(this.correctFormat===!0){const l=Cq(r,this.dateFormat),a=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(a,u,l,"dateValidator"),o=!0}else o=!1;e(o)}fE.VALIDATOR_TYPE=wq;function Cq(t,e){const n=ee(gD(t)),r=ee(t,e),o=t.search(/[A-z]/g)>-1;let i;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||o?i=n:i=r,i.format(e)}const vq="numeric";function gE(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:jn(t))}gE.VALIDATOR_TYPE=vq;const yq=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Sq="time";function mE(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,o=t;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;const i=/^\d{1,2}$/.test(o);i&&(o+=":00");const s=ee(o,yq,!0).isValid()?ee(o):ee(o,n);let l=s.isValid(),a=ee(o,n,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(l=!0,a=!0),l||(r=!1),!l&&a&&(r=!0),l&&!a)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,h,u,"timeValidator"),r=!0}else r=!1;e(r)}mE.VALIDATOR_TYPE=Sq;function Rq(){Sa(rp),Sa(fE),Sa(gE),Sa(mE)}const bq="autocomplete",Eq={CELL_TYPE:bq,editor:iE,renderer:lu,validator:rp},Tq="checkbox",Mq={CELL_TYPE:Tq,editor:oD,renderer:aE},xq="date",_q={CELL_TYPE:xq,editor:lD,renderer:lu,validator:fE},Oq="dropdown",Iq={CELL_TYPE:Oq,editor:sE,renderer:lu,validator:rp},Aq="handsontable",Hq={CELL_TYPE:Aq,editor:oE,renderer:lu},Pq="numeric",kq={CELL_TYPE:Pq,editor:aD,renderer:cE,validator:gE,dataType:"number"},Dq="password",Nq={CELL_TYPE:Dq,editor:uD,renderer:hE,copyable:!1},Lq="select";function mD(t,e,n,r,o,i,s){ki.apply(this,[t,e,n,r,o,i,s]),t.getSettings().ariaTags&&e.setAttribute(...L0())}mD.RENDERER_TYPE=Lq;const Fq="select",$q={CELL_TYPE:Fq,editor:cD,renderer:mD},Vq="time",Bq={CELL_TYPE:Vq,editor:hD,renderer:dE,validator:mE};function Wq(){Ar(Eq),Ar(Mq),Ar(_q),Ar(Iq),Ar(Hq),Ar(kq),Ar(Nq),Ar($q),Ar(Yk),Ar(Bq)}function Uq(t,e){zq(t,e),e.add(t)}function zq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jq(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Rx=new Map([["plugin",u6],["cell-type",Lk],["editor",MP],["renderer",LP],["validator",FP]]),Yq="base",Vs=new WeakMap,Kw=[];let Ro=null;var bx=new WeakSet;class ot{static get PLUGIN_KEY(){return Yq}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){Uq(this,bx),jo(this,"hot",e,{writable:!1}),Vs.set(this,{hooks:{}}),Ro=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const o=[];if(n.forEach(i=>{const[s,l]=i.split(":");if(!Rx.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);Rx.get(s)(l)||o.push(` - ${l} (${s})`)}),o.length>0){const i=[`The ${this.pluginName} plugin requires the following modules:
`,`${o.join(`
`)}
`].join("");Kw.push(i)}}if(Ro||(Ro=tR()),Ro.indexOf("UndoRedo")>=0&&Ro.splice(Ro.indexOf("UndoRedo"),1),Ro.indexOf(this.pluginName)>=0&&Ro.splice(Ro.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Ro.length===0){if(Kw.length>0){const o=[`${Kw.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(o)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){Vs.get(this).hooks[e]=Vs.get(this).hooks[e]||[];const r=Vs.get(this).hooks[e];this.hot.addHook(e,n),r.push(n),Vs.get(this).hooks[e]=r}removeHooks(e){O(Vs.get(this).hooks[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Vs.get(this).hooks;Ue(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){O(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=jq(this,bx,Gq).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Ue(this,(e,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function Gq(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Bs(t,e,n){return e=Kq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kq(t){var e=Xq(t,"string");return typeof e=="symbol"?e:String(e)}function Xq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let qq=class{constructor(e){Bs(this,"hot",null),Bs(this,"container",null),Bs(this,"injected",!1),Bs(this,"rows",[]),Bs(this,"columns",[]),Bs(this,"samples",null),Bs(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),O(this.rows,n=>{e(n.row,kt(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),O(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{O(r.strings,o=>{n.appendChild(this.createColElement(o.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),o=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,o),r.appendChild(o)),this.samples.forEach(i=>{O(i.strings,s=>{const l=s.col,a=this.hot.getCellMeta(e,l);a.col=l,a.row=e;const u=this.hot.getCellRenderer(a),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,l,this.hot.colToProp(l),s.value,a),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const o=e.createElement("th");r.push([-1,o]),n.appendChild(o)}this.samples.forEach(o=>{O(o.strings,i=>{const s=i.col,l=e.createElement("th");r.push([s,l]),n.appendChild(l)})}),this.table.tHead.appendChild(n),O(r,o=>{const[i,s]=o;this.hot.view.appendColHeader(i,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(o=>{O(o.strings,i=>{const s=i.row,l=this.hot.getCellMeta(s,e);l.col=e,l.row=s;const a=this.hot.getCellRenderer(l),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),a(this.hot,u,s,e,this.hot.colToProp(e),i.value,l),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let o=0;n>=0&&e>=0&&(o=this.hot.getCellMeta(n,e).colspan);let i=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(o>1)for(let s=e+1;s<e+o;s++)i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${i}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),o=n.createElement("table"),i=n.createElement("thead"),s=n.createElement("tbody"),l=n.createElement("colgroup"),a=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&o.appendChild(l),this.isHorizontal()&&(a.appendChild(u),i.appendChild(a),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(i),this.isVertical()&&s.appendChild(a),o.appendChild(s),te(o,e),r.appendChild(o),{fragment:r,table:o,tHead:i,tBody:s,colGroup:l,tr:a,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),o=n.createElement("div"),i=`htGhostTable htAutoSize ${e.trim()}`;return te(o,i),r.appendChild(o),{fragment:r,container:o}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const pE=qq;function Hd(t,e,n){return e=Qq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qq(t){var e=Zq(t,"string");return typeof e=="symbol"?e:String(e)}function Zq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wE{static get SAMPLE_COUNT(){return 3}constructor(e){Hd(this,"samples",null),Hd(this,"dataFactory",null),Hd(this,"customSampleCount",null),Hd(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:wE.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const o=new Map,{from:i,to:s}=typeof r=="number"?{from:r,to:r}:r;return ye(i,s,l=>{const a=this.generateSample(e,n,l);o.set(l,a)}),o}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const o=new Map,i=e==="row"?"col":"row",s=[];return ye(n.from,n.to,l=>{const a=e==="row"?this.dataFactory(r,l):this.dataFactory(l,r);if(a===!1)return;const{value:u,bundleSeed:c}=a,h=typeof c=="string"&&c.length>0;let f;h?f=c:$e(u)?f=`${Object.keys(u).length}`:Array.isArray(u)?f=`${u.length}`:f=`${Vt(u).length}`,o.has(f)||o.set(f,{needed:this.getSampleCount(),strings:[]});const g=o.get(f);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[i]:l}),s.push(u),g.needed-=1)}),o}}const pD=wE;me.getSingleton().register("modifyAutoColumnSizeSeed");const Ou="autoColumnSize",Jq=10,Xw=new WeakMap,eQ="autoColumnSize";class Sc extends ot{static get PLUGIN_KEY(){return Ou}static get PLUGIN_PRIORITY(){return Jq}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Xw.set(this,{cachedColumnHeaders:[]}),this.ghostTable=new pE(this.hot),this.samplesGenerator=new pD((n,r)=>{const o=this.hot.getCellMeta(n,r);let i="";o.spanned||(i=this.hot.getDataAtCell(n,r));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,o,i)),{value:i,bundleSeed:s}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredColumns=0,this.columnWidthsMap=new As,this.hot.columnIndexMapper.registerMap(eQ,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,o)=>this.onBeforeColumnResize(n,r,o))}isEnabled(){return this.hot.getSettings()[Ou]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Ou];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",r=>this.onBeforeChange(r)),this.addHook("afterFormulasValuesUpdate",r=>this.onAfterFormulasValuesUpdate(r)),this.addHook("beforeViewRender",r=>this.onBeforeViewRender(r)),this.addHook("modifyColWidth",(r,o)=>this.getColumnWidth(o,r)),this.addHook("afterInit",()=>this.onAfterInit()),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>this.onBeforeColumnResize(e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),o=this.getLastVisibleColumn();r===-1||o===-1||this.calculateColumnsWidth({from:r,to:o},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof e=="number"?{from:e,to:e}:e,i=typeof n=="number"?{from:n,to:n}:n;ye(o.from,o.to,s=>{let l=this.hot.toPhysicalColumn(s);if(l===null&&(l=s),r||this.columnWidthsMap.getValueAtIndex(l)===null&&!this.hot._getColWidthFromSettings(l)){const a=this.samplesGenerator.generateColumnSamples(s,i);O(a,u=>{let[c,h]=u;return this.ghostTable.addColumn(c,h)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,l)=>{const a=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(a,l)})},!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let o=null;this.inProgress=!0;const i=()=>{if(!this.hot){Jc(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+Sc.CALCULATION_STEP,r)},e),n=n+Sc.CALCULATION_STEP+1,n<r?o=Fm(i):(Jc(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?i():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[Ou],n=e&&Pt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Pt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Ou];let n=Sc.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return $e(e)&&(n=e.syncLimit,D0(n)?n=J0(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=n;return o===void 0&&(o=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof o=="number"&&(o=Math.max(o,oR.DEFAULT_WIDTH))),o}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader(),{cachedColumnHeaders:n}=Xw.get(this);return Gt(e,(o,i,s)=>{const l=n.length;return(l-1<s||n[s]!==i)&&o.push(s),l-1<s?n.push(i):n[s]=i,o},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{O(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!Rr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}onBeforeViewRender(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}onAfterLoadData(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}onBeforeChange(e){const n=We(e,r=>{let[,o]=r;return this.hot.toPhysicalColumn(this.hot.propToCol(o))});this.clearCache(Array.from(new Set(n)))}onBeforeColumnResize(e,n,r){let o=e;return r&&(this.calculateColumnsWidth(n,void 0,!0),o=this.getColumnWidth(n,void 0,!1)),o}onAfterInit(){Xw.get(this).cachedColumnHeaders=this.hot.getColHeader()}onAfterFormulasValuesUpdate(e){const n=Rr(e,o=>{var i;return he((i=o.address)===null||i===void 0?void 0:i.col)}),r=We(n,o=>o.address.col);this.clearCache(Array.from(new Set(r)))}destroy(){this.ghostTable.clean(),super.destroy()}}const il={horizontal:"horizontal",vertical:"vertical"};function tQ(t,e,n){let r,o,i;return e[0]===t[0]&&e[1]<t[1]?(i="left",r=n(e[0],e[1]),o=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(i="right",r=n(e[0],t[3]+1),o=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(i="up",r=n(e[0],e[1]),o=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(i="down",r=n(t[2]+1,e[1]),o=n(e[2],e[3])),r&&r.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:r,endOfDragCoords:o}}function nQ(t){const e={};return t===!0?(e.directions=Object.keys(il),e.autoInsertRow=!0):$e(t)?(he(t.autoInsertRow)?t.direction===il.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,he(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(il)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}me.getSingleton().register("modifyAutofillRange");me.getSingleton().register("beforeAutofill");me.getSingleton().register("afterAutofill");const Ex="autofill",rQ=20,oQ=["fillHandle"],iQ="insert_row_below",sQ=200;class lQ extends ot{static get PLUGIN_KEY(){return Ex}static get PLUGIN_PRIORITY(){return rQ}static get SETTING_KEYS(){return[Ex,...oQ]}constructor(e){super(e),this.eventManager=new Dt(this),this.addingStarted=!1,this.mouseDownOnCellCorner=!1,this.mouseDragOutside=!1,this.handleDraggedCells=0,this.directions=[],this.autoInsertRow=!1}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>this.onAfterCellCornerMouseDown(e)),this.addHook("afterOnCellCornerDblClick",e=>this.onCellCornerDblClick(e)),this.addHook("beforeOnCellMouseOver",(e,n)=>this.onBeforeCellMouseOver(n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:o,col:i}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:o,endCol:i}]),l=[],a=[],u=[];return O(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)l.indexOf(h)===-1&&l.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)a.indexOf(h)===-1&&a.push(h)}),O(l,c=>{const h=[];O(a,f=>{h.push(this.hot.getCopyableData(c,f))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,o]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),s=i.getTopStartCorner(),l=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const a=[s.row,s.col,l.row,l.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(l.row,r),Math.max(l.col,o)],a),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:f}=tQ(a,u,(g,p)=>this.hot._createCellCoords(g,p));if(h&&h.row>-1&&h.col>-1){const g=this.getSelectionData(),p=i.clone(),y=this.hot._createCellRange(h,h,f),E=this.hot.runHooks("beforeAutofill",g,p,y,c);if(E===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let w=E;const C=E;if(["up","left"].indexOf(c)>-1&&!(C.length===1&&C[0].length===0))if(w=[],c==="up"){const S=f.row-h.row+1,T=S%C.length;for(let x=0;x<S;x++)w.push(C[(x+(C.length-T))%C.length])}else{const S=f.col-h.col+1,T=S%C[0].length;for(let x=0;x<C.length;x++){w.push([]);for(let A=0;A<S;A++)w[x].push(C[x][(A+(C[x].length-T))%C[x].length])}}this.hot.populateFromArray(h.row,h.col,w,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",w,p,y,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let o=e;if(this.directions.includes(il.vertical)&&this.directions.includes(il.horizontal)){const i=n.getTopStartCorner();(r.col<=e.col||i.col>=e.col)&&(o=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||i.row>e.row)&&(o=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(il.vertical))o=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(il.horizontal))o=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(o)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(iQ,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},sQ)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let o;for(let i=e[2]+1;i<r;i++){for(let a=e[1];a<=e[3];a++)if(n[i][a])return-1;const s=n[i][e[1]-1],l=n[i][e[3]+1];(s||l)&&(o=i)}return o}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...We(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Qt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+kt(this.hot.table),o=Qt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+ct(this.hot.table);return e.clientY>r&&e.clientX<=o}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(e,"mousemove",n=>this.onMouseMove(n))}onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}onBeforeCellMouseOver(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}onMouseUp(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}onMouseMove(e){const n=this.getIfMouseWasDraggedOutside(e);this.addingStarted===!1&&this.handleDraggedCells>0&&n?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=nQ(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}const Pd="autoRowSize",aQ=40,uQ="autoRowSize";class Rc extends ot{static get PLUGIN_KEY(){return Pd}static get PLUGIN_PRIORITY(){return aQ}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),this.rowHeightsMap=void 0,this.headerHeight=null,this.ghostTable=new pE(this.hot),this.samplesGenerator=new pD((n,r)=>{if(n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let o;return n>=0?o=this.hot.getDataAtCell(n,r):n===-1&&(o=this.hot.getColHeader(r)),{value:o}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredRows=0,this.rowHeightsMap=new As,this.hot.rowIndexMapper.registerMap(uQ,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,o)=>this.onBeforeRowResize(n,r,o))}isEnabled(){const e=this.hot.getSettings()[Pd];return e===!0||$e(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",n=>this.onBeforeChange(n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>this.onBeforeViewRender(n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>this.onBeforeRowResize(e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof e=="number"?{from:e,to:e}:e,i=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(s.get(-1))}ye(o.from,o.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const l=this.samplesGenerator.generateRowSamples(s,i);O(l,a=>{let[u,c]=a;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,l)=>{s<0?this.headerHeight=l:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),l)})},!0),this.measuredRows=o.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let o=null;this.inProgress=!0;const i=()=>{if(!this.hot){Jc(o),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+Rc.CALCULATION_STEP,r)},e),n=n+Rc.CALCULATION_STEP+1,n<r?o=Fm(i):(Jc(o),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?i():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[Pd],n=e&&Pt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Pt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){pl(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Pd];let n=Rc.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return $e(e)&&(n=e.syncLimit,D0(n)?n=J0(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let o=n;return r!==null&&r>(n||0)&&(o=r),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{ye(Math.min(n,r),Math.max(n,r),o=>{this.rowHeightsMap.setValueAtIndex(o,null)})},!0)}isNeedRecalculate(){return!!Rr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}onBeforeViewRender(){const e=this.hot.renderCall,n=this.hot.getSettings().fixedRowsBottom,r=this.getFirstVisibleRow(),o=this.getLastVisibleRow();if(!(r===-1||o===-1)){if(this.calculateRowsHeight({from:r,to:o},void 0,e),n){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-n,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}onBeforeRowMove(e,n){this.clearCacheByRange({from:e,to:n}),this.calculateAllRowsHeight()}onBeforeRowResize(e,n,r){let o=e;return r&&(this.calculateRowsHeight(n,void 0,!0),o=this.getRowHeight(n)),o}onAfterLoadData(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}onBeforeChange(e){let n=null;e.length===1?n=e[0][0]:e.length>1&&(n={from:e[0][0],to:e[e.length-1][0]}),n!==null&&this.clearCacheByRange(n)}destroy(){this.ghostTable.clean(),super.destroy()}}const{getListWithInsertedItems:cQ,getListWithRemovedItems:hQ}=pk("physicallyIndexed");class dQ extends Il{constructor(){super(e=>e)}insert(e,n){const r=OR(this.indexedValues,n);this.indexedValues=cQ(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=hQ(this.indexedValues,e);this.indexedValues=_R(n,e),super.remove(e)}}const fQ=dQ,{getListWithInsertedItems:gQ,getListWithRemovedItems:mQ}=pk("physicallyIndexed");class pQ extends Il{constructor(){super(e=>e)}insert(e,n){this.indexedValues=gQ(this.indexedValues,e,n,(r,o)=>this.getNextValue(o)),super.insert(e,n)}remove(e){this.indexedValues=mQ(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const wQ=pQ,qw="bindRowsWithHeaders",CQ=210,vQ="loose",yQ=new Map([["loose",fQ],["strict",wQ]]);class SQ extends ot{static get PLUGIN_KEY(){return qw}static get PLUGIN_PRIORITY(){return CQ}constructor(e){super(e),this.headerIndexes=null}isEnabled(){return!!this.hot.getSettings()[qw]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[qw];typeof e!="string"&&(e=vQ);const n=yQ.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>this.onModifyRowHeader(r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}onModifyRowHeader(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}destroy(){super.destroy()}}function RQ(t,e,n){bQ(t,e),e.set(t,n)}function bQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qw(t,e,n){return e=EQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EQ(t){var e=TQ(t,"string");return typeof e=="symbol"?e:String(e)}function TQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tx(t,e){var n=wD(t,e,"get");return MQ(t,n)}function MQ(t,e){return e.get?e.get.call(t):e.value}function Zw(t,e,n){var r=wD(t,e,"set");return xQ(t,r,n),n}function wD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function xQ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Nf="collapsibleColumns",_Q=290,OQ=["nestedHeaders"],Ul="collapsibleIndicator",Mx=Nf,xx=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var zl=new WeakMap;class IQ extends ot{constructor(){super(...arguments),Qw(this,"nestedHeadersPlugin",null),Qw(this,"eventManager",new Dt(this)),Qw(this,"headerStateManager",null),RQ(this,zl,{writable:!0,value:null})}static get PLUGIN_KEY(){return Nf}static get PLUGIN_PRIORITY(){return _Q}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Nf,...OQ]}isEnabled(){return!!this.hot.getSettings()[Nf]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||Ct("You need to configure the Nested Headers plugin in order to use collapsible headers."),Zw(this,zl,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",(r,o,i)=>this.onBeforeOnCellMouseDown(r,o,i)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Zw(this,zl,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:o,isCollapsed:i,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};o&&(i?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:Mx})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Mx)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(s){s&&s.parentNode.removeChild(s)};ye(0,e-1,s=>{const l=n.childNodes[s],a=r.childNodes[s],u=o?o.childNodes[s]:null;ye(0,l.childNodes.length-1,c=>{let h=l.childNodes[c].querySelector(`.${Ul}`);i(h),a&&a.childNodes[c]&&(h=a.childNodes[c].querySelector(`.${Ul}`),i(h)),o&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Ul}`),i(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:o,origColspan:i,headerLevel:s,columnIndex:l,isCollapsed:a}=r;if(o===!0&&i>1&&(a&&e==="expand"||!a&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:l}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!xx.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Rr(e,f=>{let{row:g}=f;return g<0});let o=r.length>0;O(r,f=>{var g;let{row:p,col:y}=f;const{collapsible:E,isCollapsed:w}=(g=this.headerStateManager.getHeaderSettings(p,y))!==null&&g!==void 0?g:{};if(!E||w&&n==="collapse"||!w&&n==="expand")return o=!1,!1});const i=[],s=[];o&&O(r,f=>{let{row:g,col:p}=f;const{colspanCompensation:y,affectedColumns:E,rollbackModification:w}=this.headerStateManager.triggerNodeModification(n,g,p);y>0&&(s.push(...E),i.push(w))});const l=this.getCollapsedColumns();let a=[];n==="collapse"?a=P0([...l,...s]):n==="expand"&&(a=Rr(l,f=>!s.includes(f)));const u=xx.get(n);if(this.hot.runHooks(u.beforeHook,l,a,o)===!1){O(i,f=>{f()});return}this.hot.batchExecution(()=>{O(s,f=>{Tx(this,zl).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==l.length;this.hot.runHooks(u.afterHook,l,a,o,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return Tx(this,zl).getHiddenIndexes()}onAfterGetColHeader(e,n,r){var o;const{collapsible:i,origColspan:s,isCollapsed:l}=(o=this.headerStateManager.getHeaderSettings(r,e))!==null&&o!==void 0?o:{},a=i&&s>1&&e>=this.hot.getSettings().fixedColumnsStart,u=this.hot.getSettings().ariaTags;let c=n.querySelector(`.${Ul}`);if(bh(n,[Fr("")[0]]),a)c||(c=this.hot.rootDocument.createElement("div"),te(c,Ul),n.querySelector("div:first-child").appendChild(c)),ke(c,["collapsed","expanded"]),l?(te(c,"collapsed"),Es(c,"+"),u&&He(n,...Fr(!1))):(te(c,"expanded"),Es(c,"-"),u&&He(n,...Fr(!0))),u&&He(c,...ru());else{var h;(h=c)===null||h===void 0||h.remove()}}onBeforeOnCellMouseDown(e,n){Pe(e.target,Ul)&&(Pe(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([n],"collapse")):Pe(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([n],"expand")),br(e))}onInit(){this.updatePlugin()}onAfterLoadData(e,n){n||this.updatePlugin()}destroy(){Zw(this,zl,null),super.destroy()}}const AQ=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],HQ=!1,PQ=!0,kQ=!0;class DQ{constructor(e,n){this.hot=e,this.sortingStates=new Bm,this.sortEmptyCells=HQ,this.indicator=PQ,this.headerAction=kQ,this.compareFunctionFactory=void 0,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){$e(e)&&Ue(e,(n,r)=>{AQ.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return $e(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,o]=n;return{column:this.hot.toVisualColumn(r),...o}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(he(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const Ng="asc",Lg="desc",NQ="colHeader";function LQ(t){if($e(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Ng,Lg].includes(n)}function FQ(t){if(t.some(n=>LQ(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function _x(t){if(t!==Lg)return t===Ng?Lg:Ng}function Ox(t){return t.querySelector(`.${NQ}`)}function Ix(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function Yy(t,e,n){return t===-1&&e>=0&&Ts(n)===!1}const $Q="ascending",VQ="descending",CD="indicatorDisabled",vD="columnSorting",yD="sortAction",SD=new Map([[Ng,$Q],[Lg,VQ]]);function BQ(t,e,n,r){const o=[vD];if(r&&o.push(yD),n===!1)return o.push(CD),o;const i=t.getSortOrderOfColumn(e);return he(i)&&o.push(SD.get(i)),o}function WQ(){return Array.from(SD.values()).concat(yD,CD,vD)}function RD(t,e,n){const r=e.locale;return function(o,i){const{sortEmptyCells:s}=n;return typeof o=="string"&&(o=o.toLocaleLowerCase(r)),typeof i=="string"&&(i=i.toLocaleLowerCase(r)),o===i?$o:rn(o)?rn(i)?$o:s&&t==="asc"?Ft:$t:rn(i)?s&&t==="asc"?$t:Ft:isNaN(o)&&!isNaN(i)?t==="asc"?$t:Ft:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?t==="asc"?Ft:$t:o>i?t==="asc"?$t:Ft:$o}}const bD="default";function UQ(t,e,n){return function(r,o){const i=parseFloat(r),s=parseFloat(o),{sortEmptyCells:l}=n;if(i===s||isNaN(i)&&isNaN(s))return $o;if(l){if(rn(r))return t==="asc"?Ft:$t;if(rn(o))return t==="asc"?$t:Ft}return isNaN(i)?$t:isNaN(s)?Ft:i<s?t==="asc"?Ft:$t:i>s?t==="asc"?$t:Ft:$o}}const zQ="numeric";function jQ(t,e,n){const r=e.checkedTemplate,o=e.uncheckedTemplate,{sortEmptyCells:i}=n;return function(s,l){const a=rn(s),u=rn(l),c=a?o:s,h=u?o:l,f=c===o||c===r,g=h===o||h===r;if(i===!1){if(a&&u===!1)return $t;if(a===!1&&u)return Ft}return f===!1&&g?t==="asc"?Ft:$t:f&&g===!1?t==="asc"?$t:Ft:f===!1&&g===!1?RD(t,e,n)(s,l):c===o&&h===r?t==="asc"?Ft:$t:c===r&&h===o?t==="asc"?$t:Ft:$o}}const YQ="checkbox";function GQ(t,e,n){return function(r,o){const{sortEmptyCells:i}=n;if(r===o)return $o;if(rn(r))return rn(o)?$o:i&&t==="asc"?Ft:$t;if(rn(o))return i&&t==="asc"?$t:Ft;const s=e.dateFormat,l=ee(r,s),a=ee(o,s);return l.isValid()?a.isValid()?a.isAfter(l)?t==="asc"?Ft:$t:a.isBefore(l)?t==="asc"?$t:Ft:$o:Ft:$t}}const KQ="date",{register:op,getItem:Ax,hasItem:XQ}=po("sorting.compareFunctionFactory"),{register:ED,getItem:qQ}=po("sorting.mainSortComparator");function TD(t){return XQ(t)?Ax(t):Ax(bD)}op(zQ,UQ);op(YQ,jQ);op(KQ,GQ);op(bD,RD);const $o=0,Ft=-1,$t=1;function QQ(t,e){const n=qQ(e);for(var r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];t.sort(n(...o))}function ZQ(t,e){return function(n,r){const[,...o]=n,[,...i]=r;return function(l){const a=t[l],u=e[l],c=o[l],h=i[l],f=u.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:TD(u.type))(a,u,f)(c,h)}(0)}}const Fg="columnSorting",JQ=50,$g="append",eZ="replace",Hx=Fg;ED(Fg,ZQ);me.getSingleton().register("beforeColumnSort");me.getSingleton().register("afterColumnSort");class MD extends ot{static get PLUGIN_KEY(){return Fg}static get PLUGIN_PRIORITY(){return JQ}constructor(e){super(e),this.columnStatesManager=null,this.columnMetaCache=null,this.pluginKey=Fg,this.indexesSequenceCache=null}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new DQ(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new As(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>this.onAfterGetColHeader(n,r)),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>this.loadOrSortBySettings()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.hot.view&&this.loadOrSortBySettings(),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const o=Ox(r);Ix(n,r)===!1||o===null||this.updateHeaderClasses(o)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:Hx})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Hx)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),o=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,o)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new wk),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),o&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,o?r:n,o),o&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return he(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return FQ(e)&&e.every(r=>{let{column:o}=r;return o<=n&&o>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=o=>{let{column:i,...s}=o;return{column:this.hot.toPhysicalColumn(i),...s}};n.initialConfig=We(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=o=>{let{column:i,...s}=o;return{column:this.hot.toVisualColumn(i),...s}};return he(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=We(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(he(n)){const o=_x(n);return he(o)?{column:e,sortOrder:o}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:_x()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$g;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),o=r!==-1,i=this.getSortConfig(),s=this.getColumnNextConfig(e);if(o){if(vt(s))return[...i.slice(0,r),...i.slice(r+1)];if(n===$g)return[...i.slice(0,r),...i.slice(r+1),s];if(n===eZ)return[...i.slice(0,r),s,...i.slice(r+1)]}return he(s)?i.concat(s):i}getPluginColumnConfig(e){if($e(e)){const n=e[this.pluginKey];if($e(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),o=this.hot.getCellMeta(0,e),i=Object.getPrototypeOf(o);return Array.isArray(i.columns)?Object.assign(r,n,this.getPluginColumnConfig(i.columns[e])):wt(i.columns)?Object.assign(r,n,this.getPluginColumnConfig(i.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),o=u=>We(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(o(u)));const i=We(n,u=>u[0]);QQ(n,this.pluginKey,We(e,u=>u.sortOrder),We(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(o(u)));const s=We(n,u=>u[0]),l=new Map(We(i,(u,c)=>[u,s[c]])),a=We(this.hot.rowIndexMapper.getIndexesSequence(),u=>l.has(u)?l.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(a)}loadOrSortBySettings(){const e=this.getAllSavedSortSettings();if($e(e))this.sortBySettings(e);else{const n=this.hot.getSettings()[this.pluginKey];this.sortBySettings(n)}}sortBySettings(e){if($e(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||$e(n))&&this.sort(n)}else this.hot.render()}onAfterGetColHeader(e,n){const r=Ox(n);if(Ix(e,n)===!1||r===null)return;const o=this.getFirstCellSettings(e)[this.pluginKey],i=o.indicator,s=o.headerAction;if(this.updateHeaderClasses(r,this.columnStatesManager,e,i,s),this.hot.getSettings().ariaTags){const l=this.columnStatesManager.getSortOrderOfColumn(e);He(n,...z3(l?`${l}ending`:"none"))}}updateHeaderClasses(e){if(ke(e,WQ()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];te(e,BQ(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),he(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}onAfterLoadData(e){e===!0&&this.hot.view&&this.loadOrSortBySettings()}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&e.target.nodeName==="SPAN"}onBeforeOnCellMouseDown(e,n,r,o){Yy(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(o.column=!0)}onAfterOnCellMouseDown(e,n){Yy(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}class tZ{constructor(e,n){this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=n,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),O(r,o=>{const i={};this.assignSetting(o,i,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(o,i,"reversedRowCoords",!1),this.assignSetting(o,i,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(o,i,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(o,i,"sourceColumn",o.destinationColumn),this.assignSetting(o,i,"type","sum"),this.assignSetting(o,i,"forceNumeric",!1),this.assignSetting(o,i,"suppressDataTypeErrors",!0),this.assignSetting(o,i,"suppressDataTypeErrors",!0),this.assignSetting(o,i,"customFunction",null),this.assignSetting(o,i,"readOnly",!0),this.assignSetting(o,i,"roundFloat",!1),n.push(i)}),n}assignSetting(e,n,r,o){if(r==="ranges"&&e[r]===void 0){n[r]=o;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(o instanceof Error)throw o;n[r]=o}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const o=e.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();O(i,s=>{o==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),o==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(e,n,r,o,i){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const l=e.indexOf("row")>-1?"row":"col",a=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;O(u,f=>{l==="row"&&f.destinationRow>=h&&(f.alterRowOffset=a*r),l==="col"&&f.destinationColumn>=h&&(f.alterColumnOffset=a*r)}),this.resetAllEndpoints(u,!c),c?O(u,f=>{this.extendEndpointRanges(f,h,o[0],o.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):O(u,f=>{this.shiftEndpointCoordinates(f,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,o){O(e.ranges,i=>{i[1]&&(n>=i[0]&&n<=i[1]?r>i[1]?i[1]+=o:r<i[0]&&(i[0]-=o):r>=i[0]&&r<=i[1]&&(i[1]-=o,n<=i[0]&&(i[0]+=1,i[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],o=[];O(n,i=>{const s=[];if(i[1])for(let l=i[0];l<=i[1];l++)s.push(this.hot.toPhysicalRow(l));else s.push(this.hot.toPhysicalRow(i[0]));o.push(s)}),O(o,i=>{let s=[];O(i,(l,a)=>{a===0?s.push(l):i[a]!==i[a-1]+1&&(s.push(i[a-1]),r.push(s),s=[],s.push(l)),a===i.length-1&&(s.push(l),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,O(e.ranges,r=>{O(r,(o,i)=>{o>=n&&(r[i]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(o=>{const i=o.alterRowOffset||0,s=o.alterColumnOffset||0;return o.destinationRow+i>=this.hot.countRows()||o.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],O(e,o=>{this.resetEndpointValue(o,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],O(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],O(e,(r,o,i)=>{`${r[2]||""}`!=`${r[3]}`&&O(this.getAllEndpoints(),(s,l)=>{this.hot.propToCol(i[o][1])===s.sourceColumn&&n.indexOf(l)===-1&&n.push(l)})}),O(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,o=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?o:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const i=this.hot.toVisualRow(e.destinationRow);if(i!==null){const s=this.hot.getCellMeta(i,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(o,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Ct("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const nZ=tZ;function Jw(t){return t==null||isNaN(t)}const eC="columnSummary",rZ=220;class oZ extends ot{static get PLUGIN_KEY(){return eC}static get PLUGIN_PRIORITY(){return rZ}constructor(e){super(e),this.endpoints=null}isEnabled(){return!!this.hot.getSettings()[eC]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[eC],this.endpoints=new nZ(this,this.settings),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeCreateRow",(n,r,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,o)),this.addHook("beforeCreateCol",(n,r,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,o)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,o)),this.addHook("afterCreateCol",(n,r,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,o)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){return e.onAfterRowMove(...arguments)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ue(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,o=e[1]||e[0],i=null,s=0;do{if(i=this.getCellValue(o,n),i=Jw(i)?null:i,i!==null){const l=(`${i}`.split(".")[1]||[]).length||1;l>s&&(s=l)}r+=i||0,o-=1}while(o>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ue(e.ranges,o=>{const i=this.getPartialMinMax(o,e.sourceColumn,n);if(r===null&&i!==null&&(r=i),i!==null)switch(n){case"min":r=Math.min(r,i);break;case"max":r=Math.max(r,i);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let o=null,i=e[1]||e[0],s;do{if(s=this.getCellValue(i,n),s=Jw(s)?null:s,o===null)o=s;else if(s!==null)switch(r){case"min":o=Math.min(o,s);break;case"max":o=Math.max(o,s);break}i-=1}while(i>=e[0]);return o}countEmpty(e,n){let r,o=0,i=e[1]||e[0];do r=this.getCellValue(i,n),r=Jw(r)?null:r,r===null&&(o+=1),i-=1;while(i>=e[0]);return o}countEntries(e){let n=0;const r=e.ranges;return Ue(r,o=>{const i=o[1]===void 0?1:o[1]-o[0]+1,s=this.countEmpty(o,e.sourceColumn);n+=i,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),o=this.hot.toVisualColumn(n);let i=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&o!==null&&(s=this.hot.getCellMeta(r,o).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof i=="string"&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ht`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}onAfterInit(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}onAfterChange(e,n){e&&n!=="ColumnSummary.reset"&&n!=="ColumnSummary.set"&&n!=="loadData"&&this.endpoints.refreshChangedEndpoints(e)}onAfterRowMove(e,n){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",n,e.length,e,this.pluginName)}}class ba{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){this.rootDocument=e,this.isRtl=n,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:ct(this.getInputElement()),height:kt(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),te(this.container,ba.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),te(e,ba.CLASS_EDITOR),te(n,ba.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${ba.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const iZ=ba,sZ=250,lZ=250;class xD{constructor(e){this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},lZ)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sZ;this.showDebounced=j0(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}gt(xD,cr);const aZ=xD;function uZ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function cZ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ws(t,e){const n={};return O(t,r=>{r.forAll((o,i)=>{o>=0&&i>=0&&(n[o]||(n[o]=[]),n[o][i]=e(o,i))})}),n}function Gi(t,e,n,r,o){O(t,i=>{i.forAll((s,l)=>{s>=0&&l>=0&&hZ(s,l,e,n,r,o)})})}function hZ(t,e,n,r,o,i){const s=o(t,e);let l=r;s.className&&(n==="vertical"?l=uZ(s.className,r):l=cZ(s.className,r)),i(t,e,"className",l)}function ai(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Ho(t,e){let n=!1;return Array.isArray(t)&&O(t,r=>(r.forAll((o,i)=>{if(o>=0&&i>=0&&e(o,i))return n=!0,!1}),n)),n}function Vg(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:o,left:i}=r.getBoundingClientRect();n.top=o,n.left=i}return n}const je="---------";function dZ(){return{name:je}}const Pr="alignment";function fZ(){return{key:Pr,name(){return this.getTranslatedPhrase(tb)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Pr}:left`,name(){let t=this.getTranslatedPhrase(nb);return Ho(this.getSelectedRange(),(n,r)=>{const o=this.getCellMeta(n,r).className;if(o&&o.indexOf("htLeft")!==-1)return!0})&&(t=ai(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(o,i)=>this.getCellMeta(o,i).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Gi(t,n,r,(o,i)=>this.getCellMeta(o,i),(o,i,s,l)=>this.setCellMeta(o,i,s,l)),this.render()},disabled:!1},{key:`${Pr}:center`,name(){let t=this.getTranslatedPhrase(rb);return Ho(this.getSelectedRange(),(n,r)=>{const o=this.getCellMeta(n,r).className;if(o&&o.indexOf("htCenter")!==-1)return!0})&&(t=ai(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(o,i)=>this.getCellMeta(o,i).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Gi(t,n,r,(o,i)=>this.getCellMeta(o,i),(o,i,s,l)=>this.setCellMeta(o,i,s,l)),this.render()},disabled:!1},{key:`${Pr}:right`,name(){let t=this.getTranslatedPhrase(ob);return Ho(this.getSelectedRange(),(n,r)=>{const o=this.getCellMeta(n,r).className;if(o&&o.indexOf("htRight")!==-1)return!0})&&(t=ai(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(o,i)=>this.getCellMeta(o,i).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Gi(t,n,r,(o,i)=>this.getCellMeta(o,i),(o,i,s,l)=>this.setCellMeta(o,i,s,l)),this.render()},disabled:!1},{key:`${Pr}:justify`,name(){let t=this.getTranslatedPhrase(ib);return Ho(this.getSelectedRange(),(n,r)=>{const o=this.getCellMeta(n,r).className;if(o&&o.indexOf("htJustify")!==-1)return!0})&&(t=ai(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(o,i)=>this.getCellMeta(o,i).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Gi(t,n,r,(o,i)=>this.getCellMeta(o,i),(o,i,s,l)=>this.setCellMeta(o,i,s,l)),this.render()},disabled:!1},{name:je},{key:`${Pr}:top`,name(){let t=this.getTranslatedPhrase(sb);return Ho(this.getSelectedRange(),(n,r)=>{const o=this.getCellMeta(n,r).className;if(o&&o.indexOf("htTop")!==-1)return!0})&&(t=ai(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(o,i)=>this.getCellMeta(o,i).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Gi(t,n,r,(o,i)=>this.getCellMeta(o,i),(o,i,s,l)=>this.setCellMeta(o,i,s,l)),this.render()},disabled:!1},{key:`${Pr}:middle`,name(){let t=this.getTranslatedPhrase(lb);return Ho(this.getSelectedRange(),(n,r)=>{const o=this.getCellMeta(n,r).className;if(o&&o.indexOf("htMiddle")!==-1)return!0})&&(t=ai(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(o,i)=>this.getCellMeta(o,i).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Gi(t,n,r,(o,i)=>this.getCellMeta(o,i),(o,i,s,l)=>this.setCellMeta(o,i,s,l)),this.render()},disabled:!1},{key:`${Pr}:bottom`,name(){let t=this.getTranslatedPhrase(ab);return Ho(this.getSelectedRange(),(n,r)=>{const o=this.getCellMeta(n,r).className;if(o&&o.indexOf("htBottom")!==-1)return!0})&&(t=ai(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(o,i)=>this.getCellMeta(o,i).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Gi(t,n,r,(o,i)=>this.getCellMeta(o,i),(o,i,s,l)=>this.setCellMeta(o,i,s,l)),this.render()},disabled:!1}]}}}const ip="clear_column";function gZ(){return{key:ip,name(){return this.getTranslatedPhrase(BR)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const Ph="col_left";function mZ(){return{key:Ph,name(){return this.getTranslatedPhrase(kR)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const kh="col_right";function pZ(){return{key:kh,name(){return this.getTranslatedPhrase(DR)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Dh="make_read_only";function wZ(){return{key:Dh,name(){let t=this.getTranslatedPhrase(VR);return Ho(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=ai(t)),t},callback(){const t=this.getSelectedRange(),e=Ho(t,(n,r)=>this.getCellMeta(n,r).readOnly);O(t,n=>{n.forAll((r,o)=>{r>=0&&o>=0&&this.setCellMeta(r,o,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const sp="redo";function CZ(){return{key:sp,name(){return this.getTranslatedPhrase($R)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Nh="remove_col";function vZ(){return{key:Nh,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(LR,e)},callback(){this.alter("remove_col",n9(this.getSelected()),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const lp="remove_row";function yZ(){return{key:lp,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(NR,e)},callback(){this.alter("remove_row",r9(this.getSelected()),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const ap="row_above";function SZ(){return{key:ap,name(){return this.getTranslatedPhrase(HR)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const up="row_below";function RZ(){return{key:up,name(){return this.getTranslatedPhrase(PR)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const ih="no_items";function bZ(){return{key:ih,name(){return this.getTranslatedPhrase(AR)},disabled:!0,isCommand:!1}}const cp="undo";function EZ(){return{key:cp,name(){return this.getTranslatedPhrase(FR)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const TZ=[ap,up,Ph,kh,ip,lp,Nh,cp,sp,Dh,Pr,je,ih],MZ={[je]:dZ,[ih]:bZ,[ap]:SZ,[up]:RZ,[Ph]:mZ,[kh]:pZ,[ip]:gZ,[lp]:yZ,[Nh]:vZ,[cp]:EZ,[sp]:CZ,[Dh]:wZ,[Pr]:fZ};function _D(){const t={};return Ue(MZ,(e,n)=>{t[n]=e()}),t}function xZ(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(ZR):this.getTranslatedPhrase(QR)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!e||e.highlight.isHeader()?!0:this.countRenderedRows()===0||this.countRenderedCols()===0}}}function _Z(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(JR)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!e||e.highlight.isHeader()?!0:this.countRenderedRows()===0||this.countRenderedCols()===0}}}function OZ(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(eb);return Ho(this.getSelectedRange(),(r,o)=>t.getCommentMeta(r,o,Lf))?ai(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const o=!!t.getCommentMeta(n,r,Lf);t.updateCommentMeta(n,r,{[Lf]:!o})}})},disabled(){const e=this.getSelectedRangeLast();return!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)?!0:this.countRenderedRows()===0||this.countRenderedCols()===0}}}function Us(t,e,n){IZ(t,e),e.set(t,n)}function IZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Px(t,e,n){return e=AZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AZ(t){var e=HZ(t,"string");return typeof e=="symbol"?e:String(e)}function HZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zo(t,e,n){var r=OD(t,e,"set");return PZ(t,r,n),n}function PZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function qe(t,e){var n=OD(t,e,"get");return kZ(t,n)}function OD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function kZ(t,e){return e.get?e.get.call(t):e.value}const bc="comments",DZ=60,Jo="comment",Iu="value",kx="style",Lf="readOnly",kd=bc,tC=`plugin:${bc}`;var bt=new WeakMap,qr=new WeakMap,Dd=new WeakMap,Nd=new WeakMap,Ld=new WeakMap,nC=new WeakMap,Fd=new WeakMap;class NZ extends ot{constructor(){super(...arguments),Px(this,"range",{}),Px(this,"eventManager",null),Us(this,bt,{writable:!0,value:null}),Us(this,qr,{writable:!0,value:null}),Us(this,Dd,{writable:!0,value:!1}),Us(this,Nd,{writable:!0,value:!1}),Us(this,Ld,{writable:!0,value:{}}),Us(this,nC,{writable:!0,value:null}),Us(this,Fd,{writable:!0,value:""})}static get PLUGIN_KEY(){return bc}static get PLUGIN_PRIORITY(){return DZ}isEnabled(){return!!this.hot.getSettings()[bc]}enablePlugin(){this.enabled||(qe(this,bt)||Zo(this,bt,new iZ(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Dt(this)),qe(this,qr)||Zo(this,qr,new aZ(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,o,i,s)=>this.onAfterRenderer(e,s)),this.addHook("afterScroll",()=>this.onAfterScroll()),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>this.onAfterDocumentKeyDown(e)),qe(this,qr).addLocalHook("hide",()=>this.hide()),qe(this,qr).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){qe(this,qr).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(tC);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const o=this.hot.getSelectedRangeLast();Zo(this,Nd,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(o),this.show(),this.focusEditor(),e.setActiveContextName(tC),this.hot._registerTimeout(()=>{Zo(this,Nd,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var o;return((o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight.isCell())&&!qe(this,bt).isVisible()},group:kd}),r.addShortcut({keys:[["Escape"]],callback:()=>{qe(this,bt).setValue(qe(this,Fd)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var o;return((o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight.isCell())&&qe(this,bt).isVisible()},group:kd}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var o;return((o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight.isCell())&&qe(this,bt).isVisible()},group:kd})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(kd)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>this.onMouseOver(r)),this.eventManager.addEventListener(e,"mousedown",r=>this.onMouseDown(r)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(n,"focus",()=>this.onEditorFocus()),this.eventManager.addEventListener(n,"blur",()=>this.onEditorBlur()),this.eventManager.addEventListener(n,"mousedown",r=>this.onEditorMouseDown(r)),this.eventManager.addEventListener(n,"mouseup",r=>this.onEditorMouseUp(r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=ps(e.target,"TD","TBODY");return!!(n&&Pe(n,"htCommentCell")&&ps(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=qe(this,bt).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const o=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(o,i,{[Iu]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Jo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Iu)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Iu)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const o=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return qe(this,qr).cancelHiding(),qe(this,bt).setValue((e=o[Jo]?o[Jo][Iu]:null)!==null&&e!==void 0?e:""),qe(this,bt).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){qe(this,bt).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!qe(this,bt).isVisible()))return;const{rowIndexMapper:o,columnIndexMapper:i}=this.hot,{row:s,col:l}=this.range.from;let a=o.getRenderableFromVisualIndex(s),u=i.getRenderableFromVisualIndex(l);const c=a===null;qe(this,bt).setPosition(0,0),a===null&&(a=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s,-1))),u===null&&(u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(l,-1)));const h=a===null,f=u===null;a=(e=a)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:g,view:{_wt:p}}=this.hot,{wtTable:y}=p,E=p.getCell({row:a,col:u},!0),w=this.getCommentMeta(s,l,kx);w?qe(this,bt).setSize(w.width,w.height):qe(this,bt).resetSize();const C=f?0:y.getStretchedColumnWidth(u),S=c&&!h?kt(E):0,{left:T,top:x,width:A,height:D}=E.getBoundingClientRect(),{width:U,height:j}=qe(this,bt).getSize(),{innerWidth:z,innerHeight:Z}=this.hot.rootWindow,re=this.hot.rootDocument.documentElement;let ne=T+g.scrollX+C,ue=x+g.scrollY+S;this.hot.isRtl()&&(ne-=U+C),this.hot.isLtr()&&T+A+U>z?ne=T+g.scrollX-U-1:this.hot.isRtl()&&ne<-(re.scrollWidth-re.clientWidth)&&(ne=T+g.scrollX+C+1),x+j>Z&&(ue-=j-D+1),qe(this,bt).setPosition(ne,ue),qe(this,bt).setReadOnlyState(this.getCommentMeta(s,l,Lf))}focusEditor(){qe(this,bt).focus()}updateCommentMeta(e,n,r){const o=this.hot.getCellMeta(e,n)[Jo];let i;o?(i=kn(o),xh(i,r)):i=r,this.hot.setCellMeta(e,n,Jo,i)}getCommentMeta(e,n,r){const o=this.hot.getCellMeta(e,n);if(o[Jo])return o[Jo][r]}onMouseDown(e){if(!(!this.hot.view||!this.hot.view._wt)&&!qe(this,Dd)&&!this.targetIsCommentTextArea(e)){const n=ps(e.target,"TD","TBODY");let r=null;n&&(r=this.hot.getCoords(n)),(!n||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}onMouseOver(e){const{rootDocument:n}=this.hot;if(!(qe(this,Dd)||qe(this,bt).isFocused()||Pe(e.target,"wtBorder")||qe(this,nC)===e.target||!qe(this,bt)))if(Zo(this,nC,n.elementFromPoint(e.clientX,e.clientY)),this.targetIsCellWithComment(e)){const r=this.hot._createCellRange(this.hot.getCoords(e.target));qe(this,qr).show(r)}else ws(e.target,n)&&!this.targetIsCommentTextArea(e)&&qe(this,qr).hide()}onMouseUp(){Zo(this,Dd,!1)}onAfterRenderer(e,n){n[Jo]&&n[Jo][Iu]&&te(e,n.commentedCellClassName)}onEditorBlur(){Zo(this,Fd,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}onEditorFocus(){Zo(this,Fd,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(tC)}onEditorMouseDown(e){Zo(this,Ld,{width:ct(e.target),height:kt(e.target)})}onEditorMouseUp(e){const n=ct(e.target),r=kt(e.target);(n!==qe(this,Ld).width+1||r!==qe(this,Ld).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[kx]:{width:n,height:r}})}onAfterDocumentKeyDown(e){qe(this,bt).isVisible()&&br(e)}onAfterScroll(){qe(this,Nd)||this.hide()}addToContextMenu(e){e.items.push({name:je},xZ(this),_Z(this),OZ(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[bc];if($e(e))return e.displayDelay}getEditorInputElement(){return qe(this,bt).getInputElement()}destroy(){qe(this,bt)&&qe(this,bt).destroy(),qe(this,qr)&&qe(this,qr).destroy(),super.destroy()}}var Dx=pA,LZ=TypeError,FZ=function(t,e){if(!delete t[e])throw LZ("Cannot delete property "+Dx(e)+" of "+Dx(t))},$Z=Ml,VZ=dm,BZ=gm,WZ=PA,UZ=FZ,zZ=kA,jZ=[].unshift(0)!==1,YZ=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},GZ=jZ||!YZ();$Z({target:"Array",proto:!0,arity:1,forced:GZ},{unshift:function(e){var n=VZ(this),r=BZ(n),o=arguments.length;if(o){zZ(r+o);for(var i=r;i--;){var s=i+o;i in n?n[s]=n[i]:UZ(n,s)}for(var l=0;l<o;l++)n[l]=arguments[l]}return WZ(n,r+o)}});class ID{constructor(e){this.hot=e,this.commands={},this.commonCallback=null}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];const i=e.split(":"),s=i[0],l=i.length===2?i[1]:null;let a=this.commands[s];if(!a)throw new Error(`Menu command '${s}' not exists.`);if(l&&a.submenu&&(a=KZ(l,a.submenu.items)),a.disabled===!0||typeof a.disabled=="function"&&a.disabled.call(this.hot)===!0||Pt(a,"submenu"))return;const u=[];typeof a.callback=="function"&&u.push(a.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(i.join(":")),O(u,c=>c.apply(this.hot,r))}}function KZ(t,e){let n;return O(e,r=>{const o=r.key?r.key.split(":"):null;if(Array.isArray(o)&&o[1]===t)return n=r,!1}),n}class AD{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.hot=e,this.predefinedItems=_D(),this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ue(e,(r,o)=>{let i="";r.name===je?(n[je]=r,i=je):isNaN(parseInt(o,10))?(r.key=r.key===void 0?o:r.key,n[o]=r,i=r.key):(n[r.key]=r,i=r.key),this.defaultOrderPattern.push(i)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return XZ(e,this.defaultOrderPattern,this.predefinedItems)}}function XZ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let o=t;return o&&o.items?o=o.items:Array.isArray(o)||(o=e),$e(o)?Ue(o,(i,s)=>{let l=n[typeof i=="string"?i:s];l||(l=i),$e(i)?Zt(l,i):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=s),r.push(l)}):O(o,(i,s)=>{let l=n[i];!l&&TZ.indexOf(i)>=0||(l||(l={name:i,key:`${s}`}),$e(i)&&Zt(l,i),l.key===void 0&&(l.key=s),r.push(l))}),r}class qZ{constructor(e,n){const r=n.scrollY,o=n.scrollX;let i,s,l,a,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(i=parseInt(e.top,10),l=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=i,a=l,i+=r,l+=o):this.type==="event"&&(i=parseInt(e.pageY,10),l=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=i-r,a=l-o),this.top=i,this.topRelative=s,this.left=l,this.leftRelative=a,this.scrollTop=r,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Au(t,e,n){QZ(t,e),e.set(t,n)}function QZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ke(t,e){var n=HD(t,e,"get");return ZZ(t,n)}function ZZ(t,e){return e.get?e.get.call(t):e.value}function $d(t,e,n){var r=HD(t,e,"set");return JZ(t,r,n),n}function HD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function JZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Vn=new WeakMap,Fi=new WeakMap,wn=new WeakMap,rC=new WeakMap,jl=new WeakMap;class eJ{constructor(e){Au(this,Vn,{writable:!0,value:void 0}),Au(this,Fi,{writable:!0,value:void 0}),Au(this,wn,{writable:!0,value:void 0}),Au(this,rC,{writable:!0,value:!1}),Au(this,jl,{writable:!0,value:{above:0,below:0,left:0,right:0}}),$d(this,rC,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ke(this,jl)[e]=n,this}setElement(e){return $d(this,Vn,e),this}setParentElement(e){return $d(this,Fi,e),this}updatePosition(e){$d(this,wn,new qZ(e,Ke(this,Vn).ownerDocument.defaultView)),Ke(this,rC)?(Ke(this,wn).fitsBelow(Ke(this,Vn))?this.setPositionBelowCursor():Ke(this,wn).fitsAbove(Ke(this,Vn))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ke(this,Vn).dir==="rtl"?Ke(this,wn).fitsOnLeft(Ke(this,Vn))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ke(this,wn).fitsOnRight(Ke(this,Vn))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ke(this,jl).above+Ke(this,wn).top-Ke(this,Vn).offsetHeight;Ke(this,Fi)&&(e=Ke(this,wn).top+Ke(this,wn).cellHeight-Ke(this,Vn).offsetHeight+3),Ke(this,Vn).style.top=`${e}px`}setPositionBelowCursor(){let e=Ke(this,jl).below+Ke(this,wn).top+1;Ke(this,Fi)&&(e=Ke(this,wn).top-1),Ke(this,Vn).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ke(this,wn).left;if(Ke(this,Fi)){const{right:n}=Ke(this,Fi).getBoundingClientRect();e+=Ke(this,wn).cellWidth+n-(Ke(this,wn).left+Ke(this,wn).cellWidth)}else e+=Ke(this,jl).right;Ke(this,Vn).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ke(this,jl).left+Ke(this,wn).left-Ke(this,Vn).offsetWidth;if(Ke(this,Fi)){const{left:n}=Ke(this,Fi).getBoundingClientRect();e-=Ke(this,wn).left-n}Ke(this,Vn).style.left=`${e}px`}}function tJ(t){return We(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function oC(t){return Pt(t,"submenu")}function Nx(t){return new RegExp(je,"i").test(t.name)}function iC(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function sC(t){return Pt(t,"disableSelection")}function nJ(t){return Pe(t,"htSeparator")}function rJ(t){return Pe(t,"htSubmenu")}function oJ(t){return Pe(t,"htDisabled")}function iJ(t){return Pe(t,"htSelectionDisabled")}function sJ(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function PD(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function lJ(t,e){let n=t.slice(0);return n.reverse(),n=PD(n,e),n.reverse(),n}function aJ(t){const e=[];return O(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function uJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:je,n=t.slice(0);return n=PD(n,e),n=lJ(n,e),n=aJ(n),n}function cJ(t,e){kD(t,e),e.add(t)}function Vd(t,e,n){kD(t,e),e.set(t,n)}function kD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ju(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Mt(t,e){var n=DD(t,e,"get");return hJ(t,n)}function hJ(t,e){return e.get?e.get.call(t):e.value}function zn(t,e,n){var r=DD(t,e,"set");return dJ(t,r,n),n}function DD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function dJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Pa=new WeakMap,jt=new WeakMap,ss=new WeakMap,qi=new WeakMap,ia=new WeakSet;class fJ{constructor(){cJ(this,ia),Vd(this,Pa,{writable:!0,value:void 0}),Vd(this,jt,{writable:!0,value:-1}),Vd(this,ss,{writable:!0,value:-1}),Vd(this,qi,{writable:!0,value:new Set})}setMenu(e){zn(this,Pa,e)}selectFirst(){Mt(this,qi).clear(),zn(this,jt,0),zn(this,ss,Mt(this,jt)-1),Ju(this,ia,ec).call(this)}selectLast(){Mt(this,qi).clear(),zn(this,jt,Mt(this,Pa).countRows()-1),zn(this,ss,Mt(this,jt)+1),Ju(this,ia,ec).call(this)}selectNext(){Mt(this,qi).clear(),zn(this,jt,Mt(this,jt)+1),Ju(this,ia,ec).call(this)}selectPrev(){Mt(this,qi).clear(),zn(this,jt,Mt(this,jt)-1),Ju(this,ia,ec).call(this)}clear(){Mt(this,qi).clear(),zn(this,ss,-1),zn(this,jt,-1)}}function ec(){const t=Mt(this,Pa).countRows()-1;if(Mt(this,jt)<0&&(zn(this,jt,t),zn(this,ss,t)),Mt(this,jt)>t&&(zn(this,jt,0),zn(this,ss,-1)),Mt(this,qi).has(Mt(this,jt)))return;const e=Mt(this,Pa).getCell(Mt(this,jt),0);Mt(this,qi).add(Mt(this,jt)),!e||nJ(e)||oJ(e)||iJ(e)?(zn(this,jt,Mt(this,jt)+(Mt(this,jt)>Mt(this,ss)?1:-1)),Ju(this,ia,ec).call(this)):Mt(this,Pa).selectCell(Mt(this,jt),0),zn(this,ss,Mt(this,jt))}const Lx=215,ND="menu",gJ=ND;class au{constructor(e,n){this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:Lx,container:this.hot.rootDocument.documentElement},this.eventManager=new Dt(this),this.container=this.createContainer(this.options.name),this.positioner=new eJ(this.options.keepInViewport),this.navigator=new fJ,this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this._afterScrollCallback=null,this.registerEvents()}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Xc(e)}setMenuItems(e){this.menuItems=e}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=j0(h=>this.openSubMenu(h),300),n=this.options.minWidth||Lx;let r=!1,o=Rr(this.menuItems,h=>(h.key===ih&&(r=!0),sJ(h,this.hot)));if(o.length<1&&!r)o.push(_D()[ih]);else if(o.length===0)return;o=uJ(o,je);let i=!1;const s={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(h){return he(h)&&h<n?n:h},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:(h,f,g,p,y,E)=>this.menuItemRenderer(h,f,g,p,y,E)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,afterOnCellMouseOver:(h,f)=>{this.isAllSubMenusClosed()?e(f.row):this.openSubMenu(f.row)},rowHeights:h=>o[h].name===je?1:23,afterOnCellContextMenu:h=>{h.preventDefault(),Sy()&&i&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(h,f,g,p,y)=>{this.hotMenu.view.isMouseDown()&&(y.value=!0)},beforeOnCellMouseUp:h=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(h))},afterOnCellMouseUp:h=>{(!Sy()||!Ts(h))&&i&&this.hasSelectedItem()&&(pi()||q0()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),this.hotMenu.listen(),this.navigator.setMenu(this.hotMenu);const l=this.hotMenu.getShortcutManager(),a=l.addContext(gJ),c={...{group:ND},runOnlyIf:h=>!Zc(h.target)||!this.container.contains(h.target)};l.setActiveContextName("menu"),a.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:this.hot.getShortcutManager().getContext("grid"),callback:()=>this.close(!0)},{keys:[["Escape"]],callback:()=>this.close(!0)},{keys:[["ArrowDown"]],callback:()=>this.navigator.selectNext()},{keys:[["ArrowUp"]],callback:()=>this.navigator.selectPrev()},{keys:[["ArrowRight"]],callback:()=>{const h=this.hotMenu.getSelectedLast();if(h){const f=this.openSubMenu(h[0]);f&&f.navigator.selectFirst()}}},{keys:[["ArrowLeft"]],callback:()=>{this.hotMenu.getSelectedLast()&&this.isSubMenu()&&(this.close(),this.isSubMenu()&&this.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>this.navigator.selectFirst()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>this.navigator.selectLast()},{keys:[["Enter"],["Space"]],callback:h=>{const f=this.hotMenu.getSelectedLast();this.hotMenu.getSourceDataAtRow(f[0]).submenu?this.openSubMenu(f[0]).navigator.selectFirst():(this.executeCommand(h),this.close(!0))}},{keys:[["PageUp"]],callback:()=>{this.hotMenu.getSelectedLast()?this.hotMenu.selection.transformStart(-this.hotMenu.countVisibleRows(),0):this.navigator.selectFirst()}},{keys:[["PageDown"]],callback:()=>{this.hotMenu.getSelectedLast()?this.hotMenu.selection.transformStart(this.hotMenu.countVisibleRows(),0):this.navigator.selectLast()}}],c),this.runLocalHooks("afterOpen")}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(this.navigator.clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);He(r,[Fr(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!rJ(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),o=new au(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(r.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=o,this.hot.getSettings().ariaTags&&He(n,[Fr(!0)]),o}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const o=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&He(o,[Fr(!1)])}}closeAllSubMenus(){O(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),o=r?tJ(r):[];this.runLocalHooks("executeCommand",n.key,o,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,o,e)}isCommandPassive(e){return e.isCommand===!1||Nx(e)||iC(e,this.hot)||oC(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}menuItemRenderer(e,n,r,o,i,s){const l=e.getSourceDataAtRow(r),a=this.hot.rootDocument.createElement("div");let u=s;typeof u=="function"&&(u=u.call(this.hot)),go(n),te(a,"htItemWrapper"),this.hot.getSettings().ariaTags&&He(n,[k3(),B3(u),...iC(l,this.hot)?[W3()]:[],...oC(l)?[Fr(!1)]:[]]),n.appendChild(a),Nx(l)?te(n,"htSeparator"):typeof l.renderer=="function"?(te(n,"htCustomMenuRenderer"),n.appendChild(l.renderer(e,a,r,o,i,u))):Ol(a,u),iC(l,this.hot)?(te(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",()=>e.deselectCell())):sC(l)?(te(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",()=>e.deselectCell())):oC(l)?(te(n,"htSubmenu"),sC(l)?this.eventManager.addEventListener(n,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(n,"mouseenter",()=>e.selectCell(r,o,void 0,void 0,!1,!1))):(ke(n,["htSubmenu","htDisabled"]),sC(l)?this.eventManager.addEventListener(n,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(n,"mouseenter",()=>e.selectCell(r,o,void 0,void 0,!1,!1)))}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,o;return r&&(wt(r)&&(r=r.call(this.hot),r===null||vt(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,o=n.querySelector(`.${this.options.className}.${r}`)),o||(o=n.createElement("div"),te(o,`htMenu ${this.options.className}`),r&&te(o,r),this.options.container.appendChild(o)),o}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,o=e.holder.style,i=parseInt(r.width,10),s=Gt(n,(l,a)=>l+(a.name===je?1:26),0);o.width=`${i+3}px`,o.height=`${s+3}px`,r.height=o.height,this.hot.getSettings().ariaTags&&He(this.hotMenu.rootElement,[P3()])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ws(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ws(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Pe(e.target,"htCore")&&ws(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}gt(au,cr);const tc="contextMenu",mJ=70,Fx=tc;me.getSingleton().register("afterContextMenuDefaultOptions");me.getSingleton().register("beforeContextMenuShow");me.getSingleton().register("afterContextMenuShow");me.getSingleton().register("afterContextMenuHide");me.getSingleton().register("afterContextMenuExecute");class hp extends ot{static get PLUGIN_KEY(){return tc}static get PLUGIN_PRIORITY(){return mJ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[ap,up,je,Ph,kh,je,lp,Nh,je,cp,sp,je,Dh,je,Pr]}constructor(e){super(e),this.eventManager=new Dt(this),this.commandExecutor=new ID(this.hot),this.itemsFactory=null,this.menu=null}isEnabled(){return!!this.hot.getSettings()[tc]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[tc];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new au(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e.executeCommand.call(e,...o)}),this.addHook("afterOnCellContextMenu",r=>this.onAfterOnCellContextMenu(r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.unregisterShortcuts(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","\\"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=Vg(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height})},runOnlyIf:()=>this.hot.getSelectedRangeLast()&&!this.menu.isOpened(),group:Fx})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Fx)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ue(r,(o,i)=>{this.menu.setOffset(i,o)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new AD(this.hot,hp.DEFAULT_ITEMS);const e=this.hot.getSettings()[tc],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),O(r,o=>this.commandExecutor.registerCommand(o.key,o))}onAfterOnCellContextMenu(e){const n=this.hot.getSettings(),r=n.rowHeaders,o=n.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=e.target;if(this.close(),Pe(s,"handsontableInput")||(e.preventDefault(),e.stopPropagation(),!(r||o)&&!i(s)&&!(Pe(s,"current")&&Pe(s,"wtBorder"))))return;const l=Vg(this.menu.container,this.hot.rootDocument);this.open({top:e.clientY+l.top,left:e.clientX+l.left})}onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}hp.SEPARATOR={name:je};function pJ(t){return{key:"copy",name(){return this.getTranslatedPhrase(WR)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function wJ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?wr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(jR,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function CJ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?wr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(zR,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function vJ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?wr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(UR,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function yJ(t){return{key:"cut",name(){return this.getTranslatedPhrase(YR)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class SJ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class RJ{constructor(){this.clipboardData=new SJ}}function $x(t,e){LD(t,e),e.add(t)}function Yl(t,e,n){LD(t,e),e.set(t,n)}function LD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bd(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Wn(t,e){var n=FD(t,e,"get");return bJ(t,n)}function bJ(t,e){return e.get?e.get.call(t):e.value}function Gl(t,e,n){var r=FD(t,e,"set");return EJ(t,r,n),n}function FD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function EJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var $i=new WeakMap,lC=new WeakMap,Hu=new WeakMap,Gy=new WeakMap,Ky=new WeakMap,Pu=new WeakMap,Wd=new WeakSet,Vx=new WeakSet;class TJ{constructor(e){let{countRows:n,countColumns:r,rowsLimit:o,columnsLimit:i,countColumnHeaders:s}=e;$x(this,Vx),$x(this,Wd),Yl(this,$i,{writable:!0,value:void 0}),Yl(this,lC,{writable:!0,value:void 0}),Yl(this,Hu,{writable:!0,value:void 0}),Yl(this,Gy,{writable:!0,value:void 0}),Yl(this,Ky,{writable:!0,value:void 0}),Yl(this,Pu,{writable:!0,value:void 0}),Gl(this,lC,n),Gl(this,Hu,r),Gl(this,Gy,o),Gl(this,Ky,i),Gl(this,Pu,s)}setSelectedRange(e){Gl(this,$i,e)}getCellsRange(){if(Wn(this,lC).call(this)===0||Wn(this,Hu).call(this)===0)return null;const{row:e,col:n}=Wn(this,$i).getTopStartCorner(),{row:r,col:o}=Wn(this,$i).getBottomEndCorner(),i=Bd(this,Vx,MJ).call(this,e,r),s=Bd(this,Wd,aC).call(this,n,o);return{isRangeTrimmed:r!==i||o!==s,startRow:e,startCol:n,endRow:i,endCol:s}}getMostBottomColumnHeadersRange(){if(Wn(this,Hu).call(this)===0||Wn(this,Pu).call(this)===0)return null;const{col:e}=Wn(this,$i).getTopStartCorner(),{col:n}=Wn(this,$i).getBottomEndCorner(),r=Bd(this,Wd,aC).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Wn(this,Hu).call(this)===0||Wn(this,Pu).call(this)===0)return null;const{col:e}=Wn(this,$i).getTopStartCorner(),{col:n}=Wn(this,$i).getBottomEndCorner(),r=Bd(this,Wd,aC).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Wn(this,Pu).call(this),startCol:e,endRow:-1,endCol:r}}}function aC(t,e){return Math.min(e,Math.max(t+Wn(this,Ky).call(this)-1,t))}function MJ(t,e){return Math.min(e,Math.max(t+Wn(this,Gy).call(this)-1,t))}function $D(t){const e=[],n=[];return O(t,r=>{const o=Math.min(r.startRow,r.endRow),i=Math.max(r.startRow,r.endRow);ye(o,i,a=>{e.indexOf(a)===-1&&e.push(a)});const s=Math.min(r.startCol,r.endCol),l=Math.max(r.startCol,r.endCol);ye(s,l,a=>{n.indexOf(a)===-1&&n.push(a)})}),{rows:e,columns:n}}function Ud(t,e){VD(t,e),e.add(t)}function zs(t,e,n){VD(t,e),e.set(t,n)}function VD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ku(t,e,n){return e=xJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xJ(t){var e=_J(t,"string");return typeof e=="symbol"?e:String(e)}function _J(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hr(t,e){var n=BD(t,e,"get");return OJ(t,n)}function OJ(t,e){return e.get?e.get.call(t):e.value}function Kl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ei(t,e,n){var r=BD(t,e,"set");return IJ(t,r,n),n}function BD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function IJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}me.getSingleton().register("afterCopyLimit");me.getSingleton().register("modifyCopyableRange");me.getSingleton().register("beforeCut");me.getSingleton().register("afterCut");me.getSingleton().register("beforePaste");me.getSingleton().register("afterPaste");me.getSingleton().register("beforeCopy");me.getSingleton().register("afterCopy");const zd="copyPaste",AJ=80,HJ=["fragmentSelection"],Bx=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var uC=new WeakMap,cC=new WeakMap,hC=new WeakMap,Xl=new WeakMap,jd=new WeakMap,Yd=new WeakMap,ql=new WeakMap,dC=new WeakSet,Wx=new WeakSet,Ux=new WeakSet,fC=new WeakSet;class PJ extends ot{constructor(){super(...arguments),Ud(this,fC),Ud(this,Ux),Ud(this,Wx),Ud(this,dC),ku(this,"columnsLimit",1/0),ku(this,"rowsLimit",1/0),ku(this,"pasteMode","overwrite"),ku(this,"uiContainer",this.hot.rootDocument.body),zs(this,uC,{writable:!0,value:!1}),zs(this,cC,{writable:!0,value:!1}),zs(this,hC,{writable:!0,value:!1}),zs(this,Xl,{writable:!0,value:"cells-only"}),zs(this,jd,{writable:!0,value:!1}),zs(this,Yd,{writable:!0,value:!1}),zs(this,ql,{writable:!0,value:new TJ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),ku(this,"copyableRanges",[])}static get PLUGIN_KEY(){return zd}static get SETTING_KEYS(){return[zd,...HJ]}static get PLUGIN_PRIORITY(){return AJ}isEnabled(){return!!this.hot.getSettings()[zd]}enablePlugin(){var e=this;if(this.enabled)return;const{[zd]:n}=this.hot.getSettings();if(typeof n=="object"){var r,o;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,ei(this,uC,!!n.copyColumnHeaders),ei(this,cC,!!n.copyColumnGroupHeaders),ei(this,hC,!!n.copyColumnHeadersOnly),this.uiContainer=(o=n.uiContainer)!==null&&o!==void 0?o:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",i=>this.onAfterContextMenuDefaultOptions(i)),this.addHook("afterSelectionEnd",()=>this.onAfterSelectionEnd()),this.eventManager=new Dt(this),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),K0()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){return e.onSafariMouseEnter(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){return e.onSafariMouseLeave(...arguments)}),this.addHook("afterSelection",()=>this.onSafariAfterSelection())),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";ei(this,Xl,e),ei(this,jd,!0),Kl(this,dC,zx).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){ei(this,Yd,!0),Kl(this,dC,zx).call(this,"cut")}getRangedCopyableData(e){return yc(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:o}=$D(e);return O(r,i=>{const s=[];O(o,l=>{i<0?s.push(this.hot.getColHeader(l,i)):s.push(this.hot.getCopyableData(i,l))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new RJ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}hr(this,ql).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);hr(this,Xl)==="column-headers-only"?n.set("headers",hr(this,ql).getMostBottomColumnHeadersRange()):(hr(this,Xl)==="with-column-headers"?n.set("headers",hr(this,ql).getMostBottomColumnHeadersRange()):hr(this,Xl)==="with-column-group-headers"&&n.set("headers",hr(this,ql).getAllColumnHeadersRange()),n.set("cells",hr(this,ql).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(o=>o!==null).map(o=>{let{startRow:i,startCol:s,endRow:l,endCol:a}=o;return{startRow:i,startCol:s,endRow:l,endCol:a}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:o,startCol:i,endRow:s,endCol:l}=r;this.hot.runHooks("afterCopyLimit",s-o+1,l-i+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,o=e[0].length,i=[],{row:s,col:l}=n.getTopStartCorner(),{row:a,col:u}=n.getBottomEndCorner();let c=s,h=l,f=s,g=l;for(;i.length<r||c<=a;){const{skipRowOnPaste:p,visualRow:y}=this.hot.getCellMeta(c,l);if(c=y+1,p===!0)continue;f=y,h=l;const E=[],w=i.length%r;for(;E.length<o||h<=u;){const{skipColumnOnPaste:C,visualCol:S}=this.hot.getCellMeta(s,h);if(h=S+1,C===!0)continue;g=S;const T=E.length%o;E.push(e[w][T])}i.push(E)}return this.hot.populateFromArray(s,l,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,l,f,g]}onCopy(e){if(!this.hot.isListening()&&!hr(this,jd)||this.isEditorOpened())return;this.setCopyableText(),ei(this,jd,!1);const n=this.getRangedData(this.copyableRanges),r=Kl(this,Wx,kJ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const i=yc(n);if(e&&e.clipboardData){const s=xy(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[Bx,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}ei(this,Xl,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!hr(this,Yd)||this.isEditorOpened())return;this.setCopyableText(),ei(this,Yd,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const o=yc(n);if(e&&e.clipboardData){const i=xy(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[Bx,i].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const l=_m(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});l&&/(<table)|(<TABLE)/g.test(l)?n=PP(l,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=d9(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,o,i,s]=this.populateValues(n);this.hot.selectCell(r,o,Math.min(this.hot.countRows()-1,i),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}onAfterContextMenuDefaultOptions(e){e.items.push({name:"---------"},pJ(this)),hr(this,uC)&&e.items.push(vJ(this)),hr(this,cC)&&e.items.push(CJ(this)),hr(this,hC)&&e.items.push(wJ(this)),e.items.push(yJ(this))}onAfterSelectionEnd(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}onSafariMouseEnter(){Kl(this,fC,jx).call(this)}onSafariMouseLeave(){Kl(this,Ux,DJ).call(this)}onSafariAfterSelection(){Kl(this,fC,jx).call(this)}destroy(){super.destroy()}}function zx(t){if(K0()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,o=this.hot.getCell(n,r,!0);o&&aP(o,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function kJ(t){const{rows:e}=$D(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function DJ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&U0(r)}}}function jx(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&z0(r)}}}function WD(t,e){return`border_row${t}col${e}`}function nc(){return{width:1,color:"#000"}}function wi(){return{hide:!0}}function NJ(){return{width:1,color:"#000",cornerVisible:!1}}function gC(t){if(he(t.start)||he(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(he(t.end)||he(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Du(t){return he(t.start)&&(t.left=t.start),he(t.end)&&(t.right=t.end),t}function mC(t,e){return{id:WD(t,e),border:NJ(),row:t,col:e,top:wi(),bottom:wi(),start:wi(),end:wi()}}function LJ(t,e){return Pt(e,"border")&&e.border&&(t.border=e.border),Pt(e,"top")&&he(e.top)&&(e.top?($e(e.top)||(e.top=nc()),t.top=e.top):(e.top=wi(),t.top=e.top)),Pt(e,"bottom")&&he(e.bottom)&&(e.bottom?($e(e.bottom)||(e.bottom=nc()),t.bottom=e.bottom):(e.bottom=wi(),t.bottom=e.bottom)),Pt(e,"start")&&he(e.start)&&(e.start?($e(e.start)||(e.start=nc()),t.start=e.start):(e.start=wi(),t.start=e.start)),Pt(e,"end")&&he(e.end)&&(e.end?($e(e.end)||(e.end=nc()),t.end=e.end):(e.end=wi(),t.end=e.end)),t}function Mi(t,e){let n=!1;return O(t.getSelectedRange(),r=>{r.forAll((o,i)=>{if(o<0||i<0)return;const s=t.getCellMeta(o,i).borders;if(s)if(e){if(!Pt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function dp(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function FJ(t){return t.some(e=>he(e.left)||he(e.right))}function $J(t){return t.some(e=>he(e.start)||he(e.end))}const VJ=new Map([["left","start"],["right","end"]]);function BJ(t){var e;return(e=VJ.get(t))!==null&&e!==void 0?e:t}function WJ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(db);return Mi(this,"bottom")&&(e=dp(e)),e},callback(e,n){const r=Mi(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function UJ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(fb);return Mi(this,e)&&(n=dp(n)),n},callback(n,r){const o=Mi(this,e);t.prepareBorder(r,e,o)}}}function zJ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(gb)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Mi(this)}}}function jJ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(hb);return Mi(this,e)&&(n=dp(n)),n},callback(n,r){const o=Mi(this,e);t.prepareBorder(r,e,o)}}}function YJ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(cb);return Mi(this,"top")&&(e=dp(e)),e},callback(e,n){const r=Mi(this,"top");t.prepareBorder(n,"top",r)}}}function GJ(t,e,n){return e=KJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KJ(t){var e=XJ(t,"string");return typeof e=="symbol"?e:String(e)}function XJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Gd="customBorders",qJ=90;class QJ extends ot{constructor(){super(...arguments),GJ(this,"savedBorders",[])}static get PLUGIN_KEY(){return Gd}static get PLUGIN_PRIORITY(){return qJ}isEnabled(){return!!this.hot.getSettings()[Gd]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.onAfterContextMenuDefaultOptions(e)),this.addHook("init",()=>this.onAfterInit()),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],o=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),o=gC(n));const i=Ya(e),s=th(i);O(e,l=>{s(l).forAll((a,u)=>{O(r,c=>{this.prepareBorderFromCustomAdded(a,u,o,BJ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Ya(e),r=th(n),o=[];return O(e,i=>{r(i).forAll((s,l)=>{O(this.savedBorders,a=>{a.row===s&&a.col===l&&o.push(Du(a))})})}),o}clearBorders(e){e?this.setBorders(e):(O(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const o=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,o,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:o})}prepareBorderFromCustomAdded(e,n,r,o){const i=this.hot.countRows(),s=this.hot.countCols();if(e>=i||n>=s)return;let l=mC(e,n);r&&(l=LJ(l,r),O(this.hot.selection.highlight.customSelections,a=>{if(l.id===a.settings.id)return Object.assign(a.settings,r),l.id=a.settings.id,l.top=a.settings.top,l.bottom=a.settings.bottom,l.start=a.settings.start,l.end=a.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Du(l)),this.insertBorderIntoSettings(l,o)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),o=Math.min(e.to.col,this.hot.countCols()-1);ye(e.from.row,r,i=>{ye(e.from.col,o,s=>{const l=mC(i,s);let a=0;i===e.from.row&&Pt(n,"top")&&(a+=1,l.top=n.top),i===e.to.row&&Pt(n,"bottom")&&(a+=1,l.bottom=n.bottom),s===e.from.col&&Pt(n,"start")&&(a+=1,l.start=n.start),s===e.to.col&&Pt(n,"end")&&(a+=1,l.end=n.end),a>0&&(this.hot.setCellMeta(i,s,"borders",Du(l)),this.insertBorderIntoSettings(l))})})}removeAllBorders(e,n){const r=WD(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,o){let i=this.hot.getCellMeta(e,n).borders;!i||i.border===void 0?i=mC(e,n):i=gC(i),o?(i[r]=wi(),this.countHide(i)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(i,r,o)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,n,"borders",Du(i)))):(i[r]=nc(),this.checkCustomSelectionsFromContextMenu(i,r,o)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,n,"borders",Du(i)))}prepareBorder(e,n,r){O(e,o=>{let{start:i,end:s}=o;if(i.row===s.row&&i.col===s.col)n==="noBorders"?this.removeAllBorders(i.row,i.col):this.setBorder(i.row,i.col,n,r);else switch(n){case"noBorders":ye(i.col,s.col,l=>{ye(i.row,s.row,a=>{this.removeAllBorders(a,l)})});break;case"top":ye(i.col,s.col,l=>{this.setBorder(i.row,l,n,r)});break;case"bottom":ye(i.col,s.col,l=>{this.setBorder(s.row,l,n,r)});break;case"start":ye(i.row,s.row,l=>{this.setBorder(l,i.col,n,r)});break;case"end":ye(i.row,s.row,l=>{this.setBorder(l,s.col,n,r)});break}})}createCustomBorders(e){O(e,n=>{const r=gC(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:o,end:i}=e;return Gt([n,r,o,i],(l,a)=>{let u=l;return a&&a.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=We(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){O(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){O(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=We(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):O(this.savedBorders,(o,i)=>{if(e.id===o.id)return this.savedBorders[i]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let o=!1;return O(this.hot.selection.highlight.customSelections,i=>{if(e.id===i.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(i);return O(s,l=>{l.toggleHiddenClass(n,r)}),o=!0,!1}}),o}checkCustomSelections(e,n,r){const o=this.countHide(e);let i=!1;return o===4?(this.removeAllBorders(e.row,e.col),i=!0):O(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const l=this.hot.view._wt.selectionManager.getBorderInstances(s);O(l,a=>{a.changeBorderStyle(r,e)})}return i=!0,!1}}),i}changeBorderSettings(){const e=this.hot.getSettings()[Gd];if(Array.isArray(e)){const n=kn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=FJ(e),r=$J(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}onAfterContextMenuDefaultOptions(e){this.hot.getSettings()[Gd]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(ub)},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[YJ(this),jJ(this),WJ(this),UJ(this),zJ(this)]}})}onAfterInit(){this.changeBorderSettings()}destroy(){super.destroy()}}const Yx="dragToScroll",ZJ=100;class JJ extends ot{static get PLUGIN_KEY(){return Yx}static get PLUGIN_PRIORITY(){return ZJ}constructor(e){super(e),this.eventManager=new Dt(this),this.boundaries=null,this.callback=null,this.listening=!1}isEnabled(){return!!this.hot.getSettings()[Yx]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>this.setupListening(e)),this.addHook("afterOnCellCornerMouseDown",e=>this.setupListening(e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,o=0;n<this.boundaries.top?o=n-this.boundaries.top:n>this.boundaries.bottom&&(o=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,o)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=Xc(n)}unregisterEvents(){this.eventManager.clear()}setupListening(e){if(Ts(e))return;const n=this.hot.view._wt.wtTable.holder;n!==this.hot.rootWindow&&(this.setBoundaries(n.getBoundingClientRect()),this.setCallback((r,o)=>{r<0?n.scrollLeft-=50:r>0&&(n.scrollLeft+=50),o<0?n.scrollTop-=20:o>0&&(n.scrollTop+=20)}),this.listen())}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}me.getSingleton().register("afterDropdownMenuDefaultOptions");me.getSingleton().register("beforeDropdownMenuShow");me.getSingleton().register("afterDropdownMenuShow");me.getSingleton().register("afterDropdownMenuHide");me.getSingleton().register("afterDropdownMenuExecute");const Ff="dropdownMenu",eee=230,pC="changeType",wC=Ff;class fp extends ot{static get PLUGIN_KEY(){return Ff}static get PLUGIN_PRIORITY(){return eee}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Ph,kh,je,Nh,je,ip,je,Dh,je,Pr]}constructor(e){super(e),this.eventManager=new Dt(this),this.commandExecutor=new ID(this.hot),this.itemsFactory=null,this.menu=null,this.hot.addHook("afterGetColHeader",(n,r)=>this.onAfterGetColHeader(n,r))}isEnabled(){return this.hot.getSettings()[Ff]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new AD(this.hot,fp.DEFAULT_ITEMS);const n=this.hot.getSettings()[Ff],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const o=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new au(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",o),this.menu.setMenuItems(o),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return e.executeCommand.call(e,...s)}),O(o,i=>this.commandExecutor.registerCommand(i.key,i))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:o}=this.hot.getSelectedRangeLast(),i=Vg(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,o.col,!0),l=s.getBoundingClientRect();this.open({left:l.left+i.left,top:l.top+s.offsetHeight+i.top},{left:l.width})}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;return((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader())&&!this.menu.isOpened()},captureCtrl:!0,group:wC},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;return((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isCell())&&!this.menu.isOpened()},group:wC}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wC)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>this.onTableClick(e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ue(r,(o,i)=>{this.menu.setOffset(i,o)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}onTableClick(e){if(e.stopPropagation(),Pe(e.target,pC)){const n=Vg(this.menu.container,this.hot.rootDocument),r=e.target.getBoundingClientRect();this.open({left:r.left+n.left,top:r.top+e.target.offsetHeight+3+n.top},{left:r.width})}}onAfterGetColHeader(e,n){const r=n.parentNode;if(!r)return;const o=r.parentNode.childNodes,i=Array.prototype.indexOf.call(o,r);if(e<0||i!==o.length-1)return;const s=n.querySelector(`.${pC}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const l=this.hot.rootDocument.createElement("button");l.className=pC,l.type="button",l.tabIndex=-1,this.hot.getSettings().ariaTags&&He(l,[ru()]),l.onclick=function(){return!1},n.firstChild.insertBefore(l,n.firstChild.firstChild)}onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}fp.SEPARATOR={name:je};class tee{constructor(e){this.hot=e,this.options={}}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:o}=this._getDataRange(),i=this.options,s=[];return ye(e,r,l=>{const a=[];!i.exportHiddenRows&&this._isHiddenRow(l)||(ye(n,o,u=>{!i.exportHiddenColumns&&this._isHiddenColumn(u)||a.push(this.hot.getDataAtCell(l,u))}),s.push(a))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),o=this.hot.getRowHeader();ye(n,r,i=>{!this.options.exportHiddenRows&&this._isHiddenRow(i)||e.push(o[i])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),o=this.hot.getColHeader();ye(n,r,i=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(i)||e.push(o[i])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,o=0,i=n,s=e]=this.options.range;return r=Math.max(r,0),o=Math.max(o,0),i=Math.min(i,n),s=Math.min(s,e),{startRow:r,startCol:o,endRow:i,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const nee=tee;class CE{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Yn(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=Zt(Yn(CE.DEFAULT_OPTIONS),n),n=Zt(n,e),n.filename=N0(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const ree=CE,oee=String.fromCharCode(13),iee=String.fromCharCode(34),see=String.fromCharCode(10);class lee extends ree{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const o=r.length>0,i=this.dataProvider.getRowHeaders(),s=i.length>0;let l=e.bom?String.fromCharCode(65279):"";return o&&(r=We(r,a=>this._escapeCell(a,!0)),s&&(l+=e.columnDelimiter),l+=r.join(e.columnDelimiter),l+=e.rowDelimiter),O(n,(a,u)=>{u>0&&(l+=e.rowDelimiter),s&&(l+=this._escapeCell(i[u])+e.columnDelimiter),l+=a.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),l}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Vt(e);return r!==""&&(n||r.indexOf(oee)>=0||r.indexOf(iee)>=0||r.indexOf(see)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const aee=lee,uee="csv",Xy={[uee]:aee};function cee(t,e,n){return typeof Xy[t]=="function"?new Xy[t](e,n):null}const hee="exportFile",dee=240;class fee extends ot{static get PLUGIN_KEY(){return hee}static get PLUGIN_PRIORITY(){return dee}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:o}=this.hot,i=this._createTypeFormatter(e,n),s=this._createBlob(i),l=o.URL||o.webkitURL,a=r.createElement("a"),u=`${i.options.filename}.${i.options.fileExtension}`;if(a.download!==void 0){const c=l.createObjectURL(s);a.style.display="none",a.setAttribute("href",c),a.setAttribute("download",u),r.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),r.body.removeChild(a),setTimeout(()=>{l.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Xy[e])throw new Error(`Export format type "${e}" is not supported.`);return cee(e,new nee(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}class UD{constructor(e,n){let{id:r,stateless:o=!0}=n;this.hot=e,this.id=r,this.elements=[],this.hidden=!1,this.stateId=`Filters.component.${this.id}`,this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Bm)}reset(){O(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),O(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}gt(UD,cr);const gp=UD,sh={};function xs(t,e){if(!sh[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=sh[t];let o=e;return r.inputValuesDecorator&&(o=r.inputValuesDecorator(o)),function(i){return n.apply(i.meta.instance,[].concat([i],[o]))}}function sl(t){if(!sh[t])throw Error(`Filter condition "${t}" does not exist.`);return sh[t].descriptor}function Jt(t,e,n){n.key=t,sh[t]={condition:e,descriptor:n}}const hn="none";function gee(){return!0}Jt(hn,gee,{name:Wm,inputsCount:0,showOperators:!1});const Ec="empty";function mee(t){return rn(t.value)}Jt(Ec,mee,{name:Sb,inputsCount:0,showOperators:!0});const $f="not_empty";function pee(t,e){return!xs(Ec,e)(t)}Jt($f,pee,{name:Rb,inputsCount:0,showOperators:!0});const Tc="eq";function wee(t,e){let[n]=e;return Vt(t.value).toLocaleLowerCase(t.meta.locale)===Vt(n)}Jt(Tc,wee,{name:bb,inputsCount:1,showOperators:!0});const Vf="neq";function Cee(t,e){return!xs(Tc,e)(t)}Jt(Vf,Cee,{name:Eb,inputsCount:1,showOperators:!0});const zD="gt";function vee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Jt(zD,vee,{name:Ob,inputsCount:1,showOperators:!0});const jD="gte";function yee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Jt(jD,yee,{name:Ib,inputsCount:1,showOperators:!0});const YD="lt";function See(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Jt(YD,See,{name:Ab,inputsCount:1,showOperators:!0});const GD="lte";function Ree(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Jt(GD,Ree,{name:Hb,inputsCount:1,showOperators:!0});const vE="date_after";function bee(t,e){let[n]=e;const r=ee(t.value,t.meta.dateFormat),o=ee(n,t.meta.dateFormat);return!r.isValid()||!o.isValid()?!1:r.diff(o)>=0}Jt(vE,bee,{name:Db,inputsCount:1,showOperators:!0});const yE="date_before";function Eee(t,e){let[n]=e;const r=ee(t.value,t.meta.dateFormat),o=ee(n,t.meta.dateFormat);return!r.isValid()||!o.isValid()?!1:r.diff(o)<=0}Jt(yE,Eee,{name:Nb,inputsCount:1,showOperators:!0});const Bg="between";function Tee(t,e){let[n,r]=e,o=n,i=r;if(t.meta.type==="numeric"){const s=parseFloat(o,10),l=parseFloat(i,10);o=Math.min(s,l),i=Math.max(s,l)}else if(t.meta.type==="date"){const s=xs(yE,[i]),l=xs(vE,[o]);return s(t)&&l(t)}return t.value>=o&&t.value<=i}Jt(Bg,Tee,{name:Pb,inputsCount:2,showOperators:!0});const KD="not_between";function Mee(t,e){return!xs(Bg,e)(t)}Jt(KD,Mee,{name:kb,inputsCount:2,showOperators:!0});const XD="begins_with";function xee(t,e){let[n]=e;return Vt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Vt(n))}Jt(XD,xee,{name:Tb,inputsCount:1,showOperators:!0});const qD="ends_with";function _ee(t,e){let[n]=e;return Vt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Vt(n))}Jt(qD,_ee,{name:Mb,inputsCount:1,showOperators:!0});const SE="contains";function Oee(t,e){let[n]=e;return Vt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Vt(n))>=0}Jt(SE,Oee,{name:xb,inputsCount:1,showOperators:!0});const QD="not_contains";function Iee(t,e){return!xs(SE,e)(t)}Jt(QD,Iee,{name:_b,inputsCount:1,showOperators:!0});const ZD="date_tomorrow";function Aee(t){const e=ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ee().subtract(-1,"days").startOf("day"),"d"):!1}Jt(ZD,Aee,{name:Fb,inputsCount:0});const JD="date_today";function Hee(t){const e=ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ee().startOf("day"),"d"):!1}Jt(JD,Hee,{name:Lb,inputsCount:0});const eN="date_yesterday";function Pee(t){const e=ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ee().subtract(1,"days").startOf("day"),"d"):!1}Jt(eN,Pee,{name:$b,inputsCount:0});YP();function kee(t,e){let n=t;return n===""&&(n=`(${e})`),n}const qy=new Set([1]).has(1),Dee=qy&&typeof Array.from=="function";function Lh(t){let e=t;return qy&&(e=new Set(e)),function(n){let r;return qy?r=e.has(n):r=!!~e.indexOf(n),r}}function tN(t){return t??""}function Qy(t){let e=t;return Dee?e=Array.from(new Set(e)):e=P0(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function Gx(t,e,n,r){const o=[],i=t===e;let s;return i||(s=Lh(e)),O(t,l=>{let a=!1;(i||s(l))&&(a=!0);const u={checked:a,value:l,visualValue:kee(l,n)};r&&r(u),o.push(u)}),o}const ll="by_value";function Nee(t,e){let[n]=e;return n(t.value)}Jt(ll,Nee,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Lh(e)]},showOperators:!1});const lh={};function Lee(t){if(!lh[t])throw Error(`Operation with id "${t}" does not exist.`);const e=lh[t].func;return function(n,r){return e(n,r)}}function Fee(t){return lh[t].name}function RE(t,e,n){lh[t]={name:e,func:n}}const ys="conjunction",$ee=Wb;function Vee(t,e){return t.every(n=>n.func(e))}RE(ys,$ee,Vee);const Wg="disjunction",Bee=Um;function Wee(t,e){return t.some(n=>n.func(e))}RE(Wg,Bee,Wee);const bE="disjunctionWithExtraCondition",Uee=Um;function zee(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}RE(bE,Uee,zee);const jee="numeric",nN="text",Yee="date",Kx={[jee]:[hn,je,Ec,$f,je,Tc,Vf,je,zD,jD,YD,GD,Bg,KD],[nN]:[hn,je,Ec,$f,je,Tc,Vf,je,XD,qD,je,SE,QD],[Yee]:[hn,je,Ec,$f,je,Tc,Vf,je,yE,vE,Bg,je,ZD,JD,eN]};function Gee(t){const e=[];let n=t;return Kx[n]||(n=nN),O(Kx[n],r=>{let o;r===je?o={name:je}:o=Yn(sl(r)),e.push(o)}),e}const CC="built",vC="building",Xx=["click","input","keydown","keypress","keyup","focus","blur","change"];let rN=class oN{static get DEFAULTS(){return Yn({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){this.hot=e,this.eventManager=new Dt(this),this.options=Zt(oN.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===vC?this._element:this.buildState===CC?(this.update(),this._element):(this.buildState=vC,this.build(),this.buildState=CC,this._element)}isBuilt(){return this.buildState===CC}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Zn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,o=>this.runLocalHooks(r,o,this))};if(this.buildState||(this.buildState=vC),this.options.className&&te(this._element,this.options.className),this.options.children.length)O(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);Ue(this.options,(r,o)=>{n[o]!==void 0&&o!=="className"&&o!=="tagName"&&o!=="children"&&(n[o]=this.translateIfPossible(r))}),this._element.appendChild(n),O(Xx,r=>e(n,r))}else O(Xx,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};gt(rN,cr);const Ss=rN,Kd=new WeakMap;class EE extends Ss{static get DEFAULTS(){return Yn({placeholder:"",type:"text",tagName:"input"})}constructor(e,n){super(e,Zt(EE.DEFAULTS,n)),Kd.set(this,{}),this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick()),this.addLocalHook("keyup",e=>this.onKeyup(e))}build(){super.build();const e=Kd.get(this),n=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,te(this._element,"htUIInput"),te(n,"htUIInputIcon"),this._element.appendChild(n),this.update()}update(){if(!this.isBuilt())return;const e=Kd.get(this).input;e.type=this.options.type,e.placeholder=this.translateIfPossible(this.options.placeholder),e.value=this.translateIfPossible(this.options.value)}focus(){this.isBuilt()&&Kd.get(this).input.focus()}onClick(){}onKeyup(e){this.options.value=e.target.value}}const ka=EE,Xd=new WeakMap;class TE extends Ss{static get DEFAULTS(){return Yn({className:"htUISelect",wrapIt:!1})}constructor(e,n){super(e,Zt(TE.DEFAULTS,n)),Xd.set(this,{}),this.menu=null,this.items=[],this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick())}setItems(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}translateNames(e){return O(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),this.menu=new au(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);const e=new Ss(this.hot,{className:"htUISelectCaption"}),n=new Ss(this.hot,{className:"htUISelectDropdown"}),r=Xd.get(this);r.caption=e,r.captionElement=e.element,r.dropdown=n,O([e,n],o=>this._element.appendChild(o.element)),this.menu.addLocalHook("select",o=>this.onMenuSelect(o)),this.menu.addLocalHook("afterClose",()=>this.onMenuClosed()),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=this.menu.hot.getTranslatedPhrase(Wm),Xd.get(this).captionElement.textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}))}closeOptions(){this.menu&&this.menu.close()}onMenuSelect(e){e.name!==je&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}onMenuClosed(){this.runLocalHooks("afterClose")}onClick(){this.openOptions()}destroy(){this.menu&&(this.menu.destroy(),this.menu=null);const{caption:e,dropdown:n}=Xd.get(this);e&&e.destroy(),n&&n.destroy(),super.destroy()}}const qx=TE;class Kee extends gp{constructor(e,n){super(e,{id:n.id,stateless:!1}),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new qx(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new ka(this.hot,{placeholder:Kb})),this.elements.push(new ka(this.hot,{placeholder:Xb})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>this.onConditionSelect(e)),this.getSelectElement().addLocalHook("afterClose",()=>this.onSelectUIClosed()),O(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>this.onInputKeyDown(n))})}setState(e){if(this.reset(),!e)return;const n=Yn(e.command);n.name.startsWith(Ut)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),O(e.args,(r,o)=>{if(o>n.inputsCount-1)return!1;const i=this.getInputElement(o);i.setValue(r),i[n.inputsCount>o?"show":"hide"](),o||setTimeout(()=>i.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||sl(hn),n=[];return O(this.getInputElements(),(r,o)=>{e.inputsCount>o&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=sl(e?e.name:hn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||O(this.getInputElements(),o=>o.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof qx)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof ka)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,o,i,s)=>{te(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&te(n.parentNode,"border");const l=this.hot.rootDocument.createElement("div");return te(l,"htFiltersMenuLabel"),l.textContent=s,n.appendChild(l),n.parentNode.hasAttribute("ghost-table")||O(this.elements,a=>n.appendChild(a.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[sl(hn)];if(e!==null){const{visualIndex:r}=e;n=Gee(this.hot.getDataType(0,r,this.hot.countRows(),r))}O(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}onConditionSelect(e){O(this.getInputElements(),(n,r)=>{n[e.inputsCount>r?"show":"hide"](),r===0&&setTimeout(()=>n.focus(),10)}),this.runLocalHooks("change",e)}onSelectUIClosed(){this.runLocalHooks("afterClose")}onInputKeyDown(e){za(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),br(e)):za(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),br(e))}}const yC=Kee,qd=new WeakMap;class ME extends Ss{static get DEFAULTS(){return Yn({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,Zt(ME.DEFAULTS,n)),qd.set(this,{})}build(){super.build();const e=qd.get(this);e.input=this._element.firstChild;const n=this.hot.rootDocument.createElement("label");n.textContent=this.translateIfPossible(this.options.label.textContent),n.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=n,this._element.appendChild(n),this.update()}update(){if(!this.isBuilt())return;const e=qd.get(this);e.input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent)}isChecked(){return this.options.checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=e,this.update()}focus(){this.isBuilt()&&qd.get(this).input.focus()}}const Qx=ME,Zx=0;class Xee extends gp{constructor(e,n){super(e,{id:n.id,stateless:!1}),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(te(n.parentNode,"htFiltersMenuOperators"),n.parentNode.hasAttribute("ghost-table")||O(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[ys,Wg];O(e,n=>{const r=new Qx(this.hot,{name:"operator",label:{htmlFor:n,textContent:Fee(n)},value:n,checked:n===e[Zx],id:n});r.addLocalHook("change",o=>this.onRadioInputChange(o)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ht`Radio button with index ${e} doesn't exist.`);O(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Qx&&n.isChecked());return e?e.getValue():ys}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&O(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ys,n=arguments.length>1?arguments[1]:void 0,r=e;r===bE&&(r=Wg),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(Zx)}onRadioInputChange(e){this.setState(e.target.value)}}const qee=Xee,SC=new WeakMap;class xE extends Ss{static get DEFAULTS(){return Yn({href:"#",tagName:"a"})}constructor(e,n){super(e,Zt(xE.DEFAULTS,n)),SC.set(this,{})}build(){super.build();const e=SC.get(this);e.link=this._element.firstChild}update(){this.isBuilt()&&(SC.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}const Jx=xE,Qee=new WeakMap,Zee="multipleSelect.itemBox";class _E extends Ss{static get DEFAULTS(){return Yn({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,Zt(_E.DEFAULTS,n)),Qee.set(this,{}),this.searchInput=new ka(this.hot,{placeholder:Gb,className:"htUIMultipleSelectSearch"}),this.selectAllUI=new Jx(this.hot,{textContent:Ub,className:"htUISelectAll"}),this.clearAllUI=new Jx(this.hot,{textContent:zb,className:"htUIClearAll"}),this.items=[],this.itemsBox=null,this.registerHooks()}registerHooks(){this.searchInput.addLocalHook("keydown",e=>this.onInputKeyDown(e)),this.searchInput.addLocalHook("input",e=>this.onInput(e)),this.selectAllUI.addLocalHook("click",e=>this.onSelectAllClick(e)),this.clearAllUI.addLocalHook("click",e=>this.onClearAllClick(e))}setItems(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}setLocale(e){this.locale=e}getLocale(){return this.locale}getItems(){return[...this.items]}getValue(){return ete(this.items)}isSelectedAllValues(){return this.items.length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new Ss(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(r.element),this._element.appendChild(n);const o=i=>{if(!this._element)return;this.itemsBox&&this.itemsBox.destroy(),te(i,"htUIMultipleSelectHot"),this.itemsBox=new this.hot.constructor(i,{data:this.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(a,u,c,h,f,g)=>{a.title=g.instance.getDataAtRowProp(u,g.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>this.itemsBox.container.scrollWidth-un(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"}),this.itemsBox.init(),this.itemsBox.getShortcutManager().getContext("grid").addShortcut({keys:[["Escape"]],callback:a=>{this.runLocalHooks("keydown",a,this)},group:Zee})};o(n),setTimeout(()=>o(n),100)}reset(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}update(){this.isBuilt()&&(this.itemsBox.loadData(Jee(this.items,this.options.value)),super.update())}destroy(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,super.destroy()}onInput(e){const n=e.target.value.toLocaleLowerCase(this.getLocale());let r;n===""?r=[...this.items]:r=Rr(this.items,o=>`${o.value}`.toLocaleLowerCase(this.getLocale()).indexOf(n)>=0),this.itemsBox.loadData(r)}onInputKeyDown(e){this.runLocalHooks("keydown",e,this),Y0(za,e.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(br(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}onSelectAllClick(e){const n=[];e.preventDefault(),O(this.itemsBox.getSourceData(),(r,o)=>{r.checked=!0,n.push(Dy(r,o)[0])}),this.itemsBox.setSourceDataAtCell(n)}onClearAllClick(e){const n=[];e.preventDefault(),O(this.itemsBox.getSourceData(),(r,o)=>{r.checked=!1,n.push(Dy(r,o)[0])}),this.itemsBox.setSourceDataAtCell(n)}}const e_=_E;function Jee(t,e){const n=Lh(e);return We(t,r=>(r.checked=n(r.value),r))}function ete(t){const e=[];return O(t,n=>{n.checked&&e.push(n.value)}),e}class tte extends gp{constructor(e,n){super(e,{id:n.id,stateless:!1}),this.name=n.name,this.elements.push(new e_(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>this.onInputKeyDown(e))}setState(e){if(this.reset(),e&&e.command.key===ll){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?hn:ll},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,o,i,s,l)=>{const[a]=Rr(o,h=>h.name===ll),u={},c=this.hot.getTranslatedPhrase(Pg);if(a){const h=Qy(We(s(r,l),y=>y.value));i&&(a.args[0]=i);const f=[],g=Gx(h,a.args[0],c,y=>{y.checked&&f.push(y.value)}),p=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,p).locale,u.args=[f],u.command=sl(ll),u.itemsSnapshot=g}else u.args=[],u.command=sl(hn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof e_)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,o,i,s)=>{te(n.parentNode,"htFiltersMenuValue");const l=this.hot.rootDocument.createElement("div");return te(l,"htFiltersMenuLabel"),l.textContent=s,n.appendChild(l),n.parentNode.hasAttribute("ghost-table")||O(this.elements,a=>n.appendChild(a.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Pg),n=Qy(this._getColumnVisibleValues()),r=Gx(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const o=this.hot.getPlugin("filters").getSelectedColumn();o!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,o.visualIndex).locale)}onInputKeyDown(e){za(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),br(e))}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:We(this.hot.getDataAtCol(e.visualIndex),n=>tN(n))}}const nte=tte;class Mc extends gp{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),this.name=n.name,this.elements.push(new ka(this.hot,{type:"button",value:jb,className:"htUIButton htUIButtonOK",identifier:Mc.BUTTON_OK})),this.elements.push(new ka(this.hot,{type:"button",value:Yb,className:"htUIButton htUIButtonCancel",identifier:Mc.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){O(this.elements,e=>{e.addLocalHook("click",(n,r)=>this.onButtonClick(n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(te(n.parentNode,"htFiltersMenuActionBar"),n.parentNode.hasAttribute("ghost-table")||O(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}onButtonClick(e,n){n.options.identifier===Mc.BUTTON_OK?this.accept():this.cancel()}}const rte=Mc,t_="ConditionCollection.filteringStates";class iN{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.hot=e,this.isMapRegistrable=n,this.filteringStates=new Bm,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(t_,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const o=this.filteringStates.getValueAtIndex(n),i=(r=o==null?void 0:o.conditions)!==null&&r!==void 0?r:[],s=o==null?void 0:o.operation;return this.isMatchInConditions(i,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ys;return e.length?Lee(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ys,o=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,e).locale,s=We(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(i):c),l=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const a=this.getOperation(e);if(a){if(a!==r)throw Error(ht`The column of index ${e} has been already applied with a \`${a}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(vt(lh[r]))throw new Error(ht`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:l,args:s,func:xs(l,s)}]},o):u.push({name:l,args:s,func:xs(l,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Gt(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:o,conditions:i}]=n;return e.push({column:r,operation:o,conditions:We(i,s=>{let{name:l,args:a}=s;return{name:l,args:a}})}),e},[])}importAllConditions(e){this.clean(),O(e,n=>{O(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(o=>o.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(t_),this.filteringStates=null,this.clearLocalHooks()}}gt(iN,cr);const sN=iN;class ote{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return O(this.conditionCollection.getFilteredColumns(),(n,r)=>{let o=this.columnDataFactory(n);r&&(o=this._getIntersectData(o,e)),e=this.filterByColumn(n,o)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return O(n,o=>{o!==void 0&&this.conditionCollection.isMatch(o,e)&&r.push(o)}),r}_getIntersectData(e,n){const r=[];return O(n,o=>{const i=o.meta.visualRow;e[i]!==void 0&&(r[i]=e[i])}),r}}const lN=ote;class aN{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",o=>this._onConditionBeforeModify(o)),this.conditionCollection.addLocalHook("afterRemove",o=>this.updateStatesAtColumn(o)),this.conditionCollection.addLocalHook("afterAdd",o=>this.updateStatesAtColumn(o)),this.conditionCollection.addLocalHook("beforeClean",()=>this._onConditionBeforeClean()),this.conditionCollection.addLocalHook("afterClean",()=>this._onConditionAfterClean())}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,O(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}_onConditionBeforeModify(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const o=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(e);i===-1&&(i=this.latestEditedColumnPosition);const s=o.slice(0,i),l=o.slice(i);l.length&&l[0].column===e&&l.shift();const a=cP(function(c,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const g=new sN(r.hot,!1),p=[].concat(c,f);g.importAllConditions(p);const y=r.columnDataFactory(h);let E;g.isEmpty()?E=y:E=new lN(g,C=>r.columnDataFactory(C)).filter(),E=We(E,C=>C.meta.visualRow);const w=Lh(E);return g.destroy(),Rr(y,C=>w(C.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:l,filteredRowsFactory:a,conditionArgsChange:n})}_onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}_onConditionAfterClean(){O(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}destroy(){this.clearLocalHooks(),Ue(this,(e,n)=>{this[n]=null})}}gt(aN,cr);const ite=aN,Zy="filters",ste=250,n_=Zy;class lte extends ot{static get PLUGIN_KEY(){return Zy}static get PLUGIN_PRIORITY(){return ste}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),this.eventManager=new Dt(this),this.dropdownMenuPlugin=null,this.conditionCollection=null,this.conditionUpdateObserver=null,this.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),this.filtersRowsMap=null,this.hot.addHook("afterGetColHeader",(n,r)=>this.onAfterGetColHeader(n,r))}isEnabled(){return!!this.hot.getSettings()[Zy]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Ah),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>this.onActionBarSubmit("accept")),s.addLocalHook("cancel",()=>this.onActionBarSubmit("cancel")),s.addLocalHook("change",l=>this.onComponentChange(s,l)),s),o=()=>`${this.hot.getTranslatedPhrase(Vb)}:`,i=()=>`${this.hot.getTranslatedPhrase(Bb)}:`;if(!this.components.get("filter_by_condition")){const s=new yC(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new qee(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new yC(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition2",r(s))}this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new nte(this.hot,{id:"filter_by_value",name:i}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new rte(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new sN(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new ite(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>this.updateComponents(s))),this.components.forEach(s=>s.show()),this.addHook("beforeDropdownMenuSetItems",s=>this.onBeforeDropdownMenuSetItems(s)),this.addHook("afterDropdownMenuDefaultOptions",s=>this.onAfterDropdownMenuDefaultOptions(s)),this.addHook("afterDropdownMenuShow",()=>this.onAfterDropdownMenuShow()),this.addHook("afterDropdownMenuHide",()=>this.onAfterDropdownMenuHide()),this.addHook("afterChange",s=>this.onAfterChange(s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{this.clearConditions(),this.filter()},group:n_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(n_)}addCondition(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ys;const i=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(i,{command:{key:n},args:r},o)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const e=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let r=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(n){const s=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=We(e.filter(),a=>a.meta.visualRow);const l=Lh(r);ye(this.hot.countSourceRows()-1,a=>{l(a)||s.push(a)}),O(s,a=>{this.filtersRowsMap.setValueAtIndex(a,!0)})},!0),r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render()}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return O(this.hot.getSourceDataAtCol(n),(o,i)=>{var s;const{row:l,col:a,visualCol:u,visualRow:c,type:h,instance:f,dateFormat:g,locale:p}=this.hot.getCellMeta(i,n),y=(s=this.hot.getDataAtCell(this.hot.toVisualRow(i),n))!==null&&s!==void 0?s:o;r.push({meta:{row:l,col:a,visualCol:u,visualRow:c,type:h,instance:f,dateFormat:g,locale:p},value:tN(y)})}),r}onAfterChange(e){e&&O(e,n=>{const[,r]=n,o=this.hot.propToCol(r);this.conditionCollection.hasConditions(o)&&this.updateValueComponentCondition(o)})}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=Qy(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(o=>{o.isHidden()||o.restoreState(r)}),this.updateDependentComponentsVisibility()}onAfterDropdownMenuShow(){this.restoreComponents(Array.from(this.components.values()))}onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}onBeforeDropdownMenuSetItems(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",()=>{this.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}onAfterDropdownMenuDefaultOptions(e){e.items.push({name:je}),this.components.forEach(n=>{e.items.push(n.getMenuItemDescriptor())})}getOperationBasedOnArguments(e,n,r,o){let i=e;return i===Wg&&n.command.key!==hn&&r.command.key!==hn&&o.command.key!==hn?i=bE:o.command.key!==hn&&(n.command.key===hn||r.command.key===hn)&&(i=ys),i}onActionBarSubmit(e){var n;if(e==="accept"){const o=this.getSelectedColumn();if(o===null){var r;(r=this.dropdownMenuPlugin)===null||r===void 0||r.close();return}const{physicalIndex:i}=o,s=this.components.get("filter_by_condition").getState(),l=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),u=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,l,a);this.conditionUpdateObserver.groupChanges();let c=this.conditionCollection.getColumnStackPosition(i);c===-1&&(c=void 0),this.conditionCollection.removeConditions(i),s.command.key!==hn&&(this.conditionCollection.addCondition(i,s,u,c),l.command.key!==hn&&this.conditionCollection.addCondition(i,l,u,c)),a.command.key!==hn&&this.conditionCollection.addCondition(i,a,u,c),this.conditionUpdateObserver.flush(),this.components.forEach(h=>h.saveState(i)),this.filtersRowsMap.clear(),this.filter(),this.hot.selectCell(0,o.visualIndex)}(n=this.dropdownMenuPlugin)===null||n===void 0||n.close()}onComponentChange(e,n){this.updateDependentComponentsVisibility(),e.constructor===yC&&!n.inputsCount&&this.setListeningDropdownMenu()}onSelectUIClosed(){this.setListeningDropdownMenu()}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}onAfterGetColHeader(e,n){const r=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(r)?te(n,"htFiltersActive"):ke(n,"htFiltersActive")}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new lN(e,n=>this.getDataMapAtColumn(n))}updateComponents(e){var n;if(!((n=this.dropdownMenuPlugin)!==null&&n!==void 0&&n.enabled))return;const{editedConditionStack:{conditions:r,column:o}}=e,i=r.filter(l=>l.name===ll),s=r.filter(l=>l.name!==ll);if(i.length>=2||s.length>=3)Ct(ht`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const l=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(s[0],o),this.components.get("filter_by_condition2").updateState(s[1],o),this.components.get("filter_operators").updateState(l,o),this.components.get("filter_by_value").updateState(e)}}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return O(o,s=>{O(n.menuItems,(l,a)=>{l.key===s.getMenuItemDescriptor().key&&e.push(a)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,o=r.getPlugin("hiddenRows");for(var i=arguments.length,s=new Array(i>1?i-1:0),l=1;l<i;l++)s[l-1]=arguments[l];const a=this.getIndexesOfComponents(...s);e?o.showRows(a):o.hideRows(a),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}const uN="internal-use-in-handsontable",Jy={licenseKey:uN,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function cN(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[_n])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function hN(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function ate(t){var e;const n=t[_n],r=hN(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),o=cN(t);return{...Jy,...r,...o}}function ute(t){var e;const n=t[_n],r=hN(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),o=cN(t);return{...r,...o}}function cte(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function mp(){const t="engine_relationship",e=po(_n);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function OE(){const t="shared_engine_usage",e=po(_n);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function hte(t){const e=t.getSettings(),n=e[_n],r=n==null?void 0:n.engine;if(n===!0||vt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var o;return dte((o=r.hyperformula)!==null&&o!==void 0?o:r,e,t)}else if(typeof r=="object"&&vt(r.hyperformula)){const i=mp(),s=OE().get(r);return i.has(r)||i.set(r,[]),i.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:uN}),(r.getConfig().leapYear1900!==Jy.leapYear1900||Pm(r.getConfig().nullDate,Jy.nullDate)===!1)&&Ct(ht`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function dte(t,e,n){const r=e[_n],o=ate(e),i=mp(),s=OE();fte(t,r.functions),gte(t,r.language);const l=t.buildEmpty(o);return i.set(l,[n]),s.set(l,[n.guid]),mte(l,r.namedExpressions),l.on("sheetAdded",()=>{l.rebuildAndRecalculate()}),l.on("sheetRemoved",()=>{l.rebuildAndRecalculate()}),l}function r_(t){var e;const n=mp(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(o=>[o.getPlugin("formulas").sheetId,o]))}function o_(t,e){if(t){const n=mp(),r=n.get(t),o=OE(),i=o.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),i&&i.includes(e.guid)&&(i.splice(i.indexOf(e.guid),1),i.length===0&&(o.delete(t),t.destroy()))}}function fte(t,e){e&&e.forEach(n=>{const{name:r,plugin:o,translations:i}=n;try{t.registerFunction(r,o,i)}catch(s){Ct(s.message)}})}function gte(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){Ct(r.message)}}}function mte(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:o,scope:i,options:s}=n;try{t.addNamedExpression(r,o,i,s)}catch(l){Ct(l.message)}}),t.resumeEvaluation())}function pte(t,e){return(vt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const dN="DD/MM/YYYY";function fN(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function wte(t){return fN(t)?t.substr(1):t}function Cte(t){return typeof t=="string"&&t.startsWith("=")}function RC(t,e){return typeof t=="string"&&e==="date"}function i_(t,e){return ee(t,e,!0).isValid()}function s_(t,e){return ee(t,e,!0).format(dN)}function vte(t,e){return ee(t,dN,!0).format(e)}function l_(t,e){const r=new Date(Date.UTC(0,0,t+-1));return ee(r).format(e)}function js(t,e,n){yte(t,e),e.set(t,n)}function yte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Et(t,e){var n=gN(t,e,"get");return Ste(t,n)}function Ste(t,e){return e.get?e.get.call(t):e.value}function Vi(t,e,n){var r=gN(t,e,"set");return Rte(t,r,n),n}function gN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Rte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Nu=new WeakMap,Bi=new WeakMap,dr=new WeakMap,Qd=new WeakMap,bC=new WeakMap,EC=new WeakMap,Zd=new WeakMap;class bte{constructor(e,n,r){js(this,Nu,{writable:!0,value:void 0}),js(this,Bi,{writable:!0,value:void 0}),js(this,dr,{writable:!0,value:void 0}),js(this,Qd,{writable:!0,value:[]}),js(this,bC,{writable:!0,value:[]}),js(this,EC,{writable:!0,value:void 0}),js(this,Zd,{writable:!0,value:[]}),Vi(this,Nu,e),Vi(this,Bi,n),Vi(this,dr,r)}setRemovedHfIndexes(e){return Vi(this,Zd,e.map(n=>{const r=Et(this,Bi).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Et(this,Zd)}getRemovedHfIndexes(){return Et(this,Zd)}getHfIndexFromVisualIndex(e){const n=Et(this,Bi).getIndexesSequence(),r=Et(this,Bi).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${Hn(Et(this,Nu))}s`;Et(this,dr).getEngine().batch(()=>{e.forEach(o=>{const i=o.from!==o.to,s=o.from+1!==o.to;i&&s&&Et(this,dr).getEngine()[r](Et(this,dr).getSheetId(),o.from,1,o.to)})})}storeMovesInformation(e,n,r){r!==!1&&(Vi(this,bC,e.map(o=>this.getHfIndexFromVisualIndex(o))),Vi(this,EC,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=Et(this,Bi).getNumberOfIndexes(),o=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var i;return(i=o[n])!==null&&i!==void 0?i:0}return o[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const o=[];return e.forEach(i=>{const s={from:i,to:r};o.forEach(l=>{const a=l.from>l.to,u=l.to<=s.from;l.from>s.from&&u&&a&&(s.from+=1)}),s.from>=r&&(r+=1),o.push(s)}),o}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(i=>{const s=i.from<i.to;i.from>n.from&&s&&(i.from-=1)})}),e}calculateAndSyncMoves(e,n){if(Et(this,dr).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(Et(this,bC),Et(this,EC)));Et(this,dr).getSheetId()===null?Et(this,dr).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Hn(Et(this,Nu))}Order`;return n=>{if(Et(this,dr).isPerformingUndoRedo())return;const r=Et(this,Bi).getIndexesSequence();if(n==="update"){const o=Et(this,Qd).map(a=>r.indexOf(a)),i=Et(this,dr).getEngine().getSheetDimensions(Et(this,dr).getSheetId());let s;Et(this,Nu)==="row"?s=i.height:s=i.width;const l=o.length;for(let a=l;a<s;a+=1)o.push(a);Et(this,dr).getEngine()[e](Et(this,dr).getSheetId(),o)}Vi(this,Qd,r)}}init(){Vi(this,Qd,Et(this,Bi).getIndexesSequence())}}const a_=bte;function Ys(t,e,n){Ete(t,e),e.set(t,n)}function Ete(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ti(t,e){var n=mN(t,e,"get");return Tte(t,n)}function Tte(t,e){return e.get?e.get.call(t):e.value}function Gs(t,e,n){var r=mN(t,e,"set");return Mte(t,r,n),n}function mN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Mte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Jd=new WeakMap,ef=new WeakMap,TC=new WeakMap,MC=new WeakMap,xC=new WeakMap,_C=new WeakMap,OC=new WeakMap;class xte{constructor(e,n,r){Ys(this,Jd,{writable:!0,value:void 0}),Ys(this,ef,{writable:!0,value:void 0}),Ys(this,TC,{writable:!0,value:void 0}),Ys(this,MC,{writable:!0,value:!1}),Ys(this,xC,{writable:!0,value:!1}),Ys(this,_C,{writable:!0,value:null}),Ys(this,OC,{writable:!0,value:null}),Gs(this,Jd,new a_("row",e,this)),Gs(this,ef,new a_("column",n,this)),Gs(this,TC,r)}getForAxis(e){return e==="row"?ti(this,Jd):ti(this,ef)}setPerformUndo(e){Gs(this,MC,e)}setPerformRedo(e){Gs(this,xC,e)}isPerformingUndoRedo(){return ti(this,MC)||ti(this,xC)}getSheetId(){return ti(this,OC)}getEngine(){return ti(this,_C)}getPostponeAction(){return ti(this,TC)}setupSyncEndpoint(e,n){Gs(this,_C,e),Gs(this,OC,n),ti(this,Jd).init(),ti(this,ef).init()}}const _te=xte;function Ql(t,e,n){return e=Ote(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ote(t){var e=Ite(t,"string");return typeof e=="symbol"?e:String(e)}function Ite(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IC(t,e,n){Ate(t,e),e.set(t,n)}function Ate(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wi(t,e,n){var r=pN(t,e,"set");return Hte(t,r,n),n}function Hte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Zl(t,e){var n=pN(t,e,"get");return Pte(t,n)}function pN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Pte(t,e){return e.get?e.get.call(t):e.value}const _n="formulas",kte=["maxRows","maxColumns","language"],Dte=260;me.getSingleton().register("afterNamedExpressionAdded");me.getSingleton().register("afterNamedExpressionRemoved");me.getSingleton().register("afterSheetAdded");me.getSingleton().register("afterSheetRemoved");me.getSingleton().register("afterSheetRenamed");me.getSingleton().register("afterFormulasValuesUpdate");const Jl=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var ni=new WeakMap,AC=new WeakMap,Lu=new WeakMap;class Nte extends ot{constructor(){var e;super(...arguments),e=this,IC(this,ni,{writable:!0,value:!1}),IC(this,AC,{writable:!0,value:!1}),IC(this,Lu,{writable:!0,value:[["valuesUpdated",function(){return e.onEngineValuesUpdated(...arguments)}],["namedExpressionAdded",function(){return e.onEngineNamedExpressionsAdded(...arguments)}],["namedExpressionRemoved",function(){return e.onEngineNamedExpressionsRemoved(...arguments)}],["sheetAdded",function(){return e.onEngineSheetAdded(...arguments)}],["sheetRenamed",function(){return e.onEngineSheetRenamed(...arguments)}],["sheetRemoved",function(){return e.onEngineSheetRemoved(...arguments)}]]}),Ql(this,"staticRegister",po("formulas")),Ql(this,"engine",null),Ql(this,"sheetName",null),Ql(this,"indexSyncer",null),Ql(this,"rowAxisSyncer",null),Ql(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return _n}static get PLUGIN_PRIORITY(){return Dte}static get SETTING_KEYS(){return[_n,...kte]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[_n]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=hte(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Ct("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){return n.onBeforeLoadData(...arguments)}),this.addHook("afterLoadData",function(){return n.onAfterLoadData(...arguments)}),this.addHook("beforeUpdateData",function(){return n.onBeforeLoadData(...arguments)}),this.addHook("afterUpdateData",function(){return n.onAfterLoadData(...arguments)}),this.addHook("modifyData",function(){return n.onModifyData(...arguments)}),this.addHook("modifySourceData",function(){return n.onModifySourceData(...arguments)}),this.addHook("beforeValidate",function(){return n.onBeforeValidate(...arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return n.onAfterSetSourceDataAtCell(...arguments)}),this.addHook("afterSetDataAtCell",function(){return n.onAfterSetDataAtCell(...arguments)}),this.addHook("afterSetDataAtRowProp",function(){return n.onAfterSetDataAtCell(...arguments)}),this.addHook("beforeCreateRow",function(){return n.onBeforeCreateRow(...arguments)}),this.addHook("beforeCreateCol",function(){return n.onBeforeCreateCol(...arguments)}),this.addHook("afterCreateRow",function(){return n.onAfterCreateRow(...arguments)}),this.addHook("afterCreateCol",function(){return n.onAfterCreateCol(...arguments)}),this.addHook("beforeRemoveRow",function(){return n.onBeforeRemoveRow(...arguments)}),this.addHook("beforeRemoveCol",function(){return n.onBeforeRemoveCol(...arguments)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow(...arguments)}),this.addHook("afterRemoveCol",function(){return n.onAfterRemoveCol(...arguments)}),this.indexSyncer=new _te(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,o,i,s)=>{this.rowAxisSyncer.storeMovesInformation(r,o,s)}),this.hot.addHook("beforeColumnMove",(r,o,i,s)=>{this.columnAxisSyncer.storeMovesInformation(r,o,s)}),this.hot.addHook("afterRowMove",(r,o,i,s,l)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,l)}),this.hot.addHook("afterColumnMove",(r,o,i,s,l)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,l)}),this.hot.addHook("beforeColumnFreeze",(r,o)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,o)}),this.hot.addHook("afterColumnFreeze",(r,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,o)}),this.hot.addHook("beforeColumnUnfreeze",(r,o)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,o)}),this.hot.addHook("afterColumnUnfreeze",(r,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,o)}),this.addHook("afterCellMetaReset",function(){return n.onAfterCellMetaReset(...arguments)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return n.onAfterDetachChild(...arguments)}),this.addHook("beforeAutofill",function(){return n.onBeforeAutofill(...arguments)}),Zl(this,Lu).forEach(r=>{let[o,i]=r;return this.engine.on(o,i)}),super.enablePlugin()}}disablePlugin(){Zl(this,Lu).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),o_(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=ute(this.hot.getSettings());cte(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[_n];if(he(r)&&he(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const o=this.hot.getSettings()[_n].sheetName;o&&this.engine.doesSheetExist(o)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(o??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Zl(this,Lu).forEach(e=>{var n;let[r,o]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,o)}),Wi(this,Lu,null),o_(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(he(n)&&!gk(n))return Ct("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Ct("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return Ct(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){Z0(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Hn(_n)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const o=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(n);return o!==null&&i!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(o=>{var i;const s=o==null||(i=o.address)===null||i===void 0?void 0:i.sheet;s!==void 0&&(r.has(s)||r.add(s))}),r_(this.engine).forEach((o,i)=>{if((n||i!==this.sheetId)&&r.has(i)){var s;o.render(),(s=o.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=i=>{var s;const{row:l,col:a,sheet:u}=(s=i==null?void 0:i.address)!==null&&s!==void 0?s:{};return he(u)?`${u}:${l}x${a}`:""},o=new Set(n.map(i=>r(i)));e.forEach(i=>{var s,l;const{row:a,col:u}=(s=i.address)!==null&&s!==void 0?s:{};if(he(a)===!1||he(u)===!1||a>=this.hot.countRows()||u>=this.hot.countCols())return;const c=i==null||(l=i.address)===null||l===void 0?void 0:l.sheet,h=r(i);if(c!==void 0&&!o.has(h)){const f=r_(this.engine).get(c);if(!f)return;f.validateCell(f.getDataAtCell(a,u),f.getCellMeta(a,u),()=>{})}})}syncChangeWithEngine(e,n,r){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(o)){Ct(`Not possible to set cell data at ${JSON.stringify(o)}`);return}const i=this.hot.getCellMeta(e,n);return RC(r,i.type)&&(i_(r,i.dateFormat)?r=s_(r,i.dateFormat):Cte(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(o,r)}onBeforeValidate(e,n,r){const o=this.hot.propToCol(r);if(this.isFormulaCellType(n,o)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},s=this.hot.getCellMeta(n,o);let l=this.engine.getCellValue(i);return s.type==="date"&&jn(l)&&(l=l_(l,s.dateFormat)),typeof l=="object"&&l!==null?l.value:l}return e}onBeforeAutofill(e,n,r){const{row:o,col:i}=n.getTopStartCorner(),{row:s,col:l}=n.getBottomEndCorner(),{row:a,col:u}=r.getTopStartCorner(),{row:c,col:h}=r.getBottomEndCorner(),f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId}},g={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(g)===!1)return!1;const p=this.engine.getFillRangeData(f,g),{row:y,col:E}=f.start,{row:w,col:C}=f.end,S=w-y+1,T=C-E+1;for(let x=0;x<p.length;x+=1)for(let A=0;A<p[x].length;A+=1){const D=p[x][A],U=x%S,j=A%T,z=this.hot.getCellMeta(U,j);RC(D,z.type)&&(D.startsWith("'")?p[x][A]=D.slice(1):this.isFormulaCellType(U,j,this.sheetId)===!1&&(p[x][A]=vte(D,z.dateFormat)))}return p}onBeforeLoadData(e,n){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Hn(_n))||Wi(this,AC,vt(this.hot.getSettings().data))}onAfterCellMetaReset(){const e=this.hot.getSourceDataArray();let n=!1;e.forEach((r,o)=>{r.forEach((i,s)=>{const l=this.hot.getCellMeta(o,s),a=l.dateFormat;RC(i,l.type)&&(n=!0,i_(i,a)?e[o][s]=s_(i,a):this.isFormulaCellType(o,s)===!1&&(e[o][s]=`'${i}`))})}),n===!0&&(Wi(this,ni,!0),this.engine.setSheetContent(this.sheetId,e),Wi(this,ni,!1))}onAfterLoadData(e,n){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Hn(_n)))if(this.sheetName=pte(this.engine,this.hot.getSettings()[_n].sheetName),Zl(this,AC))this.switchSheet(this.sheetName);else{const o=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,o)){Wi(this,ni,!0);const i=this.engine.setSheetContent(this.sheetId,o);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),Wi(this,ni,!1)}}}onModifyData(e,n,r,o){if(o!=="get"||Zl(this,ni)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e);if(i===null||n===null)return;if(!this.isFormulaCellType(i,n)&&this.getCellType(i,n)!=="ARRAY"){fN(r.value)&&(r.value=wte(r.value));return}const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};let a=this.engine.getCellValue(l);const u=this.hot.getCellMeta(i,n);u.type==="date"&&jn(a)&&(a=l_(a,u.dateFormat));const c=typeof a=="object"&&a!==null?a.value:a;r.value=c}onModifySourceData(e,n,r,o){if(o!=="get"||Zl(this,ni)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e),s=this.hot.propToCol(n);if(i===null||s===null||!this.isFormulaCellType(i,s)&&this.getCellType(i,s)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};r.value=this.engine.getCellSerialized(u)}onAfterSetDataAtCell(e,n){if(Jl(n))return;const r=[],o=[],i=this.engine.batch(()=>{e.forEach(s=>{let[l,a,,u]=s;const c=this.hot.propToCol(a),h=this.hot.toPhysicalRow(l),f=this.hot.toPhysicalColumn(c),g={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};h!==null&&f!==null?this.syncChangeWithEngine(l,c,u):r.push([l,c,u]),o.push({address:g})})});r.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{r.forEach(l=>{let[a,u,c]=l;this.syncChangeWithEngine(a,u,c)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,o)}onAfterSetSourceDataAtCell(e,n){if(Jl(n))return;const r=[],o=[];e.forEach(i=>{let[s,l,,a]=i;const u=this.hot.propToCol(l);if(!jn(u))return;const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(c)){Ct(`Not possible to set source cell data at ${JSON.stringify(c)}`);return}o.push({address:c}),r.push(...this.engine.setCellContents(c,a))}),this.renderDependentSheets(r),this.validateDependentCells(r,o)}onBeforeCreateRow(e,n){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(r=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,n]))return!1}onBeforeCreateCol(e,n){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(r=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,n]))return!1}onBeforeRemoveRow(e,n,r){return this.rowAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}onBeforeRemoveCol(e,n,r){return this.columnAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}onAfterCreateRow(e,n,r){if(Jl(r))return;const o=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),n]);this.renderDependentSheets(o)}onAfterCreateCol(e,n,r){if(Jl(r))return;const o=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),n]);this.renderDependentSheets(o)}onAfterRemoveRow(e,n,r,o){if(Jl(o))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),s=this.engine.batch(()=>{i.forEach(l=>{this.engine.removeRows(this.sheetId,[l,1])})});this.renderDependentSheets(s)}onAfterRemoveCol(e,n,r,o){if(Jl(o))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),s=this.engine.batch(()=>{i.forEach(l=>{this.engine.removeColumns(this.sheetId,[l,1])})});this.renderDependentSheets(s)}onAfterDetachChild(e,n,r){var o;Wi(this,ni,!0);const i=this.hot.getSourceDataArray(r,0,r+(((o=n.__children)===null||o===void 0?void 0:o.length)||0),this.hot.countSourceCols());Wi(this,ni,!1),i.forEach((s,l)=>{s.forEach((a,u)=>{this.engine.setCellContents({col:u,row:r+l,sheet:this.sheetId},[[a]])})})}onEngineValuesUpdated(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}onEngineNamedExpressionsAdded(e,n){this.hot.runHooks("afterNamedExpressionAdded",e,n)}onEngineNamedExpressionsRemoved(e,n){this.hot.runHooks("afterNamedExpressionRemoved",e,n)}onEngineSheetAdded(e){this.hot.runHooks("afterSheetAdded",e)}onEngineSheetRenamed(e,n){this.hot.runHooks("afterSheetRenamed",e,n)}onEngineSheetRemoved(e,n){this.hot.runHooks("afterSheetRemoved",e,n)}}function Lte(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,o]=e;r-o!==0&&(n=1)}return this.getTranslatedPhrase(wb,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),o=Math.max(e.col,n.col),i=[];for(let a=r;a<=o;a+=1)i.push(a);t.hideColumns(i);const s=i[i.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Fte(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(Cb,n)},callback(){var n,r;if(e.length===0)return;let o=e[0],i=e[e.length-1];o=(n=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&n!==void 0?n:0,i=(r=this.columnIndexMapper.getNearestNotHiddenIndex(i+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),i-o+1===this.countCols()||this.selectColumns(o,i)},disabled:!1,hidden(){const n=We(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),o=r.getTopStartCorner().col,i=r.getBottomEndCorner().col,s=this.columnIndexMapper,l=s.getRenderableFromVisualIndex(o),a=s.getRenderableFromVisualIndex(i),u=s.getNotTrimmedIndexes(),c=[];if(o!==i){const h=i-o+1,f=a-l+1;if(h>f){const g=u.slice(o,i+1);c.push(...g.filter(p=>n.includes(p)))}}else if(l===0&&l<o)c.push(...u.slice(0,o));else if(l===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));a===f&&h>i&&c.push(...u.slice(i+1))}return O(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function u_(t,e,n){$te(t,e),e.set(t,n)}function $te(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fr(t,e){var n=wN(t,e,"get");return Vte(t,n)}function Vte(t,e){return e.get?e.get.call(t):e.value}function Fu(t,e,n){var r=wN(t,e,"set");return Bte(t,r,n),n}function wN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Bte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}me.getSingleton().register("beforeHideColumns");me.getSingleton().register("afterHideColumns");me.getSingleton().register("beforeUnhideColumns");me.getSingleton().register("afterUnhideColumns");const HC="hiddenColumns",Wte=310;var bo=new WeakMap,Eo=new WeakMap;class Ute extends ot{constructor(){super(...arguments),u_(this,bo,{writable:!0,value:{}}),u_(this,Eo,{writable:!0,value:null})}static get PLUGIN_KEY(){return HC}static get PLUGIN_PRIORITY(){return Wte}isEnabled(){return!!this.hot.getSettings()[HC]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[HC];$e(n)&&(Fu(this,bo,n),vt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Fu(this,Eo,new Vm),fr(this,Eo).addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,fr(this,Eo)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(r,o,i)=>this.onAfterGetCellMeta(r,o,i)),this.addHook("modifyColWidth",(r,o)=>this.onModifyColWidth(r,o)),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("modifyCopyableRange",r=>this.onModifyCopyableRange(r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Fu(this,bo,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let o=n;const i=fr(this,Eo).getValues().slice(),s=e.length>0;if(r&&s){const a=e.map(u=>this.hot.toPhysicalColumn(u));O(a,u=>{i[u]=!1}),o=Gt(i,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,o,r&&s)!==!1&&(r&&s&&fr(this,Eo).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,o,r&&s,r&&o.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let o=n;r&&(o=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,o,r)!==!1&&(r&&this.hot.batchExecution(()=>{O(e,s=>{fr(this,Eo).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,o,r,r&&o.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return We(fr(this,Eo).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return fr(this,Eo).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){O(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}onModifyColWidth(e,n){if(this.isHidden(n))return 0;if(fr(this,bo).indicators&&(this.isHidden(n+1)||this.isHidden(n-1))&&typeof e=="number"&&this.hot.hasColHeaders())return e+15}onAfterGetCellMeta(e,n,r){if(fr(this,bo).copyPasteEnabled===!1&&this.isHidden(n)&&(r.skipColumnOnPaste=!0),this.isHidden(n-1))r.className=r.className||"",r.className.indexOf("afterHiddenColumn")===-1&&(r.className+=" afterHiddenColumn");else if(r.className){const o=r.className.split(" ");if(o.length>0){const i=o.indexOf("afterHiddenColumn");i>-1&&o.splice(i,1),r.className=o.join(" ")}}}onModifyCopyableRange(e){if(fr(this,bo).copyPasteEnabled)return e;const n=[],r=(o,i,s,l)=>{n.push({startRow:o,endRow:i,startCol:s,endCol:l})};return O(e,o=>{let i=!0,s=0;ye(o.startCol,o.endCol,l=>{this.isHidden(l)?(i||r(o.startRow,o.endRow,s,l-1),i=!0):(i&&(s=l),l===o.endCol&&r(o.startRow,o.endRow,s,l),i=!1)})}),n}onAfterGetColHeader(e,n){if(!fr(this,bo).indicators||e<0)return;const r=[];e>=1&&this.isHidden(e-1)&&r.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&r.push("beforeHiddenColumn"),te(n,r)}onAfterContextMenuDefaultOptions(e){e.items.push({name:je},Lte(this),Fte(this))}onMapInit(){Array.isArray(fr(this,bo).columns)&&this.hideColumns(fr(this,bo).columns)}destroy(){Fu(this,bo,null),Fu(this,Eo,null),super.destroy()}}function zte(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,o]=e;r-o!==0&&(n=1)}return this.getTranslatedPhrase(vb,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),o=Math.max(e.row,n.row),i=[];for(let a=r;a<=o;a+=1)i.push(a);t.hideRows(i);const s=i[i.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function jte(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(yb,n)},callback(){var n,r;if(e.length===0)return;let o=e[0],i=e[e.length-1];o=(n=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&n!==void 0?n:0,i=(r=this.rowIndexMapper.getNearestNotHiddenIndex(i+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),i-o+1===this.countRows()||this.selectRows(o,i)},disabled:!1,hidden(){const n=We(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),o=r.getTopStartCorner().row,i=r.getBottomEndCorner().row,s=this.rowIndexMapper,l=s.getRenderableFromVisualIndex(o),a=s.getRenderableFromVisualIndex(i),u=s.getNotTrimmedIndexes(),c=[];if(o!==i){const h=i-o+1,f=a-l+1;if(h>f){const g=u.slice(o,i+1);c.push(...g.filter(p=>n.includes(p)))}}else if(l===0&&l<o)c.push(...u.slice(0,o));else if(l===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));a===f&&h>i&&c.push(...u.slice(i+1))}return O(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function c_(t,e,n){Yte(t,e),e.set(t,n)}function Yte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ir(t,e){var n=CN(t,e,"get");return Gte(t,n)}function Gte(t,e){return e.get?e.get.call(t):e.value}function $u(t,e,n){var r=CN(t,e,"set");return Kte(t,r,n),n}function CN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Kte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}me.getSingleton().register("beforeHideRows");me.getSingleton().register("afterHideRows");me.getSingleton().register("beforeUnhideRows");me.getSingleton().register("afterUnhideRows");const PC="hiddenRows",Xte=320;var ri=new WeakMap,To=new WeakMap;class qte extends ot{constructor(){super(...arguments),c_(this,ri,{writable:!0,value:{}}),c_(this,To,{writable:!0,value:null})}static get PLUGIN_KEY(){return PC}static get PLUGIN_PRIORITY(){return Xte}isEnabled(){return!!this.hot.getSettings()[PC]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[PC];$e(n)&&($u(this,ri,n),vt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),$u(this,To,new Vm),Ir(this,To).addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,Ir(this,To)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(r,o,i)=>this.onAfterGetCellMeta(r,o,i)),this.addHook("modifyRowHeight",(r,o)=>this.onModifyRowHeight(r,o)),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("modifyCopyableRange",r=>this.onModifyCopyableRange(r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),$u(this,ri,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let o=n;const i=Ir(this,To).getValues().slice(),s=e.length>0;if(r&&s){const a=e.map(u=>this.hot.toPhysicalRow(u));O(a,u=>{i[u]=!1}),o=Gt(i,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,o,r&&s)!==!1&&(r&&s&&Ir(this,To).setValues(i),this.hot.runHooks("afterUnhideRows",n,o,r&&s,r&&o.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let o=n;r&&(o=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,o,r)!==!1&&(r&&this.hot.batchExecution(()=>{O(e,s=>{Ir(this,To).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,o,r,r&&o.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return We(Ir(this,To).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Ir(this,To).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){O(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}onModifyRowHeight(e,n){return this.isHidden(n)?0:e}onAfterGetCellMeta(e,n,r){if(Ir(this,ri).copyPasteEnabled===!1&&this.isHidden(e)&&(r.skipRowOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",r.className.indexOf("afterHiddenRow")===-1&&(r.className+=" afterHiddenRow");else if(r.className){const o=r.className.split(" ");if(o.length>0){const i=o.indexOf("afterHiddenRow");i>-1&&o.splice(i,1),r.className=o.join(" ")}}}onModifyCopyableRange(e){if(Ir(this,ri).copyPasteEnabled)return e;const n=[],r=(o,i,s,l)=>{n.push({startRow:o,endRow:i,startCol:s,endCol:l})};return O(e,o=>{let i=!0,s=0;ye(o.startRow,o.endRow,l=>{this.isHidden(l)?(i||r(s,l-1,o.startCol,o.endCol),i=!0):(i&&(s=l),l===o.endRow&&r(s,l,o.startCol,o.endCol),i=!1)})}),n}onAfterGetRowHeader(e,n){if(!Ir(this,ri).indicators||e<0)return;const r=[];e>=1&&this.isHidden(e-1)&&r.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&r.push("beforeHiddenRow"),te(n,r)}onAfterContextMenuDefaultOptions(e){e.items.push({name:je},zte(this),jte(this))}onMapInit(){Array.isArray(Ir(this,ri).rows)&&this.hideRows(Ir(this,ri).rows)}destroy(){$u(this,ri,null),$u(this,To,null),super.destroy()}}function Qte(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(GR)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Zte(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(KR)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}me.getSingleton().register("beforeColumnFreeze");me.getSingleton().register("afterColumnFreeze");me.getSingleton().register("beforeColumnUnfreeze");me.getSingleton().register("afterColumnUnfreeze");const h_="manualColumnFreeze",Jte=110,Vu=new WeakMap;class ene extends ot{static get PLUGIN_KEY(){return h_}static get PLUGIN_PRIORITY(){return Jte}constructor(e){super(e),Vu.set(this,{afterFirstUse:!1})}isEnabled(){return!!this.hot.getSettings()[h_]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.addContextMenuEntry(e)),this.addHook("beforeColumnMove",(e,n)=>this.onBeforeColumnMove(e,n)),super.enablePlugin())}disablePlugin(){const e=Vu.get(this);e.afterFirstUse=!1,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=Vu.get(this),r=this.hot.getSettings(),o=r.fixedColumnsStart<this.hot.countCols()&&e>r.fixedColumnsStart-1;n.afterFirstUse||(n.afterFirstUse=!0),this.hot.runHooks("beforeColumnFreeze",e,o)!==!1&&(o&&(this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart),r._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,o))}unfreezeColumn(e){const n=Vu.get(this),r=this.hot.getSettings(),o=r.fixedColumnsStart>0&&e<=r.fixedColumnsStart-1;n.afterFirstUse||(n.afterFirstUse=!0),this.hot.runHooks("beforeColumnUnfreeze",e,o)!==!1&&(o&&(r._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,o))}addContextMenuEntry(e){e.items.push({name:"---------"},Qte(this),Zte(this))}onBeforeColumnMove(e,n){if(Vu.get(this).afterFirstUse){const o=this.hot.getSettings().fixedColumnsStart;if(n<o||e.some(i=>i<o))return!1}}}const kC=0,d_=1,f_=2,ea="px";let tne=class{constructor(e){this.hot=e,this._element=null,this.state=kC,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=f_}build(){this.state===kC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=d_)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=kC}isAppended(){return this.state===f_}isBuilt(){return this.state>=d_}setPosition(e,n){jn(e)&&(this._element.style.top=e+ea),jn(n)&&(this._element.style[this.inlineProperty]=n+ea)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){jn(e)&&(this._element.style.width=e+ea),jn(n)&&(this._element.style.height=n+ea)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){jn(e)&&(this._element.style.marginTop=e+ea),jn(n)&&(this._element.style[`margin${Hn(this.inlineProperty)}`]=n+ea)}getOffset(){const e=this._element.style,n=`margin${Hn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const vN=tne,nne="ht__manualColumnMove--backlight";let rne=class extends vN{build(){super.build(),te(this._element,nne)}};const one=rne,ine="ht__manualColumnMove--guideline";let sne=class extends vN{build(){super.build(),te(this._element,ine)}};const lne=sne;me.getSingleton().register("beforeColumnMove");me.getSingleton().register("afterColumnMove");const DC="manualColumnMove",ane=120,Ui=new WeakMap,g_="ht__manualColumnMove",tf="show-ui",NC="on-moving--columns",LC="after-selection--columns";class une extends ot{static get PLUGIN_KEY(){return DC}static get PLUGIN_PRIORITY(){return ane}constructor(e){super(e),Ui.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),this.eventManager=new Dt(this),this.backlight=new one(e),this.guideline=new lne(e)}isEnabled(){return!!this.hot.getSettings()[DC]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollVertically",()=>this.onAfterScrollVertically()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,g_),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ke(this.hot.rootElement,g_),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=Ui.get(this),o=r.cachedDropIndex,i=this.isMovePossible(e,n),s=this.hot.runHooks("beforeColumnMove",e,n,o,i);if(r.cachedDropIndex=void 0,s===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const l=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,o,i,l),l}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n),o=Ui.get(this);return o.cachedDropIndex=n,this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),o=e.length+n>r,i=n<0,s=e.some(a=>a<0),l=e.some(a=>a>=r);return!(o||i||s||l)}isColumnOrderChanged(e,n){return e.some((r,o)=>r-o!==n)}countFinalIndex(e,n){const r=Gt(e,(o,i)=>(i<n&&(o+=1),o),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let o=0;for(let i=e;i<=n;i+=1){const s=r.getRenderableFromVisualIndex(i);i<0?o+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return o}moveBySettingsOrLoad(){const e=this.hot.getSettings()[DC];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return ye(e,n,o=>{r.push(o)}),r}refreshPositions(){const e=Ui.get(this),n=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(e.hoveredColumn)&&n>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(n-1,-1)});const r=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof o.scrollX=="number"?o.scrollX:o.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.hoveredColumn-1);const l=r.hider.offsetWidth,a=r.TBODY.offsetLeft,u=this.backlight.getOffset().start,c=this.backlight.getSize().width;let h=0,f=0;if(this.hot.isRtl()){const y=this.hot.rootWindow,E=ct(this.hot.rootElement),w=y.innerWidth-e.rootElementOffset-E;f=y.innerWidth-e.target.eventPageX-w-(o.scrollX===void 0?i:0)}else f=e.target.eventPageX-(e.rootElementOffset-(o.scrollX===void 0?i:0));if(e.hasRowHeaders&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(e.hoveredColumn)&&(s+=i),s+=h,e.hoveredColumn<0)e.fixedColumnsStart>0?e.target.col=0:e.target.col=n>0?n-1:n;else if(e.target.TD.offsetWidth/2+s<=f){const y=e.hoveredColumn>=e.countCols?e.countCols-1:e.hoveredColumn;e.target.col=y+1,s+=e.target.TD.offsetWidth}else e.target.col=e.hoveredColumn;let g=f,p=s;f+c+u>=l?g=l-c-u:f+u<a+h&&(g=a+h+Math.abs(u)),s>=l-1?p=l-1:p===0?p=1:o.scrollX!==void 0&&e.hoveredColumn<e.fixedColumnsStart&&(p-=e.rootElementOffset<=o.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,g),this.guideline.setPosition(null,p)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>this.onMouseMove(n)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,n,r,o){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),l=this.hot.getSelectedRangeLast(),a=Ui.get(this),u=Pe(e.target,"sortAction");if(!l||!s||a.pressed||e.button!==0||u){a.pressed=!1,a.columnsToMove.length=0,ke(this.hot.rootElement,[NC,tf]);return}const c=this.guideline.isBuilt()&&!this.guideline.isAppended(),h=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&h&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:f,to:g}=l,p=Math.min(f.col,g.col),y=Math.max(f.col,g.col);if(n.row<0&&n.col>=p&&n.col<=y){o.column=!0,a.pressed=!0;const E=r.firstChild?bP(e,r.firstChild).x:e.offsetX;a.target.eventPageX=e.pageX,a.hoveredColumn=n.col,a.target.TD=r,a.target.col=n.col,a.columnsToMove=this.prepareColumnsToMoving(p,y),a.hasRowHeaders=!!this.hot.getSettings().rowHeaders,a.countCols=this.hot.countCols(),a.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,a.rootElementOffset=Qt(this.hot.rootElement).left;const w=a.hasRowHeaders?-1:0,C=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,S=n.col<a.fixedColumnsStart,T=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),x=Math.abs(E-(this.hot.isRtl()?r.offsetWidth:0)),A=this.getColumnsWidth(p,n.col-1)+x,D=this.getColumnsWidth(w,p-1)+(S?T:0)+A;this.backlight.setPosition(C,D),this.backlight.setSize(this.getColumnsWidth(p,y),i.hider.offsetHeight-C),this.backlight.setOffset(null,-A),te(this.hot.rootElement,NC)}else ke(this.hot.rootElement,LC),a.pressed=!1,a.columnsToMove.length=0}onMouseMove(e){const n=Ui.get(this);n.pressed&&(n.target.eventPageX=e.pageX,this.refreshPositions())}onBeforeOnCellMouseOver(e,n,r,o){const i=this.hot.getSelectedRangeLast(),s=Ui.get(this);!i||!s.pressed||(s.columnsToMove.indexOf(n.col)>-1?ke(this.hot.rootElement,tf):te(this.hot.rootElement,tf),o.row=!0,o.column=!0,o.cell=!0,s.hoveredColumn=n.col,s.target.TD=r)}onMouseUp(){const e=Ui.get(this),n=e.target.col,r=e.columnsToMove.length;if(e.hoveredColumn=void 0,e.pressed=!1,e.backlightWidth=0,ke(this.hot.rootElement,[NC,tf,LC]),this.hot.selection.isSelectedByColumnHeader()&&te(this.hot.rootElement,LC),r<1||n===void 0)return;const o=e.columnsToMove[0],i=this.hot.toPhysicalColumn(o),s=this.dragColumns(e.columnsToMove,n);if(e.columnsToMove.length=0,s===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const l=this.hot.toVisualColumn(i),a=l+r-1;this.hot.selectColumns(l,a)}}onAfterScrollVertically(){const e=this.hot.view._wt.wtTable,n=e.getColumnHeaderHeight(0)+1,r=e.holder.scrollTop,o=n+r;this.backlight.setPosition(o),this.backlight.setSize(null,e.hider.offsetHeight-o)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const nf="manualColumnResize",cne=130,m_="manualColumnWidths",FC=new WeakMap;class hne extends ot{static get PLUGIN_KEY(){return nf}static get PLUGIN_PRIORITY(){return cne}constructor(e){super(e);const{rootDocument:n}=this.hot;this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=n.createElement("DIV"),this.guide=n.createElement("DIV"),this.eventManager=new Dt(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.columnWidthsMap=void 0,FC.set(this,{config:void 0}),te(this.handle,"manualColumnResizer"),te(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[nf]}enablePlugin(){this.enabled||(this.columnWidthsMap=new As,this.columnWidthsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(e,n)=>this.onModifyColWidth(e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>this.onBeforeStretchingColumnWidth(e,n)),this.addHook("beforeColumnResize",(e,n,r)=>this.onBeforeColumnResize(e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=FC.get(this);e.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",m_,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",m_,e),e.value}setManualSize(e,n){const r=Math.max(n,20),o=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(o,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(n,null)}onMapInit(){const e=FC.get(this),n=this.hot.getSettings()[nf],r=this.loadManualColumnWidths();typeof r<"u"?this.hot.batchExecution(()=>{r.forEach((o,i)=>{this.columnWidthsMap.setValueAtIndex(i,o)})},!0):Array.isArray(n)?(this.hot.batchExecution(()=>{n.forEach((o,i)=>{this.columnWidthsMap.setValueAtIndex(i,o)})},!0),e.config=n):n===!0&&Array.isArray(e.config)&&this.hot.batchExecution(()=>{e.config.forEach((o,i)=>{this.columnWidthsMap.setValueAtIndex(i,o)})},!0)}setupHandlePosition(e){if(!e.parentNode)return;this.currentTH=e;const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(this.currentTH),o=r.col;if(o<0)return;const i=kt(this.currentTH),s=this.currentTH.getBoundingClientRect(),l=o<n.getSetting("fixedColumnsStart");let a;l&&(a=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),a||(a=n.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.selectedCols=[];const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();O(c,h=>{const f=h.getTopStartCorner().col,g=h.getBottomEndCorner().col;ye(f,g,p=>{this.selectedCols.includes(p)||this.selectedCols.push(p)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=a.start-6,this.startWidth=parseInt(s.width,10),this.handle.style.top=`${a.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${i}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const e=parseInt(kt(this.handle),10),n=parseInt(this.handle.style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top=`${n}px`,this.refreshGuidePosition(),this.guide.style.height=`${r-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){ke(this.handle,"active"),ke(this.guide,"active")}checkIfColumnHeader(e){return!!ps(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}onMouseOver(e){if(!W0(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfColumnHeader(e.target)){const n=this.getClosestTHParent(e.target);if(!n)return;const r=n.getAttribute("colspan");n&&(r===null||r==="1")&&(this.pressed||this.setupHandlePosition(n))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,o)=>{const i=this.hot.runHooks("beforeColumnResize",this.newSize,r,!0);i!==void 0&&(this.newSize=i),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,r,!0),o&&e()};this.dblclick>=2&&(this.selectedCols.length>1?(O(this.selectedCols,o=>{n(o)}),e()):O(this.selectedCols,o=>{n(o,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Pe(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}onMouseMove(e){if(this.pressed){const n=(e.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+n,O(this.selectedCols,r=>{this.newSize=this.setManualSize(r,this.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,o)=>{this.hot.runHooks("beforeColumnResize",this.newSize,r,!1),o&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,r,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(O(this.selectedCols,o=>{n(o)}),e()):O(this.selectedCols,o=>{n(o,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>this.onMouseOver(r)),this.eventManager.addEventListener(n,"mousedown",r=>this.onMouseDown(r)),this.eventManager.addEventListener(e,"mousemove",r=>this.onMouseMove(r)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyColWidth(e,n){let r=e;if(this.enabled){const o=this.hot.toPhysicalColumn(n),i=this.columnWidthsMap.getValueAtIndex(o);this.hot.getSettings()[nf]&&i&&(r=i)}return r}onBeforeStretchingColumnWidth(e,n){let r=this.columnWidthsMap.getValueAtIndex(n);return r===null&&(r=e),r}onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}destroy(){super.destroy()}}const $C=0,p_=1,w_=2,ta="px";let dne=class{constructor(e){this.hot=e,this._element=null,this.state=$C}appendTo(e){e.appendChild(this._element),this.state=w_}build(){this.state===$C&&(this._element=this.hot.rootDocument.createElement("div"),this.state=p_)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=$C}isAppended(){return this.state===w_}isBuilt(){return this.state>=p_}setPosition(e,n){e!==void 0&&(this._element.style.top=e+ta),n!==void 0&&(this._element.style.left=n+ta)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+ta),n&&(this._element.style.height=n+ta)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+ta),n&&(this._element.style.marginLeft=n+ta)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const yN=dne,fne="ht__manualRowMove--backlight";class gne extends yN{build(){super.build(),te(this._element,fne)}}const mne=gne,pne="ht__manualRowMove--guideline";class wne extends yN{build(){super.build(),te(this._element,pne)}}const Cne=wne;me.getSingleton().register("beforeRowMove");me.getSingleton().register("afterRowMove");const VC="manualRowMove",vne=140,zi=new WeakMap,C_="ht__manualRowMove",rf="show-ui",BC="on-moving--rows",WC="after-selection--rows";class yne extends ot{static get PLUGIN_KEY(){return VC}static get PLUGIN_PRIORITY(){return vne}constructor(e){super(e),zi.set(this,{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),this.eventManager=new Dt(this),this.backlight=new mne(e),this.guideline=new Cne(e)}isEnabled(){return!!this.hot.getSettings()[VC]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollHorizontally",()=>this.onAfterScrollHorizontally()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,C_),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ke(this.hot.rootElement,C_),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=zi.get(this),o=r.cachedDropIndex,i=this.isMovePossible(e,n),s=this.hot.runHooks("beforeRowMove",e,n,o,i);if(r.cachedDropIndex=void 0,s===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const l=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,o,i,l),l}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n),o=zi.get(this);return o.cachedDropIndex=n,this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),o=e.length+n>r,i=n<0,s=e.some(a=>a<0),l=e.some(a=>a>=r);return!(o||i||s||l)}isRowOrderChanged(e,n){return e.some((r,o)=>r-o!==n)}countFinalIndex(e,n){const r=Gt(e,(o,i)=>(i<n&&(o+=1),o),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let o=0;for(let i=e;i<=n;i++){const s=r.getRenderableFromVisualIndex(i);s!==null&&(o+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return o}moveBySettingsOrLoad(){const e=this.hot.getSettings()[VC];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:o}=e,i=Math.min(r.row,o.row),s=Math.max(r.row,o.row);return ye(i,s,l=>{n.push(l)}),n}refreshPositions(){const e=zi.get(this),n=e.target.coords,r=this.hot.view.getFirstFullyVisibleRow(),o=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(n.row)&&r>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1)),this.isFixedRowBottom(n.row)&&o<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,l=e.target.TD,a=this.hot.rootElement,u=Qt(a),c=wl(a),h=s.holder.scrollTop,f=this.hot.rootWindow!==c?c.scrollTop:0,g=u.top-f,p=e.target.eventPageY-g+h,y=s.hider.offsetHeight,E=s.TBODY.offsetTop,w=this.backlight.getOffset().top,C=this.backlight.getSize().height,S=l.offsetHeight/2,T=l.offsetHeight;let x=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,n.row-1);const A=p>=x+S;this.isFixedRowTop(n.row)&&(x+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),n.row<0?e.target.row=r>0?r-1:r:A?(e.target.row=n.row+1,x+=n.row===0?T-1:T):e.target.row=n.row;let D=p,U=x;p+C+w>=y?D=y-C-w:p+w<E&&(D=E+Math.abs(w)),x>=y-1&&(U=y-1),this.backlight.setPosition(D),this.guideline.setPosition(U)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>this.onMouseMove(n)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,n,r,o){const{wtTable:i,wtViewport:s}=this.hot.view._wt,l=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast(),u=zi.get(this);if(!a||!l||u.pressed||e.button!==0){u.pressed=!1,u.rowsToMove.length=0,ke(this.hot.rootElement,[BC,rf]);return}const c=this.guideline.isBuilt()&&!this.guideline.isAppended(),h=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&h&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:f,to:g}=a,p=Math.min(f.row,g.row),y=Math.max(f.row,g.row);if(n.col<0&&n.row>=p&&n.row<=y){o.row=!0,u.pressed=!0,u.target.eventPageY=e.pageY,u.target.coords=n,u.target.TD=r,u.rowsToMove=this.prepareRowsToMoving();const E=i.holder.scrollLeft+s.getRowHeaderWidth(),w=this.getRowsHeight(p,n.row-1)+e.offsetY;this.backlight.setPosition(null,E),this.backlight.setSize(i.hider.offsetWidth-E,this.getRowsHeight(p,y)),this.backlight.setOffset(-w,null),te(this.hot.rootElement,BC),this.refreshPositions()}else ke(this.hot.rootElement,WC),u.pressed=!1,u.rowsToMove.length=0}onMouseMove(e){const n=zi.get(this);n.pressed&&(n.target.eventPageY=e.pageY,this.refreshPositions())}onBeforeOnCellMouseOver(e,n,r,o){const i=this.hot.getSelectedRangeLast(),s=zi.get(this);!i||!s.pressed||(s.rowsToMove.indexOf(n.row)>-1?ke(this.hot.rootElement,rf):te(this.hot.rootElement,rf),o.row=!0,o.column=!0,o.cell=!0,s.target.coords=n,s.target.TD=r)}onMouseUp(){const e=zi.get(this),n=e.target.row,r=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,ke(this.hot.rootElement,[BC,rf,WC]),this.hot.selection.isSelectedByRowHeader()&&te(this.hot.rootElement,WC),r<1||n===void 0)return;const o=e.rowsToMove[0],i=this.hot.toPhysicalRow(o),s=this.dragRows(e.rowsToMove,n);if(e.rowsToMove.length=0,s===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const l=this.hot.toVisualRow(i),a=l+r-1;this.hot.selectRows(l,a)}}onAfterScrollHorizontally(){const e=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtViewport.getRowHeaderWidth(),r=e.holder.scrollLeft,o=n+r;this.backlight.setPosition(null,o),this.backlight.setSize(e.hider.offsetWidth-o)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const of="manualRowResize",Sne=30,v_="manualRowHeights",UC=new WeakMap;class Rne extends ot{static get PLUGIN_KEY(){return of}static get PLUGIN_PRIORITY(){return Sne}constructor(e){super(e);const{rootDocument:n}=this.hot;this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=n.createElement("DIV"),this.guide=n.createElement("DIV"),this.eventManager=new Dt(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.rowHeightsMap=void 0,UC.set(this,{config:void 0}),te(this.handle,"manualRowResizer"),te(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[of]}enablePlugin(){this.enabled||(this.rowHeightsMap=new As,this.rowHeightsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(e,n)=>this.onModifyRowHeight(e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=UC.get(this);e.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",v_,this.rowHeightsMap.getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",v_,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),o=Math.max(n,UP.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(r,o),o}setupHandlePosition(e){this.currentTH=e;const{view:n}=this.hot,{_wt:r}=n,o=r.wtTable.getCoords(this.currentTH),i=o.row;if(i<0)return;const s=ct(this.currentTH),l=this.currentTH.getBoundingClientRect(),a=i<r.getSetting("fixedRowsTop"),u=i>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;a?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.selectedRows=[];const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const f=this.hot.getSelectedRange();O(f,g=>{const p=g.getTopStartCorner().row,y=g.getBottomStartCorner().row;ye(p,y,E=>{this.selectedRows.includes(E)||this.selectedRows.push(E)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=c.top-6,this.startHeight=parseInt(l.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${c.start}px`,this.handle.style.width=`${s}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const e=parseInt(ct(this.handle),10),n=parseInt(this.handle.style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${n}px`,this.guide.style.width=`${r-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){ke(this.handle,"active"),ke(this.guide,"active")}checkIfRowHeader(e){var n;return ps(e,["TH"],this.hot.rootElement)&&((n=e.parentNode)===null||n===void 0||(n=n.parentNode)===null||n===void 0?void 0:n.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&this.newSize<n?n:this.newSize}onMouseOver(e){if(!W0(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfRowHeader(e.target)){const n=this.getClosestTHParent(e.target);n&&(this.pressed||this.setupHandlePosition(n))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,o)=>{const i=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);i!==void 0&&(this.newSize=i),this.setManualSize(r,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),o&&e()};this.dblclick>=2&&(this.selectedRows.length>1?(O(this.selectedRows,o=>{n(o)}),e()):O(this.selectedRows,o=>{n(o,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Pe(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}onMouseMove(e){this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),O(this.selectedRows,n=>{this.newSize=this.setManualSize(n,this.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,o)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),o&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(O(this.selectedRows,o=>{n(o)}),e()):O(this.selectedRows,o=>{n(o,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>this.onMouseOver(r)),this.eventManager.addEventListener(e,"mousedown",r=>this.onMouseDown(r)),this.eventManager.addEventListener(n,"mousemove",r=>this.onMouseMove(r)),this.eventManager.addEventListener(n,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyRowHeight(e,n){let r=e;if(this.enabled){const o=this.hot.toPhysicalRow(n),i=this.rowHeightsMap.getValueAtIndex(o);this.hot.getSettings()[of]&&i&&(r=i)}return r}onMapInit(){const e=UC.get(this),n=this.hot.getSettings()[of],r=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof r<"u"?r.forEach((o,i)=>{this.rowHeightsMap.setValueAtIndex(i,o)}):Array.isArray(n)?(n.forEach((o,i)=>{this.rowHeightsMap.setValueAtIndex(i,o)}),e.config=n):n===!0&&Array.isArray(e.config)&&e.config.forEach((o,i)=>{this.rowHeightsMap.setValueAtIndex(i,o)})},!0)}destroy(){super.destroy()}}class bne{constructor(e,n,r,o,i,s){this.row=e,this.col=n,this.rowspan=r,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return ht`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return ht`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return ht`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return ht`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],o=n+Math.abs(e[0]||e[1])-1,i=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",l=Math.min(n,o),a=Math.max(n,o),u=this[s],c=this[s]+this[i]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[i]+=r);else if(r<0){if(l<=u&&a>=c)return this.removed=!0,!1;if(u>=l&&u<=a){const h=a-u+1,f=Math.abs(r)-h;this[s]-=f+r,this[i]-=h}else if(u<=l&&c>=a)this[i]+=r;else if(u<=l&&c>=l&&c<a){const h=c-l+1;this[i]-=h}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const Ao=bne;function eS(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}class IE{constructor(e){this.plugin=e,this.mergedCells=[],this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return ht`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let o=!1;return O(r,i=>i.row<=e&&i.row+i.rowspan-1>=e&&i.col<=n&&i.col+i.colspan-1>=n?(o=i,!1):!0),o}getByRange(e){const n=this.mergedCells;let r=!1;return O(n,o=>o.row<=e.from.row&&o.row+o.rowspan-1>=e.to.row&&o.col<=e.from.col&&o.col+o.colspan-1>=e.to.col?(r=o,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,o=[];let i=e;if(!i.includesRange){const s=this.hot._createCellCoords(i.from.row,i.from.col),l=this.hot._createCellCoords(i.to.row,i.to.col);i=this.hot._createCellRange(s,s,l)}return O(r,s=>{const l=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(l,l,a);n?i.overlaps(u)&&o.push(s):i.includesRange(u)&&o.push(s)}),o.length?o:!1}add(e){const n=this.mergedCells,r=e.row,o=e.col,i=e.rowspan,s=e.colspan,l=new Ao(r,o,i,s,this.hot._createCellCoords,this.hot._createCellRange),a=this.get(r,o),u=this.isOverlapping(l);return!a&&!u?(this.hot&&l.normalize(this.hot),n.push(l),l):(Ct(IE.IS_OVERLAPPING_WARNING(l)),!1)}remove(e,n){const r=this.mergedCells,o=this.get(e,n),i=o?this.mergedCells.indexOf(o):-1;return o&&i!==-1?(r.splice(i,1),o):!1}clear(){const e=this.mergedCells,n=[],r=[];O(e,o=>{const i=this.hot.getCell(o.row,o.col);i&&n.push([i,this.get(o.row,o.col),o.row,o.col])}),this.mergedCells.length=0,O(n,(o,i)=>{ye(0,o.rowspan-1,s=>{ye(0,o.colspan-1,l=>{if(l!==0||s!==0){const a=this.hot.getCell(o.row+s,o.col+l);a&&r.push([a,null,null,null])}})}),n[i][1]=null}),O(n,o=>{eS(...o)}),O(r,o=>{eS(...o)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return O(this.mergedCells,o=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(o.row,o.col),this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(o,i)}shiftCollections(e,n,r){const o=[0,0];switch(e){case"right":o[0]+=r;break;case"left":o[0]-=r;break;case"down":o[1]+=r;break;case"up":o[1]-=r;break}O(this.mergedCells,i=>{i.shift(o,n)}),Og(this.mergedCells.length-1,0,i=>{const s=this.mergedCells[i];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const Ene=IE;class Tne{constructor(e){this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,o){const i=n.slice(0),s=this.getAutofillSize(e,n,r),[l,a,u,c]=e,f=["up","down"].indexOf(r)>-1?u-l+1:c-a+1,g=Math.floor(s/f)*f,p=s-g,y=this.getFarthestCollection(e,n,r,o);if(y){if(r==="down"){const E=y.row+y.rowspan-l-p;i[2]+E>=this.plugin.hot.countRows()?i[2]-=p:i[2]+=p?E:0}else if(r==="right"){const E=y.col+y.colspan-a-p;i[3]+E>=this.plugin.hot.countCols()?i[3]-=p:i[3]+=p?E:0}else if(r==="up"){const E=u-p-y.row+1;i[0]+E<0?i[0]+=p:i[0]-=p?E:0}else if(r==="left"){const E=c-p-y.col+1;i[1]+E<0?i[1]+=p:i[1]-=p?E:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:o,fillSize:s,dragArea:i,cycleLength:f}),i}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Zt(this.currentFillData,e)}getAutofillSize(e,n,r){const[o,i,s,l]=e,[a,u,c,h]=n;switch(r){case"up":return o-a;case"down":return c-s;case"left":return i-u;case"right":return h-l;default:return null}}getDragArea(e,n,r){const[o,i,s,l]=e,[a,u,c,h]=n;switch(r){case"up":return[a,u,o-1,l];case"down":return[s+1,i,c,l];case"left":return[a,u,s,i-1];case"right":return[o,l+1,c,h];default:return null}}getFarthestCollection(e,n,r,o){const[i,s,l,a]=e,u=["up","down"].indexOf(r)>-1,c=u?l:a,h=u?i:s,f=this.getAutofillSize(e,n,r),g=u?l-i+1:a-s+1,p=Math.floor(f/g)*g,y=f-p;let E=null,w=null,C=null;switch(r){case"up":E="includesVertically",C=c-y+1;break;case"left":E="includesHorizontally",C=c-y+1;break;case"down":E="includesVertically",C=h+y-1;break;case"right":E="includesHorizontally",C=h+y-1;break}return O(o,S=>{S[E](C)&&S.isFarther(w,r)&&(w=S)}),w}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,i=(u,c)=>{switch(o){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,l=null,a=1;do for(let u=0;u<r.length;u+=1){if(l=r[u],s=a*this.currentFillData.cycleLength,i(l,s))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:l.row-s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-s,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+s,colspan:l.colspan});break}u===r.length-1&&(a+=1)}while(i(l,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return O(e,o=>{const i=o[0],s=this.plugin.hot.propToCol(o[1]);(n.min===null||i<n.min)&&(n.min=i),(n.max===null||i>n.max)&&(n.max=i),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const o=this.getDragArea(e,n,r),[i,s,l,a]=o,u=this.plugin.hot._createCellCoords(i,s),c=this.plugin.hot._createCellCoords(l,a),h=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}const Mne=Tne;class xne{constructor(e){this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}snapDelta(e,n,r){const o=n.to,i=o.row+e.row,s=o.col+e.col;e.row?this.jumpOverMergedCell(e,r,i):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let o=e.row||e.col,i=null,s=null,l=null;e.row?(i=n.includesVertically(r),s=n.row,l=n.getLastRow()):e.col&&(i=n.includesHorizontally(r),s=n.col,l=n.getLastColumn()),o!==0&&(o>0?i&&r!==s&&(o+=l-r+1):i&&r!==l&&(o-=r-s+1),e.row?e.row=o:e.col&&(e.col=o))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,o){const i=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),l=Math.max(r[0],r[2]),a=Math.max(r[1],r[3]);if(o===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),f=c.getLastColumn();if(i<=c.row&&s<=c.col&&l>=h&&a>=f)return`${this.fullySelectedMergedCellClassName}-${o}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let o=0;o<e.rowspan;o+=1)for(let i=0;i<e.colspan;i+=1)r.push(this.hot._createCellCoords(e.row+o,e.col+i));for(let o=0;o<r.length;o+=1){const i=[];for(let s=0;s<n.length;s+=1)i[s]=n[s].includes(r[o]);if(!i.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const _ne=xne;function One(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(qR)}return this.getTranslatedPhrase(XR)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?Ao.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}me.getSingleton().register("beforeMergeCells");me.getSingleton().register("afterMergeCells");me.getSingleton().register("beforeUnmergeCells");me.getSingleton().register("afterUnmergeCells");const rc="mergeCells",Ine=150,y_=new WeakMap,S_=rc;class Ane extends ot{static get PLUGIN_KEY(){return rc}static get PLUGIN_PRIORITY(){return Ine}constructor(e){super(e),y_.set(this,{lastDesiredCoords:null}),this.mergedCellsCollection=null,this.autofillCalculations=null,this.selectionCalculations=null}isEnabled(){return!!this.hot.getSettings()[rc]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Ene(this),this.autofillCalculations=new Mne(this),this.selectionCalculations=new _ne(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("modifyTransformStart",function(){return e.onModifyTransformStart(...arguments)}),this.addHook("afterModifyTransformStart",function(){return e.onAfterModifyTransformStart(...arguments)}),this.addHook("modifyTransformEnd",function(){return e.onModifyTransformEnd(...arguments)}),this.addHook("modifyGetCellCoords",function(){return e.onModifyGetCellCoords(...arguments)}),this.addHook("beforeSetRangeStart",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeEnd",function(){return e.onBeforeSetRangeEnd(...arguments)}),this.addHook("afterIsMultipleSelection",function(){return e.onAfterIsMultipleSelection(...arguments)}),this.addHook("afterRenderer",function(){return e.onAfterRenderer(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.addMergeActionsToContextMenu(...arguments)}),this.addHook("afterGetCellMeta",function(){return e.onAfterGetCellMeta(...arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return e.onAfterViewportRowCalculatorOverride(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),this.addHook("modifyAutofillRange",function(){return e.onModifyAutofillRange(...arguments)}),this.addHook("afterCreateCol",function(){return e.onAfterCreateCol(...arguments)}),this.addHook("afterRemoveCol",function(){return e.onAfterRemoveCol(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeDrawBorders",function(){return e.onBeforeDrawAreaBorders(...arguments)}),this.addHook("afterDrawSelection",function(){return e.onAfterDrawSelection(...arguments)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[rc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!G0())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:o,rowspan:i}=r;for(let s=o+1;s<o+i;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const o=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(i=>(i==null?void 0:i.name)==="master"?i:i.clone.wtTable).forEach(i=>{const s=i.getRow(o);s&&(s.style.background=Wa(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=Wa(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(Ao.containsNegativeValues(e)?(Ct(Ao.NEGATIVE_VALUES_WARNING(e)),n=!1):Ao.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Ct(Ao.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):Ao.isSingleCell(e)?(Ct(Ao.IS_SINGLE_CELL(e)),n=!1):Ao.containsZeroSpan(e)&&(Ct(Ao.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(O(e,r=>{if(!this.validateSetting(r))return;const o=this.hot._createCellCoords(r.row,r.col),i=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(o,o,i);this.mergeRange(s,!0,!0),ye(r.row,r.row+r.rowspan-1,l=>{ye(r.col,r.col+r.colspan-1,a=>{l===r.row&&a===r.col||n.push([l,a,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=e.getTopStartCorner(),i=e.getBottomEndCorner(),s={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},l=[];let a=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),ye(0,s.rowspan-1,c=>{ye(0,s.colspan-1,h=>{let f=null;l[c]||(l[c]=[]),c===0&&h===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),l[c][h]=f})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?a=[s.row,s.col,l]:this.hot.populateFromArray(s.row,s.col,l,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),a):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),O(r,o=>{this.mergedCellsCollection.remove(o.row,o.col),ye(0,o.rowspan-1,i=>{ye(0,o.colspan-1,s=>{this.hot.removeCellMeta(o.row+i,o.col+s,"hidden"),this.hot.removeCellMeta(o.row+i,o.col+s,"copyable")})}),this.hot.removeCellMeta(o.row,o.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,o){const i=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,o);this.mergeRange(this.hot._createCellRange(i,i,s))}unmerge(e,n,r,o){const i=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,o);this.unmergeRange(this.hot._createCellRange(i,i,s))}onAfterInit(){this.generateFromSettings(this.hot.getSettings()[rc]),this.hot.render()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:S_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(S_)}onAfterIsMultipleSelection(e){if(e){const n=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast();for(let o=0;o<n.length;o+=1)if(r.from.row===n[o].row&&r.from.col===n[o].col&&r.to.row===n[o].row+n[o].rowspan-1&&r.to.col===n[o].col+n[o].colspan-1)return!1}return e}onModifyTransformStart(e){const n=y_.get(this),r=this.hot.getSelectedRangeLast();let o={row:e.row,col:e.col},i=null;const s=this.hot._createCellCoords(r.highlight.row,r.highlight.col),l=this.mergedCellsCollection.get(s.row,s.col);if(n.lastDesiredCoords||(n.lastDesiredCoords=this.hot._createCellCoords(null,null)),l){const u=this.hot._createCellCoords(l.row,l.col),c=this.hot._createCellCoords(l.row+l.rowspan-1,l.col+l.colspan-1);this.hot._createCellRange(u,u,c).includes(n.lastDesiredCoords)||(n.lastDesiredCoords=this.hot._createCellCoords(null,null)),o.row=n.lastDesiredCoords.row?n.lastDesiredCoords.row-s.row:o.row,o.col=n.lastDesiredCoords.col?n.lastDesiredCoords.col-s.col:o.col,e.row>0?o.row=l.row+l.rowspan-1-s.row+e.row:e.row<0&&(o.row=s.row-l.row+e.row),e.col>0?o.col=l.col+l.colspan-1-s.col+e.col:e.col<0&&(o.col=s.col-l.col+e.col)}i=this.hot._createCellCoords(r.highlight.row+o.row,r.highlight.col+o.col);const a=this.mergedCellsCollection.get(i.row,i.col);if(a){const u=this.mergedCellsCollection.getFirstRenderableCoords(a.row,a.col);n.lastDesiredCoords=i,o={row:u.row-s.row,col:u.col-s.col}}o.row!==0&&(e.row=o.row),o.col!==0&&(e.col=o.col)}onModifyTransformEnd(e){const n=this.hot.getSelectedRangeLast(),r=Yn(e),o=this.selectionCalculations.getUpdatedSelectionRange(n,e);let i=Yn(r);const s=this.mergedCellsCollection.getWithinRange(o,!0);do i=Yn(r),this.selectionCalculations.getUpdatedSelectionRange(n,r),O(s,l=>{this.selectionCalculations.snapDelta(r,n,l)});while(r.row!==i.row||r.col!==i.col);e.row=r.row,e.col=r.col}onModifyGetCellCoords(e,n){if(e<0||n<0)return;const r=this.mergedCellsCollection.get(e,n);if(!r)return;const{row:o,col:i,colspan:s,rowspan:l}=r;return[o,i,o+l-1,i+s-1]}addMergeActionsToContextMenu(e){e.items.push({name:"---------"},One(this))}onAfterRenderer(e,n,r){const o=this.mergedCellsCollection.get(n,r),i=$e(o)?Yn(o):void 0;if($e(i)){const{rowIndexMapper:s,columnIndexMapper:l}=this.hot,{row:a,col:u,colspan:c,rowspan:h}=i,[f,g]=this.translateMergedCellToRenderable(a,h,u,c),p=s.getRenderableFromVisualIndex(n),y=l.getRenderableFromVisualIndex(r),E=f-p+1,w=g-y+1;i.row=s.getNearestNotHiddenIndex(i.row,1),i.col=l.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,E),i.colspan=Math.min(i.colspan,w)}eS(e,i,n,r)}onBeforeSetRangeStart(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){const n=this.mergedCellsCollection.get(e.row,e.col);[e.row,e.col]=[n.row,n.col]}}onBeforeSetRangeEnd(e){const n=this.hot.getSelectedRangeLast();n.highlight=this.hot._createCellCoords(n.highlight.row,n.highlight.col),n.to=e;let r=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{r=!1;for(let o=0;o<this.mergedCellsCollection.mergedCells.length;o+=1){const s=this.mergedCellsCollection.mergedCells[o].getRange();n.expandByRange(s)&&(e.row=n.to.row,e.col=n.to.col,r=!0)}}while(r)}onAfterGetCellMeta(e,n,r){const o=this.mergedCellsCollection.get(e,n);o&&(o.row!==e||o.col!==n?r.copyable=!1:(r.rowspan=o.rowspan,r.colspan=o.colspan))}onAfterViewportRowCalculatorOverride(e){const n=this.hot.countCols();this.modifyViewportRowStart(e,n),this.modifyViewportRowEnd(e,n)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,o=r.getVisualFromRenderableIndex(e.startRow);for(let i=0;i<n;i+=1){const s=this.mergedCellsCollection.get(o,i);if($e(s)){const l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(l<e.startRow){e.startRow=l,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,o=r.getVisualFromRenderableIndex(e.endRow);for(let i=0;i<n;i+=1){const s=this.mergedCellsCollection.get(o,i);if($e(s)){const l=s.row+s.rowspan-1,a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(l,-1));if(a>e.endRow){e.endRow=a,this.modifyViewportRowEnd(e,n);return}}}}onAfterViewportColumnCalculatorOverride(e){const n=this.hot.countRows();this.modifyViewportColumnStart(e,n),this.modifyViewportColumnEnd(e,n)}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,o=r.getVisualFromRenderableIndex(e.startColumn);for(let i=0;i<n;i+=1){const s=this.mergedCellsCollection.get(i,o);if($e(s)){const l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(l<e.startColumn){e.startColumn=l,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,o=r.getVisualFromRenderableIndex(e.endColumn);for(let i=0;i<n;i+=1){const s=this.mergedCellsCollection.get(i,o);if($e(s)){const l=s.col+s.colspan-1,a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(l,-1));if(a>e.endColumn){e.endColumn=a,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,o){const{rowIndexMapper:i,columnIndexMapper:s}=this.hot;let l,a;n===0?l=i.getNearestNotHiddenIndex(e,1):l=i.getNearestNotHiddenIndex(e+n-1,-1),o===0?a=s.getNearestNotHiddenIndex(r,1):a=s.getNearestNotHiddenIndex(r+o-1,-1);const u=e>=0?i.getRenderableFromVisualIndex(l):e,c=r>=0?s.getRenderableFromVisualIndex(a):r;return[u,c]}onModifyAutofillRange(e,n){this.autofillCalculations.correctSelectionAreaSize(n);const r=this.autofillCalculations.getDirection(n,e);let o=e;if(this.autofillCalculations.dragAreaOverlapsCollections(n,o,r))return o=n,o;const i=this.mergedCellsCollection.getWithinRange({from:{row:n[0],col:n[1]},to:{row:n[2],col:n[3]}});return i&&(o=this.autofillCalculations.snapDragArea(n,o,r,i)),o}onAfterCreateCol(e,n){this.mergedCellsCollection.shiftCollections("right",e,n)}onAfterRemoveCol(e,n){this.mergedCellsCollection.shiftCollections("left",e,n)}onAfterCreateRow(e,n,r){r!=="auto"&&this.mergedCellsCollection.shiftCollections("down",e,n)}onAfterRemoveRow(e,n){this.mergedCellsCollection.shiftCollections("up",e,n)}onAfterChange(e,n){n==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(e)}onBeforeDrawAreaBorders(e,n){if(n&&n==="area"){const r=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getWithinRange(r);O(o,i=>{r.getBottomEndCorner().row===i.getLastRow()&&r.getBottomEndCorner().col===i.getLastColumn()&&(e[2]=i.row,e[3]=i.col)})}}onAfterModifyTransformStart(e,n,r){if(!this.enabled)return;const o=this.mergedCellsCollection.get(e.row,e.col);if(!o)return;const i=n>0,s=n<0,l=r<0,a=r>0,u=o.row+o.rowspan-1===this.hot.countRows()-1,c=o.row===0,h=o.col+o.colspan-1===this.hot.countCols()-1,f=o.col===0;(i&&u||s&&c||a&&h||l&&f)&&(e.row=o.row,e.col=o.col)}onAfterDrawSelection(e,n,r,o){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(e,n,r,o)}}function Hne(t,e){return function(n,r){const[,...o]=n,[,...i]=r;return function s(l){const a=t[l],u=e[l],c=o[l],h=i[l],f=u.multiColumnSorting,p=(f.compareFunctionFactory?f.compareFunctionFactory:TD(u.type))(a,u,f)(c,h);if(p===$o){const y=l+1;if(typeof e[y]<"u")return s(y)}return p}(0)}}function R_(){Ct(ht`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const SN="sort";function Pne(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${SN}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function kne(t){const e=t.className.split(" "),n=new RegExp(`^${SN}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}const Ug="multiColumnSorting",Dne=170,b_="columnSorting",E_=Ug;ED(Ug,Hne);class Nne extends MD{static get PLUGIN_KEY(){return Ug}static get PLUGIN_PRIORITY(){return Dne}constructor(e){super(e),this.pluginKey=Ug}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[b_]&&R_(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,$g))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:E_})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(E_)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];super.updateHeaderClasses(e,...r),ke(e,kne(e)),this.enabled!==!1&&te(e,Pne(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[b_]&&R_(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){Yy(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,$g))):this.sort(this.getColumnNextConfig(n.col)))}}const Lne="multipleSelectionHandles",Fne=160;class $ne extends ot{static get PLUGIN_KEY(){return Lne}static get PLUGIN_PRIORITY(){return Fne}constructor(e){super(e),this.dragged=[],this.eventManager=null,this.lastSetCell=null}isEnabled(){return pi()}enablePlugin(){this.enabled||(this.eventManager||(this.eventManager=new Dt(this)),this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(o){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const i=e.dragged.indexOf(o);if(i===-1)return!1;i===0?e.dragged=e.dragged.slice(0,1):i===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",o=>{let i;if(Pe(o.target,"topSelectionHandle-HitArea"))return i=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},o.preventDefault(),!1;if(Pe(o.target,"bottomSelectionHandle-HitArea"))return i=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},o.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",o=>{if(Pe(o.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,o.preventDefault(),!1;if(Pe(o.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,o.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",o=>{const{rootDocument:i}=this.hot;let s,l,a,u,c,h;if(e.dragged.length===0)return;const f=i.elementFromPoint(o.touches[0].clientX,o.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(s=e.hot.getCoords(f),s.col===-1&&(s.col=0),l=e.hot.getSelectedRangeLast(),a=l.getWidth(),u=l.getHeight(),c=l.getDirection(),a===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(l,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=f),o.preventDefault())})}getCurrentRangeCoords(e,n,r,o,i){const s=e.getTopStartCorner(),l=e.getBottomEndCorner(),a=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":i==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(a.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":i==="bottom"&&(c={start:this.hot._createCellCoords(l.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(o){case"NE-SW":i==="top"?c={start:n,end:a}:c.end=n;break;case"NW-SE":i==="top"?c={start:n,end:l}:c.end=n;break;case"SE-NW":i==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":i==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(o){case"NW-SE":i==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(a.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,l.col)};break;case"SW-NE":i==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,l.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":i==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:i==="top"&&(c={start:a,end:n});break}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":i==="top"&&(c.end=n);break;case"SE-NW":i==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function tS(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:o=[],isCollapsed:i=!1,isHidden:s=!1,isRoot:l=!1,isPlaceholder:a=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:i,crossHiddenColumns:o,isHidden:s,isRoot:l,isPlaceholder:a}}function RN(){return{label:"",isPlaceholder:!0}}function Vne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;O(t,o=>{const i=[];let s=0;n.push(i),O(o,l=>{const a=tS();if($e(l)){const{label:c,colspan:h}=l;a.label=Vt(c),typeof h=="number"&&h>1&&(a.colspan=h,a.origColspan=h)}else a.label=Vt(l);s+=a.origColspan;let u=!1;if(s>=e&&(a.colspan=a.origColspan-(s-e),a.origColspan=a.colspan,u=!0),i.push(a),a.colspan>1)for(let c=0;c<a.colspan-1;c++)i.push(RN());return!u})});const r=Math.max(...We(n,o=>o.length));return O(n,o=>{if(o.length<r){const i=We(new Array(r-o.length),()=>tS());o.splice(o.length,0,...i)}}),n}function zC(t,e,n){Bne(t,e),e.set(t,n)}function Bne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qr(t,e){var n=bN(t,e,"get");return Wne(t,n)}function Wne(t,e){return e.get?e.get.call(t):e.value}function Bu(t,e,n){var r=bN(t,e,"set");return Une(t,r,n),n}function bN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Une(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const T_=["label","collapsible"];var oi=new WeakMap,Ks=new WeakMap,jC=new WeakMap;class zne{constructor(){zC(this,oi,{writable:!0,value:[]}),zC(this,Ks,{writable:!0,value:0}),zC(this,jC,{writable:!0,value:1/0})}setColumnsLimit(e){Bu(this,jC,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Bu(this,oi,Vne(e,Qr(this,jC))),Bu(this,Ks,Qr(this,oi).length)}getData(){return Qr(this,oi)}mergeWith(e){O(e,n=>{let{row:r,col:o,...i}=n;const s=this.getHeaderSettings(r,o);s!==null&&Zt(s,i,T_)})}map(e){O(Qr(this,oi),n=>{O(n,r=>{const o=e({...r});$e(o)&&Zt(r,o,T_)})})}getHeaderSettings(e,n){var r;if(e>=Qr(this,Ks)||e<0)return null;const o=Qr(this,oi)[e];return n>=o.length?null:(r=o[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const o=[];if(e>=Qr(this,Ks)||e<0)return o;const i=Qr(this,oi)[e];let s=0;for(let l=n;l<i.length;l++){const a=i[l];if(a.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=a.colspan,o.push(a),a.colspan>1&&(l+=a.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return o}getLayersCount(){return Qr(this,Ks)}getColumnsCount(){return Qr(this,Ks)>0?Qr(this,oi)[0].length:0}clear(){Bu(this,oi,[]),Bu(this,Ks,0)}}function YC(t,e,n){return e=jne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jne(t){var e=Yne(t,"string");return typeof e=="symbol"?e:String(e)}function Yne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const EN="DF-pre-order";function TN(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=TN.call(this.childs[r],t,e)}return n}const Gne="DF-post-order";function MN(t,e){for(let n=0;n<this.childs.length;n++)if(MN.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const xN="BF";function Kne(t,e){const n=[this];function r(){if(n.length===0)return;const o=n.shift();n.push(...o.childs),t.call(e,o)!==!1&&r()}r()}const Xne=xN,M_=new Map([[EN,TN],[Gne,MN],[xN,Kne]]);class zg{constructor(e){YC(this,"data",{}),YC(this,"parent",null),YC(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new zg({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xne;if(!M_.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);M_.get(n).call(this,e,this)}walkUp(e){const n=this,r=o=>{e.call(n,o)!==!1&&o.parent!==null&&r(o.parent)};r(this)}}function GC(t,e,n){qne(t,e),e.set(t,n)}function qne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bn(t,e){var n=_N(t,e,"get");return Qne(t,n)}function Qne(t,e){return e.get?e.get.call(t):e.value}function Zne(t,e,n){var r=_N(t,e,"set");return Jne(t,r,n),n}function _N(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Jne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var na=new WeakMap,Xs=new WeakMap,ra=new WeakMap;class ere{constructor(e){GC(this,na,{writable:!0,value:new Map}),GC(this,Xs,{writable:!0,value:new Map}),GC(this,ra,{writable:!0,value:null}),Zne(this,ra,e)}getRoots(){return Array.from(Bn(this,na).values())}getRootByColumn(e){let n;return Bn(this,Xs).has(e)&&(n=Bn(this,na).get(Bn(this,Xs).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const o=n-Bn(this,Xs).get(n);let i=0,s;return r.walkDown(l=>{const{data:{origColspan:a,headerLevel:u}}=l;if(e===u){if(o>=i&&o<=i+a-1)return s=l,s.data.isRoot=n===s.data.columnIndex,!1;i+=a}}),s}rebuildTreeIndex(){let e=0;Bn(this,Xs).clear(),O(Bn(this,na),n=>{let[,{data:{colspan:r}}]=n;for(let o=e;o<e+r;o++)Bn(this,Xs).set(o,e);e+=r})}buildTree(){this.clear();const e=Bn(this,ra).getColumnsCount();let n=0;for(;n<e;){const r=Bn(this,ra).getHeaderSettings(0,n),o=new zg;Bn(this,na).set(n,o),this.buildLeaves(o,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const i=Bn(this,ra).getHeadersSettings(r,n,o);r+=1,O(i,s=>{const l={...s,headerLevel:r-1,columnIndex:n};let a;r===1?(e.data=l,a=e):(a=new zg(l),e.addChild(a)),r<Bn(this,ra).getLayersCount()&&this.buildLeaves(a,n,r,s.origColspan),n+=s.origColspan})}clear(){Bn(this,na).clear(),Bn(this,Xs).clear()}}function ON(t,e){t.walkDown(n=>{let{data:r,childs:o}=n;if(!r.isHidden&&(e(r.columnIndex),o.length===0))for(let i=1;i<r.colspan;i++)e(r.columnIndex+i)})}function jg(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function Yg(t){return jg(t,"origColspan")===t.data.origColspan}function AE(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Yg(t))return AE(n[0]);e.isCollapsed=!1;const o=n.slice(1),i=new Set;let s=0;if(o.length>0)O(o,l=>{l.replaceTreeWith(l.data.clonedTree),l.data.clonedTree=null;const a=l.data;s+=a.colspan,ON(l,u=>{i.add(u)})});else{const{colspan:l,origColspan:a,columnIndex:u}=e;s=a-l;for(let c=1;c<a;c++)i.add(u+c)}return t.walkUp(l=>{const{data:a}=l;a.colspan+=s,a.colspan>=a.origColspan?(a.colspan=a.origColspan,a.isCollapsed=!1):Yg(l)&&(a.isCollapsed=jg(l,"isCollapsed"))}),{rollbackModification:()=>HE(t),affectedColumns:Array.from(i),colspanCompensation:s}}function HE(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Yg(t))return HE(r[0]);n.isCollapsed=!0;const i=r.slice(1),s=new Set;if(i.length>0)O(i,a=>{ON(a,u=>{s.add(u)}),a.data.clonedTree=a.cloneTree(),a.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:a,columnIndex:u}=n;for(let c=1;c<a;c++){const h=u+c;s.add(h)}}const l=n.colspan-((e=jg(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(a=>{const{data:u}=a;u.colspan-=l,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Yg(a)&&(u.isCollapsed=jg(a,"isCollapsed"))}),{rollbackModification:()=>AE(t),affectedColumns:Array.from(s),colspanCompensation:l}}function tre(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ht`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(o=>{const{data:{collapsible:i}}=o;if(i)return r=!0,!1}),!r&&t.walkUp(o=>{const{data:i}=o;i.crossHiddenColumns.push(e),i.colspan>1?i.colspan-=1:i.isHidden=!0})}function nre(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ht`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(o=>{const{data:{collapsible:i}}=o;if(i)return r=!0,!1}),!r&&t.walkUp(o=>{const{data:i}=o;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(e),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}const x_=new Map([["collapse",HE],["expand",AE],["hide-column",tre],["show-column",nre]]);function rre(t,e,n){if(!x_.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return x_.get(t)(e,n)}function sf(t){const e=[];return O(t,n=>{n.walkDown(r=>{const o=r.data,{origColspan:i,columnIndex:s,headerLevel:l,crossHiddenColumns:a}=o,u=ire(e,l);let c=!1;for(let h=s;h<s+i;h++)if(a.includes(h)||c)u.push(RN());else{const g=ore(o);g.isRoot=!0,u.push(g),c=!0}})}),e}function ore(t){const{crossHiddenColumns:e,...n}=tS(t);return n}function ire(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function KC(t,e,n){sre(t,e),e.set(t,n)}function sre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wu(t,e,n){var r=IN(t,e,"set");return lre(t,r,n),n}function lre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Nt(t,e){var n=IN(t,e,"get");return are(t,n)}function IN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function are(t,e){return e.get?e.get.call(t):e.value}var Mo=new WeakMap,tr=new WeakMap,qs=new WeakMap;class ure{constructor(){KC(this,Mo,{writable:!0,value:new zne}),KC(this,tr,{writable:!0,value:new ere(Nt(this,Mo))}),KC(this,qs,{writable:!0,value:[[]]})}setState(e){Nt(this,Mo).setData(e);let n=!1;try{Nt(this,tr).buildTree()}catch{Nt(this,tr).clear(),Nt(this,Mo).clear(),n=!0}return Wu(this,qs,sf(Nt(this,tr).getRoots())),n}setColumnsLimit(e){Nt(this,Mo).setColumnsLimit(e)}mergeStateWith(e){const n=We(e,r=>{let{row:o,...i}=r;return{row:o<0?this.rowCoordsToLevel(o):o,...i}});Nt(this,Mo).mergeWith(n),Nt(this,tr).buildTree(),Wu(this,qs,sf(Nt(this,tr).getRoots()))}mapState(e){Nt(this,Mo).map(e),Nt(this,tr).buildTree(),Wu(this,qs,sf(Nt(this,tr).getRoots()))}mapNodes(e){return Gt(Nt(this,tr).getRoots(),(n,r)=>(r.walkDown(o=>{const i=e(o.data);i!==void 0&&n.push(i)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const o=Nt(this,tr).getNode(n,r);let i;return o&&(i=rre(e,o,r),Wu(this,qs,sf(Nt(this,tr).getRoots()))),i}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,o;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(o=Nt(this,qs)[e])===null||o===void 0?void 0:o[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Nt(this,tr).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const o=r-e+1;let i=!1,s=null;for(let l=e;l<=r;l++){const a=Nt(this,tr).getRootByColumn(l);if(!a)break;i=!0,a.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:f,isHidden:g}=u.data;g||f<=o&&c>=e&&c+f-1<=r&&(s===null||h<s)&&(s=h)},EN)}return i&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(o)return n;let i=n-1;for(;i>=0;){var s;const{isRoot:l}=(s=this.getHeaderSettings(e,i))!==null&&s!==void 0?s:{isRoot:!0};if(l)break;i-=1}return i}findRightMostColumnIndex(e,n){var r;const{isRoot:o,origColspan:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(o)return n+i-1;let s=n+1;for(;s<this.getColumnsCount();){var l;const{isRoot:a}=(l=this.getHeaderSettings(e,s))!==null&&l!==void 0?l:{isRoot:!0};if(a)break;s+=1}return s-1}getLayersCount(){return Nt(this,Mo).getLayersCount()}getColumnsCount(){return Nt(this,Mo).getColumnsCount()}clear(){Wu(this,qs,[]),Nt(this,Mo).clear(),Nt(this,tr).clear()}}function Uu(t,e,n){return e=cre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cre(t){var e=hre(t,"string");return typeof e=="symbol"?e:String(e)}function hre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dre{constructor(e,n){Uu(this,"hot",void 0),Uu(this,"nestedHeaderSettingsGetter",void 0),Uu(this,"layersCount",0),Uu(this,"container",void 0),Uu(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),i=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(i,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,o=n.createDocumentFragment(),i=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,l=r.getRenderableIndexesLength();for(let a=0;a<this.layersCount;a++){const u=n.createElement("tr");for(let c=0;c<l;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const f=n.createElement("th"),g=this.nestedHeaderSettingsGetter(a,h);if(g&&(!g.isPlaceholder||g.isHidden)){let p=g.label;s&&(p+='<button class="changeType"></button>'),Ol(f,p),f.colSpan=g.colspan,u.appendChild(f)}}i.appendChild(u)}o.appendChild(i),e.appendChild(o)}clear(){this.widthsMap.clear(),this.container=null}}const fre=dre;function __(t,e,n){return e=gre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gre(t){var e=mre(t,"string");return typeof e=="symbol"?e:String(e)}function mre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lf(t,e,n){pre(t,e),e.set(t,n)}function pre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qs(t,e,n){var r=AN(t,e,"set");return wre(t,r,n),n}function wre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Je(t,e){var n=AN(t,e,"get");return Cre(t,n)}function AN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Cre(t,e){return e.get?e.get.call(t):e.value}const O_="nestedHeaders",vre=280;var ut=new WeakMap,ji=new WeakMap,zu=new WeakMap,af=new WeakMap;class yre extends ot{constructor(){super(...arguments),lf(this,ut,{writable:!0,value:new ure}),lf(this,ji,{writable:!0,value:null}),lf(this,zu,{writable:!0,value:null}),lf(this,af,{writable:!0,value:!1}),__(this,"ghostTable",new fre(this.hot,(e,n)=>this.getHeaderSettings(e,n))),__(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return O_}static get PLUGIN_PRIORITY(){return vre}isEnabled(){return!!this.hot.getSettings()[O_]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Ct(ht`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",function(){return e.onAfterOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("beforeOnCellMouseUp",function(){return e.onBeforeOnCellMouseUp(...arguments)}),this.addHook("beforeSelectionHighlightSet",function(){return e.onBeforeSelectionHighlightSet(...arguments)}),this.addHook("modifyTransformStart",function(){return e.onModifyTransformStart(...arguments)}),this.addHook("afterSelection",()=>this.updateFocusHighlightPosition()),this.addHook("beforeViewportScrollHorizontally",function(){return e.onBeforeViewportScrollHorizontally(...arguments)}),this.addHook("afterGetColumnHeaderRenderers",r=>this.onAfterGetColumnHeaderRenderers(r)),this.addHook("modifyColWidth",function(){return e.onModifyColWidth(...arguments)}),this.addHook("modifyColumnHeaderValue",function(){return e.onModifyColumnHeaderValue(...arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return e.onBeforeHighlightingColumnHeader(...arguments)}),this.addHook("beforeCopy",function(){return e.onBeforeCopy(...arguments)}),this.addHook("beforeSelectColumns",function(){return e.onBeforeSelectColumns(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),this.addHook("modifyFocusedElement",function(){return e.onModifyFocusedElement(...arguments)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>this.updateFocusHighlightPosition()),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>this.updateFocusHighlightPosition()),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Je(this,ut).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Je(this,ut).setState(e)),this.detectedOverlappedHeaders&&Ct(ht`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const o=n===!0?"hide-column":"show-column";Je(this,ut).triggerColumnModification(o,r)}),!Je(this,ji)&&this.enabled&&Qs(this,ji,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:o,index:i,newValue:s}=r;if(o==="replace"){const l=s===!0?"hide-column":"show-column";Je(this,ut).triggerColumnModification(l,i)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Je(this,ut).clear(),Je(this,ji).unsubscribe(),Qs(this,ji,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Je(this,ut)}getLayersCount(){return Je(this,ut).getLayersCount()}getHeaderSettings(e,n){return Je(this,ut).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,o=e.wtOverlays.topOverlay.clone.wtTable.THEAD,i=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const l=r.childNodes[s];if(!l)break;const a=o.childNodes[s],u=i?i.childNodes[s]:null;for(let c=0,h=l.childNodes.length;c<h;c++)l.childNodes[c].removeAttribute("colspan"),ke(l.childNodes[c],"hiddenHeader"),a&&a.childNodes[c]&&(a.childNodes[c].removeAttribute("colspan"),ke(a.childNodes[c],"hiddenHeader")),i&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),ke(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(o,i)=>{var s;const{columnIndexMapper:l,view:a}=this.hot;let u=l.getVisualFromRenderableIndex(o);u===null&&(u=o),i.removeAttribute("colspan"),ke(i,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:f}=(s=Je(this,ut).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(f||h)te(i,"hiddenHeader");else if(c>1){var g,p;const{wtOverlays:y}=a._wt,E=(g=y.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(i),w=(p=y.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(i),C=E||w?Math.min(c,r-o):c;C>1&&i.setAttribute("colspan",C)}this.hot.view.appendColHeader(u,i,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:o,isPlaceholder:i}=(r=Je(this,ut).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return i||o?"":this.hot.getColHeader(e,n)}updateFocusHighlightPosition(){var e;const n=(e=this.hot)===null||e===void 0?void 0:e.getSelectedRangeLast();if(!n)return;const{highlight:r}=n;if(r.isHeader()&&r.col>=0){const i=Je(this,ut).findLeftMostColumnIndex(r.row,r.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=i,s.visualCellRange.from.col=i,s.visualCellRange.to.col=i,s.commit()}}onBeforeViewportScrollHorizontally(e){const n=this.hot.getSelectedRangeLast();if(!n)return e;const{highlight:r}=n;if(!(r.isHeader()&&r.col>=0))return e;const i=this.hot.view.getFirstFullyVisibleColumn(),s=this.hot.view.getLastFullyVisibleColumn(),l=Je(this,ut).findLeftMostColumnIndex(r.row,r.col),a=Je(this,ut).findRightMostColumnIndex(r.row,r.col);return l<i&&a>s?e:l<i?l:a}onBeforeHighlightingColumnHeader(e,n,r){const o=Je(this,ut).getHeaderTreeNodeData(n,e);if(!o)return e;const{columnCursor:i,selectionType:s,selectionWidth:l}=r,{isRoot:a,colspan:u}=Je(this,ut).getHeaderSettings(n,e);if(s===mR){if(!a)return o.columnIndex}else if(s===ok&&(u>l-i||!a))return null;return e}onBeforeCopy(e,n,r){let{columnHeadersCount:o}=r;if(o!==0)for(let s=0;s<n.length;s++){const{startRow:l,startCol:a,endRow:u,endCol:c}=n[s],h=u-l+1,f=a-c+1;if(l>=0||f===1)break;for(let g=a;g<=c;g++)for(let p=l;p<=u;p++){var i;const y=h+p,E=g-a;if(E===0)continue;((i=Je(this,ut).getHeaderTreeNodeData(p,g))===null||i===void 0?void 0:i.isRoot)===!1&&(e[y][E]="")}}}onBeforeOnCellMouseDown(e,n,r,o){this._getHeaderTreeNodeDataByCoords(n)&&(o.column=!0)}onAfterOnCellMouseDown(e,n){const r=this._getHeaderTreeNodeDataByCoords(n);if(!r)return;Qs(this,zu,n.clone()),Qs(this,af,!0);const{selection:o}=this.hot,i=o.isSelected()?o.getSelectedRange().current():null,s=[],{columnIndex:l,origColspan:a}=r,u=!o.inInSelection(n);e.shiftKey&&i?n.col<i.from.col?s.push(i.getTopEndCorner().col,l,n.row):n.col>i.from.col?s.push(i.getTopStartCorner().col,l+a-1,n.row):s.push(l,l+a-1,n.row):(Dm(e)||Ts(e)&&u)&&s.push(l,l+a-1,n.row),o.selectColumns(...s)}onBeforeOnCellMouseOver(e,n,r,o){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(n);if(!i)return;const{columnIndex:s,origColspan:l}=i,a=this.hot.getSelectedRangeLast(),u=a.getTopStartCorner(),c=a.getBottomEndCorner(),{from:h}=a;o.column=!0,o.cell=!0;const f=[],g=wr(n.row,-1/0,-1);n.col<h.col?f.push(c.col,s,g):n.col>h.col?f.push(u.col,s+l-1,g):f.push(s,s+l-1,g),this.hot.selection.selectColumns(...f)}onBeforeOnCellMouseUp(){Qs(this,af,!1)}onBeforeSelectionHighlightSet(){const{navigableHeaders:e}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Je(this,af)||!e)return;const n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner().col,o=n.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=Je(this,ut).getHeaderTreeNodeData(Je(this,zu).row,Je(this,zu).col);if(n.setHighlight(Je(this,zu)),s>n.getWidth()||i<r||i+s-1>o){const l=Je(this,ut).findTopMostEntireHeaderLevel(wr(r,i,i+s-1),wr(o,i,i+s-1));n.highlight.row=l,n.highlight.col=n.from.col}}onModifyTransformStart(e){const{highlight:n}=this.hot.getSelectedRangeLast(),r=this.hot._createCellCoords(n.row+e.row,n.col+e.col);if(!(r.isHeader()&&r.col>=0))return;const i=Je(this,ut).findLeftMostColumnIndex(r.row,r.col),s=Je(this,ut).findRightMostColumnIndex(r.row,r.col);if(e.col<0){const l=n.col>=i&&n.col<=s?i-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(l,-1);a===null?e.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,n.col)-1,1)}else if(e.col>0){const l=n.col>=i&&n.col<=s?s+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(l,1);a===null?e.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):e.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,a)-1,1)}}onBeforeSelectColumns(e,n){const r=e.row,o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col}),i=this._getHeaderTreeNodeDataByCoords({row:r,col:n.col});n.col<e.col?(o&&(e.col=o.columnIndex+o.origColspan-1),i&&(n.col=i.columnIndex)):n.col>=e.col&&(o&&(e.col=o.columnIndex),i&&(n.col=i.columnIndex+i.origColspan-1))}onAfterGetColumnHeaderRenderers(e){e.length=0;for(let n=0;n<Je(this,ut).getLayersCount();n++)e.push(this.headerRendererFactory(n))}onAfterViewportColumnCalculatorOverride(e){const n=Je(this,ut).getLayersCount();let r=e.startColumn,o=!!n;for(let i=0;i<n;i++){const s=Je(this,ut).findLeftMostColumnIndex(i,e.startColumn),l=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(o=!1),jn(l)&&l<e.startColumn){r=l;break}}e.startColumn=o?Je(this,ut).getHeaderTreeNodeData(0,r).columnIndex:r}onModifyColWidth(e,n){const r=this.ghostTable.getWidth(n);return e>r?e:r}onModifyColumnHeaderValue(e,n,r){var o;const{label:i}=(o=Je(this,ut).getHeaderTreeNodeData(r,n))!==null&&o!==void 0?o:{label:""};return i}onModifyFocusedElement(e,n){if(e<0)return this.hot.getCell(e,Je(this,ut).findLeftMostColumnIndex(e,n),!0)}onInit(){this.updatePlugin()}onAfterLoadData(e,n){n||this.updatePlugin()}destroy(){Qs(this,ut,null),Je(this,ji)!==null&&(Je(this,ji).unsubscribe(),Qs(this,ji,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Je(this,ut).getHeaderTreeNodeData(e.row,e.col)}}class Sre{constructor(e,n){this.hot=n,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},ye(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&O(e.__children,o=>{this.cacheNode(o,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,o){let i=!1,s=n;if(isNaN(s)&&s.end)return s;let l=e;return l||(l={__children:this.data},i=!0,s-=1),r!=null&&s===r?{result:l,end:!0}:o!=null&&l===o?{result:s,end:!0}:(s+=1,l.__children&&O(l.__children,a=>{if(this.parentReference.set(a,i?null:l),s=this.readTreeNodes(a,s,r,o),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ue(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(O(r.__children,o=>{n+=1,o.__children&&(n+=this.countChildren(o))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let o=null;e&&(o=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(e)+1,1);let i=e;e||(i=this.mockParent()),i.__children||(i.__children=[]),r||(r=this.mockNode()),i.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let o=r,i;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",e,o,n),e){const l=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",l,1),e.__children.splice(n,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),i=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),i=this.getRowIndex(this.data[n]);o=this.getDataObject(i),this.hot.runHooks("afterAddChild",e,o,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),o=this.getRowParent(r),i=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(o,i+1,null);break;case"above":this.addChildAtIndex(o,i,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const o=[];Array.isArray(e)?(ye(e[0],e[2],f=>{const g=this.translateTrimmedRow(f);o.push(this.getDataObject(g))}),ye(0,o.length-2,f=>{this.detachFromParent(o[f],!1)}),r=o[o.length-1]):r=e;const i=this.getRowIndex(r),s=this.countChildren(r),l=this.getRowIndexWithinParent(r),a=this.getRowParent(r),u=this.getRowParent(a),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",a,r),l!=null){const f=Array.from(new Array(i+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",i,s+1,f,this.plugin.pluginName),a.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,s+1,f,this.plugin.pluginName),u){h=c+this.countChildren(u);const g=this.getChild(u,this.countChildren(u)-1),p=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",p+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",a,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const o=[];O(r,i=>{o.push(this.getDataObject(i))}),O(o,i=>{const s=this.getRowIndexWithinParent(i),l=this.getRowParent(i);l===null?this.data.splice(s,1):l.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const o=this.getDataObject(e-1);let i=null,s=e;o&&o.__children&&o.__children.length===0?(i=o,s=0):e<this.countAllRows()&&(i=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),i?r?i.__children.splice(s,n,...r):i.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,o){const i=n===this.hot.countRows(),s=this.getRowParent(e),l=this.getRowIndexWithinParent(e),a=s.__children.slice(l,l+1),u=e>n;let c=i?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=i||r||o?c.__children.length:this.getRowIndexWithinParent(n),f=s===c;c.__children.splice(h,0,a[0]),s.__children.splice(l+(u&&f?1:0),1),this.syncRowWithRawSource(s),f||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const Rre=Sre;class bre{constructor(e,n){this.hot=n,this.plugin=e}}const PE=bre;class ui extends PE{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),o=this.dataManager.getRowLevel(r),i=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],l=s.querySelector("span.rowHeader"),a=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(O(a,c=>{c&&s.removeChild(c)}),te(n,ui.CSS_CLASSES.indicatorContainer),o){const{rootDocument:c}=this.hot,h=l.cloneNode(!0);s.innerHTML="",ye(0,o-1,()=>{const f=c.createElement("SPAN");te(f,ui.CSS_CLASSES.emptyIndicator),s.appendChild(f)}),s.appendChild(h)}if(this.dataManager.hasChildren(i)){const c=this.hot.rootDocument.createElement("DIV");u&&He(c,[ru()]),te(n,ui.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(te(c,`${ui.CSS_CLASSES.button} ${ui.CSS_CLASSES.expandButton}`),u&&He(n,[Fr(!1)])):(te(c,`${ui.CSS_CLASSES.button} ${ui.CSS_CLASSES.collapseButton}`),u&&He(n,[Fr(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const HN=ui;class Ere extends PE{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,o)},shiftStash:function(o,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;i==null&&(i=1/0),O(r.lastCollapsedRows,(l,a)=>{l>=o&&l<i&&(r.lastCollapsedRows[a]=l+s)})},applyStash:function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,o),r.lastCollapsedRows=void 0},trimStash:(o,i)=>{ye(o,o+i-1,s=>{const l=this.lastCollapsedRows.indexOf(s);l>-1&&this.lastCollapsedRows.splice(l,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];let i=null,s=null,l=null;return isNaN(e)?(i=e,s=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(i)&&O(i.__children,a=>{o.push(this.dataManager.getRowIndex(a))}),l=this.collapseRows(o,!0,!1),r&&this.trimRows(l),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),l}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];O(e,i=>{o.push(...this.collapseChildren(i,!1,!1))}),r&&this.trimRows(o),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=[];return O(e,i=>{o.push(i),n&&this.collapseChildRows(i,o)}),r&&this.trimRows(o),o}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);O(o.__children,i=>{const s=this.dataManager.getRowIndex(i);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=[];return O(e,i=>{o.push(i),n&&this.expandChildRows(i,o)}),r&&this.untrimRows(o),o}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);O(o.__children,i=>{if(!this.isAnyParentCollapsed(i)){const s=this.dataManager.getRowIndex(i);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];let i=null,s=null,l=null;return isNaN(e)?(i=e,s=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(i)&&O(i.__children,a=>{const u=this.dataManager.getRowIndex(a);o.push(u)}),l=this.expandRows(o,!0,!1),r&&this.untrimRows(l),n&&this.renderAndAdjust(),l}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];O(e,i=>{o.push(...this.expandChildren(i,!1,!1))}),r&&this.untrimRows(o),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];O(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];O(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{O(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{O(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&O(n.__children,o=>{const i=this.dataManager.getRowIndex(o);if(!this.plugin.collapsedRowsMap.getValueAtIndex(i))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);Pe(e.target,HN.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),br(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const Tre=Ere,I_=new WeakMap;class Mre extends PE{constructor(e,n){super(e,n),I_.set(this,{row_above:(r,o)=>{const i=o[o.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(r,o)=>{const i=o[o.length-1];this.dataManager.addSibling(i.start.row,"below")}}),this.dataManager=this.plugin.dataManager}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(mb)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),o=this.dataManager.getDataObject(r);this.dataManager.addChild(o)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(pb)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),o=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(o)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return ye(0,e.items.length-1,r=>{if(r===0)return O(n,(o,i)=>{e.items.splice(r+i,0,o)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){const n=I_.get(this);return ye(0,e.items.length-1,r=>{const o=n[e.items[r].key];o!=null&&(e.items[r].callback=o)}),e}}const xre=Mre;class _re{constructor(e){this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,o){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:o}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),l=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let a=!0;const u=e.map(p=>{if(!a)return!1;const y=this.dataManager.translateTrimmedRow(p);return a=this.shouldAllowMoving(y,l),y}),c=u.indexOf(l)===-1;if(!a||!c)return!1;const h=this.getBaseParent(u),f=this.getTargetParent(s,l),g=h===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,l,g),this.moveRows(u,l,f),this.dataManager.rewriteCache(),this.moveCellsMeta(u,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,o,o&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:o,movePossible:i}=e;let s=!1;return vt(o)&&(Ct(ht`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,o,i,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const o=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(i=>{this.dataManager.moveRow(i,n,this.movedToCollapsed,o)})})}moveCellsMeta(e,n){const r=[],o=Math.max(...e)<n;e.forEach(i=>{r.push(this.hot.getCellMetaAtRow(i))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(o?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let o=0,i=0,s=null,l=null;if(this.movedToCollapsed){let a=null;e[r-1]<n?a=this.dataManager.translateTrimmedRow(n-r):a=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(a===null?this.hot.countSourceRows()-1:a-1),c=this.dataManager.getRowIndex(u);o=this.dataManager.untranslateTrimmedRow(c),i=o}else e[r-1]<n?(i=n-1,o=i-r+1):(o=n,i=o+r-1);s=this.hot.selection,l=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(o,0)),s.setRangeEnd(this.hot._createCellCoords(i,l),!0)}isRowOrderChanged(e,n){return e.some((r,o)=>r-o!==n)}}const Bf="nestedRows",Ore=300,A_=Bf,ii=new WeakMap,Ire="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";class Are extends ot{static get PLUGIN_KEY(){return Bf}static get PLUGIN_PRIORITY(){return Ore}constructor(e){super(e),this.dataManager=null,this.headersUI=null,this.collapsedRowsMap=null,ii.set(this,{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1})}isEnabled(){return!!this.hot.getSettings()[Bf]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Ah),this.dataManager=new Rre(this,this.hot),this.collapsingUI=new Tre(this,this.hot),this.headersUI=new HN(this,this.hot),this.contextMenuUI=new xre(this,this.hot),this.rowMoveController=new _re(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("beforeViewRender",function(){return e.onBeforeViewRender(...arguments)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){return e.onFilterData(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeRemoveRow",function(){return e.onBeforeRemoveRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("beforeAddChild",function(){return e.onBeforeAddChild(...arguments)}),this.addHook("afterAddChild",function(){return e.onAfterAddChild(...arguments)}),this.addHook("beforeDetachChild",function(){return e.onBeforeDetachChild(...arguments)}),this.addHook("afterDetachChild",function(){return e.onAfterDetachChild(...arguments)}),this.addHook("modifyRowHeaderWidth",function(){return e.onModifyRowHeaderWidth(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("beforeRowMove",function(){return e.onBeforeRowMove(...arguments)}),this.addHook("beforeLoadData",n=>this.onBeforeLoadData(n)),this.addHook("beforeUpdateData",n=>this.onBeforeLoadData(n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:A_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(A_)}onBeforeRowMove(e,n,r,o){return this.rowMoveController.onBeforeRowMove(e,n,r,o)}disableCoreAPIModifiers(){const e=ii.get(this);e.skipCoreAPIModifiers=!0}enableCoreAPIModifiers(){const e=ii.get(this);e.skipCoreAPIModifiers=!1}onBeforeOnCellMouseDown(e,n,r){this.collapsingUI.toggleState(e,n,r)}onModifyRowData(e){if(!ii.get(this).skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!ii.get(this).skipCoreAPIModifiers)return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return ii.get(this).skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}onFilterData(e,n,r){const o=ii.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],n),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*n),this.dataManager.filterData(e,n,r),o.skipRender=!0,this.dataManager.getData().slice()}onAfterContextMenuDefaultOptions(e){return this.contextMenuUI.appendOptions(e)}onAfterGetRowHeader(e,n){this.headersUI.appendLevelIndicators(e,n)}onModifyRowHeaderWidth(e){return this.headersUI.rowHeaderWidthCache||e}onAfterRemoveRow(e,n,r,o){if(o===this.pluginName)return;const i=ii.get(this);setTimeout(()=>{i.skipRender=null,this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()},0)}onBeforeRemoveRow(e,n,r){const o=Array.from(r.reduce((i,s)=>{if(this.dataManager.isParent(s)){const l=this.dataManager.getDataObject(s).__children;return i.add(s),Array.isArray(l)&&l.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(s)},new Set));r.length=0,r.push(...o)}onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterAddChild(e,n){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(n)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterDetachChild(e,n,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onAfterCreateRow(){this.dataManager.rewriteCache()}onAfterInit(){this.headersUI.updateRowHeaderWidth()}onBeforeViewRender(e,n){ii.get(this).skipRender&&(n.skipRender=!0)}destroy(){super.destroy()}onBeforeLoadData(e){if(!mk(e)){Z0(Ire),this.hot.getSettings()[Bf]=!1,this.disablePlugin();return}this.dataManager.setData(e),this.dataManager.rewriteCache()}}class Hre{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;this.rootWindow=n,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,o=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return o===null?void 0:JSON.parse(o)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){O(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const Pre=Hre;me.getSingleton().register("persistentStateSave");me.getSingleton().register("persistentStateLoad");me.getSingleton().register("persistentStateReset");const H_="persistentState",kre=0;class Dre extends ot{static get PLUGIN_KEY(){return H_}static get PLUGIN_PRIORITY(){return kre}constructor(e){super(e),this.storage=void 0}isEnabled(){return!!this.hot.getSettings()[H_]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Pre(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}const XC="search",Nre=190,Lre="htSearchResult",Fre=function(t,e,n,r,o){t.getCellMeta(e,n).isSearchResult=o},$re=function(t,e,n){return vt(t)||t===null||!t.toLocaleLowerCase||t.length===0||vt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};class Vre extends ot{static get PLUGIN_KEY(){return XC}static get PLUGIN_PRIORITY(){return Nre}constructor(e){super(e),this.callback=Fre,this.queryMethod=$re,this.searchResultClass=Lre}isEnabled(){return this.hot.getSettings()[XC]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[XC];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){return e.onBeforeRenderer(...arguments)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){return e.onBeforeRenderer(...arguments)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const o=this.hot.countRows(),i=this.hot.countCols(),s=[],l=this.hot;return ye(0,o-1,a=>{ye(0,i-1,u=>{const c=this.hot.getDataAtCell(a,u),h=this.hot.getCellMeta(a,u),f=h.search.callback||n,p=(h.search.queryMethod||r)(e,c,h);if(p){const y={row:a,col:u,data:c};s.push(y)}f&&f(l,a,u,c,p)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){$e(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}onBeforeRenderer(e,n,r,o,i,s){const l=s.className||[];let a=[];typeof l=="string"?a=l.split(" "):a.push(...l),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}destroy(){super.destroy()}}const Bre="touchScroll",Wre=200;class Ure extends ot{static get PLUGIN_KEY(){return Bre}static get PLUGIN_PRIORITY(){return Wre}static get SETTING_KEYS(){return!0}constructor(e){super(e),this.scrollbars=[],this.clones=[],this.lockedCollection=!1,this.freezeOverlays=!1}isEnabled(){return aR()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>this.onAfterViewRender()),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>this.onBeforeTouchScroll()),this.addHook("afterMomentumScroll",()=>this.onAfterMomentumScroll())}onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:n,inlineStartOverlay:r,topInlineStartCornerOverlay:o,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),n.clone&&this.scrollbars.push(n),this.scrollbars.push(r),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}onBeforeTouchScroll(){this.freezeOverlays=!0,O(this.clones,e=>{te(e,"hide-tween")})}onAfterMomentumScroll(){this.freezeOverlays=!1,O(this.clones,e=>{ke(e,"hide-tween"),te(e,"show-tween")}),this.hot._registerTimeout(()=>{O(this.clones,e=>{ke(e,"show-tween")})},400),O(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}const uf="trimRows",zre=330;class jre extends ot{static get PLUGIN_KEY(){return uf}static get PLUGIN_PRIORITY(){return zre}constructor(e){super(e),this.trimmedRowsMap=null}isEnabled(){return!!this.hot.getSettings()[uf]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Ah),this.trimmedRowsMap.addLocalHook("init",()=>this.onMapInit()),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[uf];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),O(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let o=n;r&&(o=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,o,r)!==!1&&(r&&this.hot.batchExecution(()=>{O(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,o,r,r&&o.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let o=n;const i=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(O(e,a=>{i[a]=!1}),o=Gt(i,(a,u,c)=>(u&&a.push(c),a),[])),this.hot.runHooks("beforeUntrimRow",n,o,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",n,o,r&&s,r&&o.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}onMapInit(){const e=this.hot.getSettings()[uf];Array.isArray(e)&&this.hot.batchExecution(()=>{O(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0)}destroy(){super.destroy()}}const PN="undoRedo",Yre="undoRedo";function de(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,r){const o=n&&n.length;if(!o||!n.find(l=>{const[,,a,u]=l;return a!==u}))return;const s=()=>{const l=n.reduce((u,c)=>(u.push([...c]),u),[]);O(l,u=>{u[1]=t.propToCol(u[1])});const a=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new de.ChangeAction(l,a)};e.done(s,r)}),t.addHook("afterCreateRow",(n,r,o)=>{e.done(()=>new de.CreateRowAction(n,r),o)}),t.addHook("beforeRemoveRow",(n,r,o,i)=>{const s=()=>{const l=t.toPhysicalRow(n),a=kn(e.instance.getSourceData(l,0,l+r-1,e.instance.countSourceCols()-1));return new de.RemoveRowAction(l,a,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(s,i)}),t.addHook("afterCreateCol",(n,r,o)=>{e.done(()=>new de.CreateColumnAction(n,r),o)}),t.addHook("beforeRemoveCol",(n,r,o,i)=>{const s=()=>{const l=e.instance.getSourceDataArray(),a=(e.instance.countCols()+n)%e.instance.countCols(),u=[],c=[],h=[];ye(l.length-1,p=>{const y=[],E=l[p];ye(a,a+(r-1),w=>{y.push(E[t.toPhysicalColumn(w)])}),u.push(y)}),ye(r-1,p=>{h.push(t.toPhysicalColumn(a+p))}),Array.isArray(t.getSettings().colHeaders)&&ye(r-1,p=>{c.push(t.getSettings().colHeaders[t.toPhysicalColumn(a+p)]||null)});const f=t.columnIndexMapper.getIndexesSequence(),g=t.rowIndexMapper.getIndexesSequence();return new de.RemoveColumnAction(a,h,u,c,f,g,t.getSettings().fixedColumnsStart)};e.done(s,i)}),t.addHook("beforeCellAlignment",(n,r,o,i)=>{e.done(()=>new de.CellAlignmentAction(n,r,o,i))}),t.addHook("beforeFilter",n=>{e.done(()=>new de.FiltersAction(n))}),t.addHook("beforeRowMove",(n,r)=>{n!==!1&&e.done(()=>new de.RowMoveAction(n,r))}),t.addHook("beforeMergeCells",(n,r)=>{r||e.done(()=>new de.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,r)=>{r||e.done(()=>new de.UnmergeCellsAction(t,n))}),t.addHook("afterInit",()=>{e.init()})}de.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const i=t(),s=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};de.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=kn(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),e.undo(this.instance,()=>{o.ignoreNewActions=!1,o.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};de.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=kn(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),e.redo(this.instance,()=>{o.ignoreNewActions=!1,o.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};de.prototype.isUndoAvailable=function(){return this.doneActions.length>0};de.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};de.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};de.prototype.isEnabled=function(){return this.enabled};de.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,Xre(t),this.registerShortcuts(),t.addHook("afterChange",kN)};de.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,qre(t),this.unregisterShortcuts(),t.removeHook("afterChange",kN)};de.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};de.Action=function(){};de.Action.prototype.undo=function(){};de.Action.prototype.redo=function(){};de.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Ai(de.ChangeAction,de.Action);de.ChangeAction.prototype.undo=function(t,e){const n=kn(this.changes),r=t.countEmptyRows(!0),o=t.countEmptyCols(!0);for(let i=0,s=n.length;i<s;i++)n[i].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let i=0,s=n.length;i<s;i++){const[l,a]=n[i];t.getSettings().minSpareRows&&l+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(l+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&a+1+t.getSettings().minSpareCols===t.countCols()&&o===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(a+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};de.ChangeAction.prototype.redo=function(t,e){const n=kn(this.changes);for(let r=0,o=n.length;r<o;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};de.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Ai(de.CreateRowAction,de.Action);de.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};de.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};de.RemoveRowAction=function(t,e,n,r,o){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=o};Ai(de.RemoveRowAction,de.Action);de.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,i)=>{Object.keys(o).forEach(s=>{const l=parseInt(s,10);r.push([this.index+i,isNaN(l)?s:l,o[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};de.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};de.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Ai(de.CreateColumnAction,de.Action);de.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};de.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};de.RemoveColumnAction=function(t,e,n,r,o,i,s){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s};Ai(de.RemoveColumnAction,de.Action);de.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),o=(u,c,h)=>h[this.indexes.indexOf(r[c])],i=this.data.length,s=[];for(let u=0;u<i;u++)s.push(We(this.data[u],o));const l=We(this.headers,o),a=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),O(t.getSourceDataArray(),(u,c)=>{O(r,(h,f)=>{u[h]=s[c][f],a.push([c,h,u[h]])})}),t.setSourceDataAtCell(a,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&O(l,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};de.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};de.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};de.CellAlignmentAction.prototype.undo=function(t,e){O(this.range,n=>{n.forAll((r,o)=>{r>=0&&o>=0&&t.setCellMeta(r,o,"className",this.stateBefore[r][o]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};de.CellAlignmentAction.prototype.redo=function(t,e){Gi(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,o,i)=>t.setCellMeta(n,r,o,i)),t.addHookOnce("afterViewRender",e),t.render()};de.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};Ai(de.FiltersAction,de.Action);de.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};de.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class Gre extends de.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),o=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,o.row,o.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const o=this.cellRange.getTopStartCorner();e.populateFromArray(o.row,o.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}de.MergeCellsAction=Gre;class Kre extends de.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}de.UnmergeCellsAction=Kre;de.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};Ai(de.RowMoveAction,de.Action);de.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),o=r.filter(l=>l>this.finalIndex),i=r.filter(l=>l<=this.finalIndex),s=o.sort((l,a)=>a-l).concat(i.sort((l,a)=>l-a));t.addHookOnce("afterViewRender",e);for(let l=0;l<s.length;l+=1){const a=t.toVisualRow(s[l]);n.moveRow(a,s[l])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};de.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};de.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};de.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:o=>!o.altKey,group:PN};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};de.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(PN)};function kN(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function Xre(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function qre(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const Fh=me.getSingleton();Fh.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});Fh.register("beforeUndo");Fh.register("afterUndo");Fh.register("beforeRedo");Fh.register("afterRedo");de.PLUGIN_KEY=Yre;de.SETTING_KEYS=!0;function Qre(){et(Sc),et(lQ),et(Rc),et(SQ),et(IQ),et(MD),et(oZ),et(NZ),et(hp),et(PJ),et(QJ),et(JJ),et(fp),et(fee),et(lte),et(Nte),et(Ute),et(qte),et(ene),et(une),et(hne),et(yne),et(Rne),et(Ane),et(Nne),et($ne),et(yre),et(Are),et(Dre),et(Vre),et(Ure),et(jre),et(de)}function Zre(){JX(),gq(),Rq(),Wq(),Qre()}function Jre(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let o=r.data("handsontable");if(typeof n!="string"){const u=n||{};return o?o.updateSettings(u):(o=new t.Core(r[0],u),r.data("handsontable",o),o.init()),r}let i;if(o)if(typeof o[n]<"u"){for(var s=arguments.length,l=new Array(s>1?s-1:0),a=1;a<s;a++)l[a-1]=arguments[a];i=o[n].call(o,...l),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return i})}var qC,QC,ZC,JC,ev;Zre();Jre(ae);ae.__GhostTable=pE;ae._getListenersCounter=U4;ae._getRegisteredMapsCounter=o5;ae.EventManager=Dt;const eoe=[R3,I4,Q8,pq,rK,h4,M3,J4,x4,_3,P4,Z4],toe=[l4,k4];ae.helper={};ae.dom={};O(eoe,t=>{O(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(ae.helper[e]=t[e])})});O(toe,t=>{O(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(ae.dom[e]=t[e])})});ae.cellTypes=(qC=ae.cellTypes)!==null&&qC!==void 0?qC:{};O(p9(),t=>{ae.cellTypes[t]=Zb(t)});ae.cellTypes.registerCellType=Ar;ae.cellTypes.getCellType=Zb;ae.editors=(QC=ae.editors)!==null&&QC!==void 0?QC:{};O($4(),t=>{ae.editors[`${Hn(t)}Editor`]=_g(t)});ae.editors.registerEditor=or;ae.editors.getEditor=_g;ae.renderers=(ZC=ae.renderers)!==null&&ZC!==void 0?ZC:{};O(g6(),t=>{const e=Ig(t);t==="base"&&(ae.renderers.cellDecorator=e),ae.renderers[`${Hn(t)}Renderer`]=e});ae.renderers.registerRenderer=Io;ae.renderers.getRenderer=Ig;ae.validators=(JC=ae.validators)!==null&&JC!==void 0?JC:{};O(w6(),t=>{ae.validators[`${Hn(t)}Validator`]=nR(t)});ae.validators.registerValidator=Sa;ae.validators.getValidator=nR;ae.plugins=(ev=ae.plugins)!==null&&ev!==void 0?ev:{};O(tR(),t=>{ae.plugins[t]=_h(t)});ae.plugins[`${Hn(ot.PLUGIN_KEY)}Plugin`]=ot;ae.plugins.registerPlugin=et;ae.plugins.getPlugin=_h;const DN=t=>{var e;ch.useEffect(()=>{var r;const n=(r=t.cellProperties)==null?void 0:r.className;n!==void 0&&t.TD&&ae.dom.addClass(t.TD,n)},[(e=t.cellProperties)==null?void 0:e.className,t.TD])};function noe(t){return DN(t),we.jsx("div",{className:"progressBar",style:{width:`${t.value*10}px`}})}function roe(t){return DN(t),we.jsx("div",{className:"star htCenter",children:"".repeat(t.value)})}var kE={exports:{}};kE.exports;(function(t){(function(e,n,r){function o(a){var u=this,c=l();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(a),u.s0<0&&(u.s0+=1),u.s1-=c(a),u.s1<0&&(u.s1+=1),u.s2-=c(a),u.s2<0&&(u.s2+=1),c=null}function i(a,u){return u.c=a.c,u.s0=a.s0,u.s1=a.s1,u.s2=a.s2,u}function s(a,u){var c=new o(a),h=u&&u.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,h&&(typeof h=="object"&&i(h,c),f.state=function(){return i(c,{})}),f}function l(){var a=4022871197,u=function(c){c=String(c);for(var h=0;h<c.length;h++){a+=c.charCodeAt(h);var f=.02519603282416938*a;a=f>>>0,f-=a,f*=a,a=f>>>0,f-=a,a+=f*4294967296}return(a>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.alea=s})(so,t,!1)})(kE);var ooe=kE.exports,DE={exports:{}};DE.exports;(function(t){(function(e,n,r){function o(l){var a=this,u="";a.x=0,a.y=0,a.z=0,a.w=0,a.next=function(){var h=a.x^a.x<<11;return a.x=a.y,a.y=a.z,a.z=a.w,a.w^=a.w>>>19^h^h>>>8},l===(l|0)?a.x=l:u+=l;for(var c=0;c<u.length+64;c++)a.x^=u.charCodeAt(c)|0,a.next()}function i(l,a){return a.x=l.x,a.y=l.y,a.z=l.z,a.w=l.w,a}function s(l,a){var u=new o(l),c=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&i(c,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor128=s})(so,t,!1)})(DE);var ioe=DE.exports,NE={exports:{}};NE.exports;(function(t){(function(e,n,r){function o(l){var a=this,u="";a.next=function(){var h=a.x^a.x>>>2;return a.x=a.y,a.y=a.z,a.z=a.w,a.w=a.v,(a.d=a.d+362437|0)+(a.v=a.v^a.v<<4^(h^h<<1))|0},a.x=0,a.y=0,a.z=0,a.w=0,a.v=0,l===(l|0)?a.x=l:u+=l;for(var c=0;c<u.length+64;c++)a.x^=u.charCodeAt(c)|0,c==u.length&&(a.d=a.x<<10^a.x>>>4),a.next()}function i(l,a){return a.x=l.x,a.y=l.y,a.z=l.z,a.w=l.w,a.v=l.v,a.d=l.d,a}function s(l,a){var u=new o(l),c=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&i(c,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorwow=s})(so,t,!1)})(NE);var soe=NE.exports,LE={exports:{}};LE.exports;(function(t){(function(e,n,r){function o(l){var a=this;a.next=function(){var c=a.x,h=a.i,f,g;return f=c[h],f^=f>>>7,g=f^f<<24,f=c[h+1&7],g^=f^f>>>10,f=c[h+3&7],g^=f^f>>>3,f=c[h+4&7],g^=f^f<<7,f=c[h+7&7],f=f^f<<13,g^=f^f<<9,c[h]=g,a.i=h+1&7,g};function u(c,h){var f,g=[];if(h===(h|0))g[0]=h;else for(h=""+h,f=0;f<h.length;++f)g[f&7]=g[f&7]<<15^h.charCodeAt(f)+g[f+1&7]<<13;for(;g.length<8;)g.push(0);for(f=0;f<8&&g[f]===0;++f);for(f==8?g[7]=-1:g[f],c.x=g,c.i=0,f=256;f>0;--f)c.next()}u(a,l)}function i(l,a){return a.x=l.x.slice(),a.i=l.i,a}function s(l,a){l==null&&(l=+new Date);var u=new o(l),c=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(c.x&&i(c,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorshift7=s})(so,t,!1)})(LE);var loe=LE.exports,FE={exports:{}};FE.exports;(function(t){(function(e,n,r){function o(l){var a=this;a.next=function(){var c=a.w,h=a.X,f=a.i,g,p;return a.w=c=c+1640531527|0,p=h[f+34&127],g=h[f=f+1&127],p^=p<<13,g^=g<<17,p^=p>>>15,g^=g>>>12,p=h[f]=p^g,a.i=f,p+(c^c>>>16)|0};function u(c,h){var f,g,p,y,E,w=[],C=128;for(h===(h|0)?(g=h,h=null):(h=h+"\0",g=0,C=Math.max(C,h.length)),p=0,y=-32;y<C;++y)h&&(g^=h.charCodeAt((y+32)%h.length)),y===0&&(E=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,y>=0&&(E=E+1640531527|0,f=w[y&127]^=g+E,p=f==0?p+1:0);for(p>=128&&(w[(h&&h.length||0)&127]=-1),p=127,y=4*128;y>0;--y)g=w[p+34&127],f=w[p=p+1&127],g^=g<<13,f^=f<<17,g^=g>>>15,f^=f>>>12,w[p]=g^f;c.w=E,c.X=w,c.i=p}u(a,l)}function i(l,a){return a.i=l.i,a.w=l.w,a.X=l.X.slice(),a}function s(l,a){l==null&&(l=+new Date);var u=new o(l),c=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(c.X&&i(c,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor4096=s})(so,t,!1)})(FE);var aoe=FE.exports,$E={exports:{}};$E.exports;(function(t){(function(e,n,r){function o(l){var a=this,u="";a.next=function(){var h=a.b,f=a.c,g=a.d,p=a.a;return h=h<<25^h>>>7^f,f=f-g|0,g=g<<24^g>>>8^p,p=p-h|0,a.b=h=h<<20^h>>>12^f,a.c=f=f-g|0,a.d=g<<16^f>>>16^p,a.a=p-h|0},a.a=0,a.b=0,a.c=-1640531527,a.d=1367130551,l===Math.floor(l)?(a.a=l/4294967296|0,a.b=l|0):u+=l;for(var c=0;c<u.length+20;c++)a.b^=u.charCodeAt(c)|0,a.next()}function i(l,a){return a.a=l.a,a.b=l.b,a.c=l.c,a.d=l.d,a}function s(l,a){var u=new o(l),c=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&i(c,u),h.state=function(){return i(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.tychei=s})(so,t,!1)})($E);var uoe=$E.exports,NN={exports:{}};const coe={},hoe=Object.freeze(Object.defineProperty({__proto__:null,default:coe},Symbol.toStringTag,{value:"Module"})),doe=V_(hoe);(function(t){(function(e,n,r){var o=256,i=6,s=52,l="random",a=r.pow(o,i),u=r.pow(2,s),c=u*2,h=o-1,f;function g(T,x,A){var D=[];x=x==!0?{entropy:!0}:x||{};var U=w(E(x.entropy?[T,S(n)]:T??C(),3),D),j=new p(D),z=function(){for(var Z=j.g(i),re=a,ne=0;Z<u;)Z=(Z+ne)*o,re*=o,ne=j.g(1);for(;Z>=c;)Z/=2,re/=2,ne>>>=1;return(Z+ne)/re};return z.int32=function(){return j.g(4)|0},z.quick=function(){return j.g(4)/4294967296},z.double=z,w(S(j.S),n),(x.pass||A||function(Z,re,ne,ue){return ue&&(ue.S&&y(ue,j),Z.state=function(){return y(j,{})}),ne?(r[l]=Z,re):Z})(z,U,"global"in x?x.global:this==r,x.state)}function p(T){var x,A=T.length,D=this,U=0,j=D.i=D.j=0,z=D.S=[];for(A||(T=[A++]);U<o;)z[U]=U++;for(U=0;U<o;U++)z[U]=z[j=h&j+T[U%A]+(x=z[U])],z[j]=x;(D.g=function(Z){for(var re,ne=0,ue=D.i,Re=D.j,Ne=D.S;Z--;)re=Ne[ue=h&ue+1],ne=ne*o+Ne[h&(Ne[ue]=Ne[Re=h&Re+re])+(Ne[Re]=re)];return D.i=ue,D.j=Re,ne})(o)}function y(T,x){return x.i=T.i,x.j=T.j,x.S=T.S.slice(),x}function E(T,x){var A=[],D=typeof T,U;if(x&&D=="object")for(U in T)try{A.push(E(T[U],x-1))}catch{}return A.length?A:D=="string"?T:T+"\0"}function w(T,x){for(var A=T+"",D,U=0;U<A.length;)x[h&U]=h&(D^=x[h&U]*19)+A.charCodeAt(U++);return S(x)}function C(){try{var T;return f&&(T=f.randomBytes)?T=T(o):(T=new Uint8Array(o),(e.crypto||e.msCrypto).getRandomValues(T)),S(T)}catch{var x=e.navigator,A=x&&x.plugins;return[+new Date,e,A,e.screen,S(n)]}}function S(T){return String.fromCharCode.apply(0,T)}if(w(r.random(),n),t.exports){t.exports=g;try{f=doe}catch{}}else r["seed"+l]=g})(typeof self<"u"?self:so,[],Math)})(NN);var foe=NN.exports,goe=ooe,moe=ioe,poe=soe,woe=loe,Coe=aoe,voe=uoe,Hl=foe;Hl.alea=goe;Hl.xor128=moe;Hl.xorwow=poe;Hl.xorshift7=woe;Hl.xor4096=Coe;Hl.tychei=voe;var yoe=Hl;const LN=ah(yoe);let FN=LN();function $N(){return FN()}function Soe(t){FN=LN(t)}function Pl(t,e){let n=t;if(Array.isArray(t)){let r=t;e!=null&&e.maxCharCount&&typeof t[0]=="string"&&(r=t.filter(o=>o.length<=e.maxCharCount)),n=()=>VN(r)}return(e==null?void 0:e.length)===void 0?n(0):Array.from({length:e.length},(r,o)=>n(o))}function VN(t){return t[Math.floor($N()*t.length)]}function Roe({min:t=1,max:e=9999.99,fraction:n=0}={}){if(e<t)throw new Error("Max must be bigger than min");return Number(($N()*(e-t)+t).toFixed(n))}function P_(t){return Pl(()=>VN([!0,!1]),t)}function Jr(t){const e={min:(t==null?void 0:t.min)??0,max:(t==null?void 0:t.max)??999999,precision:t==null?void 0:t.precision,fraction:t==null?void 0:t.fraction};return Pl(()=>{if(e.min===e.max)return e.min;const n=Roe(e);return e.precision!==void 0?Math.floor(n/e.precision)*e.precision:n},t)}function boe(t){const e=new Date(t.from).getTime(),n=new Date(t.to).getTime();if(e>=n)throw new Error("From must be before to");return Pl(()=>new Date(Jr({min:e,max:n})),t)}var Eoe=["Kautzer, Macejkovic and Fisher","Greenholt - Mosciski","Marquardt - Runolfsdottir","Abernathy Inc","Dickens - Lang","Hand, Bernhard and Kessler","Abbott LLC","Kub Inc","Johnston - Wisozk","Reichert LLC","Kohler LLC","Shanahan - Boyle","Batz - Rice","Cronin, Oberbrunner and Beier","Kuhlman, Schowalter and West","Luettgen Inc","Ward Group","Hills and Sons","Prohaska, Balistreri and Walker","Rempel - Durgan","Bernier LLC","Stehr - Lockman","Roberts, Rogahn and Dooley","Lesch - Jakubowski","Jenkins - Turcotte","Gerhold - Rowe","Block - Rau","Dickinson, Tremblay and Moore","Nader - Fritsch","Kreiger and Sons","Bartell, Wehner and Schowalter","Hegmann Inc","Orn, Spencer and Kiehn","Graham, Sipes and Towne","Hodkiewicz Inc","Mills Group","Legros, Tillman and Hodkiewicz","Lesch - Carter","Lesch Group","Kreiger - Sauer","Cartwright - Schuster","Labadie LLC","Pfannerstill, White and Mosciski","Jenkins LLC","Boehm, Hettinger and Huels","Maggio, Wisoky and Blick","Kozey Inc","Stracke - Wisozk","Olson, Olson and Carter","Orn, Gerlach and Runolfsdottir","Stracke - Kertzmann","Walker - Zieme","Hodkiewicz - Hintz","Lind Group","Fahey, Leannon and Gleichner","Mertz, Gusikowski and Lemke","Heidenreich - Aufderhar","Zboncak and Sons","Carroll Group","Brown LLC","Weber Inc","Rath LLC","Walker Inc","Heller, Hyatt and Jaskolski","Jacobi - Kutch","Skiles and Sons","Durgan - Stamm","Renner - Prosacco","Hahn - Welch","Lesch, Dooley and Bartell","Crona and Sons","Rogahn, Armstrong and Goyette","Lubowitz, Kuhlman and Bailey","Doyle Group","Dooley and Sons","Kerluke LLC","Bogan - Daniel","Hintz - Boehm","Swaniawski and Sons","Kris, Legros and Cartwright","Reichel Group","Russel - Hintz","Welch, Lockman and Hand","Pouros - Brakus","Mohr, Fritsch and Wisozk","Upton - Reichert","Koepp and Sons","Weber and Sons","Quigley, Bins and Becker","Strosin, Oberbrunner and Wunsch","Rodriguez - Spencer","Wilkinson - Dare","Gutkowski Inc","OReilly LLC","Collins, Mante and Pacocha","Steuber, Luettgen and Corkery","Kub and Sons","Lesch and Sons"];function ju(t){return Pl(Eoe,t)}var Toe=["Argentina","Peru","Colombia","Chile","Uruguay","Gabon","Congo","Norfolk Island","Qatar","Syrian Arab Republic","Wallis and Futuna","Somalia","Saint Barthelemy","Comoros","Sri Lanka","Czech Republic","Christmas Island","Macao","Montenegro","Anguilla","Canada","Mayotte","Tajikistan","Afghanistan","Liechtenstein","Cocos (Keeling) Islands","Angola","Bahrain","Dominican Republic","Croatia","Latvia","Virgin Islands, U.S.","United Kingdom","Brazil","Spain","Mongolia","Montserrat","Estonia","Benin","Guinea","Guinea-Bissau","Greece","Lao Peoples Democratic Republic","Puerto Rico","Slovakia (Slovak Republic)","United States of America","Switzerland","Costa Rica","Mauritius","Nigeria","Russian Federation","Germany","Antigua and Barbuda","Albania","Romania","Moldova","Senegal","Tanzania","British Indian Ocean Territory (Chagos Archipelago)","Central African Republic","New Caledonia","Burundi","Panama","Azerbaijan","Namibia","French Southern Territories","Vanuatu","Ethiopia","Burkina Faso","Tunisia","Mozambique","Belarus","Saint Kitts and Nevis","Hungary","Indonesia","Cyprus","Ecuador","Saint Martin","Nauru","Faroe Islands","Iran","Bolivia","Pitcairn Islands","France","Paraguay","Isle of Man","Sierra Leone","Monaco","Belize","Trinidad and Tobago"];function Moe(t){return Pl(Toe,t)}var xoe={china:["Peking roasted duck","Kung pao chicken","Sweet and sour pork","Hot pot","Dim sum","Dumplings","Ma po tofu","Char siu","Chicken chow mein","Beef chow mein","vegetable chow mein","Chicken fried rice","Beef fried rice","Vegetable fried Rice","Special fried Rice","Sichuan pork","Xiaolongbao","Zhajiangmian","Wonton soup","Sweet and sour pork","Duck spring Rolls","Vegetable spring Rolls","Wonton","Peking duck","Lamb hot pot","Spicy crayfish","Guilin rice noodles","Lanzhou hand-pulled noodles","Steamed crab","Shredded pork with garlic sauce","Red braised pork","Sweet and sour Ribs","Xinjiang","Braised pork with vermicelli"],italy:["Butternut squash risotto","Mushroom risotto","Beetroot risotto","Courgette risotto","Pizza","Gnocchi","Spaghetti bolognese","Spaghetti carbonara","Pesto alla Genovese","Beef lasagne","Vegetable lasagne","Gelato","Prosciutto di Parma","Ribollita","Bagna cauda","Polenta","Tortelli and ravioli","Focaccia","Garlic bread","Arancini","Il tartufo","Panzerotto fritto","Fiorentina","Minestrone","Frico","Arrosticini","Olive ascolante","Fritto misto piemontes","Tiramis"],india:["Biryani","Dosa","Tandoori chicken","Samosas","Chaat","Plain naan","Garlic naan","Pilau rice","Steamed rice","Chicken madras","Vegetable madras","Chicken vindaloo","Chicken jalfrezi","Chicken roghan josh","Lamb roghan josh","Beef roghan josh","Butter chicken","Dosa","Gulab jamun","Chicken korma","Mutter paneer","Papadum","Paratha","Raita","Saag paneer","Tandoori chicken","Chicken tikka masala","Pakora","Dal","Chapati","Pasanda","Aloo gobi","Kofta","Chicken makhani","Paneer naan","Chana Aloo Curry"],mexico:["Chilaquiles","Pozole","Tacos al pastor","Tostadas","Chiles en nogada","Elote","Enchiladas","Mole","Guacamole","Tamales","Huevos rancheros","Machaca","Discada","Beef Burrito","Chicken Burrito","Pozole de pollo o duajolote","Menudo","Cochinita pibil","Tamale","Quesadilla","Frijoles puercos","Chile en nogada","Esquites","Alegria de amaranto","Pipin","Aguachile","Ceviche","Pescado zarandeado","Camarones a la diabla","Birria de chivo","Tlayuda","Guacamole con chapulines","Flautas","Torta Ahogada","Carnitas","Caldo Azteca","Gorditas de Nata"],japan:["Sushi","Udon","Tofu","Tempura","Yakitori","Sashimi","Ramen","Donburi","Natto","Oden","Tamagoyaki","Soba","Tonkatsu","Kashipan","Sukiyaki","Miso soup","Okonomiyaki","Mentaiko","Nikujaga","Unagi no kabayaki","Shabu Shabu","Onigiri","Gyoza","Takoyaki","aiseki ryori","Edamame","Yakisoba","Chawanmushi","Wagashi"],france:["Foie gras","Hutres","Cassoulet","Poulet basquaise","Escargots au beurre persill","Mouclade charentaise","Galettes bretonnes","Flemish carbonnade","Quiche lorraine","Raclette","Cheese fondue","Beef fondue","Gratin dauphinois","Tartiflette","Bouillabaisse","Ratatouille","Boeuf bourguignon","Blanquette de veau","Pot-au-feu","Coq-au-vin","Hachis parmentier","Steak tartare","Choucroute","Souffl au fromage","Cuisses de grenouilles","Soupe  loignon","Baguette","Croissant","French cheeses","Fondant au chocolat","Tarte tatin","Macarons","Crme brle","le flottante","Profiteroles","Pain au chocolat"],lebanon:["Kibbeh","Kafta","Kanafeh","Hummus","Rice pilaf","Fattoush","Manakish","Tabbouleh","Sfeeha","Fattoush","Labneh","Muhammara","Lahm bi ajin","Kaak","Chanklich","Mssabaha","Shawarma","Kebbe","Falafel","Halewit el jeben","Namoura","Maamoul","Foul mdammas","Balila","Kawarma","Fattouch"],thailand:["Pad kra pao moo","Tom kha gai","Khao Pad","Chicken pad Thai","Vegetable pad Thai","Moo satay","Tom yum goong","Khao niew mamuang","Kai yad sai","Khao soi","Pad see ew","Laab moo","Gaeng panang","Gai pad med ma muang","Som tam","Poh pia tod","Gaeng massaman","Pla kapung nueng manao","Tod mun pla","Gaeng ped","Gaeng garee","Gaeng keow wan","Moo ping","Durian","Sai ooah","Hoy tod","Kuay teow reua","Mu kratha","Kao ka moo","Yam nua"],greece:["Moussaka","Papoutsakia","Pastitsio","Souvlaki","Soutzoukakia","Stifado","Tomatokeftedes","Tzatziki","Kolokithokeftedes","Giouvetsi","Choriatiki","Kleftiko","Gemista","Fasolada","Bougatsa","Tiropita","Spanakopita","Feta Cheese with Honey","Horta","Tirokroketes","Briam","Saganaki","Gigantes","Dolmades","Fasolatha","Koulouri","Loukoumades","Gyros","Galaktoboureko","Baklava"],turkey:["i kebap","Dner","Kfte","Pide","Kumpir","Meze","Mant","Lahmacun","Menemen","i kebap","skender kebab","Corba","Kuzu tandir","i Kfte","Pilav","Yaprak sarma","Dolma","mam bayld","Borek","Durum","Kumpir","Balik ekmek","Simit","Kunefe","Baklava","Lokum","Halva","Mozzaik pasta","Glla","Mercimek Kftesi","Haydari","Tursu suyu","Kahvalti","Kazan dibi","Hunkar begendi","Islak burgers","Salep","Yogurtlu kebab"],spain:["Tortilla de patatas","Fabada asturiana","Calots","Boquerones al vinagre","Empanada gallega","Paella","Gazpacho","Gachas","Migas","Bocadillo de calamares","Pulpo a feira","Caldo gallego","Lentejas con chorizo","Cocido madrileo","Cachopo","Caracoles"],venezuela:["Pabelln criollo","Arepa","Mondongo","Empanadas","Quesillo","Chicha andina","Tequeos","Cachapa","Hallaca","Perico","Pasticho","Mandocas","Caraotas negras","Patacones","Dulce de leche","Pan de Jamn"],chile:["Humitas","Empanadas","Porotos con riendas","Completos","Manjar","Cordero al palo","Pastel de choclo","Mote con huesillos","Sopaipillas","Curanto"],argentina:["Milanesas","Empanadas","Pizza fugazeta","Asado","Choripan","Bondiola","Bife de chorizo"],colombia:["Bandeja paisa","Chuleta valluna","Sancocho trifsico","Empanada valluna","Salpicon de frutas","Pastel de garbanzo","Ajiaco","Arepas","Arroz de lisa","Sancocho","Pan de bono","Cuchuco","Oblea","Cazuela de mariscos","Pan de yuca","Bollo Limpio","Almojbana","Empanadas","Arroz con Coco","Sopa de mondongo","Cazuela de Mariscos","Arroz con Pollo","Arepa de Huevo","Mote de Queso"],ecuador:["Encebollado","Ceviche","Tigrillo","Bolon de verde","Llapingacho","Mote pillo","Locro de papa","Churrasco"],peru:["Ceviche","Arroz con pollo","Aji de gallina","Llunca de gallina"],"el salvador":["Pupusa","Sopa de patas","Rigua","Flor de izote con huevo","Gallo en chicha"],romania:["Sarmale","Mici","Pomana porcului","Ciorb de fasole cu ciolan","Ciorb de burt","Ciorb rduean","Plcint cu brnz","Ciorb de potroace","Mmlig cu brnz i smntn","Tochitur","Piftie","Iahnie de fasole","Slnin afumat","Crnai afumai","Varz a la Cluj","Gula de cartofi cu afumtur","Cozonac de cas","Ciorb ardeleneasc de porc","Mucenici moldoveneti","Salat de boeuf","Dovleac copt","Papanai cu brnz de vac i afine","Drob de miel","Prjoale moldoveneti","Zacusc de vinete","Zacusc de fasole","Turt dulce","Cltitele cu gem","Cltitele cu brnza de vac","Balmo","Cozonac","Chiftele"]},$_;($_=Object.keys(xoe))==null||$_.length;function k_(t){const e=(t==null?void 0:t.years)??1;if(e<=0)throw new Error("Years must be positive, use future() instead");const n=365*e*24*60*60*1e3,r=new Date,o=new Date(r.getTime()-n);return Pl(()=>boe({from:o,to:r}),t)}var _oe=["Small Rubber Shoes","Fantastic Wooden Sausages","Handmade Frozen Salad","Intelligent Soft Car","Intelligent Concrete Chips","Handcrafted Concrete Bacon","Small Fresh Fish","Rustic Metal Towels","Unbranded Cotton Hat","Fantastic Frozen Bike","Generic Rubber Shirt","Unbranded Wooden Keyboard","Awesome Metal Computer","Gorgeous Fresh Shoes","Unbranded Concrete Sausages","Practical Wooden Ball","Ergonomic Soft Towels","Small Plastic Table","Awesome Metal Pants","Licensed Steel Sausages","Handcrafted Rubber Bike","Ergonomic Cotton Computer","Generic Wooden Ball","Fantastic Frozen Soap","Generic Plastic Keyboard","Awesome Cotton Pizza","Licensed Metal Chips","Handcrafted Cotton Towels","Handmade Plastic Tuna","Practical Granite Keyboard","Intelligent Concrete Soap","Rustic Concrete Chips","Fantastic Steel Hat","Rustic Cotton Chair","Gorgeous Metal Pants","Intelligent Metal Bacon","Handmade Rubber Car","Tasty Concrete Keyboard","Incredible Granite Hat","Practical Rubber Fish","Rustic Cotton Gloves","Rustic Cotton Ball","Refined Fresh Shirt","Generic Granite Sausages","Rustic Granite Fish","Practical Wooden Bacon","Sleek Plastic Chair","Handcrafted Fresh Mouse","Small Concrete Shoes","Awesome Fresh Chair","Incredible Soft Computer","Tasty Concrete Chips","Generic Rubber Sausages","Intelligent Concrete Chicken","Rustic Soft Ball","Awesome Steel Towels","Incredible Fresh Bike","Unbranded Granite Chicken","Rustic Concrete Bike","Small Frozen Sausages","Intelligent Plastic Gloves","Ergonomic Frozen Towels","Refined Frozen Ball","Refined Cotton Ball","Licensed Steel Salad","Intelligent Wooden Bacon","Unbranded Metal Shoes","Fantastic Granite Car","Ergonomic Granite Bacon","Awesome Wooden Shirt","Rustic Wooden Pizza","Tasty Frozen Table","Awesome Wooden Hat","Awesome Rubber Salad","Licensed Concrete Fish","Fantastic Soft Cheese","Rustic Frozen Pizza","Refined Concrete Tuna","Small Frozen Tuna","Licensed Granite Cheese","Practical Rubber Car","Rustic Steel Sausages","Awesome Concrete Hat","Awesome Granite Sausages","Sleek Plastic Chips","Handcrafted Wooden Gloves","Intelligent Metal Computer","Fantastic Fresh Sausages","Fantastic Plastic Salad","Unbranded Steel Sausages","Handcrafted Wooden Fish","Sleek Wooden Bacon","Unbranded Plastic Towels","Tasty Soft Sausages","Generic Metal Shirt","Handmade Granite Cheese","Small Fresh Bacon","Tasty Granite Towels","Licensed Steel Chips"];function D_(t){return Pl(_oe,t)}Soe("42219");const BN=[{companyName:ju({maxCharCount:18}),productName:D_({maxCharCount:18}),sellDate:k_().toLocaleDateString(),inStock:P_(),qty:Jr({max:500}),progress:Jr({max:10}),rating:Jr({max:5}),orderId:`${Jr({max:2,min:2})}-${Jr({max:7,min:7})}`,country:"United Kingdom",__children:[{companyName:ju({maxCharCount:18})},{companyName:ju({maxCharCount:18})},{companyName:ju({maxCharCount:18})}]},...Array.from({length:150},()=>({companyName:ju({maxCharCount:18}),productName:D_({maxCharCount:18}),sellDate:k_().toLocaleDateString(),inStock:P_(),qty:Jr({max:500}),progress:Jr({max:10}),rating:Jr({max:5}),orderId:`${Jr({max:2,min:2})}-${Jr({max:7,min:7})}`,country:Moe({maxCharCount:28})}))],Ooe=BN.reduce((t,e)=>t.includes(e.country)?t:[...t,e.country],[]);function Ioe({disableTabNavigation:t,navigableHeaders:e,renderAllRows:n,enterBeginsEditing:r,autoWrapRow:o,autoWrapCol:i,enterMoves:s,changeToggleOptions:l}){const a=u=>{switch(u){case"enableTabNavigation":l(c=>({...c,disableTabNavigation:!t}));break;case"enableHeaderNavigation":l(c=>({...c,navigableHeaders:!e}));break;case"enableCellVirtualization":l(c=>({...c,renderAllRows:!n,viewportColumnRenderingOffset:n?"auto":9}));break;case"enableCellEnterEditing":l(c=>({...c,enterBeginsEditing:!r}));break;case"enableArrowRLFirstLastColumn":l(c=>({...c,autoWrapRow:!o}));break;case"enableArrowTDFirstLastColumn":l(c=>({...c,autoWrapCol:!i}));break;case"enableEnterFocusEditing":l(c=>({...c,enterMoves:s.row!==1?{col:0,row:1}:{col:0,row:0}}));break}};return we.jsx(we.Fragment,{children:we.jsxs("div",{className:"checkboxContainer",children:[we.jsxs("div",{className:"checkboxGroup",children:[we.jsx("div",{children:we.jsxs("label",{className:"optionLabel",htmlFor:"enableTabNavigation",id:"tabNavigationLabel",children:[we.jsx("input",{checked:!t,type:"checkbox",id:"enableTabNavigation",name:"enableTabNavigation","aria-label":"Enable navigation with the Tab key",onChange:()=>a("enableTabNavigation")}),"Enable navigation with the Tab key"]})}),we.jsx("div",{children:we.jsxs("label",{className:"optionLabel",htmlFor:"enableHeaderNavigation",id:"headerNavigationLabel",children:[we.jsx("input",{checked:e,type:"checkbox",id:"enableHeaderNavigation",name:"enableHeaderNavigation","aria-labelledby":"headerNavigationLabel",onChange:()=>a("enableHeaderNavigation")}),"Enable navigation across headers"]})}),we.jsx("div",{children:we.jsxs("label",{className:"optionLabel",htmlFor:"enableCellVirtualization",id:"cellVirtualizationLabel",children:[we.jsx("input",{checked:!n,type:"checkbox",id:"enableCellVirtualization",name:"enableCellVirtualization","aria-labelledby":"cellVirtualizationLabel",onChange:()=>a("enableCellVirtualization")}),"Enable cells virtualization"]})}),we.jsxs("div",{children:[we.jsxs("label",{className:"optionLabel",htmlFor:"enableCellEnterEditing",id:"cellEnterEditingLabel",children:[we.jsx("input",{checked:r,type:"checkbox",id:"enableCellEnterEditing",name:"enableCellEnterEditing","aria-labelledby":"cellEnterEditingLabel",onChange:()=>a("enableCellEnterEditing")}),"The Enter key begins cell editing"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#enterbeginsediting",target:"_blank",className:"externalLink",rel:"noopener noreferrer","aria-label":"Learn more about Enter key cell editing (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-external-link","aria-hidden":"true",children:[we.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),we.jsx("polyline",{points:"15 3 21 3 21 9"}),we.jsx("line",{x1:"10",x2:"21",y1:"14",y2:"3"})]})})]})]}),we.jsxs("div",{className:"checkboxGroup",children:[we.jsxs("div",{children:[we.jsxs("label",{className:"optionLabel",htmlFor:"enableArrowRLFirstLastColumn",id:"arrowRLFirstLastColumnLabel",children:[" ",we.jsx("input",{checked:o,type:"checkbox",id:"enableArrowRLFirstLastColumn",name:"enableArrowFirstLastColumn","aria-labelledby":"arrowRLFirstLastColumnLabel",onChange:()=>a("enableArrowRLFirstLastColumn")}),"The right/left arrow keys move the focus to the first/last column"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#autowrapcol",target:"_blank",className:"externalLink",rel:"noopener noreferrer","aria-label":"Learn more about right/left arrow key behavior (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-external-link","aria-hidden":"true",children:[we.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),we.jsx("polyline",{points:"15 3 21 3 21 9"}),we.jsx("line",{x1:"10",x2:"21",y1:"14",y2:"3"})]})})]}),we.jsxs("div",{children:[we.jsxs("label",{className:"optionLabel",htmlFor:"enableArrowTDFirstLastColumn",id:"arrowTDFirstLastColumnLabel",children:[we.jsx("input",{checked:i,type:"checkbox",id:"enableArrowTDFirstLastColumn",name:"enableArrowTDFirstLastColumn","aria-labelledby":"arrowTDFirstLastColumnLabel",onChange:()=>a("enableArrowTDFirstLastColumn")}),"The up/down arrow keys move the focus to the first/last row"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#autowraprow",target:"_blank",className:"externalLink",rel:"noopener noreferrer","aria-label":"Learn more about up/down arrow key behavior (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-external-link","aria-hidden":"true",children:[we.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),we.jsx("polyline",{points:"15 3 21 3 21 9"}),we.jsx("line",{x1:"10",x2:"21",y1:"14",y2:"3"})]})})]}),we.jsxs("div",{children:[we.jsxs("label",{className:"optionLabel",htmlFor:"enableEnterFocusEditing",id:"enterFocusEditingLabel",children:[we.jsx("input",{checked:s.row!==0,type:"checkbox",id:"enableEnterFocusEditing",name:"enableEnterFocusEditing","aria-labelledby":"enterFocusEditingLabel",onChange:()=>a("enableEnterFocusEditing")}),"The Enter key moves the focus after cell edition"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#entermoves",target:"_blank",className:"externalLink",rel:"noopener noreferrer","aria-label":"Learn more about Enter key focus behavior (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-external-link","aria-hidden":"true",children:[we.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),we.jsx("polyline",{points:"15 3 21 3 21 9"}),we.jsx("line",{x1:"10",x2:"21",y1:"14",y2:"3"})]})})]})]})]})})}const N_="selected",L_="odd",F_=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]),Aoe=(t,e,n,r,o,i)=>{if(n!==0)return;const s=t.parentElement;s!==null&&(i.instance.getDataAtRowProp(e,"0")?ae.dom.addClass(s,N_):ae.dom.removeClass(s,N_),e%2===0?ae.dom.addClass(s,L_):ae.dom.removeClass(s,L_))};function Hoe(t,e){if(t<0)return;const n=this.isRtl()?"htRight":"htLeft";e.firstChild&&(F_.has(t.toString())?(ae.dom.removeClass(e.firstChild,n),ae.dom.addClass(e.firstChild,F_.get(t.toString()))):ae.dom.addClass(e.firstChild,n))}const Poe=function(e,n){const r=e.target;n.col===-1&&e.target&&r.nodeName==="INPUT"&&(e.preventDefault(),this.setDataAtRowProp(n.row,"0",!r.checked))},koe={data:BN,height:464,colWidths:[140,165,100,100,100,90,90,110,178],colHeaders:["Company name","Product name","Sell date","In stock","Qty","Progress","Rating","Order ID","Country"],dropdownMenu:!0,hiddenColumns:{indicators:!0},multiColumnSorting:!0,filters:!0,rowHeaders:!0,manualRowMove:!0,nestedRows:!0,afterGetColHeader:Hoe,beforeRenderer:Aoe,afterOnCellMouseDown:Poe,licenseKey:"non-commercial-and-evaluation"};function Doe(){const[t,e]=ch.useState({disableTabNavigation:!1,navigableHeaders:!0,renderAllRows:!1,enterBeginsEditing:!0,autoWrapRow:!0,autoWrapCol:!0,enterMoves:{col:0,row:1}});return we.jsxs(we.Fragment,{children:[we.jsx(Ioe,{changeToggleOptions:e,...t}),we.jsx("input",{type:"text",placeholder:"Focusable text input"}),we.jsxs(rD,{...koe,...t,children:[we.jsx(_o,{data:"companyName",type:"text"}),we.jsx(_o,{data:"productName",type:"text"}),we.jsx(_o,{data:"sellDate",type:"date",allowInvalid:!1}),we.jsx(_o,{data:"inStock",type:"checkbox",className:"htCenter"}),we.jsx(_o,{data:"qty",type:"numeric"}),we.jsx(_o,{data:"progress",readOnly:!0,className:"htMiddle",children:we.jsx(noe,{"hot-renderer":!0})}),we.jsx(_o,{data:"rating",readOnly:!0,className:"htCenter",children:we.jsx(roe,{"hot-renderer":!0})}),we.jsx(_o,{data:"orderId",type:"text"}),we.jsx(_o,{data:"country",type:"dropdown",source:Ooe})]},String(t.renderAllRows)),we.jsx("input",{type:"text",placeholder:"Focusable text input"})]})}tv.createRoot(document.getElementById("root")).render(we.jsx(tn.StrictMode,{children:we.jsx(Doe,{})}))});export default Noe();
