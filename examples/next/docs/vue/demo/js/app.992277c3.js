(function(){var t={7180:function(t,e,o){"use strict";var n={};o.r(n),o.d(n,{arrayAvg:function(){return _},arrayEach:function(){return A},arrayFilter:function(){return k},arrayFlatten:function(){return L},arrayMap:function(){return I},arrayMax:function(){return P},arrayMin:function(){return N},arrayReduce:function(){return x},arraySum:function(){return O},arrayUnique:function(){return D},extendArray:function(){return M},getDifferenceOfArrays:function(){return W},getIntersectionOfArrays:function(){return V},getUnionOfArrays:function(){return F},pivot:function(){return H},stringToArray:function(){return j},to2dArray:function(){return T}});var i={};o.r(i),o.d(i,{_injectProductInfo:function(){return rt},isDefined:function(){return U},isEmpty:function(){return G},isRegExp:function(){return Y},isUndefined:function(){return $},stringify:function(){return z}});var r={};o.r(r),o.d(r,{equalsIgnoreCase:function(){return at},isPercentValue:function(){return ct},randomString:function(){return ht},sanitize:function(){return gt},stripTags:function(){return dt},substitute:function(){return ut},toUpperCaseFirst:function(){return lt}});var s={};o.r(s),o.d(s,{HTML_CHARACTERS:function(){return ve},addClass:function(){return de},addEvent:function(){return Le},clearTextSelection:function(){return je},closest:function(){return ie},closestDown:function(){return re},empty:function(){return we},fastInnerHTML:function(){return Ce},fastInnerText:function(){return ye},getCaretPosition:function(){return We},getComputedStyle:function(){return Ae},getCssTransform:function(){return Xe},getFrameElement:function(){return ee},getParent:function(){return Zt},getParentWindow:function(){return oe},getScrollLeft:function(){return Me},getScrollTop:function(){return Te},getScrollableElement:function(){return He},getScrollbarWidth:function(){return $e},getSelectionEndPosition:function(){return Ve},getSelectionText:function(){return Fe},getStyle:function(){return ke},getTrimmingContainer:function(){return xe},getWindowScrollLeft:function(){return Ee},getWindowScrollTop:function(){return Re},hasAccessToParentWindow:function(){return ne},hasClass:function(){return ue},hasHorizontalScrollbar:function(){return Ye},hasVerticalScrollbar:function(){return Ge},index:function(){return le},innerHeight:function(){return Ne},innerWidth:function(){return _e},isChildOf:function(){return se},isDetached:function(){return to},isInput:function(){return Qe},isOutsideInput:function(){return Je},isThisHotChild:function(){return te},isVisible:function(){return be},makeElementContentEditableAndSelectItsContent:function(){return oo},matchesCSSRules:function(){return Ie},observeVisibilityChangeOnce:function(){return eo},offset:function(){return Se},outerHeight:function(){return Pe},outerWidth:function(){return Oe},overlayContainsElement:function(){return ae},removeAttribute:function(){return me},removeClass:function(){return ge},removeContentEditableFromElementAndDeselect:function(){return no},removeEvent:function(){return De},removeTextNodes:function(){return pe},resetCssTransform:function(){return qe},runWithSelectedContendEditableElement:function(){return io},selectElementIfAllowed:function(){return Ze},setAttribute:function(){return fe},setCaretPosition:function(){return Be},setOverlayPosition:function(){return Ke}});var l={};o.r(l),o.d(l,{curry:function(){return uo},curryRight:function(){return go},debounce:function(){return ao},fastCall:function(){return fo},isFunction:function(){return ro},partial:function(){return co},pipe:function(){return ho},throttle:function(){return so},throttleAfterHits:function(){return lo}});var a={};o.r(a),o.d(a,{clone:function(){return yo},createObjectPropListener:function(){return ko},deepClone:function(){return Co},deepExtend:function(){return vo},deepObjectSize:function(){return xo},defineGetter:function(){return Eo},duckSchema:function(){return mo},extend:function(){return wo},getProperty:function(){return Mo},hasOwnProperty:function(){return Io},inherit:function(){return po},isObject:function(){return Ro},isObjectEqual:function(){return So},mixin:function(){return bo},objectEach:function(){return To},setProperty:function(){return Ho}});var h={};o.r(h),o.d(h,{cancelAnimationFrame:function(){return Oo},getComparisonFunction:function(){return Lo},isCSR:function(){return No},isTouchSupported:function(){return Po},requestAnimationFrame:function(){return Ao}});var c={};o.r(c),o.d(c,{isChrome:function(){return Bo},isChromeWebKit:function(){return zo},isEdge:function(){return Yo},isEdgeWebKit:function(){return Ko},isFirefox:function(){return Uo},isFirefoxWebKit:function(){return $o},isIOS:function(){return qo},isIpadOS:function(){return Qo},isLinuxOS:function(){return tn},isMacOS:function(){return Zo},isMobileBrowser:function(){return Xo},isSafari:function(){return Go},isWindowsOS:function(){return Jo},setBrowserMeta:function(){return Fo},setPlatformMeta:function(){return jo}});var u={};o.r(u),o.d(u,{KEY_CODES:function(){return en},isCtrlKey:function(){return sn},isCtrlMetaKey:function(){return ln},isFunctionKey:function(){return rn},isKey:function(){return an},isPrintableChar:function(){return nn}});var d={};o.r(d),o.d(d,{isImmediatePropagationStopped:function(){return cn},isLeftClick:function(){return dn},isRightClick:function(){return un},offsetRelativeTo:function(){return gn},stopImmediatePropagation:function(){return hn}});var g={};o.r(g),o.d(g,{_dataToHTML:function(){return _i},htmlToGridSettings:function(){return Li},instanceToHTML:function(){return Ni}});var f={};o.r(f),o.d(f,{clamp:function(){return Bi},isNumeric:function(){return Di},isNumericLike:function(){return Wi},rangeEach:function(){return Vi},rangeEachReverse:function(){return Fi},valueAccordingPercent:function(){return ji}});var m={};o.r(m),o.d(m,{countFirstRowKeys:function(){return Cu},createEmptySpreadsheetData:function(){return wu},createSpreadsheetData:function(){return mu},createSpreadsheetObjectData:function(){return pu},dataRowToChangesArray:function(){return vu},isArrayOfArrays:function(){return yu},isArrayOfObjects:function(){return bu},spreadsheetColumnIndex:function(){return fu},spreadsheetColumnLabel:function(){return gu}});var p={};o.r(p),o.d(p,{CHECKBOX_CHECKED:function(){return pf},CHECKBOX_RENDERER_NAMESPACE:function(){return mf},CHECKBOX_UNCHECKED:function(){return wf},CONTEXTMENU_ITEMS_ADD_COMMENT:function(){return hg},CONTEXTMENU_ITEMS_ALIGNMENT:function(){return gg},CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:function(){return yg},CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:function(){return mg},CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:function(){return wg},CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:function(){return fg},CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:function(){return Cg},CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:function(){return pg},CONTEXTMENU_ITEMS_ALIGNMENT_TOP:function(){return vg},CONTEXTMENU_ITEMS_BORDERS:function(){return bg},CONTEXTMENU_ITEMS_BORDERS_BOTTOM:function(){return Eg},CONTEXTMENU_ITEMS_BORDERS_LEFT:function(){return Tg},CONTEXTMENU_ITEMS_BORDERS_RIGHT:function(){return Rg},CONTEXTMENU_ITEMS_BORDERS_TOP:function(){return Sg},CONTEXTMENU_ITEMS_CLEAR_COLUMN:function(){return Zd},CONTEXTMENU_ITEMS_COPY:function(){return tg},CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:function(){return ng},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:function(){return og},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:function(){return eg},CONTEXTMENU_ITEMS_CUT:function(){return ig},CONTEXTMENU_ITEMS_EDIT_COMMENT:function(){return cg},CONTEXTMENU_ITEMS_FREEZE_COLUMN:function(){return rg},CONTEXTMENU_ITEMS_HIDE_COLUMN:function(){return kg},CONTEXTMENU_ITEMS_HIDE_ROW:function(){return Ag},CONTEXTMENU_ITEMS_INSERT_LEFT:function(){return Gd},CONTEXTMENU_ITEMS_INSERT_RIGHT:function(){return Yd},CONTEXTMENU_ITEMS_MERGE_CELLS:function(){return lg},CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:function(){return xg},CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:function(){return Hg},CONTEXTMENU_ITEMS_NO_ITEMS:function(){return zd},CONTEXTMENU_ITEMS_READ_ONLY:function(){return Jd},CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:function(){return dg},CONTEXTMENU_ITEMS_REDO:function(){return Qd},CONTEXTMENU_ITEMS_REMOVE_BORDERS:function(){return Mg},CONTEXTMENU_ITEMS_REMOVE_COLUMN:function(){return Xd},CONTEXTMENU_ITEMS_REMOVE_COMMENT:function(){return ug},CONTEXTMENU_ITEMS_REMOVE_ROW:function(){return Kd},CONTEXTMENU_ITEMS_ROW_ABOVE:function(){return Ud},CONTEXTMENU_ITEMS_ROW_BELOW:function(){return $d},CONTEXTMENU_ITEMS_SHOW_COLUMN:function(){return Ig},CONTEXTMENU_ITEMS_SHOW_ROW:function(){return Og},CONTEXTMENU_ITEMS_UNDO:function(){return qd},CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:function(){return sg},CONTEXTMENU_ITEMS_UNMERGE_CELLS:function(){return ag},CONTEXT_MENU_ITEMS_NAMESPACE:function(){return jd},FILTERS_BUTTONS_CANCEL:function(){return uf},FILTERS_BUTTONS_CLEAR:function(){return hf},FILTERS_BUTTONS_OK:function(){return cf},FILTERS_BUTTONS_PLACEHOLDER_SEARCH:function(){return df},FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:function(){return ff},FILTERS_BUTTONS_PLACEHOLDER_VALUE:function(){return gf},FILTERS_BUTTONS_SELECT_ALL:function(){return af},FILTERS_CONDITIONS_AFTER:function(){return Qg},FILTERS_CONDITIONS_BEFORE:function(){return Jg},FILTERS_CONDITIONS_BEGINS_WITH:function(){return Fg},FILTERS_CONDITIONS_BETWEEN:function(){return Xg},FILTERS_CONDITIONS_BY_VALUE:function(){return Ug},FILTERS_CONDITIONS_CONTAINS:function(){return Bg},FILTERS_CONDITIONS_EMPTY:function(){return Lg},FILTERS_CONDITIONS_ENDS_WITH:function(){return jg},FILTERS_CONDITIONS_EQUAL:function(){return Wg},FILTERS_CONDITIONS_GREATER_THAN:function(){return $g},FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:function(){return Gg},FILTERS_CONDITIONS_LESS_THAN:function(){return Yg},FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:function(){return Kg},FILTERS_CONDITIONS_NAMESPACE:function(){return Ng},FILTERS_CONDITIONS_NONE:function(){return _g},FILTERS_CONDITIONS_NOT_BETWEEN:function(){return qg},FILTERS_CONDITIONS_NOT_CONTAIN:function(){return zg},FILTERS_CONDITIONS_NOT_EMPTY:function(){return Dg},FILTERS_CONDITIONS_NOT_EQUAL:function(){return Vg},FILTERS_CONDITIONS_TODAY:function(){return Zg},FILTERS_CONDITIONS_TOMORROW:function(){return tf},FILTERS_CONDITIONS_YESTERDAY:function(){return ef},FILTERS_DIVS_FILTER_BY_CONDITION:function(){return of},FILTERS_DIVS_FILTER_BY_VALUE:function(){return nf},FILTERS_LABELS_CONJUNCTION:function(){return rf},FILTERS_LABELS_DISJUNCTION:function(){return sf},FILTERS_NAMESPACE:function(){return Pg},FILTERS_VALUES_BLANK_CELLS:function(){return lf}});var w={};o.r(w),o.d(w,{getNormalizedDate:function(){return Wb}});var v=o(6427),C=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("DataGrid")],1)},y=[],b=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"example"}},[e("hot-table",{ref:"hotTableComponent",attrs:{data:t.data,settings:t.hotSettings}})],1)},S=[],R=(o(4031),o(3407),o(8339),o(9757)),E=o(8289);function T(t){const e=t.length;let o=0;while(o<e)t[o]=[t[o]],o+=1}function M(t,e){const o=e.length;let n=0;while(n<o)t.push(e[n]),n+=1}function H(t){const e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;const o=t.length,n=t[0].length;for(let i=0;i<o;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function x(t,e,o,n){let i=-1,r=t,s=o;Array.isArray(t)||(r=Array.from(t));const l=r.length;n&&l&&(i+=1,s=r[i]),i+=1;while(i<l)s=e(s,r[i],i,r),i+=1;return s}function k(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,r=[];let s=-1;while(o<i){const t=n[o];e(t,o,n)&&(s+=1,r[s]=t),o+=1}return r}function I(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,r=[];let s=-1;while(o<i){const t=n[o];s+=1,r[s]=e(t,o,n),o+=1}return r}function A(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;while(o<i){if(!1===e(n[o],o,n))break;o+=1}return t}function O(t){return x(t,((t,e)=>t+e),0)}function P(t){return x(t,((t,e)=>t>e?t:e),Array.isArray(t)?t[0]:void 0)}function N(t){return x(t,((t,e)=>t<e?t:e),Array.isArray(t)?t[0]:void 0)}function _(t){return t.length?O(t)/t.length:0}function L(t){return x(t,((t,e)=>t.concat(Array.isArray(e)?L(e):e)),[])}function D(t){const e=[];return A(t,(t=>{-1===e.indexOf(t)&&e.push(t)})),e}function W(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...i]=[...e];let r=n;return A(i,(t=>{r=r.filter((e=>!t.includes(e)))})),r}function V(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...i]=[...e];let r=n;return A(i,(t=>{r=r.filter((e=>t.includes(e)))})),r}function F(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...i]=[...e],r=new Set(n);return A(i,(t=>{A(t,(t=>{r.has(t)||r.add(t)}))})),Array.from(r)}function j(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}function B(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];const i=x(t,((t,e,n)=>{const i=e.replace(/\r?\n\s*/g,""),r=o[n]?o[n]:"";return t+i+r}),"");return i.trim()}function z(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function U(t){return"undefined"!==typeof t}function $(t){return"undefined"===typeof t}function G(t){return null===t||""===t||$(t)}function Y(t){return"[object RegExp]"===Object.prototype.toString.call(t)}const K="length",X=t=>parseInt(t,16),q=t=>parseInt(t,10),Q=(t,e,o)=>t["substr"](e,o),J=t=>t["codePointAt"](0)-65,Z=t=>`${t}`.replace(/\-/g,""),tt=t=>X(Q(Z(t),X("12"),J("F")))/(X(Q(Z(t),J("B"),~~![][K]))||9),et=()=>"undefined"!==typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let ot=!1;const nt={invalid:()=>B`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:o}=t;return B`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${o}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>B`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},it={invalid:()=>B`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:o}=t;return B`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${o}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>B`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function rt(t,e){const o=!G(t),n="string"===typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),i="14.0.0";let r,s="invalid",l="invalid";t=Z(t||"");const a=st(t);if(o||n||a)if(a){const e=E("30/11/2023","DD/MM/YYYY"),o=Math.floor(e.toDate().getTime()/864e5),n=tt(t);r=E(864e5*(n+1),"x").format("MMMM DD, YYYY"),o>n?(s="expired",l="expired"):(s="valid",l="valid")}else n?(s="non_commercial",l="valid"):(s="invalid",l="invalid");else s="missing",l="missing";if(et()&&(s="valid",l="valid"),!ot&&"valid"!==s){const t=nt[s]({keyValidityDate:r,hotVersion:i});t&&console["non_commercial"===s?"info":"warn"](nt[s]({keyValidityDate:r,hotVersion:i})),ot=!0}if("valid"!==l&&e.parentNode){const t=it[l]({keyValidityDate:r,hotVersion:i});if(t){const t=document.createElement("div");t.className="hot-display-license-info",t.innerHTML=it[l]({keyValidityDate:r,hotVersion:i}),e.parentNode.insertBefore(t,e.nextSibling)}}}function st(t){let e=[][K],o=e;if(t[K]!==J("Z"))return!1;for(let n="",i="B<H4P+".split(""),r=J(i.shift());r;r=J(i.shift()||"A"))--r<""[K]?o|=(q(`${q(X(n)+(X(Q(t,Math.abs(r),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=Q(t,r,r?1===i[K]?9:8:6);return o===e}function lt(t){return t[0].toUpperCase()+t.substr(1)}function at(){const t=[];for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];let i=o.length;while(i){i-=1;const e=z(o[i]).toLowerCase();-1===t.indexOf(e)&&t.push(e)}return 1===t.length}function ht(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function ct(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function ut(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,((t,o)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[o]?"":e[o]))}function dt(t){return gt(`${t}`,{ALLOWED_TAGS:[]})}function gt(t,e){return R.sanitize(t,e)}const ft=t=>["tabindex",t],mt=()=>["role","treegrid"],pt=()=>["role","presentation"],wt=()=>["role","gridcell"],vt=()=>["role","rowheader"],Ct=()=>["role","rowgroup"],yt=()=>["role","columnheader"],bt=()=>["role","row"],St=()=>["role","menu"],Rt=()=>["role","menuitem"],Et=()=>["role","combobox"],Tt=()=>["role","listbox"],Mt=()=>["role","option"],Ht=()=>["role","checkbox"],xt=()=>["scope","col"],kt=()=>["scope","row"],It=()=>["type","text"],At=t=>["aria-label",t],Ot=()=>["aria-hidden","true"],Pt=()=>["aria-disabled","true"],Nt=()=>["aria-multiselectable","true"],_t=t=>["aria-haspopup",t],Lt=t=>["aria-rowcount",t],Dt=t=>["aria-colcount",t],Wt=t=>["aria-rowindex",t],Vt=t=>["aria-colindex",t],Ft=t=>["aria-expanded",t],jt=t=>["aria-sort",t],Bt=()=>["aria-readonly","true"],zt=()=>["aria-invalid","true"],Ut=t=>["aria-checked",t],$t=()=>["aria-selected","true"],Gt=()=>["aria-autocomplete","list"],Yt=t=>["aria-controls",t],Kt=t=>["aria-activedescendant",t],Xt=t=>["aria-live",t],qt=t=>["aria-relevant",t],Qt=t=>["aria-setsize",t],Jt=t=>["aria-posinset",t];function Zt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=-1,n=null,i=t;while(null!==i){if(o===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(o+=1,i=i.parentNode)}return n}function te(t,e){const o=t.closest(".handsontable");return!!o&&(o.parentNode===e||o===e)}function ee(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function oe(t){return ee(t)&&t.parent}function ne(t){return!!Object.getPrototypeOf(t.parent)}function ie(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let r=t;while(null!==r&&void 0!==r&&r!==o){const{nodeType:t,nodeName:o}=r;if(t===n&&(e.includes(o)||e.includes(r)))return r;const{host:s}=r;r=s&&t===i?s:r.parentNode}return null}function re(t,e,o){const n=[];let i=t;while(i){if(i=ie(i,e,o),!i||o&&!o.contains(i))break;n.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode}const r=n.length;return r?n[r-1]:null}function se(t,e){let o=t.parentNode,n=[];"string"===typeof e?n=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);while(null!==o){if(n.indexOf(o)>-1)return!0;o=o.parentNode}return!1}function le(t){let e=0,o=t;if(o.previousSibling)while(o=o.previousSibling)e+=1;return e}function ae(t,e,o){const n=o.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function he(t){return t&&t.length?t.filter((t=>!!t)):[]}function ce(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const o=[],n=[];return n.push(...t.filter((t=>{const n=t instanceof RegExp;return n&&e&&o.push(t),!n}))),e?{regexFree:n,regexes:o}:n}function ue(t,e){return void 0!==t.classList&&"string"===typeof e&&""!==e&&t.classList.contains(e)}function de(t,e){"string"===typeof e&&(e=e.split(" ")),e=he(e),e.length>0&&t.classList.add(...e)}function ge(t,e){"string"===typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:o,regexes:n}=ce(e,!0);o=he(o),o.length>0&&t.classList.remove(...o),n.forEach((e=>{t.classList.forEach((o=>{e.test(o)&&t.classList.remove(o)}))}))}function fe(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,o]]),e.forEach((e=>{Array.isArray(e)&&""!==e[0]&&t.setAttribute(...e)}))}function me(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"===typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:o,regexes:n}=ce(e,!0);o.forEach((e=>{""!==e&&t.removeAttribute(e)})),n.forEach((e=>{t.getAttributeNames().forEach((o=>{e.test(o)&&t.removeAttribute(o)}))}))}function pe(t){if(3===t.nodeType)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let t=e.length-1;t>=0;t--)pe(e[t])}}function we(t){let e;while(e=t.lastChild)t.removeChild(e)}const ve=/(<(.*)>|&(.*);)/;function Ce(t,e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];ve.test(e)?t.innerHTML=o?gt(e):e:ye(t,e)}function ye(t,e){const o=t.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=e:(we(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function be(t){const e=t.ownerDocument.documentElement;let o=t;while(o!==e){if(null===o)return!1;if(o.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(o.host){if(o.host.impl)return be(o.host.impl);if(o.host)return be(o.host);throw new Error("Lost in Web Components world")}return!1}if("none"===Ae(o).display)return!1;o=o.parentNode}return!0}function Se(t){const e=t.ownerDocument,o=e.defaultView,n=e.documentElement;let i,r,s,l=t;i=l.offsetLeft,r=l.offsetTop,s=l;while(l=l.offsetParent){if(l===e.body)break;if(!("offsetLeft"in l))break;i+=l.offsetLeft,r+=l.offsetTop,s=l}return s&&"fixed"===s.style.position&&(i+=o.pageXOffset||n.scrollLeft,r+=o.pageYOffset||n.scrollTop),{left:i,top:r}}function Re(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollY}function Ee(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollX}function Te(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?Re(e):t.scrollTop}function Me(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?Ee(e):t.scrollLeft}function He(t){let e=t.ownerDocument,o=e?e.defaultView:void 0;e||(e=t.document?t.document:t,o=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;while(i&&i.style&&e.body!==i){let{overflow:t,overflowX:e,overflowY:r}=i.style;if([t,e,r].includes("scroll"))return i;if(({overflow:t,overflowX:e,overflowY:r}=o.getComputedStyle(i)),n.includes(t)||n.includes(e)||n.includes(r))return i;if(i.clientHeight<=i.scrollHeight+1&&(n.includes(r)||n.includes(t)))return i;if(i.clientWidth<=i.scrollWidth+1&&(n.includes(e)||n.includes(t)))return i;i=i.parentNode}return o}function xe(t){const e=t.ownerDocument,o=e.defaultView;let n=t.parentNode;while(n&&n.style&&e.body!==n){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;const t=Ae(n,o),e=["scroll","hidden","auto"],i=t.getPropertyValue("overflow"),r=t.getPropertyValue("overflow-y"),s=t.getPropertyValue("overflow-x");if(e.includes(i)||e.includes(r)||e.includes(s))return n;n=n.parentNode}return o}function ke(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!t)return;if(t===o)return"width"===e?`${o.innerWidth}px`:"height"===e?`${o.innerHeight}px`:void 0;const n=t.style[e];if(""!==n&&void 0!==n)return n;const i=Ae(t,o);return""!==i[e]&&void 0!==i[e]?i[e]:void 0}function Ie(t,e){const{selectorText:o}=e;let n=!1;return e.type===CSSRule.STYLE_RULE&&o&&(t.msMatchesSelector?n=t.msMatchesSelector(o):t.matches&&(n=t.matches(o))),n}function Ae(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function Oe(t){return t.offsetWidth}function Pe(t){return t.offsetHeight}function Ne(t){return t.clientHeight||t.innerHeight}function _e(t){return t.clientWidth||t.innerWidth}function Le(t,e,o){t.addEventListener(e,o,!1)}function De(t,e,o){t.removeEventListener(e,o,!1)}function We(t){return t.selectionStart?t.selectionStart:0}function Ve(t){return t.selectionEnd?t.selectionEnd:0}function Fe(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;const e=t.document;let o="";return t.getSelection?o=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(o=e.selection.createRange().text),o}function je(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Be(t,e,o){if(void 0===o&&(o=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,o)}catch(n){const i=t.parentNode,r=i.style.display;i.style.display="block",t.setSelectionRange(e,o),i.style.display=r}}}let ze;function Ue(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const o=t.createElement("div");o.style.boxSizing="content-box",o.style.height="150px",o.style.left="0px",o.style.overflow="hidden",o.style.position="absolute",o.style.top="0px",o.style.width="200px",o.style.visibility="hidden",o.appendChild(e),(t.body||t.documentElement).appendChild(o);const n=e.offsetWidth;o.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=o.clientWidth),(t.body||t.documentElement).removeChild(o),n-i}function $e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===ze&&(ze=Ue(t)),ze}function Ge(t){return t.offsetWidth!==t.clientWidth}function Ye(t){return t.offsetHeight!==t.clientHeight}function Ke(t,e,o){t.style.transform=`translate3d(${e},${o},0)`}function Xe(t){let e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:-1}function qe(t){t.style.transform&&""!==t.style.transform&&(t.style.transform="")}function Qe(t){const e=["INPUT","SELECT","TEXTAREA"];return t&&(e.indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function Je(t){return Qe(t)&&!1===t.hasAttribute("data-hot-input")}function Ze(t){const e=t.ownerDocument.activeElement;Je(e)||t.select()}function to(t){return!t.parentNode}function eo(t,e){const o=new IntersectionObserver(((o,n)=>{o.forEach((o=>{o.isIntersecting&&null!==t.offsetParent&&(e(),n.unobserve(t))}))}),{root:t.ownerDocument.body});o.observe(t)}function oo(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=t.ownerDocument,i=n.createRange(),r=n.defaultView.getSelection();fe(t,"contenteditable",!0),o&&fe(t,...Ot()),e&&de(t,"invisibleSelection"),i.selectNodeContents(t),r.removeAllRanges(),r.addRange(i)}function no(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),o.removeAllRanges(),e&&ge(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function io(t,e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];oo(t,o),e(),no(t,o)}function ro(t){return"function"===typeof t}function so(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=0;const n={lastCallThrottled:!0};let i=null;function r(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];const a=Date.now();let h=!1;n.lastCallThrottled=!0,o||(o=a,h=!0);const c=e-(a-o);return h?(n.lastCallThrottled=!1,t.apply(this,s)):(i&&clearTimeout(i),i=setTimeout((()=>{n.lastCallThrottled=!1,t.apply(this,s),o=0,i=void 0}),c)),n}return r}function lo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;const n=so(t,e);let i=o;function r(){i=o}function s(){for(var e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];return i?(i-=1,t.apply(this,o)):n.apply(this,o)}return s.clearHits=r,s}function ao(t){let e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=null;function i(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n&&clearTimeout(n),n=setTimeout((()=>{e=t.apply(this,r)}),o),e}return i}function ho(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...i]=e;return function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return x(i,((t,e)=>e(t)),n.apply(this,e))}}function co(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(this,o.concat(n))}}function uo(t){const e=t.length;function o(n){return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const l=n.concat(r);let a;return a=l.length>=e?t.apply(this,l):o(l),a}}return o([])}function go(t){const e=t.length;function o(n){return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const l=n.concat(r.reverse());let a;return a=l.length>=e?t.apply(this,l):o(l),a}}return o([])}function fo(t,e,o,n,i,r,s,l){return U(l)?t.call(e,o,n,i,r,s,l):U(s)?t.call(e,o,n,i,r,s):U(r)?t.call(e,o,n,i,r):U(i)?t.call(e,o,n,i):U(n)?t.call(e,o,n):U(o)?t.call(e,o):t.call(e)}o(442);function mo(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},To(t,((t,o)=>{"__children"!==o&&(t&&"object"===typeof t&&!Array.isArray(t)?e[o]=mo(t):Array.isArray(t)?t.length&&"object"===typeof t[0]&&!Array.isArray(t[0])?e[o]=[mo(t[0])]:e[o]=[]:e[o]=null)}))),e}function po(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function wo(t,e,o){const n=Array.isArray(o);return To(e,((e,i)=>{(!1===n||o.includes(i))&&(t[i]=e)})),t}function vo(t,e){To(e,((o,n)=>{e[n]&&"object"===typeof e[n]?(t[n]||(Array.isArray(e[n])?t[n]=[]:"[object Date]"===Object.prototype.toString.call(e[n])?t[n]=e[n]:t[n]={}),vo(t[n],e[n])):t[n]=e[n]}))}function Co(t){return"object"===typeof t?JSON.parse(JSON.stringify(t)):t}function yo(t){const e={};return To(t,((t,o)=>{e[o]=t})),e}function bo(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];return A(o,(e=>{t.MIXINS.push(e.MIXIN_NAME),To(e,((e,o)=>{if(void 0!==t.prototype[o])throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if("function"===typeof e)t.prototype[o]=e;else{const n=function(t,e){const o=`_${t}`,n=t=>{let e=t;return(Array.isArray(e)||Ro(e))&&(e=Co(e)),e};return function(){return void 0===this[o]&&(this[o]=n(e)),this[o]}},i=function(t){const e=`_${t}`;return function(t){this[e]=t}};Object.defineProperty(t.prototype,o,{get:n(o,e),set:i(o),configurable:!0})}}))})),t}function So(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ro(t){return"[object Object]"===Object.prototype.toString.call(t)}function Eo(t,e,o,n){n.value=o,n.writable=!1!==n.writable,n.enumerable=!1!==n.enumerable,n.configurable=!1!==n.configurable,Object.defineProperty(t,e,n)}function To(t,e){for(const o in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,o))&&!1===e(t[o],o,t))break;return t}function Mo(t,e){const o=e.split(".");let n=t;return To(o,(t=>{if(n=n[t],void 0===n)return n=void 0,!1})),n}function Ho(t,e,o){const n=e.split(".");let i=t;n.forEach(((t,e)=>{e!==n.length-1?(Io(i,t)||(i[t]={}),i=i[t]):i[t]=o}))}function xo(t){if(!Ro(t))return 0;const e=function(t){let o=0;return Ro(t)?To(t,((t,n)=>{"__children"!==n&&(o+=e(t))})):o+=1,o};return e(t)}function ko(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const o=`_${e}`,n={_touched:!1,[o]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[o]},set(t){this._touched=!0,this[o]=t},enumerable:!0,configurable:!0}),n}function Io(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ao(t){return window.requestAnimationFrame(t)}function Oo(t){window.cancelAnimationFrame(t)}function Po(){return"ontouchstart"in window}function No(){return"undefined"!==typeof window}let _o;function Lo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _o||(_o="object"===typeof Intl?new Intl.Collator(t,e).compare:"function"===typeof String.prototype.localeCompare?(t,e)=>`${t}`.localeCompare(e):(t,e)=>t===e?0:t>e?-1:1,_o)}const Do=t=>{const e={value:!1,test:(o,n)=>{e.value=t(o,n)}};return e},Wo={chrome:Do(((t,e)=>/Chrome/.test(t)&&/Google/.test(e))),chromeWebKit:Do((t=>/CriOS/.test(t))),edge:Do((t=>/Edge/.test(t))),edgeWebKit:Do((t=>/EdgiOS/.test(t))),firefox:Do((t=>/Firefox/.test(t))),firefoxWebKit:Do((t=>/FxiOS/.test(t))),mobile:Do((t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t))),safari:Do(((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e)))},Vo={mac:Do((t=>/^Mac/.test(t))),win:Do((t=>/^Win/.test(t))),linux:Do((t=>/^Linux/.test(t))),ios:Do((t=>/iPhone|iPad|iPod/i.test(t)))};function Fo(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};To(Wo,(o=>{let{test:n}=o;n(t,e)}))}function jo(){let{platform:t=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};To(Vo,(e=>{let{test:o}=e;o(t)}))}function Bo(){return Wo.chrome.value}function zo(){return Wo.chromeWebKit.value}function Uo(){return Wo.firefox.value}function $o(){return Wo.firefoxWebKit.value}function Go(){return Wo.safari.value}function Yo(){return Wo.edge.value}function Ko(){return Wo.edgeWebKit.value}function Xo(){return Wo.mobile.value}function qo(){return Vo.ios.value}function Qo(){let{maxTouchPoints:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t>2&&Vo.mac.value}function Jo(){return Vo.win.value}function Zo(){return Vo.mac.value}function tn(){return Vo.linux.value}No()&&(Fo(),jo());const en={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Uo()?182:174,AUDIO_MUTE:Uo()?181:173,AUDIO_UP:Uo()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},on=[en.ALT,en.ARROW_DOWN,en.ARROW_LEFT,en.ARROW_RIGHT,en.ARROW_UP,en.AUDIO_DOWN,en.AUDIO_MUTE,en.AUDIO_UP,en.BACKSPACE,en.CAPS_LOCK,en.DELETE,en.END,en.ENTER,en.ESCAPE,en.F1,en.F2,en.F3,en.F4,en.F5,en.F6,en.F7,en.F8,en.F9,en.F10,en.F11,en.F12,en.F13,en.F14,en.F15,en.F16,en.F17,en.F18,en.F19,en.HOME,en.INSERT,en.MEDIA_NEXT,en.MEDIA_PLAY_PAUSE,en.MEDIA_PREV,en.MEDIA_STOP,en.NULL,en.NUM_LOCK,en.PAGE_DOWN,en.PAGE_UP,en.PAUSE,en.SCROLL_LOCK,en.SHIFT,en.TAB];function nn(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function rn(t){return on.includes(t)}function sn(t){const e=[];return Zo()?e.push(en.COMMAND_LEFT,en.COMMAND_RIGHT,en.COMMAND_FIREFOX):e.push(en.CONTROL),e.includes(t)}function ln(t){return[en.CONTROL,en.COMMAND_LEFT,en.COMMAND_RIGHT,en.COMMAND_FIREFOX].includes(t)}function an(t,e){const o=e.split("|");let n=!1;return A(o,(e=>{if(t===en[e])return n=!0,!1})),n}function hn(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function cn(t){return!1===t.isImmediatePropagationEnabled}function un(t){return 2===t.button}function dn(t){return 0===t.button}function gn(t,e){const o={x:t.offsetX,y:t.offsetY};let n=t.target;if(!(e instanceof HTMLElement)||n!==e&&n.contains(e))return o;while(n!==e)o.x+=n.offsetLeft,o.y+=n.offsetTop,n=n.offsetParent;return o}function fn(){U(console)&&console.warn(...arguments)}function mn(){U(console)&&console.error(...arguments)}function pn(t,e,o){return e=wn(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function wn(t){var e=vn(t,"string");return"symbol"==typeof e?e:String(e)}function vn(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Cn=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],yn=B`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,bn=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Sn=new Map([[]]);class Rn{static getSingleton(){return Tn()}constructor(){pn(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const t=Object.create(null);return A(Cn,(e=>t[e]=[])),t}getBucket(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}add(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))A(e,(e=>this.add(t,e,o)));else{bn.has(t)&&fn(ut(yn,{hookName:t,removedInVersion:bn.get(t)})),Sn.has(t)&&fn(Sn.get(t));const n=this.getBucket(o);if("undefined"===typeof n[t]&&(this.register(t),n[t]=[]),e.skip=!1,-1===n[t].indexOf(e)){let o=!1;e.initialHook&&A(n[t],((i,r)=>{if(i.initialHook)return n[t][r]=e,o=!0,!1})),o||n[t].push(e)}}return this}once(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?A(e,(e=>this.once(t,e,o))):(e.runOnce=!0,this.add(t,e,o))}remove(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=this.getBucket(o);return"undefined"!==typeof n[t]&&n[t].indexOf(e)>=0&&(e.skip=!0,!0)}has(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const o=this.getBucket(e);return!(void 0===o[t]||!o[t].length)}run(t,e,o,n,i,r,s,l){{const a=this.globalBucket[e],h=a?a.length:0;let c=0;if(h)while(c<h){if(!a[c]||a[c].skip){c+=1;continue}const h=fo(a[c],t,o,n,i,r,s,l);void 0!==h&&(o=h),a[c]&&a[c].runOnce&&this.remove(e,a[c]),c+=1}}{const a=this.getBucket(t)[e],h=a?a.length:0;let c=0;if(h)while(c<h){if(!a[c]||a[c].skip){c+=1;continue}const h=fo(a[c],t,o,n,i,r,s,l);void 0!==h&&(o=h),a[c]&&a[c].runOnce&&this.remove(e,a[c],t),c+=1}}return o}destroy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;To(this.getBucket(t),((t,e,o)=>o[e].length=0))}register(t){this.isRegistered(t)||Cn.push(t)}deregister(t){this.isRegistered(t)&&Cn.splice(Cn.indexOf(t),1)}isDeprecated(t){return Sn.has(t)||bn.has(t)}isRegistered(t){return Cn.indexOf(t)>=0}getRegistered(){return Cn}}const En=new Rn;function Tn(){return En}var Mn=Rn;const Hn=new Map;function xn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";Hn.has(t)||Hn.set(t,new Map);const e=Hn.get(t);function o(t,o){e.set(t,o)}function n(t){return e.get(t)}function i(t){return e.has(t)}function r(){return[...e.keys()]}function s(){return[...e.values()]}return{register:o,getItem:n,hasItem:i,getNames:r,getValues:s}}const kn=new WeakMap,{register:In,getItem:An,hasItem:On,getNames:Pn,getValues:Nn}=xn("editors");function _n(t){const e={},o=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new o(t)),e[t.guid]},Mn.getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function Ln(t,e){let o;if("function"===typeof t)kn.get(t)||Wn(null,t),o=kn.get(t);else{if("string"!==typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');o=An(t)}if(!o)throw Error(`No editor registered under name "${t}"`);return o.getInstance(e)}function Dn(t){if("function"===typeof t)return t;if(!On(t))throw Error(`No registered editor found under "${t}" name`);return An(t).getConstructor()}function Wn(t,e){t&&"string"!==typeof t&&(e=t,t=e.EDITOR_TYPE);const o=new _n(e);"string"===typeof t&&In(t,o),kn.set(e,o)}function Vn(t,e,o){return e=Fn(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Fn(t){var e=jn(t,"string");return"symbol"==typeof e?e:String(e)}function jn(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}let Bn=0;class zn{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Vn(this,"context",void 0),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(t){o.call(this,Un(t))}return this.context.eventListeners.push({element:t,event:e,callback:o,callbackProxy:i,options:n,eventManager:this}),t.addEventListener(e,i,n),Bn+=1,()=>{this.removeEventListener(t,e,o)}}removeEventListener(t,e,o){let n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.context.eventListeners.length;while(r)if(r-=1,n=this.context.eventListeners[r],n.event===e&&n.element===t){if(o&&o!==n.callback)continue;if(i&&n.eventManager!==this)continue;this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),Bn-=1}}clearEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let e=this.context.eventListeners.length;while(e){e-=1;const o=this.context.eventListeners[e];t&&o.eventManager!==this||(this.context.eventListeners.splice(e,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),Bn-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(t,e){let o=t.document,n=t;o||(o=t.ownerDocument?t.ownerDocument:t,n=o.defaultView);const i={bubbles:!0,cancelable:"mousemove"!==e,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let r;o.createEvent?(r=o.createEvent("MouseEvents"),r.initMouseEvent(e,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||o.body.parentNode)):r=o.createEventObject(),t.dispatchEvent?t.dispatchEvent(r):t.fireEvent(`on${e}`,r)}}function Un(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),hn(this)},t}var $n=zn;function Gn(){return Bn}function Yn(t,e){Kn(t,e),e.add(t)}function Kn(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xn(t,e,o){return e=qn(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function qn(t){var e=Qn(t,"string");return"symbol"==typeof e?e:String(e)}function Qn(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Jn(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const Zn="editorManager.navigation";var ti=new WeakSet,ei=new WeakSet;class oi{constructor(t,e,o){Yn(this,ei),Yn(this,ti),Xn(this,"hot",void 0),Xn(this,"tableMeta",void 0),Xn(this,"selection",void 0),Xn(this,"eventManager",void 0),Xn(this,"destroyed",!1),Xn(this,"lock",!1),Xn(this,"activeEditor",void 0),Xn(this,"cellProperties",void 0),this.hot=t,this.tableMeta=e,this.selection=o,this.eventManager=new $n(t),this.hot.addHook("afterDocumentKeyDown",(t=>Jn(this,ti,ni).call(this,t))),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",(t=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",t)})),this.hot.view._wt.update("onCellDblClick",((t,e,o)=>Jn(this,ei,ii).call(this,t,e,o)))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(t){this.lock||this.closeEditor(t)}getActiveEditor(){return this.activeEditor}prepareEditor(){var t;if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(t=>{t&&this.prepareEditor()}));const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!e||e.isHeader())return;const{row:o,col:n}=e,i=this.hot.runHooks("modifyGetCellCoords",o,n);let r=o,s=n;if(Array.isArray(i)&&([r,s]=i),this.cellProperties=this.hot.getCellMeta(r,s),!this.isCellEditable())return void this.clearActiveEditor();const l=this.hot.getCell(o,n,!0);if(l){const t=this.hot.getCellEditor(this.cellProperties),e=this.hot.colToProp(s),i=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r),s);this.activeEditor=Ln(t,this.hot),this.activeEditor.prepare(o,n,e,l,i,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isCellEditable()?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))):this.clearActiveEditor()}closeEditor(t,e,o){this.activeEditor?this.activeEditor.finishEditing(t,e,o):o&&o(!1)}closeEditorAndSaveChanges(t){this.closeEditor(!1,t)}closeEditorAndRestoreOriginalValue(t){this.closeEditor(!0,t)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const t=this.hot.getSelectedRangeLast();if(!t)return!1;const e=this.hot.getCellEditor(this.cellProperties),{row:o,col:n}=t.highlight,{rowIndexMapper:i,columnIndexMapper:r}=this.hot,s=i.isHidden(this.hot.toPhysicalRow(o))||r.isHidden(this.hot.toPhysicalColumn(n));return!(this.cellProperties.readOnly||!e||s)}moveSelectionAfterEnter(t){const e="function"===typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function ni(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||cn(t))return;const{keyCode:o}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!rn(o)&&!ln(o)&&!n&&!this.isEditorOpened()){const e=this.hot.getShortcutManager(),o=e.getContext("editor"),n={runOnlyIf:()=>U(this.hot.getSelected()),group:Zn};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],n),this.openEditor("",t)}}function ii(t,e,o){"TD"===o.nodeName&&this.openEditor(null,t,!0)}const ri=new WeakMap;oi.getInstance=function(t,e,o){let n=ri.get(t);return n||(n=new oi(t,e,o),ri.set(t,n)),n};var si=oi;function li(t,e){hi(t,e),e.add(t)}function ai(t,e,o){hi(t,e),e.set(t,o)}function hi(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ci(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function ui(t,e){var o=fi(t,e,"get");return di(t,o)}function di(t,e){return e.get?e.get.call(t):e.value}function gi(t,e,o){var n=fi(t,e,"set");return mi(t,n,o),o}function fi(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function mi(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const pi=Object.freeze({CELL:"cell",MIXED:"mixed"});var wi=new WeakMap,vi=new WeakMap,Ci=new WeakMap,yi=new WeakMap,bi=new WeakMap,Si=new WeakSet,Ri=new WeakSet,Ei=new WeakSet,Ti=new WeakSet;class Mi{constructor(t){var e=this;li(this,Ti),li(this,Ei),li(this,Ri),li(this,Si),ai(this,wi,{writable:!0,value:void 0}),ai(this,vi,{writable:!0,value:void 0}),ai(this,Ci,{writable:!0,value:50}),ai(this,yi,{writable:!0,value:null}),ai(this,bi,{writable:!0,value:new Map});const o=t.getSettings();gi(this,wi,t),gi(this,vi,o.imeFastEdit?pi.MIXED:pi.CELL),ui(this,wi).addHook("afterUpdateSettings",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return ci(e,Ti,Ii).call(e,...o)})),ui(this,wi).addHook("afterSelection",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return ci(e,Ri,xi).call(e,...o)})),ui(this,wi).addHook("afterSelectionEnd",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return ci(e,Ei,ki).call(e,...o)}))}getFocusMode(){return ui(this,vi)}setFocusMode(t){Object.values(pi).includes(t)?gi(this,vi,t):fn(`"${t}" is not a valid focus mode.`)}getRefocusDelay(){return ui(this,Ci)}setRefocusDelay(t){gi(this,Ci,t)}setRefocusElementGetter(t){gi(this,yi,t)}getRefocusElement(){return"function"===typeof ui(this,yi)?ui(this,yi).call(this):null===(t=ui(this,wi).getActiveEditor())||void 0===t?void 0:t.TEXTAREA;var t}focusOnHighlightedCell(t){const e=t=>{var e,o;const n=null===(e=ui(this,wi).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!n)return;let i=ui(this,wi).runHooks("modifyFocusedElement",n.row,n.col,t);i instanceof HTMLElement||(i=t),!i||null!==(o=ui(this,wi).getActiveEditor())&&void 0!==o&&o.isOpened()||i.focus({preventScroll:!0})};t?e(t):ci(this,Si,Hi).call(this,(t=>e(t)))}refocusToEditorTextarea(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ui(this,Ci);const o=this.getRefocusElement();!ui(this,wi).getSettings().imeFastEdit||null!==(t=ui(this,wi).getActiveEditor())&&void 0!==t&&t.isOpened()||!o||(ui(this,bi).has(e)||ui(this,bi).set(e,ao((()=>{o.select()}),e)),ui(this,bi).get(e)())}}function Hi(t){var e;const o=null===(e=ui(this,wi).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!o||!ui(this,wi).selection.isCellVisible(o))return void t(null);const n=ui(this,wi).getCell(o.row,o.col,!0);null===n?ui(this,wi).addHookOnce("afterScroll",(()=>{t(ui(this,wi).getCell(o.row,o.col,!0))})):t(n)}function xi(){ci(this,Si,Hi).call(this,(t=>{const{activeElement:e}=ui(this,wi).rootDocument;e&&Je(e)&&e.blur(),this.focusOnHighlightedCell(t)}))}function ki(){ci(this,Si,Hi).call(this,(t=>{this.getFocusMode()===pi.MIXED&&"TD"===t.nodeName&&this.refocusToEditorTextarea()}))}function Ii(t){t.imeFastEdit&&this.getFocusMode()!==pi.MIXED?this.setFocusMode(pi.MIXED):t.imeFastEdit||this.getFocusMode()===pi.CELL||this.setFocusMode(pi.CELL)}const Ai={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Oi=new RegExp(Object.keys(Ai).map((t=>`(${t})`)).join("|"),"gi");function Pi(t){return"TABLE"===(t&&t.nodeName||"")}function Ni(t){const e=t.hasColHeaders(),o=t.hasRowHeaders(),n=[e?-1:0,o?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),r=i.length,s=r>0?i[0].length:0,l=["<table>","</table>"],a=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],c=o?1:0,u=e?1:0;for(let d=0;d<r;d+=1){const n=e&&0===d,r=[];for(let e=0;e<s;e+=1){const s=!n&&o&&0===e;let l="";if(n)l=`<th>${t.getColHeader(e-c)}</th>`;else if(s)l=`<th>${t.getRowHeader(d-u)}</th>`;else{const o=i[d][e],{hidden:n,rowspan:r,colspan:s}=t.getCellMeta(d-u,e-c);if(!n){const t=[];if(r&&t.push(`rowspan="${r}"`),s&&t.push(`colspan="${s}"`),G(o))l=`<td ${t.join(" ")}></td>`;else{const e=o.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l=`<td ${t.join(" ")}>${e}</td>`}}}r.push(l)}const l=["<tr>",...r,"</tr>"].join("");n?a.splice(1,0,l):h.splice(-1,0,l)}return l.splice(1,0,a.join(""),h.join("")),l.join("")}function _i(t){const e=t.length,o=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],r=i.length,s=[];0===n&&o.push("<tbody>");for(let t=0;t<r;t+=1){const e=i[t],o=G(e)?"":e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`)).replace(/\t/gi,"&#9;");s.push(`<td>${o}</td>`)}o.push("<tr>",...s,"</tr>"),n+1===e&&o.push("</tbody>")}return o.push("</table>"),o.join("")}function Li(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const o={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let r=t;if("string"===typeof r){const t=r.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(t=>{const e=t.match(/<td\b[^>]*?>/g)[0],o=t.substring(e.length,t.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),n="</td>";return`${e}${o}${n}`}));i.insertAdjacentHTML("afterbegin",`${t}`),r=i.querySelector("table")}if(!r||!Pi(r))return;const s=i.querySelector('meta[name$="enerator"]'),l=null!==r.querySelector("tbody th"),a=r.querySelector("tr"),h=a?Array.from(a.cells).reduce(((t,e)=>t+e.colSpan),0)-(l?1:0):0,c=r.tFoot&&Array.from(r.tFoot.rows)||[],u=[];let d=!1,g=0,f=0;if(r.tHead){const t=Array.from(r.tHead.rows).filter((t=>{const e=null!==t.querySelector("td");return e&&u.push(t),!e}));g=t.length,d=g>0,g>1?o.nestedHeaders=Array.from(t).reduce(((t,e)=>{const o=Array.from(e.cells).reduce(((t,e,o)=>{if(l&&0===o)return t;const{colSpan:n,innerHTML:i}=e,r=n>1?{label:i,colspan:n}:i;return t.push(r),t}),[]);return t.push(o),t}),[]):d&&(o.colHeaders=Array.from(t[0].children).reduce(((t,e,o)=>(l&&0===o||t.push(e.innerHTML),t)),[]))}u.length&&(o.fixedRowsTop=u.length),c.length&&(o.fixedRowsBottom=c.length);const m=[...u,...Array.from(r.tBodies).reduce(((t,e)=>(t.push(...Array.from(e.rows)),t)),[]),...c];f=m.length;const p=new Array(f);for(let C=0;C<f;C++)p[C]=new Array(h);const w=[],v=[];for(let C=0;C<f;C++){const t=m[C],e=Array.from(t.cells),o=e.length;for(let n=0;n<o;n++){const t=e[n],{nodeName:o,innerHTML:i,rowSpan:r,colSpan:l}=t,a=p[C].findIndex((t=>void 0===t));if("TD"===o){if(r>1||l>1){for(let t=C;t<C+r;t++)if(t<f)for(let e=a;e<a+l;e++)p[t][e]=null;const e=t.getAttribute("style"),o=e&&e.includes("mso-ignore:colspan");o||w.push({col:a,row:C,rowspan:r,colspan:l})}let e="";e=s&&/excel/gi.test(s.content)?i.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):i.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),p[C][a]=e.replace(Oi,(t=>Ai[t]))}else v.push(i)}}return w.length&&(o.mergeCells=w),v.length&&(o.rowHeaders=v),p.length&&(o.data=p),o}function Di(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=typeof t;if("number"===o)return!isNaN(t)&&isFinite(t);if("string"===o){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);const o=Array.from(new Set([".",...e])).map((t=>`\\${t}`)).join("|");return new RegExp(`^[+-]?\\s*(((${o})?\\d+((${o})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}return"object"===o&&(!!t&&"number"===typeof t.valueOf()&&!(t instanceof Date))}function Wi(t){return Di(t,[","])}function Vi(t,e,o){let n=-1;"function"===typeof e?(o=e,e=t):n=t-1;while(++n<=e)if(!1===o(n))break}function Fi(t,e,o){let n=t+1;"function"===typeof e&&(o=e,e=0);while(--n>=e)if(!1===o(n))break}function ji(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Bi(t,e,o){return Math.min(t,e)===t?e:Math.max(t,o)===t?o:t}const zi="asc",Ui="desc",$i=new Map([[zi,[-1,1]],[Ui,[1,-1]]]),Gi=t=>`The priority '${t}' is already declared in a map.`,Yi=t=>`The priority '${t}' is not a number.`;function Ki(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=new Map;function n(n,i){if(!Di(n))throw new Error(e(n));if(o.has(n))throw new Error(t(n));o.set(n,i)}function i(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zi;const[e,n]=$i.get(t)||$i.get(zi);return[...o].sort(((t,o)=>t[0]<o[0]?e:n)).map((t=>t[1]))}return t=ro(t)?t:Gi,e=ro(e)?e:Yi,{addItem:n,getItems:i}}const Xi=t=>`The id '${t}' is already declared in a map.`;function qi(){let{errorIdExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Map;function o(o,n){if(a(o))throw new Error(t(o));e.set(o,n)}function n(t){return e.delete(t)}function i(){e.clear()}function r(t){const[e]=l().find((e=>{let[o,n]=e;return t===n&&o}))||[null];return e}function s(t){return e.get(t)}function l(){return[...e]}function a(t){return e.has(t)}return t=ro(t)?t:Xi,{addItem:o,clear:i,getId:r,getItem:s,getItems:l,hasItem:a,removeItem:n}}const Qi=t=>`'${t}' value is already declared in a unique set.`;function Ji(){let{errorItemExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Set;function o(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return t=ro(t)?t:Qi,{addItem:o,clear:i,getItems:n}}const Zi=t=>`There is already registered "${t}" plugin.`,tr=t=>`There is already registered plugin on priority "${t}".`,er=t=>`The priority "${t}" is not a number.`,or=Ki({errorPriorityExists:tr,errorPriorityNaN:er}),nr=Ji({errorItemExists:Zi}),ir=qi({errorIdExists:Zi});function rr(){return[...or.getItems(),...nr.getItems()]}function sr(t){const e=lt(t);return ir.getItem(e)}function lr(t){return!!sr(t)}function ar(t,e,o){[t,e,o]=cr(t,e,o),void 0===sr(t)&&hr(t,e,o)}function hr(t,e,o){const n=lt(t);if(ir.hasItem(n))throw new Error(Zi(n));void 0===o?nr.addItem(n):or.addItem(o,n),ir.addItem(n,e)}function cr(t,e,o){return"function"===typeof t&&(e=t,t=e.PLUGIN_KEY,o=e.PLUGIN_PRIORITY),[t,e,o]}const{register:ur,getItem:dr,hasItem:gr,getNames:fr,getValues:mr}=xn("renderers");function pr(t){if("function"===typeof t)return t;if(!gr(t))throw Error(`No registered renderer found under "${t}" name`);return dr(t)}function wr(t,e){"string"!==typeof t&&(e=t,t=e.RENDERER_TYPE),ur(t,e)}const{register:vr,getItem:Cr,hasItem:yr,getNames:br,getValues:Sr}=xn("validators");function Rr(t){if("function"===typeof t)return t;if(!yr(t))throw Error(`No registered validator found under "${t}" name`);return Cr(t)}function Er(t,e){"string"!==typeof t&&(e=t,t=e.VALIDATOR_TYPE),vr(t,e)}function Tr(t,e,o){Mr(t,e),e.set(t,o)}function Mr(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hr(t,e){var o=Ir(t,e,"get");return xr(t,o)}function xr(t,e){return e.get?e.get.call(t):e.value}function kr(t,e,o){var n=Ir(t,e,"set");return Ar(t,n,o),o}function Ir(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Ar(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var Or=new WeakMap,Pr=new WeakMap,Nr=new WeakMap,_r=new WeakMap,Lr=new WeakMap,Dr=new WeakMap,Wr=new WeakMap,Vr=new WeakMap,Fr=new WeakMap,jr=new WeakMap;class Br{constructor(t,e,o,n,i,r){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Tr(this,Or,{writable:!0,value:void 0}),Tr(this,Pr,{writable:!0,value:void 0}),Tr(this,Nr,{writable:!0,value:void 0}),Tr(this,_r,{writable:!0,value:void 0}),Tr(this,Lr,{writable:!0,value:void 0}),Tr(this,Dr,{writable:!0,value:void 0}),Tr(this,Wr,{writable:!0,value:void 0}),Tr(this,Vr,{writable:!0,value:void 0}),Tr(this,Fr,{writable:!0,value:[null,null]}),Tr(this,jr,{writable:!0,value:[null,null]}),kr(this,Or,o),kr(this,Pr,e),kr(this,Nr,i),kr(this,_r,r),kr(this,Lr,s),kr(this,Dr,n),kr(this,Wr,t),this.registerEvents()}registerEvents(){Hr(this,Dr).addEventListener(Hr(this,Nr).holder,"contextmenu",(t=>this.onContextMenu(t))),Hr(this,Dr).addEventListener(Hr(this,Nr).TABLE,"mouseover",(t=>this.onMouseOver(t))),Hr(this,Dr).addEventListener(Hr(this,Nr).TABLE,"mouseout",(t=>this.onMouseOut(t)));const t=()=>{Hr(this,Dr).addEventListener(Hr(this,Nr).holder,"touchstart",(t=>this.onTouchStart(t))),Hr(this,Dr).addEventListener(Hr(this,Nr).holder,"touchend",(t=>this.onTouchEnd(t))),this.momentumScrolling||(this.momentumScrolling={}),Hr(this,Dr).addEventListener(Hr(this,Nr).holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Hr(this,Or).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Hr(this,Or).getSetting("onAfterMomentumScroll"))}),200)}))},e=()=>{Hr(this,Dr).addEventListener(Hr(this,Nr).holder,"mouseup",(t=>this.onMouseUp(t))),Hr(this,Dr).addEventListener(Hr(this,Nr).holder,"mousedown",(t=>this.onMouseDown(t)))};Xo()?t():(Po()&&t(),e())}selectedCellWasTouched(t){const e=this.parentCell(t),o=e.coords;if(Hr(this,Vr)&&o){const[t,e]=[o.row,Hr(this,Vr).from.row],[n,i]=[o.col,Hr(this,Vr).from.col];return t===e&&n===i}return!1}parentCell(t){const e={},o=Hr(this,Nr).TABLE,n=re(t,["TD","TH"],o);return n?(e.coords=Hr(this,Nr).getCoords(n),e.TD=n):ue(t,"wtBorder")&&ue(t,"current")?(e.coords=Hr(this,_r).getFocusSelection().cellRange.highlight,e.TD=Hr(this,Nr).getCell(e.coords)):ue(t,"wtBorder")&&ue(t,"area")&&Hr(this,_r).getAreaSelection().cellRange&&(e.coords=Hr(this,_r).getAreaSelection().cellRange.to,e.TD=Hr(this,Nr).getCell(e.coords)),e}onMouseDown(t){const e=Hr(this,Pr).rootDocument.activeElement,o=co(Zt,t.target),n=t.target;if(!["TD","TH"].includes(e.nodeName)&&(n===e||o(0)===e||o(1)===e))return;const i=this.parentCell(n);ue(n,"corner")?Hr(this,Or).getSetting("onCellCornerMouseDown",t,n):i.TD&&Hr(this,Or).has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,i.coords,i.TD),(0===t.button||this.touchApplied)&&i.TD&&(Hr(this,jr)[0]=i.TD,clearTimeout(Hr(this,Fr)[0]),Hr(this,Fr)[0]=setTimeout((()=>{Hr(this,jr)[0]=null}),1e3))}onContextMenu(t){if(Hr(this,Or).has("onCellContextMenu")){const e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}onMouseOver(t){if(!Hr(this,Or).has("onCellMouseOver"))return;const e=Hr(this,Nr).TABLE,o=re(t.target,["TD","TH"],e),n=Hr(this,Lr)||this;o&&o!==n.lastMouseOver&&se(o,e)&&(n.lastMouseOver=o,this.callListener("onCellMouseOver",t,Hr(this,Nr).getCoords(o),o))}onMouseOut(t){if(!Hr(this,Or).has("onCellMouseOut"))return;const e=Hr(this,Nr).TABLE,o=re(t.target,["TD","TH"],e),n=re(t.relatedTarget,["TD","TH"],e),i=Hr(this,Lr)||this;o&&o!==n&&se(o,e)&&(this.callListener("onCellMouseOut",t,Hr(this,Nr).getCoords(o),o),null===n&&(i.lastMouseOver=null))}onMouseUp(t){const e=this.parentCell(t.target);e.TD&&Hr(this,Or).has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,e.coords,e.TD),(0===t.button||this.touchApplied)&&(e.TD===Hr(this,jr)[0]&&e.TD===Hr(this,jr)[1]?(ue(t.target,"corner")?this.callListener("onCellCornerDblClick",t,e.coords,e.TD):this.callListener("onCellDblClick",t,e.coords,e.TD),Hr(this,jr)[0]=null,Hr(this,jr)[1]=null):e.TD===Hr(this,jr)[0]&&(Hr(this,jr)[1]=e.TD,clearTimeout(Hr(this,Fr)[1]),Hr(this,Fr)[1]=setTimeout((()=>{Hr(this,jr)[1]=null}),500)))}onTouchStart(t){kr(this,Vr,Hr(this,_r).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(t)}onTouchEnd(t){var e;const o=t.target,n=null===(e=this.parentCell(o))||void 0===e?void 0:e.coords,i=U(n)&&n.row>=0&&n.col>=0,r=t.cancelable&&i&&Hr(this,Or).getSetting("isDataViewInstance");if(r){const e=["A","BUTTON","INPUT"];qo()&&(zo()||$o())&&this.selectedCellWasTouched(o)&&!e.includes(o.tagName)?t.preventDefault():this.selectedCellWasTouched(o)||t.preventDefault()}this.onMouseUp(t),this.touchApplied=!1}callListener(t,e,o,n){const i=Hr(this,Or).getSettingPure(t);i&&i(e,o,n,Hr(this,Wr).call(this))}destroy(){clearTimeout(Hr(this,Fr)[0]),clearTimeout(Hr(this,Fr)[1]),Hr(this,Dr).destroy()}}var zr=Br;function Ur(t,e,o){return e=$r(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function $r(t){var e=Gr(t,"string");return"symbol"==typeof e?e:String(e)}function Gr(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Yr{constructor(t,e,o){Ur(this,"offset",void 0),Ur(this,"total",void 0),Ur(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=o}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleRowHeadedColumnToSourceColumn(t){return this.renderedToSource(this.offsettedTH(t))}sourceColumnToVisibleRowHeadedColumn(t){return this.unOffsettedTH(this.sourceToRendered(t))}}var Kr=Yr;function Xr(t,e,o){return e=qr(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function qr(t){var e=Qr(t,"string");return"symbol"==typeof e?e:String(e)}function Qr(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Jr{constructor(t,e,o){Xr(this,"offset",void 0),Xr(this,"total",void 0),Xr(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=o}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleColHeadedRowToSourceRow(t){return this.renderedToSource(this.offsettedTH(t))}sourceRowToVisibleColHeadedRow(t){return this.unOffsettedTH(this.sourceToRendered(t))}}var Zr=Jr;const ts=0,es=1,os=2;function ns(t,e,o){return e=is(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function is(t){var e=rs(t,"string");return"symbol"==typeof e?e:String(e)}function rs(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ss{constructor(){ns(this,"currentSize",0),ns(this,"nextSize",0),ns(this,"currentOffset",0),ns(this,"nextOffset",0)}setSize(t){this.currentSize=this.nextSize,this.nextSize=t}setOffset(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}function ls(t,e,o){return e=as(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function as(t){var e=hs(t,"string");return"symbol"==typeof e?e:String(e)}function hs(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class cs{constructor(){ls(this,"size",new ss),ls(this,"workingSpace",ts),ls(this,"sharedSize",null)}setSize(t){this.size.setSize(t)}setOffset(t){this.size.setOffset(t)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof ss}isPlaceOn(t){return this.workingSpace===t}append(t){this.workingSpace=es,t.workingSpace=os,this.sharedSize=t.getViewSize()}prepend(t){this.workingSpace=os,t.workingSpace=es,this.sharedSize=t.getViewSize()}}function us(t,e,o){return e=ds(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ds(t){var e=gs(t,"string");return"symbol"==typeof e?e:String(e)}function gs(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class fs{constructor(t,e,o){us(this,"rootNode",void 0),us(this,"nodesPool",void 0),us(this,"sizeSet",new cs),us(this,"childNodeType",void 0),us(this,"visualIndex",0),us(this,"collectedNodes",[]),this.rootNode=t,this.nodesPool=e,this.childNodeType=o.toUpperCase()}setSize(t){return this.sizeSet.setSize(t),this}setOffset(t){return this.sizeSet.setOffset(t),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}getCurrentNode(){const t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}getRenderedChildCount(){const{rootNode:t,sizeSet:e}=this;let o=0;if(this.isSharedViewSet()){let n=t.firstElementChild;while(n){if(n.tagName===this.childNodeType)o+=1;else if(e.isPlaceOn(es))break;n=n.nextElementSibling}}else o=t.childElementCount;return o}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:t,sizeSet:e}=this,o=this.isSharedViewSet(),{nextSize:n}=e.getViewSize();let i=this.getRenderedChildCount();while(i<n){const n=this.nodesPool();!o||o&&e.isPlaceOn(os)?t.appendChild(n):t.insertBefore(n,t.firstChild),i+=1}const r=o&&e.isPlaceOn(es);while(i>n)t.removeChild(r?t.firstChild:t.lastChild),i-=1}render(){const{rootNode:t,sizeSet:e}=this;let o=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(os)&&(o+=e.sharedSize.nextSize);let n=t.childNodes[o];if(n.tagName!==this.childNodeType){const e=this.nodesPool();t.replaceChild(e,n),n=e}this.collectedNodes.push(n),this.visualIndex+=1}end(){}}class ms extends fs{prependView(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}appendView(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}function ps(t,e,o){return e=ws(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ws(t){var e=vs(t,"string");return"symbol"==typeof e?e:String(e)}function vs(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Cs{constructor(t){ps(this,"nodeType",void 0),this.nodeType=t.toUpperCase()}setRootDocument(t){this.rootDocument=t}obtain(){return this.rootDocument.createElement(this.nodeType)}}function ys(t,e,o){return e=bs(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function bs(t){var e=Ss(t,"string");return"symbol"==typeof e?e:String(e)}function Ss(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Rs{constructor(t,e){ys(this,"nodesPool",null),ys(this,"nodeType",void 0),ys(this,"rootNode",void 0),ys(this,"table",null),ys(this,"renderedNodes",0),this.nodesPool="string"===typeof t?new Cs(t):null,this.nodeType=t,this.rootNode=e}setTable(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}adjust(){}render(){}}function Es(t,e,o){return e=Ts(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ts(t){var e=Ms(t,"string");return"symbol"==typeof e?e:String(e)}function Ms(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Hs extends Rs{constructor(){super("TH"),Es(this,"orderViews",new WeakMap),Es(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new ms(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,rowHeaderFunctions:e,rowHeadersCount:o,rows:n,cells:i}=this.table;for(let r=0;r<t;r++){const t=this.table.renderedRowToSource(r),s=n.getRenderedNode(r);this.sourceRowIndex=t;const l=this.obtainOrderView(s),a=i.obtainOrderView(s);l.appendView(a).setSize(o).setOffset(this.table.renderedColumnToSource(0)).start();for(let n=0;n<o;n++){l.render();const o=l.getCurrentNode();o.className="",o.removeAttribute("style"),me(o,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&fe(o,[vt(),kt(),Vt(n+1),ft(-1)]),e[n](t,o,n)}l.end()}}}class xs extends Rs{constructor(t){super(null,t)}adjust(){const{columnHeadersCount:t,rowHeadersCount:e}=this.table;let o=this.rootNode.firstChild;if(t){const{columnsToRender:n}=this.table,i=n+e;for(let e=0,s=t;e<s;e++){o=this.rootNode.childNodes[e],o||(o=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(o)),this.renderedNodes=o.childNodes.length;while(this.renderedNodes<i)o.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;while(this.renderedNodes>i)o.removeChild(o.lastChild),this.renderedNodes-=1}const r=this.rootNode.childNodes.length;if(r>t)for(let e=t;e<r;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else o&&we(o)}render(){const{columnHeadersCount:t}=this.table;this.table.isAriaEnabled()&&fe(this.rootNode,[Ct()]);for(let e=0;e<t;e+=1){const{columnHeaderFunctions:t,columnsToRender:o,rowHeadersCount:n}=this.table,i=this.rootNode.childNodes[e];this.table.isAriaEnabled()&&fe(i,[bt(),Wt(e+1)]);for(let r=-1*n;r<o;r+=1){const o=this.table.renderedColumnToSource(r),s=i.childNodes[r+n];s.className="",s.removeAttribute("style"),me(s,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&fe(s,[Vt(r+1+this.table.rowHeadersCount),ft(-1),yt(),...r>=0?[xt()]:[bt()]]),t[e](o,s,e)}}}}let ks=!1;class Is extends Rs{constructor(t){super(null,t)}adjust(){const{columnsToRender:t,rowHeadersCount:e}=this.table,o=t+e;while(this.renderedNodes<o)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;while(this.renderedNodes>o)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:t,rowHeadersCount:e}=this.table;!ks&&t>1e3&&(ks=!0,fn(B`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let n=0;n<e;n++){const t=this.table.renderedColumnToSource(n),e=this.table.columnUtils.getHeaderWidth(t);this.rootNode.childNodes[n].style.width=`${e}px`}for(let n=0;n<t;n++){const t=this.table.renderedColumnToSource(n),o=this.table.columnUtils.getStretchedColumnWidth(t);this.rootNode.childNodes[n+e].style.width=`${o}px`}const o=this.rootNode.firstChild;o&&de(o,"rowHeader")}}function As(t,e,o){return e=Os(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Os(t){var e=Ps(t,"string");return"symbol"==typeof e?e:String(e)}function Ps(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}let Ns=!1;class _s extends Rs{constructor(t){super("TR",t),As(this,"orderView",void 0),this.orderView=new fs(t,(t=>this.nodesPool.obtain(t)),this.nodeType)}getRenderedNode(t){return this.orderView.getNode(t)}render(){const{rowsToRender:t}=this.table;!Ns&&t>1e3&&(Ns=!0,fn(B`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&fe(this.rootNode,[Ct()]),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let n=0;n<t;n++){this.orderView.render();const t=this.orderView.getCurrentNode(),i=this.table.renderedRowToSource(n);var e,o;if(this.table.isAriaEnabled())fe(t,[bt(),Wt(i+(null!==(e=null===(o=this.table.rowUtils)||void 0===o||null===(o=o.dataAccessObject)||void 0===o?void 0:o.columnHeaders.length)&&void 0!==e?e:0)+1)])}this.orderView.end()}}function Ls(t,e,o){return e=Ds(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ds(t){var e=Ws(t,"string");return"symbol"==typeof e?e:String(e)}function Ws(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Vs extends Rs{constructor(){super("TD"),Ls(this,"orderViews",new WeakMap),Ls(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new ms(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,columnsToRender:e,rows:o,rowHeaders:n}=this.table;for(let s=0;s<t;s++){const t=this.table.renderedRowToSource(s),l=o.getRenderedNode(s);this.sourceRowIndex=t;const a=this.obtainOrderView(l),h=n.obtainOrderView(l);a.prependView(h).setSize(e).setOffset(this.table.renderedColumnToSource(0)).start();for(let o=0;o<e;o++){a.render();const e=a.getCurrentNode(),n=this.table.renderedColumnToSource(o);var i,r;if(ue(e,"hide")||(e.className=""),e.removeAttribute("style"),e.removeAttribute("dir"),me(e,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(t,n,e),this.table.isAriaEnabled())fe(e,[...e.hasAttribute("role")?[]:[wt()],ft(-1),Vt(n+(null!==(i=null===(r=this.table.rowUtils)||void 0===r||null===(r=r.dataAccessObject)||void 0===r?void 0:r.rowHeaders.length)&&void 0!==i?i:0)+1)])}a.end()}}}function Fs(t,e,o){return e=js(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function js(t){var e=Bs(t,"string");return"symbol"==typeof e?e:String(e)}function Bs(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class zs{constructor(t){let{cellRenderer:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Fs(this,"rootNode",void 0),Fs(this,"rootDocument",void 0),Fs(this,"rowHeaders",null),Fs(this,"columnHeaders",null),Fs(this,"colGroup",null),Fs(this,"rows",null),Fs(this,"cells",null),Fs(this,"rowFilter",null),Fs(this,"columnFilter",null),Fs(this,"rowUtils",null),Fs(this,"columnUtils",null),Fs(this,"rowsToRender",0),Fs(this,"columnsToRender",0),Fs(this,"rowHeaderFunctions",[]),Fs(this,"rowHeadersCount",0),Fs(this,"columnHeaderFunctions",[]),Fs(this,"columnHeadersCount",0),Fs(this,"cellRenderer",void 0),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=e}setAxisUtils(t,e){this.rowUtils=t,this.columnUtils=e}setViewportSize(t,e){this.rowsToRender=t,this.columnsToRender=e}setFilters(t,e){this.rowFilter=t,this.columnFilter=e}setHeaderContentRenderers(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}setRenderers(){let{rowHeaders:t,columnHeaders:e,colGroup:o,rows:n,cells:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setTable(this),e.setTable(this),o.setTable(this),n.setTable(this),i.setTable(this),this.rowHeaders=t,this.columnHeaders=e,this.colGroup=o,this.rows=n,this.cells=i}renderedRowToSource(t){return this.rowFilter.renderedToSource(t)}renderedColumnToSource(t){return this.columnFilter.renderedToSource(t)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:t,rows:e}=this;for(let o=0;o<t;o++){const t=e.getRenderedNode(o);if(t.firstChild){const e=this.renderedRowToSource(o),n=this.rowUtils.getHeight(e);t.firstChild.style.height=n?n-1+"px":""}}}}class Us{constructor(){let{TABLE:t,THEAD:e,COLGROUP:o,TBODY:n,rowUtils:i,columnUtils:r,cellRenderer:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new zs(t,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new Hs,columnHeaders:new xs(e),colGroup:new Is(o),rows:new _s(n),cells:new Vs}),this.renderer.setAxisUtils(i,r)}setFilters(t,e){return this.renderer.setFilters(t,e),this}setViewportSize(t,e){return this.renderer.setViewportSize(t,e),this}setHeaderContentRenderers(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function $s(t,e,o){Gs(t,e),e.set(t,o)}function Gs(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ys(t,e,o){return e=Ks(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ks(t){var e=Xs(t,"string");return"symbol"==typeof e?e:String(e)}function Xs(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function qs(t,e){var o=Zs(t,e,"get");return Qs(t,o)}function Qs(t,e){return e.get?e.get.call(t):e.value}function Js(t,e,o){var n=Zs(t,e,"set");return tl(t,n,o),o}function Zs(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function tl(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var el=new WeakMap,ol=new WeakMap,nl=new WeakMap,il=new WeakMap,rl=new WeakMap;class sl{static get DEFAULT_WIDTH(){return 50}constructor(t){let{totalColumns:e,stretchMode:o,stretchingColumnWidthFn:n,columnWidthFn:i}=t;Ys(this,"stretchAllRatio",0),Ys(this,"stretchLastWidth",0),Ys(this,"stretchAllColumnsWidth",[]),$s(this,el,{writable:!0,value:0}),Ys(this,"needVerifyLastColumnWidth",!0),$s(this,ol,{writable:!0,value:()=>0}),$s(this,nl,{writable:!0,value:t=>t}),$s(this,il,{writable:!0,value:t=>t}),$s(this,rl,{writable:!0,value:()=>"none"}),Js(this,ol,e),Js(this,rl,o),Js(this,nl,null!==n&&void 0!==n?n:qs(this,nl)),Js(this,il,null!==i&&void 0!==i?i:qs(this,il))}refreshStretching(t){if("none"===qs(this,rl).call(this))return;Js(this,el,t);let e=0;for(let n=0;n<qs(this,ol).call(this);n++){const o=this._getColumnWidth(n),i=qs(this,nl).call(this,void 0,n);"number"===typeof i?t-=i:e+=o}const o=t-e;if("all"===qs(this,rl).call(this)&&o>0)this.stretchAllRatio=t/e,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===qs(this,rl).call(this)&&t!==1/0){const t=this._getColumnWidth(qs(this,ol).call(this)-1),e=o+t;this.stretchLastWidth=e>=0?e:t}}getStretchedColumnWidth(t,e){let o=null;return"all"===qs(this,rl).call(this)&&0!==this.stretchAllRatio?o=this._getStretchedAllColumnWidth(t,e):"last"===qs(this,rl).call(this)&&0!==this.stretchLastWidth&&(o=this._getStretchedLastColumnWidth(t)),o}_getStretchedAllColumnWidth(t,e){let o=0;if(!this.stretchAllColumnsWidth[t]){const o=Math.round(e*this.stretchAllRatio),n=qs(this,nl).call(this,o,t);this.stretchAllColumnsWidth[t]=void 0===n?o:isNaN(n)?this._getColumnWidth(t):n}if(this.stretchAllColumnsWidth.length===qs(this,ol).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let t=0;t<this.stretchAllColumnsWidth.length;t++)o+=this.stretchAllColumnsWidth[t];o!==qs(this,el)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=qs(this,el)-o)}return this.stretchAllColumnsWidth[t]}_getStretchedLastColumnWidth(t){return t===qs(this,ol).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(t){let e=qs(this,il).call(this,t);return isNaN(e)&&(e=sl.DEFAULT_WIDTH),e}}function ll(t,e,o){return e=al(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function al(t){var e=hl(t,"string");return"symbol"==typeof e?e:String(e)}function hl(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class cl{constructor(t,e){ll(this,"dataAccessObject",void 0),ll(this,"wtSettings",void 0),ll(this,"headerWidths",new Map),ll(this,"stretching",void 0),this.dataAccessObject=t,this.wtSettings=e,this.stretching=new sl({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(t,e)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",t,e),columnWidthFn:t=>this.dataAccessObject.wtTable.getColumnWidth(t)})}getWidth(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(t){let e=this.getWidth(t);const o=this.stretching.getStretchedColumnWidth(t,e);return o&&(e=o),e}getHeaderHeight(t){let e=this.wtSettings.getSetting("defaultRowHeight");const o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==o&&(e=e?Math.max(e,o):o),e}getHeaderWidth(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}refreshStretching(){const{wtTable:t,wtViewport:e,cloneSource:o}=this.dataAccessObject,n=o?o.wtTable.holder:t.holder,i=n.offsetHeight<n.scrollHeight?$e():0;this.stretching.refreshStretching(e.getViewportWidth()-i)}calculateWidths(){const{wtSettings:t}=this;let e=t.getSetting("rowHeaderWidth");if(this.refreshStretching(),e=t.getSetting("onModifyRowHeaderWidth",e),null!==e&&void 0!==e){const o=t.getSetting("rowHeaders").length,n=t.getSetting("defaultColumnWidth");for(let t=0;t<o;t++){let o=Array.isArray(e)?e[t]:e;o=null===o||void 0===o?n:o,this.headerWidths.set(t,o)}}}}function ul(t,e,o){return e=dl(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function dl(t){var e=gl(t,"string");return"symbol"==typeof e?e:String(e)}function gl(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class fl{constructor(t,e){ul(this,"dataAccessObject",void 0),ul(this,"wtSettings",void 0),this.dataAccessObject=t,this.wtSettings=e}getHeight(t){let e=this.wtSettings.getSetting("rowHeight",t);const o=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==o&&(e=void 0===e?o:Math.max(e,o)),e}}const ml="top",pl="bottom",wl="inline_start",vl="top_inline_start_corner",Cl="bottom_inline_start_corner",yl=[ml,pl,wl,vl,Cl],bl=new Map([[ml,`ht_clone_${ml}`],[pl,`ht_clone_${pl}`],[wl,`ht_clone_${wl} ht_clone_left`],[vl,`ht_clone_${vl} ht_clone_top_left_corner`],[Cl,`ht_clone_${Cl} ht_clone_bottom_left_corner`]]);function Sl(t,e,o){return e=Rl(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Rl(t){var e=El(t,"string");return"symbol"==typeof e?e:String(e)}function El(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Tl{constructor(t,e,o,n,i){Sl(this,"wtSettings",null),Sl(this,"domBindings",void 0),Sl(this,"TBODY",null),Sl(this,"THEAD",null),Sl(this,"COLGROUP",null),Sl(this,"hasTableHeight",!0),Sl(this,"hasTableWidth",!0),Sl(this,"isTableVisible",!1),Sl(this,"tableOffset",0),Sl(this,"holderOffset",0),this.domBindings=o,this.isMaster="master"===i,this.name=i,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=o.rootTable,pe(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const r=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(r))),this.rowUtils=new fl(this.dataAccessObject,this.wtSettings),this.columnUtils=new cl(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Us({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(t){return this.name===t}fixTableDomTree(){const t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&ue(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",e&&e.insertBefore(o,t),o.appendChild(t)),o.style.position="relative",this.wtSettings.getSetting("ariaTags")&&fe(o,[pt()]),o}createHider(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&ue(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",e&&e.insertBefore(o,t),o.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&fe(o,[pt()]),o}createHolder(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&ue(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",e&&e.insertBefore(o,t),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&fe(o.parentNode,[pt()])),o.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&fe(o,[pt()]),o}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this,{wtOverlays:o,wtViewport:n}=this.dataAccessObject,i=e.getSetting("totalRows"),r=e.getSetting("totalColumns"),s=e.getSetting("rowHeaders"),l=s.length,a=e.getSetting("columnHeaders"),h=a.length;let c=!1,u=t;if(this.isMaster&&(this.holderOffset=Se(this.holder),u=n.createRenderCalculators(u),l&&!e.getSetting("fixedColumnsStart"))){const t=o.inlineStartOverlay.getScrollPosition(),e=this.correctHeaderWidth;this.correctHeaderWidth=0!==t,e!==this.correctHeaderWidth&&(u=!1)}if(this.isMaster&&(c=o.updateStateOfRendering()),u)this.isMaster&&n.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=Se(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const t=i>0?this.getFirstRenderedRow():0,e=r>0?this.getFirstRenderedColumn():0;this.rowFilter=new Zr(t,i,h),this.columnFilter=new Kr(e,r,l);let o=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const t={};this.wtSettings.getSetting("beforeDraw",!0,t),o=!0!==t.skipRender}if(o){let t;if(this.tableRenderer.setHeaderContentRenderers(s,a),(this.is(pl)||this.is(Cl))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(t=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(pl))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const e=Oe(this.hider),o=Oe(this.TABLE);0!==e&&o!==e&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),t!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(pl)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(d=o.bottomOverlay.resetFixedPosition()||d),d=o.inlineStartOverlay.resetFixedPosition()||d,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(o.refreshAll(),o.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(u),c&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(t){const e=this.columnFilter.renderedToSource(t);let o=this.wtSettings.getSetting("columnHeaders").length;const n=this.wtSettings.getSetting("defaultRowHeight");let i,r,s;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];while(o)o-=1,i=this.getColumnHeaderHeight(o),r=this.getColumnHeader(e,o),r&&(s=Ne(r),(!i&&n<s||i<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=s),Array.isArray(l)?null!==l[o]&&void 0!==l[o]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l[o]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(l[o]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l[o]||l))}adjustColumnHeaderHeights(){const{wtSettings:t}=this,e=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,n=t.getSetting("columnHeaders");for(let i=0,r=n.length;i<r;i++)if(o[i]){if(!e[i]||0===e[i].childNodes.length)return;e[i].childNodes[0].style.height=`${o[i]}px`}}resetOversizedRows(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject;if((this.isMaster||this.is(pl))&&!t.getSetting("externalRowCalculator")){const t=this.getRenderedRowsCount();for(let o=0;o<t;o++){const t=this.rowFilter.renderedToSource(o);e.oversizedRows&&e.oversizedRows[t]&&(e.oversizedRows[t]=void 0)}}}getCell(t){let e=t.row,o=t.col;const n=this.wtSettings.getSetting("onModifyGetCellCoords",e,o);if(n&&Array.isArray(n)&&([e,o]=n),this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;const i=this.getRow(e);if(!i&&e>=0)throw new Error("TR was expected to be rendered but is not");const r=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!r&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return r}getRow(t){let e=null,o=null;var n,i;t<0?(e=null===(n=this.rowFilter)||void 0===n?void 0:n.sourceRowToVisibleColHeadedRow(t),o=this.THEAD):(e=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(t),o=this.TBODY);return void 0!==e&&void 0!==o&&(!(o.childNodes.length<e+1)&&o.childNodes[e])}getColumnHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const o=this.THEAD.childNodes[e];return null===o||void 0===o?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}getColumnHeaders(t){const e=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach((t=>{const n=t.childNodes[o];n&&e.push(n)})),e}getRowHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const o=this.wtSettings.getSetting("rowHeaders").length;if(e>=o)return;const n=this.rowFilter.sourceToRendered(t),i=n<0?this.rowFilter.sourceRowToVisibleColHeadedRow(t):n,r=n<0?this.THEAD:this.TBODY,s=r.childNodes[i];return null===s||void 0===s?void 0:s.childNodes[e]}getRowHeaders(t){const e=[],o=this.wtSettings.getSetting("rowHeaders").length;for(let n=0;n<o;n++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],i=null===o||void 0===o?void 0:o.childNodes[n];i&&e.push(i)}return e}getCoords(t){let e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=ie(e,["TD","TH"])),null===e)return null;const o=e.parentNode,n=o.parentNode;let i=le(o),r=e.cellIndex;if(ae(vl,e,this.wtRootElement)||ae(ml,e,this.wtRootElement))"THEAD"===n.nodeName&&(i-=n.childNodes.length);else if(ae(Cl,e,this.wtRootElement)||ae(pl,e,this.wtRootElement)){const t=this.wtSettings.getSetting("totalRows");i=t-n.childNodes.length+i}else i=n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i);return r=ae(vl,e,this.wtRootElement)||ae(wl,e,this.wtRootElement)||ae(Cl,e,this.wtRootElement)?this.columnFilter.offsettedTH(r):this.columnFilter.visibleRowHeadedColumnToSourceColumn(r),this.wot.createCellCoords(i,r)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let t=this.TBODY.childNodes.length;const e=t*this.wtSettings.getSetting("defaultRowHeight"),o=Ne(this.TBODY)-1;let n,i,r,s,l;if(e!==o||this.wtSettings.getSetting("fixedRowsBottom"))while(t)t-=1,r=this.rowFilter.renderedToSource(t),n=this.getRowHeight(r),s=this.getTrForRow(r),l=s.querySelector("th"),i=l?Ne(l):Ne(s)-1,(!n&&this.wtSettings.getSetting("defaultRowHeight")<i||n<i)&&(i+=1,this.dataAccessObject.wtViewport.oversizedRows[r]=i)}getTrForRow(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}isColumnHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("rowHeaders"),o=e.length;return Math.abs(t)<=o}isRowHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("columnHeaders"),o=e.length;return Math.abs(t)<=o}isRowBeforeRenderedRows(t){const e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}isRowAfterRenderedRows(t){return t>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(t){const e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}isColumnAfterRenderedColumns(t){return this.columnFilter&&t>this.getLastRenderedColumn()}isColumnAfterViewport(t){return this.columnFilter&&t>this.getLastVisibleColumn()}isRowAfterViewport(t){return this.rowFilter&&t>this.getLastVisibleRow()}isColumnBeforeViewport(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(t){return this.rowUtils.getHeight(t)}getColumnHeaderHeight(t){return this.columnUtils.getHeaderHeight(t)}getColumnWidth(t){return this.columnUtils.getWidth(t)}getStretchedColumnWidth(t){return this.columnUtils.getStretchedColumnWidth(t)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Oe(this.TABLE)}getHeight(){return Pe(this.TABLE)}getTotalWidth(){const t=Oe(this.hider);return 0!==t?t:this.getWidth()}getTotalHeight(){const t=Pe(this.hider);return 0!==t?t:this.getHeight()}isVisible(){return be(this.TABLE)}_modifyRowHeaderWidth(t){let e=ro(t)?t():null;return Array.isArray(e)?(e=[...e],e[e.length-1]=this._correctRowHeaderWidth(e[e.length-1])):e=this._correctRowHeaderWidth(e),e}_correctRowHeaderWidth(t){let e=t;return"number"!==typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}var Ml=Tl;const Hl="stickyRowsTop",xl={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows");return 0===t?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Eo(xl,"MIXIN_NAME",Hl,{writable:!1,enumerable:!1});var kl=xl;const Il="calculatedColumns",Al={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Eo(Al,"MIXIN_NAME",Il,{writable:!1,enumerable:!1});var Ol=Al;class Pl extends Ml{constructor(t,e,o,n){super(t,e,o,n,ml)}}bo(Pl,kl),bo(Pl,Ol);var Nl=Pl;function _l(t,e,o){return e=Ll(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ll(t){var e=Dl(t,"string");return"symbol"==typeof e?e:String(e)}function Dl(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Wl{constructor(t){_l(this,"dataAccessObject",void 0),_l(this,"lastScrolledColumnPos",-1),_l(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}scrollViewport(t,e,o,n,i){const r=this.scrollViewportHorizontally(t.col,o,i),s=this.scrollViewportVertically(t.row,e,n);return r||s}scrollViewportHorizontally(t,e,o){const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n||!Number.isInteger(t)||t<0||t>i)return!1;const r=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn(),l=void 0===e&&void 0===o,{fixedColumnsStart:a,inlineStartOverlay:h}=this.dataAccessObject;if(l&&t<a)return!1;let c=!1;return t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",t),-1===r?c=h.scrollTo(t,l?t>this.lastScrolledColumnPos:e):(l&&(t<r||t>s)||!l)&&(c=h.scrollTo(t,l?t>s:e)),c&&(this.lastScrolledColumnPos=t),c}scrollViewportVertically(t,e,o){const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n||!Number.isInteger(t)||t<0||t>i)return!1;const r=this.getFirstVisibleRow(),s=this.getLastVisibleRow(),l=void 0===e&&void 0===o,{fixedRowsBottom:a,fixedRowsTop:h,topOverlay:c}=this.dataAccessObject;if(l&&(t<h||t>i-a-1))return!1;let u=!1;return t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",t),-1===r?u=c.scrollTo(t,l?t>this.lastScrolledRowPos:o):(l&&(t<r||t>s)||!l)&&(u=c.scrollTo(t,l?t>s:o)),u&&(this.lastScrolledRowPos=t),u}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){const{topOverlay:t,wtTable:e,wtViewport:o,totalRows:n,rootWindow:i}=this.dataAccessObject;let r=e.getLastVisibleRow();if(t.mainTableScrollableElement===i){const s=Se(e.wtRootElement),l=Te(i,i);if(s.top>l){const e=Ne(i);let a=o.getColumnHeaderHeight();for(let o=1;o<=n;o++)if(a+=t.sumCellSizes(o-1,o),s.top+a-l>=e){r=o-2;break}}}return r}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){const{wtSettings:t,inlineStartOverlay:e,wtTable:o,wtViewport:n,totalColumns:i,rootWindow:r}=this.dataAccessObject;let s=o.getLastVisibleColumn();if(e.mainTableScrollableElement===r){const l=t.getSetting("rtlMode");let a=null;if(l){const t=o.TABLE.getBoundingClientRect(),e=this.dataAccessObject.rootWindow.document,n=e.documentElement.offsetWidth;a=Math.abs(t.right-n)}else{const t=Se(o.wtRootElement);a=t.left}const h=Math.abs(Me(r,r));if(a>h){const t=_e(r);let o=n.getRowHeaderWidth();for(let n=1;n<=i;n++)if(o+=e.sumCellSizes(n-1,n),a+o-h>=t){s=n-2;break}}}return s}}var Vl=Wl;function Fl(t,e,o){jl(t,e),e.set(t,o)}function jl(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bl(t,e,o){return e=zl(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function zl(t){var e=Ul(t,"string");return"symbol"==typeof e?e:String(e)}function Ul(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function $l(t,e){var o=Kl(t,e,"get");return Gl(t,o)}function Gl(t,e){return e.get?e.get.call(t):e.value}function Yl(t,e,o){var n=Kl(t,e,"set");return Xl(t,n,o),o}function Kl(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Xl(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var ql=new WeakMap;class Ql{constructor(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Bl(this,"row",null),Bl(this,"col",null),Fl(this,ql,{writable:!0,value:!1}),Yl(this,ql,o),"undefined"!==typeof t&&"undefined"!==typeof e&&(this.row=t,this.col=e)}isValid(t){const{countRows:e,countCols:o,countRowHeaders:n,countColHeaders:i}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...t};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col))&&(!(this.row<-i||this.col<-n)&&!(this.row>=e||this.col>=o))}isEqual(t){return t===this||this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return $l(this,ql)}isSouthEastOf(t){return this.row>=t.row&&($l(this,ql)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&($l(this,ql)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&($l(this,ql)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&($l(this,ql)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(t){return Number.isInteger(null===t||void 0===t?void 0:t.row)&&(this.row=t.row),Number.isInteger(null===t||void 0===t?void 0:t.col)&&(this.col=t.col),t instanceof Ql&&Yl(this,ql,t.isRtl()),this}clone(){return new Ql(this.row,this.col,$l(this,ql))}toObject(){return{row:this.row,col:this.col}}}var Jl=Ql;function Zl(t,e,o){ta(t,e),e.set(t,o)}function ta(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ea(t,e,o){return e=oa(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function oa(t){var e=na(t,"string");return"symbol"==typeof e?e:String(e)}function na(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ia(t,e){var o=la(t,e,"get");return ra(t,o)}function ra(t,e){return e.get?e.get.call(t):e.value}function sa(t,e,o){var n=la(t,e,"set");return aa(t,n,o),o}function la(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function aa(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var ha=new WeakMap;class ca{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];ea(this,"highlight",null),ea(this,"from",null),ea(this,"to",null),Zl(this,ha,{writable:!0,value:!1}),this.highlight=t.clone(),this.from=e.clone(),this.to=o.clone(),sa(this,ha,n)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){const{row:e,col:o}=t,n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return n.row<=e&&i.row>=e&&n.col<=o&&i.col>=o}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopEndCorner().col>=t.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=t.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=t.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=t.getOuterTopStartCorner().col}isOverlappingVertically(t){return this.getOuterBottomStartCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=t.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=t.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=t.getOuterTopRightCorner().row}expand(t){const e=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>o.row||t.col>o.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(o.row,t.row),Math.max(o.col,t.col)),!0)}expandByRange(t){if(this.includesRange(t)||!this.overlaps(t))return!1;const e=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),n=this.getDirection(),i=t.getOuterTopStartCorner(),r=t.getOuterBottomEndCorner(),s=Math.min(e.row,i.row),l=Math.min(e.col,i.col),a=Math.max(o.row,r.row),h=Math.max(o.col,r.col),c=this._createCellCoords(s,l),u=this._createCellCoords(a,h);return this.from=c,this.to=u,this.setDirection(n),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break;default:break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){const t=this.getDirection();switch(t){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}flipDirectionHorizontally(){const t=this.getDirection();switch(t){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ia(this,ha)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ia(this,ha)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ia(this,ha)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ia(this,ha)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ia(this,ha)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ia(this,ha)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ia(this,ha)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ia(this,ha)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t){return t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(t){return t instanceof Jl&&(t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(t){if(!this.includesRange(t))return[];const e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},n=[];return e.top===o.top&&n.push("top"),e.right===o.right&&n.push(ia(this,ha)?"left":"right"),e.bottom===o.bottom&&n.push("bottom"),e.left===o.left&&n.push(ia(this,ha)?"right":"left"),n}getInner(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),o=[];for(let n=t.row;n<=e.row;n++)for(let i=t.col;i<=e.col;i++)this.from.row===n&&this.from.col===i||this.to.row===n&&this.to.col===i||o.push(this._createCellCoords(n,i));return o}getAll(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),o=[];for(let n=t.row;n<=e.row;n++)for(let i=t.col;i<=e.col;i++)t.row===n&&t.col===i?o.push(t):e.row===n&&e.col===i?o.push(e):o.push(this._createCellCoords(n,i));return o}forAll(t){const e=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();for(let n=e.row;n<=o.row;n++)for(let i=e.col;i<=o.col;i++){const e=t(n,i);if(!1===e)return}}clone(){return new ca(this.highlight,this.from,this.to,ia(this,ha))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,e){return new Jl(t,e,ia(this,ha))}}var ua=ca;function da(t,e,o){return e=ga(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ga(t){var e=fa(t,"string");return"symbol"==typeof e?e:String(e)}function fa(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ma{get eventManager(){return new $n(this)}constructor(t,e){da(this,"wtTable",void 0),da(this,"wtScroll",void 0),da(this,"wtViewport",void 0),da(this,"wtOverlays",void 0),da(this,"selectionManager",void 0),da(this,"wtEvent",void 0),da(this,"guid",`wt_${ht()}`),da(this,"drawInterrupted",!1),da(this,"drawn",!1),da(this,"domBindings",void 0),da(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new Vl(this.createScrollDao())}findOriginalHeaders(){const t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;e<o;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,o){ye(o,t[e])}])}}createCellCoords(t,e){return new Jl(t,e,this.wtSettings.getSetting("rtlMode"))}createCellRange(t,e,o){return new ua(t,e,o,this.wtSettings.getSetting("rtlMode"))}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this.wtTable.getCell(t);const o=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),r=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<n&&t.col<r)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<r&&t.row>=o-i){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<r)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);if(t.row<o&&t.row>=o-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}scrollViewport(t,e,o,n,i){return!(t.col<0||t.row<0)&&this.wtScroll.scrollViewport(t,e,o,n,i)}scrollViewportHorizontally(t,e,o){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,o)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selectionManager(){return t.selectionManager},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return t.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return t.wtSettings.getSetting("rowHeaders")}}}}function pa(t,e,o){return e=wa(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function wa(t){var e=va(t,"string");return"symbol"==typeof e?e:String(e)}function va(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ca extends ma{constructor(t,e,o){super(t,e),pa(this,"cloneSource",void 0),pa(this,"cloneOverlay",void 0);const n=this.wtSettings.getSetting("facade",this);this.cloneSource=o.source,this.cloneOverlay=o.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=o.viewport,this.selectionManager=o.selectionManager,this.wtEvent=new zr(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,o.event),this.findOriginalHeaders()}}function ya(t,e,o){return e=ba(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ba(t){var e=Sa(t,"string");return"symbol"==typeof e?e:String(e)}function Sa(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ra{constructor(t,e,o,n,i){ya(this,"wtSettings",null),Eo(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=e,this.wtSettings=n;const{TABLE:r,hider:s,spreader:l,holder:a,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=o,this.mainTableScrollableElement=null,this.TABLE=r,this.hider=s,this.spreader=l,this.holder=a,this.wtRootElement=h,this.trimmingContainer=xe(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const t=this.needFullRender;this.needFullRender=this.shouldBeRendered();const e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=xe(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:t}=this.wot,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=He(t.TABLE)}getRelativeCellPosition(t,e,o){if(!1===this.clone.wtTable.holder.contains(t))return void fn(`The provided element is not a child of the ${this.type} overlay`);const n=this.mainTableScrollableElement===this.domBindings.rootWindow,i=o<this.wtSettings.getSetting("fixedColumnsStart"),r=e<this.wtSettings.getSetting("fixedRowsTop"),s=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,a={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(t),top:t.offsetTop};let c=null;return c=n?this.getRelativeCellPositionWithinWindow(r,i,h,a):this.getRelativeCellPositionWithinHolder(r,s,i,h,a),c}getRelativeStartPosition(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}getRelativeCellPositionWithinWindow(t,e,o,n){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let r=0,s=0;if(e){let t=i.left;this.isRtl()&&(t=this.domBindings.rootWindow.innerWidth-(i.left+i.width+$e())),r=t<=0?-1*t:0}else r=n.start;if(t){const t=this.clone.wtTable.TABLE.getBoundingClientRect();s=t.top-i.top}else s=n.top;return{start:o.start+r,top:o.top+s}}getRelativeCellPositionWithinHolder(t,e,o,n,i){const r={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let s=0,l=0;if(o||(s=r.horizontal-i.start),e){const t=this.wot.wtTable.wtRootElement.getBoundingClientRect(),e=this.clone.wtTable.TABLE.getBoundingClientRect();l=-1*e.top+t.top}else t||(l=r.vertical-i.top);return{start:n.start-s,top:n.top-l}}makeClone(){if(-1===yl.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:t,wtSettings:e}=this.wot,{rootDocument:o,rootWindow:n}=this.domBindings,i=o.createElement("div"),r=o.createElement("table"),s=t.wtRootElement.parentNode;i.className=`${bl.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,e.getSetting("ariaTags")&&fe(i,[pt()]),r.className=t.TABLE.className;const l=t.TABLE.getAttribute("role");l&&r.setAttribute("role",t.TABLE.getAttribute("role")),i.appendChild(r),s.appendChild(i);const a=this.wtSettings.getSetting("preventOverflow");return!0===a||"horizontal"===a&&this.type===ml||"vertical"===a&&this.type===wl?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(s).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=He(t.TABLE),new Ca(r,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}reset(){if(!this.clone)return;const t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,o=t.style,n=e.style,i=t.parentNode.style;A([o,n,i],(t=>{t.width="",t.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}const Ea=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});function Ta(t,e,o){return e=Ma(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ma(t){var e=Ha(t,"string");return"symbol"==typeof e?e:String(e)}function Ha(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class xa extends Ra{constructor(t,e,o,n){super(t,e,ml,o,n),Ta(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new Nl(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode,{rootWindow:e}=this.domBindings,o=this.wtSettings.getSetting("preventOverflow");let n=0,i=!1;if(this.trimmingContainer!==e||o&&"vertical"===o)n=this.getScrollPosition(),qe(t);else{const{wtTable:e}=this.wot,o=e.hider.getBoundingClientRect(),r=Math.ceil(o.bottom),s=t.offsetHeight;i=r===s,n=this.getOverlayOffset(),Ke(t,"0px",`${n}px`)}const r=this.adjustHeaderBordersPosition(n,i);return this.adjustElementsSize(),r}setScrollPosition(t){const e=this.domBindings.rootWindow;let o=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(Ee(e),t),o=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const o=this.wtSettings.getSetting("defaultRowHeight");let n=t,i=0;while(n<e){const t=this.wot.wtTable.getRowHeight(n);i+=void 0===t?o:t,n+=1}return i}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:o}=this.domBindings,n=$e(e),i=this.clone.wtTable.holder.parentNode,r=i.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===s){let e=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=n),e=Math.min(e,t.wtRootElement.scrollWidth),r.width=`${e}px`}else r.width="";this.clone.wtTable.holder.style.width=r.width;let l=Pe(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),r.height=`${l}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(Ea.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+e}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){const{wot:o,wtSettings:n}=this,i=o.cloneSource?o.cloneSource:o,r=i.wtTable.holder;let s=this.getTableParentOffset(),l=0;if(e){const o=this.wot.wtTable.getRowHeight(t),n=this.wot.wtViewport.getViewportHeight();o>n&&(e=!1)}if(e&&r.offsetHeight!==r.clientHeight&&(l=$e(this.domBindings.rootDocument)),e){const e=n.getSetting("fixedRowsBottom"),i=n.getSetting("totalRows");s+=this.sumCellSizes(0,t+1),s-=o.wtViewport.getViewportHeight()-this.sumCellSizes(i-e,i),s+=1}else s+=this.sumCellSizes(n.getSetting("fixedRowsTop"),t);return s+=l,this.setScrollPosition(s)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Te(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),n=t-e;o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),o>n&&(o=0)}return o}adjustHeaderBordersPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("totalColumns");n?ge(o,"emptyColumns"):de(o,"emptyColumns");let i=!1;if(!e){const e=this.wtSettings.getSetting("fixedRowsTop"),n=this.cachedFixedRowsTop!==e,r=this.wtSettings.getSetting("columnHeaders");if((n||0===e)&&r.length>0){const e=ue(o,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?(de(o,"innerBorderTop"),i=!e):(ge(o,"innerBorderTop"),i=e)}}return i}}const ka="stickyRowsBottom",Ia={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),o=t-e;return 0===t||0===e?-1:o<0?0:o},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Eo(Ia,"MIXIN_NAME",ka,{writable:!1,enumerable:!1});var Aa=Ia;class Oa extends Ml{constructor(t,e,o,n){super(t,e,o,n,pl)}}bo(Oa,Aa),bo(Oa,Ol);var Pa=Oa;function Na(t,e,o){return e=_a(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function _a(t){var e=La(t,"string");return"symbol"==typeof e?e:String(e)}function La(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Da extends Ra{constructor(t,e,o,n){super(t,e,pl,o,n),Na(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new Pa(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,e=this.clone.wtTable.holder.parentNode;e.style.top="";let o=0;const n=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||n&&"vertical"===n?(o=this.getScrollPosition(),this.repositionOverlay()):(o=this.getOverlayOffset(),e.style.bottom=`${o}px`);const i=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let i=0;e.hasVerticalScroll()||(i+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(i+=$e(o)),n.style.bottom=`${i}px`}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let o=!1;return this.mainTableScrollableElement===e?(e.scrollTo(Ee(e),t),o=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const{wtTable:o,wtSettings:n}=this.wot,i=n.getSetting("defaultRowHeight");let r=t,s=0;while(r<e){const t=o.getRowHeight(r);s+=void 0===t?i:t,r+=1}return s}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o,rootWindow:n}=this.domBindings,i=$e(o),r=this.clone.wtTable.holder.parentNode,s=r.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===l){let o=e.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(o-=i),o=Math.min(o,t.wtRootElement.scrollWidth),s.width=`${o}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let a=Pe(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(a=0),s.height=`${a}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let o=this.getTableParentOffset();const n=this.wot.cloneSource?this.wot.cloneSource:this.wot,i=n.wtTable.holder;let r=0;e&&i.offsetHeight!==i.clientHeight&&(r=$e(this.domBindings.rootDocument)),e?(o+=this.sumCellSizes(0,t+1),o-=this.wot.wtViewport.getViewportHeight(),o+=1):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),o+=r,this.setScrollPosition(o)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Te(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),n=t-e,i=this.domBindings.rootDocument.documentElement.clientHeight;o=Math.max(this.getTableParentOffset()-this.getScrollPosition()-i+t,0),o>n&&(o=0)}return o}adjustHeaderBordersPosition(t){const e=this.wtSettings.getSetting("fixedRowsBottom"),o=this.cachedFixedRowsBottom!==e,n=this.wtSettings.getSetting("columnHeaders");let i=!1;if((o||0===e)&&n.length>0){const e=this.wot.wtTable.holder.parentNode,o=ue(e,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?(de(e,"innerBorderBottom"),i=!o):(ge(e,"innerBorderBottom"),i=o)}return i}}const Wa="calculatedRows",Va={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Eo(Va,"MIXIN_NAME",Wa,{writable:!1,enumerable:!1});var Fa=Va;const ja="stickyColumnsStart",Ba={getFirstRenderedColumn(){const t=this.wtSettings.getSetting("totalColumns");return 0===t?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Eo(Ba,"MIXIN_NAME",ja,{writable:!1,enumerable:!1});var za=Ba;class Ua extends Ml{constructor(t,e,o,n){super(t,e,o,n,wl)}}bo(Ua,Fa),bo(Ua,za);var $a=Ua;class Ga extends Ra{constructor(t,e,o,n){super(t,e,wl,o,n)}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new $a(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:t}=this.wot;if(!this.needFullRender||!t.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,o=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer!==e||n&&"horizontal"===n?(i=this.getScrollPosition(),qe(o)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),Ke(o,`${i}px`,"0px"));const r=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),r}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let o=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,Re(e)),o=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(t,e){const o=this.wtSettings.getSetting("defaultColumnWidth");let n=t,i=0;while(n<e)i+=this.wot.wtTable.getStretchedColumnWidth(n)||o,n+=1;return i}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:o}=this.domBindings,n=$e(e),i=this.clone.wtTable.holder.parentNode,r=i.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"vertical"===s){let e=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(e-=n),e=Math.min(e,t.wtRootElement.scrollHeight),r.height=`${e}px`}else r.height="";this.clone.wtTable.holder.style.height=r.height;const l=Oe(this.clone.wtTable.TABLE);r.width=`${l}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(Ea.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+e}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[e]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(t,e){let o=this.getTableParentOffset();const n=this.wot.cloneSource?this.wot.cloneSource:this.wot,i=n.wtTable.holder;let r=0;if(e){const o=this.wot.wtTable.getColumnWidth(t),n=this.wot.wtViewport.getViewportWidth();o>n&&(e=!1)}return e&&i.offsetWidth!==i.clientWidth&&(r=$e(this.domBindings.rootDocument)),e?(o+=this.sumCellSizes(0,t+1),o-=this.wot.wtViewport.getViewportWidth()):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),o+=r,this.setScrollPosition(o)}getTableParentOffset(){const t=this.wtSettings.getSetting("preventOverflow");let e=0;return t||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs(Me(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===t&&(!e||"horizontal"!==e)){o=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const t=this.wot.wtTable.getTotalWidth(),e=this.clone.wtTable.getTotalWidth(),n=t-e;o>n&&(o=0)}return o}adjustHeaderBordersPosition(t){const e=this.wot.wtTable.holder.parentNode,o=this.wtSettings.getSetting("rowHeaders"),n=this.wtSettings.getSetting("fixedColumnsStart"),i=this.wtSettings.getSetting("totalRows");i?ge(e,"emptyRows"):de(e,"emptyRows");let r=!1;if(n&&!o.length)de(e,"innerBorderLeft innerBorderInlineStart");else if(!n&&o.length){const o=ue(e,"innerBorderInlineStart");t?(de(e,"innerBorderLeft innerBorderInlineStart"),r=!o):(ge(e,"innerBorderLeft innerBorderInlineStart"),r=o)}return r}}class Ya extends Ml{constructor(t,e,o,n){super(t,e,o,n,vl)}}bo(Ya,kl),bo(Ya,za);var Ka=Ya;function Xa(t,e,o){return e=qa(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function qa(t){var e=Qa(t,"string");return"symbol"==typeof e?e:String(e)}function Qa(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ja extends Ra{constructor(t,e,o,n,i,r){super(t,e,vl,o,n),Xa(this,"topOverlay",void 0),Xa(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=r}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new Ka(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Ke(t,`${e}px`,`${o}px`)}else qe(t);let e=Pe(this.clone.wtTable.TABLE);const o=Oe(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=`${e}px`,t.style.width=`${o}px`,!1}}class Za extends Ml{constructor(t,e,o,n){super(t,e,o,n,Cl)}}bo(Za,Aa),bo(Za,za);var th=Za;class eh extends Ra{constructor(t,e,o,n,i,r){super(t,e,Cl,o,n),this.bottomOverlay=i,this.inlineStartOverlay=r}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new th(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:t}=this;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const t=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]=`${t}px`,e.style.bottom=`${o}px`}else qe(e),this.repositionOverlay();let o=Pe(this.clone.wtTable.TABLE);const n=Oe(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),e.style.height=`${o}px`,e.style.width=`${n}px`,!1}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let i=0;e.hasVerticalScroll()||(i+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(i+=$e(o)),n.style.bottom=`${i}px`}}function oh(t,e,o){return e=nh(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function nh(t){var e=ih(t,"string");return"symbol"==typeof e?e:String(e)}function ih(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class rh{constructor(t,e,o,n,i,r){oh(this,"wot",null),oh(this,"topOverlay",null),oh(this,"bottomOverlay",null),oh(this,"inlineStartOverlay",null),oh(this,"topInlineStartCornerOverlay",null),oh(this,"bottomInlineStartCornerOverlay",null),oh(this,"browserLineHeight",void 0),oh(this,"wtSettings",null),oh(this,"resizeObserver",new ResizeObserver((t=>{Ao((()=>{Array.isArray(t)&&t.length&&this.wtSettings.getSetting("onContainerElementResize")}))}))),this.wot=t,this.wtSettings=n,this.domBindings=o,this.facadeGetter=e,this.wtTable=r;const{rootDocument:s,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=$e(s);const a="hidden"===l.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=a?r.holder:He(r.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&e.push(this.wtTable),e}initBrowserLineHeight(){const{rootWindow:t,rootDocument:e}=this.domBindings,o=t.getComputedStyle(e.body),n=parseInt(o.lineHeight,10),i=1.2*parseInt(o.fontSize,10);this.browserLineHeight=n||i}initOverlays(){const t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new xa(...t),this.bottomOverlay=new Da(...t),this.inlineStartOverlay=new Ga(...t),this.topInlineStartCornerOverlay=new Ja(...t,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new eh(...t,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:t,rootWindow:e}=this.domBindings,{mainTableScrollableElement:o}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(t.documentElement,"keydown",(t=>this.onKeyDown(t))),this.eventManager.addEventListener(t.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(t,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(o,"scroll",(t=>this.onTableScroll(t)),{passive:!0}),o!==n&&this.eventManager.addEventListener(n,"scroll",(t=>this.onTableScroll(t)),{passive:!0});const i=e.devicePixelRatio&&e.devicePixelRatio>1,r=this.scrollableElement===e,s=this.wtSettings.getSetting("preventWheel"),l={passive:r};(s||i||!Bo())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(t=>this.onCloneWheel(t,s)),l);const a=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let h;a.forEach((t=>{if(t&&t.needFullRender){const{holder:e}=t.clone.wtTable;this.eventManager.addEventListener(e,"wheel",(t=>this.onCloneWheel(t,s)),l)}})),this.eventManager.addEventListener(e,"resize",(()=>{clearTimeout(h),h=setTimeout((()=>{this.wtSettings.getSetting("onWindowResize")}),200)})),r||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(t){const e=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,i=t.target;this.keyPressed&&(n!==e&&i!==e&&!t.target.contains(n)||o!==e&&i!==e&&!t.target.contains(o))||this.syncScrollPositions(t)}onCloneWheel(t,e){const{rootWindow:o}=this.domBindings,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,r=t.target,s=i!==o&&r!==o&&!r.contains(i),l=n!==o&&r!==o&&!r.contains(n);if(this.keyPressed&&(s||l))return;const a=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==o&&a)&&t.preventDefault()}onKeyDown(t){this.keyPressed=an(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(t){let e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,o=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(o+=o*this.browserLineHeight,e+=e*this.browserLineHeight);const n=this.scrollVertically(e),i=this.scrollHorizontally(o);return n||i}scrollVertically(t){const e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}scrollHorizontally(t){const e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:t}=this.domBindings,e=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,[n,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=e.scrollLeft!==n||this.lastScrollX!==t.scrollX,this.verticalScrolling=o.scrollTop!==i||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=n;const t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=n)}this.verticalScrolling&&(o.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){const t=this.topOverlay.mainTableScrollableElement,{scrollLeft:e,scrollTop:o}=t;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:t}=this,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=He(t.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.updateLastSpreaderSize();e&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}updateLastSpreaderSize(){const t=this.wtTable.spreader,e=t.clientWidth,o=t.clientHeight,n=e!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return n&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=o),n}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtViewport:e}=this.wot,{wtTable:o}=this,n=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),r=e.getRowHeaderWidth(),s=e.getColumnHeaderHeight(),l=o.hider.style;if(l.width=`${r+this.inlineStartOverlay.sumCellSizes(0,n)}px`,l.height=`${s+this.topOverlay.sumCellSizes(0,i)+1}px`,this.scrollbarSize>0){const{scrollHeight:t,scrollWidth:e}=o.wtRootElement,{scrollHeight:n,scrollWidth:i}=o.holder;this.hasScrollbarRight=t<n,this.hasScrollbarBottom=e<i,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>e?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>t&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;const e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let o=null;return A(e,(e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(o=e.clone)})),o}syncOverlayTableClassNames(){const t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];A(e,(e=>{e&&(e.clone.wtTable.TABLE.className=t.className)}))}}var sh=rh;function lh(t,e,o){return e=ah(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ah(t){var e=hh(t,"string");return"symbol"==typeof e?e:String(e)}function hh(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ch{constructor(t){lh(this,"settings",{}),lh(this,"defaults",Object.freeze(this.getDefaults())),To(this.defaults,((e,o)=>{if(void 0!==t[o])this.settings[o]=t[o];else{if(void 0===e)throw new Error(`A required setting "${o}" was not provided`);this.settings[o]=e}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(t,e,o)=>{const n=this.getSetting("data",t,e);ye(o,void 0===n||null===n?"":n)},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:t=>t,onBeforeViewportScrollVertically:t=>t,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:t=>t,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:t=>t,onBeforeHighlightingColumnHeader:t=>t,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(t,e){return void 0===e?To(t,((t,e)=>{this.settings[e]=t})):this.settings[t]=e,this}getSetting(t,e,o,n,i){return"function"===typeof this.settings[t]?this.settings[t](e,o,n,i):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}getSettingPure(t){return this.settings[t]}has(t){return!!this.settings[t]}}class uh extends Ml{constructor(t,e,o,n){super(t,e,o,n,"master")}alignOverlaysWithTrimmingContainer(){const t=xe(this.wtRootElement),{rootWindow:e}=this.domBindings;if(t===e){const t=this.wtSettings.getSetting("preventOverflow");t||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const o=t.parentElement,n=ke(t,"height",e),i=ke(t,"overflow",e),r=this.holder.style,{scrollWidth:s,scrollHeight:l}=t;let a=t.offsetWidth,h=t.offsetHeight;const c=["auto","hidden","scroll"];if(o&&c.includes(i)){const n=t.cloneNode(!1);n.style.overflow="auto",n.style.position="absolute",t.nextElementSibling?o.insertBefore(n,t.nextElementSibling):o.appendChild(n);const i=parseInt(Ae(n,e).height,10);o.removeChild(n),0===i&&(h=0)}h=Math.min(h,l),r.height="auto"===n?"auto":`${h}px`,a=Math.min(a,s),r.width=`${a}px`,r.overflow="",this.hasTableHeight="auto"===r.height||h>0,this.hasTableWidth=a>0}this.isTableVisible=be(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject,o="master",n=t.getSetting("columnHeaders"),i=n.length;if(i&&!e.hasOversizedColumnHeadersMarked[o]){const n=t.getSetting("rowHeaders"),r=n.length,s=this.getRenderedColumnsCount();for(let t=0;t<i;t++)for(let e=-1*r;e<s;e++)this.markIfOversizedColumnHeader(e);e.hasOversizedColumnHeadersMarked[o]=!0}}}bo(uh,Fa),bo(uh,Ol);var dh=uh;const gh=1,fh=2;function mh(t,e,o){return e=ph(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ph(t){var e=wh(t,"string");return"symbol"==typeof e?e:String(e)}function wh(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class vh{constructor(t){mh(this,"count",0),mh(this,"startRow",0),mh(this,"endRow",0),mh(this,"startPosition",0),this.count=t.totalRows,this.endRow=this.count-1}}o(7402);function Ch(t,e,o){yh(t,e),e.set(t,o)}function yh(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bh(t,e,o){return e=Sh(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Sh(t){var e=Rh(t,"string");return"symbol"==typeof e?e:String(e)}function Rh(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Eh(t,e){var o=Hh(t,e,"get");return Th(t,o)}function Th(t,e){return e.get?e.get.call(t):e.value}function Mh(t,e,o){var n=Hh(t,e,"set");return xh(t,n,o),o}function Hh(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function xh(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var kh=new WeakMap;class Ih{static get DEFAULT_HEIGHT(){return 23}constructor(t){bh(this,"count",0),bh(this,"startRow",null),bh(this,"endRow",null),bh(this,"startPosition",null),bh(this,"isVisibleInTrimmingContainer",!1),Ch(this,kh,{writable:!0,value:void 0}),Mh(this,kh,t),this.calculate()}calculate(){const{calculationType:t,overrideFn:e,rowHeightFn:o,scrollOffset:n,totalRows:i,viewportHeight:r}=Eh(this,kh),s=Math.max(Eh(this,kh).scrollOffset,0),l=Eh(this,kh).horizontalScrollbarHeight||0;let a=0,h=!0;const c=[];let u,d=0,g=0;for(let w=0;w<i;w++)if(u=o(w),isNaN(u)&&(u=Ih.DEFAULT_HEIGHT),a<=s&&t!==fh&&(this.startRow=w,d=u),a>=s&&a+(t===fh?u:0)<=s+r-l&&(null===this.startRow&&(this.startRow=w,d=u),this.endRow=w),c.push(a),a+=u,g=u,t!==fh&&(this.endRow=w),a>=s+r-l){h=!1;break}const f=n+r-l,m=t===fh?d:0,p=t===fh?0:g;if(f<m||n>c.at(-1)+p?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===i-1&&h){this.startRow=this.endRow;while(this.startRow>0){const e=c[this.endRow]+u-c[this.startRow-1];if((e<=r-l||t!==fh)&&(this.startRow-=1),e>=r-l)break}}t===gh&&null!==this.startRow&&e&&e(this),this.startPosition=c[this.startRow],void 0===this.startPosition&&(this.startPosition=null),i<this.endRow&&(this.endRow=i-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function Ah(t,e,o){return e=Oh(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Oh(t){var e=Ph(t,"string");return"symbol"==typeof e?e:String(e)}function Ph(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Nh{constructor(t){Ah(this,"count",0),Ah(this,"startColumn",0),Ah(this,"endColumn",0),Ah(this,"startPosition",0),this.count=t.totalColumns,this.endColumn=this.count-1}}function _h(t,e,o){Lh(t,e),e.set(t,o)}function Lh(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dh(t,e,o){return e=Wh(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Wh(t){var e=Vh(t,"string");return"symbol"==typeof e?e:String(e)}function Vh(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Fh(t,e){var o=zh(t,e,"get");return jh(t,o)}function jh(t,e){return e.get?e.get.call(t):e.value}function Bh(t,e,o){var n=zh(t,e,"set");return Uh(t,n,o),o}function zh(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Uh(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var $h=new WeakMap;class Gh{static get DEFAULT_WIDTH(){return 50}constructor(t){Dh(this,"count",0),Dh(this,"startColumn",null),Dh(this,"endColumn",null),Dh(this,"startPosition",null),Dh(this,"isVisibleInTrimmingContainer",!1),_h(this,$h,{writable:!0,value:void 0}),Bh(this,$h,t),this.calculate()}calculate(){const{calculationType:t,overrideFn:e,scrollOffset:o,totalColumns:n,viewportWidth:i}=Fh(this,$h),r=Math.max(Fh(this,$h).scrollOffset,0),s=r>0?i+1:i;let l=0,a=!0;const h=[];let c,u=0,d=0;for(let p=0;p<n;p++)if(c=this._getColumnWidth(p),l<=r&&t!==fh&&(this.startColumn=p,u=c),l>=r&&l+(t===fh?c:0)<=r+s&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=p,u=c),this.endColumn=p),h.push(l),l+=c,d=c,t!==fh&&(this.endColumn=p),l>=r+i){a=!1;break}const g=o+i-s,f=t===fh?0:d,m=t===fh?u:0;if(g<-1*Fh(this,$h).inlineStartOffset||o>h.at(-1)+f||-1*Fh(this,$h).scrollOffset-Fh(this,$h).viewportWidth>-1*m?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===n-1&&a){this.startColumn=this.endColumn;while(this.startColumn>0){const e=h[this.endColumn]+c-h[this.startColumn-1];if((e<=i||t!==fh)&&(this.startColumn-=1),e>i)break}}t===gh&&null!==this.startColumn&&e&&e(this),this.startPosition=h[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),n<this.endColumn&&(this.endColumn=n-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}_getColumnWidth(t){let e=Fh(this,$h).columnWidthFn(t);return isNaN(e)&&(e=Gh.DEFAULT_WIDTH),e}}class Yh{constructor(t,e,o,n,i){this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=o,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=n,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer;let o=0;if(e===this.domBindings.rootWindow)o=t.documentElement.clientHeight;else{const t=Pe(e);o=t>0&&e.clientHeight>0?e.clientHeight:1/0}return o}getWorkspaceWidth(){const{wtSettings:t}=this,{rootDocument:e,rootWindow:o}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=e.documentElement.offsetWidth,r=t.getSetting("totalColumns"),s=t.getSetting("preventOverflow"),l=t.getSetting("rtlMode"),a=this.wtTable.TABLE.getBoundingClientRect(),h=l?a.right-i:a.left,c=i-h;let u,d;if(s)return Oe(this.wtTable.wtRootElement);if(u=t.getSetting("freezeOverlays")?Math.min(c,i):Math.min(this.getContainerFillWidth(),c,i),n===o&&r>0&&this.sumColumnWidths(0,r-1)>u)return e.documentElement.clientWidth;if(n!==o&&(d=ke(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),"scroll"===d||"hidden"===d||"auto"===d))return Math.max(u,n.clientWidth);const g=t.getSetting("stretchH");return"none"!==g&&g?u:Math.max(u,Oe(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(t,e){let o=0,n=t;while(n<e)o+=this.wtTable.getColumnWidth(n),n+=1;return o}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);const o=e.offsetWidth;return this.containerWidth=o,t.removeChild(e),o}getWorkspaceOffset(){return Se(this.wtTable.TABLE)}getColumnHeaderHeight(){const t=this.wtSettings.getSetting("columnHeaders");return t.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Pe(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let t=this.getWorkspaceHeight();if(t===1/0)return t;const e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}getRowHeaderWidth(){const t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(let o=0,n=e.length;o<n;o++)this.rowHeaderWidth+=t[o]||t}if(isNaN(this.rowHeaderWidth))if(e.length){let t=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let o=0,n=e.length;o<n;o++)t?(this.rowHeaderWidth+=Oe(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const t=this.getWorkspaceWidth();if(t===1/0)return t;const e=this.getRowHeaderWidth();return e>0?t-e:t}createRowsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gh;const{wtSettings:e,wtTable:o}=this;if(e.getSetting("renderAllRows")&&t===gh)return new vh({totalRows:e.getSetting("totalRows")});let n,i,r=this.getViewportHeight();this.rowHeaderWidth=NaN;let s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=e.getSetting("fixedRowsTop"),a=e.getSetting("fixedRowsBottom"),h=e.getSetting("totalRows");return l&&s>=0&&(i=this.dataAccessObject.topOverlay.sumCellSizes(0,l),s+=i,r-=i),a&&this.dataAccessObject.bottomOverlay.clone&&(i=this.dataAccessObject.bottomOverlay.sumCellSizes(h-a,h),r-=i),n=o.holder.clientHeight===o.holder.offsetHeight?0:$e(this.domBindings.rootDocument),new Ih({viewportHeight:r,scrollOffset:s,totalRows:e.getSetting("totalRows"),rowHeightFn:t=>o.getRowHeight(t),overrideFn:e.getSettingPure("viewportRowCalculatorOverride"),calculationType:t,horizontalScrollbarHeight:n})}createColumnsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gh;const{wtSettings:e,wtTable:o}=this;if(e.getSetting("renderAllColumns")&&t===gh)return new Nh({totalColumns:e.getSetting("totalColumns")});let n=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const r=e.getSetting("fixedColumnsStart");if(r&&i>=0){const t=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,r);i+=t,n-=t}return o.holder.clientWidth!==o.holder.offsetWidth&&(n-=$e(this.domBindings.rootDocument)),new Gh({viewportWidth:n,scrollOffset:i,totalColumns:e.getSetting("totalColumns"),columnWidthFn:t=>o.getColumnWidth(t),overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this;if(t&&!e.getSetting("renderAllRows")){const e=this.createRowsCalculator(fh);t=this.areAllProposedVisibleRowsAlreadyRendered(e)}if(t&&!e.getSetting("renderAllColumns")){const e=this.createColumnsCalculator(fh);t=this.areAllProposedVisibleColumnsAlreadyRendered(e)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(gh),this.columnsRenderCalculator=this.createColumnsCalculator(gh)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(fh),this.columnsVisibleCalculator=this.createColumnsCalculator(fh)}areAllProposedVisibleRowsAlreadyRendered(t){if(!this.rowsVisibleCalculator)return!1;const{startRow:e,endRow:o,isVisibleInTrimmingContainer:n}=t;if(null===e&&null===o)return!n;const{startRow:i,endRow:r}=this.rowsRenderCalculator;return!(e<i||e===i&&e>0)&&!(o>r||o===r&&o<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(t){if(!this.columnsVisibleCalculator)return!1;const{startColumn:e,endColumn:o,isVisibleInTrimmingContainer:n}=t;if(null===e&&null===o)return!n;const{startColumn:i,endColumn:r}=this.columnsRenderCalculator;return!(e<i||e===i&&e>0)&&!(o>r||o===r&&o<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){To(this.hasOversizedColumnHeadersMarked,((t,e,o)=>{o[e]=void 0}))}}var Kh=Yh;o(4244);function Xh(t,e){Qh(t,e),e.add(t)}function qh(t,e,o){Qh(t,e),e.set(t,o)}function Qh(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jh(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function Zh(t,e){var o=oc(t,e,"get");return tc(t,o)}function tc(t,e){return e.get?e.get.call(t):e.value}function ec(t,e,o){var n=oc(t,e,"set");return nc(t,n,o),o}function oc(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function nc(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var ic=new WeakMap,rc=new WeakMap,sc=new WeakSet;class lc{constructor(){Xh(this,sc),qh(this,ic,{writable:!0,value:void 0}),qh(this,rc,{writable:!0,value:void 0})}setActiveOverlay(t){return ec(this,rc,t),this}setActiveSelection(t){return ec(this,ic,t),this}scan(){const t=Zh(this,ic).settings.selectionType,e=new Set;return"active-header"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t)))):"area"===t?this.scanCellsRange((t=>e.add(t))):"focus"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t))),this.scanCellsRange((t=>e.add(t)))):"fill"===t?this.scanCellsRange((t=>e.add(t))):"header"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t)))):"row"===t?(this.scanRowsInHeadersRange((t=>e.add(t))),this.scanRowsInCellsRange((t=>e.add(t)))):"column"===t&&(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanColumnsInCellsRange((t=>e.add(t)))),e}scanColumnsInHeadersRange(t){const[e,o,n,i]=Zh(this,ic).getCorners(),{wtTable:r}=Zh(this,rc),s=r.getRenderedColumnsCount(),l=r.getColumnHeadersCount();let a=0;for(let h=-r.getRowHeadersCount();h<s;h++){const s=r.columnFilter.renderedToSource(h);if(!(s<o||s>i)){for(let h=-l;h<0;h++){if(h<e||h>n)continue;const c=h+l;let u=r.getColumnHeader(s,c);const d=Zh(this,rc).getSetting("onBeforeHighlightingColumnHeader",s,c,{selectionType:Zh(this,ic).settings.selectionType,columnCursor:a,selectionWidth:i-o+1});null!==d&&(d!==s&&(u=r.getColumnHeader(d,c)),t(u))}a+=1}}}scanRowsInHeadersRange(t){const[e,o,n,i]=Zh(this,ic).getCorners(),{wtTable:r}=Zh(this,rc),s=r.getRenderedRowsCount(),l=r.getRowHeadersCount();let a=0;for(let h=-r.getColumnHeadersCount();h<s;h++){const s=r.rowFilter.renderedToSource(h);if(!(s<e||s>n)){for(let h=-l;h<0;h++){if(h<o||h>i)continue;const c=h+l;let u=r.getRowHeader(s,c);const d=Zh(this,rc).getSetting("onBeforeHighlightingRowHeader",s,c,{selectionType:Zh(this,ic).settings.selectionType,rowCursor:a,selectionHeight:n-e+1});null!==d&&(d!==s&&(u=r.getRowHeader(d,c)),t(u))}a+=1}}}scanCellsRange(t){const[e,o,n,i]=Zh(this,ic).getCorners(),{wtTable:r}=Zh(this,rc);Jh(this,sc,ac).call(this,((s,l)=>{if(s>=e&&s<=n&&l>=o&&l<=i){const e=r.getCell(Zh(this,rc).createCellCoords(s,l)),o=Zh(this,rc).getSetting("onAfterDrawSelection",s,l,Zh(this,ic).settings.layerLevel);"string"===typeof o&&de(e,o),t(e)}}))}scanRowsInCellsRange(t){const[e,,o]=Zh(this,ic).getCorners(),{wtTable:n}=Zh(this,rc);Jh(this,sc,ac).call(this,((i,r)=>{if(i>=e&&i<=o){const e=n.getCell(Zh(this,rc).createCellCoords(i,r));t(e)}}))}scanColumnsInCellsRange(t){const[,e,,o]=Zh(this,ic).getCorners(),{wtTable:n}=Zh(this,rc);Jh(this,sc,ac).call(this,((i,r)=>{if(r>=e&&r<=o){const e=n.getCell(Zh(this,rc).createCellCoords(i,r));t(e)}}))}}function ac(t){const{wtTable:e}=Zh(this,rc),o=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<o;i+=1){const o=e.rowFilter.renderedToSource(i);for(let i=0;i<n;i+=1)t(o,e.columnFilter.renderedToSource(i))}}class hc{constructor(t,e){e&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Ea,this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners())}registerListeners(){const t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp()));for(let e=0,o=this.main.childNodes.length;e<o;e++){const t=this.main.childNodes[e];this.eventManager.addEventListener(t,"mouseenter",(t=>this.onMouseEnter(t,this.main.childNodes[e])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(t,e){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),hn(t);const o=this,n=this.wot.rootDocument.body,i=e.getBoundingClientRect();function r(t){return t.clientY<Math.floor(i.top)||(t.clientY>Math.ceil(i.top+i.height)||(t.clientX<Math.floor(i.left)||(t.clientX>Math.ceil(i.left+i.width)||void 0)))}function s(t){r(t)&&(o.eventManager.removeEventListener(n,"mousemove",s),e.style.display="block")}e.style.display="none",this.eventManager.addEventListener(n,"mousemove",s)}createBorders(t){const{rootDocument:e}=this.wot;this.main=e.createElement("div");const o=["top","start","bottom","end","corner"];let n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(let s=0;s<5;s++){const i=o[s],r=e.createElement("div");r.className=`wtBorder ${this.settings.className||""}`,this.settings[i]&&this.settings[i].hide&&(r.className+=" hidden"),n=r.style,n.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:t.border.color,n.height=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${t.border.width}px`,n.width=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${t.border.width}px`,this.main.appendChild(r)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Xo()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let r=i.bordersHolder;r||(r=e.createElement("div"),r.className="htBorders",i.bordersHolder=r,i.spreader.appendChild(r)),r.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:t}=this.wot;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")};const e=10,o=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const n={position:"absolute",height:`${o}px`,width:`${o}px`,"border-radius":`${parseInt(o/1.5,10)}px`};To(n,((t,e)=>{this.selectionHandles.styles.bottomHitArea[e]=t,this.selectionHandles.styles.topHitArea[e]=t}));const i={position:"absolute",height:`${e}px`,width:`${e}px`,"border-radius":`${parseInt(e/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};To(i,((t,e)=>{this.selectionHandles.styles.bottom[e]=t,this.selectionHandles.styles.top[e]=t})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(t,e){const o=this.wot.selectionManager.getAreaSelection();return!(!o.cellRange||t===o.cellRange.to.row&&e===o.cellRange.to.col)}updateMultipleSelectionHandlesPosition(t,e,o,n,i,r){const s=this.wot.wtSettings.getSetting("rtlMode"),l=s?"right":"left",{top:a,topHitArea:h,bottom:c,bottomHitArea:u}=this.selectionHandles.styles,d=parseInt(a.borderWidth,10),g=parseInt(a.width,10),f=parseInt(h.width,10),m=this.wot.wtTable.getWidth(),p=this.wot.wtTable.getHeight();a.top=`${parseInt(o-g-1,10)}px`,a[l]=`${parseInt(n-g-1,10)}px`,h.top=`${parseInt(o-f/4*3,10)}px`,h[l]=`${parseInt(n-f/4*3,10)}px`;const w=Math.min(parseInt(n+i,10),m-g-2*d),v=Math.min(parseInt(n+i-f/4,10),m-f-2*d);c[l]=`${w}px`,u[l]=`${v}px`;const C=Math.min(parseInt(o+r,10),p-g-2*d),y=Math.min(parseInt(o+r-f/4,10),p-f-2*d);c.top=`${C}px`,u.top=`${y}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",h.display="block",this.isPartRange(t,e)?(c.display="none",u.display="none"):(c.display="block",u.display="block")):(a.display="none",c.display="none",h.display="none",u.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",h.zIndex="9999"):(a.zIndex="",h.zIndex="")}appear(t){if(this.disabled)return;const{wtTable:e,rootDocument:o,rootWindow:n}=this.wot;let i,r,s,l,a,h;const c=e.getRenderedRowsCount();for(let P=0;P<c;P+=1){const o=e.rowFilter.renderedToSource(P);if(o>=t[0]&&o<=t[2]){i=o,a=t[0];break}}for(let P=c-1;P>=0;P-=1){const o=e.rowFilter.renderedToSource(P);if(o>=t[0]&&o<=t[2]){r=o;break}}const u=e.getRenderedColumnsCount();for(let P=0;P<u;P+=1){const o=e.columnFilter.renderedToSource(P);if(o>=t[1]&&o<=t[3]){s=o,h=t[1];break}}for(let P=u-1;P>=0;P-=1){const o=e.columnFilter.renderedToSource(P);if(o>=t[1]&&o<=t[3]){l=o;break}}if(void 0===i||void 0===s)return void this.disappear();let d=e.getCell(this.wot.createCellCoords(i,s));const g=i!==r||s!==l,f=g?e.getCell(this.wot.createCellCoords(r,l)):d,m=Se(d),p=g?Se(f):m,w=Se(e.TABLE),v=Oe(e.TABLE),C=m.top,y=m.left,b=this.wot.wtSettings.getSetting("rtlMode");let S=0,R=0;if(b){const t=Oe(d),e=n.innerWidth-w.left-v;R=y+t-p.left,S=n.innerWidth-y-t-e-1}else R=p.left+Oe(f)-y,S=y-w.left-1;if(this.isEntireColumnSelected(i,r)){const t=this.getDimensionsFromHeader("columns",s,l,a,w);let e=null;t&&([e,S,R]=t),e&&(d=e)}let E=C-w.top-1,T=p.top+Pe(f)-C;if(this.isEntireRowSelected(s,l)){const t=this.getDimensionsFromHeader("rows",i,r,h,w);let e=null;t&&([e,E,T]=t),e&&(d=e)}const M=Ae(d,n);parseInt(M.borderTopWidth,10)>0&&(E+=1,T=T>0?T-1:0),parseInt(M[b?"borderRightWidth":"borderLeftWidth"],10)>0&&(S+=1,R=R>0?R-1:0);const H=b?"right":"left";this.topStyle.top=`${E}px`,this.topStyle[H]=`${S}px`,this.topStyle.width=`${R}px`,this.topStyle.display="block",this.startStyle.top=`${E}px`,this.startStyle[H]=`${S}px`,this.startStyle.height=`${T}px`,this.startStyle.display="block";const x=Math.floor(this.settings.border.width/2);this.bottomStyle.top=E+T-x+"px",this.bottomStyle[H]=`${S}px`,this.bottomStyle.width=`${R}px`,this.bottomStyle.display="block",this.endStyle.top=`${E}px`,this.endStyle[H]=S+R-x+"px",this.endStyle.height=`${T+1}px`,this.endStyle.display="block";let k=this.settings.border.cornerVisible;k="function"===typeof k?k(this.settings.layerLevel):k;const I=this.wot.getSetting("onModifyGetCellCoords",r,l);let[A,O]=[r,l];if(I&&Array.isArray(I)&&([,,A,O]=I),Xo()||!k||this.isPartRange(A,O))this.cornerStyle.display="none";else{this.cornerStyle.top=E+T+this.cornerCenterPointOffset-1+"px",this.cornerStyle[H]=S+R+this.cornerCenterPointOffset-1+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let t=xe(e.TABLE);const i=t===n;i&&(t=o.documentElement);const s=parseInt(this.cornerDefaultStyle.width,10)/2,a=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const e=i?f.getBoundingClientRect().left:f.offsetLeft;let o=!1,n=0;b?(n=e-parseInt(this.cornerDefaultStyle.width,10)/2,o=n<0):(n=e+Oe(f)+parseInt(this.cornerDefaultStyle.width,10)/2,o=n>=_e(t)),o&&(this.cornerStyle[H]=`${Math.floor(S+R+this.cornerCenterPointOffset-s)}px`,this.cornerStyle[b?"borderLeftWidth":"borderRightWidth"]=0)}if(r===this.wot.getSetting("totalRows")-1){const e=i?f.getBoundingClientRect().top:f.offsetTop,o=e+Pe(f)+parseInt(this.cornerDefaultStyle.height,10)/2,n=o>=Ne(t);n&&(this.cornerStyle.top=`${Math.floor(E+T+this.cornerCenterPointOffset-a)}px`,this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Xo()&&this.updateMultipleSelectionHandlesPosition(r,l,E,S,R,T)}isEntireColumnSelected(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(t,e,o,n,i){const{wtTable:r}=this.wot,s=r.wtRootElement.parentNode;let l=null,a=null,h=null,c=null,u=null,d=null,g=null,f=null;switch(t){case"rows":l=function(){return r.getRowHeader(...arguments)},a=function(){return Pe(...arguments)},h="ht__selection--rows",d="top";break;case"columns":l=function(){return r.getColumnHeader(...arguments)},a=function(){return Oe(...arguments)},h="ht__selection--columns",d="left";break;default:}if(s.classList.contains(h)){const t=this.wot.getSetting("columnHeaders").length;if(g=l(e,t-n),f=l(o,t-n),!g||!f)return!1;const r=Se(g),s=Se(f);return g&&f&&(c=r[d]-i[d]-1,u=s[d]+a(f)-r[d]),[g,c,u]}return!1}changeBorderStyle(t,e){const o=this[t].style,n=e[t];!n||n.hide?de(this[t],"hidden"):(ue(this[t],"hidden")&&ge(this[t],"hidden"),o.backgroundColor=n.color,"top"!==t&&"bottom"!==t||(o.height=`${n.width}px`),"start"!==t&&"end"!==t||(o.width=`${n.width}px`))}changeBorderToDefaultStyle(t){const e={width:1,color:"#000"},o=this[t].style;o.backgroundColor=e.color,o.width=`${e.width}px`,o.height=`${e.width}px`}toggleHiddenClass(t,e){this.changeBorderToDefaultStyle(t),e?de(this[t],"hidden"):ge(this[t],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Xo()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}var cc=hc;function uc(t,e){gc(t,e),e.add(t)}function dc(t,e,o){gc(t,e),e.set(t,o)}function gc(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fc(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function mc(t,e){var o=vc(t,e,"get");return pc(t,o)}function pc(t,e){return e.get?e.get.call(t):e.value}function wc(t,e,o){var n=vc(t,e,"set");return Cc(t,n,o),o}function vc(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Cc(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var yc=new WeakMap,bc=new WeakMap,Sc=new WeakMap,Rc=new WeakMap,Ec=new WeakMap,Tc=new WeakMap,Mc=new WeakSet;class Hc{constructor(t){uc(this,Mc),dc(this,yc,{writable:!0,value:void 0}),dc(this,bc,{writable:!0,value:void 0}),dc(this,Sc,{writable:!0,value:new lc}),dc(this,Rc,{writable:!0,value:new WeakMap}),dc(this,Ec,{writable:!0,value:new WeakSet}),dc(this,Tc,{writable:!0,value:new Map}),wc(this,bc,t)}setActiveOverlay(t){return wc(this,yc,t),mc(this,Sc).setActiveOverlay(mc(this,yc)),mc(this,Rc).has(mc(this,yc))||mc(this,Rc).set(mc(this,yc),new Set),this}getFocusSelection(){return null!==mc(this,bc)?mc(this,bc).getFocus():null}getAreaSelection(){return null!==mc(this,bc)?mc(this,bc).createLayeredArea():null}getBorderInstance(t){if(!t.settings.border)return null;if(mc(this,Tc).has(t)){const e=mc(this,Tc).get(t);if(e.has(mc(this,yc)))return e.get(mc(this,yc));const o=new cc(mc(this,yc),t.settings);return e.set(mc(this,yc),o),o}const e=new cc(mc(this,yc),t.settings);return mc(this,Tc).set(t,new Map([[mc(this,yc),e]])),e}getBorderInstances(t){var e,o;return Array.from(null!==(e=null===(o=mc(this,Tc).get(t))||void 0===o?void 0:o.values())&&void 0!==e?e:[])}destroyBorders(t){mc(this,Tc).get(t).forEach((t=>t.destroy())),mc(this,Tc).delete(t)}render(t){if(null===mc(this,bc))return;t&&fc(this,Mc,xc).call(this);const e=Array.from(mc(this,bc)),o=new Map,n=new Map;for(let i=0;i<e.length;i++){const t=e[i],{className:r,headerAttributes:s,createLayers:l,selectionType:a}=t.settings;mc(this,Ec).has(t)||(mc(this,Ec).add(t),t.addLocalHook("destroy",(()=>this.destroyBorders(t))));const h=this.getBorderInstance(t);if(t.isEmpty()){null===h||void 0===h||h.disappear();continue}if(r){const e=mc(this,Sc).setActiveSelection(t).scan();e.forEach((t=>{if(o.has(t)){const e=o.get(t);e.has(r)&&!0===l?e.set(r,e.get(r)+1):e.set(r,1)}else o.set(t,new Map([[r,1]]));s&&(n.has(t)||n.set(t,[]),"TH"===t.nodeName&&n.get(t).push(...s))}))}const c=t.getCorners();mc(this,yc).getSetting("onBeforeDrawBorders",c,a),null===h||void 0===h||h.appear(c)}o.forEach(((t,e)=>{var o;const n=Array.from(t).map((t=>{let[e,o]=t;return 1===o?e:[e,...Array.from({length:o-1},((t,o)=>`${e}-${o+1}`))]})).flat();n.forEach((t=>mc(this,Rc).get(mc(this,yc)).add(t))),de(e,n),"TD"===e.nodeName&&Array.isArray(null===(o=mc(this,bc).options)||void 0===o?void 0:o.cellAttributes)&&fe(e,mc(this,bc).options.cellAttributes)})),Array.from(n.keys()).forEach((t=>{fe(t,[...n.get(t)])}))}}function xc(){const t=mc(this,Rc).get(mc(this,yc)),e=mc(this,yc).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let o=0;o<e.length;o++)t.add(e[o]);t.forEach((t=>{var e,o;const n=mc(this,yc).wtTable.TABLE.querySelectorAll(`.${t}`);let i=[];Array.isArray(null===(e=mc(this,bc).options)||void 0===e?void 0:e.cellAttributes)&&(i=mc(this,bc).options.cellAttributes.map((t=>t[0]))),Array.isArray(null===(o=mc(this,bc).options)||void 0===o?void 0:o.headerAttributes)&&(i=[...i,...mc(this,bc).options.headerAttributes.map((t=>t[0]))]);for(let r=0,s=n.length;r<s;r++)ge(n[r],t),me(n[r],i)})),t.clear()}class kc extends ma{constructor(t,e){super(t,new ch(e));const o=this.wtSettings.getSetting("facade",this);this.wtTable=new dh(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=new Kh(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Hc(this.wtSettings.getSetting("selections")),this.wtEvent=new zr(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new sh(this,o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const t={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},e=[],o=[];To(t,((t,n)=>{this.wtSettings.getSetting(n).length&&o.push(t),e.push(t)})),ge(this.wtTable.wtRootElement.parentNode,e),de(this.wtTable.wtRootElement.parentNode,o)}getViewportDao(){const t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}class Ic{constructor(t){t instanceof ma?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=t=>{const e=new Ic(t);return()=>e},this._wot=new kc(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}createCellCoords(t,e){return this._wot.createCellCoords(t,e)}createCellRange(t,e,o){return this._wot.createCellRange(t,e,o)}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}scrollViewport(t,e,o,n,i){return this._wot.scrollViewport(t,e,o,n,i)}scrollViewportHorizontally(t,e,o){return this._wot.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return this._wot.scrollViewportVertically(t,e,o)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,e){return this._wot.wtSettings.update(t,e),this}getSetting(t,e,o,n,i){return this._wot.wtSettings.getSetting(t,e,o,n,i)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}}function Ac(t){let{isShiftKey:e,isLeftClick:o,isRightClick:n,coords:i,selection:r,controller:s,cellCoordsFactory:l}=t;const a=r.isSelected()?r.getSelectedRange().current():null,h=r.isSelectedByCorner(),c=r.isSelectedByRowHeader();if(e&&a)i.row>=0&&i.col>=0&&!s.cell?r.setRangeEnd(i):(h||c)&&i.row>=0&&i.col>=0&&!s.cell?r.setRangeEnd(l(i.row,i.col)):h&&i.row<0&&!s.column?r.setRangeEnd(l(a.to.row,i.col)):c&&i.col<0&&!s.row?r.setRangeEnd(l(i.row,a.to.col)):(!h&&!c&&i.col<0||h&&i.col<0)&&!s.row?r.selectRows(Math.max(a.from.row,0),i.row,i.col):(!h&&!c&&i.row<0||c&&i.row<0)&&!s.column&&r.selectColumns(Math.max(a.from.col,0),i.col,i.row);else{const t=!r.inInSelection(i),e=o||n&&t;i.row<0&&i.col>=0&&!s.column?e&&r.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?e&&r.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?e&&r.setRangeStart(i):i.col<0&&i.row<0&&r.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function Oc(t){let{isLeftClick:e,coords:o,selection:n,controller:i,cellCoordsFactory:r}=t;if(!e)return;const s=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),a=n.tableProps.countCols(),h=n.tableProps.countRows();l&&!i.column?n.setRangeEnd(r(h-1,o.col)):s&&!i.row?n.setRangeEnd(r(o.row,a-1)):i.cell||n.setRangeEnd(o)}const Pc=new Map([["mousedown",Ac],["mouseover",Oc],["touchstart",Ac]]);function Nc(t,e){let{coords:o,selection:n,controller:i,cellCoordsFactory:r}=e;Pc.get(t.type)({coords:o,selection:n,controller:i,cellCoordsFactory:r,isShiftKey:t.shiftKey,isLeftClick:dn(t)||"touchstart"===t.type,isRightClick:un(t)})}const _c=new WeakMap,Lc=Symbol("rootInstance");function Dc(t){_c.set(t,!0)}function Wc(t){return t===Lc}function Vc(t){return _c.has(t)}function Fc(t,e){Bc(t,e),e.add(t)}function jc(t,e,o){Bc(t,e),e.set(t,o)}function Bc(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zc(t,e,o){return e=Uc(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Uc(t){var e=$c(t,"string");return"symbol"==typeof e?e:String(e)}function $c(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Gc(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function Yc(t,e){var o=qc(t,e,"get");return Kc(t,o)}function Kc(t,e){return e.get?e.get.call(t):e.value}function Xc(t,e,o){var n=qc(t,e,"set");return Qc(t,n,o),o}function qc(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Qc(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var Jc=new WeakMap,Zc=new WeakMap,tu=new WeakMap,eu=new WeakMap,ou=new WeakMap,nu=new WeakMap,iu=new WeakMap,ru=new WeakSet,su=new WeakSet;class lu{constructor(t){Fc(this,su),Fc(this,ru),zc(this,"hot",void 0),zc(this,"eventManager",void 0),zc(this,"settings",void 0),zc(this,"THEAD",void 0),zc(this,"TBODY",void 0),zc(this,"_wt",void 0),zc(this,"activeWt",void 0),jc(this,Jc,{writable:!0,value:0}),jc(this,Zc,{writable:!0,value:0}),zc(this,"postponedAdjustElementsSize",!1),jc(this,tu,{writable:!0,value:!1}),jc(this,eu,{writable:!0,value:void 0}),jc(this,ou,{writable:!0,value:void 0}),jc(this,nu,{writable:!0,value:0}),jc(this,iu,{writable:!0,value:0}),this.hot=t,this.eventManager=new $n(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}getCellAtCoords(t,e){const o=this._wt.getCell(t,e);return o<0?null:o}scrollViewport(t,e,o,n,i){return this._wt.scrollViewport(t,e,o,n,i)}scrollViewportHorizontally(t,e,o){return this._wt.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return this._wt.scrollViewportVertically(t,e,o)}createElements(){const{rootElement:t,rootDocument:e}=this.hot,o=t.getAttribute("style");o&&t.setAttribute("data-originalstyle",o),de(t,"handsontable"),Xc(this,ou,e.createElement("TABLE")),de(Yc(this,ou),"htCore"),this.hot.getSettings().tableClassName&&de(Yc(this,ou),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(fe(Yc(this,ou),[pt()]),fe(t,[mt(),Lt(-1),Dt(this.hot.countCols()),Nt()])),this.THEAD=e.createElement("THEAD"),Yc(this,ou).appendChild(this.THEAD),this.TBODY=e.createElement("TBODY"),Yc(this,ou).appendChild(this.TBODY),this.hot.table=Yc(this,ou),this.hot.container.insertBefore(Yc(this,ou),this.hot.container.firstChild)}registerEvents(){const{rootElement:t,rootDocument:e,selection:o}=this.hot,n=e.documentElement;this.eventManager.addEventListener(t,"mousedown",(t=>{if(Xc(this,tu,!0),!this.isTextSelectionAllowed(t.target)){const{rootWindow:e}=this.hot;je(e),t.preventDefault(),e.focus()}})),this.eventManager.addEventListener(t,"mouseup",(()=>{Xc(this,tu,!1)})),this.eventManager.addEventListener(t,"mousemove",(t=>{Yc(this,tu)&&!this.isTextSelectionAllowed(t.target)&&(this.settings.fragmentSelection&&je(this.hot.rootWindow),t.preventDefault())})),this.eventManager.addEventListener(n,"keyup",(t=>{o.isInProgress()&&!t.shiftKey&&o.finish()})),this.eventManager.addEventListener(n,"mouseup",(n=>{o.isInProgress()&&dn(n)&&o.finish(),Xc(this,eu,!1);const i=Je(e.activeElement);Qe(e.activeElement)&&!i||!i&&(o.isSelected()||o.isSelectedByAnyHeader()||t.contains(n.target)||un(n))||this.hot.unlisten()})),this.eventManager.addEventListener(n,"contextmenu",(t=>{o.isInProgress()&&un(t)&&(o.finish(),Xc(this,eu,!1))})),this.eventManager.addEventListener(n,"touchend",(()=>{o.isInProgress()&&o.finish(),Xc(this,eu,!1)})),this.eventManager.addEventListener(n,"mousedown",(o=>{const i=o.target,r=o.x||o.clientX,s=o.y||o.clientY;let l=o.target;if(Yc(this,eu)||!t||!this.hot.view)return;const{holder:a}=this.hot.view._wt.wtTable;if(l===a){const t=$e(e);if(e.elementFromPoint(r+t,s)!==a||e.elementFromPoint(r,s+t)!==a)return}else while(l!==n){if(null===l){if(o.isTargetWebComponent)break;return}if(l===t)return;l=l.parentNode}const h="function"===typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(i):this.settings.outsideClickDeselects;h?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)})),this.eventManager.addEventListener(Yc(this,ou),"selectstart",(t=>{this.settings.fragmentSelection||Qe(t.target)||t.preventDefault()}))}translateFromRenderableToVisualCoords(t){let{row:e,col:o}=t;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(e,o))}translateFromRenderableToVisualIndex(t,e){let o=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t,n=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===o&&(o=t),null===n&&(n=e),[o,n]}countRenderableIndexes(t,e){const o=Math.min(t.getNotTrimmedIndexesLength(),e),n=t.getNearestNotHiddenIndex(o-1,-1);return null===n?0:t.getRenderableFromVisualIndex(n)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(t,e,o,n){if(isNaN(t)||t<0)return 0;const i=o.getNearestNotHiddenIndex(t,e),r=o.getRenderableFromVisualIndex(i);if(!Number.isInteger(r))return 0;let s=0;return e<0?s=r+1:e>0&&(s=n-r),s}countNotHiddenFixedColumnsStart(){const t=this.hot.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){const t=this.hot.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){const t=this.hot.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}countRenderableColumnsInRange(t,e){let o=0;for(let n=t;n<=e;n++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(n)&&(o+=1);return o}countRenderableRowsInRange(t,e){let o=0;for(let n=t;n<=e;n++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(n)&&(o+=1);return o}isMainTableNotFullyCoveredByOverlays(){const t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>t&&this.hot.countRenderedCols()>e}initializeWalkontable(){const t={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Yc(this,ou),isDataViewInstance:()=>Vc(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(t,e)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(t,e)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const t=[];return this.hot.hasRowHeaders()&&t.push(((t,e)=>{const o=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t;this.appendRowHeader(o,e)})),this.hot.runHooks("afterGetRowHeaderRenderers",t),Xc(this,Zc,t.length),this.hot.getSettings().ariaTags&&Gc(this,ru,au).call(this)===this.hot.countCols()&&Gc(this,su,hu).call(this,Yc(this,Zc)),t},columnHeaders:()=>{const t=[];return this.hot.hasColHeaders()&&t.push(((t,e)=>{const o=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;this.appendColHeader(o,e)})),this.hot.runHooks("afterGetColumnHeaderRenderers",t),Xc(this,Jc,t.length),t},columnWidth:t=>{const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getColWidth(null===e?t:e)},rowHeight:t=>{const e=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getRowHeight(null===e?t:e)},cellRenderer:(t,e,o)=>{const[n,i]=this.translateFromRenderableToVisualIndex(t,e),r=this.hot.runHooks("modifyGetCellCoords",n,i);let s=n,l=i;Array.isArray(r)&&([s,l]=r);const a=this.hot.getCellMeta(s,l),h=this.hot.colToProp(l);let c=this.hot.getDataAtRowProp(s,h);this.hot.hasHook("beforeValueRender")&&(c=this.hot.runHooks("beforeValueRender",c,a)),this.hot.runHooks("beforeRenderer",o,n,i,h,c,a),this.hot.getCellRenderer(a)(this.hot,o,n,i,h,c,a),this.hot.runHooks("afterRenderer",o,n,i,h,c,a)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&be(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e),r={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=n,Xc(this,eu,!0),this.hot.runHooks("beforeOnCellMouseDown",t,i,o,r),cn(t)||(Nc(t,{coords:i,selection:this.hot.selection,controller:r,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseDown",t,i,o),this.activeWt=this._wt)},onCellContextMenu:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=n,Xc(this,eu,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",t,i,o),cn(t)||(this.hot.runHooks("afterOnCellContextMenu",t,i,o),this.activeWt=this._wt)},onCellMouseOut:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=n,this.hot.runHooks("beforeOnCellMouseOut",t,i,o),cn(t)||(this.hot.runHooks("afterOnCellMouseOut",t,i,o),this.activeWt=this._wt)},onCellMouseOver:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e),r={row:!1,column:!1,cell:!1};this.activeWt=n,this.hot.runHooks("beforeOnCellMouseOver",t,i,o,r),cn(t)||(Yc(this,eu)&&Nc(t,{coords:i,selection:this.hot.selection,controller:r,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseOver",t,i,o),this.activeWt=this._wt)},onCellMouseUp:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=n,this.hot.runHooks("beforeOnCellMouseUp",t,i,o),cn(t)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",t,i,o),this.activeWt=this._wt)},onCellCornerMouseDown:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:(t,e)=>this.beforeRender(t,e),onDraw:t=>this.afterRender(t),onBeforeViewportScrollVertically:t=>{const e=this.hot.rowIndexMapper,o=t<0;let n=t;return o||(n=e.getVisualFromRenderableIndex(t),null!==n)?(n=this.hot.runHooks("beforeViewportScrollVertically",n),this.hot.runHooks("beforeViewportScroll"),o?n:e.getRenderableFromVisualIndex(n)):t},onBeforeViewportScrollHorizontally:t=>{const e=this.hot.columnIndexMapper,o=t<0;let n=t;return o||(n=e.getVisualFromRenderableIndex(t),null!==n)?(n=this.hot.runHooks("beforeViewportScrollHorizontally",n),this.hot.runHooks("beforeViewportScroll"),o?n:e.getRenderableFromVisualIndex(n)):t},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(t,e,o)=>{const n=this.hot.rowIndexMapper,i=t<0;let r=t;i||(r=n.getVisualFromRenderableIndex(t));const s=this.hot.runHooks("beforeHighlightingRowHeader",r,e,o);return i?s:n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(t,e,o)=>{const n=this.hot.columnIndexMapper,i=t<0;let r=t;i||(r=n.getVisualFromRenderableIndex(t));const s=this.hot.runHooks("beforeHighlightingColumnHeader",r,e,o);return i?s:n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(t,e,o)=>{let n;const[i,r]=this.translateFromRenderableToVisualIndex(t,e),s=this.hot.selection.getSelectedRange(),l=s.size();if(l>0){const t=s.peekByIndex(null!==o&&void 0!==o?o:0);n=[t.from.row,t.from.col,t.to.row,t.to.col]}return this.hot.runHooks("afterDrawSelection",i,r,n,o)},onBeforeDrawBorders:(t,e)=>{const[o,n,i,r]=t,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)];return this.hot.runHooks("beforeDrawBorders",s,e)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(t,e)=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.runHooks("beforeStretchingColumnWidth",t,o)},onModifyRowHeaderWidth:t=>this.hot.runHooks("modifyRowHeaderWidth",t),onModifyGetCellCoords:(t,e,o)=>{const n=this.hot.rowIndexMapper,i=this.hot.columnIndexMapper,r=e>=0?i.getVisualFromRenderableIndex(e):e,s=t>=0?n.getVisualFromRenderableIndex(t):t,l=this.hot.runHooks("modifyGetCellCoords",s,r,o);if(Array.isArray(l)){const[t,e,o,r]=l;return[t>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(t,1)):t,e>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,1)):e,o>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1)):o,r>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1)):r]}},viewportRowCalculatorOverride:t=>{let e=this.settings.viewportRowRenderingOffset;if("auto"===e&&this.settings.fixedRowsTop&&(e=10),e>0||"auto"===e){const o=this.countRenderableRows(),n=t.startRow,i=t.endRow;if("number"===typeof e)t.startRow=Math.max(n-e,0),t.endRow=Math.min(i+e,o-1);else if("auto"===e){const e=Math.ceil(i/o*12);t.startRow=Math.max(n-e,0),t.endRow=Math.min(i+e,o-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:t=>{let e=this.settings.viewportColumnRenderingOffset;if("auto"===e&&this.settings.fixedColumnsStart&&(e=10),e>0||"auto"===e){const o=this.countRenderableColumns(),n=t.startColumn,i=t.endColumn;if("number"===typeof e&&(t.startColumn=Math.max(n-e,0),t.endColumn=Math.min(i+e,o-1)),"auto"===e){const e=Math.ceil(i/o*6);t.startColumn=Math.max(n-e,0),t.endColumn=Math.min(i+e,o-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const t=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||t}};this.hot.runHooks("beforeInitWalkontable",t),this._wt=new Ic(t),this.activeWt=this._wt;const e=this._wt.wtTable.spreader,{width:o,height:n}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(o,n),this.eventManager.addEventListener(e,"mousedown",(t=>{t.target===e&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(e,"contextmenu",(t=>{t.target===e&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(t){if(Qe(t))return!0;const e=se(t,this.hot.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return Yc(this,eu)}isSelectedOnlyCell(){var t,e;return null!==(t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingleCell())&&void 0!==t&&t}isCellEdited(){const t=this.hot.getActiveEditor();return t&&t.isOpened()}beforeRender(t,e){t&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,e)}afterRender(t){t&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(t,e){if(e.firstChild){const o=e.firstChild;if(!ue(o,"relative"))return we(e),void this.appendRowHeader(t,e);this.updateCellHeader(o.querySelector(".rowHeader"),t,this.hot.getRowHeader)}else{const{rootDocument:o,getRowHeader:n}=this.hot,i=o.createElement("div"),r=o.createElement("span");i.className="relative",r.className="rowHeader",this.updateCellHeader(r,t,n),i.appendChild(r),e.appendChild(i)}this.hot.runHooks("afterGetRowHeader",t,e)}appendColHeader(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){const i=e.firstChild;ue(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),t,o,n):(we(e),this.appendColHeader(t,e,o,n))}else{const{rootDocument:i}=this.hot,r=i.createElement("div"),s=i.createElement("span");r.className="relative",s.className="colHeader",this.settings.ariaTags&&(fe(r,...pt()),fe(s,...pt())),this.updateCellHeader(s,t,o,n),r.appendChild(s),e.appendChild(r)}this.hot.runHooks("afterGetColHeader",t,e,n)}updateCellHeader(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e;const r=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&(ue(t,"colHeader")?i=r.wtTable.columnFilter.sourceToRendered(e):ue(t,"rowHeader")&&(i=r.wtTable.rowFilter.sourceToRendered(e))),i>-1?Ce(t,o(e,n)):(ye(t,String.fromCharCode(160)),de(t,"cornerHeader"))}maximumVisibleElementWidth(t){const e=this._wt.wtViewport.getWorkspaceWidth(),o=e-t;return o>0?o:0}maximumVisibleElementHeight(t){const e=this._wt.wtViewport.getWorkspaceHeight(),o=e-t;return o>0?o:0}setLastSize(t,e){Xc(this,nu,t),Xc(this,iu,e)}getLastSize(){return{width:Yc(this,nu),height:Yc(this,iu)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return Yc(this,Jc)}getRowHeadersCount(){return Yc(this,Zc)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function au(){return parseInt(this.hot.rootElement.getAttribute(Dt()[0]),10)}function hu(t){const e=Gc(this,ru,au).call(this)+t;fe(this.hot.rootElement,...Dt(e))}var cu=lu;const uu="ABCDEFGHIJKLMNOPQRSTUVWXYZ",du=uu.length;function gu(t){let e,o=t+1,n="";while(o>0)e=(o-1)%du,n=String.fromCharCode(65+e)+n,o=parseInt((o-e)/du,10);return n}function fu(t){let e=0;if(t)for(let o=0,n=t.length-1;o<t.length;o+=1,n-=1)e+=du**n*(uu.indexOf(t[o])+1);return e-=1,e}function mu(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const o=[];let n,i;for(n=0;n<t;n++){const t=[];for(i=0;i<e;i++)t.push(gu(i)+(n+1));o.push(t)}return o}function pu(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const o=[];let n,i;for(n=0;n<t;n++){const t={};for(i=0;i<e;i++)t[`prop${i}`]=gu(i)+(n+1);o.push(t)}return o}function wu(t,e){const o=[];let n;for(let i=0;i<t;i++){n=[];for(let t=0;t<e;t++)n.push("");o.push(n)}return o}function vu(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t;const n=[];return Array.isArray(t)&&Array.isArray(t[0])||(o=[t]),o.forEach(((t,o)=>{Array.isArray(t)?t.forEach(((t,i)=>{n.push([o+e,i,t])})):Object.keys(t).forEach((i=>{n.push([o+e,i,t[i]])}))})),n}function Cu(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ro(t[0])&&(e=xo(t[0]))),e}function yu(t){return!!(Array.isArray(t)&&t.length&&t.every((t=>Array.isArray(t))))}function bu(t){return!!(Array.isArray(t)&&t.length&&t.every((t=>"object"===typeof t&&!Array.isArray(t)&&null!==t)))}function Su(t,e,o){return e=Ru(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ru(t){var e=Eu(t,"string");return"symbol"==typeof e?e:String(e)}function Eu(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Tu{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Su(this,"hot",void 0),Su(this,"data",void 0),Su(this,"dataType","array"),Su(this,"colToProp",(()=>{})),Su(this,"propToCol",(()=>{})),this.hot=t,this.data=e}modifyRowData(t){let e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}getData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}setData(t){this.data=t}getAtColumn(t){const e=[];return A(this.data,((o,n)=>{const i=this.getAtCell(n,t);e.push(i)})),e}getAtRow(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=void 0===e&&void 0===o;let r=null,s=null;if(r=this.modifyRowData(t),Array.isArray(r))s=[],i?r.forEach(((e,o)=>{s[o]=this.getAtPhysicalCell(t,o,r)})):Vi(e,o,(o=>{s[o-e]=this.getAtPhysicalCell(t,o,r)}));else if(Ro(r)||ro(r))if(s=n?[]:{},!i||n){const i=0,l=this.countFirstRowKeys()-1;Vi(i,l,(a=>{const h=this.colToProp(a);if(a>=(e||i)&&a<=(o||l)&&!Number.isInteger(h)){const e=this.getAtPhysicalCell(t,h,r);n?s.push(e):Ho(s,h,e)}}))}else To(r,((e,o)=>{Ho(s,o,this.getAtPhysicalCell(t,o,r))}));return s}setAtCell(t,e,o){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const n=ko(o);this.hot.runHooks("modifySourceData",t,e,n,"set"),n.isTouched()&&(o=n.value)}Number.isInteger(e)?this.data[t][e]=o:Ho(this.data[t],e,o)}}getAtPhysicalCell(t,e,o){let n=null;if(o&&(n="string"===typeof e?Mo(o,e):"function"===typeof e?e(o):o[e]),this.hot.hasHook("modifySourceData")){const o=ko(n);this.hot.runHooks("modifySourceData",t,e,o,"get"),o.isTouched()&&(n=o.value)}return n}getAtCell(t,e){const o=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),o)}getByRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,i=null,r=null,s=null,l=null;null===t||null===e?(n=!0,i=0,s=this.countRows()-1):(i=Math.min(t.row,e.row),r=Math.min(t.col,e.col),s=Math.max(t.row,e.row),l=Math.max(t.col,e.col));const a=[];return Vi(i,s,(t=>{a.push(n?this.getAtRow(t,void 0,void 0,o):this.getAtRow(t,r,l,o))})),a}countRows(){if(this.hot.hasHook("modifySourceLength")){const t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}countFirstRowKeys(){return Cu(this.data)}destroy(){this.data=null,this.hot=null}}var Mu=Tu;const Hu="localHooks",xu={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,o,n,i,r,s){if(this._localHooks[t]){const l=this._localHooks[t].length;for(let a=0;a<l;a++)fo(this._localHooks[t][a],this,e,o,n,i,r,s)}},clearLocalHooks(){return this._localHooks={},this}};Eo(xu,"MIXIN_NAME",Hu,{writable:!1,enumerable:!1});var ku=xu;function Iu(t,e,o){return e=Au(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Au(t){var e=Ou(t,"string");return"symbol"==typeof e?e:String(e)}function Ou(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Pu{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Iu(this,"indexedValues",[]),Iu(this,"initValueOrFn",void 0),this.initValueOrFn=t}getValues(){return this.indexedValues}getValueAtIndex(t){const e=this.indexedValues;if(t<e.length)return e[t]}setValues(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}setValueAtIndex(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ro(this.initValueOrFn)?Vi(t-1,(t=>this.indexedValues.push(this.initValueOrFn(t)))):Vi(t-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function Nu(t,e,o){return[...t.slice(0,e),...o,...t.slice(e)]}function _u(t,e){return k(t,(t=>!1===e.includes(t)))}function Lu(t,e){return I(t,(t=>t-e.filter((e=>e<t)).length))}function Du(t,e){const o=e[0],n=e.length;return I(t,(t=>t>=o?t+n:t))}bo(Pu,ku);class Wu extends Pu{constructor(){super((t=>t))}insert(t,e){const o=Du(this.indexedValues,e);this.indexedValues=Nu(o,t,e),super.insert(t,e)}remove(t){const e=_u(this.indexedValues,t);this.indexedValues=Lu(e,t),super.remove(t)}}function Vu(t,e,o,n){const i=o.length?o[0]:void 0;return[...t.slice(0,i),...o.map(((t,e)=>ro(n)?n(t,e):n)),...void 0===i?[]:t.slice(i)]}function Fu(t,e){return k(t,((t,o)=>!1===e.includes(o)))}class ju extends Pu{insert(t,e){this.indexedValues=Vu(this.indexedValues,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){this.indexedValues=Fu(this.indexedValues,t),super.remove(t)}}class Bu extends ju{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getHiddenIndexes(){return x(this.getValues(),((t,e,o)=>(e&&t.push(o),t)),[])}}function zu(t,e,o){return e=Uu(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Uu(t){var e=$u(t,"string");return"symbol"==typeof e?e:String(e)}function $u(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Gu extends Pu{constructor(){super(...arguments),zu(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map((t=>this.indexedValues[t]))}setValues(t){this.orderOfIndexes=[...Array(t.length).keys()],super.setValues(t)}setValueAtIndex(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(o,0,t),this.runLocalHooks("change"),!0)}clearValue(t){this.orderOfIndexes=_u(this.orderOfIndexes,[t]),ro(this.initValueOrFn)?super.setValueAtIndex(t,this.initValueOrFn(t)):super.setValueAtIndex(t,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(t)}insert(t,e){this.indexedValues=Vu(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=Du(this.orderOfIndexes,e),super.insert(t,e)}remove(t){this.indexedValues=Fu(this.indexedValues,t),this.orderOfIndexes=_u(this.orderOfIndexes,t),this.orderOfIndexes=Lu(this.orderOfIndexes,t),super.remove(t)}getEntries(){return this.orderOfIndexes.map((t=>[t,this.getValueAtIndex(t)]))}}class Yu extends ju{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getTrimmedIndexes(){return x(this.getValues(),((t,e,o)=>(e&&t.push(o),t)),[])}}const Ku=new Map([["hiding",Bu],["index",Pu],["linkedPhysicalIndexToValue",Gu],["physicalIndexToValue",ju],["trimming",Yu]]);function Xu(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Ku.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(Ku.get(t))(e)}function qu(t,e,o){return e=Qu(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Qu(t){var e=Ju(t,"string");return"symbol"==typeof e?e:String(e)}function Ju(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}let Zu=0;class td{constructor(){qu(this,"collection",new Map)}register(t,e){!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",(()=>this.runLocalHooks("change",e))),Zu+=1)}unregister(t){const e=this.collection.get(t);U(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),Zu-=1)}unregisterAll(){this.collection.forEach(((t,e)=>this.unregister(e))),this.collection.clear()}get(t){return $(t)?Array.from(this.collection.values()):this.collection.get(t)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach((e=>{e.remove(t)}))}insertToEvery(t,e){this.collection.forEach((o=>{o.insert(t,e)}))}initEvery(t){this.collection.forEach((e=>{e.init(t)}))}}function ed(){return Zu}function od(t,e,o){return e=nd(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function nd(t){var e=id(t,"string");return"symbol"==typeof e?e:String(e)}function id(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}bo(td,ku);class rd extends td{constructor(t,e){super(),od(this,"mergedValuesCache",[]),od(this,"aggregationFunction",void 0),od(this,"fallbackValue",void 0),this.aggregationFunction=t,this.fallbackValue=e}getMergedValues(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.mergedValuesCache;if(0===this.getLength())return[];const e=I(this.get(),(t=>t.getValues())),o=[],n=U(e[0])&&e[0].length||0;for(let i=0;i<n;i+=1){const t=[];for(let o=0;o<this.getLength();o+=1)t.push(e[o][i]);o.push(t)}return I(o,this.aggregationFunction)}getMergedValueAtIndex(t,e){const o=this.getMergedValues(e)[t];return U(o)?o:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function sd(t,e,o){ld(t,e),e.set(t,o)}function ld(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ad(t,e,o){var n=ud(t,e,"set");return hd(t,n,o),o}function hd(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function cd(t,e){var o=ud(t,e,"get");return dd(t,o)}function ud(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function dd(t,e){return e.get?e.get.call(t):e.value}var gd=new WeakMap;class fd{constructor(){sd(this,gd,{writable:!0,value:[]})}subscribe(t){return this.addLocalHook("change",t),this._write(cd(this,gd)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(t){return t.length>0&&this.runLocalHooks("change",t),this}_writeInitialChanges(t){ad(this,gd,t)}}function md(t,e){const o=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&o.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)o.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)o.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return o}function pd(t,e,o){wd(t,e),e.set(t,o)}function wd(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vd(t,e){var o=bd(t,e,"get");return Cd(t,o)}function Cd(t,e){return e.get?e.get.call(t):e.value}function yd(t,e,o){var n=bd(t,e,"set");return Sd(t,n,o),o}function bd(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Sd(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}bo(fd,ku);var Rd=new WeakMap,Ed=new WeakMap,Td=new WeakMap,Md=new WeakMap,Hd=new WeakMap;class xd{constructor(){let{initialIndexValue:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};pd(this,Rd,{writable:!0,value:new Set}),pd(this,Ed,{writable:!0,value:[]}),pd(this,Td,{writable:!0,value:[]}),pd(this,Md,{writable:!0,value:!1}),pd(this,Hd,{writable:!0,value:!1}),yd(this,Hd,null!==t&&void 0!==t&&t)}createObserver(){const t=new fd;return vd(this,Rd).add(t),t.addLocalHook("unsubscribe",(()=>{vd(this,Rd).delete(t)})),t._writeInitialChanges(md(vd(this,Ed),vd(this,Td))),t}emit(t){let e=vd(this,Td);vd(this,Md)&&vd(this,Ed).length===t.length||(0===t.length?t=new Array(e.length).fill(vd(this,Hd)):yd(this,Ed,new Array(t.length).fill(vd(this,Hd))),vd(this,Md)||(yd(this,Md,!0),e=vd(this,Ed)));const o=md(e,t);vd(this,Rd).forEach((t=>t._write(o))),yd(this,Td,t)}}function kd(t,e,o){return e=Id(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Id(t){var e=Ad(t,"string");return"symbol"==typeof e?e:String(e)}function Ad(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}new Set;class Od{constructor(){kd(this,"indexesSequence",new Wu),kd(this,"trimmingMapsCollection",new rd((t=>t.some((t=>!0===t))),!1)),kd(this,"hidingMapsCollection",new rd((t=>t.some((t=>!0===t))),!1)),kd(this,"variousMapsCollection",new td),kd(this,"hidingChangesObservable",new xd({initialIndexValue:!1})),kd(this,"notTrimmedIndexesCache",[]),kd(this,"notHiddenIndexesCache",[]),kd(this,"isBatched",!1),kd(this,"indexesSequenceChanged",!1),kd(this,"indexesChangeSource",void 0),kd(this,"trimmedIndexesChanged",!1),kd(this,"hiddenIndexesChanged",!1),kd(this,"renderablePhysicalIndexesCache",[]),kd(this,"fromPhysicalToVisualIndexesCache",new Map),kd(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(t=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(t=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(t=>{this.runLocalHooks("change",t,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(t){if("hiding"!==t)throw new Error(`Unsupported index map type "${t}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(t,e,o){return this.registerMap(t,Xu(e,o))}registerMap(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error(`Map with name "${t}" has been already registered.`);e instanceof Yu?this.trimmingMapsCollection.register(t,e):e instanceof Bu?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);const o=this.getNumberOfIndexes();return o>0&&e.init(o),e}unregisterMap(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(t){const e=this.notTrimmedIndexesCache[t];return U(e)?e:null}getPhysicalFromRenderableIndex(t){const e=this.renderablePhysicalIndexesCache[t];return U(e)?e:null}getVisualFromPhysicalIndex(t){const e=this.fromPhysicalToVisualIndexesCache.get(t);return U(e)?e:null}getVisualFromRenderableIndex(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}getRenderableFromVisualIndex(t){const e=this.fromVisualToRenderableIndexesCache.get(t);return U(e)?e:null}getNearestNotHiddenIndex(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.getPhysicalFromVisualIndex(t);if(null===n)return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;const i=Array.from(this.fromVisualToRenderableIndexesCache.keys());let r=-1;return r=e>0?i.findIndex((e=>e>t)):i.reverse().findIndex((e=>e<t)),-1===r?o?this.getNearestNotHiddenIndex(t,-e,!1):null:i[r]}initToLength(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(t).keys()],this.notHiddenIndexesCache=[...new Array(t).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){const e=this.getNumberOfIndexes();if(t<e){const e=[...Array(this.getNumberOfIndexes()-t).keys()].map((e=>e+t));this.removeIndexes(e)}else this.insertIndexes(e,t-e)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;const e=this.getIndexesSequence();return e.filter((t=>!1===this.isTrimmed(t)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notHiddenIndexesCache;const e=this.getIndexesSequence();return e.filter((t=>!1===this.isHidden(t)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;const e=this.getNotTrimmedIndexes();return e.filter((t=>!1===this.isHidden(t)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(t,e){"number"===typeof t&&(t=[t]);const o=I(t,(t=>this.getPhysicalFromVisualIndex(t))),n=this.getNotTrimmedIndexesLength(),i=t.length,r=_u(this.getIndexesSequence(),o),s=r.filter((t=>!1===this.isTrimmed(t)));let l=r.indexOf(s[s.length-1])+1;if(e+i<n){const t=s[e];l=r.indexOf(t)}this.indexesChangeSource="move",this.setIndexesSequence(Nu(r,l,o)),this.indexesChangeSource=void 0}isTrimmed(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}isHidden(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}insertIndexes(t,e){const o=this.getNotTrimmedIndexes()[t],n=U(o)?o:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),r=I(new Array(e).fill(n),((t,e)=>t+e));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,r),this.hidingMapsCollection.insertToEvery(i,r),this.variousMapsCollection.insertToEvery(i,r),this.resumeOperations()}removeIndexes(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}updateCache(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(t,e)}}cacheFromVisualToRenderableIndexes(){const t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromRenderableIndex(e),o=this.getVisualFromPhysicalIndex(t);this.fromVisualToRenderableIndexesCache.set(o,e)}}}function Pd(t,e){return To(e,((e,o)=>{$(t[o])&&(t[o]=e)})),t}function Nd(t){const e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,o=e.exec(t);return o?`${o[1].toLowerCase()}-${o[2].toUpperCase()}`:t}function _d(t){U(t)&&mn(B`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Ld(t,e){const o=Array.isArray(t)&&Number.isInteger(e);return o?t[e]:t}bo(Od,ku);const{register:Dd,getValues:Wd}=xn("phraseFormatters");function Vd(t,e){Dd(t,e)}function Fd(){return Wd()}Vd("pluralize",Ld);const jd="ContextMenu:items",Bd=jd,zd=`${Bd}.noItems`,Ud=`${Bd}.insertRowAbove`,$d=`${Bd}.insertRowBelow`,Gd=`${Bd}.insertColumnOnTheLeft`,Yd=`${Bd}.insertColumnOnTheRight`,Kd=`${Bd}.removeRow`,Xd=`${Bd}.removeColumn`,qd=`${Bd}.undo`,Qd=`${Bd}.redo`,Jd=`${Bd}.readOnly`,Zd=`${Bd}.clearColumn`,tg=`${Bd}.copy`,eg=`${Bd}.copyWithHeaders`,og=`${Bd}.copyWithGroupHeaders`,ng=`${Bd}.copyHeadersOnly`,ig=`${Bd}.cut`,rg=`${Bd}.freezeColumn`,sg=`${Bd}.unfreezeColumn`,lg=`${Bd}.mergeCells`,ag=`${Bd}.unmergeCells`,hg=`${Bd}.addComment`,cg=`${Bd}.editComment`,ug=`${Bd}.removeComment`,dg=`${Bd}.readOnlyComment`,gg=`${Bd}.align`,fg=`${Bd}.align.left`,mg=`${Bd}.align.center`,pg=`${Bd}.align.right`,wg=`${Bd}.align.justify`,vg=`${Bd}.align.top`,Cg=`${Bd}.align.middle`,yg=`${Bd}.align.bottom`,bg=`${Bd}.borders`,Sg=`${Bd}.borders.top`,Rg=`${Bd}.borders.right`,Eg=`${Bd}.borders.bottom`,Tg=`${Bd}.borders.left`,Mg=`${Bd}.borders.remove`,Hg=`${Bd}.nestedHeaders.insertChildRow`,xg=`${Bd}.nestedHeaders.detachFromParent`,kg=`${Bd}.hideColumn`,Ig=`${Bd}.showColumn`,Ag=`${Bd}.hideRow`,Og=`${Bd}.showRow`,Pg="Filters:",Ng=`${Pg}conditions`,_g=`${Ng}.none`,Lg=`${Ng}.isEmpty`,Dg=`${Ng}.isNotEmpty`,Wg=`${Ng}.isEqualTo`,Vg=`${Ng}.isNotEqualTo`,Fg=`${Ng}.beginsWith`,jg=`${Ng}.endsWith`,Bg=`${Ng}.contains`,zg=`${Ng}.doesNotContain`,Ug=`${Ng}.byValue`,$g=`${Ng}.greaterThan`,Gg=`${Ng}.greaterThanOrEqualTo`,Yg=`${Ng}.lessThan`,Kg=`${Ng}.lessThanOrEqualTo`,Xg=`${Ng}.isBetween`,qg=`${Ng}.isNotBetween`,Qg=`${Ng}.after`,Jg=`${Ng}.before`,Zg=`${Ng}.today`,tf=`${Ng}.tomorrow`,ef=`${Ng}.yesterday`,of=`${Pg}labels.filterByCondition`,nf=`${Pg}labels.filterByValue`,rf=`${Pg}labels.conjunction`,sf=`${Pg}labels.disjunction`,lf=`${Pg}values.blankCells`,af=`${Pg}buttons.selectAll`,hf=`${Pg}buttons.clear`,cf=`${Pg}buttons.ok`,uf=`${Pg}buttons.cancel`,df=`${Pg}buttons.placeholder.search`,gf=`${Pg}buttons.placeholder.value`,ff=`${Pg}buttons.placeholder.secondValue`,mf="CheckboxRenderer:",pf=`${mf}checked`,wf=`${mf}unchecked`,vf={languageCode:"en-US",[zd]:"No available options",[Ud]:"Insert row above",[$d]:"Insert row below",[Gd]:"Insert column left",[Yd]:"Insert column right",[Kd]:["Remove row","Remove rows"],[Xd]:["Remove column","Remove columns"],[qd]:"Undo",[Qd]:"Redo",[Jd]:"Read only",[Zd]:"Clear column",[gg]:"Alignment",[fg]:"Left",[mg]:"Center",[pg]:"Right",[wg]:"Justify",[vg]:"Top",[Cg]:"Middle",[yg]:"Bottom",[rg]:"Freeze column",[sg]:"Unfreeze column",[bg]:"Borders",[Sg]:"Top",[Rg]:"Right",[Eg]:"Bottom",[Tg]:"Left",[Mg]:"Remove border(s)",[hg]:"Add comment",[cg]:"Edit comment",[ug]:"Delete comment",[dg]:"Read-only comment",[lg]:"Merge cells",[ag]:"Unmerge cells",[tg]:"Copy",[eg]:["Copy with header","Copy with headers"],[og]:["Copy with group header","Copy with group headers"],[ng]:["Copy header only","Copy headers only"],[ig]:"Cut",[Hg]:"Insert child row",[xg]:"Detach from parent",[kg]:["Hide column","Hide columns"],[Ig]:["Show column","Show columns"],[Ag]:["Hide row","Hide rows"],[Og]:["Show row","Show rows"],[_g]:"None",[Lg]:"Is empty",[Dg]:"Is not empty",[Wg]:"Is equal to",[Vg]:"Is not equal to",[Fg]:"Begins with",[jg]:"Ends with",[Bg]:"Contains",[zg]:"Does not contain",[$g]:"Greater than",[Gg]:"Greater than or equal to",[Yg]:"Less than",[Kg]:"Less than or equal to",[Xg]:"Is between",[qg]:"Is not between",[Qg]:"After",[Jg]:"Before",[Zg]:"Today",[tf]:"Tomorrow",[ef]:"Yesterday",[lf]:"Blank cells",[of]:"Filter by condition",[nf]:"Filter by value",[rf]:"And",[sf]:"Or",[af]:"Select all",[hf]:"Clear",[cf]:"OK",[uf]:"Cancel",[df]:"Search",[gf]:"Value",[ff]:"Second value",[pf]:"Checked",[wf]:"Unchecked"};var Cf=vf;const yf=p,bf=Cf.languageCode,{register:Sf,getItem:Rf,hasItem:Ef,getValues:Tf}=xn("languagesDictionaries");function Mf(t,e){let o=t,n=e;return Ro(t)&&(n=t,o=n.languageCode),Hf(o,n),Sf(o,Co(n)),Co(n)}function Hf(t,e){t!==bf&&Pd(e,Rf(bf))}function xf(t){return kf(t)?Co(Rf(t)):null}function kf(t){return Ef(t)}function If(){return Tf()}function Af(t,e,o){const n=xf(t);if(null===n)return null;const i=n[e];if($(i))return null;const r=Of(i,o);return Array.isArray(r)?r[0]:r}function Of(t,e){let o=t;return A(Fd(),(n=>{o=n(t,e)})),o}function Pf(t){let e=Nd(t);return kf(e)||(e=bf,_d(t)),e}Mf(Cf);const Nf="active-header",_f="header",Lf="area",Df="focus",Wf="fill",Vf="row",Ff="column",jf="custom-selection";class Bf{constructor(t,e){this.settings=t,this.cellRange=e||null}isEmpty(){return null===this.cellRange}add(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}replace(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}destroy(){this.runLocalHooks("destroy")}}bo(Bf,ku);var zf=Bf;function Uf(t,e,o){return e=$f(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function $f(t){var e=Gf(t,"string");return"symbol"==typeof e?e:String(e)}function Gf(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Yf extends zf{constructor(t,e){super(t,null),Uf(this,"visualCellRange",null),this.visualCellRange=e||null,this.commit()}add(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(t){let{from:e,to:o}=t,n=this.getNearestNotHiddenCoords(e,1),i=this.getNearestNotHiddenCoords(o,-1);return null===n||null===i?null:((n.row>i.row||n.col>i.col)&&(n=e,i=o),this.settings.createCellRange(n,n,i))}getNearestNotHiddenCoords(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const n=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,t.row,e);if(null===n)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,t.col,o);return null===i?null:this.settings.createCellCoords(n,i)}getNearestNotHiddenIndex(t,e,o){return e<0?e:t.getNearestNotHiddenIndex(e,o)}commit(){if(null===this.visualCellRange)return this;const t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===t?null:this.createRenderableCellRange(t.from,t.to),this}syncWith(t){const e=t.from.clone().normalize(),o="N-S"===t.getVerticalDirection()?1:-1,n="W-E"===t.getHorizontalDirection()?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let r=null;if(null!==i&&null!==i.col&&null!==i.row||(r=this.getNearestNotHiddenCoords(e,o,n)),null!==r&&t.overlaps(r)){const e=t.highlight.clone();if(e.row>=0&&(e.row=r.row),e.col>=0&&(e.col=r.col),null===this.cellRange){const t=this.settings.visualToRenderableCoords(e);this.cellRange=this.settings.createCellRange(t)}t.setHighlight(e)}return"focus"===this.settings.selectionType&&null!==i&&null===r&&t.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:t,to:e}=this.cellRange;return[Math.min(t.row,e.row),Math.min(t.col,e.col),Math.max(t.row,e.row),Math.max(t.col,e.col)]}getVisualCorners(){const t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}createRenderableCellRange(t,e){const o=this.settings.visualToRenderableCoords(t),n=this.settings.visualToRenderableCoords(e);return null===o.row||null===o.col||null===n.row||null===n.col?null:this.settings.createCellRange(o,o,n)}}var Kf=Yf;function Xf(t){let{activeHeaderClassName:e,...o}=t;return new Kf({className:e,...o,selectionType:Nf})}function qf(t){let{areaCornerVisible:e,...o}=t;return new Kf({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...o,selectionType:Lf})}function Qf(t){let{...e}=t;return new Kf({className:"highlight",...e,selectionType:Lf})}function Jf(t){let{columnClassName:e,...o}=t;return new Kf({className:e,...o,selectionType:Ff})}function Zf(t){let{cellCornerVisible:e,...o}=t;return new Kf({className:"current",headerAttributes:[$t()],border:{width:2,color:"#4b89ff",cornerVisible:e},...o,selectionType:Df})}function tm(t){let{border:e,visualCellRange:o,...n}=t;return new Kf({...e,...n,selectionType:jf},o)}function em(t){let{...e}=t;return new Kf({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:Wf})}function om(t){let{headerClassName:e,...o}=t;return new Kf({className:e,...o,selectionType:_f})}function nm(t){let{rowClassName:e,...o}=t;return new Kf({className:e,...o,selectionType:Vf})}let im;function rm(t,e){sm(t,e),e.add(t)}function sm(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lm(t,e,o){return e=am(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function am(t){var e=hm(t,"string");return"symbol"==typeof e?e:String(e)}function hm(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function cm(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}var um=new WeakSet;im=Symbol.iterator;class dm{constructor(t){rm(this,um),lm(this,"options",void 0),lm(this,"layerLevel",0),lm(this,"focus",void 0),lm(this,"fill",void 0),lm(this,"layeredAreas",new Map),lm(this,"areas",new Map),lm(this,"rowHeaders",new Map),lm(this,"columnHeaders",new Map),lm(this,"activeRowHeaders",new Map),lm(this,"activeColumnHeaders",new Map),lm(this,"activeCornerHeaders",new Map),lm(this,"rowHighlights",new Map),lm(this,"columnHighlights",new Map),lm(this,"customSelections",[]),this.options=t,this.focus=Zf(t),this.fill=em(t)}isEnabledFor(t,e){let o=t;t===Df&&(o="current");let n=this.options.disabledCellSelection(e.row,e.col);return"string"===typeof n&&(n=[n]),!1===n||Array.isArray(n)&&!n.includes(o)}useLayerLevel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return cm(this,um,gm).call(this,this.layeredAreas,qf)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return cm(this,um,gm).call(this,this.areas,Qf)}getAreas(){return[...this.areas.values()]}createRowHeader(){return cm(this,um,gm).call(this,this.rowHeaders,om)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return cm(this,um,gm).call(this,this.columnHeaders,om)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return cm(this,um,gm).call(this,this.activeRowHeaders,Xf)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return cm(this,um,gm).call(this,this.activeColumnHeaders,Xf)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return cm(this,um,gm).call(this,this.activeCornerHeaders,Xf)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return cm(this,um,gm).call(this,this.rowHighlights,nm)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return cm(this,um,gm).call(this,this.columnHighlights,Jf)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(t){this.customSelections.push(tm({...this.options,...t}))}clear(){this.focus.clear(),this.fill.clear(),A(this.areas.values(),(t=>{t.clear()})),A(this.layeredAreas.values(),(t=>{t.clear()})),A(this.rowHeaders.values(),(t=>{t.clear()})),A(this.columnHeaders.values(),(t=>{t.clear()})),A(this.activeRowHeaders.values(),(t=>{t.clear()})),A(this.activeColumnHeaders.values(),(t=>{t.clear()})),A(this.activeCornerHeaders.values(),(t=>{t.clear()})),A(this.rowHighlights.values(),(t=>{t.clear()})),A(this.columnHighlights.values(),(t=>{t.clear()}))}[im](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function gm(t,e){const o=this.layerLevel;if(t.has(o))return t.get(o);const n=e({layerLevel:o,...this.options});return t.set(o,n),n}var fm=dm;let mm;function pm(t,e,o){return e=wm(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function wm(t){var e=vm(t,"string");return"symbol"==typeof e?e:String(e)}function vm(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}mm=Symbol.iterator;class Cm{constructor(t){pm(this,"ranges",[]),pm(this,"createCellRange",void 0),this.createCellRange=t}isEmpty(){return 0===this.size()}set(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}add(t){return this.ranges.push(this.createCellRange(t)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(t){return this.ranges.some((e=>e.includes(t)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[mm](){return this.ranges[Symbol.iterator]()}}var ym=Cm;function bm(t,e){Rm(t,e),e.add(t)}function Sm(t,e,o){Rm(t,e),e.set(t,o)}function Rm(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Em(t,e){var o=xm(t,e,"get");return Tm(t,o)}function Tm(t,e){return e.get?e.get.call(t):e.value}function Mm(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function Hm(t,e,o){var n=xm(t,e,"set");return km(t,n,o),o}function xm(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function km(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var Im=new WeakMap,Am=new WeakMap,Om=new WeakMap,Pm=new WeakSet,Nm=new WeakSet,_m=new WeakSet,Lm=new WeakSet,Dm=new WeakSet;class Wm{constructor(t,e){bm(this,Dm),bm(this,Lm),bm(this,_m),bm(this,Nm),bm(this,Pm),Sm(this,Im,{writable:!0,value:void 0}),Sm(this,Am,{writable:!0,value:void 0}),Sm(this,Om,{writable:!0,value:{x:0,y:0}}),Hm(this,Im,t),Hm(this,Am,e)}transformStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Mm(this,Pm,Vm).call(this,{x:Em(this,Am).navigableHeaders()?Em(this,Am).countRowHeaders():0,y:Em(this,Am).navigableHeaders()?Em(this,Am).countColHeaders():0});const n=Em(this,Am).createCellCoords(t,e);let i=Em(this,Im).current().highlight;const r=Em(this,Am).visualToRenderableCoords(i);let s=0,l=0;if(this.runLocalHooks("beforeTransformStart",n),null!==r.row&&null!==r.col){const{width:t,height:e}=Mm(this,_m,jm).call(this),{row:r,col:a}=Mm(this,Lm,Bm).call(this,i),h=Em(this,Am).fixedRowsBottom(),c=Em(this,Am).minSpareRows(),u=Em(this,Am).minSpareCols(),d=Em(this,Am).autoWrapRow(),g=Em(this,Am).autoWrapCol(),f=Em(this,Am).createCellCoords(r+n.row,a+n.col);if(f.row>=e){const n=ko(o&&c>0&&0===h),i=f.col+1,r=Em(this,Am).createCellCoords(f.row-e,i>=t?i-t:i);this.runLocalHooks("beforeColumnWrap",n,Mm(this,Dm,zm).call(this,r),i>=t),n.value?this.runLocalHooks("insertRowRequire",Em(this,Am).countRenderableRows()):g&&f.assign(r)}else if(f.row<0){const o=ko(g),n=f.col-1,i=Em(this,Am).createCellCoords(e+f.row,n<0?t+n:n);this.runLocalHooks("beforeColumnWrap",o,Mm(this,Dm,zm).call(this,i),n<0),g&&f.assign(i)}if(f.col>=t){const n=ko(o&&u>0),i=f.row+1,r=Em(this,Am).createCellCoords(i>=e?i-e:i,f.col-t);this.runLocalHooks("beforeRowWrap",n,Mm(this,Dm,zm).call(this,r),i>=e),n.value?this.runLocalHooks("insertColRequire",Em(this,Am).countRenderableColumns()):d&&f.assign(r)}else if(f.col<0){const o=ko(d),n=f.row-1,i=Em(this,Am).createCellCoords(n<0?e+n:n,t+f.col);this.runLocalHooks("beforeRowWrap",o,Mm(this,Dm,zm).call(this,i),n<0),d&&f.assign(i)}const{rowDir:m,colDir:p}=Mm(this,Nm,Fm).call(this,f);s=m,l=p,i=Mm(this,Dm,zm).call(this,f)}return this.runLocalHooks("afterTransformStart",i,s,l),i}transformEnd(t,e){Mm(this,Pm,Vm).call(this,{x:Em(this,Am).navigableHeaders()?Em(this,Am).countRowHeaders():0,y:Em(this,Am).navigableHeaders()?Em(this,Am).countColHeaders():0});const o=Em(this,Am).createCellCoords(t,e),n=Em(this,Im).current(),i=Em(this,Am).visualToRenderableCoords(n.highlight),r=n.to.clone();let s=0,l=0;if(this.runLocalHooks("beforeTransformEnd",o),null!==i.row&&null!==i.col){const{row:t,col:e}=Mm(this,Lm,Bm).call(this,n.to),i=Em(this,Am).createCellCoords(t+o.row,e+o.col),{rowDir:a,colDir:h}=Mm(this,Nm,Fm).call(this,i);s=a,l=h;const c=Mm(this,Dm,zm).call(this,i);0===o.row&&0!==o.col?r.col=c.col:0!==o.row&&0===o.col?r.row=c.row:(r.row=c.row,r.col=c.col)}return this.runLocalHooks("afterTransformEnd",r,s,l),r}}function Vm(t){let{x:e,y:o}=t;Hm(this,Om,{x:e,y:o})}function Fm(t){const{width:e,height:o}=Mm(this,_m,jm).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=o&&(n=1,t.row=o-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function jm(){return{width:Em(this,Om).x+Em(this,Am).countRenderableColumns(),height:Em(this,Om).y+Em(this,Am).countRenderableRows()}}function Bm(t){const{row:e,col:o}=Em(this,Am).visualToRenderableCoords(t);return Em(this,Am).createCellCoords(Em(this,Om).y+e,Em(this,Om).x+o)}function zm(t){const e=t.clone();return e.col=t.col-Em(this,Om).x,e.row=t.row-Em(this,Om).y,Em(this,Am).renderableToVisualCoords(e)}bo(Wm,ku);var Um=Wm;const $m=0,Gm=1,Ym=2,Km=3,Xm=[Km,Ym],qm=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Qm=Symbol("root"),Jm=Symbol("child");function Zm(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qm;if(e!==Qm&&e!==Jm)throw new Error("The second argument is used internally only and cannot be overwritten.");const o=Array.isArray(t),n=e===Qm;let i=$m;if(o){const e=t[0];if(0===t.length)i=Gm;else if(n&&e instanceof ua)i=Km;else if(n&&Array.isArray(e))i=Zm(e,Jm);else if(t.length>=2&&t.length<=4){const e=!t.some(((t,e)=>!qm[e].includes(typeof t)));e&&(i=Ym)}}return i}function tp(t){let{createCellCoords:e,createCellRange:o,keepDirection:n=!1,propToCol:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Xm.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(r){const s=t===Km;let l=s?r.from.row:r[0],a=s?r.from.col:r[1],h=s?r.to.row:r[2],c=s?r.to.col:r[3];if("function"===typeof i&&("string"===typeof a&&(a=i(a)),"string"===typeof c&&(c=i(c))),$(h)&&(h=l),$(c)&&(c=a),!n){const t=l,e=a,o=h,n=c;l=Math.min(t,o),a=Math.min(e,n),h=Math.max(t,o),c=Math.max(e,n)}const u=e(l,a),d=e(h,c);return o(u,u,d)}}function ep(t){const e=Zm(t.getSelected());if(e===$m||e===Gm)return[];const o=tp(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;A(t.getSelected(),(t=>{const{from:e,to:i}=o(t),r=Math.max(e.col,0),s=i.col-r+1;A(Array.from(new Array(s),((t,e)=>r+e)),(t=>{n.has(t)||n.add(t)}))}));const i=Array.from(n).sort(((t,e)=>t-e)),r=x(i,((t,e,o,n)=>(0!==o&&e===n[o-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[]);return r}function op(t){const e=Zm(t.getSelected());if(e===$m||e===Gm)return[];const o=tp(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;A(t.getSelected(),(t=>{const{from:e,to:i}=o(t),r=Math.max(e.row,0),s=i.row-r+1;A(Array.from(new Array(s),((t,e)=>r+e)),(t=>{n.has(t)||n.add(t)}))}));const i=Array.from(n).sort(((t,e)=>t-e)),r=x(i,((t,e,o,n)=>(0!==o&&e===n[o-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[]);return r}function np(t,e,o){ip(t,e),e.set(t,o)}function ip(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rp(t,e,o){return e=sp(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function sp(t){var e=lp(t,"string");return"symbol"==typeof e?e:String(e)}function lp(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ap(t,e,o){var n=up(t,e,"set");return hp(t,n,o),o}function hp(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function cp(t,e){var o=up(t,e,"get");return dp(t,o)}function up(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function dp(t,e){return e.get?e.get.call(t):e.value}var gp=new WeakMap;class fp{constructor(t,e){var o=this;rp(this,"settings",void 0),rp(this,"tableProps",void 0),rp(this,"inProgress",!1),rp(this,"selectedRange",new ym(((t,e,o)=>this.tableProps.createCellRange(t,e,o)))),rp(this,"highlight",void 0),rp(this,"transformation",void 0),rp(this,"selectedByRowHeader",new Set),rp(this,"selectedByColumnHeader",new Set),np(this,gp,{writable:!0,value:!1}),this.settings=t,this.tableProps=e,this.highlight=new fm({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,cellAttributes:[$t()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(t,e)=>this.tableProps.isDisabledCellSelection(t,e),cellCornerVisible:function(){return o.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return o.isAreaCornerVisible(...arguments)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),createCellRange:(t,e,o)=>this.tableProps.createCellRange(t,e,o)}),this.transformation=new Um(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),navigableHeaders:()=>t.navigableHeaders,fixedRowsBottom:()=>t.fixedRowsBottom,minSpareRows:()=>t.minSpareRows,minSpareCols:()=>t.minSpareCols,autoWrapRow:()=>t.autoWrapRow,autoWrapCol:()=>t.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeModifyTransformStart",...e)})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("afterModifyTransformStart",...e)})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeModifyTransformEnd",...e)})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("afterModifyTransformEnd",...e)})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("insertRowRequire",...e)})),this.transformation.addLocalHook("insertColRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("insertColRequire",...e)})),this.transformation.addLocalHook("beforeRowWrap",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeRowWrap",...e)})),this.transformation.addLocalHook("beforeColumnWrap",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeColumnWrap",...e)}))}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;const i="multiple"===this.settings.selectionMode,r=$(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,s=t.clone();this.runLocalHooks("beforeSetRangeStart"+(o?"Only":""),s),(!i||i&&!r&&$(e))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(n.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),o||this.setRangeEnd(t)}setRangeStartOnly(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;this.setRangeStart(t,e,!0,o)}setRangeEnd(t){if(this.selectedRange.isEmpty())return;const e=t.clone(),o=this.tableProps.countRows(),n=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(t).isSingleHeader();if((o>0||n>0)&&(0===o&&e.col<0&&!i||0===n&&e.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",e),this.begin();const r=this.selectedRange.current();this.settings.navigableHeaders||r.highlight.normalize(),"single"===this.settings.selectionMode?(r.setFrom(r.highlight),r.setTo(r.highlight)):r.setTo(e),o>0&&n>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!r.isSingleHeader())&&r.to.normalize(),this.runLocalHooks("beforeHighlightSet");const s=this.highlight.getFocus();s.clear(),this.highlight.isEnabledFor(Df,r.highlight)&&s.add(this.selectedRange.current().highlight).commit().syncWith(r);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(A(this.highlight.getAreas(),(t=>{t.clear()})),A(this.highlight.getLayeredAreas(),(t=>{t.clear()})),A(this.highlight.getRowHeaders(),(t=>{t.clear()})),A(this.highlight.getColumnHeaders(),(t=>{t.clear()})),A(this.highlight.getActiveRowHeaders(),(t=>{t.clear()})),A(this.highlight.getActiveColumnHeaders(),(t=>{t.clear()})),A(this.highlight.getActiveCornerHeaders(),(t=>{t.clear()})),A(this.highlight.getRowHighlights(),(t=>{t.clear()})),A(this.highlight.getColumnHighlights(),(t=>{t.clear()}))),this.highlight.useLayerLevel(l);const a=this.highlight.createArea(),h=this.highlight.createLayeredArea(),c=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),f=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),p=this.highlight.createColumnHighlight();if(a.clear(),h.clear(),c.clear(),u.clear(),d.clear(),g.clear(),f.clear(),m.clear(),p.clear(),this.highlight.isEnabledFor(Lf,r.highlight)&&(this.isMultiple()||l>=1)&&(a.add(r.from).add(r.to).commit(),h.add(r.from).add(r.to).commit(),1===l)){const t=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(t.from).commit().syncWith(t),this.highlight.createLayeredArea().add(t.from).commit().syncWith(t),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(_f,r.highlight)){if(!r.isSingleHeader()){const t=this.tableProps.createCellCoords(Math.max(r.from.row,0),-1),e=this.tableProps.createCellCoords(r.to.row,-1),o=this.tableProps.createCellCoords(-1,Math.max(r.from.col,0)),n=this.tableProps.createCellCoords(-1,r.to.col);"single"===this.settings.selectionMode?(c.add(t).commit(),u.add(o).commit(),m.add(t).commit(),p.add(o).commit()):(c.add(t).add(e).commit(),u.add(o).add(n).commit(),m.add(t).add(e).commit(),p.add(o).add(n).commit())}const t=!cp(this,gp)&&this.isEntireRowSelected()&&(n>0&&n===r.getWidth()||0===n&&this.isSelectedByRowHeader()),e=!cp(this,gp)&&this.isEntireColumnSelected()&&(o>0&&o===r.getHeight()||0===o&&this.isSelectedByColumnHeader());t&&d.add(this.tableProps.createCellCoords(Math.max(r.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(r.to.row,0),-1)).commit(),e&&g.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(r.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(r.to.col,0))).commit(),t&&e&&f.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",t)}isMultiple(){const t=ko(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}transformStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(t,e,o))}transformEnd(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&(-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t))}isEntireRowSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{col:e}=t.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),n=this.tableProps.countCols();return(o>0&&e<0||0===o)&&t.getWidth()===n};if(-1===t)return Array.from(this.selectedRange).some((t=>e(t)));const o=this.selectedRange.peekByIndex(t);return!!o&&e(o)}isSelectedByColumnHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t))}isEntireColumnSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{row:e}=t.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),n=this.tableProps.countRows();return(o>0&&e<0||0===o)&&t.getHeight()===n};if(-1===t)return Array.from(this.selectedRange).some((t=>e(t)));const o=this.selectedRange.peekByIndex(t);return!!o&&e(o)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(t){return this.selectedRange.includes(t)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(t){const e=this.tableProps.visualToRenderableCoords(t);return null!==e.row&&null!==e.col}isAreaCornerVisible(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var t;let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),r=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),a=o?-l:0,h=e?-s:0;if(0===a&&0===h&&(0===i||0===r))return;let c=null===(t=this.getSelectedRange().current())||void 0===t?void 0:t.highlight;const{focusPosition:u,disableHeadersHighlight:d}=n;ap(this,gp,d),u&&Number.isInteger(null===u||void 0===u?void 0:u.row)&&Number.isInteger(null===u||void 0===u?void 0:u.col)&&(c=this.tableProps.createCellCoords(Bi(u.row,a,i-1),Bi(u.col,h,r-1)));const g=this.tableProps.createCellCoords(a,h),f=this.tableProps.createCellCoords(i-1,r-1);this.clear(),this.setRangeStartOnly(g,void 0,c),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),a<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.finish(),ap(this,gp,!1)}selectCells(t){var e=this;const o=Zm(t);if(o===Gm)return!1;if(o===$m)throw new Error(B`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const n=tp(o,{createCellCoords:function(){return e.tableProps.createCellCoords(...arguments)},createCellRange:function(){return e.tableProps.createCellRange(...arguments)},propToCol:t=>this.tableProps.propToCol(t),keepDirection:!0}),i=this.settings.navigableHeaders,r={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:i?this.tableProps.countRowHeaders():0,countColHeaders:i?this.tableProps.countColHeaders():0},s=!t.some((t=>{const e=n(t),o=e.isValid(r);return!(o&&!e.containsHeaders()||o&&e.containsHeaders()&&e.isSingleHeader())}));return s&&(this.clear(),A(t,(t=>{const{from:e,to:o}=n(t);this.setRangeStartOnly(e.clone(),!1),this.setRangeEnd(o.clone()),this.finish()}))),s}selectColumns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n="string"===typeof t?this.tableProps.propToCol(t):t,i="string"===typeof e?this.tableProps.propToCol(e):e,r=this.tableProps.countRows(),s=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),a=0===l?0:-l,h=this.tableProps.createCellCoords(a,n),c=this.tableProps.createCellCoords(r-1,i),u=this.tableProps.createCellRange(h,h,c).isValid({countRows:r,countCols:s,countRowHeaders:0,countColHeaders:l});if(u){const t=0===l?0:Bi(o,a,-1),e=r-1,s=this.tableProps.createCellCoords(t,n),h=this.tableProps.createCellCoords(e,i),c=this.tableProps.createCellCoords(Bi(o,a,r-1),n);this.runLocalHooks("beforeSelectColumns",s,h,c),s.row=t,h.row=e,this.setRangeStartOnly(s,void 0,c),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectColumns",s,h,c),this.finish()}return u}selectRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=this.tableProps.countRows(),i=this.tableProps.countCols(),r=this.tableProps.countRowHeaders(),s=0===r?0:-r,l=this.tableProps.createCellCoords(t,s),a=this.tableProps.createCellCoords(e,i-1),h=this.tableProps.createCellRange(l,l,a).isValid({countRows:n,countCols:i,countRowHeaders:r,countColHeaders:0});if(h){const n=0===r?0:Bi(o,s,-1),l=i-1,a=this.tableProps.createCellCoords(t,n),h=this.tableProps.createCellCoords(e,l),c=this.tableProps.createCellCoords(t,Bi(o,s,i-1));this.runLocalHooks("beforeSelectRows",a,h,c),a.col=n,h.col=l,this.setRangeStartOnly(a,void 0,c),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectRows",a,h,c),this.finish()}return h}refresh(){const t=this.highlight.getCustomSelections();if(t.forEach((t=>{t.commit()})),!this.isSelected())return;const e=this.highlight.getFocus(),o=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(let n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);const t=this.highlight.createArea(),e=this.highlight.createLayeredArea(),o=this.highlight.createRowHeader(),i=this.highlight.createColumnHeader(),r=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),l=this.highlight.createActiveCornerHeader(),a=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();t.commit(),e.commit(),o.commit(),i.commit(),r.commit(),s.commit(),l.commit(),a.commit(),h.commit()}this.highlight.useLayerLevel(o)}}bo(fp,ku);var mp=fp;const{register:pp,getItem:wp,hasItem:vp,getNames:Cp,getValues:yp}=xn("cellTypes");function bp(t){if(!vp(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return wp(t)}function Sp(t,e){"string"!==typeof t&&(e=t,t=e.CELL_TYPE);const{editor:o,renderer:n,validator:i}=e;o&&Wn(t,o),n&&wr(t,n),i&&Er(t,i),pp(t,e)}function Rp(t,e){var o;return"CELL_TYPE"!==t&&((null===(o=e._automaticallyAssignedMetaProps)||void 0===o?void 0:o.has(t))||!Io(e,t))}function Ep(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const n="string"===typeof e.type?bp(e.type):e.type;if(t._automaticallyAssignedMetaProps&&To(e,((e,o)=>{t._automaticallyAssignedMetaProps.delete(o)})),!Ro(n))return;o!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);const i={};To(n,((e,n)=>{var r;Rp(n,o)&&(i[n]=e,null===(r=t._automaticallyAssignedMetaProps)||void 0===r||r.add(n))})),wo(t,i)}function Tp(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function o(){}po(o,t);for(let n=0;n<e.length;n++)o.prototype[e[n]]=void 0;return o}function Mp(t){return Number.isInteger(t)&&t>=0}function Hp(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function xp(t){return null===t||void 0===t}var kp=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,o,n;for(e=0,o=this.countRows();e<o;e++)if(n=this.getDataAtCell(e,t),!1===G(n))return!1;return!0},isEmptyRow(t){let e,o,n,i;for(e=0,o=this.countCols();e<o;e++)if(n=this.getDataAtCell(t,e),!1===G(n))return"object"===typeof n&&(i=this.getCellMeta(t,e),So(this.getSchema()[i.prop],n));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function Ip(t,e,o){return e=Ap(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ap(t){var e=Op(t,"string");return"symbol"==typeof e?e:String(e)}function Op(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Pp(){return class{}}class Np{constructor(t){Ip(this,"metaCtor",Pp()),Ip(this,"meta",void 0),this.meta=this.metaCtor.prototype,wo(this.meta,kp()),this.meta.instance=t}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(t){var e;wo(this.meta,t),Ep(this.meta,{...t,type:null!==(e=t.type)&&void 0!==e?e:this.meta.type},t)}}function _p(t,e,o){return e=Lp(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Lp(t){var e=Dp(t,"string");return"symbol"==typeof e?e:String(e)}function Dp(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Wp{constructor(t){_p(this,"meta",void 0);const e=t.getMetaConstructor();this.meta=new e}getMeta(){return this.meta}updateMeta(t){wo(this.meta,t),Ep(this.meta,t,t)}}let Vp;function Fp(t,e,o){return e=jp(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function jp(t){var e=Bp(t,"string");return"symbol"==typeof e?e:String(e)}function Bp(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Vp=Symbol.iterator;class zp{constructor(t){Fp(this,"valueFactory",void 0),Fp(this,"data",[]),Fp(this,"index",[]),Fp(this,"holes",new Set),this.valueFactory=t}obtain(t){Hp((()=>Mp(t)),"Expecting an unsigned number.");const e=this._getStorageIndexByKey(t);let o;if(e>=0)o=this.data[e],void 0===o&&(o=this.valueFactory(t),this.data[e]=o);else if(o=this.valueFactory(t),this.holes.size>0){const e=this.holes.values().next().value;this.holes.delete(e),this.data[e]=o,this.index[t]=e}else this.data.push(o),this.index[t]=this.data.length-1;return o}insert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Hp((()=>Mp(t)||xp(t)),"Expecting an unsigned number or null/undefined argument.");const o=[],n=this.data.length;for(let r=0;r<e;r++)o.push(n+r),this.data.push(void 0);const i=xp(t)?this.index.length:t;this.index=[...this.index.slice(0,i),...o,...this.index.slice(i)]}remove(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Hp((()=>Mp(t)||xp(t)),"Expecting an unsigned number or null/undefined argument.");const o=this.index.splice(xp(t)?this.index.length-e:t,e);for(let n=0;n<o.length;n++){const t=o[n];"number"===typeof t&&this.holes.add(t)}}size(){return this.data.length-this.holes.size}values(){return k(this.data,((t,e)=>!this.holes.has(e)))[Symbol.iterator]()}entries(){const t=[];for(let o=0;o<this.data.length;o++){const e=this._getKeyByStorageIndex(o);-1!==e&&t.push([e,this.data[o]])}let e=0;return{next:()=>{if(e<t.length){const o=t[e];return e+=1,{value:o,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(t){return this.index.length>t?this.index[t]:-1}_getKeyByStorageIndex(t){return this.index.indexOf(t)}[Vp](){return this.entries()}}function Up(t,e,o){return e=$p(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function $p(t){var e=Gp(t,"string");return"symbol"==typeof e?e:String(e)}function Gp(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Yp=["data","width"];class Kp{constructor(t){Up(this,"globalMeta",void 0),Up(this,"metas",new zp((()=>this._createMeta()))),this.globalMeta=t,this.metas=new zp((()=>this._createMeta()))}updateMeta(t,e){const o=this.getMeta(t);wo(o,e),Ep(o,e)}createColumn(t,e){this.metas.insert(t,e)}removeColumn(t,e){this.metas.remove(t,e)}getMeta(t){return this.metas.obtain(t)}getMetaConstructor(t){return this.metas.obtain(t).constructor}clearCache(){this.metas.clear()}_createMeta(){return Tp(this.globalMeta.getMetaConstructor(),Yp).prototype}}function Xp(t,e,o){return e=qp(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function qp(t){var e=Qp(t,"string");return"symbol"==typeof e?e:String(e)}function Qp(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Jp{constructor(t){Xp(this,"columnMeta",void 0),Xp(this,"metas",new zp((()=>this._createRow()))),this.columnMeta=t}updateMeta(t,e,o){const n=this.getMeta(t,e);wo(n,o),Ep(n,o)}createRow(t,e){this.metas.insert(t,e)}createColumn(t,e){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(t,e)}removeRow(t,e){this.metas.remove(t,e)}removeColumn(t,e){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(t,e)}getMeta(t,e,o){const n=this.metas.obtain(t).obtain(e);return void 0===o?n:n[o]}setMeta(t,e,o,n){var i;const r=this.metas.obtain(t).obtain(e);null===(i=r._automaticallyAssignedMetaProps)||void 0===i||i.delete(o),r[o]=n}removeMeta(t,e,o){const n=this.metas.obtain(t).obtain(e);delete n[o]}getMetas(){const t=[],e=Array.from(this.metas.values());for(let o=0;o<e.length;o++)t.push(...e[o].values());return t}getMetasAtRow(t){Hp((()=>Mp(t)),"Expecting an unsigned number.");const e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new zp((t=>this._createMeta(t)))}_createMeta(t){const e=this.columnMeta.getMetaConstructor(t);return new e}}class Zp{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new Np(t),this.tableMeta=new Wp(this.globalMeta),this.columnMeta=new Kp(this.globalMeta),this.cellMeta=new Jp(this.columnMeta),o.forEach((t=>new t(this))),this.globalMeta.updateMeta(e)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(t){this.globalMeta.updateMeta(t)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(t){this.tableMeta.updateMeta(t)}getColumnMeta(t){return this.columnMeta.getMeta(t)}updateColumnMeta(t,e){this.columnMeta.updateMeta(t,e)}getCellMeta(t,e,o){let{visualRow:n,visualColumn:i}=o;const r=this.cellMeta.getMeta(t,e);return r.visualRow=n,r.visualCol=i,r.row=t,r.col=e,this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(t,e,o){if("string"!==typeof o)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,o)}setCellMeta(t,e,o,n){this.cellMeta.setMeta(t,e,o,n)}updateCellMeta(t,e,o){this.cellMeta.updateMeta(t,e,o)}removeCellMeta(t,e,o){this.cellMeta.removeMeta(t,e,o)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(t){return this.cellMeta.getMetasAtRow(t)}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}createColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}removeColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function tw(t,e,o){return e=ew(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ew(t){var e=ow(t,"string");return"symbol"==typeof e?e:String(e)}function ow(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}bo(Zp,ku);class nw{constructor(t){tw(this,"metaManager",void 0),tw(this,"metaSyncMemo",new Map),this.metaManager=t,t.addLocalHook("afterGetCellMeta",(t=>this.extendCellMeta(t))),Mn.getSingleton().add("beforeRender",(t=>{t&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(t){var e;const{row:o,col:n}=t;if(null!==(e=this.metaSyncMemo.get(o))&&void 0!==e&&e.has(n))return;const{visualRow:i,visualCol:r}=t,s=this.metaManager.hot,l=s.colToProp(r);t.prop=l,s.runHooks("beforeGetCellMeta",i,r,t);const a=Io(t,"type")?t.type:null;let h=ro(t.cells)?t.cells(o,n,l):null;var c;a&&(h?h.type=null!==(c=h.type)&&void 0!==c?c:a:h={type:a});h&&this.metaManager.updateCellMeta(o,n,h),s.runHooks("afterGetCellMeta",i,r,t),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(n)}}function iw(t,e,o){return e=rw(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function rw(t){var e=sw(t,"string");return"symbol"==typeof e?e:String(e)}function sw(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class lw{constructor(t){iw(this,"metaManager",void 0),iw(this,"usageTracker",new Set),iw(this,"propDescriptors",new Map([["ariaTags",{onChange(t,e,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){const e=this.metaManager.hot.isRtl();if(e&&"fixedColumnsLeft"===t)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,e,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}],["renderAllColumns",{onChange(t,e,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}],["renderAllRows",{onChange(t,e,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=t,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((t,e)=>{const{target:o,onChange:n=(()=>{})}=t,i="string"===typeof o,r=i?o:e,s=`_${r}`;this.metaManager.globalMeta.meta[s]=this.metaManager.globalMeta.meta[r],this.installPropWatcher(e,s,n),i&&this.installPropWatcher(o,s,n)}))}installPropWatcher(t,e,o){const n=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get(){return this[e]},set(i){const r=!n.usageTracker.has(t);n.usageTracker.add(t),o.call(n,t,i,r),this[e]=i},enumerable:!0,configurable:!0})}}const aw=/^(\r\n|\n\r|\r|\n)/,hw=/^[^\t\r\n]+/,cw=/^\t/;function uw(t){const e=[[""]];if(0===t.length)return e;let o,n=0,i=0;while(t.length>0){if(o===t.length)break;if(o=t.length,t.match(cw))t=t.replace(cw,""),n+=1,e[i][n]="";else if(t.match(aw))t=t.replace(aw,""),n=0,i+=1,e[i]=[""];else{let o="";if(t.startsWith('"')){let e=0,n=!0;while(n){const i=t.slice(0,1);'"'===i&&(e+=1),o+=i,t=t.slice(1),(0===t.length||t.match(/^[\t\r\n]/)&&e%2===0)&&(n=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(t=>new Array(Math.floor(t.length/2)).fill('"').join("")))}else{const e=t.match(hw);o=e?e[0]:"",t=t.slice(o.length)}e[i][n]=o}}return e}function dw(t){let e,o,n,i,r,s="";for(e=0,o=t.length;e<o;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(s+="\t"),r=t[e][n],"string"===typeof r?r.indexOf("\n")>-1?s+=`"${r.replace(/"/g,'""')}"`:s+=r:s+=null===r||void 0===r?"":r;e!==o-1&&(s+="\n")}return s}function gw(t,e,o){return e=fw(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function fw(t){var e=mw(t,"string");return"symbol"==typeof e?e:String(e)}function mw(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class pw{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,e,o){gw(this,"hot",void 0),gw(this,"metaManager",void 0),gw(this,"tableMeta",void 0),gw(this,"dataSource",void 0),gw(this,"duckSchema",void 0),gw(this,"colToPropCache",void 0),gw(this,"propToColCache",void 0),this.hot=t,this.metaManager=o,this.tableMeta=o.getTableMeta(),this.dataSource=e,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const t=this.getSchema();if("undefined"===typeof t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const e=this.tableMeta.columns;let o;if(this.colToPropCache=[],this.propToColCache=new Map,e){let n=0,i=0,r=!1;if("function"===typeof e){const e=xo(t);n=e>0?e:this.countFirstRowKeys(),r=!0}else{const t=this.tableMeta.maxCols;n=Math.min(t,e.length)}for(o=0;o<n;o++){const t=r?e(o):e[o];if(Ro(t)){if("undefined"!==typeof t.data){const e=r?i:o;this.colToPropCache[e]=t.data,this.propToColCache.set(t.data,e)}i+=1}}}else this.recursiveDuckColumns(t)}countFirstRowKeys(){return Cu(this.dataSource)}recursiveDuckColumns(t,e,o){let n,i=e,r=o;return"undefined"===typeof i&&(i=0,r=""),"object"!==typeof t||Array.isArray(t)||To(t,((t,e)=>{null===t?(n=r+e,this.colToPropCache.push(n),this.propToColCache.set(n,i),i+=1):i=this.recursiveDuckColumns(t,i,`${e}.`)})),i}colToProp(t){if(!1===Number.isInteger(t))return t;const e=this.hot.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&U(this.colToPropCache[e])?this.colToPropCache[e]:e}propToCol(t){const e=this.propToColCache.get(t);if(U(e))return this.hot.toVisualColumn(e);const o=this.hot.toVisualColumn(t);return null===o?t:o}getSchema(){const t=this.tableMeta.dataSchema;return t?"function"===typeof t?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?mo(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:o,mode:n="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.hot.countSourceRows();let r=i,s=0,l=t;("number"!==typeof l||l>=i)&&(l=i),l<this.hot.countRows()&&(r=this.hot.toPhysicalRow(l));const a=this.hot.runHooks("beforeCreateRow",l,e,o);if(!1===a||null===r)return{delta:0};const h=this.tableMeta.maxRows,c=this.getSchema().length,u=[];while(s<e&&i+s<h){let t=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?t=Co(this.getSchema()):(t=[],Vi(c-1,(()=>t.push(null)))):"function"===this.hot.dataType?t=this.tableMeta.dataSchema(l+s):(t={},vo(t,this.getSchema())),u.push(t),s+=1}this.hot.rowIndexMapper.insertIndexes(l,s),"below"===n&&(r=Math.min(r+1,i)),this.spliceData(r,0,u);const d=this.hot.toVisualRow(r);return this.hot.countSourceRows()===u.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(void 0===t||null===t?this.metaManager.createRow(null,s):"auto"!==o&&this.metaManager.createRow(r,e)),this.hot.runHooks("afterCreateRow",d,s,o),this.hot.forceFullRender=!0,{delta:s,startPhysicalIndex:r}}createCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:o,mode:n="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,r=this.tableMeta.maxCols,s=this.hot.countSourceCols();let l=t;("number"!==typeof l||l>=s)&&(l=s);const a=this.hot.runHooks("beforeCreateCol",l,e,o);if(!1===a)return{delta:0};let h=s;l<this.hot.countCols()&&(h=this.hot.toPhysicalColumn(l));const c=this.hot.countSourceRows();let u=this.hot.countCols(),d=0,g=h;"end"===n&&(g=Math.min(g+1,s));const f=g;while(d<e&&u<r){if("number"!==typeof l||l>=u)if(c>0)for(let t=0;t<c;t+=1)"undefined"===typeof i[t]&&(i[t]=[]),i[t].push(null);else i.push([null]);else for(let t=0;t<c;t++)i[t].splice(g,0,null);d+=1,g+=1,u+=1}this.hot.columnIndexMapper.insertIndexes(l,d),d>0&&(void 0===t||null===t?this.metaManager.createColumn(null,d):"auto"!==o&&this.metaManager.createColumn(f,e));const m=this.hot.toVisualColumn(f);return this.hot.runHooks("afterCreateCol",m,d,o),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:d,startPhysicalIndex:f}}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,n=Number.isInteger(t)?t:-e;const i=this.visualRowsToPhysical(n,e),r=this.hot.countSourceRows();n=(r+n)%r;const s=this.hot.runHooks("beforeRemoveRow",n,i.length,i,o);if(!1===s)return!1;const l=i.length;if(this.filterData(n,l,i),n<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(i);const t=U(this.tableMeta.columns)||U(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===t&&this.hot.columnIndexMapper.setIndexesSequence([])}const a=i.slice(0).sort(((t,e)=>e-t));return a.forEach((t=>{this.metaManager.removeRow(t,1)})),this.hot.runHooks("afterRemoveRow",n,l,i,o),this.hot.forceFullRender=!0,!0}removeCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let n="number"!==typeof t?-e:t;n=(this.hot.countCols()+n)%this.hot.countCols();const i=this.visualColumnsToPhysical(n,e),r=i.slice(0).sort(((t,e)=>e-t)),s=this.hot.runHooks("beforeRemoveCol",n,e,i,o);if(!1===s)return!1;let l=!0;const a=r.length,h=this.dataSource;for(let c=0;c<a;c++)l&&i[0]!==i[c]-c&&(l=!1);if(l)for(let c=0,u=this.hot.countSourceRows();c<u;c++)h[c].splice(i[0],e),0===c&&this.metaManager.removeColumn(i[0],e);else for(let c=0,u=this.hot.countSourceRows();c<u;c++)for(let t=0;t<a;t++)h[c].splice(r[t],1),0===c&&this.metaManager.removeColumn(r[t],1);return n<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(i),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",n,e,i,o),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,e,o){const n=this.hot.getDataAtCol(t),i=n.slice(e,e+o),r=n.slice(e+o);for(var s=arguments.length,l=new Array(s>3?s-3:0),a=3;a<s;a++)l[a-3]=arguments[a];M(l,r);let h=0;while(h<o)l.push(null),h+=1;return T(l),this.hot.populateFromArray(e,t,l,null,null,"spliceCol"),i}spliceRow(t,e,o){const n=this.hot.getSourceDataAtRow(t),i=n.slice(e,e+o),r=n.slice(e+o);for(var s=arguments.length,l=new Array(s>3?s-3:0),a=3;a<s;a++)l[a-3]=arguments[a];M(l,r);let h=0;while(h<o)l.push(null),h+=1;return this.hot.populateFromArray(t,e,[l],null,null,"spliceRow"),i}spliceData(t,e,o){const n=this.hot.runHooks("beforeDataSplice",t,e,o);if(!1!==n){const e=[...this.dataSource.slice(0,t),...o,...this.dataSource.slice(t)];this.dataSource.length=0,e.forEach((t=>this.dataSource.push(t)))}}filterData(t,e,o){let n=this.hot.runHooks("filterData",t,e,o);!1===Array.isArray(n)&&(n=this.dataSource.filter(((t,e)=>-1===o.indexOf(e)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,n)}get(t,e){const o=this.hot.toPhysicalRow(t);let n=this.dataSource[o];const i=this.hot.runHooks("modifyRowData",o);n=isNaN(i)?i:n;let r=null;if(n&&n.hasOwnProperty&&Io(n,e))r=n[e];else if("string"===typeof e&&e.indexOf(".")>-1){const t=e.split(".");let o=n;if(!o)return null;for(let e=0,n=t.length;e<n;e++)if(o=o[t[e]],"undefined"===typeof o)return null;r=o}else"function"===typeof e&&(r=e(this.dataSource.slice(o,o+1)[0]));if(this.hot.hasHook("modifyData")){const t=ko(r);this.hot.runHooks("modifyData",o,this.propToCol(e),t,"get"),t.isTouched()&&(r=t.value)}return r}getCopyable(t,e){return this.hot.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}set(t,e,o){const n=this.hot.toPhysicalRow(t);let i=o,r=this.dataSource[n];const s=this.hot.runHooks("modifyRowData",n);if(r=isNaN(s)?s:r,this.hot.hasHook("modifyData")){const t=ko(i);this.hot.runHooks("modifyData",n,this.propToCol(e),t,"set"),t.isTouched()&&(i=t.value)}if(r&&r.hasOwnProperty&&Io(r,e))r[e]=i;else if("string"===typeof e&&e.indexOf(".")>-1){const t=e.split(".");let o,n=r,s=0;for(s=0,o=t.length-1;s<o;s++)"undefined"===typeof n[t[s]]&&(n[t[s]]={}),n=n[t[s]];n[t[s]]=i}else"function"===typeof e?e(this.dataSource.slice(n,n+1)[0],i):r[e]=i}visualRowsToPhysical(t,e){const o=this.hot.countSourceRows(),n=[];let i,r=(o+t)%o,s=e;while(r<o&&s)i=this.hot.toPhysicalRow(r),n.push(i),s-=1,r+=1;return n}visualColumnsToPhysical(t,e){const o=this.hot.countCols(),n=[];let i=(o+t)%o,r=e;while(i<o&&r){const t=this.hot.toPhysicalColumn(i);n.push(t),r-=1,i+=1}return n}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let e=0;e<this.hot.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){const t=this.tableMeta.maxRows;let e;e=t<0||0===t?0:t||1/0;const o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,e)}getAll(){const t={row:0,col:0},e={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return t.row-e.row!==0||this.hot.countSourceRows()?this.getRange(t,e,pw.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(t,e,o){const n=[];let i,r,s;const l=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===l||0===a)return[];const h=o===pw.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(l-1,0),Math.max(t.row,e.row)),u=Math.min(Math.max(a-1,0),Math.max(t.col,e.col));for(i=Math.min(t.row,e.row);i<=c;i++){s=[];const o=i>=0?this.hot.toPhysicalRow(i):i;for(r=Math.min(t.col,e.col);r<=u;r++){if(null===o)break;s.push(h.call(this,i,this.colToProp(r)))}null!==o&&n.push(s)}return n}getText(t,e){return dw(this.getRange(t,e,pw.DESTINATION_RENDERER))}getCopyableText(t,e){return dw(this.getRange(t,e,pw.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}var ww=pw;function vw(t,e,o,n){const{hotInstance:i,dataMap:r,dataSource:s,internalSource:l,source:a,metaManager:h,firstRun:c}=n,u=lt(l),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":ro(d.dataSchema)?i.dataType="function":i.dataType="object",r&&r.destroy(),t=i.runHooks(`before${u}`,t,c,a);const g=new ww(i,t,h);if(e(g),"object"===typeof t&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error(`${l} only accepts array of objects or array of arrays (${typeof t} given)`);{const e=g.getSchema();let o;t=[];let n=0,r=0;for(n=0,r=d.startRows;n<r;n++)if("object"!==i.dataType&&"function"!==i.dataType||!d.dataSchema)if("array"===i.dataType)o=Co(e[0]),t.push(o);else{o=[];for(let t=0,e=d.startCols;t<e;t++)o.push(null);t.push(o)}else o=Co(e),t.push(o)}}Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),o(g),i.runHooks(`after${u}`,t,c,a),c||(i.runHooks("afterChange",null,l),i.render()),i.getSettings().ariaTags&&fe(i.rootElement,[Lt(-1),Dt(i.countCols()+(i.view?i.countRowHeaders():0))])}const Cw="gridDefault",yw="editorManager.handlingEditor";function bw(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=t.rootElement,n=Sw(t),i=Sw(t);return n.addEventListener("focus",(()=>null===e||void 0===e?void 0:e.onFocusFromTop())),i.addEventListener("focus",(()=>null===e||void 0===e?void 0:e.onFocusFromBottom())),o.firstChild.before(n),o.lastChild.after(i),{activate(){t._registerTimeout((()=>{n.tabIndex=0,i.tabIndex=0}),10)},deactivate(){t._registerTimeout((()=>{n.tabIndex=-1,i.tabIndex=-1}),10)}}}function Sw(t){const e=t.rootDocument,o=e.createElement("input");return o.type="text",o.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&fe(o,[pt(),Ot()]),o}function Rw(t){const e=Mw(t);let o;const{activate:n,deactivate:i}=bw(t,{onFocusFromTop(){var n;const i=null!==(n=e(o))&&void 0!==n?n:Ew(t);i&&(t.runHooks("modifyFocusOnTabNavigation","from_above",i),t.selectCell(i.row,i.col)),t.listen()},onFocusFromBottom(){var n;const i=null!==(n=e(o))&&void 0!==n?n:Tw(t);i&&(t.runHooks("modifyFocusOnTabNavigation","from_below",i),t.selectCell(i.row,i.col)),t.listen()}}),r={wrapped:!1,flipped:!1};let s=!0,l=!1,a=!1;function h(){r.wrapped=!1,r.flipped=!1,t.deselectCell(),t.unlisten()}t.addHook("afterListen",(()=>i())),t.addHook("afterUnlisten",(()=>n())),t.addHook("afterSelection",((e,n,i,h,c)=>{var u;(l&&(r.wrapped&&r.flipped||a)&&(a=!1,c.value=!0),s)&&(o=null===(u=t.getSelectedRangeLast())||void 0===u?void 0:u.highlight)})),t.addHook("beforeRowWrap",((t,e,o)=>{r.wrapped=!0,r.flipped=o}));const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Cw,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:e}=t.getSettings();l=!0,t.getSelectedRangeLast()&&!e&&(s=!1),e||(a=!0)},position:"before"},{...c,callback:e=>{const{tabNavigation:n,autoWrapRow:i}=t.getSettings();if(l=!1,s=!0,!n||!t.selection.isSelected()||i&&r.wrapped&&r.flipped||!i&&r.wrapped)return i&&r.wrapped&&r.flipped&&(o=e.shiftKey?Ew(t):Tw(t)),h(),!1;e.preventDefault()},position:"after"}])}function Ew(t){const{rowIndexMapper:e,columnIndexMapper:o}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,r=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return 0===i&&(i=e.getVisualFromRenderableIndex(i)),0===r&&(r=o.getVisualFromRenderableIndex(r)),null===i||null===r?null:t._createCellCoords(i,r)}function Tw(t){var e,o;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:r}=t.getSettings();let s=n.getRenderableIndexesLength()-1,l=i.getRenderableIndexesLength()-1;if(s<0){if(!r||0===t.countColHeaders())return null;s=-1}if(l<0){if(!r||0===t.countColHeaders())return null;l=-1}return t._createCellCoords(null!==(e=n.getVisualFromRenderableIndex(s))&&void 0!==e?e:s,null!==(o=i.getVisualFromRenderableIndex(l))&&void 0!==o?o:l)}function Mw(t){return e=>{if(!e)return null;const o=Ew(t),n=Tw(t);return e.col<o.col&&(e.col=o.col),e.col>n.col&&(e.col=n.col),e.row<o.row&&(e.row=o.row),e.row>n.row&&(e.row=n.row),e}}const Hw=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),xw=t=>t.map((t=>{const e=t.toLowerCase();return Hw.has(e)?Hw.get(e):e})).sort().join("+"),kw=t=>t.split("+"),Iw=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),Aw=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),Ow=t=>{let{key:e,code:o}=t,n=e;return Iw.test(o)?n=o.replace(Iw,"$1"):Aw.has(o)&&(n=o),n.toLowerCase()},Pw=Symbol("shortcut-context");function Nw(t){return Ro(t)&&t.__kindOf===Pw}const _w=t=>{const e=qi({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`}),o=function(){let{keys:t,callback:o,group:n,runOnlyIf:i=(()=>!0),captureCtrl:r=!1,preventDefault:s=!0,stopPropagation:l=!1,relativeToGroup:a,position:h,forwardToContext:c}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if($(n))throw new Error("You need to define the shortcut's group.");if(!1===ro(o))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw new Error(B`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const u={callback:o,group:n,runOnlyIf:i,captureCtrl:r,preventDefault:s,stopPropagation:l};U(a)&&([u.relativeToGroup,u.position]=[a,h]),Nw(c)&&(u.forwardToContext=c),t.forEach((t=>{const o=xw(t),n=e.hasItem(o);if(n){const t=e.getItem(o);let n=t.findIndex((t=>t.group===a));-1!==n?"before"===h?n-=1:n+=1:n=t.length,t.splice(n,0,u)}else e.addItem(o,[u])}))},n=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach((t=>{To(e,((o,n)=>{!1===Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=e[n])})),o(t)}))},i=t=>{const o=xw(t);e.removeItem(o)},r=t=>{const o=e.getItems();o.forEach((e=>{let[o,n]=e;const r=n.filter((e=>e.group!==t));0===r.length?i(kw(o)):(n.length=0,n.push(...r))}))},s=t=>{const o=xw(t),n=e.getItem(o);return U(n)?n.slice():[]},l=t=>{const o=xw(t);return e.hasItem(o)};return{__kindOf:Pw,addShortcut:o,addShortcuts:n,getShortcuts:s,hasShortcut:l,removeShortcutsByKeys:i,removeShortcutsByGroup:r}};function Lw(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Dw=["meta","alt","shift","control"],Ww=Lw();let Vw=0;function Fw(t,e,o,n,i){const r=t=>Dw.includes(t),s=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=[];return t.altKey&&o.push("alt"),e&&(t.ctrlKey||t.metaKey)?o.push("control/meta"):(t.ctrlKey&&o.push("control"),t.metaKey&&o.push("meta")),t.shiftKey&&o.push("shift"),o},l=t=>{if(!1===e(t))return;const l=o(t);if(229===t.keyCode||!1===l||cn(t))return;const a=Ow(t);let h=[];r(a)||(h=s(t));const c=[a].concat(h),u=i(t,c);!u&&(Zo()&&h.includes("meta")||!Zo()&&h.includes("control"))&&i(t,[a].concat(s(t,!0))),n(t)},a=t=>{const e=Ow(t);r(e)&&Ww.press(e)},h=t=>{const e=Ow(t);r(e)&&Ww.release(e)},c=()=>{Ww.releaseAll()},u=()=>{let e=t;Vw+=1;while(e)1===Vw&&(e.document.documentElement.addEventListener("keydown",a),e.document.documentElement.addEventListener("keyup",h)),e.document.documentElement.addEventListener("keydown",l),e.document.documentElement.addEventListener("blur",c),e=oe(e)},d=()=>{let e=t;Vw-=1;while(e)0===Vw&&(e.document.documentElement.removeEventListener("keydown",a),e.document.documentElement.removeEventListener("keyup",h)),e.document.documentElement.removeEventListener("keydown",l),e.document.documentElement.removeEventListener("blur",c),e=oe(e)};return{mount:u,unmount:d,isPressed:t=>Ww.isPressed(t),releasePressedKeys:()=>Ww.releaseAll()}}const jw=t=>{let{ownerWindow:e,handleEvent:o,beforeKeyDown:n,afterKeyDown:i}=t;const r=qi({errorIdExists:t=>`The "${t}" context name is already registered.`});let s="grid";const l=t=>{const e=_w(t);return r.addItem(t,e),e},a=()=>s,h=t=>r.getItem(t),c=t=>{if(!r.hasItem(t))throw new Error(B`You've tried to activate the "${t}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=t};let u=!1;const d=function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a();const n=Nw(o)?o:h(o);let i=!1;if(!n.hasShortcut(e))return i;const r=n.getShortcuts(e);for(let s=0;s<r.length;s++){const{callback:o,runOnlyIf:n,preventDefault:l,stopPropagation:a,captureCtrl:h,forwardToContext:c}=r[s];if(!0===n(t)){if(u=h,i=!1===o(t,e),u=!1,l&&t.preventDefault(),a&&(hn(t),t.stopPropagation()),i)break;c&&d(t,e,c)}}return i},g=Fw(e,o,n,i,d);return g.mount(),{addContext:l,getActiveContextName:a,getContext:h,setActiveContextName:c,isCtrlPressed:()=>!u&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}},Bw={name:"editorCloseAndSave",callback(t,e,o){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(o.includes("shift"))}},zw={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Uw={name:"editorFastOpen",callback(t,e){const{highlight:o}=t.getSelectedRangeLast();o.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},$w={name:"editorOpen",callback(t,e,o){const n=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter():n.openEditor(null,e,!0):n.moveSelectionAfterEnter(o.includes("shift")),hn(e))}};function Gw(){return[Bw,zw,Uw,$w]}const Yw={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},Kw={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),o=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),n=t.rowIndexMapper.getNearestNotHiddenIndex(o,-1);if(null!==n){const o=t._createCellCoords(n,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),r=Math.min(o.row-i,t.countRows()-1);t.selection.setRangeEnd(o),t.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}},Xw={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},qw={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},Qw={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:o,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(o.col,n.col,e.row)}},Jw={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:o}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||s){const n=o.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(n,r.col))}}},Zw={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n}=t.getSelectedRangeLast();n.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,o.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},tv={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n}=t.getSelectedRangeLast();n.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,o.getNearestNotHiddenIndex(0,1)))}},ev={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||s){const n=o.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r.row,n))}}},ov={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||s){const n=o.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r.row,n))}}},nv={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:o}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||s){const n=o.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(n,r.col))}}},iv={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:o,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(o.row,n.row,e.col)}},rv={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},sv={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),o=Math.max(e.row-t.countVisibleRows(),0),n=t.rowIndexMapper.getNearestNotHiddenIndex(o,1);if(null!==n){const o=t._createCellCoords(n,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),r=Math.max(o.row-i,0);t.selection.setRangeEnd(o),t.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}};function lv(){return[Yw,Kw,Xw,qw,Qw,Jw,Zw,tv,ev,ov,nv,iv,rv,sv]}const av={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},hv={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),o=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+o;n===t.countRows()-1?i=1:n+i>t.countRows()&&(i=t.countRows()-n-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},cv={name:"moveCellSelectionInlineEnd",callback(t,e){const o=t.getSettings(),n="function"===typeof o.tabMoves?o.tabMoves(e):o.tabMoves;t.selection.transformStart(-n.row,-n.col)}},uv={name:"moveCellSelectionInlineStart",callback(t,e){const o=t.getSettings(),n="function"===typeof o.tabMoves?o.tabMoves(e):o.tabMoves;t.selection.transformStart(n.row,n.col)}},dv={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},gv={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},fv={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let o=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);null===o&&(o=-1),t.selection.setRangeStart(t._createCellCoords(o,e))}},mv={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:o,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),r=o.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(r,s))}},pv={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:o}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,o.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},wv={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:o}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,r=o.getNearestNotHiddenIndex(n,1);e.setRangeStart(t._createCellCoords(i,r))}},vv={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:o}=t,n=t.getSelectedRangeLast().highlight.row;let i=o.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);null===i&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(n,i))}},Cv={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:o}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=o.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);null===i&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(n,i))}},yv={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let o=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===o&&(o=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(o,e))}},bv={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:o,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),r=parseInt(t.getSettings().fixedColumnsStart,10),s=o.getNearestNotHiddenIndex(i,1),l=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(s,l))}},Sv={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},Rv={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),o=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+o);n===-o?i=-1:n+i<o&&(i=-(n+o)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function Ev(){return[av,hv,cv,uv,dv,gv,fv,mv,pv,wv,vv,Cv,yv,bv,Sv,Rv]}const Tv={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Mv={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),o=t.view.getFirstFullyVisibleRow()-1,n=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,r=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(o,n),l=t._createCellCoords(i,r),a=t._createCellRange(s,s,l);if(!a.includes(e)&&(e.row>=0||e.col>=0)){const o={};if(e.col>=0){const n=Math.floor(t.countVisibleCols()/2);o.col=Math.max(e.col-n,0)}if(e.row>=0){const n=Math.floor(t.countVisibleRows()/2);o.row=Math.max(e.row-n,0)}t.scrollViewportTo({...o,verticalSnap:"top",horizontalSnap:"start"})}}},Hv={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},xv={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},kv={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:o,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(o,n),r=new Map;for(let s=0;s<e.length;s++)e[s].forAll(((e,s)=>{if(e>=0&&s>=0&&(e!==o||s!==n)){const{readOnly:o}=t.getCellMeta(e,s);o||r.set(`${e}x${s}`,[e,s,i])}}));t.setDataAtCell(Array.from(r.values()))}},Iv=[...Gw(),...lv(),...Ev(),Tv,Mv,Hv,xv,kv];function Av(t){const e={};return Iv.forEach((o=>{let{name:n,callback:i}=o;e[n]=function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return i(t,...o)}})),e}function Ov(t){const e=t.getShortcutManager().addContext("editor"),o=Av(t),n={group:yw};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>o.editorCloseAndSave(t,e)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(t,e)=>o.editorCloseAndSave(t,e)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>o.editorCloseWithoutSaving()}],n)}function Pv(t){const e=t.getShortcutManager().addContext("grid"),o=Av(t),n={runOnlyIf:()=>{const{navigableHeaders:e}=t.getSettings();return U(t.getSelected())&&(e||!e&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:Cw};e.addShortcuts([{keys:[["F2"]],callback:t=>o.editorFastOpen(t)},{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>o.editorOpen(t,e)},{keys:[["Backspace"],["Delete"]],callback:()=>o.emptySelectedCells()}],{group:yw,runOnlyIf:()=>U(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>o.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>o.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>o.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>o.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>o.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>o.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>o.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>o.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>o.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>o.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>o.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>o.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>o.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>o.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>o.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>o.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>o.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>o.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>o.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>o.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>o.scrollToFocusedCell()}],n)}function Nv(t){[Ov,Pv].forEach((e=>e(t)))}let _v=null;const Lv=new Map;new Set;function Dv(t,e){var o,n=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,s=this;const l=new $n(s);let a,h,c,u,d,g=!0;Wc(i)&&Dc(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const f=null!==(o=null===e||void 0===e?void 0:e.layoutDirection)&&void 0!==o?o:"inherit",m=["rtl","ltr"].includes(f)?f:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return"rtl"===m},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=Pf(e.language);const p=new Zp(s,e,[nw,lw]),w=p.getTableMeta(),v=p.getGlobalMeta(),C=qi();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Vc(this)&&rt(e.licenseKey,t),this.guid=`ht_${ht()}`,Lv.set(this.guid,this),this.columnIndexMapper=new Od,this.rowIndexMapper=new Od,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(t=>{s.runHooks("afterColumnSequenceChange",t)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(t=>{s.runHooks("afterRowSequenceChange",t)})),h=new Mu(s),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);const y=t=>{const{row:e,col:o}=t;return s._createCellCoords(e>=0?s.rowIndexMapper.getRenderableFromVisualIndex(e):e,o>=0?s.columnIndexMapper.getRenderableFromVisualIndex(o):o)},b=t=>{const{row:e,col:o}=t;return s._createCellCoords(e>=0?s.rowIndexMapper.getVisualFromRenderableIndex(e):e,o>=0?s.columnIndexMapper.getVisualFromRenderableIndex(o):o)};let S=new mp(w,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:t=>a.propToCol(t),isEditorOpened:()=>!!s.getActiveEditor()&&s.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(t,e)=>s._createCellCoords(t,e),createCellRange:(t,e,o)=>s._createCellRange(t,e,o),visualToRenderableCoords:y,renderableToVisualCoords:b,isDisabledCellSelection:(t,e)=>t<0||e<0?s.getSettings().disableVisualSelection:s.getCellMeta(t,e).disableVisualSelection});this.selection=S;const R=t=>{let{hiddenIndexesChanged:e}=t;e&&this.selection.refresh()};function E(t){const e=Nd(t);kf(e)?(s.runHooks("beforeLanguageChange",e),v.language=e,s.runHooks("afterLanguageChange",e)):_d(t)}function T(t,e){const o="className"===t?s.rootElement:s.table;if(g)de(o,e);else{let n=[],i=[];v[t]&&(n=Array.isArray(v[t])?v[t]:j(v[t])),e&&(i=Array.isArray(e)?e:j(e));const r=W(n,i),s=W(i,n);r.length&&ge(o,r),s.length&&de(o,s)}v[t]=e}function M(){let t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function k(t){const e=t.replace(",",".");return!1===isNaN(parseFloat(e))?parseFloat(e):t}function O(t,e,o){if(!t.length)return;const n=s.getActiveEditor(),i=new M;let r=!0;i.onQueueEmpty=t=>{n&&r&&n.cancelChanges(),o(t)};for(let l=t.length-1;l>=0;l--){const[o,n,,h]=t[l],c=a.propToCol(n),u=s.getCellMeta(o,c);"numeric"===u.type&&"string"===typeof h&&Wi(h)&&(t[l][3]=k(h)),s.getCellValidator(u)&&(i.addValidatorToQueue(),s.validateCell(t[l][3],u,function(e,o){return function(n){if("boolean"!==typeof n)throw new Error("Validation error: result is not boolean");if(!1===n&&!1===o.allowInvalid){r=!1,t.splice(e,1),o.valid=!0;const n=s.getCell(o.visualRow,o.visualCol);null!==n&&ge(n,w.invalidCellClassName)}i.removeValidatorFormQueue()}}(l,u),e))}i.checkIfQueueIsEmpty()}function P(t,e){let o=t.length-1;if(o<0)return;for(;o>=0;o--){let n=!1;if(null!==t[o]){if(null!==t[o][2]&&void 0!==t[o][2]||null!==t[o][3]&&void 0!==t[o][3]){if(w.allowInsertRow)while(t[o][0]>s.countRows()-1){const{delta:t}=a.createRow(void 0,void 0,{source:e});if(0===t){n=!0;break}}if("array"===s.dataType&&(!w.columns||0===w.columns.length)&&w.allowInsertColumn)while(a.propToCol(t[o][1])>s.countCols()-1){const{delta:t}=a.createCol(void 0,void 0,{source:e});if(0===t){n=!0;break}}n||a.set(t[o][0],t[o][1],t[o][3])}}else t.splice(o,1)}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",t,e),u.lockEditor(),s._refreshBorders(null),u.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",t,e||"edit");const n=s.getActiveEditor();n&&U(n.refreshValue)&&n.refreshValue()}function N(t,e,o){return Array.isArray(t)?t:[[t,e,o]]}function _(t,e){const o=s.getActiveEditor(),n=s.runHooks("beforeChange",t,e||"edit"),i=t.filter((t=>null!==t));return!1===n||0===i.length?(o&&o.cancelChanges(),[]):i}this.columnIndexMapper.addLocalHook("cacheUpdated",R),this.rowIndexMapper.addLocalHook("cacheUpdated",R),this.selection.addLocalHook("afterSetRangeEnd",(t=>{const e=ko(!1),o=this.selection.getSelectedRange(),{from:n,to:i}=o.current(),l=o.size()-1;this.runHooks("afterSelection",n.row,n.col,i.row,i.col,e,l),this.runHooks("afterSelectionByProp",n.row,s.colToProp(n.col),i.row,s.colToProp(i.col),e,l);let a=!0;r&&(a=!1),e.isTouched()&&(a=!e.value);const h=this.selection.selectedRange.current(),c=this.selection.isSelectedByAnyHeader(),u=this.selection.isSelectedByRowHeader(),d=this.selection.isSelectedByColumnHeader();if(!1!==a)if(c)u?this.scrollViewportTo({row:t.row}):d&&this.scrollViewportTo({col:t.col});else if(h&&!this.selection.isMultiple()){const{row:t,col:e}=h.from;t<0&&e>=0?this.scrollViewportTo({col:e}):e<0&&t>=0?this.scrollViewportTo({row:t}):this.scrollViewportTo({row:t,col:e})}else this.scrollViewportTo(t.toObject());u&&d?de(this.rootElement,["ht__selection--rows","ht__selection--columns"]):u?(ge(this.rootElement,"ht__selection--columns"),de(this.rootElement,"ht__selection--rows")):d?(ge(this.rootElement,"ht__selection--rows"),de(this.rootElement,"ht__selection--columns")):ge(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(t=>{const e=t.length-1,{from:o,to:n}=t[e];this.runHooks("afterSelectionEnd",o.row,o.col,n.row,n.col,e),this.runHooks("afterSelectionEndByProp",o.row,s.colToProp(o.col),n.row,s.colToProp(n.col),e)})),this.selection.addLocalHook("afterIsMultipleSelection",(t=>{const e=this.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)})),this.selection.addLocalHook("afterDeselect",(()=>{u.destroyEditor(),this._refreshBorders(),ge(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("beforeHighlightSet",(()=>this.runHooks("beforeSelectionHighlightSet"))).addLocalHook("beforeSetRangeStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSetRangeStart",...e)})).addLocalHook("beforeSetRangeStartOnly",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSetRangeStartOnly",...e)})).addLocalHook("beforeSetRangeEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSetRangeEnd",...e)})).addLocalHook("beforeSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSelectColumns",...e)})).addLocalHook("afterSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterSelectColumns",...e)})).addLocalHook("beforeSelectRows",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSelectRows",...e)})).addLocalHook("afterSelectRows",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterSelectRows",...e)})).addLocalHook("beforeModifyTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("modifyTransformStart",...e)})).addLocalHook("afterModifyTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterModifyTransformStart",...e)})).addLocalHook("beforeModifyTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("modifyTransformEnd",...e)})).addLocalHook("afterModifyTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterModifyTransformEnd",...e)})).addLocalHook("beforeRowWrap",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeRowWrap",...e)})).addLocalHook("beforeColumnWrap",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeColumnWrap",...e)})).addLocalHook("insertRowRequire",(t=>this.alter("insert_row_above",t,1,"auto"))).addLocalHook("insertColRequire",(t=>this.alter("insert_col_start",t,1,"auto"))),c={alter(t,e){var o,n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;const h=t=>{if(0===t.length)return[];const e=[...t];e.sort(((t,e)=>{let[o]=t,[n]=e;return o===n?0:o>n?1:-1}));const o=x(e,((t,e)=>{let[o,n]=e;const i=t[t.length-1],[r,s]=i,l=r+s;if(o<=l){const t=Math.max(n-(l-o),0);i[1]+=t}else t.push([o,n]);return t}),[e[0]]);return o};switch(t){case"insert_row_below":case"insert_row_above":const l=s.countSourceRows();if(w.maxRows===l)return;const u="insert_row_below"===t?"below":"above";e=null!==(o=e)&&void 0!==o?o:"below"===u?l:0;const{delta:d,startPhysicalIndex:g}=a.createRow(e,i,{source:r,mode:u});if(d){const t=S.selectedRange.current(),e=null===t||void 0===t?void 0:t.from,o=null===e||void 0===e?void 0:e.row,n=s.toVisualRow(g);if(S.isSelectedByCorner())S.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(U(o)&&o>=n){const{row:n,col:i}=t.to;let r=e.col;S.isSelectedByRowHeader()&&(r=-1),S.getSelectedRange().pop(),S.setRangeStartOnly(s._createCellCoords(o+d,r),!0),S.setRangeEnd(s._createCellCoords(n+d,i))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const f="insert_col_end"===t?"end":"start";e=null!==(n=e)&&void 0!==n?n:"end"===f?s.countSourceCols():0;const{delta:m,startPhysicalIndex:p}=a.createCol(e,i,{source:r,mode:f});if(m){if(Array.isArray(w.colHeaders)){const t=[s.toVisualColumn(p),0];t.length+=m,Array.prototype.splice.apply(w.colHeaders,t)}const t=S.selectedRange.current(),e=null===t||void 0===t?void 0:t.from,o=null===e||void 0===e?void 0:e.col,n=s.toVisualColumn(p);if(S.isSelectedByCorner())S.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(U(o)&&o>=n){const{row:n,col:i}=t.to;let r=e.row;S.isSelectedByColumnHeader()&&(r=-1),S.getSelectedRange().pop(),S.setRangeStartOnly(s._createCellCoords(r,o+m),!0),S.setRangeEnd(s._createCellCoords(n,i+m))}else s._refreshBorders()}break;case"remove_row":const v=t=>{let e=0;A(t,(t=>{let[o,n]=t;const i=G(o)?s.countRows()-1:Math.max(o-e,0);Number.isInteger(o)&&(o=Math.max(o-e,0));const l=a.removeRow(o,n,r);if(!l)return;const h=s.countRows(),c=w.fixedRowsTop;c>=i+1&&(w.fixedRowsTop-=Math.min(n,c-i));const u=w.fixedRowsBottom;u&&i>=h-u&&(w.fixedRowsBottom-=Math.min(n,u)),e+=n}))};Array.isArray(e)?v(h(e)):v([[e,i]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const C=t=>{let e=0;A(t,(t=>{let[o,n]=t;const i=G(o)?s.countCols()-1:Math.max(o-e,0);let l=s.toPhysicalColumn(i);Number.isInteger(o)&&(o=Math.max(o-e,0));const h=a.removeCol(o,n,r);if(!h)return;const c=w.fixedColumnsStart;c>=i+1&&(w.fixedColumnsStart-=Math.min(n,c-i)),Array.isArray(w.colHeaders)&&("undefined"===typeof l&&(l=-1),w.colHeaders.splice(l,n)),e+=n}))};Array.isArray(e)?C(h(e)):C([[e,i]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${t}"`)}l||c.adjustRowsAndCols()},adjustRowsAndCols(){const t=w.minRows,e=w.minSpareRows,o=w.minCols,n=w.minSpareCols;if(0===s.countRows()&&0===s.countCols()&&S.deselect(),t){const e=s.countRows();e<t&&a.createRow(e,t-e,{source:"auto"})}if(e){const t=s.countEmptyRows(!0);if(t<e){const o=e-t,n=Math.min(o,w.maxRows-s.countSourceRows());a.createRow(s.countRows(),n,{source:"auto"})}}{let t;(o||n)&&(t=s.countEmptyCols(!0));let e=s.countCols();if(o&&!w.columns&&e<o){const n=o-e;t+=n,a.createCol(e,n,{source:"auto"})}if(n&&!w.columns&&"array"===s.dataType&&t<n){e=s.countCols();const o=n-t,i=Math.min(o,w.maxCols-e);a.createCol(e,i,{source:"auto"})}}if(S.isSelected()){const t=s.countRows(),e=s.countCols();A(S.selectedRange,(o=>{let n=!1,i=o.from.row,r=o.from.col,l=o.to.row,a=o.to.col;i>t-1?(i=t-1,n=!0,l>i&&(l=i)):l>t-1&&(l=t-1,n=!0,i>l&&(i=l)),r>e-1?(r=e-1,n=!0,a>r&&(a=r)):a>e-1&&(a=e-1,n=!0,r>a&&(r=a)),n&&s.selectCell(i,r,l,a)}))}s.view&&s.view.adjustElementsSize()},populateFromArray(t,e,o,n,i){let r,l,a,h;const c=[],u={},d=[],g=t.row,f=t.col;if(l=e.length,0===l)return!1;let m=0,p=0;switch(Ro(o)&&(m=o.col-f+1,p=o.row-g+1),i){case"shift_down":const i=H(e),v=i.length,C=Math.max(v,m),y=s.getData().slice(g),b=H(y).slice(f,f+C);for(a=0;a<C;a+=1)if(a<v){for(r=0,l=i[a].length;r<p-l;r+=1)i[a].push(i[a][r%l]);a<b.length?d.push(i[a].concat(b[a])):d.push(i[a].concat(new Array(y.length).fill(null)))}else d.push(i[a%v].concat(b[a]));s.populateFromArray(g,f,H(d));break;case"shift_right":const S=e.length,R=Math.max(S,p),E=s.getData().slice(g).map((t=>t.slice(f)));for(r=0;r<R;r+=1)if(r<S){for(a=0,h=e[r].length;a<m-h;a+=1)e[r].push(e[r][a%h]);if(r<E.length)for(let t=0;t<E[r].length;t+=1)e[r].push(E[r][t]);else e[r].push(...new Array(E[0].length).fill(null))}else e.push(e[r%l].slice(0,R).concat(E[r]));s.populateFromArray(g,f,e);break;case"overwrite":default:u.row=t.row,u.col=t.col;let T,M=0,x=0,k=!0;const I=function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=e[t%e.length];return null!==o?n[o%n.length]:n},A=e.length,O=o?o.row-t.row+1:0;for(l=o?O:Math.max(A,O),r=0;r<l;r++){if(o&&u.row>o.row&&O>A||!w.allowInsertRow&&u.row>s.countRows()-1||u.row>=w.maxRows)break;const e=r-M,i=I(e).length,d=o?o.col-t.col+1:0;if(h=o?d:Math.max(i,d),u.col=t.col,T=s.getCellMeta(u.row,u.col),"CopyPaste.paste"!==n&&"Autofill.fill"!==n||!T.skipRowOnPaste){for(x=0,a=0;a<h;a++){if(o&&u.col>o.col&&d>i||!w.allowInsertColumn&&u.col>s.countCols()-1||u.col>=w.maxCols)break;if(T=s.getCellMeta(u.row,u.col),("CopyPaste.paste"===n||"Autofill.fill"===n)&&T.skipColumnOnPaste){x+=1,u.col+=1,h+=1;continue}if(T.readOnly&&"UndoRedo.undo"!==n){u.col+=1;continue}const t=a-x;let r=I(e,t),l=s.getDataAtCell(u.row,u.col);if(null!==r&&"object"===typeof r)if(Array.isArray(r)&&null===l&&(l=[]),null===l||"object"!==typeof l)k=!1;else{const t=mo(Array.isArray(l)?l:l[0]||l),e=mo(Array.isArray(r)?r:r[0]||r);So(t,e)||Array.isArray(t)&&Array.isArray(e)?r=Co(r):k=!1}else null!==l&&"object"===typeof l&&(k=!1);k&&c.push([u.row,u.col,r]),k=!0,u.col+=1}u.row+=1}else M+=1,u.row+=1,l+=1}s.setDataAtCell(c,null,null,n||"populateFromArray");break}}},this.init=function(){h.setData(w.data),s.runHooks("beforeInit"),(Xo()||Qo())&&de(s.rootElement,"mobile"),this.updateSettings(w,!0),this.view=new cu(this),u=si.getInstance(s,w,S),d=new Mi(s),Vc(this)&&Rw(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&null===s.rootElement.offsetParent&&eo(s.rootElement,(()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()})),"object"===typeof g&&(s.runHooks("afterChange",g[0],g[1]),g=!1),s.runHooks("afterInit")},this._createCellCoords=function(t,e){return s.view._wt.createCellCoords(t,e)},this._createCellRange=function(t,e,o){return s.view._wt.createCellRange(t,e,o)},this.validateCell=function(t,e,o,n){let i=s.getCellValidator(e);function r(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!n||!0===e.hidden)return void o(t);const i=e.visualCol,r=e.visualRow,l=s.getCell(r,i,!0);if(l&&"TH"!==l.nodeName){const t=s.rowIndexMapper.getRenderableFromVisualIndex(r),e=s.columnIndexMapper.getRenderableFromVisualIndex(i);s.view._wt.getSetting("cellRenderer",t,e,l)}o(t)}Y(i)&&(i=function(t){return function(e,o){o(t.test(e))}}(i)),ro(i)?(t=s.runHooks("beforeValidate",t,e.visualRow,e.prop,n),s._registerImmediate((()=>{i.call(e,t,(o=>{s&&(o=s.runHooks("afterValidate",o,t,e.visualRow,e.prop,n),e.valid=o,r(o),s.runHooks("postAfterValidate",o,t,e.visualRow,e.prop,n))}))}))):s._registerImmediate((()=>{e.valid=!0,r(e.valid,!1)}))},this.setDataAtCell=function(t,e,o,n){const i=N(t,e,o),r=[];let l,c,u,d=n;for(l=0,c=i.length;l<c;l++){if("object"!==typeof i[l])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof i[l][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");u=i[l][1]>=this.countCols()?i[l][1]:a.colToProp(i[l][1]),r.push([i[l][0],u,h.getAtCell(this.toPhysicalRow(i[l][0]),i[l][1]),i[l][2]])}d||"object"!==typeof t||(d=e);const g=_(r,n);s.runHooks("afterSetDataAtCell",g,d),O(g,d,(()=>{P(g,d)}))},this.setDataAtRowProp=function(t,e,o,n){const i=N(t,e,o),r=[];let l,a,c=n;for(l=0,a=i.length;l<a;l++)r.push([i[l][0],i[l][1],h.getAtCell(this.toPhysicalRow(i[l][0]),i[l][1]),i[l][2]]);c||"object"!==typeof t||(c=e);const u=_(r,n);s.runHooks("afterSetDataAtRowProp",u,c),O(u,c,(()=>{P(u,c)}))},this.listen=function(){s&&!s.isListening()&&(Lv.forEach((t=>{s!==t&&t.unlisten()})),_v=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(_v=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return _v===s.guid},this.destroyEditor=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];s._refreshBorders(t,e)},this.populateFromArray=function(t,e,o,n,i,r,l){if("object"!==typeof o||"object"!==typeof o[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const a="number"===typeof n?s._createCellCoords(n,i):null;return c.populateFromArray(s._createCellCoords(t,e),o,a,r,l)},this.spliceCol=function(t,e,o){for(var n=arguments.length,i=new Array(n>3?n-3:0),r=3;r<n;r++)i[r-3]=arguments[r];return a.spliceCol(t,e,o,...i)},this.spliceRow=function(t,e,o){for(var n=arguments.length,i=new Array(n>3?n-3:0),r=3;r<n;r++)i[r-3]=arguments[r];return a.spliceRow(t,e,o,...i)},this.getSelected=function(){if(S.isSelected())return I(S.getSelectedRange(),(t=>{let{from:e,to:o}=t;return[e.row,e.col,o.row,o.col]}))},this.getSelectedLast=function(){const t=this.getSelected();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(S.isSelected())return Array.from(S.getSelectedRange())},this.getSelectedRangeLast=function(){const t=this.getSelectedRange();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(t){if(!S.isSelected()||0===this.countRows()||0===this.countCols())return;const e=[];A(S.getSelectedRange(),(t=>{if(t.isSingleHeader())return;const o=t.getTopStartCorner(),n=t.getBottomEndCorner();Vi(o.row,n.row,(t=>{Vi(o.col,n.col,(o=>{this.getCellMeta(t,o).readOnly||e.push([t,o,null])}))}))})),e.length>0&&this.setDataAtCell(e,t)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const t=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(t,0),this.isRenderSuspended()||t!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(u.lockEditor(),this._refreshBorders(null),u.unlockEditor()))},this.batchRender=function(t){this.suspendRender();const e=t();return this.resumeRender(),e},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(e,0),(!this.isExecutionSuspended()&&e===this.executionSuspendedCounter||t)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const o=t();return this.resumeExecution(e),o},this.batch=function(t){this.suspendRender(),this.suspendExecution();const e=t();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){if(!s.view)return;const{width:t,height:e}=s.view.getLastSize(),{width:o,height:n}=s.rootElement.getBoundingClientRect(),i=o!==t||n!==e,r=!1===s.runHooks("beforeRefreshDimensions",{width:t,height:e},{width:o,height:n},i);r||((i||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(o,n),s.render()),s.runHooks("afterRefreshDimensions",{width:t,height:e},{width:o,height:n},i))},this.updateData=function(t,e){vw(t,(t=>{a=t}),(t=>{a=t,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()}),{hotInstance:s,dataMap:a,dataSource:h,internalSource:"updateData",source:e,metaManager:p,firstRun:g})},this.loadData=function(t,e){vw(t,(t=>{a=t}),(()=>{p.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),g&&(g=[null,"loadData"])}),{hotInstance:s,dataMap:a,dataSource:h,internalSource:"loadData",source:e,metaManager:p,firstRun:g})},this.getInitialColumnCount=function(){const t=w.columns;let e=0;if(Array.isArray(t))e=t.length;else if(ro(t))if("array"===s.dataType){const o=this.countSourceCols();for(let n=0;n<o;n+=1)t(n)&&(e+=1)}else"object"!==s.dataType&&"function"!==s.dataType||(e=a.colToPropCache.length);else if(U(w.dataSchema)){const t=a.getSchema();e=Array.isArray(t)?t.length:xo(t)}else e=this.countSourceCols();return e},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(t,e,o,n){return $(t)?a.getAll():a.getRange(s._createCellCoords(t,e),s._createCellCoords(o,n),a.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,o,n){return a.getCopyableText(s._createCellCoords(t,e),s._createCellCoords(o,n))},this.getCopyableData=function(t,e){return a.getCopyable(t,a.colToProp(e))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=(g?s.loadData:s.updateData).bind(this);let n,i,r=!1;if(U(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(U(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(U(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(n in t)"data"===n||("language"===n?E(t.language):"className"===n?T("className",t.className):"tableClassName"===n&&s.table?(T("tableClassName",t.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):Mn.getSingleton().isRegistered(n)||Mn.getSingleton().isDeprecated(n)?(ro(t[n])||Array.isArray(t[n]))&&(t[n].initialHook=!0,s.addHook(n,t[n])):!e&&Io(t,n)&&(v[n]=t[n]));void 0===t.data&&void 0===w.data?o(null,"updateSettings"):void 0!==t.data?o(t.data,"updateSettings"):void 0!==t.columns&&(a.createMap(),s.initIndexMappers());const l=s.countCols(),h=w.columns;if(h&&ro(h)&&(r=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||p.clearCache(),l>0)for(n=0,i=0;n<l;n++){if(h){const t=r?h(n):h[i];t&&p.updateColumnMeta(i,t)}i+=1}U(t.cell)&&To(t.cell,(t=>{s.setCellMetaObject(t.row,t.col,t)})),s.runHooks("afterCellMetaReset");let d=s.rootElement.style.height;""!==d&&(d=parseInt(s.rootElement.style.height,10));let f=t.height;if(ro(f)&&(f=f()),e){const t=s.rootElement.getAttribute("style");t&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"))}if(null===f){const t=s.rootElement.getAttribute("data-initialstyle");t&&(t.indexOf("height")>-1||t.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",t):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else void 0!==f&&(s.rootElement.style.height=isNaN(f)?`${f}`:`${f}px`,s.rootElement.style.overflow="hidden");if("undefined"!==typeof t.width){let e=t.width;ro(e)&&(e=e()),s.rootElement.style.width=isNaN(e)?`${e}`:`${e}px`}e||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",t)),c.adjustRowsAndCols(),s.view&&!g&&(s.forceFullRender=!0,u.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),u.unlockEditor()),e||!s.view||""!==d&&""!==f&&void 0!==f||d===f||s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const t=s.getSelectedLast();if(w.getValue){if(ro(w.getValue))return w.getValue.call(s);if(t)return s.getData()[t[0][0]][w.getValue]}else if(t)return s.getDataAtCell(t[0],t[1])},this.getSettings=function(){return w},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,o,n,i){c.alter(t,e,o,n,i)},this.getCell=function(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e,i=t;if(e>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(e)))return null;n=this.columnIndexMapper.getRenderableFromVisualIndex(e)}if(t>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(t)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(t)}return null===i||null===n?null:s.view.getCellAtCoords(s._createCellCoords(i,n),o)},this.getCoords=function(t){const e=this.view._wt.wtTable.getCoords(t);if(null===e)return null;const{row:o,col:n}=e;let i=o,r=n;return o>=0&&(i=this.rowIndexMapper.getVisualFromRenderableIndex(o)),n>=0&&(r=this.columnIndexMapper.getVisualFromRenderableIndex(n)),s._createCellCoords(i,r)},this.colToProp=function(t){return a.colToProp(t)},this.propToCol=function(t){return a.propToCol(t)},this.toVisualRow=t=>this.rowIndexMapper.getVisualFromPhysicalIndex(t),this.toVisualColumn=t=>this.columnIndexMapper.getVisualFromPhysicalIndex(t),this.toPhysicalRow=t=>this.rowIndexMapper.getPhysicalFromVisualIndex(t),this.toPhysicalColumn=t=>this.columnIndexMapper.getPhysicalFromVisualIndex(t),this.getDataAtCell=function(t,e){return a.get(t,a.colToProp(e))},this.getDataAtRowProp=function(t,e){return a.get(t,e)},this.getDataAtCol=function(t){const e=[],o=a.getRange(s._createCellCoords(0,t),s._createCellCoords(w.data.length-1,t),a.DESTINATION_RENDERER);for(let n=0;n<o.length;n+=1)for(let t=0;t<o[n].length;t+=1)e.push(o[n][t]);return e},this.getDataAtProp=function(t){const e=[],o=a.getRange(s._createCellCoords(0,a.propToCol(t)),s._createCellCoords(w.data.length-1,a.propToCol(t)),a.DESTINATION_RENDERER);for(let n=0;n<o.length;n+=1)for(let t=0;t<o[n].length;t+=1)e.push(o[n][t]);return e},this.getSourceData=function(t,e,o,n){let i;return i=void 0===t?h.getData():h.getByRange(s._createCellCoords(t,e),s._createCellCoords(o,n)),i},this.getSourceDataArray=function(t,e,o,n){let i;return i=void 0===t?h.getData(!0):h.getByRange(s._createCellCoords(t,e),s._createCellCoords(o,n),!0),i},this.getSourceDataAtCol=function(t){return h.getAtColumn(t)},this.setSourceDataAtCell=function(t,e,o,n){const i=N(t,e,o),r=this.hasHook("afterSetSourceDataAtCell"),l=[];r&&A(i,(t=>{let[e,o,n]=t;l.push([e,o,h.getAtCell(e,o),n])})),A(i,(t=>{let[e,o,n]=t;h.setAtCell(e,o,n)})),r&&this.runHooks("afterSetSourceDataAtCell",l,n),this.render();const a=s.getActiveEditor();a&&U(a.refreshValue)&&a.refreshValue()},this.getSourceDataAtRow=function(t){return h.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return h.getAtCell(t,e)},this.getDataAtRow=function(t){const e=a.getRange(s._createCellCoords(t,0),s._createCellCoords(t,this.countCols()-1),a.DESTINATION_RENDERER);return e[0]||[]},this.getDataType=function(t,e,o,n){const i=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,o,n],[r,s]=i;let[,,l,a]=i,h=null,c=null;void 0===l&&(l=r),void 0===a&&(a=s);let u="mixed";return Vi(Math.max(Math.min(r,l),0),Math.max(r,l),(t=>{let e=!0;return Vi(Math.max(Math.min(s,a),0),Math.max(s,a),(o=>{const n=this.getCellMeta(t,o);return c=n.type,h?e=h===c:h=c,e})),u=e?c:"mixed",e})),u},this.removeCellMeta=function(t,e,o){const[n,i]=[this.toPhysicalRow(t),this.toPhysicalColumn(e)];let r=p.getCellMetaKeyValue(n,i,o);const l=s.runHooks("beforeRemoveCellMeta",t,e,o,r);!1!==l&&(p.removeCellMeta(n,i,o),s.runHooks("afterRemoveCellMeta",t,e,o,r)),r=null},this.spliceCellsMeta=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var o=arguments.length,n=new Array(o>2?o-2:0),i=2;i<o;i++)n[i-2]=arguments[i];if(n.length>0&&!Array.isArray(n[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");e>0&&p.removeRow(this.toPhysicalRow(t),e),n.length>0&&A(n.reverse(),(e=>{p.createRow(this.toPhysicalRow(t)),A(e,((e,o)=>this.setCellMetaObject(t,o,e)))})),s.render()},this.setCellMetaObject=function(t,e,o){"object"===typeof o&&To(o,((o,n)=>{this.setCellMeta(t,e,n,o)}))},this.setCellMeta=function(t,e,o,n){const i=s.runHooks("beforeSetCellMeta",t,e,o,n);if(!1===i)return;let r=t,l=e;t<this.countRows()&&(r=this.toPhysicalRow(t)),e<this.countCols()&&(l=this.toPhysicalColumn(e)),p.setCellMeta(r,l,o,n),s.runHooks("afterSetCellMeta",t,e,o,n)},this.getCellsMeta=function(){return p.getCellsMeta()},this.getCellMeta=function(t,e){let o=this.toPhysicalRow(t),n=this.toPhysicalColumn(e);return null===o&&(o=t),null===n&&(n=e),p.getCellMeta(o,n,{visualRow:t,visualColumn:e})},this.getCellMetaAtRow=function(t){return p.getCellsMetaAtRow(t)},this.isColumnModificationAllowed=function(){return!("object"===s.dataType||w.columns)},this.getCellRenderer=function(t,e){const o="number"===typeof t?s.getCellMeta(t,e).renderer:t.renderer;return"string"===typeof o?pr(o):$(o)?pr("text"):o},this.getCellEditor=function(t,e){const o="number"===typeof t?s.getCellMeta(t,e).editor:t.editor;return"string"===typeof o?Dn(o):$(o)?Dn("text"):o},this.getCellValidator=function(t,e){const o="number"===typeof t?s.getCellMeta(t,e).validator:t.validator;return"string"===typeof o?Rr(o):o},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,o){const n=new M;t&&(n.onQueueEmpty=t);let i=s.countRows()-1;while(i>=0){if(void 0!==e&&-1===e.indexOf(i)){i-=1;continue}let t=s.countCols()-1;while(t>=0)void 0===o||-1!==o.indexOf(t)?(n.addValidatorToQueue(),s.validateCell(s.getDataAtCell(i,t),s.getCellMeta(i,t),(t=>{if("boolean"!==typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(n.valid=!1),n.removeValidatorFormQueue()}),"validateCells"),t-=1):t-=1;i-=1}n.checkIfQueueIsEmpty()},this.getRowHeader=function(t){let e=w.rowHeaders,o=t;return void 0!==o&&(o=s.runHooks("modifyRowHeader",o)),void 0===o?(e=[],Vi(s.countRows()-1,(t=>{e.push(s.getRowHeader(t))}))):Array.isArray(e)&&void 0!==e[o]?e=e[o]:ro(e)?e=e(o):e&&"string"!==typeof e&&"number"!==typeof e&&(e=o+1),e},this.hasRowHeaders=function(){return!!w.rowHeaders},this.hasColHeaders=function(){if(void 0!==w.colHeaders&&null!==w.colHeaders)return!!w.colHeaders;for(let t=0,e=s.countCols();t<e;t++)if(s.getColHeader(t))return!0;return!1},this.getColHeader=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const o=s.runHooks("modifyColHeader",t);if(void 0===o){const t=[],e=s.countCols();for(let o=0;o<e;o++)t.push(s.getColHeader(o));return t}let n=w.colHeaders;const i=function(t){const e=[],o=s.countCols();let n=0;for(;n<o;n++)ro(w.columns)&&w.columns(n)&&e.push(n);return e[t]},r=s.toPhysicalColumn(o),l=i(r);return!1===w.colHeaders?n=null:w.columns&&ro(w.columns)&&w.columns(l)&&w.columns(l).title?n=w.columns(l).title:w.columns&&w.columns[r]&&w.columns[r].title?n=w.columns[r].title:Array.isArray(w.colHeaders)&&void 0!==w.colHeaders[r]?n=w.colHeaders[r]:ro(w.colHeaders)?n=w.colHeaders(r):w.colHeaders&&"string"!==typeof w.colHeaders&&"number"!==typeof w.colHeaders&&(n=gu(o)),n=s.runHooks("modifyColumnHeaderValue",n,t,e),n},this._getColWidthFromSettings=function(t){let e;if(t>=0){const o=s.getCellMeta(0,t);e=o.width}if(void 0!==e&&e!==w.width||(e=w.colWidths),void 0!==e&&null!==e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t);break;default:break}"string"===typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(t){let e=s._getColWidthFromSettings(t);return e=s.runHooks("modifyColWidth",e,t),void 0===e&&(e=Gh.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){let e=w.rowHeights;if(void 0!==e&&null!==e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t);break;default:break}"string"===typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){let e=s._getRowHeightFromSettings(t);return e=s.runHooks("modifyRowHeight",e,t),e},this.countSourceRows=function(){return h.countRows()},this.countSourceCols=function(){return h.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const t=w.maxCols,e=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(t,e)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Fi(s.countRows()-1,(o=>{if(s.isEmptyRow(o))e+=1;else if(!0===t)return!1})),e},this.countEmptyCols=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Fi(s.countCols()-1,(o=>{if(s.isEmptyCol(o))e+=1;else if(!0===t)return!1})),e},this.isEmptyRow=function(t){return w.isEmptyRow.call(s,t)},this.isEmptyCol=function(t){return w.isEmptyCol.call(s,t)},this.selectCell=function(t,e,o,n){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!$(t)&&!$(e)&&this.selectCells([[t,e,o,n]],i,r)},this.selectCells=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===e&&(r=!0);const n=S.selectCells(t);return n&&o&&s.listen(),r=!1,n},this.selectColumns=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2?arguments[2]:void 0;return S.selectColumns(t,e,o)},this.selectRows=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2?arguments[2]:void 0;return S.selectRows(t,e,o)},this.deselectCell=function(){S.deselect()},this.selectAll=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2?arguments[2]:void 0;r=!0,S.selectAll(t,e,o),r=!1};const L=(t,e)=>t.getNearestNotHiddenIndex(e,1,!0);function D(t){return()=>{throw new Error(`The "${t}" method cannot be called because this Handsontable instance has been destroyed`)}}this.scrollViewportTo=function(t){var e,o;"number"===typeof t&&(t={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(o=arguments[4])||void 0===o||o});const{row:n,col:i,verticalSnap:r,horizontalSnap:l,considerHiddenIndexes:a}=null!==(e=t)&&void 0!==e?e:{};let h,c,u,d;void 0!==r&&(h="top"===r,c=!h),void 0!==l&&(u="start"===l,d=!u);let g=n,f=i;if(void 0===a||a){const t=Number.isInteger(n)&&n>=0,e=Number.isInteger(i)&&i>=0,o=t?L(this.rowIndexMapper,n):void 0,r=e?L(this.columnIndexMapper,i):void 0;if(null===o||null===r)return!1;g=t?s.rowIndexMapper.getRenderableFromVisualIndex(o):n,f=e?s.columnIndexMapper.getRenderableFromVisualIndex(r):i}const m=Number.isInteger(g),p=Number.isInteger(f);return m&&g>=0&&p&&f>=0?s.view.scrollViewport(s._createCellCoords(g,f),h,d,c,u):m&&g>=0&&(p&&f<0||!p)?s.view.scrollViewportVertically(g,h,c):!!(p&&f>=0&&(m&&g<0||!m))&&s.view.scrollViewportHorizontally(f,d,u)},this.scrollToFocusedCell=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",t);const{highlight:e}=this.getSelectedRangeLast(),o=this.scrollViewportTo(e.toObject());o?this.view.render():(this.removeHook("afterScroll",t),this._registerImmediate((()=>t())))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),h&&h.destroy(),h=null,this.getShortcutManager().destroy(),p.clearCache(),Lv.delete(this.guid),Vc(s)){const t=this.rootDocument.querySelector(".hot-display-license-info");t&&t.parentNode.removeChild(t)}we(s.rootElement),l.destroy(),u&&u.destroy(),s.batchExecution((()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),C.getItems().forEach((t=>{let[,e]=t;e.destroy()})),C.clear(),s.runHooks("afterDestroy")}),!0),Mn.getSingleton().destroy(s),To(s,((t,e,o)=>{ro(t)?o[e]=D(e):"guid"!==e&&(o[e]=null)})),s.isDestroyed=!0,a&&a.destroy(),a=null,c=null,S=null,u=null,s=null},this.getActiveEditor=function(){return u.getActiveEditor()},this.getPlugin=function(t){const e=lt(t);return"UndoRedo"===e?this.undoRedo:C.getItem(e)},this.getPluginName=function(t){return t===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:C.getId(t)},this.getInstance=function(){return s},this.addHook=function(t,e){Mn.getSingleton().add(t,e,s)},this.hasHook=function(t){return Mn.getSingleton().has(t,s)||Mn.getSingleton().has(t)},this.addHookOnce=function(t,e){Mn.getSingleton().once(t,e,s)},this.removeHook=function(t,e){Mn.getSingleton().remove(t,e,s)},this.runHooks=function(t,e,o,n,i,r,l){return Mn.getSingleton().run(s,t,e,o,n,i,r,l)},this.getTranslatedPhrase=function(t,e){return Af(w.language,t,e)},this.toHTML=()=>Ni(this),this.toTableElement=()=>{const t=this.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",Ni(this)),t.firstElementChild},this.timeouts=[],this._registerTimeout=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t;"function"===typeof o&&(o=setTimeout(o,e)),this.timeouts.push(o)},this._clearTimeouts=function(){A(this.timeouts,(t=>{clearTimeout(t)}))},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){A(this.immediates,(t=>{clearImmediate(t)}))},this._refreshBorders=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];u.destroyEditor(t),s.view.render(),e&&S.isSelected()&&u.prepareEditor()},this._getEditorManager=function(){return u},this.isRtl=function(){return"rtl"===s.rootWindow.getComputedStyle(s.rootElement).direction},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const V=jw({handleEvent(){return s.isListening()},beforeKeyDown:t=>this.runHooks("beforeKeyDown",t),afterKeyDown:t=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",t)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",(t=>{!1===t.ctrlKey&&!1===t.metaKey&&V.releasePressedKeys()})),this.getShortcutManager=function(){return V},this.getFocusManager=function(){return d},rr().forEach((t=>{const e=sr(t);C.addItem(t,new e(this))})),Nv(s),V.setActiveContextName("grid"),Mn.getSingleton().run(s,"construct")}const Wv="hooksRefRegisterer",Vv={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){A(this._hooksStorage[t]||[],(e=>{this.hot.removeHook(t,e)}))},clearHooks(){To(this._hooksStorage,((t,e)=>this.removeHooksByKey(e))),this._hooksStorage={}}};Eo(Vv,"MIXIN_NAME",Wv,{writable:!1,enumerable:!1});var Fv=Vv;function jv(t,e,o){return e=Bv(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Bv(t){var e=zv(t,"string");return"symbol"==typeof e?e:String(e)}function zv(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Uv="base",$v=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Gv="baseEditor";class Yv{static get EDITOR_TYPE(){return Uv}constructor(t){jv(this,"hot",void 0),jv(this,"state",$v.VIRGIN),jv(this,"_opened",!1),jv(this,"_fullEditMode",!1),jv(this,"_closeCallback",null),jv(this,"TD",null),jv(this,"row",null),jv(this,"col",null),jv(this,"prop",null),jv(this,"originalValue",null),jv(this,"cellProperties",null),this.hot=t,this.init()}_fireCallbacks(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(t,e,o,n,i,r){this.TD=n,this.row=t,this.col=e,this.prop=o,this.originalValue=i,this.cellProperties=r,this.state=$v.VIRGIN}extend(){return class extends this.constructor{}}saveValue(t,e){let o,n,i,r;if(e){const t=this.hot.getSelectedLast();o=Math.max(Math.min(t[0],t[2]),0),n=Math.max(Math.min(t[1],t[3]),0),i=Math.max(t[0],t[2]),r=Math.max(t[1],t[3])}else[o,n,i,r]=[this.row,this.col,null,null];const s=this.hot.runHooks("modifyGetCellCoords",o,n);Array.isArray(s)&&([o,n]=s);const l=this.hot.getShortcutManager(),a=l.getContext("editor"),h={runOnlyIf:()=>U(this.hot.getSelected()),group:Gv};this.isInFullEditMode()&&a.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],h),this.hot.populateFromArray(o,n,t,i,r,"edit")}beginEditing(t,e){if(this.state!==$v.VIRGIN)return;const o=this.hot,n=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(n,i)),this.state=$v.EDITING,this.isInFullEditMode()){const e="string"===typeof t?t:z(this.originalValue);this.setValue(e)}this.open(e),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(t,e,o){let n;if(o){const t=this._closeCallback;this._closeCallback=e=>{t&&t(e),o(e),this.hot.view.render()}}if(this.isWaiting())return;const i=this.hot.getShortcutManager(),r=i.getContext("editor");if(r.removeShortcutsByGroup(Gv),r.removeShortcutsByGroup(Zn),this.state!==$v.VIRGIN){if(this.state===$v.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();const o=this.getValue();n=this.cellProperties.trimWhitespace?[["string"===typeof o?String.prototype.trim.call(o||""):o]]:[[o]],this.state=$v.WAITING,this.saveValue(n,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(t=>{this.state=$v.FINISHED,this.discardEditor(t)})):(this.state=$v.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=$v.FINISHED,this.discardEditor()}discardEditor(t){if(this.state===$v.FINISHED)if(!1===t&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=$v.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=$v.VIRGIN,this._fireCallbacks(!0);const t=this.hot.getShortcutManager();t.setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===$v.WAITING}getEditedCellRect(){var t;const e=this.getEditedCell();if(!e)return;const{wtOverlays:o,wtViewport:n}=this.hot.view._wt,i=this.hot.rootWindow,r=Se(e),s=Oe(e),l=Se(this.hot.rootElement),a=Oe(this.hot.rootElement),h=o.topOverlay.holder,c=o.inlineStartOverlay.holder,u=h!==i?h.scrollTop:0,d=c!==i?c.scrollLeft:0,g=i.innerWidth-l.left-a,{wtTable:f}=null!==(t=o.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,m=f.name,p=["master","inline_start"].includes(m)?u:0,w=["master","top","bottom"].includes(m)?d:0,v=r.top===l.top?0:1;let C=r.top-l.top-v-p,y=0;y=this.hot.isRtl()?i.innerWidth-r.left-s-g-1+w:r.left-l.left-1-w,["top","top_inline_start_corner"].includes(m)&&(C+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(y+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));const b=this.hot.hasColHeaders(),S=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),E=this.hot.rowIndexMapper.getRenderableIndexesLength(),T=E-this.hot.view._wt.getSetting("fixedRowsBottom");(b&&S<=0||S===T)&&(C+=1),R<=0&&(y+=1);const M=n.rowsRenderCalculator.startPosition,H=n.columnsRenderCalculator.startPosition,x=Math.abs(o.inlineStartOverlay.getScrollPosition()),k=o.topOverlay.getScrollPosition(),I=$e(this.hot.rootDocument);let A=e.offsetTop;if(["inline_start","master"].includes(m)&&(A+=M-k),["bottom","bottom_inline_start_corner"].includes(m)){const{wtViewport:t,wtTable:e}=o.bottomOverlay.clone;A+=t.getWorkspaceHeight()-e.getHeight()-I}let O=e.offsetLeft;this.hot.isRtl()?(O=O>=0?f.getWidth()-e.offsetLeft:Math.abs(O),O+=H-x-s):["top","master","bottom"].includes(m)&&(O+=H-x);const P=Ae(this.TD,this.hot.rootWindow),N=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",_=parseInt(P[N],10)>0?0:1,L=parseInt(P.borderTopWidth,10)>0?0:1,D=Oe(e)+_,W=Pe(e)+L,V=Ge(h)?I:0,F=Ye(c)?I:0,j=this.hot.view.maximumVisibleElementWidth(O)-V+_,B=Math.max(this.hot.view.maximumVisibleElementHeight(A)-F+L,23);return{top:C,start:y,height:W,maxHeight:B,width:D,maxWidth:j}}getEditedCellsLayerClass(){const t=this.checkEditorSection();switch(t){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const t=this.hot.countRows();let e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}function Kv(t,e,o){t.addEventListener(e,o,!1)}function Xv(t,e,o){t.removeEventListener(e,o,!1)}function qv(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function Qv(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},o=t.body,n=t.createTextNode(""),i=t.createElement("span");let r;function s(){n.textContent=r.value,i.style.position="absolute",i.style.fontSize=qv(r).fontSize,i.style.fontFamily=qv(r).fontFamily,i.style.whiteSpace="pre",o.appendChild(i);const t=i.clientWidth+2;o.removeChild(i);const s=r.style;s.height=`${e.minHeight}px`,e.minWidth>t?s.width=`${e.minWidth}px`:t>e.maxWidth?s.width=`${e.maxWidth}px`:s.width=`${t}px`;const l=r.scrollHeight?r.scrollHeight-1:0;e.minHeight>l?s.height=`${e.minHeight}px`:e.maxHeight<l?(s.height=`${e.maxHeight}px`,s.overflowY="visible"):s.height=`${l}px`}function l(){t.defaultView.setTimeout(s,0)}function a(t){if(t&&t.minHeight)if("inherit"===t.minHeight)e.minHeight=r.clientHeight;else{const o=parseInt(t.minHeight,10);isNaN(o)||(e.minHeight=o)}if(t&&t.maxHeight)if("inherit"===t.maxHeight)e.maxHeight=r.clientHeight;else{const o=parseInt(t.maxHeight,10);isNaN(o)||(e.maxHeight=o)}if(t&&t.minWidth)if("inherit"===t.minWidth)e.minWidth=r.clientWidth;else{const o=parseInt(t.minWidth,10);isNaN(o)||(e.minWidth=o)}if(t&&t.maxWidth)if("inherit"===t.maxWidth)e.maxWidth=r.clientWidth;else{const o=parseInt(t.maxWidth,10);isNaN(o)||(e.maxWidth=o)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))}function h(t,o){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r=t,a(o),"TEXTAREA"===r.nodeName&&(r.style.resize="none",r.style.overflowY="",r.style.height=`${e.minHeight}px`,r.style.minWidth=`${e.minWidth}px`,r.style.maxWidth=`${e.maxWidth}px`,r.style.overflowY="hidden"),n&&(Kv(r,"input",s),Kv(r,"keydown",l)),s()}return{init:h,resize:s,unObserve(){Xv(r,"input",s),Xv(r,"keydown",l)}}}function Jv(t,e){const o=We(e),n=e.value.split("\n");let i=o,r=0;for(let s=0;s<n.length;s++){const e=n[s];0!==s&&(r+=n[s-1].length+1);const l=r+e.length;if("home"===t?i=r:"end"===t&&(i=l),o<=l)break}Be(e,i)}function Zv(t,e,o){return e=tC(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function tC(t){var e=eC(t,"string");return"symbol"==typeof e?e:String(e)}function eC(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}bo(Yv,Fv);const oC="ht_editor_visible",nC="ht_editor_hidden",iC="textEditor",rC="text";class sC extends Yv{static get EDITOR_TYPE(){return rC}constructor(t){super(t),Zv(this,"eventManager",new $n(this)),Zv(this,"autoResize",Qv(this.hot.rootDocument)),Zv(this,"TEXTAREA",void 0),Zv(this,"textareaStyle",void 0),Zv(this,"TEXTAREA_PARENT",void 0),Zv(this,"textareaParentStyle",void 0),Zv(this,"layerClass",void 0),this.eventManager=new $n(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(t){this.TEXTAREA.value=t}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),te(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(t,e,o,n,i,r){const s=this.state;if(super.prepare(t,e,o,n,i,r),!r.readOnly){this.refreshDimensions(!0);const{allowInvalid:t}=r;t&&(this.TEXTAREA.value=""),s!==$v.FINISHED&&this.hideEditableElement()}}beginEditing(t,e){this.state===$v.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(t,e))}focus(){this.TEXTAREA.select(),Be(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:t}=this.hot;this.TEXTAREA=t.createElement("TEXTAREA"),fe(this.TEXTAREA,[["data-hot-input",""],ft(-1)]),this.hot.getSettings().ariaTags&&fe(this.TEXTAREA,[Ot()]),de(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),de(this.TEXTAREA_PARENT,"handsontableInputHolder"),ue(this.TEXTAREA_PARENT,this.layerClass)&&ge(this.TEXTAREA_PARENT,this.layerClass),de(this.TEXTAREA_PARENT,nC),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Yo()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ge(this.TEXTAREA_PARENT,this.layerClass),de(this.TEXTAREA_PARENT,nC)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const t=this.TEXTAREA_PARENT.childNodes;let e=!1;Vi(t.length-1,(o=>{const n=t[o];if(ue(n,"handsontableEditor"))return e=!0,!1})),ue(this.TEXTAREA_PARENT,nC)&&ge(this.TEXTAREA_PARENT,nC),e?(this.layerClass=oC,de(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),de(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==$v.EDITING&&!t)return;if(this.TD=this.getEditedCell(),!this.TD)return void(t||this.close());const{top:e,start:o,width:n,maxWidth:i,height:r,maxHeight:s}=this.getEditedCellRect();this.textareaParentStyle.top=`${e}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${o}px`,this.showEditableElement();const l=Ae(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const a=Ae(this.TEXTAREA),h=parseInt(a.paddingLeft,10)+parseInt(a.paddingRight,10),c=parseInt(a.paddingTop,10)+parseInt(a.paddingBottom,10),u=n-h,d=r-c,g=i-h,f=s-c;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(u,g),minHeight:Math.min(d,f),maxWidth:g,maxHeight:f},!0)}bindEvents(){qo()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.state===$v.EDITING&&this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.state===$v.EDITING&&this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor"),o=t.getContext("grid"),n={runOnlyIf:()=>U(this.hot.getSelected()),group:iC},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:o,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:t=>!this.hot.selection.isMultiple()&&!t.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(t,e)=>{let[o]=e;Jv(o,this.TEXTAREA)}},{keys:[["End"]],callback:(t,e)=>{let[o]=e;Jv(o,this.TEXTAREA)}}],n)}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(Zn),e.removeShortcutsByGroup(iC),e.removeShortcutsByGroup(Gv)}}const lC="base";function aC(t,e,o,n,i,r,s){const l=s.ariaTags,a=[],h=[],c=[],u=[];s.className&&de(e,s.className),s.readOnly?(a.push(s.readOnlyCellClassName),l&&u.push(Bt())):l&&c.push(Bt()[0]),!1===s.valid&&s.invalidCellClassName?(a.push(s.invalidCellClassName),l&&u.push(zt())):(h.push(s.invalidCellClassName),l&&c.push(zt()[0])),!1===s.wordWrap&&s.noWordWrapClassName&&a.push(s.noWordWrapClassName),!r&&s.placeholder&&a.push(s.placeholderCellClassName),ge(e,h),de(e,a),me(e,c),fe(e,u)}aC.RENDERER_TYPE=lC;const hC="text";function cC(t,e,o,n,i,r,s){aC.apply(this,[t,e,o,n,i,r,s]);let l=r;if(!l&&s.placeholder&&(l=s.placeholder),l=z(l),s.trimWhitespace&&(l=l.trim()),s.rendererTemplate){we(e);const n=t.rootDocument.createElement("TEMPLATE");n.setAttribute("bind","{{}}"),n.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(n),n.model=t.getSourceDataAtRow(o),e.appendChild(n)}else ye(e,l)}cC.RENDERER_TYPE=hC;const uC="text",dC={CELL_TYPE:uC,editor:sC,renderer:cC};function gC(t,e){const o=new Dv(t,e||{},Lc);return o.init(),o}Sp(dC),gC.editors={BaseEditor:Yv},gC.Core=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Dv(t,e,Lc)},gC.DefaultSettings=kp(),gC.hooks=Mn.getSingleton(),gC.CellCoords=Jl,gC.CellRange=ua,gC.packageName="handsontable",gC.buildDate="02/01/2024 08:59:26",gC.version="14.0.0",gC.languages={dictionaryKeys:yf,getLanguageDictionary:xf,getLanguagesDictionaries:If,registerLanguageDictionary:Mf,getTranslatedPhrase:Af};var fC=gC,mC=o(1711);function pC(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function wC(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?pC(Object(o),!0).forEach((function(e){EC(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):pC(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function vC(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function CC(t){var e=vC(t,"string");return"symbol"==typeof e?e:String(e)}function yC(t){return yC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yC(t)}function bC(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function SC(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,CC(n.key),n)}}function RC(t,e,o){return e&&SC(t.prototype,e),o&&SC(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function EC(t,e,o){return e=CC(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function TC(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&HC(t,e)}function MC(t){return MC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},MC(t)}function HC(t,e){return HC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},HC(t,e)}function xC(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function kC(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function IC(t,e){if(e&&("object"===typeof e||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return kC(t)}function AC(t){var e=xC();return function(){var o,n=MC(t);if(e){var i=MC(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return IC(this,o)}}var OC=Symbol("unassigned"),PC=null,NC="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function _C(t){t.hotInstance&&(t.hotInstance.addHook("beforeChange",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateCol",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveCol",(function(){t.__internalEdit=!0})))}function LC(t){var e=fC.hooks.getRegistered(),o={};for(var n in Object.assign(o,fC.DefaultSettings),o)o[n]={default:OC};for(var i=0;i<e.length;i++)o[e[i]]={default:OC};return o.settings={default:OC},"HotTable"===t&&(o.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},o.wrapperRendererCacheSize={type:Number,default:3e3}),o}function DC(t){var e={},o=t["settings"];if(o!==OC)for(var n in o)o.hasOwnProperty(n)&&o[n]!==OC&&(e[n]=o[n]);for(var i in t)t.hasOwnProperty(i)&&"settings"!==i&&t[i]!==OC&&(e[i]=t[i]);return e}function WC(t,e){var o=DC(t),n=t.settings?t.settings:o,i=t.settings?o:null,r={};for(var s in n)!n.hasOwnProperty(s)||void 0===n[s]||e&&"data"!==s&&BC(e[s],n[s])||(r[s]=n[s]);for(var l in i)!i.hasOwnProperty(l)||"id"===l||"settings"===l||"wrapperRendererCacheSize"===l||void 0===i[l]||e&&"data"!==l&&BC(e[l],i[l])||(r[l]=i[l]);return r}function VC(t,e){var o=null;return t.every((function(t,n){return!t.data||!t.data.attrs||void 0===t.data.attrs[e]||(o=t,!1)})),o}function FC(t){return t.filter((function(t){return"HotColumn"===t.$options.name}))}function jC(t,e,o,n){var i=e.$el?e.$el.ownerDocument:document,r={propsData:o,parent:e,data:n};PC||(PC=i.createElement("DIV"),PC.id="vueHotComponents",i.body.appendChild(PC));var s=i.createElement("DIV");return PC.appendChild(s),new t.componentOptions.Ctor(r).$mount(s)}function BC(t,e){var o=function(){var t=new WeakSet;return function(e,o){if("object"===yC(o)&&null!==o){if(t.has(o))return;t.add(o)}return o}}();return JSON.stringify(t,o)===JSON.stringify(e,o)}var zC="14.0.0";"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self&&self;function UC(t,e){return e={exports:{}},t(e,e.exports),e.exports}var $C=UC((function(t,e){(function(t,o){var n=e;o(n)})(0,(function(t){var e=Symbol("newer"),o=Symbol("older");function n(t,e){"number"!==typeof t&&(e=t,t=0),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this._keymap=new Map,e&&(this.assign(e),t<1&&(this.limit=this.size))}function i(t,n){this.key=t,this.value=n,this[e]=void 0,this[o]=void 0}t.LRUMap=n,n.prototype._markEntryAsUsed=function(t){t!==this.newest&&(t[e]&&(t===this.oldest&&(this.oldest=t[e]),t[e][o]=t[o]),t[o]&&(t[o][e]=t[e]),t[e]=void 0,t[o]=this.newest,this.newest&&(this.newest[e]=t),this.newest=t)},n.prototype.assign=function(t){var n,r=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var s=t[Symbol.iterator](),l=s.next();!l.done;l=s.next()){var a=new i(l.value[0],l.value[1]);if(this._keymap.set(a.key,a),n?(n[e]=a,a[o]=n):this.oldest=a,n=a,0==r--)throw new Error("overflow")}this.newest=n,this.size=this._keymap.size},n.prototype.get=function(t){var e=this._keymap.get(t);if(e)return this._markEntryAsUsed(e),e.value},n.prototype.set=function(t,n){var r=this._keymap.get(t);return r?(r.value=n,this._markEntryAsUsed(r),this):(this._keymap.set(t,r=new i(t,n)),this.newest?(this.newest[e]=r,r[o]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift(),this)},n.prototype.shift=function(){var t=this.oldest;if(t)return this.oldest[e]?(this.oldest=this.oldest[e],this.oldest[o]=void 0):(this.oldest=void 0,this.newest=void 0),t[e]=t[o]=void 0,this._keymap["delete"](t.key),--this.size,[t.key,t.value]},n.prototype.has=function(t){return this._keymap.has(t)}}))})),GC=$C.LRUMap,YC={name:"HotTable",props:LC("HotTable"),watch:{mergedHotSettings:function(t){this.hotInstance&&void 0!==t&&(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var t=this,e=new GC(this.wrapperRendererCacheSize);return e.shift=function(){var t=GC.prototype.shift.call(this);return t[1].component.$destroy(),t},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:e,editorCache:new Map,get hotInstance(){return!t.__hotInstance||t.__hotInstance&&!t.__hotInstance.isDestroyed?t.__hotInstance:(console.warn(NC),null)},set hotInstance(e){t.__hotInstance=e}}},computed:{mergedHotSettings:function(){return WC(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var t=this.getGlobalRendererVNode(),e=this.getGlobalEditorVNode(),o=WC(this.$props);o.columns=this.columnSettings?this.columnSettings:o.columns,e&&(o.editor=this.getEditorClass(e,this),e.child.$destroy()),t&&(o.renderer=this.getRendererWrapper(t,this),t.child.$destroy()),this.hotInstance=new fC.Core(this.$el,o),this.hotInstance.init(),_C(this),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var e,o=this.hotInstance.getSourceData(),n=[],i=[],r=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),l=0;if(o&&o.length!==r&&o.length<r)for(var a=o.length;a<r;a++)n.push(a);if(s)if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),o&&o[0]&&(null===(e=o[0])||void 0===e?void 0:e.length)!==l&&o[0].length<l)for(var h=o[0].length;h<l;h++)i.push(h);this.hotInstance.batch((function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(r-1,o.length-r),s&&0!==o.length&&(i.length>0?t.hotInstance.columnIndexMapper.removeIndexes(i):t.hotInstance.columnIndexMapper.insertIndexes(l-1,o[0].length-l))}))}},getGlobalRendererVNode:function(){var t=this.$slots["default"]||[];return VC(t,"hot-renderer")},getGlobalEditorVNode:function(){var t=this.$slots["default"]||[];return VC(t,"hot-editor")},getColumnSettings:function(){var t=FC(this.$children),e=!1,o=t.map((function(t){return t.usesRendererComponent&&(e=!0),wC({},t.columnSettings)}));return e&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),o.length?o:void 0},getRendererWrapper:function(t,e){var o=this;return function(n,i,r,s,l,a,h){if(i&&!i.getAttribute("ghost-table")){var c=o.rendererCache,u={hotInstance:n,TD:i,row:r,col:s,prop:l,value:a,cellProperties:h,isRenderer:!0};if(c&&!c.has("".concat(r,"-").concat(s))){var d=jC(t,e,t.componentOptions.propsData,u);c.set("".concat(r,"-").concat(s),{component:d,lastUsedTD:null})}var g=c.get("".concat(r,"-").concat(s)),f=g.component,m=g.lastUsedTD;if(Object.assign(f.$data,u),!f.$el.parentElement||m!==i){while(i.firstChild)i.removeChild(i.firstChild);i.appendChild(f.$el),g.lastUsedTD=i}}return i}},getEditorClass:function(t,e){var o=t.key?t.key.toString():null,n=t.componentOptions.Ctor.options.name,i=o?"".concat(n,":").concat(o):n,r=this.editorCache,s=null;return r.has(i)?s=r.get(i):(s=jC(t,e,t.componentOptions.propsData,{isEditor:!0}),r.set(i,s)),s.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:zC};function KC(t,e,o,n,i,r,s,l,a,h){"boolean"!==typeof s&&(a=l,l=s,s=!1);const c="function"===typeof o?o.options:o;let u;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),n&&(c._scopeId=n),r?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,a(t)),t&&t._registeredComponents&&t._registeredComponents.add(r)},c._ssrRegister=u):e&&(u=s?function(t){e.call(this,h(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,l(t))}),u)if(c.functional){const t=c.render;c.render=function(e,o){return u.call(o),t(e,o)}}else{const t=c.beforeCreate;c.beforeCreate=t?[].concat(t,u):[u]}return o}var XC=YC,qC=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:t.id}},[t._t("default")],2)},QC=[],JC=void 0,ZC=void 0,ty=void 0,ey=!1,oy=KC({render:qC,staticRenderFns:QC},JC,XC,ZC,ey,ty,!1,void 0,void 0,void 0);LC("HotColumn");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function ny(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s}function iy(t){return iy="function"===typeof Symbol&&"symbol"===yC(Symbol.iterator)?function(t){return yC(t)}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":yC(t)},iy(t)}function ry(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function sy(t){return ly(t)||ay(t)||hy()}function ly(t){if(Array.isArray(t)){for(var e=0,o=new Array(t.length);e<t.length;e++)o[e]=t[e];return o}}function ay(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function hy(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function cy(){return"undefined"!==typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function uy(t,e){dy(t,e),Object.getOwnPropertyNames(e.prototype).forEach((function(o){dy(t.prototype,e.prototype,o)})),Object.getOwnPropertyNames(e).forEach((function(o){dy(t,e,o)}))}function dy(t,e,o){var n=o?Reflect.getOwnMetadataKeys(e,o):Reflect.getOwnMetadataKeys(e);n.forEach((function(n){var i=o?Reflect.getOwnMetadata(n,e,o):Reflect.getOwnMetadata(n,e);o?Reflect.defineMetadata(n,i,t,o):Reflect.defineMetadata(n,i,t)}))}var gy={__proto__:[]},fy=gy instanceof Array;function my(t){var e=iy(t);return null==t||"object"!==e&&"function"!==e}function py(t,e){var o=e.prototype._init;e.prototype._init=function(){var e=this,o=Object.getOwnPropertyNames(t);if(t.$options.props)for(var n in t.$options.props)t.hasOwnProperty(n)||o.push(n);o.forEach((function(o){Object.defineProperty(e,o,{get:function(){return t[o]},set:function(e){t[o]=e},configurable:!0})}))};var n=new e;e.prototype._init=o;var i={};return Object.keys(n).forEach((function(t){void 0!==n[t]&&(i[t]=n[t])})),i}var wy=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function vy(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.name=e.name||t._componentTag||t.name;var o=t.prototype;Object.getOwnPropertyNames(o).forEach((function(t){if("constructor"!==t)if(wy.indexOf(t)>-1)e[t]=o[t];else{var n=Object.getOwnPropertyDescriptor(o,t);void 0!==n.value?"function"===typeof n.value?(e.methods||(e.methods={}))[t]=n.value:(e.mixins||(e.mixins=[])).push({data:function(){return ry({},t,n.value)}}):(n.get||n.set)&&((e.computed||(e.computed={}))[t]={get:n.get,set:n.set})}})),(e.mixins||(e.mixins=[])).push({data:function(){return py(this,t)}});var n=t.__decorators__;n&&(n.forEach((function(t){return t(e)})),delete t.__decorators__);var i=Object.getPrototypeOf(t.prototype),r=i instanceof mC.Z?i.constructor:mC.Z,s=r.extend(e);return yy(s,t,r),cy()&&uy(s,t),s}var Cy={prototype:!0,arguments:!0,callee:!0,caller:!0};function yy(t,e,o){Object.getOwnPropertyNames(e).forEach((function(n){if(!Cy[n]){var i=Object.getOwnPropertyDescriptor(t,n);if(!i||i.configurable){var r=Object.getOwnPropertyDescriptor(e,n);if(!fy){if("cid"===n)return;var s=Object.getOwnPropertyDescriptor(o,n);if(!my(r.value)&&s&&s.value===r.value)return}Object.defineProperty(t,n,r)}}}))}function by(t){return"function"===typeof t?vy(t):function(e){return vy(e,t)}}by.registerHooks=function(t){wy.push.apply(wy,sy(t))};var Sy=function(t){TC(o,t);var e=AC(o);function o(){var t;return bC(this,o),t=e.apply(this,arguments),t.name="BaseEditorComponent",t.instance=null,t.row=null,t.col=null,t.prop=null,t.TD=null,t.originalValue=null,t.cellProperties=null,t.state=null,t.hot=null,t}return RC(o,[{key:"mounted",value:function(){var t=this;this.$data.hotCustomEditorClass=function(){var e=function(e){TC(n,e);var o=AC(n);function n(e){var i;return bC(this,n),i=o.call(this,e),t.$data.hotCustomEditorInstance=kC(i),i}return RC(n,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),n}(fC.editors.BaseEditor);return Object.getOwnPropertyNames(fC.editors.BaseEditor.prototype).forEach((function(o){"constructor"!==o&&(e.prototype[o]=function(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t[o]).call.apply(e,[this].concat(i))})})),e}()}},{key:"_fireCallbacks",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];(t=fC.editors.BaseEditor.prototype._fireCallbacks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"beginEditing",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.beginEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"cancelChanges",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.cancelChanges).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"checkEditorSection",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.checkEditorSection).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"close",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.close).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"discardEditor",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.discardEditor).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"enableFullEditMode",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.enableFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"extend",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.extend).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"finishEditing",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.finishEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"focus",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.focus).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getValue",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.getValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"init",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.init).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isInFullEditMode",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.isInFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isOpened",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.isOpened).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isWaiting",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.isWaiting).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"open",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.open).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"prepare",value:function(t,e,o,n,i,r){return this.$data.hotInstance=r.instance,this.$data.row=t,this.$data.col=e,this.$data.prop=o,this.$data.TD=n,this.$data.originalValue=i,this.$data.cellProperties=r,fC.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,t,e,o,n,i,r)}},{key:"saveValue",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.saveValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"setValue",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.setValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"addHook",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.addHook).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"removeHooksByKey",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.removeHooksByKey).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"clearHooks",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.clearHooks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCell",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.getEditedCell).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellRect",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.getEditedCellRect).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellsZIndex",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellsLayerClass",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=fC.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}}]),o}(mC.Z);Sy=ny([by({})],Sy);var Ry=[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]],Ey="odd";function Ty(){return Ry}const My="handsontableEditor",Hy="handsontable";class xy extends sC{static get EDITOR_TYPE(){return Hy}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Be(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r);const s=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(t,e){const o=this.getSourceData(e.row,e.col);void 0!==o&&s.setValue(o),s.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&wo(l,r.handsontable),this.htOptions=l}beginEditing(t,e){const o=this.hot.getSettings().onBeginEditing;o&&!1===o()||super.beginEditing(t,e)}createElements(){super.createElements();const t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}finishEditing(t,e,o){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const t=this.htEditor.getValue();void 0!==t&&this.setValue(t)}super.finishEditing(t,e,o)}assignHooks(){this.hot.addHook("afterDestroy",(()=>{this.htEditor&&this.htEditor.destroy()}))}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");super.registerShortcuts();const o={group:My,relativeToGroup:Zn,position:"before"},n=(t,e)=>{const o=this.htEditor;if(void 0!==t&&(t<0||o.flipped&&t>o.countRows()-1?o.deselectCell():o.selectCell(t,0),o.getData().length))return e.preventDefault(),hn(e),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:t=>{const e=this.htEditor;let o,i;return!e.getSelectedLast()&&e.flipped?o=e.countRows()-1:e.getSelectedLast()&&(e.flipped?(i=e.getSelectedLast()[0],o=Math.max(0,i-1)):(i=e.getSelectedLast()[0],o=i-1)),n(o,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:t=>{const e=this.htEditor;let o,i;if(e.getSelectedLast()||e.flipped){if(e.getSelectedLast())if(e.flipped)o=e.getSelectedLast()[0]+1;else if(!e.flipped){const t=e.countRows()-1;i=e.getSelectedLast()[0],o=Math.min(t,i+1)}}else o=0;return n(o,t)},preventDefault:!1}],o)}unregisterShortcuts(){super.unregisterShortcuts();const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(My)}}function ky(t,e,o){Iy(t,e),e.set(t,o)}function Iy(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ay(t,e,o){return e=Oy(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Oy(t){var e=Py(t,"string");return"symbol"==typeof e?e:String(e)}function Py(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ny(t,e){var o=_y(t,e,"get");return Ly(t,o)}function _y(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Ly(t,e){return e.get?e.get.call(t):e.value}const Dy="autocomplete";var Wy=new WeakMap;class Vy extends xy{constructor(){super(...arguments),Ay(this,"query",null),Ay(this,"strippedChoices",[]),Ay(this,"rawChoices",[]),ky(this,Wy,{writable:!0,value:this.hot.guid.slice(0,9)}),Ay(this,"sortByRelevance",(function(t,e,o){const n=[],i=[],r=t.length;let s,l,a,h,c=e.length;if(0===r){for(a=0;a<c;a++)i.push(a);return i}for(a=0;a<c;a++){if(l=dt(z(e[a])),o)h=l.indexOf(t);else{const e=this.cellProperties.locale;h=l.toLocaleLowerCase(e).indexOf(t.toLocaleLowerCase(e))}-1!==h&&(s=l.length-h-r,n.push({baseIndex:a,index:h,charsLeft:s,value:l}))}for(n.sort(((t,e)=>{if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0})),a=0,c=n.length;a<c;a++)i.push(n[a].baseIndex);return i}))}static get EDITOR_TYPE(){return Dy}getValue(){const t=this.rawChoices.find((t=>{const e=this.stripValueIfNeeded(t);return e===this.TEXTAREA.value}));return U(t)?t:this.TEXTAREA.value}createElements(){super.createElements(),de(this.htContainer,"autocompleteEditor"),de(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&fe(this.TEXTAREA,[It(),Et(),_t("listbox"),Gt()])}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r),this.hot.getSettings().ariaTags&&fe(this.TEXTAREA,[Ft("false"),Yt(`${Ny(this,Wy)}-listbox-${t}-${e}`)])}open(){super.open();const t=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,e=this.hot.getSettings().ariaTags,o=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,n=null===o||void 0===o?void 0:o.length,{row:i,col:r}=this;this.showEditableElement(),this.focus();let s=$e();0===s&&Zo()&&(s+=15),this.addHook("beforeKeyDown",(t=>this.onBeforeKeyDown(t))),this.htEditor.updateSettings({colWidths:t?[Oe(this.TEXTAREA)-2]:void 0,width:t?Oe(this.TEXTAREA)+s:void 0,autoColumnSize:!0,renderer:(t,i,r,s,l,a,h)=>{cC(t,i,r,s,l,a,h);const{filteringCaseSensitive:c,allowHtml:u,locale:d}=this.cellProperties,g=this.query;let f,m,p=z(a);p&&!u&&(f=!0===c?p.indexOf(g):p.toLocaleLowerCase(d).indexOf(g.toLocaleLowerCase(d)),-1!==f&&(m=p.substr(f,g.length),p=p.replace(m,`<strong>${m}</strong>`))),e&&fe(i,[Mt(),...o?[Qt(n)]:[],...o?[Jt(o.indexOf(a)+1)]:[],["id",`${this.htEditor.rootElement.id}_${r}-${s}`]]),i.innerHTML=p},afterSelection:(t,o)=>{if(e){const e=this.htEditor.getCell(t,o,!0);fe(e,[$t()]),fe(this.TEXTAREA,...Kt(e.id))}}}),e&&(fe(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...pt()),fe(this.htEditor.rootElement,[Tt(),Xt("polite"),qt("text"),["id",`${Ny(this,Wy)}-listbox-${i}-${r}`]]),fe(this.TEXTAREA,...Ft("true"))),this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}))}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&fe(this.TEXTAREA,[Ft("false")])}discardEditor(t){super.discardEditor(t),this.hot.view.render()}queryChoices(t){const e=this.cellProperties.source;this.query=t,"function"===typeof e?e.call(this.cellProperties,t,(t=>{this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))})):Array.isArray(e)?(this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))):this.updateChoicesList([])}updateChoicesList(t){const e=We(this.TEXTAREA),o=Ve(this.TEXTAREA),n=this.cellProperties.sortByRelevance,i=this.cellProperties.filter;let r=null,s=null,l=t;n&&(r=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const a=Array.isArray(r)?r.length:0;if(!1===i)a&&(s=r[0]);else{const t=[];for(let e=0,o=l.length;e<o;e++){if(n&&a<=e)break;a?t.push(l[r[e]]):t.push(l[e])}s=0,l=t}this.strippedChoices=l,this.htEditor.loadData(H([l])),0===l.length?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(s)),this.hot.listen(),Be(this.TEXTAREA,e,e===o?void 0:o)}flipDropdownIfNeeded(){const t=xe(this.hot.view._wt.wtTable.TABLE),e=t===this.hot.rootWindow,o=this.cellProperties.preventOverflow;if(e||!e&&(o||"horizontal"===o))return!1;const n=Se(this.TEXTAREA),i=Pe(this.TEXTAREA),r=this.getDropdownHeight(),s=t.scrollTop,l=Pe(this.hot.view._wt.wtTable.THEAD),a=Se(t),h=n.top-a.top-l+s,c=t.scrollHeight-h-l-i,u=r>c&&h>c;return u?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(u?h:c,r),u}limitDropdownIfNeeded(t,e){if(e>t){let o=0,n=0,i=0,r=null;do{i=this.htEditor.getRowHeight(n)||this.htEditor.view._wt.getSetting("defaultRowHeight"),o+=i,n+=1}while(o<t);r=o-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+e-r+"px"),this.setDropdownHeight(o-i)}}flipDropdown(t){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=-t+"px",this.htEditor.flipped=!0}unflipDropdown(){const t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const t=this.htEditor.getColWidth(0)+$e(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(t){this.htEditor.updateSettings({height:t})}highlightBestMatchingChoice(t){"number"===typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const t=this.htEditor.getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}stripValueIfNeeded(t){return this.stripValuesIfNeeded([t])[0]}stripValuesIfNeeded(t){const{allowHtml:e}=this.cellProperties,o=I(t,(t=>z(t))),n=I(o,(t=>e?t:dt(t)));return n}allowKeyEventPropagation(t){const e=this.htEditor.getSelectedRangeLast(),o={row:e?e.from.row:-1};let n=!1;return t===en.ARROW_DOWN&&o.row>0&&o.row<this.htEditor.countRows()-1&&(n=!0),t===en.ARROW_UP&&o.row>-1&&(n=!0),n}onBeforeKeyDown(t){if(nn(t.keyCode)||t.keyCode===en.BACKSPACE||t.keyCode===en.DELETE||t.keyCode===en.INSERT){let e=10;if(t.keyCode===en.C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(e+=10),this.htEditor&&this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}),e)}}}const Fy="checkbox";class jy extends Yv{static get EDITOR_TYPE(){return Fy}beginEditing(t,e){if(e&&"mouseup"===e.type){const t=this.TD.querySelector('input[type="checkbox"]');ue(t,"htBadValue")||t.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var By=o(5065);function zy(t,e,o){return e=Uy(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Uy(t){var e=$y(t,"string");return"symbol"==typeof e?e:String(e)}function $y(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Gy="date",Yy="dateEditor";class Ky extends sC{constructor(){super(...arguments),zy(this,"defaultDateFormat","DD/MM/YYYY"),zy(this,"isCellEdited",!1),zy(this,"parentDestroyed",!1),zy(this,"$datePicker",null)}static get EDITOR_TYPE(){return Gy}init(){if("function"!==typeof E)throw new Error("You need to include moment.js to your project.");if("function"!==typeof By.Z)throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",(()=>{this.parentDestroyed=!0,this.destroyElements()}))}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),de(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const t=new $n(this);t.addEventListener(this.datePicker,"mousedown",(t=>{ue(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()})),t.addEventListener(this.TEXTAREA,"keydown",(t=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.code)&&t.preventDefault()}))}destroyElements(){const t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r)}open(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.hot.getShortcutManager(),o=e.getContext("editor");super.open(),this.showDatepicker(t),o.addShortcut({keys:[["Enter"]],callback:t=>{t.stopPropagation()},group:Yy})}close(){var t;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout((()=>{this.hot._refreshBorders()}));const e=this.hot.getShortcutManager(),o=e.getContext("editor");o.removeShortcutsByGroup(Yy),super.close()}finishEditing(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){const t=this.originalValue;void 0!==t&&this.setValue(t)}super.finishEditing(t,e)}showDatepicker(t){const e=this.TD.getBoundingClientRect(),o=this.cellProperties.dateFormat||this.defaultDateFormat,n=this.hot.view.isMouseDown(),i=!!t&&rn(t.keyCode);let r;this.datePicker.style.display="block",this.$datePicker=new By.Z(this.getDatePickerConfig()),"function"===typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(E),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+e.top+Pe(this.TD)}px`;let s=this.hot.rootWindow.pageXOffset;s=this.hot.isRtl()?e.right-Oe(this.datePicker):e.left,this.datePickerStyle.left=`${s}px`,this.originalValue?(r=this.originalValue,E(r,o,!0).isValid()&&this.$datePicker.setMoment(E(r,o),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),i||n||this.setValue("")):this.cellProperties.defaultDate?(r=this.cellProperties.defaultDate,E(r,o,!0).isValid()&&this.$datePicker.setMoment(E(r,o),!0),i||n||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const t=this.TEXTAREA,e={};this.cellProperties&&this.cellProperties.datePickerConfig&&vo(e,this.cellProperties.datePickerConfig);const o=e.onSelect,n=e.onClose;return e.field=t,e.trigger=t,e.container=this.datePicker,e.bound=!1,e.format=e.format||this.defaultDateFormat,e.reposition=e.reposition||!1,e.isRTL=!1,e.onSelect=t=>{let e=t;isNaN(e.getTime())||(e=E(e).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(e),o&&o()},e.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),n&&n()},e}}const Xy="dropdown";class qy extends Vy{static get EDITOR_TYPE(){return Xy}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}Mn.getSingleton().add("beforeValidate",(function(t,e,o){const n=this.getCellMeta(e,this.propToCol(o));n.editor===qy&&void 0===n.strict&&(n.filter=!1,n.strict=!0)}));const Qy="numeric";class Jy extends sC{static get EDITOR_TYPE(){return Qy}}const Zy="password";class tb extends sC{static get EDITOR_TYPE(){return Zy}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&fe(this.TEXTAREA,[Ot()]),we(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const eb="ht_editor_visible",ob="selectEditor",nb="select";class ib extends Yv{static get EDITOR_TYPE(){return nb}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",de(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(t){this.select.value=t}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";const t=this.hot.getShortcutManager();t.setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",ue(this.select,eb)&&ge(this.select,eb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>this.refreshDimensions())),this.addHook("afterRowResize",(()=>this.refreshDimensions()))}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r);const s=this.cellProperties.selectOptions;let l;l="function"===typeof s?this.prepareOptions(s(this.row,this.col,this.prop)):this.prepareOptions(s),we(this.select),To(l,((t,e)=>{const o=this.hot.rootDocument.createElement("OPTION");o.value=e,Ce(o,t),this.select.appendChild(o)}))}prepareOptions(t){let e={};if(Array.isArray(t))for(let o=0,n=t.length;o<n;o++)e[t[o]]=t[o];else"object"===typeof t&&(e=t);return e}refreshValue(){const t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){if(this.state!==$v.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:t,start:e,width:o,height:n}=this.getEditedCellRect(),i=this.select.style;i.height=`${n}px`,i.width=`${o}px`,i.top=`${t}px`,i[this.hot.isRtl()?"right":"left"]=`${e}px`,i.margin="0px",de(this.select,eb)}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor"),o=t.getContext("grid"),n={group:ob};!1!==this.isInFullEditMode()&&e.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:o,callback:()=>{}},{keys:[["ArrowUp"]],callback:()=>{const t=this.select.selectedIndex-1;t>=0&&(this.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const t=this.select.selectedIndex+1;t<=this.select.length-1&&(this.select[t].selected=!0)}}],n)}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(ob)}}const rb="time";class sb extends sC{static get EDITOR_TYPE(){return rb}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r),this.TEXTAREA.dir="ltr"}}function lb(){Wn(Yv),Wn(Vy),Wn(jy),Wn(Ky),Wn(qy),Wn(xy),Wn(Jy),Wn(tb),Wn(ib),Wn(sC),Wn(sb)}const ab="html";function hb(t,e,o,n,i,r,s){aC.apply(this,[t,e,o,n,i,r,s]),Ce(e,null===r||void 0===r?"":r,!1)}hb.RENDERER_TYPE=ab;const cb="autocomplete";function ub(t,e,o,n,i,r,s){const{rootDocument:l}=t,a=s.allowHtml?hb:cC,h=l.createElement("DIV"),c=t.getSettings().ariaTags;if(h.className="htAutocompleteArrow",c&&h.setAttribute(...Ot()),h.appendChild(l.createTextNode(String.fromCharCode(9660))),a.apply(this,[t,e,o,n,i,r,s]),e.firstChild||e.appendChild(l.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),de(e,"htAutocomplete"),!t.acArrowListener){const i=new $n(t);t.acArrowListener=function(i){ue(i.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(o,n),e)},i.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",(()=>{i.destroy()}))}}ub.RENDERER_TYPE=cb;const db=new WeakMap,gb=new WeakMap,fb="htBadValue",mb="data-row",pb="data-col",wb="checkboxRenderer",vb="checkbox";function Cb(t,e,o,n,i,r,s){const{rootDocument:l}=t,a=t.getSettings().ariaTags;aC.apply(this,[t,e,o,n,i,r,s]),yb(t);let h=bb(l);const c=s.label;let u=!1;if("undefined"===typeof s.checkedTemplate&&(s.checkedTemplate=!0),"undefined"===typeof s.uncheckedTemplate&&(s.uncheckedTemplate=!1),we(e),r===s.checkedTemplate||z(r).toLocaleLowerCase(s.locale)===z(s.checkedTemplate).toLocaleLowerCase(s.locale)?h.checked=!0:r===s.uncheckedTemplate||z(r).toLocaleLowerCase(s.locale)===z(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?h.checked=!1:G(r)?de(h,"noValue"):(h.style.display="none",de(h,fb),u=!0),fe(h,[[mb,o],[pb,n]]),a&&fe(h,[At(h.checked?t.getTranslatedPhrase(pf):t.getTranslatedPhrase(wf)),Ut(h.checked),Ht()]),!u&&c){let s="";if(c.value)s="function"===typeof c.value?c.value.call(this,o,n,i,r):c.value;else if(c.property){const e=t.getDataAtRowProp(o,c.property);s=null!==e?e:""}const a=Sb(l,s,!0!==c.separated);"before"===c.position?c.separated?(e.appendChild(a),e.appendChild(h)):(a.appendChild(h),h=a):c.position&&"after"!==c.position||(c.separated?(e.appendChild(h),e.appendChild(a)):(a.insertBefore(h,a.firstChild),h=a))}function d(){const e=t.getShortcutManager(),o=e.getContext("grid"),n={group:wb};o.addShortcuts([{keys:[["space"]],callback:()=>(g(),!f())},{keys:[["enter"]],callback:()=>(g(),!f()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!f()),relativeToGroup:yw,position:"before"}],n)}function g(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const o=t.getSelectedRange();if(o)for(let n=0;n<o.length;n++){const{row:i,col:r}=o[n].getTopStartCorner(),{row:s,col:l}=o[n].getBottomEndCorner(),a=[];for(let o=i;o<=s;o+=1)for(let n=r;n<=l;n+=1){const i=t.getCellMeta(o,n);if("checkbox"!==i.type)return;if(!0===i.readOnly)continue;"undefined"===typeof i.checkedTemplate&&(i.checkedTemplate=!0),"undefined"===typeof i.uncheckedTemplate&&(i.uncheckedTemplate=!1);const r=t.getDataAtCell(o,n);!1===e?[i.checkedTemplate,i.checkedTemplate.toString()].includes(r)?a.push([o,n,i.uncheckedTemplate]):[i.uncheckedTemplate,i.uncheckedTemplate.toString(),null,void 0].includes(r)&&a.push([o,n,i.checkedTemplate]):a.push([o,n,i.uncheckedTemplate])}a.length>0&&t.setDataAtCell(a)}}function f(){const e=t.getSelectedRange();if(e){for(let o=0;o<e.length;o++){const n=e[o].getTopStartCorner(),i=e[o].getBottomEndCorner();for(let e=n.row;e<=i.row;e++)for(let o=n.col;o<=i.col;o++){const n=t.getCellMeta(e,o);if("checkbox"!==n.type)return!1;const i=t.getCell(e,o);if(null===i||void 0===i)return!0;{const t=i.querySelectorAll("input[type=checkbox]");if(t.length>0&&!n.readOnly)return!0}}}return!1}}(!c||c&&!c.separated)&&e.appendChild(h),u&&e.appendChild(l.createTextNode("#bad-value#")),db.has(t)||(db.set(t,!0),d())}function yb(t){let e=gb.get(t);if(!e){const{rootElement:o}=t;e=new $n(t),e.addEventListener(o,"click",(e=>Eb(e,t))),e.addEventListener(o,"mouseup",(e=>Rb(e,t))),e.addEventListener(o,"change",(e=>Tb(e,t))),gb.set(t,e)}return e}function bb(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Sb(t,e,o){const n=t.createElement("label");return n.className="htCheckboxRendererLabel "+(o?"fullWidth":""),n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}function Rb(t,e){const{target:o}=t;Mb(o)&&o.hasAttribute(mb)&&o.hasAttribute(pb)&&setTimeout(e.listen,10)}function Eb(t,e){const{target:o}=t;if(!Mb(o))return;if(!o.hasAttribute(mb)||!o.hasAttribute(pb))return;const n=parseInt(o.getAttribute(mb),10),i=parseInt(o.getAttribute(pb),10),r=e.getCellMeta(n,i);r.readOnly&&t.preventDefault()}function Tb(t,e){const{target:o}=t;if(!Mb(o))return;if(!o.hasAttribute(mb)||!o.hasAttribute(pb))return;const n=parseInt(o.getAttribute(mb),10),i=parseInt(o.getAttribute(pb),10),r=e.getCellMeta(n,i);if(!r.readOnly){let o=null;o=t.target.checked?void 0===r.uncheckedTemplate||r.checkedTemplate:void 0!==r.uncheckedTemplate&&r.uncheckedTemplate,e.setDataAtCell(n,i,o)}}function Mb(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}Mn.getSingleton().add("modifyAutoColumnSizeSeed",(function(t,e,o){const{label:n,type:i,row:r,column:s,prop:l}=e;if(i===vb){if(n){const{value:e,property:i}=n;let a=o;if(e)a="function"===typeof e?e(r,s,l,o):e;else if(i){const t=this.getDataAtRowProp(r,i);a=null!==t?t:o}t=a}return t}})),Cb.RENDERER_TYPE=vb;var Hb=o(204);const xb="numeric";function kb(t,e,o,n,i,r,s){let l=r;if(Di(l)){const t=s.numericFormat,o=t&&t.culture||"-",n=t&&t.pattern,i=s.className||"",r=i.length?i.split(" "):[];if("undefined"!==typeof o&&!Hb.languages()[o]){const t=o.replace("-",""),e=Hb.allLanguages?Hb.allLanguages[o]:Hb[t];e&&Hb.registerLanguage(e)}Hb.setLanguage(o),l=Hb(l).format(n||"0"),r.indexOf("htLeft")<0&&r.indexOf("htCenter")<0&&r.indexOf("htRight")<0&&r.indexOf("htJustify")<0&&r.push("htRight"),r.indexOf("htNumeric")<0&&r.push("htNumeric"),s.className=r.join(" "),e.dir="ltr"}cC(t,e,o,n,i,l,s)}kb.RENDERER_TYPE=xb;const Ib="password";function Ab(t,e,o,n,i,r,s){cC.apply(this,[t,e,o,n,i,r,s]);const l=s.hashLength||e.innerHTML.length,a=s.hashSymbol||"*";let h="";Vi(l-1,(()=>{h+=a})),Ce(e,h)}Ab.RENDERER_TYPE=Ib;const Ob="time";function Pb(t,e,o,n,i,r,s){cC.apply(this,[t,e,o,n,i,r,s]),e.dir="ltr"}function Nb(){wr(ub),wr(aC),wr(Cb),wr(hb),wr(kb),wr(Ab),wr(cC),wr(Pb)}Pb.RENDERER_TYPE=Ob;const _b="autocomplete";function Lb(t,e){let o=t;null!==o&&void 0!==o||(o=""),this.allowEmpty&&""===o?e(!0):this.strict&&this.source?"function"===typeof this.source?this.source(o,Db(o,e)):Db(o,e)(this.source):e(!0)}function Db(t,e){const o=t;return function(t){let n=!1;for(let e=0,i=t.length;e<i;e++)if(o===t[e]){n=!0;break}e(n)}}function Wb(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}Lb.VALIDATOR_TYPE=_b;const Vb="date";function Fb(t,e){const o=Ln(Gy,this.instance);let n=t,i=!0;null!==n&&void 0!==n||(n="");let r=E(n,this.dateFormat||o.defaultDateFormat,!0).isValid(),s=E(new Date(n)).isValid()||r;if(this.allowEmpty&&""===n&&(s=!0,r=!0),s||(i=!1),!s&&r&&(i=!0),s&&!r)if(!0===this.correctFormat){const t=jb(n,this.dateFormat),e=this.instance.toVisualRow(this.row),o=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,o,t,"dateValidator"),i=!0}else i=!1;e(i)}function jb(t,e){const o=E(Wb(t)),n=E(t,e),i=t.search(/[A-z]/g)>-1;let r;return r=o.isValid()&&o.format("x")===n.format("x")||!n.isValid()||i?o:n,r.format(e)}Fb.VALIDATOR_TYPE=Vb;const Bb="numeric";function zb(t,e){let o=t;null!==o&&void 0!==o||(o=""),this.allowEmpty&&""===o?e(!0):e(""!==o&&Di(t))}zb.VALIDATOR_TYPE=Bb;const Ub=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],$b="time";function Gb(t,e){const o=this.timeFormat||"h:mm:ss a";let n=!0,i=t;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const r=/^\d{1,2}$/.test(i);r&&(i+=":00");const s=E(i,Ub,!0).isValid()?E(i):E(i,o);let l=s.isValid(),a=E(i,o,!0).isValid()&&!r;if(this.allowEmpty&&""===i&&(l=!0,a=!0),l||(n=!1),!l&&a&&(n=!0),l&&!a)if(!0===this.correctFormat){const t=s.format(o),e=this.instance.toVisualRow(this.row),i=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,i,t,"timeValidator"),n=!0}else n=!1;e(n)}function Yb(){Er(Lb),Er(Fb),Er(zb),Er(Gb)}Gb.VALIDATOR_TYPE=$b;const Kb="autocomplete",Xb={CELL_TYPE:Kb,editor:Vy,renderer:ub,validator:Lb},qb="checkbox",Qb={CELL_TYPE:qb,editor:jy,renderer:Cb},Jb="date";function Zb(t,e,o,n,i,r,s){ub.apply(this,[t,e,o,n,i,r,s])}Zb.RENDERER_TYPE=Jb;const tS="date",eS={CELL_TYPE:tS,editor:Ky,renderer:Zb,validator:Fb},oS="dropdown",nS={CELL_TYPE:oS,editor:qy,renderer:ub,validator:Lb},iS="handsontable";function rS(t,e,o,n,i,r,s){ub.apply(this,[t,e,o,n,i,r,s])}rS.RENDERER_TYPE=iS;const sS="handsontable",lS={CELL_TYPE:sS,editor:xy,renderer:rS},aS="numeric",hS={CELL_TYPE:aS,editor:Jy,renderer:kb,validator:zb,dataType:"number"},cS="password",uS={CELL_TYPE:cS,editor:tb,renderer:Ab,copyable:!1},dS="select";function gS(t,e,o,n,i,r,s){cC.apply(this,[t,e,o,n,i,r,s])}gS.RENDERER_TYPE=dS;const fS="select",mS={CELL_TYPE:fS,editor:ib,renderer:gS},pS="time",wS={CELL_TYPE:pS,editor:sb,renderer:Pb,validator:Gb};function vS(){Sp(Xb),Sp(Qb),Sp(eS),Sp(nS),Sp(lS),Sp(hS),Sp(uS),Sp(mS),Sp(dC),Sp(wS)}function CS(t,e){bS(t,e),e.add(t)}function yS(t,e,o){bS(t,e),e.set(t,o)}function bS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SS(t,e,o){return e=RS(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function RS(t){var e=ES(t,"string");return"symbol"==typeof e?e:String(e)}function ES(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function TS(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function MS(t,e){var o=HS(t,e,"get");return xS(t,o)}function HS(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function xS(t,e){return e.get?e.get.call(t):e.value}const kS=new Map([["plugin",lr],["cell-type",vp],["editor",On],["renderer",gr],["validator",yr]]),IS="base",AS=[];let OS=null;var PS=new WeakMap,NS=new WeakSet;class _S{static get PLUGIN_KEY(){return IS}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(t){CS(this,NS),SS(this,"eventManager",new $n(this)),SS(this,"pluginName",null),SS(this,"pluginsInitializedCallbacks",[]),SS(this,"isPluginsReady",!1),SS(this,"enabled",!1),SS(this,"initialized",!1),yS(this,PS,{writable:!0,value:{}}),Eo(this,"hot",t,{writable:!1}),OS=null,this.hot.addHook("afterPluginsInitialized",(()=>this.onAfterPluginsInitialized())),this.hot.addHook("afterUpdateSettings",(t=>this.onUpdateSettings(t))),this.hot.addHook("beforeInit",(()=>this.init()))}init(){this.pluginName=this.hot.getPluginName(this);const t=this.constructor.PLUGIN_DEPS,e=Array.isArray(t)?t:[];if(e.length>0){const t=[];if(e.forEach((e=>{const[o,n]=e.split(":");if(!kS.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);kS.get(o)(n)||t.push(` - ${n} (${o})`)})),t.length>0){const e=[`The ${this.pluginName} plugin requires the following modules:\n`,`${t.join("\n")}\n`].join("");AS.push(e)}}OS||(OS=rr()),OS.indexOf("UndoRedo")>=0&&OS.splice(OS.indexOf("UndoRedo"),1),OS.indexOf(this.pluginName)>=0&&OS.splice(OS.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}));const o=0===OS.length;if(o){if(AS.length>0){const t=[`${AS.join("\n")}\n`,"You have to import and register them manually."].join("");throw new Error(t)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var t;null===(t=this.eventManager)||void 0===t||t.clear(),this.clearHooks(),this.enabled=!1}addHook(t,e){MS(this,PS)[t]=MS(this,PS)[t]||[];const o=MS(this,PS)[t];this.hot.addHook(t,e),o.push(e),MS(this,PS)[t]=o}removeHooks(t){A(MS(this,PS)[t]||[],(e=>{this.hot.removeHook(t,e)}))}clearHooks(){const t=MS(this,PS);To(t,((t,e)=>this.removeHooks(e))),t.length=0}callOnPluginsReady(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}onAfterPluginsInitialized(){A(this.pluginsInitializedCallbacks,(t=>t())),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(t){const e=TS(this,NS,LS).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}updatePlugin(){}destroy(){var t;null===(t=this.eventManager)||void 0===t||t.destroy(),this.clearHooks(),To(this,((t,e)=>{"hot"!==e&&(this[e]=null)})),delete this.t,delete this.hot}}function LS(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if("boolean"===typeof e)return e;for(let o=0;o<e.length;o++)if(void 0!==t[e[o]])return!0;return!1}function DS(t,e,o){return e=WS(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function WS(t){var e=VS(t,"string");return"symbol"==typeof e?e:String(e)}function VS(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class FS{constructor(t){DS(this,"hot",null),DS(this,"container",null),DS(this,"injected",!1),DS(this,"rows",[]),DS(this,"columns",[]),DS(this,"samples",null),DS(this,"settings",{useHeaders:!0}),this.hot=t}addRow(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const o={row:t};this.rows.push(o),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(t)),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}addColumnHeadersRow(t){const e=this.hot.getColHeader(0);if(null!==e&&void 0!==e){const e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}addColumn(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const o={col:t};this.columns.push(o),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}getHeights(t){this.injected||this.injectTable(),A(this.rows,(e=>{t(e.row,Pe(e.table)-1)}))}getWidths(t){this.injected||this.injectTable(),A(this.columns,(e=>{const{width:o}=e.table.getBoundingClientRect();t(e.col,Math.ceil(o))}))}setSettings(t){this.settings=t}setSetting(t,e){this.settings||(this.settings={}),this.settings[t]=e}getSettings(){return this.settings}getSetting(t){return this.settings?this.settings[t]:null}createColGroupsCol(t){const e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1,-1)),this.samples.forEach((o=>{A(o.strings,(o=>{e.appendChild(this.createColElement(o.col,t))}))})),e}createRow(t){const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,n),o.appendChild(n)),this.samples.forEach((n=>{A(n.strings,(n=>{const i=n.col,r=this.hot.getCellMeta(t,i);r.col=i,r.row=t;const s=this.hot.getCellRenderer(r),l=e.createElement("td");l.setAttribute("ghost-table",1),s(this.hot,l,t,i,this.hot.colToProp(i),n.value,r),o.appendChild(l)}))})),o}appendColumnHeadersRow(){const{rootDocument:t}=this.hot,e=t.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){const n=t.createElement("th");o.push([-1,n]),e.appendChild(n)}this.samples.forEach((n=>{A(n.strings,(n=>{const i=n.col,r=t.createElement("th");o.push([i,r]),e.appendChild(r)}))})),this.table.tHead.appendChild(e),A(o,(t=>{const[e,o]=t;this.hot.view.appendColHeader(e,o)}))}createCol(t){const{rootDocument:e}=this.hot,o=e.createDocumentFragment();return this.samples.forEach((n=>{A(n.strings,(n=>{const i=n.row,r=this.hot.getCellMeta(i,t);r.col=t,r.row=i;const s=this.hot.getCellRenderer(r),l=e.createElement("td"),a=e.createElement("tr");l.setAttribute("ghost-table",1),s(this.hot,l,i,t,this.hot.colToProp(t),n.value,r),a.appendChild(l),o.appendChild(a)}))})),o}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t,e){const o=this.hot.rootDocument.createElement("col");let n=0;e>=0&&t>=0&&(n=this.hot.getCellMeta(e,t).colspan);let i=this.hot.view._wt.wtTable.getStretchedColumnWidth(t);if(n>1)for(let r=t+1;r<t+n;r++)i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(r);return o.style.width=`${i}px`,o}createTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("table"),i=e.createElement("thead"),r=e.createElement("tbody"),s=e.createElement("colgroup"),l=e.createElement("tr"),a=e.createElement("th");return this.isVertical()&&n.appendChild(s),this.isHorizontal()&&(l.appendChild(a),i.appendChild(l),n.style.tableLayout="auto",n.style.width="auto"),n.appendChild(i),this.isVertical()&&r.appendChild(l),n.appendChild(r),de(n,t),o.appendChild(n),{fragment:o,table:n,tHead:i,tBody:r,colGroup:s,tr:l,th:a}}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("div"),i=`htGhostTable htAutoSize ${t.trim()}`;return de(n,i),o.appendChild(n),{fragment:o,container:n}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}}var jS=FS;function BS(t,e,o){return e=zS(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function zS(t){var e=US(t,"string");return"symbol"==typeof e?e:String(e)}function US(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class $S{static get SAMPLE_COUNT(){return 3}constructor(t){BS(this,"samples",null),BS(this,"dataFactory",null),BS(this,"customSampleCount",null),BS(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:$S.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,e){return this.generateSamples("row",e,t)}generateColumnSamples(t,e){return this.generateSamples("col",e,t)}generateSamples(t,e,o){const n=new Map,{from:i,to:r}="number"===typeof o?{from:o,to:o}:o;return Vi(i,r,(o=>{const i=this.generateSample(t,e,o);n.set(o,i)})),n}generateSample(t,e,o){if("row"!==t&&"col"!==t)throw new Error("Unsupported sample type");const n=new Map,i="row"===t?"col":"row",r=[];return Vi(e.from,e.to,(e=>{const s="row"===t?this.dataFactory(o,e):this.dataFactory(e,o);if(!1===s)return;const{value:l,bundleSeed:a}=s,h="string"===typeof a&&a.length>0;let c;c=h?a:Ro(l)?`${Object.keys(l).length}`:Array.isArray(l)?`${l.length}`:`${z(l).length}`,n.has(c)||n.set(c,{needed:this.getSampleCount(),strings:[]});const u=n.get(c);if(u.needed){const t=r.indexOf(l)>-1;(!t||this.allowDuplicates||h)&&(u.strings.push({value:l,[i]:e}),r.push(l),u.needed-=1)}})),n}}var GS=$S;function YS(t,e){XS(t,e),e.add(t)}function KS(t,e,o){XS(t,e),e.set(t,o)}function XS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qS(t,e,o){return e=QS(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function QS(t){var e=JS(t,"string");return"symbol"==typeof e?e:String(e)}function JS(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ZS(t,e,o){var n=oR(t,e,"set");return tR(t,n,o),o}function tR(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function eR(t,e){var o=oR(t,e,"get");return nR(t,o)}function oR(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function nR(t,e){return e.get?e.get.call(t):e.value}function iR(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}Mn.getSingleton().register("modifyAutoColumnSizeSeed");const rR="autoColumnSize",sR=10,lR="autoColumnSize";var aR=new WeakMap,hR=new WeakSet,cR=new WeakSet,uR=new WeakSet,dR=new WeakSet,gR=new WeakSet,fR=new WeakSet;class mR extends _S{static get PLUGIN_KEY(){return rR}static get PLUGIN_PRIORITY(){return sR}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){super(t),YS(this,fR),YS(this,gR),YS(this,dR),YS(this,uR),YS(this,cR),YS(this,hR),qS(this,"ghostTable",new jS(this.hot)),qS(this,"samplesGenerator",new GS(((t,e)=>{const o=this.hot.getCellMeta(t,e);let n="";o.spanned||(n=this.hot.getDataAtCell(t,e));let i="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(i=this.hot.runHooks("modifyAutoColumnSizeSeed",i,o,n)),{value:n,bundleSeed:i}}))),qS(this,"firstCalculation",!0),qS(this,"inProgress",!1),qS(this,"measuredColumns",0),qS(this,"columnWidthsMap",new ju),KS(this,aR,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(lR,this.columnWidthsMap),this.addHook("beforeColumnResize",((t,e,o)=>iR(this,dR,CR).call(this,t,e,o)))}isEnabled(){return!1!==this.hot.getSettings()[rR]&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[rR];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return iR(t,cR,wR).call(t,...o)})),this.addHook("beforeChangeRender",(t=>iR(this,uR,vR).call(this,t))),this.addHook("afterFormulasValuesUpdate",(t=>iR(this,fR,bR).call(this,t))),this.addHook("beforeViewRender",(t=>iR(this,hR,pR).call(this,t))),this.addHook("modifyColWidth",((t,e)=>this.getColumnWidth(e,t))),this.addHook("afterInit",(()=>iR(this,gR,yR).call(this))),super.enablePlugin()}updatePlugin(){const t=this.findColumnsWhereHeaderWasChanged();t.length&&(this.clearCache(t),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",((t,e,o)=>iR(this,dR,CR).call(this,t,e,o)))}calculateVisibleColumnsWidth(){const t=this.hot.countRows();if(!t)return;const e=this.hot.renderCall,o=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();-1!==o&&-1!==n&&this.calculateColumnsWidth({from:o,to:n},void 0,e)}calculateColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n="number"===typeof t?{from:t,to:t}:t,i="number"===typeof e?{from:e,to:e}:e;Vi(n.from,n.to,(t=>{let e=this.hot.toPhysicalColumn(t);if(null===e&&(e=t),o||null===this.columnWidthsMap.getValueAtIndex(e)&&!this.hot._getColWidthFromSettings(e)){const e=this.samplesGenerator.generateColumnSamples(t,i);A(e,(t=>{let[e,o]=t;return this.ghostTable.addColumn(e,o)}))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((t,e)=>{const o=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(o,e)}))}),!0),this.measuredColumns=n.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=0;const o=this.hot.countCols()-1;let n=null;this.inProgress=!0;const i=()=>{if(!this.hot)return Oo(n),void(this.inProgress=!1);this.calculateColumnsWidth({from:e,to:Math.min(e+mR.CALCULATION_STEP,o)},t),e=e+mR.CALCULATION_STEP+1,e<o?n=Ao(i):(Oo(n),this.inProgress=!1,this.hot.view.adjustElementsSize())},r=this.getSyncCalculationLimit();this.firstCalculation&&r>=0&&(this.calculateColumnsWidth({from:0,to:r},t),this.firstCalculation=!1,e=r+1),e<o?i():this.inProgress=!1}setSamplingOptions(){const t=this.hot.getSettings()[rR],e=t&&Io(t,"samplingRatio")?t.samplingRatio:void 0,o=t&&Io(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const t=this.hot.getSettings()[rR];let e=mR.SYNC_CALCULATION_LIMIT;const o=this.hot.countCols()-1;return Ro(t)&&(e=t.syncLimit,ct(e)?e=ji(o,e):e>>=0),Math.min(e,o)}getColumnWidth(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e;return void 0===n&&(n=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),o&&"number"===typeof n&&(n=Math.max(n,Gh.DEFAULT_WIDTH))),n}getFirstVisibleColumn(){const t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){const e=t.wtTable.getFirstVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){const e=t.wtTable.getFirstRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return-1}getLastVisibleColumn(){const t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){const e=t.wtTable.getLastVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){const e=t.wtTable.getLastRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return-1}findColumnsWhereHeaderWasChanged(){const t=this.hot.getColHeader(),e=x(t,((t,e,o)=>{const n=eR(this,aR).length;return(n-1<o||eR(this,aR)[o]!==e)&&t.push(o),n-1<o?eR(this,aR).push(e):eR(this,aR)[o]=e,t}),[]);return e}clearCache(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution((()=>{A(t,(t=>{this.columnWidthsMap.setValueAtIndex(t,null)}))}),!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!k(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(t=>null===t)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function pR(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function wR(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout((()=>{this.hot&&this.recalculateAllColumnsWidth()}),0)}function vR(t){const e=I(t,(t=>{let[,e]=t;return this.hot.toPhysicalColumn(this.hot.propToCol(e))}));this.clearCache(Array.from(new Set(e)))}function CR(t,e,o){let n=t;return o&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function yR(){ZS(this,aR,this.hot.getColHeader())}function bR(t){const e=k(t,(t=>{var e;return U(null===(e=t.address)||void 0===e?void 0:e.col)})),o=I(e,(t=>t.address.col));this.clearCache(Array.from(new Set(o)))}const SR={horizontal:"horizontal",vertical:"vertical"};function RR(t,e,o){let n,i,r;return e[0]===t[0]&&e[1]<t[1]?(r="left",n=o(e[0],e[1]),i=o(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(r="right",n=o(e[0],t[3]+1),i=o(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(r="up",n=o(e[0],e[1]),i=o(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(r="down",n=o(t[2]+1,e[1]),i=o(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:r,startOfDragCoords:n,endOfDragCoords:i}}function ER(t){const e={};return!0===t?(e.directions=Object.keys(SR),e.autoInsertRow=!0):Ro(t)?(U(t.autoInsertRow)?t.direction===SR.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,U(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(SR)):"string"===typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function TR(t,e){MR(t,e),e.add(t)}function MR(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HR(t,e,o){return e=xR(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function xR(t){var e=kR(t,"string");return"symbol"==typeof e?e:String(e)}function kR(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function IR(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}Mn.getSingleton().register("modifyAutofillRange"),Mn.getSingleton().register("beforeAutofill"),Mn.getSingleton().register("afterAutofill");const AR="autofill",OR=20,PR=["fillHandle"],NR="insert_row_below",_R=200;var LR=new WeakSet,DR=new WeakSet,WR=new WeakSet,VR=new WeakSet,FR=new WeakSet;class jR extends _S{constructor(){super(...arguments),TR(this,FR),TR(this,VR),TR(this,WR),TR(this,DR),TR(this,LR),HR(this,"addingStarted",!1),HR(this,"mouseDownOnCellCorner",!1),HR(this,"mouseDragOutside",!1),HR(this,"handleDraggedCells",0),HR(this,"directions",[]),HR(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return AR}static get PLUGIN_PRIORITY(){return OR}static get SETTING_KEYS(){return[AR,...PR]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(t=>IR(this,DR,zR).call(this,t))),this.addHook("afterOnCellCornerDblClick",(t=>IR(this,LR,BR).call(this,t))),this.addHook("beforeOnCellMouseOver",((t,e)=>IR(this,WR,UR).call(this,e))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const t=this.hot.getSelectedRangeLast(),{row:e,col:o}=t.getTopStartCorner(),{row:n,col:i}=t.getBottomEndCorner(),r=this.hot.runHooks("modifyCopyableRange",[{startRow:e,startCol:o,endRow:n,endCol:i}]),s=[],l=[],a=[];return A(r,(t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===s.indexOf(e)&&s.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===l.indexOf(e)&&l.push(e)})),A(s,(t=>{const e=[];A(l,(o=>{e.push(this.hot.getCopyableData(t,o))})),a.push(e)})),a}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[t,e,o,n]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),r=i.getTopStartCorner(),s=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[r.row,r.col,s.row,s.col],a=this.hot.runHooks("modifyAutofillRange",[Math.min(r.row,t),Math.min(r.col,e),Math.max(s.row,o),Math.max(s.col,n)],l),{directionOfDrag:h,startOfDragCoords:c,endOfDragCoords:u}=RR(l,a,((t,e)=>this.hot._createCellCoords(t,e)));if(c&&c.row>-1&&c.col>-1){const t=this.getSelectionData(),e=i.clone(),o=this.hot._createCellRange(c,c,u),n=this.hot.runHooks("beforeAutofill",t,e,o,h);if(!1===n)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let r=n;const s=n;if(["up","left"].indexOf(h)>-1&&(1!==s.length||0!==s[0].length))if(r=[],"up"===h){const t=u.row-c.row+1,e=t%s.length;for(let o=0;o<t;o++)r.push(s[(o+(s.length-e))%s.length])}else{const t=u.col-c.col+1,e=t%s[0].length;for(let o=0;o<s.length;o++){r.push([]);for(let n=0;n<t;n++)r[o].push(s[o][(n+(s[o].length-e))%s[o].length])}}this.hot.populateFromArray(c.row,c.col,r,u.row,u.col,`${this.pluginName}.fill`,null),this.setSelection(a),this.hot.runHooks("afterAutofill",r,e,o,h),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}getCoordsOfDragAndDropBorders(t){const e=this.hot.getSelectedRangeLast(),o=e.getBottomEndCorner();let n=t;if(this.directions.includes(SR.vertical)&&this.directions.includes(SR.horizontal)){const i=e.getTopStartCorner();(o.col<=t.col||i.col>=t.col)&&(n=this.hot._createCellCoords(o.row,t.col)),(o.row<t.row||i.row>t.row)&&(n=this.hot._createCellCoords(t.row,o.col))}else if(this.directions.includes(SR.vertical))n=this.hot._createCellCoords(t.row,o.col);else{if(!this.directions.includes(SR.horizontal))return;n=this.hot._createCellCoords(o.row,t.col)}return this.reduceSelectionAreaIfNeeded(n)}showBorder(t){const e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout((()=>{this.hot.alter(NR,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1}),_R)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.countRows();t[2]<o-1&&e[2]===o-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(t){const e=this.hot.getData(),o=this.hot.countRows();let n;for(let i=t[2]+1;i<o;i++){for(let n=t[1];n<=t[3];n++){const t=e[i][n];if(t)return-1}const o=e[i][t[1]-1],r=e[i][t[3]+1];(o||r)&&(n=i)}return n}addSelectionFromStartAreaToSpecificRowIndex(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}setSelection(t){this.hot.selectCell(...I(t,(t=>Math.max(t,0))),!1,!1)}selectAdjacent(){const t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(t){const{documentElement:e}=this.hot.rootDocument,o=Se(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+Pe(this.hot.table),n=Se(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+Oe(this.hot.table);return t.clientY>o&&t.clientX<=n}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseup",(()=>IR(this,VR,$R).call(this))),this.eventManager.addEventListener(t,"mousemove",(t=>IR(this,FR,GR).call(this,t)))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const t=ER(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}destroy(){super.destroy()}}function BR(){const t=this.selectAdjacent();t&&this.fillIn()}function zR(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function UR(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function $R(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function GR(t){const e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function YR(t,e){KR(t,e),e.add(t)}function KR(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XR(t,e,o){return e=qR(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function qR(t){var e=QR(t,"string");return"symbol"==typeof e?e:String(e)}function QR(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function JR(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const ZR="autoRowSize",tE=40,eE="autoRowSize";var oE=new WeakSet,nE=new WeakSet,iE=new WeakSet,rE=new WeakSet;class sE extends _S{static get PLUGIN_KEY(){return ZR}static get PLUGIN_PRIORITY(){return tE}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){super(t),YR(this,rE),YR(this,iE),YR(this,nE),YR(this,oE),XR(this,"headerHeight",null),XR(this,"ghostTable",new jS(this.hot)),XR(this,"samplesGenerator",new GS(((t,e)=>{if(t>=0&&e>=0){const o=this.hot.getCellMeta(t,e);if(o.hidden)return!1}let o;return t>=0?o=this.hot.getDataAtCell(t,e):-1===t&&(o=this.hot.getColHeader(e)),{value:o}}))),XR(this,"firstCalculation",!0),XR(this,"inProgress",!1),XR(this,"measuredRows",0),XR(this,"rowHeightsMap",new ju),this.hot.rowIndexMapper.registerMap(eE,this.rowHeightsMap),this.addHook("beforeRowResize",((t,e,o)=>JR(this,nE,aE).call(this,t,e,o)))}isEnabled(){const t=this.hot.getSettings()[ZR];return!0===t||Ro(t)}enablePlugin(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JR(t,iE,hE).call(t,...o)})),this.addHook("beforeChangeRender",(t=>JR(this,rE,cE).call(this,t))),this.addHook("beforeColumnResize",(()=>this.recalculateAllRowsHeight())),this.addHook("beforeViewRender",(t=>JR(this,oE,lE).call(this,t))),this.addHook("modifyRowHeight",((t,e)=>this.getRowHeight(e,t))),this.addHook("modifyColumnHeaderHeight",(()=>this.getColumnHeaderHeight())),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",((t,e,o)=>JR(this,nE,aE).call(this,t,e,o)))}calculateRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n="number"===typeof t?{from:t,to:t}:t,i="number"===typeof e?{from:e,to:e}:e;if(null!==this.hot.getColHeader(0)){const t=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(t.get(-1))}Vi(n.from,n.to,(t=>{if(o||null===this.rowHeightsMap.getValueAtIndex(t)){const e=this.samplesGenerator.generateRowSamples(t,i);A(e,(t=>{let[e,o]=t;return this.ghostTable.addRow(e,o)}))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((t,e)=>{t<0?this.headerHeight=e:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(t),e)}))}),!0),this.measuredRows=n.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=0;const o=this.hot.countRows()-1;let n=null;this.inProgress=!0;const i=()=>{if(!this.hot)return Oo(n),void(this.inProgress=!1);this.calculateRowsHeight({from:e,to:Math.min(e+sE.CALCULATION_STEP,o)},t),e=e+sE.CALCULATION_STEP+1,e<o?n=Ao(i):(Oo(n),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},r=this.getSyncCalculationLimit();this.firstCalculation&&r>=0&&(this.calculateRowsHeight({from:0,to:r},t),this.firstCalculation=!1,e=r+1),e<o?i():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const t=this.hot.getSettings()[ZR],e=t&&Io(t,"samplingRatio")?t.samplingRatio:void 0,o=t&&Io(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}recalculateAllRowsHeight(){be(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const t=this.hot.getSettings()[ZR];let e=sE.SYNC_CALCULATION_LIMIT;const o=this.hot.countRows()-1;return Ro(t)&&(e=t.syncLimit,ct(e)?e=ji(o,e):e>>=0),Math.min(e,o)}getRowHeight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;const o=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t));let n=e;return null!==o&&o>(e||0)&&(n=o),n}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(t){const{from:e,to:o}="number"===typeof t?{from:t,to:t}:t;this.hot.batchExecution((()=>{Vi(Math.min(e,o),Math.max(e,o),(t=>{this.rowHeightsMap.setValueAtIndex(t,null)}))}),!0)}isNeedRecalculate(){return!!k(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(t=>null===t)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function lE(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,o=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(-1!==o&&-1!==n){if(this.calculateRowsHeight({from:o,to:n},void 0,t),e){const t=this.hot.countRows()-1;this.calculateRowsHeight({from:t-e,to:t})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function aE(t,e,o){let n=t;return o&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}function hE(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout((()=>{this.hot&&this.recalculateAllRowsHeight()}))}function cE(t){let e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}const uE=new Map([["indexesSequence",{getListWithInsertedItems:Nu,getListWithRemovedItems:_u}],["physicallyIndexed",{getListWithInsertedItems:Vu,getListWithRemovedItems:Fu}]]),dE=t=>{if(!1===uE.has(t))throw new Error(`Alter strategy with ID '${t}' does not exist.`);return uE.get(t)},{getListWithInsertedItems:gE,getListWithRemovedItems:fE}=dE("physicallyIndexed");class mE extends Pu{constructor(){super((t=>t))}insert(t,e){const o=Du(this.indexedValues,e);this.indexedValues=gE(o,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){const e=fE(this.indexedValues,t);this.indexedValues=Lu(e,t),super.remove(t)}}var pE=mE;const{getListWithInsertedItems:wE,getListWithRemovedItems:vE}=dE("physicallyIndexed");class CE extends Pu{constructor(){super((t=>t))}insert(t,e){this.indexedValues=wE(this.indexedValues,t,e,((t,e)=>this.getNextValue(e))),super.insert(t,e)}remove(t){this.indexedValues=vE(this.indexedValues,t),super.remove(t)}getNextValue(t){return Math.max(...this.getValues())+1+t}}var yE=CE;function bE(t,e){SE(t,e),e.add(t)}function SE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RE(t,e,o){return e=EE(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function EE(t){var e=TE(t,"string");return"symbol"==typeof e?e:String(e)}function TE(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ME(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const HE="bindRowsWithHeaders",xE=210,kE="loose",IE=new Map([["loose",pE],["strict",yE]]);var AE=new WeakSet;class OE extends _S{constructor(){super(...arguments),bE(this,AE),RE(this,"headerIndexes",null)}static get PLUGIN_KEY(){return HE}static get PLUGIN_PRIORITY(){return xE}isEnabled(){return!!this.hot.getSettings()[HE]}enablePlugin(){if(this.enabled)return;let t=this.hot.getSettings()[HE];"string"!==typeof t&&(t=kE);const e=IE.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new e),this.addHook("modifyRowHeader",(t=>ME(this,AE,PE).call(this,t))),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function PE(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function NE(t,e){LE(t,e),e.add(t)}function _E(t,e,o){LE(t,e),e.set(t,o)}function LE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DE(t,e,o){return e=WE(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function WE(t){var e=VE(t,"string");return"symbol"==typeof e?e:String(e)}function VE(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function FE(t,e){var o=UE(t,e,"get");return jE(t,o)}function jE(t,e){return e.get?e.get.call(t):e.value}function BE(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function zE(t,e,o){var n=UE(t,e,"set");return $E(t,n,o),o}function UE(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function $E(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const GE="collapsibleColumns",YE=290,KE=["nestedHeaders"],XE="collapsibleIndicator",qE=GE,QE=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var JE=new WeakMap,ZE=new WeakSet,tT=new WeakSet,eT=new WeakSet,oT=new WeakSet;class nT extends _S{constructor(){super(...arguments),NE(this,oT),NE(this,eT),NE(this,tT),NE(this,ZE),DE(this,"nestedHeadersPlugin",null),DE(this,"headerStateManager",null),_E(this,JE,{writable:!0,value:null})}static get PLUGIN_KEY(){return GE}static get PLUGIN_PRIORITY(){return YE}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[GE,...KE]}isEnabled(){return!!this.hot.getSettings()[GE]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();e||fn("You need to configure the Nested Headers plugin in order to use collapsible headers."),zE(this,JE,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(()=>BE(this,eT,sT).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return BE(t,oT,lT).call(t,...o)})),this.addHook("afterGetColHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return BE(t,ZE,iT).call(t,...o)})),this.addHook("beforeOnCellMouseDown",((t,e,o)=>BE(this,tT,rT).call(this,t,e,o))),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:t}=this.hot.getSettings();"boolean"===typeof t?this.headerStateManager.mapState((t=>({collapsible:t.origColspan>1}))):Array.isArray(t)&&(this.headerStateManager.mapState((()=>({collapsible:!1}))),this.headerStateManager.mergeStateWith(t))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),zE(this,JE,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var t;const{row:e,col:o}=this.hot.getSelectedRangeLast().highlight,{collapsible:n,isCollapsed:i,columnIndex:r}=null!==(t=this.headerStateManager.getHeaderTreeNodeData(e,o))&&void 0!==t?t:{};n&&(i?this.expandSection({row:e,col:r}):this.collapseSection({row:e,col:r}))},runOnlyIf:()=>{var t;return null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},group:qE})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(qE)}clearButtons(){if(!this.hot.view)return;const t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(t){t&&t.parentNode.removeChild(t)};Vi(0,t-1,(t=>{const r=e.childNodes[t],s=o.childNodes[t],l=n?n.childNodes[t]:null;Vi(0,r.childNodes.length-1,(t=>{let e=r.childNodes[t].querySelector(`.${XE}`);i(e),s&&s.childNodes[t]&&(e=s.childNodes[t].querySelector(`.${XE}`),i(e)),n&&l&&l.childNodes[t]&&(e=l.childNodes[t].querySelector(`.${XE}`),i(e))}))}),!0)}expandSection(t){this.toggleCollapsibleSection([t],"expand")}collapseSection(t){this.toggleCollapsibleSection([t],"collapse")}toggleAllCollapsibleSections(t){const e=this.headerStateManager.mapNodes((e=>{const{collapsible:o,origColspan:n,headerLevel:i,columnIndex:r,isCollapsed:s}=e;if(!0===o&&n>1&&(s&&"expand"===t||!s&&"collapse"===t))return{row:this.headerStateManager.levelToRowCoords(i),col:r}}));this.toggleCollapsibleSection(e,t)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(t,e){if(!QE.has(e))throw new Error(`Unsupported action is passed (${e}).`);if(!Array.isArray(t))return;const o=k(t,(t=>{let{row:e}=t;return e<0}));let n=o.length>0;A(o,(t=>{var o;let{row:i,col:r}=t;const{collapsible:s,isCollapsed:l}=null!==(o=this.headerStateManager.getHeaderSettings(i,r))&&void 0!==o?o:{};if(!s||l&&"collapse"===e||!l&&"expand"===e)return n=!1,!1}));const i=[],r=[];n&&A(o,(t=>{let{row:o,col:n}=t;const{colspanCompensation:s,affectedColumns:l,rollbackModification:a}=this.headerStateManager.triggerNodeModification(e,o,n);s>0&&(r.push(...l),i.push(a))}));const s=this.getCollapsedColumns();let l=[];"collapse"===e?l=D([...s,...r]):"expand"===e&&(l=k(s,(t=>!r.includes(t))));const a=QE.get(e),h=this.hot.runHooks(a.beforeHook,s,l,n);if(!1===h)return void A(i,(t=>{t()}));this.hot.batchExecution((()=>{A(r,(t=>{FE(this,JE).setValueAtIndex(this.hot.toPhysicalColumn(t),a.hideColumn)}))}),!0);const c=this.getCollapsedColumns().length!==s.length;this.hot.runHooks(a.afterHook,s,l,n,c),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return FE(this,JE).getHiddenIndexes()}destroy(){zE(this,JE,null),super.destroy()}}function iT(t,e,o){var n;const{collapsible:i,origColspan:r,isCollapsed:s}=null!==(n=this.headerStateManager.getHeaderSettings(o,t))&&void 0!==n?n:{},l=i&&r>1&&t>=this.hot.getSettings().fixedColumnsStart,a=this.hot.getSettings().ariaTags;let h=e.querySelector(`.${XE}`);var c;(me(e,[Ft("")[0]]),l)?(h||(h=this.hot.rootDocument.createElement("div"),de(h,XE),e.querySelector("div:first-child").appendChild(h)),ge(h,["collapsed","expanded"]),s?(de(h,"collapsed"),ye(h,"+"),a&&fe(e,...Ft(!1))):(de(h,"expanded"),ye(h,"-"),a&&fe(e,...Ft(!0))),a&&fe(h,...Ot())):null===(c=h)||void 0===c||c.remove()}function rT(t,e){ue(t.target,XE)&&(ue(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ue(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),hn(t))}function sT(){this.updatePlugin()}function lT(t,e){e||this.updatePlugin()}function aT(t,e,o){return e=hT(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function hT(t){var e=cT(t,"string");return"symbol"==typeof e?e:String(e)}function cT(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const uT=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],dT=!1,gT=!0,fT=!0;class mT{constructor(t,e){aT(this,"hot",void 0),aT(this,"sortingStates",new Gu),aT(this,"sortEmptyCells",dT),aT(this,"indicator",gT),aT(this,"headerAction",fT),aT(this,"compareFunctionFactory",void 0),aT(this,"mapName",void 0),this.hot=t,this.mapName=e,this.hot.columnIndexMapper.registerMap(e,this.sortingStates)}updateAllColumnsProperties(t){Ro(t)&&To(t,((t,e)=>{uT.includes(e)&&(this[e]=t)}))}getAllColumnsProperties(){const t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"===typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}getSortOrderOfColumn(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}getIndexOfColumnInSortQueue(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex((e=>{let[o]=e;return o===t}))}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(t){return Ro(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}getSortStates(){if(null===this.sortingStates)return[];const t=this.sortingStates.getEntries();return t.map((t=>{let[e,o]=t;return{column:this.hot.toVisualColumn(e),...o}}))}getColumnSortState(t){const e=this.getSortOrderOfColumn(t);if(U(e))return{column:t,sortOrder:e}}setSortStates(t){this.sortingStates.clear();for(let e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const pT="asc",wT="desc",vT="colHeader";function CT(t){if(!1===Ro(t))return!1;const{column:e,sortOrder:o}=t;return Number.isInteger(e)&&[pT,wT].includes(o)}function yT(t){if(t.some((t=>!1===CT(t))))return!1;const e=t.map((t=>{let{column:e}=t;return e}));return new Set(e).size===e.length}function bT(t){if(t!==wT)return t===pT?wT:pT}function ST(t){const e=t.querySelector(`.${vT}`);return e}function RT(t,e){if(t<0||!e.parentNode)return!1;const o=e.parentNode.parentNode.childNodes,n=Array.from(o).indexOf(e.parentNode)-o.length;return-1===n}function ET(t,e,o){return-1===t&&e>=0&&!1===un(o)}const TT="ascending",MT="descending",HT="indicatorDisabled",xT="columnSorting",kT="sortAction",IT=new Map([[pT,TT],[wT,MT]]);function AT(t,e,o,n){const i=[xT];if(n&&i.push(kT),!1===o)return i.push(HT),i;const r=t.getSortOrderOfColumn(e);return U(r)&&i.push(IT.get(r)),i}function OT(){return Array.from(IT.values()).concat(kT,HT,xT)}const PT=0,NT=-1,_T=1;function LT(t,e){const o=XT(e);for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];t.sort(o(...i))}function DT(t,e,o){const n=e.locale;return function(e,i){const{sortEmptyCells:r}=o;return"string"===typeof e&&(e=e.toLocaleLowerCase(n)),"string"===typeof i&&(i=i.toLocaleLowerCase(n)),e===i?PT:G(e)?G(i)?PT:r&&"asc"===t?NT:_T:G(i)?r&&"asc"===t?_T:NT:isNaN(e)&&!isNaN(i)?"asc"===t?_T:NT:!isNaN(e)&&isNaN(i)?"asc"===t?NT:_T:(isNaN(e)||isNaN(i)||(e=parseFloat(e),i=parseFloat(i)),e<i?"asc"===t?NT:_T:e>i?"asc"===t?_T:NT:PT)}}const WT="default";function VT(t,e,o){return function(e,n){const i=parseFloat(e),r=parseFloat(n),{sortEmptyCells:s}=o;if(i===r||isNaN(i)&&isNaN(r))return PT;if(s){if(G(e))return"asc"===t?NT:_T;if(G(n))return"asc"===t?_T:NT}return isNaN(i)?_T:isNaN(r)?NT:i<r?"asc"===t?NT:_T:i>r?"asc"===t?_T:NT:PT}}const FT="numeric";function jT(t,e,o){const n=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:r}=o;return function(s,l){const a=G(s),h=G(l),c=a?i:s,u=h?i:l,d=c===i||c===n,g=u===i||u===n;if(!1===r){if(a&&!1===h)return _T;if(!1===a&&h)return NT}return!1===d&&g?"asc"===t?NT:_T:d&&!1===g?"asc"===t?_T:NT:!1===d&&!1===g?DT(t,e,o)(s,l):c===i&&u===n?"asc"===t?NT:_T:c===n&&u===i?"asc"===t?_T:NT:PT}}const BT="checkbox";function zT(t,e,o){return function(n,i){const{sortEmptyCells:r}=o;if(n===i)return PT;if(G(n))return G(i)?PT:r&&"asc"===t?NT:_T;if(G(i))return r&&"asc"===t?_T:NT;const s=e.dateFormat,l=E(n,s),a=E(i,s);return l.isValid()?a.isValid()?a.isAfter(l)?"asc"===t?NT:_T:a.isBefore(l)?"asc"===t?_T:NT:PT:NT:_T}}const UT="date",{register:$T,getItem:GT,hasItem:YT}=xn("sorting.compareFunctionFactory"),{register:KT,getItem:XT}=xn("sorting.mainSortComparator");function qT(t){return YT(t)?GT(t):GT(WT)}function QT(t,e){return function(o,n){const[,...i]=o,[,...r]=n;return function(o){const n=t[o],s=e[o],l=i[o],a=r[o],h=s.columnSorting,c=h.compareFunctionFactory?h.compareFunctionFactory:qT(s.type),u=c(n,s,h)(l,a);return u}(0)}}function JT(t,e){ZT(t,e),e.add(t)}function ZT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tM(t,e,o){return e=eM(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function eM(t){var e=oM(t,"string");return"symbol"==typeof e?e:String(e)}function oM(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function nM(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}$T(FT,VT),$T(BT,jT),$T(UT,zT),$T(WT,DT);const iM="columnSorting",rM=50,sM="append",lM="replace",aM=iM;KT(iM,QT),Mn.getSingleton().register("beforeColumnSort"),Mn.getSingleton().register("afterColumnSort");var hM=new WeakSet,cM=new WeakSet,uM=new WeakSet,dM=new WeakSet;class gM extends _S{constructor(){super(...arguments),JT(this,dM),JT(this,uM),JT(this,cM),JT(this,hM),tM(this,"columnStatesManager",null),tM(this,"columnMetaCache",null),tM(this,"pluginKey",iM),tM(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return iM}static get PLUGIN_PRIORITY(){return rM}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var t=this;this.enabled||(this.columnStatesManager=new mT(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new ju((t=>{let e=this.hot.toVisualColumn(t);return null===e&&(e=t),this.getMergedPluginSettings(e)})),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",((t,e)=>nM(this,cM,mM).call(this,t,e))),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return nM(t,dM,wM).call(t,...o)})),this.addHook("afterOnCellMouseDown",((t,e)=>this.onAfterOnCellMouseDown(t,e))),this.addHook("afterInit",(()=>nM(this,hM,fM).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return nM(t,uM,pM).call(t,...o)})),this.hot.view&&nM(this,hM,fM).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const t=(t,e)=>{const o=ST(e);!1!==RT(t,e)&&null!==o&&this.updateHeaderClasses(o)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetColHeader",t)})),this.hot.batchExecution((()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();-1===t.row&&t.col>=0&&this.sort(this.getColumnNextConfig(t.col))},runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()},group:aM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(aM)}sort(t){const e=this.getSortConfig(),o=this.getNormalizedSortConfigs(t),n=this.areValidSortConfigs(o),i=this.hot.runHooks("beforeColumnSort",e,o,n);!1!==i&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Wu),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),n&&(this.columnStatesManager.setSortStates(o),this.sortByPresetSortStates(o),this.saveAllSortSettings(o)),this.hot.runHooks("afterColumnSort",e,n?o:e,n),n&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(t){return U(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}setSortConfig(t){const e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}areValidSortConfigs(t){const e=this.hot.countCols();return yT(t)&&t.every((t=>{let{column:o}=t;return o<=e&&o>=0}))}saveAllSortSettings(t){const e=this.columnStatesManager.getAllColumnsProperties(),o=t=>{let{column:e,...o}=t;return{column:this.hot.toPhysicalColumn(e),...o}};e.initialConfig=I(t,o),this.hot.runHooks("persistentStateSave","columnSorting",e)}getAllSavedSortSettings(){const t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);const e=t.value,o=t=>{let{column:e,...o}=t;return{column:this.hot.toVisualColumn(e),...o}};return U(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=I(e.initialConfig,o)),e}getColumnNextConfig(t){const e=this.columnStatesManager.getSortOrderOfColumn(t);if(U(e)){const o=bT(e);return U(o)?{column:t,sortOrder:o}:void 0}const o=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<o)return{column:t,sortOrder:bT()}}getNextSortConfig(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sM;const o=this.columnStatesManager.getIndexOfColumnInSortQueue(t),n=-1!==o,i=this.getSortConfig(),r=this.getColumnNextConfig(t);if(n){if($(r))return[...i.slice(0,o),...i.slice(o+1)];if(e===sM)return[...i.slice(0,o),...i.slice(o+1),r];if(e===lM)return[...i.slice(0,o),r,...i.slice(o+1)]}return U(r)?i.concat(r):i}getPluginColumnConfig(t){if(Ro(t)){const e=t[this.pluginKey];if(Ro(e))return e}return{}}getMergedPluginSettings(t){const e=this.hot.getSettings()[this.pluginKey],o=this.columnStatesManager.getAllColumnsProperties(),n=this.hot.getCellMeta(0,t),i=Object.getPrototypeOf(n);return Array.isArray(i.columns)?Object.assign(o,e,this.getPluginColumnConfig(i.columns[t])):ro(i.columns)?Object.assign(o,e,this.getPluginColumnConfig(i.columns(t))):Object.assign(o,e)}getFirstCellSettings(t){const e=this.hot.getCellMeta(0,t),o=Object.create(e);return o[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),o}getNumberOfRowsToSort(t){const e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}sortByPresetSortStates(t){if(0===t.length)return void this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());const e=[],o=this.hot.countRows(),n=e=>I(t,(t=>this.hot.getDataAtCell(e,t.column)));for(let a=0;a<this.getNumberOfRowsToSort(o);a+=1)e.push([this.hot.toPhysicalRow(a)].concat(n(a)));const i=I(e,(t=>t[0]));LT(e,this.pluginKey,I(t,(t=>t.sortOrder)),I(t,(t=>this.getFirstCellSettings(t.column))));for(let a=e.length;a<o;a+=1)e.push([a].concat(n(a)));const r=I(e,(t=>t[0])),s=new Map(I(i,((t,e)=>[t,r[e]]))),l=I(this.hot.rowIndexMapper.getIndexesSequence(),(t=>s.has(t)?s.get(t):t));this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(t){if(Ro(t)){this.columnStatesManager.updateAllColumnsProperties(t);const e=t.initialConfig;(Array.isArray(e)||Ro(e))&&this.sort(e)}else this.hot.render()}updateHeaderClasses(t){if(ge(t,OT(t)),!1!==this.enabled){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];de(t,AT(...o))}}onUpdateSettings(t){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),U(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}wasClickableHeaderClicked(t,e){const o=this.getFirstCellSettings(e)[this.pluginKey],n=o.headerAction;return n&&ue(t.target,vT)}onAfterOnCellMouseDown(t,e){!1!==ET(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}destroy(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),super.destroy()}}function fM(){const t=this.getAllSavedSortSettings();if(Ro(t))this.sortBySettings(t);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}function mM(t,e){const o=ST(e);if(!1===RT(t,e)||null===o)return;const n=this.getFirstCellSettings(t)[this.pluginKey],i=n.indicator,r=n.headerAction;if(this.updateHeaderClasses(o,this.columnStatesManager,t,i,r),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);fe(e,...jt(o?`${o}ending`:"none"))}}function pM(t){!0===t&&this.hot.view&&nM(this,hM,fM).call(this)}function wM(t,e,o,n){!1!==ET(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}function vM(t,e,o){return e=CM(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function CM(t){var e=yM(t,"string");return"symbol"==typeof e?e:String(e)}function yM(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class bM{constructor(t,e){vM(this,"plugin",void 0),vM(this,"hot",void 0),vM(this,"endpoints",[]),vM(this,"settings",void 0),vM(this,"settingsType","array"),vM(this,"currentEndpoint",null),vM(this,"cellsToSetCache",[]),this.plugin=t,this.hot=this.plugin.hot,this.settings=e}getEndpoint(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(t){return this.parseSettings(t.call(this))}parseSettings(t){const e=[];let o=t;if(o||"function"!==typeof this.settings)return o||(o=this.settings),A(o,(t=>{const o={};this.assignSetting(t,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(t,o,"reversedRowCoords",!1),this.assignSetting(t,o,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,o,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,o,"sourceColumn",t.destinationColumn),this.assignSetting(t,o,"type","sum"),this.assignSetting(t,o,"forceNumeric",!1),this.assignSetting(t,o,"suppressDataTypeErrors",!0),this.assignSetting(t,o,"customFunction",null),this.assignSetting(t,o,"readOnly",!0),this.assignSetting(t,o,"roundFloat",!1),e.push(o)})),e;this.settingsType="function"}assignSetting(t,e,o,n){if("ranges"!==o||void 0!==t[o]){if("ranges"!==o||0!==t[o].length)if(void 0===t[o]){if(n instanceof Error)throw n;e[o]=n}else"destinationRow"===o&&e.reversedRowCoords?e[o]=this.hot.countRows()-t[o]-1:e[o]=t[o]}else e[o]=n}resetSetupBeforeStructureAlteration(t,e,o){if("function"!==this.settingsType)return;const n=t.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();A(i,(i=>{"row"===n&&i.destinationRow>=e&&("insert_row"===t?i.alterRowOffset=o:"remove_row"===t&&(i.alterRowOffset=-1*o)),"col"===n&&i.destinationColumn>=e&&("insert_col"===t?i.alterColumnOffset=o:"remove_col"===t&&(i.alterColumnOffset=-1*o))})),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(t,e,o,n,i){let r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const t=()=>(this.hot.removeHook("beforeViewRender",t),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",t)}const s=t.indexOf("row")>-1?"row":"col",l=t.indexOf("remove")>-1?-1:1,a=this.getAllEndpoints(),h=0===t.indexOf("move_row"),c=e;A(a,(t=>{"row"===s&&t.destinationRow>=c&&(t.alterRowOffset=l*o),"col"===s&&t.destinationColumn>=c&&(t.alterColumnOffset=l*o)})),this.resetAllEndpoints(a,!h),A(a,h?t=>{this.extendEndpointRanges(t,c,n[0],n.length),this.recreatePhysicalRanges(t),this.clearOffsetInformation(t)}:t=>{this.shiftEndpointCoordinates(t,c)}),r&&this.refreshAllEndpoints()}clearOffsetInformation(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}extendEndpointRanges(t,e,o,n){A(t.ranges,(t=>{t[1]&&(e>=t[0]&&e<=t[1]?o>t[1]?t[1]+=n:o<t[0]&&(t[0]-=n):o>=t[0]&&o<=t[1]&&(t[1]-=n,e<=t[0]&&(t[0]+=1,t[1]+=1)))}))}recreatePhysicalRanges(t){const e=t.ranges,o=[],n=[];A(e,(t=>{const e=[];if(t[1])for(let o=t[0];o<=t[1];o++)e.push(this.hot.toPhysicalRow(o));else e.push(this.hot.toPhysicalRow(t[0]));n.push(e)})),A(n,(t=>{let e=[];A(t,((n,i)=>{0===i?e.push(n):t[i]!==t[i-1]+1&&(e.push(t[i-1]),o.push(e),e=[],e.push(n)),i===t.length-1&&(e.push(n),o.push(e))}))})),t.ranges=o}shiftEndpointCoordinates(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,A(t.ranges,(o=>{A(o,((n,i)=>{n>=e&&(o[i]+=t.alterRowOffset||0)}))}))):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}resetAllEndpoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=t.some((t=>{const e=t.alterRowOffset||0,o=t.alterColumnOffset||0;return t.destinationRow+e>=this.hot.countRows()||t.destinationColumn+o>=this.hot.countCols()}));o||(this.cellsToSetCache=[],A(t,(t=>{this.resetEndpointValue(t,e)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],A(this.getAllEndpoints(),(t=>{this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(t){const e=[];this.cellsToSetCache=[],A(t,((t,o,n)=>{`${t[2]||""}`!==`${t[3]}`&&A(this.getAllEndpoints(),((t,i)=>{this.hot.propToCol(n[o][1])===t.sourceColumn&&-1===e.indexOf(i)&&e.push(i)}))})),A(e,(t=>{this.refreshEndpoint(this.getEndpoint(t))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}resetEndpointValue(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=t.alterRowOffset||0,n=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?o:0)),this.hot.toVisualColumn(t.destinationColumn+(e?n:0)),""])}setEndpointValue(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const i=this.hot.toVisualRow(t.destinationRow);if(null!==i){const o=this.hot.getCellMeta(i,t.destinationColumn);"init"!==e&&o.readOnly===t.readOnly||(o.readOnly=t.readOnly,o.className="columnSummaryResult")}t.roundFloat&&!isNaN(t.result)&&(t.result=t.result.toFixed(t.roundFloat)),o?this.hot.setDataAtCell(n,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([n,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}throwOutOfBoundsWarning(){fn("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}var SM=bM;function RM(t){return null===t||void 0===t||isNaN(t)}function EM(t,e){TM(t,e),e.add(t)}function TM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MM(t,e,o){return e=HM(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function HM(t){var e=xM(t,"string");return"symbol"==typeof e?e:String(e)}function xM(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function kM(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const IM="columnSummary",AM=220;var OM=new WeakSet,PM=new WeakSet,NM=new WeakSet;class _M extends _S{constructor(){super(...arguments),EM(this,NM),EM(this,PM),EM(this,OM),MM(this,"endpoints",null)}static get PLUGIN_KEY(){return IM}static get PLUGIN_PRIORITY(){return AM}isEnabled(){return!!this.hot.getSettings()[IM]}enablePlugin(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[IM],this.endpoints=new SM(this,this.settings),this.addHook("afterInit",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return kM(t,OM,LM).call(t,...o)})),this.addHook("afterChange",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return kM(t,PM,DM).call(t,...o)})),this.addHook("beforeCreateRow",((t,e,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,e,null,o))),this.addHook("beforeCreateCol",((t,e,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,e,null,o))),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupBeforeStructureAlteration("remove_row",...o)})),this.addHook("beforeRemoveCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupBeforeStructureAlteration("remove_col",...o)})),this.addHook("afterCreateRow",((t,e,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,e,null,o))),this.addHook("afterCreateCol",((t,e,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,e,null,o))),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupAfterStructureAlteration("remove_row",...o)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupAfterStructureAlteration("remove_col",...o)})),this.addHook("afterRowMove",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return kM(t,NM,WM).call(t,...o)})),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":t.result=this.calculateMinMax(t,t.type);break;case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t);break;default:break}}calculateSum(t){let e=0;return To(t.ranges,(o=>{e+=this.getPartialSum(o,t.sourceColumn)})),e}getPartialSum(t,e){let o=0,n=t[1]||t[0],i=null,r=0;do{if(i=this.getCellValue(n,e),i=RM(i)?null:i,null!==i){const t=(`${i}`.split(".")[1]||[]).length||1;t>r&&(r=t)}o+=i||0,n-=1}while(n>=t[0]);return Math.round(o*10**r)/10**r}calculateMinMax(t,e){let o=null;return To(t.ranges,(n=>{const i=this.getPartialMinMax(n,t.sourceColumn,e);if(null===o&&null!==i&&(o=i),null!==i)switch(e){case"min":o=Math.min(o,i);break;case"max":o=Math.max(o,i);break;default:break}})),null===o?"Not enough data":o}getPartialMinMax(t,e,o){let n,i=null,r=t[1]||t[0];do{if(n=this.getCellValue(r,e),n=RM(n)?null:n,null===i)i=n;else if(null!==n)switch(o){case"min":i=Math.min(i,n);break;case"max":i=Math.max(i,n);break;default:break}r-=1}while(r>=t[0]);return i}countEmpty(t,e){let o,n=0,i=t[1]||t[0];do{o=this.getCellValue(i,e),o=RM(o)?null:o,null===o&&(n+=1),i-=1}while(i>=t[0]);return n}countEntries(t){let e=0;const o=t.ranges;return To(o,(o=>{const n=void 0===o[1]?1:o[1]-o[0]+1,i=this.countEmpty(o,t.sourceColumn);e+=n,e-=i})),e}calculateAverage(t){const e=this.calculateSum(t),o=this.countEntries(t);return e/o}getCellValue(t,e){const o=this.hot.toVisualRow(t),n=this.hot.toVisualColumn(e);let i=this.hot.getSourceDataAtCell(t,e),r="";if(null!==o&&null!==n&&(r=this.hot.getCellMeta(o,n).className||""),r.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"===typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(B`ColumnSummary plugin: cell at (${t}, ${e}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}}function LM(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}function DM(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}function WM(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function VM(t,e,o){return e=FM(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function FM(t){var e=jM(t,"string");return"symbol"==typeof e?e:String(e)}function jM(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class BM{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(t,e){VM(this,"rootDocument",void 0),VM(this,"isRtl",!1),VM(this,"container",null),VM(this,"editor",void 0),VM(this,"editorStyle",void 0),VM(this,"hidden",!0),this.rootDocument=t,this.isRtl=e,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(t,e){this.editorStyle.left=`${t}px`,this.editorStyle.top=`${e}px`}setSize(t,e){if(t&&e){const o=this.getInputElement();o.style.width=`${t}px`,o.style.height=`${e}px`}}getSize(){return{width:Oe(this.getInputElement()),height:Pe(this.getInputElement())}}resetSize(){const t=this.getInputElement();t.style.width="",t.style.height=""}setReadOnlyState(t){const e=this.getInputElement();e.readOnly=t}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return"block"===this.editorStyle.display}setValue(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const e=t||"";this.getInputElement().value=e}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const t=this.rootDocument.createElement("div"),e=this.rootDocument.createElement("textarea");return t.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),de(this.container,BM.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),de(t,BM.CLASS_EDITOR),de(e,BM.CLASS_INPUT),e.setAttribute("data-hot-input",!0),t.appendChild(e),this.container.appendChild(t),t}getInputElement(){return this.editor.querySelector(`.${BM.CLASS_INPUT}`)}destroy(){const t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,t&&t.removeChild(this.container)}}var zM=BM;function UM(t,e,o){return e=$M(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function $M(t){var e=GM(t,"string");return"symbol"==typeof e?e:String(e)}function GM(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const YM=250,KM=250;class XM{constructor(t){UM(this,"wasLastActionShow",!0),UM(this,"showDebounced",null),UM(this,"hidingTimer",null),this.updateDelay(t)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout((()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")}),KM)}show(t){this.wasLastActionShow=!0,this.showDebounced(t)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:YM;this.showDebounced=ao((t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)}),t)}destroy(){this.clearLocalHooks()}}bo(XM,ku);var qM=XM;const QM="---------";function JM(){return{name:QM}}function ZM(t){return{key:"commentsAddEdit",name(){var e;const o=null===(e=this.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return null!==o&&void 0!==o&&o.isCell()&&t.getCommentAtCell(o.row,o.col)?this.getTranslatedPhrase(cg):this.getTranslatedPhrase(hg)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}function tH(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(ug)},callback(){const e=this.getSelectedRangeLast();e.forAll(((e,o)=>{e>=0&&o>=0&&t.removeCommentAtCell(e,o,!1)})),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}function eH(t,e){if(-1!==t.indexOf(e))return t;const o=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return`${o} ${e}`}function oH(t,e){if(-1!==t.indexOf(e))return t;const o=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return`${o} ${e}`}function nH(t,e){const o={};return A(t,(t=>{t.forAll(((t,n)=>{t>=0&&n>=0&&(o[t]||(o[t]=[]),o[t][n]=e(t,n))}))})),o}function iH(t,e,o,n,i){A(t,(t=>{t.forAll(((t,r)=>{t>=0&&r>=0&&rH(t,r,e,o,n,i)}))}))}function rH(t,e,o,n,i,r){const s=i(t,e);let l=n;s.className&&(l="vertical"===o?eH(s.className,n):oH(s.className,n)),r(t,e,"className",l)}function sH(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function lH(t,e){let o=!1;return Array.isArray(t)&&A(t,(t=>(t.forAll(((t,n)=>{if(t>=0&&n>=0&&e(t,n))return o=!0,!1})),o))),o}function aH(t,e){const o={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:t}=e.defaultView,{top:n,left:i}=t.getBoundingClientRect();o.top=n,o.left=i}return o}function hH(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(dg),o=lH(this.getSelectedRange(),((e,o)=>t.getCommentMeta(e,o,HH)));return o?sH(e):e},callback(){const e=this.getSelectedRangeLast();e.forAll(((e,o)=>{if(e>=0&&o>=0){const n=!!t.getCommentMeta(e,o,HH);t.updateCommentMeta(e,o,{[HH]:!n})}}))},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}function cH(t,e){dH(t,e),e.add(t)}function uH(t,e,o){dH(t,e),e.set(t,o)}function dH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gH(t,e,o){return e=fH(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function fH(t){var e=mH(t,"string");return"symbol"==typeof e?e:String(e)}function mH(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function pH(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function wH(t,e,o){var n=yH(t,e,"set");return vH(t,n,o),o}function vH(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function CH(t,e){var o=yH(t,e,"get");return bH(t,o)}function yH(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function bH(t,e){return e.get?e.get.call(t):e.value}const SH="comments",RH=60,EH="comment",TH="value",MH="style",HH="readOnly",xH=SH,kH=`plugin:${SH}`;var IH=new WeakMap,AH=new WeakMap,OH=new WeakMap,PH=new WeakMap,NH=new WeakMap,_H=new WeakMap,LH=new WeakMap,DH=new WeakSet,WH=new WeakSet,VH=new WeakSet,FH=new WeakSet,jH=new WeakSet,BH=new WeakSet,zH=new WeakSet,UH=new WeakSet,$H=new WeakSet,GH=new WeakSet;class YH extends _S{constructor(){super(...arguments),cH(this,GH),cH(this,$H),cH(this,UH),cH(this,zH),cH(this,BH),cH(this,jH),cH(this,FH),cH(this,VH),cH(this,WH),cH(this,DH),gH(this,"range",{}),uH(this,IH,{writable:!0,value:null}),uH(this,AH,{writable:!0,value:null}),uH(this,OH,{writable:!0,value:!1}),uH(this,PH,{writable:!0,value:!1}),uH(this,NH,{writable:!0,value:{}}),uH(this,_H,{writable:!0,value:null}),uH(this,LH,{writable:!0,value:""})}static get PLUGIN_KEY(){return SH}static get PLUGIN_PRIORITY(){return RH}isEnabled(){return!!this.hot.getSettings()[SH]}enablePlugin(){this.enabled||(CH(this,IH)||wH(this,IH,new zM(this.hot.rootDocument,this.hot.isRtl())),CH(this,AH)||wH(this,AH,new qM(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(t=>this.addToContextMenu(t))),this.addHook("afterRenderer",((t,e,o,n,i,r)=>pH(this,FH,QH).call(this,t,r))),this.addHook("afterScroll",(()=>pH(this,GH,nx).call(this))),this.addHook("afterBeginEditing",(()=>this.hide())),this.addHook("afterDocumentKeyDown",(t=>pH(this,$H,ox).call(this,t))),CH(this,AH).addLocalHook("hide",(()=>this.hide())),CH(this,AH).addLocalHook("show",((t,e)=>this.showAtCell(t,e))),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){CH(this,AH).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid"),o=t.addContext(kH);e.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const e=this.hot.getSelectedRangeLast();wH(this,PH,!0),this.hot.scrollToFocusedCell((()=>{this.setRange(e),this.show(),this.focusEditor(),t.setActiveContextName(kH),this.hot._registerTimeout((()=>{wH(this,PH,!1)}))}))},stopPropagation:!0,runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&!CH(this,IH).isVisible()},group:xH}),o.addShortcut({keys:[["Escape"]],callback:()=>{CH(this,IH).setValue(CH(this,LH)),this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&CH(this,IH).isVisible()},group:xH}),o.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&CH(this,IH).isVisible()},group:xH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xH)}registerListeners(){const{rootDocument:t}=this.hot,e=this.getEditorInputElement();this.eventManager.addEventListener(t,"mouseover",(t=>pH(this,WH,XH).call(this,t))),this.eventManager.addEventListener(t,"mousedown",(t=>pH(this,DH,KH).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>pH(this,VH,qH).call(this))),this.eventManager.addEventListener(e,"focus",(()=>pH(this,BH,ZH).call(this))),this.eventManager.addEventListener(e,"blur",(()=>pH(this,jH,JH).call(this))),this.eventManager.addEventListener(e,"mousedown",(t=>pH(this,zH,tx).call(this,t))),this.eventManager.addEventListener(e,"mouseup",(t=>pH(this,UH,ex).call(this,t)))}setRange(t){this.range=t}clearRange(){this.range={}}targetIsCellWithComment(t){const e=ie(t.target,"TD","TBODY");return!!(e&&ue(e,"htCommentCell")&&ie(e,[this.hot.rootElement]))}targetIsCommentTextArea(t){return this.getEditorInputElement()===t.target}setComment(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const e=CH(this,IH).getValue();let o="";null!==t&&void 0!==t?o=t:null!==e&&void 0!==e&&(o=e);const n=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(n,i,{[TH]:o}),this.hot.render()}setCommentAtCell(t,e,o){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(o)}removeComment(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,EH),t&&this.hot.render(),this.hide()}removeCommentAtCell(t,e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(o)}getComment(){const t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,TH)}getCommentAtCell(t,e){return this.getCommentMeta(t,e,TH)}show(){var t;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:e,col:o}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||o<0||o>this.hot.countSourceCols()-1)return!1;const n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return CH(this,AH).cancelHiding(),CH(this,IH).setValue(null!==(t=n[EH]?n[EH][TH]:null)&&void 0!==t?t:""),CH(this,IH).show(),this.refreshEditor(!0),!0}showAtCell(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}hide(){CH(this,IH).hide()}refreshEditor(){var t,e;let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!o&&(!this.range.from||!CH(this,IH).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{row:r,col:s}=this.range.from;let l=n.getRenderableFromVisualIndex(r),a=i.getRenderableFromVisualIndex(s);const h=null===l;CH(this,IH).setPosition(0,0),null===l&&(l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1))),null===a&&(a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1)));const c=null===l,u=null===a;l=null!==(t=l)&&void 0!==t?t:0,a=null!==(e=a)&&void 0!==e?e:0;const{rootWindow:d,view:{_wt:g}}=this.hot,{wtTable:f}=g,m=g.getCell({row:l,col:a},!0),p=this.getCommentMeta(r,s,MH);p?CH(this,IH).setSize(p.width,p.height):CH(this,IH).resetSize();const w=u?0:f.getStretchedColumnWidth(a),v=h&&!c?Pe(m):0,{left:C,top:y,width:b,height:S}=m.getBoundingClientRect(),{width:R,height:E}=CH(this,IH).getSize(),{innerWidth:T,innerHeight:M}=this.hot.rootWindow,H=this.hot.rootDocument.documentElement;let x=C+d.scrollX+w,k=y+d.scrollY+v;this.hot.isRtl()&&(x-=R+w),this.hot.isLtr()&&C+b+R>T?x=C+d.scrollX-R-1:this.hot.isRtl()&&x<-(H.scrollWidth-H.clientWidth)&&(x=C+d.scrollX+w+1),y+E>M&&(k-=E-S+1),CH(this,IH).setPosition(x,k),CH(this,IH).setReadOnlyState(this.getCommentMeta(r,s,HH))}focusEditor(){CH(this,IH).focus()}updateCommentMeta(t,e,o){const n=this.hot.getCellMeta(t,e)[EH];let i;n?(i=Co(n),vo(i,o)):i=o,this.hot.setCellMeta(t,e,EH,i)}getCommentMeta(t,e,o){const n=this.hot.getCellMeta(t,e);if(n[EH])return n[EH][o]}addToContextMenu(t){t.items.push({name:QM},ZM(this),tH(this),hH(this))}getDisplayDelaySetting(){const t=this.hot.getSettings()[SH];if(Ro(t))return t.displayDelay}getEditorInputElement(){return CH(this,IH).getInputElement()}destroy(){CH(this,IH)&&CH(this,IH).destroy(),CH(this,AH)&&CH(this,AH).destroy(),super.destroy()}}function KH(t){if(this.hot.view&&this.hot.view._wt&&!CH(this,OH)&&!this.targetIsCommentTextArea(t)){const e=ie(t.target,"TD","TBODY");let o=null;e&&(o=this.hot.getCoords(e)),(!e||this.range.from&&o&&(this.range.from.row!==o.row||this.range.from.col!==o.col))&&this.hide()}}function XH(t){const{rootDocument:e}=this.hot;if(!(CH(this,OH)||CH(this,IH).isFocused()||ue(t.target,"wtBorder")||CH(this,_H)===t.target)&&CH(this,IH))if(wH(this,_H,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const e=this.hot._createCellRange(this.hot.getCoords(t.target));CH(this,AH).show(e)}else se(t.target,e)&&!this.targetIsCommentTextArea(t)&&CH(this,AH).hide()}function qH(){wH(this,OH,!1)}function QH(t,e){e[EH]&&e[EH][TH]&&de(t,e.commentedCellClassName)}function JH(){wH(this,LH,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function ZH(){wH(this,LH,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(kH)}function tx(t){wH(this,NH,{width:Oe(t.target),height:Pe(t.target)})}function ex(t){const e=Oe(t.target),o=Pe(t.target);e===CH(this,NH).width+1&&o===CH(this,NH).height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,{[MH]:{width:e,height:o}})}function ox(t){CH(this,IH).isVisible()&&hn(t)}function nx(){CH(this,PH)||this.hide()}o(7435);function ix(t,e,o){return e=rx(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function rx(t){var e=sx(t,"string");return"symbol"==typeof e?e:String(e)}function sx(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class lx{constructor(t){ix(this,"hot",void 0),ix(this,"commands",{}),ix(this,"commonCallback",null),this.hot=t}registerCommand(t,e){this.commands[t]=e}setCommonCallback(t){this.commonCallback=t}execute(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];const i=t.split(":"),r=i[0],s=2===i.length?i[1]:null;let l=this.commands[r];if(!l)throw new Error(`Menu command '${r}' not exists.`);if(s&&l.submenu&&(l=ax(s,l.submenu.items)),!0===l.disabled)return;if("function"===typeof l.disabled&&!0===l.disabled.call(this.hot))return;if(Io(l,"submenu"))return;const a=[];"function"===typeof l.callback&&a.push(l.callback),"function"===typeof this.commonCallback&&a.push(this.commonCallback),o.unshift(i.join(":")),A(a,(t=>t.apply(this.hot,o)))}}function ax(t,e){let o;return A(e,(e=>{const n=e.key?e.key.split(":"):null;if(Array.isArray(n)&&n[1]===t)return o=e,!1})),o}const hx="alignment";function cx(){return{key:hx,name(){return this.getTranslatedPhrase(gg)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner()))},submenu:{items:[{key:`${hx}:left`,name(){let t=this.getTranslatedPhrase(fg);const e=lH(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htLeft"))return!0}));return e&&(t=sH(t)),t},callback(){const t=this.getSelectedRange(),e=nH(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,o,n),iH(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${hx}:center`,name(){let t=this.getTranslatedPhrase(mg);const e=lH(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htCenter"))return!0}));return e&&(t=sH(t)),t},callback(){const t=this.getSelectedRange(),e=nH(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,o,n),iH(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${hx}:right`,name(){let t=this.getTranslatedPhrase(pg);const e=lH(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htRight"))return!0}));return e&&(t=sH(t)),t},callback(){const t=this.getSelectedRange(),e=nH(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,o,n),iH(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${hx}:justify`,name(){let t=this.getTranslatedPhrase(wg);const e=lH(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htJustify"))return!0}));return e&&(t=sH(t)),t},callback(){const t=this.getSelectedRange(),e=nH(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,o,n),iH(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{name:QM},{key:`${hx}:top`,name(){let t=this.getTranslatedPhrase(vg);const e=lH(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htTop"))return!0}));return e&&(t=sH(t)),t},callback(){const t=this.getSelectedRange(),e=nH(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,o,n),iH(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${hx}:middle`,name(){let t=this.getTranslatedPhrase(Cg);const e=lH(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htMiddle"))return!0}));return e&&(t=sH(t)),t},callback(){const t=this.getSelectedRange(),e=nH(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,o,n),iH(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${hx}:bottom`,name(){let t=this.getTranslatedPhrase(yg);const e=lH(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htBottom"))return!0}));return e&&(t=sH(t)),t},callback(){const t=this.getSelectedRange(),e=nH(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,o,n),iH(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1}]}}}const ux="clear_column";function dx(){return{key:ux,name(){return this.getTranslatedPhrase(Zd)},callback(t,e){const o=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,o,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByColumnHeader())}}}const gx="col_left";function fx(){return{key:gx,name(){return this.getTranslatedPhrase(Gd)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.col<0)return!0;if(this.selection.isSelectedByCorner()){const t=this.countCols();return 0===t}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const mx="col_right";function px(){return{key:mx,name(){return this.getTranslatedPhrase(Yd)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden(){return!this.getSettings().allowInsertColumn}}}const wx="make_read_only";function vx(){return{key:wx,name(){let t=this.getTranslatedPhrase(Jd);const e=lH(this.getSelectedRange(),((t,e)=>this.getCellMeta(t,e).readOnly));return e&&(t=sH(t)),t},callback(){const t=this.getSelectedRange(),e=lH(t,((t,e)=>this.getCellMeta(t,e).readOnly));A(t,(t=>{t.forAll(((t,o)=>{t>=0&&o>=0&&this.setCellMeta(t,o,"readOnly",!e)}))})),this.render()},disabled(){const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||(!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))))}}}const Cx="redo";function yx(){return{key:Cx,name(){return this.getTranslatedPhrase(Qd)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const bx="remove_col";function Sx(){return{key:bx,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,o,,n]=t[0];o-n!==0&&(e=1)}return this.getTranslatedPhrase(Xd,e)},callback(){this.alter("remove_col",ep(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}}const Rx="remove_row";function Ex(){return{key:Rx,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[o,,n]=t[0];o-n!==0&&(e=1)}return this.getTranslatedPhrase(Kd,e)},callback(){this.alter("remove_row",op(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}}const Tx="row_above";function Mx(){return{key:Tx,name(){return this.getTranslatedPhrase(Ud)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.row<0)return!0;if(this.selection.isSelectedByCorner()){const t=this.countRows();return 0===t}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Hx="row_below";function xx(){return{key:Hx,name(){return this.getTranslatedPhrase($d)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.row<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows))},hidden(){return!this.getSettings().allowInsertRow}}}const kx="no_items";function Ix(){return{key:kx,name(){return this.getTranslatedPhrase(zd)},disabled:!0,isCommand:!1}}const Ax="undo";function Ox(){return{key:Ax,name(){return this.getTranslatedPhrase(qd)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Px=[Tx,Hx,gx,mx,ux,Rx,bx,Ax,Cx,wx,hx,QM,kx],Nx={[QM]:JM,[kx]:Ix,[Tx]:Mx,[Hx]:xx,[gx]:fx,[mx]:px,[ux]:dx,[Rx]:Ex,[bx]:Sx,[Ax]:Ox,[Cx]:yx,[wx]:vx,[hx]:cx};function _x(){const t={};return To(Nx,((e,o)=>{t[o]=e()})),t}function Lx(t,e,o){return e=Dx(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Dx(t){var e=Wx(t,"string");return"symbol"==typeof e?e:String(e)}function Wx(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Vx{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Lx(this,"hot",void 0),Lx(this,"predefinedItems",_x()),Lx(this,"defaultOrderPattern",void 0),this.hot=t,this.defaultOrderPattern=e}setPredefinedItems(t){const e={};this.defaultOrderPattern.length=0,To(t,((t,o)=>{let n="";t.name===QM?(e[QM]=t,n=QM):isNaN(parseInt(o,10))?(t.key=void 0===t.key?o:t.key,e[o]=t,n=t.key):(e[t.key]=t,n=t.key),this.defaultOrderPattern.push(n)})),this.predefinedItems=e}getItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Fx(t,this.defaultOrderPattern,this.predefinedItems)}}function Fx(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Ro(i)?To(i,((t,e)=>{let i=o["string"===typeof t?t:e];i||(i=t),Ro(t)?wo(i,t):"string"===typeof i&&(i={name:i}),void 0===i.key&&(i.key=e),n.push(i)})):A(i,((t,e)=>{let i=o[t];!i&&Px.indexOf(t)>=0||(i||(i={name:t,key:`${e}`}),Ro(t)&&wo(i,t),void 0===i.key&&(i.key=e),n.push(i))})),n}function jx(t,e,o){return e=Bx(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Bx(t){var e=zx(t,"string");return"symbol"==typeof e?e:String(e)}function zx(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ux{constructor(t,e){jx(this,"top",void 0),jx(this,"topRelative",void 0),jx(this,"left",void 0),jx(this,"leftRelative",void 0),jx(this,"scrollTop",void 0),jx(this,"scrollLeft",void 0),jx(this,"cellHeight",void 0),jx(this,"cellWidth",void 0);const o=e.scrollY,n=e.scrollX;let i,r,s,l,a,h;this.rootWindow=e,this.type=this.getSourceType(t),"literal"===this.type?(i=parseInt(t.top,10),s=parseInt(t.left,10),a=t.height||0,h=t.width||0,r=i,l=s,i+=o,s+=n):"event"===this.type&&(i=parseInt(t.pageY,10),s=parseInt(t.pageX,10),a=t.target.clientHeight,h=t.target.clientWidth,r=i-o,l=s-n),this.top=i,this.topRelative=r,this.left=s,this.leftRelative=l,this.scrollTop=o,this.scrollLeft=n,this.cellHeight=a,this.cellWidth=h}getSourceType(t){let e="literal";return t instanceof Event&&(e="event"),e}fitsAbove(t){return this.topRelative>=t.offsetHeight}fitsBelow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}fitsOnRight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}fitsOnLeft(t){return this.leftRelative>=t.offsetWidth}}function $x(t,e,o){Gx(t,e),e.set(t,o)}function Gx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yx(t,e){var o=qx(t,e,"get");return Kx(t,o)}function Kx(t,e){return e.get?e.get.call(t):e.value}function Xx(t,e,o){var n=qx(t,e,"set");return Qx(t,n,o),o}function qx(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Qx(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var Jx=new WeakMap,Zx=new WeakMap,tk=new WeakMap,ek=new WeakMap,ok=new WeakMap;class nk{constructor(t){$x(this,Jx,{writable:!0,value:void 0}),$x(this,Zx,{writable:!0,value:void 0}),$x(this,tk,{writable:!0,value:void 0}),$x(this,ek,{writable:!0,value:!1}),$x(this,ok,{writable:!0,value:{above:0,below:0,left:0,right:0}}),Xx(this,ek,t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Yx(this,ok)[t]=e,this}setElement(t){return Xx(this,Jx,t),this}setParentElement(t){return Xx(this,Zx,t),this}updatePosition(t){Xx(this,tk,new Ux(t,Yx(this,Jx).ownerDocument.defaultView)),Yx(this,ek)?(Yx(this,tk).fitsBelow(Yx(this,Jx))?this.setPositionBelowCursor():Yx(this,tk).fitsAbove(Yx(this,Jx))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===Yx(this,Jx).dir?Yx(this,tk).fitsOnLeft(Yx(this,Jx))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Yx(this,tk).fitsOnRight(Yx(this,Jx))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let t=Yx(this,ok).above+Yx(this,tk).top-Yx(this,Jx).offsetHeight;Yx(this,Zx)&&(t=Yx(this,tk).top+Yx(this,tk).cellHeight-Yx(this,Jx).offsetHeight+3),Yx(this,Jx).style.top=`${t}px`}setPositionBelowCursor(){let t=Yx(this,ok).below+Yx(this,tk).top+1;Yx(this,Zx)&&(t=Yx(this,tk).top-1),Yx(this,Jx).style.top=`${t}px`}setPositionOnRightOfCursor(){let t=Yx(this,tk).left;if(Yx(this,Zx)){const{right:e}=Yx(this,Zx).getBoundingClientRect();t+=Yx(this,tk).cellWidth+e-(Yx(this,tk).left+Yx(this,tk).cellWidth)}else t+=Yx(this,ok).right;Yx(this,Jx).style.left=`${t}px`}setPositionOnLeftOfCursor(){let t=Yx(this,ok).left+Yx(this,tk).left-Yx(this,Jx).offsetWidth;if(Yx(this,Zx)){const{left:e}=Yx(this,Zx).getBoundingClientRect();t-=Yx(this,tk).left-e}Yx(this,Jx).style.left=`${t}px`}}function ik(t){let{initialPage:e=-1,size:o=(()=>0),onItemSelect:n=(()=>{}),onClear:i=(()=>{})}=t;const r=new Set;let s=Bi(e,-1,f()-1);function l(t,e){const o=f()-1;if(t<0&&(t=o),t>o&&(t=0),r.has(t))return-1;r.add(t);const i=n(t,!1);return!1===i&&(t=l(1===e?++t:--t,e)),t}function a(t){t>-1&&t<f()&&!1!==n(t,!0)&&(s=t)}function h(){return s}function c(){f()>0&&(r.clear(),s=l(0,1))}function u(){f()>0&&(r.clear(),s=l(f()-1,-1))}function d(){f()>0&&(r.clear(),s=l(++s,1))}function g(){f()>0&&(r.clear(),s=l(--s,-1))}function f(){return Math.max(o(),0)}function m(){r.clear(),s=e,i()}return{setCurrentPage:a,getCurrentPage:h,toFirstItem:c,toLastItem:u,toNextItem:d,toPreviousItem:g,getSize:f,clear:m}}function rk(t){return I(t,(t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()})))}function sk(t){return Io(t,"submenu")}function lk(t){return new RegExp(QM,"i").test(t.name)}function ak(t,e){return!0===t.disabled||"function"===typeof t.disabled&&!0===t.disabled.call(e)}function hk(t){return Io(t,"disableSelection")}function ck(t){return ue(t,"htSeparator")}function uk(t){return ue(t,"htSubmenu")}function dk(t){return ue(t,"htDisabled")}function gk(t){return ue(t,"htSelectionDisabled")}function fk(t,e){return!t.hidden||!("function"===typeof t.hidden&&t.hidden.call(e))}function mk(t,e){const o=t.slice(0);for(let n=0;n<o.length;){if(o[n].name!==e)break;o.shift()}return o}function pk(t,e){let o=t.slice(0);return o.reverse(),o=mk(o,e),o.reverse(),o}function wk(t){const e=[];return A(t,((t,o)=>{o>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)})),e}function vk(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:QM,o=t.slice(0);return o=mk(o,e),o=pk(o,e),o=wk(o),o}function Ck(t){return ik({size:()=>t.countRows(),onItemSelect(e,o){const n=t.getCell(e,0);if(!n||ck(n)||dk(n)||gk(n))return!1;t.selectCell(e,0,...o?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function yk(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const o=t.openSubMenu(e[0]);o&&o.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{const e=t.hotMenu.getSelectedLast();e&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const o=t.hotMenu.getSelectedLast();o&&(t.hotMenu.getSourceDataAtRow(o[0]).submenu?t.openSubMenu(o[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{const e=t.hotMenu.getSelectedLast();e?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{const e=t.hotMenu.getSelectedLast();e?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const bk="menu",Sk=bk;function Rk(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=[];function n(t,e){l(e).addShortcuts(t,{group:bk})}function i(t,e){const i=l(e);t.forEach((t=>{let{keys:e}=t;e.forEach((t=>i.removeShortcutsByKeys(t)))})),o.push({shortcuts:t,contextName:e}),n(t,e)}function r(){return[...o]}function s(t){return t?`${Sk}:${t}`:Sk}function l(e){var o;const n=t.hotMenu.getShortcutManager(),i=s(e);return null!==(o=n.getContext(i))&&void 0!==o?o:n.addContext(i)}function a(e){t.hotMenu.getShortcutManager().setActiveContextName(s(e))}return n(yk(t)),e.forEach((t=>{let{shortcuts:e,contextName:o}=t;i(e,o)})),{addCustomShortcuts:i,getCustomShortcuts:r,getContext:l,listen:a}}function Ek(t){return(e,o,n,i,r,s)=>{if(o.hasAttribute("ghost-table"))return;const l=e.getSourceDataAtRow(n),a=t.rootDocument.createElement("div"),h="function"===typeof s?s.call(t):s;if(we(o),de(a,"htItemWrapper"),t.getSettings().ariaTags){const e=!ak(l,t)&&!hk(l)&&!lk(l);fe(o,[Rt(),At(h),...e?[ft(-1)]:[],...ak(l,t)?[Pt()]:[],...sk(l)?[Ft(!1)]:[]])}o.className="",o.appendChild(a),lk(l)?de(o,"htSeparator"):"function"===typeof l.renderer?(de(o,"htCustomMenuRenderer"),o.appendChild(l.renderer(e,a,n,i,r,h))):Ce(a,h),ak(l,t)?de(o,"htDisabled"):hk(l)?de(o,"htSelectionDisabled"):sk(l)&&de(o,"htSubmenu")}}function Tk(t,e,o){Mk(t,e),e.set(t,o)}function Mk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hk(t,e,o){return e=xk(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function xk(t){var e=kk(t,"string");return"symbol"==typeof e?e:String(e)}function kk(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ik(t,e,o){var n=Pk(t,e,"set");return Ak(t,n,o),o}function Ak(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function Ok(t,e){var o=Pk(t,e,"get");return Nk(t,o)}function Pk(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Nk(t,e){return e.get?e.get.call(t):e.value}const _k=215;var Lk=new WeakMap,Dk=new WeakMap;class Wk{constructor(t,e){var o=this;Hk(this,"hot",void 0),Hk(this,"options",void 0),Hk(this,"eventManager",new $n(this)),Hk(this,"container",void 0),Hk(this,"positioner",void 0),Hk(this,"hotMenu",null),Hk(this,"hotSubMenus",{}),Hk(this,"parentMenu",void 0),Hk(this,"menuItems",null),Hk(this,"origOutsideClickDeselects",null),Tk(this,Lk,{writable:!0,value:void 0}),Tk(this,Dk,{writable:!0,value:void 0}),this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:_k,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new nk(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.parentMenu.runLocalHooks("afterSelectionChange",...e)}))}registerEvents(){let t=this.hot.rootWindow;while(t)this.eventManager.addEventListener(t.document,"mousedown",(t=>this.onDocumentMouseDown(t))),this.eventManager.addEventListener(t.document,"contextmenu",(t=>this.onDocumentContextMenu(t))),t=oe(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return Ok(this,Lk)}getKeyboardShortcutsCtrl(){return Ok(this,Dk)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=ao((t=>this.openSubMenu(t)),300),e=this.options.minWidth||_k;let o=!1,n=k(this.menuItems,(t=>(t.key===kx&&(o=!0),fk(t,this.hot))));if(n.length<1&&!o)n.push(_x()[kx]);else if(0===n.length)return;n=vk(n,QM);let i=!1;const r={data:n,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(t){return U(t)&&t<e?e:t},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Ek(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(t,e)=>{Ok(this,Lk).setCurrentPage(e.row)},afterOnCellMouseOver:(e,o)=>{this.isAllSubMenusClosed()?t(o.row):this.openSubMenu(o.row)},rowHeights:t=>n[t].name===QM?1:23,afterOnCellContextMenu:t=>{t.preventDefault(),Jo()&&i&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(t,e,o,n,i)=>{this.hotMenu.view.isMouseDown()&&(i.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:t=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(t))},afterOnCellMouseUp:t=>{Jo()&&un(t)||!i||!this.hasSelectedItem()||(Xo()||Qo()?this.hot._registerTimeout((()=>this.close(!0)),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,r),this.hotMenu.addHook("afterInit",(()=>this.onAfterInit())),this.hotMenu.init(),Ik(this,Lk,Ck(this.hotMenu)),Ik(this,Dk,Rk(this)),Ok(this,Dk).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",(()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this))),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(t&&this.isSubMenu())this.parentMenu.close();else if(Ok(this,Lk).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const e=this.parentMenu.hotMenu.getCell(t[0],0);fe(e,[Ft(!1)])}}this.parentMenu.hotMenu.listen()}}openSubMenu(t){if(!this.hotMenu)return!1;const e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!uk(e))return!1;const o=this.hotMenu.getSourceDataAtRow(t),n=new Wk(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return n.setMenuItems(o.submenu.items),n.open(),n.setPosition(e.getBoundingClientRect()),this.hotSubMenus[o.key]=n,this.hot.getSettings().ariaTags&&fe(e,[Ft(!0)]),n}closeSubMenu(t){const e=this.hotMenu.getSourceDataAtRow(t),o=this.hotSubMenus[e.key];if(o){o.destroy(),delete this.hotSubMenus[e.key];const n=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&fe(n,[Ft(!1)])}}closeAllSubMenus(){A(this.hotMenu.getData(),((t,e)=>this.closeSubMenu(e)))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;const e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),this.isCommandPassive(e))return;const o=this.hot.getSelectedRange(),n=o?rk(o):[];this.runLocalHooks("executeCommand",e.key,n,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,n,t)}isCommandPassive(t){return!1===t.isCommand||lk(t)||ak(t,this.hot)||sk(t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(t,e)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.options.container.ownerDocument;let o,n=t;return n&&(ro(n)&&(n=n.call(this.hot),n=null===n||$(n)?"":n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,o=e.querySelector(`.${this.options.className}.${n}`)),o||(o=e.createElement("div"),de(o,`htMenu ${this.options.className}`),n&&de(o,n),this.options.container.appendChild(o)),o}onAfterInit(){const{wtTable:t}=this.hotMenu.view._wt,e=this.hotMenu.getSettings().data,o=t.hider.style,n=t.holder.style,i=parseInt(o.width,10),r=x(e,((t,e)=>t+(e.name===QM?1:26)),0);n.width=`${i+3}px`,n.height=`${r+3}px`,o.height=n.height,this.hot.getSettings().ariaTags&&fe(this.hotMenu.rootElement,[St(),ft(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!se(t.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||se(t.target,".htMenu")||this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&ue(t.target,"htCore")&&se(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}function Vk(t,e){Fk(t,e),e.add(t)}function Fk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jk(t,e,o){return e=Bk(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Bk(t){var e=zk(t,"string");return"symbol"==typeof e?e:String(e)}function zk(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Uk(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}bo(Wk,ku);const $k="contextMenu",Gk=70,Yk=$k;Mn.getSingleton().register("afterContextMenuDefaultOptions"),Mn.getSingleton().register("beforeContextMenuShow"),Mn.getSingleton().register("afterContextMenuShow"),Mn.getSingleton().register("afterContextMenuHide"),Mn.getSingleton().register("afterContextMenuExecute");var Kk=new WeakSet,Xk=new WeakSet,qk=new WeakSet,Qk=new WeakSet;class Jk extends _S{constructor(){super(...arguments),Vk(this,Qk),Vk(this,qk),Vk(this,Xk),Vk(this,Kk),jk(this,"commandExecutor",new lx(this.hot)),jk(this,"itemsFactory",null),jk(this,"menu",null)}static get PLUGIN_KEY(){return $k}static get PLUGIN_PRIORITY(){return Gk}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Tx,Hx,QM,gx,mx,QM,Rx,bx,QM,Ax,Cx,QM,wx,QM,hx]}isEnabled(){return!!this.hot.getSettings()[$k]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[$k];"function"===typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new Wk(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(()=>Uk(this,Xk,tI).call(this))),this.menu.addLocalHook("afterOpen",(()=>Uk(this,qk,eI).call(this))),this.menu.addLocalHook("afterClose",(()=>Uk(this,Qk,oI).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.executeCommand.call(t,...o)})),this.addHook("afterOnCellContextMenu",(t=>Uk(this,Kk,Zk).call(this,t))),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const e=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),o=aH(this.menu.container,this.hot.rootDocument);this.open({left:e.left+o.left,top:e.top+o.top-1+e.height},{left:e.width,above:-e.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&!this.menu.isOpened()},group:Yk})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Yk)}open(t){var e;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.prepareMenuItems(),this.menu.open(),To(o,((t,e)=>{this.menu.setOffset(e,t)})),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close(),this.itemsFactory=null}executeCommand(t){null===this.itemsFactory&&this.prepareMenuItems();for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];this.commandExecutor.execute(t,...o)}prepareMenuItems(){this.itemsFactory=new Vx(this.hot,Jk.DEFAULT_ITEMS);const t=this.hot.getSettings()[$k],e={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",e),this.itemsFactory.setPredefinedItems(e.items);const o=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),A(o,(t=>this.commandExecutor.registerCommand(t.key,t)))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Zk(t){const e=this.hot.getSettings(),o=e.rowHeaders,n=e.colHeaders;function i(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}const r=t.target;if(this.close(),ue(r,"handsontableInput"))return;if(t.preventDefault(),t.stopPropagation(),!o&&!n&&!i(r)&&(!ue(r,"current")||!ue(r,"wtBorder")))return;const s=aH(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function tI(){this.hot.runHooks("beforeContextMenuShow",this)}function eI(){this.hot.runHooks("afterContextMenuShow",this)}function oI(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}function nI(t){return{key:"copy",name(){return this.getTranslatedPhrase(tg)},callback(){t.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function iI(t){return{key:"copy_column_headers_only",name(){const t=this.getSelectedRangeLast(),e=t?Bi(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(ng,e)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function rI(t){return{key:"copy_with_column_group_headers",name(){const t=this.getSelectedRangeLast(),e=t?Bi(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(og,e)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function sI(t){return{key:"copy_with_column_headers",name(){const t=this.getSelectedRangeLast(),e=t?Bi(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(eg,e)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function lI(t){return{key:"cut",name(){return this.getTranslatedPhrase(ig)},callback(){t.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}Jk.SEPARATOR={name:QM};class aI{constructor(){this.data={}}setData(t,e){this.data[t]=e}getData(t){return this.data[t]||void 0}}class hI{constructor(){this.clipboardData=new aI}}function cI(t,e){dI(t,e),e.add(t)}function uI(t,e,o){dI(t,e),e.set(t,o)}function dI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gI(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function fI(t,e){var o=wI(t,e,"get");return mI(t,o)}function mI(t,e){return e.get?e.get.call(t):e.value}function pI(t,e,o){var n=wI(t,e,"set");return vI(t,n,o),o}function wI(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function vI(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var CI=new WeakMap,yI=new WeakMap,bI=new WeakMap,SI=new WeakMap,RI=new WeakMap,EI=new WeakMap,TI=new WeakSet,MI=new WeakSet;class HI{constructor(t){let{countRows:e,countColumns:o,rowsLimit:n,columnsLimit:i,countColumnHeaders:r}=t;cI(this,MI),cI(this,TI),uI(this,CI,{writable:!0,value:void 0}),uI(this,yI,{writable:!0,value:void 0}),uI(this,bI,{writable:!0,value:void 0}),uI(this,SI,{writable:!0,value:void 0}),uI(this,RI,{writable:!0,value:void 0}),uI(this,EI,{writable:!0,value:void 0}),pI(this,yI,e),pI(this,bI,o),pI(this,SI,n),pI(this,RI,i),pI(this,EI,r)}setSelectedRange(t){pI(this,CI,t)}getCellsRange(){if(0===fI(this,yI).call(this)||0===fI(this,bI).call(this))return null;const{row:t,col:e}=fI(this,CI).getTopStartCorner(),{row:o,col:n}=fI(this,CI).getBottomEndCorner(),i=gI(this,MI,kI).call(this,t,o),r=gI(this,TI,xI).call(this,e,n),s=o!==i||n!==r;return{isRangeTrimmed:s,startRow:t,startCol:e,endRow:i,endCol:r}}getMostBottomColumnHeadersRange(){if(0===fI(this,bI).call(this)||0===fI(this,EI).call(this))return null;const{col:t}=fI(this,CI).getTopStartCorner(),{col:e}=fI(this,CI).getBottomEndCorner(),o=gI(this,TI,xI).call(this,t,e),n=e!==o;return{isRangeTrimmed:n,startRow:-1,startCol:t,endRow:-1,endCol:o}}getAllColumnHeadersRange(){if(0===fI(this,bI).call(this)||0===fI(this,EI).call(this))return null;const{col:t}=fI(this,CI).getTopStartCorner(),{col:e}=fI(this,CI).getBottomEndCorner(),o=gI(this,TI,xI).call(this,t,e),n=e!==o;return{isRangeTrimmed:n,startRow:-fI(this,EI).call(this),startCol:t,endRow:-1,endCol:o}}}function xI(t,e){return Math.min(e,Math.max(t+fI(this,RI).call(this)-1,t))}function kI(t,e){return Math.min(e,Math.max(t+fI(this,SI).call(this)-1,t))}function II(t){const e=[],o=[];return A(t,(t=>{const n=Math.min(t.startRow,t.endRow),i=Math.max(t.startRow,t.endRow);Vi(n,i,(t=>{-1===e.indexOf(t)&&e.push(t)}));const r=Math.min(t.startCol,t.endCol),s=Math.max(t.startCol,t.endCol);Vi(r,s,(t=>{-1===o.indexOf(t)&&o.push(t)}))})),{rows:e,columns:o}}function AI(t,e){PI(t,e),e.add(t)}function OI(t,e,o){PI(t,e),e.set(t,o)}function PI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NI(t,e,o){return e=_I(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function _I(t){var e=LI(t,"string");return"symbol"==typeof e?e:String(e)}function LI(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function DI(t,e){var o=jI(t,e,"get");return WI(t,o)}function WI(t,e){return e.get?e.get.call(t):e.value}function VI(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function FI(t,e,o){var n=jI(t,e,"set");return BI(t,n,o),o}function jI(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function BI(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}Mn.getSingleton().register("afterCopyLimit"),Mn.getSingleton().register("modifyCopyableRange"),Mn.getSingleton().register("beforeCut"),Mn.getSingleton().register("afterCut"),Mn.getSingleton().register("beforePaste"),Mn.getSingleton().register("afterPaste"),Mn.getSingleton().register("beforeCopy"),Mn.getSingleton().register("afterCopy");const zI="copyPaste",UI=80,$I=["fragmentSelection"],GI=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var YI=new WeakMap,KI=new WeakMap,XI=new WeakMap,qI=new WeakMap,QI=new WeakMap,JI=new WeakMap,ZI=new WeakMap,tA=new WeakMap,eA=new WeakSet,oA=new WeakSet,nA=new WeakSet,iA=new WeakSet,rA=new WeakSet,sA=new WeakSet,lA=new WeakSet,aA=new WeakSet,hA=new WeakSet,cA=new WeakSet;class uA extends _S{constructor(){super(...arguments),AI(this,cA),AI(this,hA),AI(this,aA),AI(this,lA),AI(this,sA),AI(this,rA),AI(this,iA),AI(this,nA),AI(this,oA),AI(this,eA),NI(this,"columnsLimit",1/0),NI(this,"rowsLimit",1/0),NI(this,"pasteMode","overwrite"),NI(this,"uiContainer",this.hot.rootDocument.body),OI(this,YI,{writable:!0,value:!1}),OI(this,KI,{writable:!0,value:!1}),OI(this,XI,{writable:!0,value:!1}),OI(this,qI,{writable:!0,value:"cells-only"}),OI(this,QI,{writable:!0,value:!1}),OI(this,JI,{writable:!0,value:!1}),OI(this,ZI,{writable:!0,value:new HI({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),OI(this,tA,{writable:!0,value:!1}),NI(this,"copyableRanges",[])}static get PLUGIN_KEY(){return zI}static get SETTING_KEYS(){return[zI,...$I]}static get PLUGIN_PRIORITY(){return UI}isEnabled(){return!!this.hot.getSettings()[zI]}enablePlugin(){var t=this;if(this.enabled)return;const{[zI]:e}=this.hot.getSettings();var o,n;"object"===typeof e&&(this.pasteMode=null!==(o=e.pasteMode)&&void 0!==o?o:this.pasteMode,this.rowsLimit=isNaN(e.rowsLimit)?this.rowsLimit:e.rowsLimit,this.columnsLimit=isNaN(e.columnsLimit)?this.columnsLimit:e.columnsLimit,FI(this,YI,!!e.copyColumnHeaders),FI(this,KI,!!e.copyColumnGroupHeaders),FI(this,XI,!!e.copyColumnHeadersOnly),this.uiContainer=null!==(n=e.uiContainer)&&void 0!==n?n:this.uiContainer);this.addHook("afterContextMenuDefaultOptions",(t=>VI(this,rA,pA).call(this,t))),this.addHook("afterSelection",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return VI(t,sA,wA).call(t,...o)})),this.addHook("afterSelectionEnd",(()=>VI(this,lA,vA).call(this))),this.eventManager.addEventListener(this.hot.rootDocument,"copy",(function(){return t.onCopy(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"cut",(function(){return t.onCut(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"paste",(function(){return t.onPaste(...arguments)})),Go()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return VI(t,aA,CA).call(t,...o)})),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return VI(t,hA,yA).call(t,...o)})),this.addHook("afterSelection",(()=>VI(this,cA,bA).call(this)))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";FI(this,qI,t),FI(this,QI,!0),VI(this,eA,dA).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){FI(this,JI,!0),VI(this,eA,dA).call(this,"cut")}getRangedCopyableData(t){return dw(this.getRangedData(t))}getRangedData(t){const e=[],{rows:o,columns:n}=II(t);return A(o,(t=>{const o=[];A(n,(e=>{t<0?o.push(this.hot.getColHeader(e,t)):o.push(this.hot.getCopyableData(t,e))})),e.push(o)})),e}paste(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t&&!e)return;const o=new hI;t&&o.clipboardData.setData("text/plain",t),e&&o.clipboardData.setData("text/html",e),this.onPaste(o)}setCopyableText(){const t=this.hot.getSelectedRangeLast();if(!t)return;if(t.isSingleHeader())return void(this.copyableRanges=[]);DI(this,ZI).setSelectedRange(t);const e=new Map([["headers",null],["cells",null]]);"column-headers-only"===DI(this,qI)?e.set("headers",DI(this,ZI).getMostBottomColumnHeadersRange()):("with-column-headers"===DI(this,qI)?e.set("headers",DI(this,ZI).getMostBottomColumnHeadersRange()):"with-column-group-headers"===DI(this,qI)&&e.set("headers",DI(this,ZI).getAllColumnHeadersRange()),e.set("cells",DI(this,ZI).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter((t=>null!==t)).map((t=>{let{startRow:e,startCol:o,endRow:n,endCol:i}=t;return{startRow:e,startCol:o,endRow:n,endCol:i}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const o=e.get("cells");if(null!==o&&o.isRangeTrimmed){const{startRow:t,startCol:e,endRow:n,endCol:i}=o;this.hot.runHooks("afterCopyLimit",n-t+1,i-e+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}populateValues(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!t.length)return;const o=t.length,n=t[0].length,i=[],{row:r,col:s}=e.getTopStartCorner(),{row:l,col:a}=e.getBottomEndCorner();let h=r,c=s,u=r,d=s;while(i.length<o||h<=l){const{skipRowOnPaste:e,visualRow:l}=this.hot.getCellMeta(h,s);if(h=l+1,!0===e)continue;u=l,c=s;const g=[],f=i.length%o;while(g.length<n||c<=a){const{skipColumnOnPaste:e,visualCol:o}=this.hot.getCellMeta(r,c);if(c=o+1,!0===e)continue;d=o;const i=g.length%n;g.push(t[f][i])}i.push(g)}return FI(this,tA,!0),this.hot.populateFromArray(r,s,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[r,s,u,d]}onCopy(t){if(!this.hot.isListening()&&!DI(this,QI)||this.isEditorOpened())return;this.setCopyableText(),FI(this,QI,!1);const e=this.getRangedData(this.copyableRanges),o=VI(this,oA,gA).call(this,this.copyableRanges),n=!!this.hot.runHooks("beforeCopy",e,this.copyableRanges,o);if(n){const n=dw(e);if(t&&t.clipboardData){const o=_i(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[GI,o].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.runHooks("afterCopy",e,this.copyableRanges,o)}FI(this,qI,"cells-only"),t.preventDefault()}onCut(t){if(!this.hot.isListening()&&!DI(this,JI)||this.isEditorOpened())return;this.setCopyableText(),FI(this,JI,!1);const e=this.getRangedData(this.copyableRanges),o=!!this.hot.runHooks("beforeCut",e,this.copyableRanges);if(o){const o=dw(e);if(t&&t.clipboardData){const n=_i(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",o),t.clipboardData.setData("text/html",[GI,n].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",e,this.copyableRanges)}t.preventDefault()}onPaste(t){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;let e;if(t&&t.preventDefault&&t.preventDefault(),t&&"undefined"!==typeof t.clipboardData){const o=gt(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(o&&/(<table)|(<TABLE)/g.test(o)){const t=Li(o,this.hot.rootDocument);e=t.data}else e=t.clipboardData.getData("text/plain")}else"undefined"===typeof ClipboardEvent&&"undefined"!==typeof this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"===typeof e&&(e=uw(e)),void 0===e||e&&0===e.length)return;if(!1===this.hot.runHooks("beforePaste",e,this.copyableRanges))return;const[o,n,i,r]=this.populateValues(e);this.hot.selectCell(o,n,Math.min(this.hot.countRows()-1,i),Math.min(this.hot.countCols()-1,r)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}destroy(){super.destroy()}}function dA(t){if(Go()){const e=this.hot.getSelectedRangeLast();if(e){const{row:o,col:n}=e.highlight,i=this.hot.getCell(o,n,!0);i&&io(i,(()=>{this.hot.rootDocument.execCommand(t)}))}}else this.hot.rootDocument.execCommand(t)}function gA(t){const{rows:e}=II(t);let o=0;for(let n=0;n<e.length;n++){if(e[n]>=0)break;o+=1}return{columnHeadersCount:o}}function fA(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:o}=t.highlight,n=this.hot.getCell(e,o,!0);n&&oo(n)}}}function mA(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:o}=t.highlight,n=this.hot.getCell(e,o,!0);null!==n&&void 0!==n&&n.hasAttribute("contenteditable")&&no(n)}}}function pA(t){t.items.push({name:"---------"},nI(this)),DI(this,YI)&&t.items.push(sI(this)),DI(this,KI)&&t.items.push(rI(this)),DI(this,XI)&&t.items.push(iI(this)),t.items.push(lI(this))}function wA(t,e,o,n,i){DI(this,tA)&&(i.value=!0),FI(this,tA,!1)}function vA(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function CA(){VI(this,iA,mA).call(this)}function yA(){VI(this,nA,fA).call(this)}function bA(){VI(this,iA,mA).call(this)}function SA(t,e){return`border_row${t}col${e}`}function RA(){return{width:1,color:"#000"}}function EA(){return{hide:!0}}function TA(){return{width:1,color:"#000",cornerVisible:!1}}function MA(t){var e,o;(U(t.start)||U(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left);(U(t.end)||U(t.right))&&(t.end=null!==(o=t.end)&&void 0!==o?o:t.right);return delete t.left,delete t.right,t}function HA(t){return U(t.start)&&(t.left=t.start),U(t.end)&&(t.right=t.end),t}function xA(t,e){return{id:SA(t,e),border:TA(),row:t,col:e,top:EA(),bottom:EA(),start:EA(),end:EA()}}function kA(t,e){return Io(e,"border")&&e.border&&(t.border=e.border),Io(e,"top")&&U(e.top)&&(e.top?(Ro(e.top)||(e.top=RA()),t.top=e.top):(e.top=EA(),t.top=e.top)),Io(e,"bottom")&&U(e.bottom)&&(e.bottom?(Ro(e.bottom)||(e.bottom=RA()),t.bottom=e.bottom):(e.bottom=EA(),t.bottom=e.bottom)),Io(e,"start")&&U(e.start)&&(e.start?(Ro(e.start)||(e.start=RA()),t.start=e.start):(e.start=EA(),t.start=e.start)),Io(e,"end")&&U(e.end)&&(e.end?(Ro(e.end)||(e.end=RA()),t.end=e.end):(e.end=EA(),t.end=e.end)),t}function IA(t,e){let o=!1;return A(t.getSelectedRange(),(n=>{n.forAll(((n,i)=>{if(n<0||i<0)return;const r=t.getCellMeta(n,i).borders;if(r){if(!e)return o=!0,!1;if(!Io(r[e],"hide")||!1===r[e].hide)return o=!0,!1}}))})),o}function AA(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function OA(t){return t.some((t=>U(t.left)||U(t.right)))}function PA(t){return t.some((t=>U(t.start)||U(t.end)))}const NA=new Map([["left","start"],["right","end"]]);function _A(t){var e;return null!==(e=NA.get(t))&&void 0!==e?e:t}function LA(t){return{key:"borders:top",name(){let t=this.getTranslatedPhrase(Sg);const e=IA(this,"top");return e&&(t=AA(t)),t},callback(e,o){const n=IA(this,"top");t.prepareBorder(o,"top",n)}}}function DA(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(Rg);const o=IA(this,e);return o&&(t=AA(t)),t},callback(o,n){const i=IA(this,e);t.prepareBorder(n,e,i)}}}function WA(t){return{key:"borders:bottom",name(){let t=this.getTranslatedPhrase(Eg);const e=IA(this,"bottom");return e&&(t=AA(t)),t},callback(e,o){const n=IA(this,"bottom");t.prepareBorder(o,"bottom",n)}}}function VA(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(Tg);const o=IA(this,e);return o&&(t=AA(t)),t},callback(o,n){const i=IA(this,e);t.prepareBorder(n,e,i)}}}function FA(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Mg)},callback(e,o){t.prepareBorder(o,"noBorders")},disabled(){return!IA(this)}}}function jA(t,e){BA(t,e),e.add(t)}function BA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zA(t,e,o){return e=UA(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function UA(t){var e=$A(t,"string");return"symbol"==typeof e?e:String(e)}function $A(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function GA(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const YA="customBorders",KA=90;var XA=new WeakSet,qA=new WeakSet;class QA extends _S{constructor(){super(...arguments),jA(this,qA),jA(this,XA),zA(this,"savedBorders",[])}static get PLUGIN_KEY(){return YA}static get PLUGIN_PRIORITY(){return KA}isEnabled(){return!!this.hot.getSettings()[YA]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>GA(this,XA,JA).call(this,t))),this.addHook("init",(()=>GA(this,qA,ZA).call(this))),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(t,e){let o=["top","bottom","start","end"],n=null;e&&(this.checkSettingsCohesion([e]),o=Object.keys(e),n=MA(e));const i=Zm(t),r=tp(i,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});A(t,(t=>{r(t).forAll(((t,e)=>{A(o,(o=>{this.prepareBorderFromCustomAdded(t,e,n,_A(o))}))}))})),this.hot.view.render()}getBorders(t){if(!Array.isArray(t))return this.savedBorders;const e=Zm(t),o=tp(e,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),n=[];return A(t,(t=>{o(t).forAll(((t,e)=>{A(this.savedBorders,(o=>{o.row===t&&o.col===e&&n.push(HA(o))}))}))})),n}clearBorders(t){t?this.setBorders(t):(A(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")})),this.savedBorders.length=0)}insertBorderIntoSettings(t,e){const o=this.checkSavedBorders(t);o||this.savedBorders.push(t);const n=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col)),i=this.checkCustomSelections(t,n,e);i||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:n})}prepareBorderFromCustomAdded(t,e,o,n){const i=this.hot.countRows(),r=this.hot.countCols();if(t>=i||e>=r)return;let s=xA(t,e);o&&(s=kA(s,o),A(this.hot.selection.highlight.customSelections,(t=>{if(s.id===t.settings.id)return Object.assign(t.settings,o),s.id=t.settings.id,s.top=t.settings.top,s.bottom=t.settings.bottom,s.start=t.settings.start,s.end=t.settings.end,!1}))),this.hot.setCellMeta(t,e,"borders",HA(s)),this.insertBorderIntoSettings(s,n)}prepareBorderFromCustomAddedRange(t,e){const o=Math.min(t.to.row,this.hot.countRows()-1),n=Math.min(t.to.col,this.hot.countCols()-1);Vi(t.from.row,o,(o=>{Vi(t.from.col,n,(n=>{const i=xA(o,n);let r=0;o===t.from.row&&Io(e,"top")&&(r+=1,i.top=e.top),o===t.to.row&&Io(e,"bottom")&&(r+=1,i.bottom=e.bottom),n===t.from.col&&Io(e,"start")&&(r+=1,i.start=e.start),n===t.to.col&&Io(e,"end")&&(r+=1,i.end=e.end),r>0&&(this.hot.setCellMeta(o,n,"borders",HA(i)),this.insertBorderIntoSettings(i))}))}))}removeAllBorders(t,e){const o=SA(t,e);this.spliceBorder(o),this.clearBordersFromSelectionSettings(o),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}setBorder(t,e,o,n){let i=this.hot.getCellMeta(t,e).borders;if(i=i&&void 0!==i.border?MA(i):xA(t,e),n){i[o]=EA();const r=this.countHide(i);if(4===r)this.removeAllBorders(t,e);else{const r=this.checkCustomSelectionsFromContextMenu(i,o,n);r||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",HA(i))}}else{i[o]=RA();const r=this.checkCustomSelectionsFromContextMenu(i,o,n);r||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",HA(i))}}prepareBorder(t,e,o){A(t,(t=>{let{start:n,end:i}=t;if(n.row===i.row&&n.col===i.col)"noBorders"===e?this.removeAllBorders(n.row,n.col):this.setBorder(n.row,n.col,e,o);else switch(e){case"noBorders":Vi(n.col,i.col,(t=>{Vi(n.row,i.row,(e=>{this.removeAllBorders(e,t)}))}));break;case"top":Vi(n.col,i.col,(t=>{this.setBorder(n.row,t,e,o)}));break;case"bottom":Vi(n.col,i.col,(t=>{this.setBorder(i.row,t,e,o)}));break;case"start":Vi(n.row,i.row,(t=>{this.setBorder(t,n.col,e,o)}));break;case"end":Vi(n.row,i.row,(t=>{this.setBorder(t,i.col,e,o)}));break;default:break}}))}createCustomBorders(t){A(t,(t=>{const e=MA(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,e):this.prepareBorderFromCustomAdded(t.row,t.col,e)}))}countHide(t){const{top:e,bottom:o,start:n,end:i}=t,r=[e,o,n,i];return x(r,((t,e)=>{let o=t;return e&&e.hide&&(o+=1),o}),0)}clearBordersFromSelectionSettings(t){const e=I(this.hot.selection.highlight.customSelections,(t=>t.settings.id)).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}clearNullCellRange(){A(this.hot.selection.highlight.customSelections,((t,e)=>{if(null===t.cellRange)return this.hot.selection.highlight.customSelections[e].destroy(),this.hot.selection.highlight.customSelections.splice(e,1),!1}))}hideBorders(){A(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange()}))}spliceBorder(t){const e=I(this.savedBorders,(t=>t.id)).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}checkSavedBorders(t){let e=!1;const o=this.countHide(t);return 4===o?(this.spliceBorder(t.id),e=!0):A(this.savedBorders,((o,n)=>{if(t.id===o.id)return this.savedBorders[n]=t,e=!0,!1})),e}checkCustomSelectionsFromContextMenu(t,e,o){let n=!1;return A(this.hot.selection.highlight.customSelections,(i=>{if(t.id===i.settings.id){const t=this.hot.view._wt.selectionManager.getBorderInstances(i);return A(t,(t=>{t.toggleHiddenClass(e,o)})),n=!0,!1}})),n}checkCustomSelections(t,e,o){const n=this.countHide(t);let i=!1;return 4===n?(this.removeAllBorders(t.row,t.col),i=!0):A(this.hot.selection.highlight.customSelections,(n=>{if(t.id===n.settings.id){if(n.visualCellRange=e,n.commit(),o){const e=this.hot.view._wt.selectionManager.getBorderInstances(n);A(e,(e=>{e.changeBorderStyle(o,t)}))}return i=!0,!1}})),i}changeBorderSettings(){const t=this.hot.getSettings()[YA];if(Array.isArray(t)){const e=Co(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(t){const e=OA(t),o=PA(t);if(e&&o)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function JA(t){this.hot.getSettings()[YA]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(bg)},disabled(){const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||this.selection.isSelectedByCorner())},submenu:{items:[LA(this),DA(this),WA(this),VA(this),FA(this)]}})}function ZA(){this.changeBorderSettings()}function tO(t,e){eO(t,e),e.add(t)}function eO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oO(t,e,o){return e=nO(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function nO(t){var e=iO(t,"string");return"symbol"==typeof e?e:String(e)}function iO(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function rO(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const sO="dragToScroll",lO=100;var aO=new WeakSet;class hO extends _S{constructor(){super(...arguments),tO(this,aO),oO(this,"boundaries",null),oO(this,"callback",null),oO(this,"listening",!1)}static get PLUGIN_KEY(){return sO}static get PLUGIN_PRIORITY(){return lO}isEnabled(){return!!this.hot.getSettings()[sO]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",(t=>rO(this,aO,cO).call(this,t))),this.addHook("afterOnCellCornerMouseDown",(t=>rO(this,aO,cO).call(this,t))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=t}setCallback(t){this.callback=t}check(t,e){let o=0,n=0;e<this.boundaries.top?n=e-this.boundaries.top:e>this.boundaries.bottom&&(n=e-this.boundaries.bottom),t<this.boundaries.left?o=t-this.boundaries.left:t>this.boundaries.right&&(o=t-this.boundaries.right),this.callback(o,n)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:t}=this.hot;let e=t;while(e)this.eventManager.addEventListener(e.document,"contextmenu",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mouseup",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mousemove",(t=>this.onMouseMove(t))),e=oe(e)}unregisterEvents(){this.eventManager.clear()}onMouseMove(t){this.isListening()&&this.check(t.clientX,t.clientY)}destroy(){super.destroy()}}function cO(t){if(un(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback(((t,o)=>{var n,i;const r=null!==(n=e.scrollLeft)&&void 0!==n?n:e.scrollX,s=null!==(i=e.scrollTop)&&void 0!==i?i:e.scrollY;e.scroll(r+50*Math.sign(t),s+20*Math.sign(o))})),this.listen()}function uO(t,e){dO(t,e),e.add(t)}function dO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gO(t,e,o){return e=fO(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function fO(t){var e=mO(t,"string");return"symbol"==typeof e?e:String(e)}function mO(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function pO(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}Mn.getSingleton().register("afterDropdownMenuDefaultOptions"),Mn.getSingleton().register("beforeDropdownMenuShow"),Mn.getSingleton().register("afterDropdownMenuShow"),Mn.getSingleton().register("afterDropdownMenuHide"),Mn.getSingleton().register("afterDropdownMenuExecute");const wO="dropdownMenu",vO=230,CO="changeType",yO=wO;var bO=new WeakSet,SO=new WeakSet,RO=new WeakSet,EO=new WeakSet,TO=new WeakSet,MO=new WeakSet,HO=new WeakSet;class xO extends _S{static get PLUGIN_KEY(){return wO}static get PLUGIN_PRIORITY(){return vO}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[gx,mx,QM,bx,QM,ux,QM,wx,QM,hx]}constructor(t){super(t),uO(this,HO),uO(this,MO),uO(this,TO),uO(this,EO),uO(this,RO),uO(this,SO),uO(this,bO),gO(this,"commandExecutor",new lx(this.hot)),gO(this,"itemsFactory",null),gO(this,"menu",null),this.hot.addHook("afterGetColHeader",((t,e)=>pO(this,RO,AO).call(this,t,e)))}isEnabled(){return this.hot.getSettings()[wO]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new Vx(this.hot,xO.DEFAULT_ITEMS);const e=this.hot.getSettings()[wO],o={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"===typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady((()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",o),this.itemsFactory.setPredefinedItems(o.items);const n=this.itemsFactory.getItems(e);this.menu&&this.menu.destroy(),this.menu=new Wk(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",n),this.menu.setMenuItems(n),this.menu.addLocalHook("beforeOpen",(()=>pO(this,EO,OO).call(this))),this.menu.addLocalHook("afterOpen",(()=>pO(this,TO,PO).call(this))),this.menu.addLocalHook("afterSubmenuOpen",(t=>pO(this,MO,NO).call(this,t))),this.menu.addLocalHook("afterClose",(()=>pO(this,HO,_O).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.executeCommand.call(t,...o)})),A(n,(t=>this.commandExecutor.registerCommand(t.key,t)))}))}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("grid"),e=()=>{const{highlight:t}=this.hot.getSelectedRangeLast();if((t.isHeader()&&-1===t.row||t.isCell())&&t.col>=0){this.hot.selectColumns(t.col,t.col,-1);const{from:e}=this.hot.getSelectedRangeLast(),o=aH(this.menu.container,this.hot.rootDocument),n=this.hot.getCell(-1,e.col,!0),i=n.getBoundingClientRect();this.open({left:i.left+o.left,top:i.top+n.offsetHeight+o.top},{left:i.width}),this.menu.getNavigator().toFirstItem()}};t.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:yO},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isCell()&&!this.menu.isOpened()},group:yO}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yO)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",(t=>pO(this,SO,IO).call(this,t)))}open(t){var e;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.menu.open(),To(o,((t,e)=>{this.menu.setOffset(e,t)})),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close()}executeCommand(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];this.commandExecutor.execute(t,...o)}setListening(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function kO(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function IO(t){if(t.stopPropagation(),ue(t.target,CO)){const e=aH(this.menu.container,this.hot.rootDocument),o=t.target.getBoundingClientRect();this.open({left:o.left+e.left,top:o.top+t.target.offsetHeight+3+e.top},{left:o.width})}}function AO(t,e){const o=e.parentNode;if(!o)return;const n=o.parentNode.childNodes,i=Array.prototype.indexOf.call(n,o);if(t<0||i!==n.length-1)return;const r=e.querySelector(`.${CO}`);if(this.enabled&&r)return;if(!this.enabled)return void(r&&r.parentNode.removeChild(r));const s=this.hot.rootDocument.createElement("button");s.className=CO,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(fe(s,[Ot(),At(" ")]),fe(e,[_t("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function OO(){this.hot.runHooks("beforeDropdownMenuShow",this)}function PO(){this.hot.runHooks("afterDropdownMenuShow",this),pO(this,bO,kO).call(this,this.menu)}function NO(t){pO(this,bO,kO).call(this,t)}function _O(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function LO(t,e,o){return e=DO(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function DO(t){var e=WO(t,"string");return"symbol"==typeof e?e:String(e)}function WO(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}xO.SEPARATOR={name:QM};class VO{constructor(t){LO(this,"hot",void 0),LO(this,"options",{}),this.hot=t}setOptions(t){this.options=t}getData(){const{startRow:t,startCol:e,endRow:o,endCol:n}=this._getDataRange(),i=this.options,r=[];return Vi(t,o,(t=>{const o=[];!i.exportHiddenRows&&this._isHiddenRow(t)||(Vi(e,n,(e=>{!i.exportHiddenColumns&&this._isHiddenColumn(e)||o.push(this.hot.getDataAtCell(t,e))})),r.push(o))})),r}getRowHeaders(){const t=[];if(this.options.rowHeaders){const{startRow:e,endRow:o}=this._getDataRange(),n=this.hot.getRowHeader();Vi(e,o,(e=>{!this.options.exportHiddenRows&&this._isHiddenRow(e)||t.push(n[e])}))}return t}getColumnHeaders(){const t=[];if(this.options.columnHeaders){const{startCol:e,endCol:o}=this._getDataRange(),n=this.hot.getColHeader();Vi(e,o,(e=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(e)||t.push(n[e])}))}return t}_getDataRange(){const t=this.hot.countCols()-1,e=this.hot.countRows()-1;let[o=0,n=0,i=e,r=t]=this.options.range;return o=Math.max(o,0),n=Math.max(n,0),i=Math.min(i,e),r=Math.min(r,t),{startRow:o,startCol:n,endRow:i,endCol:r}}_isHiddenRow(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}_isHiddenColumn(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}}var FO=VO;function jO(t,e,o){return e=BO(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function BO(t){var e=zO(t,"string");return"symbol"==typeof e?e:String(e)}function zO(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class UO{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(t,e){jO(this,"dataProvider",void 0),jO(this,"options",void 0),this.dataProvider=t,this.options=this._mergeOptions(e),this.dataProvider.setOptions(this.options)}_mergeOptions(t){let e=yo(this.constructor.DEFAULT_OPTIONS);const o=new Date;return e=wo(yo(UO.DEFAULT_OPTIONS),e),e=wo(e,t),e.filename=ut(e.filename,{YYYY:o.getFullYear(),MM:`${o.getMonth()+1}`.padStart(2,"0"),DD:`${o.getDate()}`.padStart(2,"0")}),e}}var $O=UO;const GO=String.fromCharCode(13),YO=String.fromCharCode(34),KO=String.fromCharCode(10);class XO extends $O{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const t=this.options,e=this.dataProvider.getData();let o=this.dataProvider.getColumnHeaders();const n=o.length>0,i=this.dataProvider.getRowHeaders(),r=i.length>0;let s=t.bom?String.fromCharCode(65279):"";return n&&(o=I(o,(t=>this._escapeCell(t,!0))),r&&(s+=t.columnDelimiter),s+=o.join(t.columnDelimiter),s+=t.rowDelimiter),A(e,((e,o)=>{o>0&&(s+=t.rowDelimiter),r&&(s+=this._escapeCell(i[o])+t.columnDelimiter),s+=e.map((t=>this._escapeCell(t))).join(t.columnDelimiter)})),s}_escapeCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=z(t);return""!==o&&(e||o.indexOf(GO)>=0||o.indexOf(YO)>=0||o.indexOf(KO)>=0||o.indexOf(this.options.columnDelimiter)>=0)&&(o=o.replace(new RegExp('"',"g"),'""'),o=`"${o}"`),o}}var qO=XO;const QO="csv",JO={[QO]:qO};function ZO(t,e,o){return"function"===typeof JO[t]?new JO[t](e,o):null}const tP="exportFile",eP=240;class oP extends _S{static get PLUGIN_KEY(){return tP}static get PLUGIN_PRIORITY(){return eP}isEnabled(){return!0}exportAsString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}exportAsBlob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}downloadFile(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:o,rootWindow:n}=this.hot,i=this._createTypeFormatter(t,e),r=this._createBlob(i),s=n.URL||n.webkitURL,l=o.createElement("a"),a=`${i.options.filename}.${i.options.fileExtension}`;if(void 0!==l.download){const t=s.createObjectURL(r);l.style.display="none",l.setAttribute("href",t),l.setAttribute("download",a),o.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),o.body.removeChild(l),setTimeout((()=>{s.revokeObjectURL(t)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(r,a)}_createTypeFormatter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!JO[t])throw new Error(`Export format type "${t}" is not supported.`);return ZO(t,new FO(this.hot),e)}_createBlob(t){let e=null;return"undefined"!==typeof Blob&&(e=new Blob([t.export()],{type:`${t.options.mimeType};charset=${t.options.encoding}`})),e}}function nP(t,e,o){return e=iP(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function iP(t){var e=rP(t,"string");return"symbol"==typeof e?e:String(e)}function rP(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class sP{constructor(t,e){let{id:o,stateless:n=!0}=e;nP(this,"hot",void 0),nP(this,"id",void 0),nP(this,"elements",[]),nP(this,"hidden",!1),nP(this,"stateId",""),nP(this,"state",void 0),this.hot=t,this.id=o,this.stateId=`Filters.component.${this.id}`,this.state=n?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Gu)}getElements(){return this.elements}reset(){A(this.elements,(t=>t.reset()))}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(t){this.state&&this.setState(this.state.getValueAtIndex(t))}setState(){throw new Error("The state setting logic is not implemented")}saveState(t){this.state&&this.state.setValueAtIndex(t,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),A(this.elements,(t=>t.destroy())),this.state=null,this.elements=null,this.hot=null}}bo(sP,ku);const lP={};function aP(t,e){if(!lP[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:o,descriptor:n}=lP[t];let i=e;return n.inputValuesDecorator&&(i=n.inputValuesDecorator(i)),function(t){return o.apply(t.meta.instance,[].concat([t],[i]))}}function hP(t){if(!lP[t])throw Error(`Filter condition "${t}" does not exist.`);return lP[t].descriptor}function cP(t,e,o){o.key=t,lP[t]={condition:e,descriptor:o}}const uP="none";function dP(){return!0}cP(uP,dP,{name:_g,inputsCount:0,showOperators:!1});const gP="empty";function fP(t){return G(t.value)}cP(gP,fP,{name:Lg,inputsCount:0,showOperators:!0});const mP="not_empty";function pP(t,e){return!aP(gP,e)(t)}cP(mP,pP,{name:Dg,inputsCount:0,showOperators:!0});const wP="eq";function vP(t,e){let[o]=e;return z(t.value).toLocaleLowerCase(t.meta.locale)===z(o)}cP(wP,vP,{name:Wg,inputsCount:1,showOperators:!0});const CP="neq";function yP(t,e){return!aP(wP,e)(t)}cP(CP,yP,{name:Vg,inputsCount:1,showOperators:!0});const bP="gt";function SP(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>n}cP(bP,SP,{name:$g,inputsCount:1,showOperators:!0});const RP="gte";function EP(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>=n}cP(RP,EP,{name:Gg,inputsCount:1,showOperators:!0});const TP="lt";function MP(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<n}cP(TP,MP,{name:Yg,inputsCount:1,showOperators:!0});const HP="lte";function xP(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<=n}cP(HP,xP,{name:Kg,inputsCount:1,showOperators:!0});const kP="date_after";function IP(t,e){let[o]=e;const n=E(t.value,t.meta.dateFormat),i=E(o,t.meta.dateFormat);return!(!n.isValid()||!i.isValid())&&n.diff(i)>=0}cP(kP,IP,{name:Qg,inputsCount:1,showOperators:!0});const AP="date_before";function OP(t,e){let[o]=e;const n=E(t.value,t.meta.dateFormat),i=E(o,t.meta.dateFormat);return!(!n.isValid()||!i.isValid())&&n.diff(i)<=0}cP(AP,OP,{name:Jg,inputsCount:1,showOperators:!0});const PP="between";function NP(t,e){let[o,n]=e,i=o,r=n;if("numeric"===t.meta.type){const t=parseFloat(i,10),e=parseFloat(r,10);i=Math.min(t,e),r=Math.max(t,e)}else if("date"===t.meta.type){const e=aP(AP,[r]),o=aP(kP,[i]);return e(t)&&o(t)}return t.value>=i&&t.value<=r}cP(PP,NP,{name:Xg,inputsCount:2,showOperators:!0});const _P="not_between";function LP(t,e){return!aP(PP,e)(t)}cP(_P,LP,{name:qg,inputsCount:2,showOperators:!0});const DP="begins_with";function WP(t,e){let[o]=e;return z(t.value).toLocaleLowerCase(t.meta.locale).startsWith(z(o))}cP(DP,WP,{name:Fg,inputsCount:1,showOperators:!0});const VP="ends_with";function FP(t,e){let[o]=e;return z(t.value).toLocaleLowerCase(t.meta.locale).endsWith(z(o))}cP(VP,FP,{name:jg,inputsCount:1,showOperators:!0});const jP="contains";function BP(t,e){let[o]=e;return z(t.value).toLocaleLowerCase(t.meta.locale).indexOf(z(o))>=0}cP(jP,BP,{name:Bg,inputsCount:1,showOperators:!0});const zP="not_contains";function UP(t,e){return!aP(jP,e)(t)}cP(zP,UP,{name:zg,inputsCount:1,showOperators:!0});const $P="date_tomorrow";function GP(t){const e=E(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(E().subtract(-1,"days").startOf("day"),"d")}cP($P,GP,{name:tf,inputsCount:0});const YP="date_today";function KP(t){const e=E(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(E().startOf("day"),"d")}cP(YP,KP,{name:Zg,inputsCount:0});const XP="date_yesterday";function qP(t){const e=E(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(E().subtract(1,"days").startOf("day"),"d")}cP(XP,qP,{name:ef,inputsCount:0});const QP="numeric",JP="text",ZP="date",tN={[QP]:[uP,QM,gP,mP,QM,wP,CP,QM,bP,RP,TP,HP,PP,_P],[JP]:[uP,QM,gP,mP,QM,wP,CP,QM,DP,VP,QM,jP,zP],[ZP]:[uP,QM,gP,mP,QM,wP,CP,QM,AP,kP,PP,QM,$P,YP,XP]};function eN(t){const e=[];let o=t;return tN[o]||(o=JP),A(tN[o],(t=>{let o;o=t===QM?{name:QM}:yo(hP(t)),e.push(o)})),e}function oN(t,e,o){return e=nN(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function nN(t){var e=iN(t,"string");return"symbol"==typeof e?e:String(e)}function iN(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const rN="built",sN="building",lN=["click","input","keydown","keypress","keyup","focus","blur","change"];class aN{static get DEFAULTS(){return yo({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,e){oN(this,"hot",void 0),oN(this,"eventManager",new $n(this)),oN(this,"options",void 0),oN(this,"_element",void 0),oN(this,"buildState",void 0),this.hot=t,this.options=wo(aN.DEFAULTS,e),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===sN?this._element:this.buildState===rN?(this.update(),this._element):(this.buildState=sN,this.build(),this.buildState=rN,this._element)}isBuilt(){return this.buildState===rN}translateIfPossible(t){return"string"===typeof t&&t.startsWith(Pg)?this.hot.getTranslatedPhrase(t):t}build(){const t=(t,e)=>{this.eventManager.addEventListener(t,e,(t=>this.runLocalHooks(e,t,this)))};if(this.buildState||(this.buildState=sN),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&de(this._element,this.options.className),this.options.children.length)A(this.options.children,(t=>this._element.appendChild(t.element)));else if(this.options.wrapIt){const e=this.hot.rootDocument.createElement(this.options.tagName);e.setAttribute("data-hot-input",!0),To(this.options,((t,o)=>{void 0!==e[o]&&"className"!==o&&"tagName"!==o&&"children"!==o&&(e[o]=this.translateIfPossible(t))})),this._element.appendChild(e),A(lN,(o=>t(e,o)))}else A(lN,(e=>t(this._element,e)))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function hN(t,e){uN(t,e),e.add(t)}function cN(t,e,o){uN(t,e),e.set(t,o)}function uN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dN(t,e){var o=mN(t,e,"get");return gN(t,o)}function gN(t,e){return e.get?e.get.call(t):e.value}function fN(t,e,o){var n=mN(t,e,"set");return pN(t,n,o),o}function mN(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function pN(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function wN(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}bo(aN,ku);var vN=new WeakMap,CN=new WeakSet;class yN extends aN{static get DEFAULTS(){return yo({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,e){super(t,wo(yN.DEFAULTS,e)),hN(this,CN),cN(this,vN,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",(t=>wN(this,CN,bN).call(this,t)))}build(){super.build();const t=this.hot.rootDocument.createElement("div");fN(this,vN,this._element.firstChild),de(this._element,"htUIInput"),de(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(dN(this,vN).type=this.options.type,dN(this,vN).placeholder=this.translateIfPossible(this.options.placeholder),dN(this,vN).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&dN(this,vN).focus()}}function bN(t){this.options.value=t.target.value}function SN(t,e){EN(t,e),e.add(t)}function RN(t,e,o){EN(t,e),e.set(t,o)}function EN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TN(t,e,o){var n=kN(t,e,"set");return MN(t,n,o),o}function MN(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function HN(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function xN(t,e){var o=kN(t,e,"get");return IN(t,o)}function kN(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function IN(t,e){return e.get?e.get.call(t):e.value}var AN=new WeakMap,ON=new WeakMap,PN=new WeakMap,NN=new WeakMap,_N=new WeakMap,LN=new WeakSet,DN=new WeakSet,WN=new WeakSet;class VN extends aN{static get DEFAULTS(){return yo({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,e){super(t,wo(VN.DEFAULTS,e)),SN(this,WN),SN(this,DN),SN(this,LN),RN(this,AN,{writable:!0,value:null}),RN(this,ON,{writable:!0,value:[]}),RN(this,PN,{writable:!0,value:void 0}),RN(this,NN,{writable:!0,value:void 0}),RN(this,_N,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return xN(this,AN)}registerHooks(){this.addLocalHook("click",(()=>HN(this,WN,BN).call(this)))}setItems(t){TN(this,ON,this.translateNames(t)),xN(this,AN)&&xN(this,AN).setMenuItems(xN(this,ON))}translateNames(t){return A(t,(t=>{t.name=this.translateIfPossible(t.name)})),t}build(){super.build(),TN(this,AN,new Wk(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),xN(this,AN).setMenuItems(xN(this,ON));const t=new aN(this.hot,{className:"htUISelectCaption"}),e=new aN(this.hot,{className:"htUISelectDropdown"});TN(this,PN,t),TN(this,NN,t.element),TN(this,_N,e),this.hot.getSettings().ariaTags&&(fe(e.element,[Ot()]),fe(this._element,[Tt()])),A([t,e],(t=>this._element.appendChild(t.element))),xN(this,AN).addLocalHook("select",(t=>HN(this,LN,FN).call(this,t))),xN(this,AN).addLocalHook("afterClose",(()=>HN(this,DN,jN).call(this))),this.update()}update(){if(!this.isBuilt())return;let t;t=this.options.value?this.options.value.name:xN(this,AN).hot.getTranslatedPhrase(_g),xN(this,NN).textContent=t,super.update()}openOptions(){const t=this.element.getBoundingClientRect();xN(this,AN)&&(xN(this,AN).open(),xN(this,AN).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),xN(this,AN).getNavigator().toFirstItem(),xN(this,AN).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){xN(this,AN)&&xN(this,AN).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){xN(this,AN)&&(xN(this,AN).destroy(),TN(this,AN,null)),xN(this,PN)&&xN(this,PN).destroy(),xN(this,_N)&&xN(this,_N).destroy(),super.destroy()}}function FN(t){t.name!==QM&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function jN(){this.runLocalHooks("afterClose")}function BN(){this.openOptions()}function zN(t,e){UN(t,e),e.add(t)}function UN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $N(t,e,o){return e=GN(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function GN(t){var e=YN(t,"string");return"symbol"==typeof e?e:String(e)}function YN(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function KN(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}var XN=new WeakSet,qN=new WeakSet;class QN extends sP{constructor(t,e){super(t,{id:e.id,stateless:!1}),zN(this,qN),zN(this,XN),$N(this,"name",""),$N(this,"addSeparator",!1),this.name=e.name,this.addSeparator=e.addSeparator,this.elements.push(new VN(this.hot,{menuContainer:e.menuContainer})),this.elements.push(new yN(this.hot,{placeholder:gf})),this.elements.push(new yN(this.hot,{placeholder:ff})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",(t=>KN(this,XN,JN).call(this,t))).addLocalHook("afterClose",(()=>this.runLocalHooks("afterClose"))).addLocalHook("tabKeydown",(t=>this.runLocalHooks("selectTabKeydown",t))),A(this.getInputElements(),(t=>{t.addLocalHook("keydown",(t=>KN(this,qN,ZN).call(this,t)))}))}setState(t){if(this.reset(),!t)return;const e=yo(t.command);e.name.startsWith(Ng)&&(e.name=this.hot.getTranslatedPhrase(e.name)),this.getSelectElement().setValue(e),A(t.args,((t,o)=>{if(o>e.inputsCount-1)return!1;const n=this.getInputElement(o);n.setValue(t),n[e.inputsCount>o?"show":"hide"](),o||this.hot._registerTimeout((()=>n.focus()),10)}))}getState(){const t=this.getSelectElement().getValue()||hP(uP),e=[];return A(this.getInputElements(),((o,n)=>{t.inputsCount>n&&e.push(o.getValue())})),{command:t,args:e}}updateState(t,e){const o=hP(t?t.name:uP);this.state.setValueAtIndex(e,{command:o,args:t?t.args:[]}),t||A(this.getInputElements(),(t=>t.setValue(null)))}getSelectElement(){return this.elements.filter((t=>t instanceof VN))[0]}getInputElement(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}getInputElements(){return this.elements.filter((t=>t instanceof yN))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,o,n,i,r)=>{de(e.parentNode,"htFiltersMenuCondition"),this.addSeparator&&de(e.parentNode,"border");const s=this.hot.rootDocument.createElement("div");return de(s,"htFiltersMenuLabel"),s.textContent=r,e.appendChild(s),A(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getPlugin("filters").getSelectedColumn();let e=[hP(uP)];if(null!==t){const{visualIndex:o}=t;e=eN(this.hot.getDataType(0,o,this.hot.countRows(),o))}A(this.getInputElements(),(t=>t.hide())),this.getSelectElement().setItems(e),super.reset(),this.getSelectElement().setValue(e[0])}}function JN(t){A(this.getInputElements(),((e,o)=>{e[t.inputsCount>o?"show":"hide"](),0===o&&this.hot._registerTimeout((()=>e.focus()),10)})),this.runLocalHooks("change",t)}function ZN(t){an(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),hn(t))}const t_={};function e_(t){if(!t_[t])throw Error(`Operation with id "${t}" does not exist.`);const e=t_[t].func;return function(t,o){return e(t,o)}}function o_(t){return t_[t].name}function n_(t,e,o){t_[t]={name:e,func:o}}const i_="conjunction",r_=rf;function s_(t,e){return t.every((t=>t.func(e)))}n_(i_,r_,s_);const l_="disjunction",a_=sf;function h_(t,e){return t.some((t=>t.func(e)))}n_(l_,a_,h_);const c_="disjunctionWithExtraCondition",u_=sf;function d_(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some((t=>t.func(e)))&&t[t.length-1].func(e)}function g_(t,e,o){f_(t,e),e.set(t,o)}function f_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function m_(t,e){var o=v_(t,e,"get");return p_(t,o)}function p_(t,e){return e.get?e.get.call(t):e.value}function w_(t,e,o){var n=v_(t,e,"set");return C_(t,n,o),o}function v_(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function C_(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}n_(c_,u_,d_);var y_=new WeakMap,b_=new WeakMap;class S_ extends aN{static get DEFAULTS(){return yo({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,e){super(t,wo(S_.DEFAULTS,e)),g_(this,y_,{writable:!0,value:void 0}),g_(this,b_,{writable:!0,value:void 0})}build(){super.build();const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),w_(this,b_,t),w_(this,y_,this._element.firstChild),m_(this,y_).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(m_(this,b_).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&m_(this,y_).checked}setChecked(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(m_(this,y_).checked=t)}focus(){this.isBuilt()&&m_(this,y_).focus()}}function R_(t,e){E_(t,e),e.add(t)}function E_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function T_(t,e,o){return e=M_(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function M_(t){var e=H_(t,"string");return"symbol"==typeof e?e:String(e)}function H_(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function x_(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const k_=0;var I_=new WeakSet;class A_ extends sP{constructor(t,e){super(t,{id:e.id,stateless:!1}),R_(this,I_),T_(this,"name",""),this.name=e.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(de(e.parentNode,"htFiltersMenuOperators"),A(this.elements,(t=>e.appendChild(t.element))),e)}}buildOperatorsElement(){const t=[i_,l_];A(t,(e=>{const o=new S_(this.hot,{name:"operator",label:{htmlFor:e,textContent:o_(e)},value:e,checked:e===t[k_],id:e});o.addLocalHook("change",(t=>x_(this,I_,O_).call(this,t))),this.elements.push(o)}))}setChecked(t){if(this.elements.length<t)throw Error(B`Radio button with index ${t} doesn't exist.`);A(this.elements,((e,o)=>{e.setChecked(o===t)}))}getActiveOperationId(){const t=this.elements.find((t=>t instanceof S_&&t.isChecked()));return t?t.getValue():i_}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&A(this.elements,(e=>{e.setChecked(e.getValue()===t)}))}updateState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i_,e=arguments.length>1?arguments[1]:void 0,o=t;o===c_&&(o=l_),this.state.setValueAtIndex(e,o)}reset(){this.setChecked(k_)}}function O_(t){this.setState(t.target.value)}Lo();function P_(t,e){let o=t;return""===o&&(o=`(${e})`),o}const N_=new Set([1]).has(1),__=N_&&"function"===typeof Array.from;function L_(t){let e=t;return N_&&(e=new Set(e)),function(t){let o;return o=N_?e.has(t):!!~e.indexOf(t),o}}function D_(t){return null===t||void 0===t?"":t}function W_(t){let e=t;return e=__?Array.from(new Set(e)):D(e),e=e.sort(((t,e)=>"number"===typeof t&&"number"===typeof e?t-e:t===e?0:t>e?1:-1)),e}function V_(t,e,o,n){const i=[],r=t===e;let s;return r||(s=L_(e)),A(t,(t=>{let e=!1;(r||s(t))&&(e=!0);const l={checked:e,value:t,visualValue:P_(t,o)};n&&n(l),i.push(l)})),i}function F_(t,e,o){j_(t,e),e.set(t,o)}function j_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function B_(t,e){var o=$_(t,e,"get");return z_(t,o)}function z_(t,e){return e.get?e.get.call(t):e.value}function U_(t,e,o){var n=$_(t,e,"set");return G_(t,n,o),o}function $_(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function G_(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var Y_=new WeakMap;class K_ extends aN{static get DEFAULTS(){return yo({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,e){super(t,wo(K_.DEFAULTS,e)),F_(this,Y_,{writable:!0,value:void 0})}build(){super.build(),U_(this,Y_,this._element.firstChild)}update(){this.isBuilt()&&(B_(this,Y_).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&B_(this,Y_).focus()}activate(){B_(this,Y_).click()}}function X_(t,e){Q_(t,e),e.add(t)}function q_(t,e,o){Q_(t,e),e.set(t,o)}function Q_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function J_(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function Z_(t,e){var o=oL(t,e,"get");return tL(t,o)}function tL(t,e){return e.get?e.get.call(t):e.value}function eL(t,e,o){var n=oL(t,e,"set");return nL(t,n,o),o}function oL(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function nL(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const iL="multipleSelect.itemBox";var rL=new WeakMap,sL=new WeakMap,lL=new WeakMap,aL=new WeakMap,hL=new WeakMap,cL=new WeakMap,uL=new WeakSet,dL=new WeakSet,gL=new WeakSet,fL=new WeakSet;class mL extends aN{static get DEFAULTS(){return yo({className:"htUIMultipleSelect",value:[]})}constructor(t,e){super(t,wo(mL.DEFAULTS,e)),X_(this,fL),X_(this,gL),X_(this,dL),X_(this,uL),q_(this,rL,{writable:!0,value:[]}),q_(this,sL,{writable:!0,value:void 0}),q_(this,lL,{writable:!0,value:void 0}),q_(this,aL,{writable:!0,value:void 0}),q_(this,hL,{writable:!0,value:void 0}),q_(this,cL,{writable:!0,value:void 0}),eL(this,aL,new yN(this.hot,{placeholder:df,className:"htUIMultipleSelectSearch"})),eL(this,hL,new K_(this.hot,{textContent:af,className:"htUISelectAll"})),eL(this,cL,new K_(this.hot,{textContent:hf,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Z_(this,sL)}registerHooks(){Z_(this,aL).addLocalHook("keydown",(t=>J_(this,dL,wL).call(this,t))),Z_(this,aL).addLocalHook("input",(t=>J_(this,uL,pL).call(this,t))),Z_(this,hL).addLocalHook("click",(t=>J_(this,gL,vL).call(this,t))),Z_(this,cL).addLocalHook("click",(t=>J_(this,fL,CL).call(this,t)))}setItems(t){eL(this,rL,t),Z_(this,sL)&&Z_(this,sL).loadData(Z_(this,rL))}setLocale(t){eL(this,lL,t)}getLocale(){return Z_(this,lL)}getItems(){return[...Z_(this,rL)]}getValue(){return bL(Z_(this,rL))}getSearchInputElement(){return Z_(this,aL)}getSelectAllElement(){return Z_(this,hL)}getClearAllElement(){return Z_(this,cL)}isSelectedAllValues(){return Z_(this,rL).length===this.getValue().length}build(){super.build();const{rootDocument:t}=this.hot,e=t.createElement("div"),o=new aN(this.hot,{className:"htUISelectionControls",children:[Z_(this,hL),Z_(this,cL)]});this._element.appendChild(Z_(this,aL).element),this._element.appendChild(o.element),this._element.appendChild(e);const n=e=>{if(!this._element)return;Z_(this,sL)&&Z_(this,sL).destroy(),de(e,"htUIMultipleSelectHot"),eL(this,sL,new this.hot.constructor(e,{data:Z_(this,rL),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(t,e,o,n,i,r)=>{t.title=r.instance.getDataAtRowProp(e,r.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Z_(this,sL).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>Z_(this,sL).container.scrollWidth-$e(t),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Z_(this,sL).init();const o=Z_(this,sL).getShortcutManager(),n=o.getContext("grid");n.removeShortcutsByKeys(["Tab"]),n.removeShortcutsByKeys(["Shift","Tab"]),n.addShortcut({keys:[["Escape"]],callback:t=>{this.runLocalHooks("keydown",t,this)},group:iL}),n.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:t=>{Z_(this,sL).deselectCell(),this.runLocalHooks("keydown",t,this),this.runLocalHooks("listTabKeydown",t,this)},group:iL})};n(e),this.hot._registerTimeout((()=>n(e)),100)}focus(){this.isBuilt()&&Z_(this,sL).listen()}reset(){Z_(this,aL).reset(),Z_(this,hL).reset(),Z_(this,cL).reset()}update(){this.isBuilt()&&(Z_(this,sL).loadData(yL(Z_(this,rL),this.options.value)),super.update())}destroy(){Z_(this,sL)&&Z_(this,sL).destroy(),Z_(this,aL).destroy(),Z_(this,cL).destroy(),Z_(this,hL).destroy(),eL(this,aL,null),eL(this,cL,null),eL(this,hL,null),eL(this,sL,null),eL(this,rL,null),super.destroy()}}function pL(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let o;o=""===e?[...Z_(this,rL)]:k(Z_(this,rL),(t=>`${t.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0)),Z_(this,sL).loadData(o)}function wL(t){this.runLocalHooks("keydown",t,this);const e=co(an,t.keyCode);e("ARROW_DOWN")&&(t.preventDefault(),hn(t),Z_(this,sL).listen(),Z_(this,sL).selectCell(0,0))}function vL(t){const e=[];t.preventDefault(),A(Z_(this,sL).getSourceData(),((t,o)=>{t.checked=!0,e.push(vu(t,o)[0])})),Z_(this,sL).setSourceDataAtCell(e)}function CL(t){const e=[];t.preventDefault(),A(Z_(this,sL).getSourceData(),((t,o)=>{t.checked=!1,e.push(vu(t,o)[0])})),Z_(this,sL).setSourceDataAtCell(e)}function yL(t,e){const o=L_(e);return I(t,(t=>(t.checked=o(t.value),t)))}function bL(t){const e=[];return A(t,(t=>{t.checked&&e.push(t.value)})),e}const SL="by_value";function RL(t,e){let[o]=e;return o(t.value)}function EL(t,e){TL(t,e),e.add(t)}function TL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ML(t,e,o){return e=HL(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function HL(t){var e=xL(t,"string");return"symbol"==typeof e?e:String(e)}function xL(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function kL(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}cP(SL,RL,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[L_(e)]},showOperators:!1});var IL,AL=new WeakSet;class OL extends sP{constructor(t,e){super(t,{id:e.id,stateless:!1}),EL(this,AL),ML(this,"name",""),this.name=e.name,this.elements.push(new mL(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",(t=>kL(this,AL,PL).call(this,t))).addLocalHook("listTabKeydown",(t=>this.runLocalHooks("listTabKeydown",t)))}getElements(){const t=this.getMultipleSelectElement();return[t.getSearchInputElement(),t.getSelectAllElement(),t.getClearAllElement(),this.getMultipleSelectElement()]}setState(t){if(this.reset(),t&&t.command.key===SL){const e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}getState(){const t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?uP:SL},args:[t.getValue()],itemsSnapshot:e}}updateState(t){const e=(e,o,n,i,r)=>{const[s]=k(o,(t=>t.name===SL)),l={},a=this.hot.getTranslatedPhrase(lf);if(s){const o=W_(I(i(e,r),(t=>t.value)));n&&(s.args[0]=n);const h=[],c=V_(o,s.args[0],a,(t=>{t.checked&&h.push(t.value)})),u=t.editedConditionStack.column;l.locale=this.hot.getCellMeta(0,u).locale,l.args=[h],l.command=hP(SL),l.itemsSnapshot=c}else l.args=[],l.command=hP(uP);this.state.setValueAtIndex(e,l)};e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter((t=>t instanceof mL))[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,o,n,i,r)=>{de(e.parentNode,"htFiltersMenuValue");const s=this.hot.rootDocument.createElement("div");return de(s,"htFiltersMenuLabel"),s.textContent=r,e.appendChild(s),A(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getTranslatedPhrase(lf),e=W_(this._getColumnVisibleValues()),o=V_(e,e,t);this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(e);const n=this.hot.getPlugin("filters").getSelectedColumn();null!==n&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,n.visualIndex).locale)}_getColumnVisibleValues(){const t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:I(this.hot.getDataAtCol(t.visualIndex),(t=>D_(t)))}}function PL(t){an(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),hn(t))}function NL(t,e){_L(t,e),e.add(t)}function _L(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LL(t,e,o){return e=DL(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function DL(t){var e=WL(t,"string");return"symbol"==typeof e?e:String(e)}function WL(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function VL(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}var FL=new WeakSet;class jL extends sP{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,e){super(t,{id:e.id,stateless:!0}),NL(this,FL),LL(this,"name",""),this.name=e.name,this.elements.push(new yN(this.hot,{type:"button",value:cf,className:"htUIButton htUIButtonOK",identifier:jL.BUTTON_OK})),this.elements.push(new yN(this.hot,{type:"button",value:uf,className:"htUIButton htUIButtonCancel",identifier:jL.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){A(this.elements,(t=>{t.addLocalHook("click",((t,e)=>VL(this,FL,BL).call(this,t,e)))}))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(de(e.parentNode,"htFiltersMenuActionBar"),A(this.elements,(t=>e.appendChild(t.element))),e)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function BL(t,e){e.options.identifier===IL.BUTTON_OK?this.accept():this.cancel()}function zL(t,e,o){return e=UL(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function UL(t){var e=$L(t,"string");return"symbol"==typeof e?e:String(e)}function $L(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}IL=jL;const GL="ConditionCollection.filteringStates";class YL{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];zL(this,"hot",void 0),zL(this,"isMapRegistrable",void 0),zL(this,"filteringStates",new Gu),this.hot=t,this.isMapRegistrable=e,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(GL,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(t,e){var o;const n=this.filteringStates.getValueAtIndex(e),i=null!==(o=null===n||void 0===n?void 0:n.conditions)&&void 0!==o?o:[],r=null===n||void 0===n?void 0:n.operation;return this.isMatchInConditions(i,t,r)}isMatchInConditions(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i_;return!t.length||e_(o)(t,e)}addCondition(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i_,n=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,t).locale,r=I(e.args,(t=>"string"===typeof t?t.toLocaleLowerCase(i):t)),s=e.name||e.command.key;this.runLocalHooks("beforeAdd",t);const l=this.getOperation(t);if(l){if(l!==o)throw Error(B`The column of index ${t} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if($(t_[o]))throw new Error(B`Unexpected operation named \`${o}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const a=this.getConditions(t);0===a.length?this.filteringStates.setValueAtIndex(t,{operation:o,conditions:[{name:s,args:r,func:aP(s,r)}]},n):a.push({name:s,args:r,func:aP(s,r)}),this.runLocalHooks("afterAdd",t)}getConditions(t){var e,o;return null!==(e=null===(o=this.filteringStates.getValueAtIndex(t))||void 0===o?void 0:o.conditions)&&void 0!==e?e:[]}getOperation(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map((t=>{let[e]=t;return e}))}getColumnStackPosition(t){return this.getFilteredColumns().indexOf(t)}exportAllConditions(){return x(this.filteringStates.getEntries(),((t,e)=>{let[o,{operation:n,conditions:i}]=e;return t.push({column:o,operation:n,conditions:I(i,(t=>{let{name:e,args:o}=t;return{name:e,args:o}}))}),t}),[])}importAllConditions(t){this.clean(),A(t,(t=>{A(t.conditions,(e=>this.addCondition(t.column,e)))}))}removeConditions(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(t,e){const o=this.getConditions(t);return e?o.some((t=>t.name===e)):o.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(GL),this.filteringStates=null,this.clearLocalHooks()}}bo(YL,ku);var KL=YL;function XL(t,e,o){return e=qL(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function qL(t){var e=QL(t,"string");return"symbol"==typeof e?e:String(e)}function QL(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class JL{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];XL(this,"conditionCollection",void 0),XL(this,"columnDataFactory",void 0),this.conditionCollection=t,this.columnDataFactory=e}filter(){let t=[];return A(this.conditionCollection.getFilteredColumns(),((e,o)=>{let n=this.columnDataFactory(e);o&&(n=this._getIntersectData(n,t)),t=this.filterByColumn(e,n)})),t}filterByColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=[];return A(e,(e=>{void 0!==e&&this.conditionCollection.isMatch(e,t)&&o.push(e)})),o}_getIntersectData(t,e){const o=[];return A(e,(e=>{const n=e.meta.visualRow;void 0!==t[n]&&(o[n]=t[n])})),o}}var ZL=JL;function tD(t,e){eD(t,e),e.add(t)}function eD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oD(t,e,o){return e=nD(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function nD(t){var e=iD(t,"string");return"symbol"==typeof e?e:String(e)}function iD(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function rD(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}var sD=new WeakSet,lD=new WeakSet,aD=new WeakSet;class hD{constructor(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];tD(this,aD),tD(this,lD),tD(this,sD),oD(this,"hot",void 0),oD(this,"conditionCollection",void 0),oD(this,"columnDataFactory",void 0),oD(this,"changes",[]),oD(this,"grouping",!1),oD(this,"latestEditedColumnPosition",-1),oD(this,"latestOrderStack",[]),this.hot=t,this.conditionCollection=e,this.columnDataFactory=o,this.conditionCollection.addLocalHook("beforeRemove",(t=>rD(this,sD,cD).call(this,t))),this.conditionCollection.addLocalHook("afterRemove",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("afterAdd",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("beforeClean",(()=>rD(this,lD,uD).call(this))),this.conditionCollection.addLocalHook("afterClean",(()=>rD(this,aD,dD).call(this)))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,A(this.changes,(t=>{this.updateStatesAtColumn(t)})),this.changes.length=0}updateStatesAtColumn(t,e){var o=this;if(this.grouping)return void(-1===this.changes.indexOf(t)&&this.changes.push(t));const n=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(t);-1===i&&(i=this.latestEditedColumnPosition);const r=n.slice(0,i),s=n.slice(i);s.length&&s[0].column===t&&s.shift();const l=uo((function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=new KL(o.hot,!1),r=[].concat(t,n);i.importAllConditions(r);const s=o.columnDataFactory(e);let l;l=i.isEmpty()?s:new ZL(i,(t=>o.columnDataFactory(t))).filter(),l=I(l,(t=>t.meta.visualRow));const a=L_(l);return i.destroy(),k(s,(t=>a(t.meta.visualRow)))}))(r),a=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:a},dependentConditionStacks:s,filteredRowsFactory:l,conditionArgsChange:e})}destroy(){this.clearLocalHooks(),To(this,((t,e)=>{this[e]=null}))}}function cD(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function uD(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function dD(){A(this.latestOrderStack,(t=>{this.updateStatesAtColumn(t)}))}bo(hD,ku);var gD=hD;function fD(t){const e=ik({initialPage:0,size:()=>t.length,onItemSelect:(e,o)=>{const n=t[e];return n instanceof mL?o:!(n.element&&!be(n.element))&&void n.focus()}});return e}const mD="filters";function pD(t,e){let o=-1;const n=fD(e),i=o=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(mD),n.setCurrentPage(e.indexOf(o))};function r(i){const r=t.getKeyboardShortcutsCtrl(),s=i.getKeyboardShortcutsCtrl();n.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:r.getContext(mD),callback:()=>{i.isSubMenu()&&i.close(),r.listen(mD)}}]),i.isSubMenu()||r.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{const i=t.getNavigator();i.getCurrentPage()>-1&&(o=i.getCurrentPage()),i.clear(),e.shiftKey?n.toPreviousItem():n.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:t=>{const o=e[n.getCurrentPage()];o instanceof VN&&(o.openOptions(),t.preventDefault()),o instanceof K_&&(o.activate(),t.preventDefault()),o instanceof aN||t.preventDefault()}}],mD)}function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(mD)}function l(){return o}return e.forEach((t=>{t instanceof aN&&(t.addLocalHook("click",i(t)),t.addLocalHook("focus",i(t)),t.addLocalHook("afterClose",i(t)))})),t.addLocalHook("afterSelectionChange",(t=>{t.key.startsWith("filter_")||n.clear()})),t.addLocalHook("afterSubmenuOpen",r),t.addLocalHook("afterOpen",r),{...n,listen:s,getLastMenuPage:l}}function wD(t,e){CD(t,e),e.add(t)}function vD(t,e,o){CD(t,e),e.set(t,o)}function CD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yD(t,e,o){return e=bD(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function bD(t){var e=SD(t,"string");return"symbol"==typeof e?e:String(e)}function SD(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function RD(t,e,o){var n=MD(t,e,"set");return ED(t,n,o),o}function ED(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function TD(t,e){var o=MD(t,e,"get");return HD(t,o)}function MD(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function HD(t,e){return e.get?e.get.call(t):e.value}function xD(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const kD="filters",ID=250,AD=kD;var OD=new WeakMap,PD=new WeakSet,ND=new WeakSet,_D=new WeakSet,LD=new WeakSet,DD=new WeakSet,WD=new WeakSet,VD=new WeakSet,FD=new WeakSet,jD=new WeakSet;class BD extends _S{static get PLUGIN_KEY(){return kD}static get PLUGIN_PRIORITY(){return ID}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(t){super(t),wD(this,jD),wD(this,FD),wD(this,VD),wD(this,WD),wD(this,DD),wD(this,LD),wD(this,_D),wD(this,ND),wD(this,PD),yD(this,"dropdownMenuPlugin",null),yD(this,"conditionCollection",null),yD(this,"conditionUpdateObserver",null),yD(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),yD(this,"filtersRowsMap",null),vD(this,OD,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",((t,e)=>xD(this,FD,qD).call(this,t,e)))}isEnabled(){return!!this.hot.getSettings()[kD]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Yu),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,e=t&&t.uiContainer||this.hot.rootDocument.body,o=t=>(t.addLocalHook("accept",(()=>xD(this,DD,YD).call(this,"accept"))),t.addLocalHook("cancel",(()=>xD(this,DD,YD).call(this,"cancel"))),t.addLocalHook("change",(e=>xD(this,WD,KD).call(this,t,e))),t),n=()=>`${this.hot.getTranslatedPhrase(of)}:`,i=()=>`${this.hot.getTranslatedPhrase(nf)}:`;if(!this.components.get("filter_by_condition")){const t=new QN(this.hot,{id:"filter_by_condition",name:n,addSeparator:!1,menuContainer:e});t.addLocalHook("afterClose",(()=>xD(this,VD,XD).call(this))),this.components.set("filter_by_condition",o(t))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new A_(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const t=new QN(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:e});t.addLocalHook("afterClose",(()=>xD(this,VD,XD).call(this))),this.components.set("filter_by_condition2",o(t))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",o(new OL(this.hot,{id:"filter_by_value",name:i}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",o(new jL(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new KL(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new gD(this.hot,this.conditionCollection,(t=>this.getDataMapAtColumn(t))),this.conditionUpdateObserver.addLocalHook("update",(t=>xD(this,jD,QD).call(this,t)))),this.components.forEach((t=>t.show())),this.addHook("afterDropdownMenuDefaultOptions",(t=>xD(this,LD,GD).call(this,t))),this.addHook("afterDropdownMenuShow",(()=>xD(this,ND,UD).call(this))),this.addHook("afterDropdownMenuHide",(()=>xD(this,_D,$D).call(this))),this.addHook("afterChange",(t=>xD(this,PD,zD).call(this,t))),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!TD(this,OD)&&this.dropdownMenuPlugin.enabled){const t=this.dropdownMenuPlugin.menu,e=[{focus:()=>{const e=t.getNavigator(),o=TD(this,OD).getLastMenuPage();t.focus(),o>0?e.setCurrentPage(o):e.toFirstItem()}},...Array.from(this.components).map((t=>{let[,e]=t;return e.getElements()})).flat()];RD(this,OD,pD(t,e));const o=t=>{TD(this,OD).listen(),t.preventDefault(),an(t.keyCode,"TAB")&&(t.shiftKey?TD(this,OD).toPreviousItem():TD(this,OD).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",o),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",o)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){var t;this.enabled&&(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(((t,e)=>{t.destroy(),this.components.set(e,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const t=this.hot.getSelected();this.clearConditions(),this.filter(),t&&this.hot.selectCells(t)},group:AD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(AD)}addCondition(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i_;const i=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(i,{command:{key:e},args:o},n)}removeConditions(t){const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}clearConditions(t){if(void 0===t)this.conditionCollection.clean();else{const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}filter(){const{navigableHeaders:t}=this.hot.getSettings(),e=this._createDataFilter(),o=!this.conditionCollection.isEmpty();let n=[];const i=this.conditionCollection.exportAllConditions(),r=this.hot.runHooks("beforeFilter",i);if(!1!==r)if(o){const o=[];this.hot.batchExecution((()=>{this.filtersRowsMap.clear(),n=I(e.filter(),(t=>t.meta.visualRow));const t=L_(n);Vi(this.hot.countSourceRows()-1,(e=>{t(e)||o.push(e)})),A(o,(t=>{this.filtersRowsMap.setValueAtIndex(t,!0)}))}),!0),t||n.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",i),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(t?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}getDataMapAtColumn(t){const e=this.hot.toVisualColumn(t),o=[];return A(this.hot.getSourceDataAtCol(e),((t,n)=>{var i;const{row:r,col:s,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:u,locale:d}=this.hot.getCellMeta(n,e),g=null!==(i=this.hot.getDataAtCell(this.hot.toVisualRow(n),e))&&void 0!==i?i:t;o.push({meta:{row:r,col:s,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:u,locale:d},value:D_(g)})})),o}updateValueComponentCondition(t){const e=this.hot.getDataAtCol(t),o=W_(e);this.conditionUpdateObserver.updateStatesAtColumn(t,o)}restoreComponents(t){var e;const o=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach((t=>{t.isHidden()||t.restoreState(o)})),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(t,e,o,n){let i=t;return i===l_&&e.command.key!==uP&&o.command.key!==uP&&n.command.key!==uP?i=c_:n.command.key!==uP&&(e.command.key!==uP&&o.command.key!==uP||(i=i_)),i}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const t=this.components.get("filter_by_condition"),{command:e}=t.getState(),o=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...o):this.hideComponents(...o)}_createDataFilter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new ZL(t,(t=>this.getDataMapAtColumn(t)))}getIndexesOfComponents(){const t=[];if(!this.dropdownMenuPlugin)return t;const e=this.dropdownMenuPlugin.menu;for(var o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return A(n,(o=>{A(e.menuItems,((e,n)=>{e.key===o.getMenuItemDescriptor().key&&t.push(n)}))})),t}changeComponentsVisibility(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const e=this.dropdownMenuPlugin.menu,o=e.hotMenu,n=o.getPlugin("hiddenRows");for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];const l=this.getIndexesOfComponents(...r);t?n.showRows(l):n.hideRows(l),o.render()}hideComponents(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.changeComponentsVisibility(!1,...e)}showComponents(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.changeComponentsVisibility(!0,...e)}destroy(){this.enabled&&(this.components.forEach(((t,e)=>{null!==t&&(t.destroy(),this.components.set(e,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function zD(t){t&&A(t,(t=>{const[,e]=t,o=this.hot.propToCol(e);this.conditionCollection.hasConditions(o)&&this.updateValueComponentCondition(o)}))}function UD(){this.restoreComponents(Array.from(this.components.values()))}function $D(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function GD(t){t.items.push({name:QM}),this.components.forEach((e=>{t.items.push(e.getMenuItemDescriptor())}))}function YD(t){var e;if("accept"===t){const t=this.getSelectedColumn();var o;if(null===t)return void(null===(o=this.dropdownMenuPlugin)||void 0===o||o.close());const{physicalIndex:e}=t,n=this.components.get("filter_by_condition").getState(),i=this.components.get("filter_by_condition2").getState(),r=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),n,i,r);this.conditionUpdateObserver.groupChanges();let l=this.conditionCollection.getColumnStackPosition(e);-1===l&&(l=void 0),this.conditionCollection.removeConditions(e),n.command.key!==uP&&(this.conditionCollection.addCondition(e,n,s,l),i.command.key!==uP&&this.conditionCollection.addCondition(e,i,s,l)),r.command.key!==uP&&this.conditionCollection.addCondition(e,r,s,l),this.conditionUpdateObserver.flush(),this.components.forEach((t=>t.saveState(e))),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}function KD(t,e){this.updateDependentComponentsVisibility(),t.constructor!==QN||e.inputsCount||this.setListeningDropdownMenu()}function XD(){this.setListeningDropdownMenu()}function qD(t,e){const o=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(o)?de(e,"htFiltersActive"):ge(e,"htFiltersActive")}function QD(t){var e;if(null===(e=this.dropdownMenuPlugin)||void 0===e||!e.enabled)return;const{editedConditionStack:{conditions:o,column:n}}=t,i=o.filter((t=>t.name===SL)),r=o.filter((t=>t.name!==SL));if(i.length>=2||r.length>=3)fn(B`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const e=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(r[0],n),this.components.get("filter_by_condition2").updateState(r[1],n),this.components.get("filter_operators").updateState(e,n),this.components.get("filter_by_value").updateState(t)}}const JD="internal-use-in-handsontable",ZD={licenseKey:JD,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function tW(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[fV])||void 0===e||null===(e=e.language)||void 0===e?void 0:e.langCode}}function eW(t){return Object.keys(t).reduce(((e,o)=>("hyperformula"!==o&&(e[o]=t[o]),e)),{})}function oW(t){var e;const o=t[fV],n=eW(null!==o&&void 0!==o&&null!==(e=o.engine)&&void 0!==e&&e.hyperformula?o.engine:{}),i=tW(t);return{...ZD,...n,...i}}function nW(t){var e;const o=t[fV],n=eW(null!==o&&void 0!==o&&null!==(e=o.engine)&&void 0!==e&&e.hyperformula?o.engine:{}),i=tW(t);return{...n,...i}}function iW(t,e){return Object.keys(e).some((o=>void 0!==e[o]&&e[o]!==t[o]))}function rW(){const t="engine_relationship",e=xn(fV);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function sW(){const t="shared_engine_usage",e=xn(fV);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function lW(t){const e=t.getSettings(),o=e[fV],n=null===o||void 0===o?void 0:o.engine;if(!0===o)return null;if($(n))return null;var i;if("function"===typeof n.hyperformula||"function"===typeof n)return aW(null!==(i=n.hyperformula)&&void 0!==i?i:n,e,t);if("object"===typeof n&&$(n.hyperformula)){const e=rW(),o=sW().get(n);return e.has(n)||e.set(n,[]),e.get(n).push(t),o&&o.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:JD}),n.getConfig().leapYear1900===ZD.leapYear1900&&!1!==So(n.getConfig().nullDate,ZD.nullDate)||fn(B`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function aW(t,e,o){const n=e[fV],i=oW(e),r=rW(),s=sW();uW(t,n.functions),dW(t,n.language);const l=t.buildEmpty(i);return r.set(l,[o]),s.set(l,[o.guid]),gW(l,n.namedExpressions),l.on("sheetAdded",(()=>{l.rebuildAndRecalculate()})),l.on("sheetRemoved",(()=>{l.rebuildAndRecalculate()})),l}function hW(t){var e;const o=rW(),n=0===o.size?[]:Array.from(null!==(e=o.get(t))&&void 0!==e?e:[]);return new Map(n.map((t=>[t.getPlugin("formulas").sheetId,t])))}function cW(t,e){if(t){const o=rW(),n=o.get(t),i=sW(),r=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),0===n.length&&o.delete(t)),r&&r.includes(e.guid)&&(r.splice(r.indexOf(e.guid),1),0===r.length&&(i.delete(t),t.destroy()))}}function uW(t,e){e&&e.forEach((e=>{const{name:o,plugin:n,translations:i}=e;try{t.registerFunction(o,n,i)}catch(r){fn(r.message)}}))}function dW(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(o){fn(o.message)}}}function gW(t,e){e&&(t.suspendEvaluation(),e.forEach((e=>{const{name:o,expression:n,scope:i,options:r}=e;try{t.addNamedExpression(o,n,i,r)}catch(s){fn(s.message)}})),t.resumeEvaluation())}function fW(t,e){return!$(e)&&t.doesSheetExist(e)||(e=t.addSheet(e)),e}const mW="DD/MM/YYYY";function pW(t){return"string"===typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function wW(t){return pW(t)?t.substr(1):t}function vW(t){return"string"===typeof t&&t.startsWith("=")}function CW(t,e){return"string"===typeof t&&"date"===e}function yW(t,e){return E(t,e,!0).isValid()}function bW(t,e){return E(t,e,!0).format(mW)}function SW(t,e){return E(t,mW,!0).format(e)}function RW(t,e){const o=-1,n=new Date(Date.UTC(0,0,t+o));return E(n).format(e)}function EW(t,e,o){TW(t,e),e.set(t,o)}function TW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MW(t,e){var o=kW(t,e,"get");return HW(t,o)}function HW(t,e){return e.get?e.get.call(t):e.value}function xW(t,e,o){var n=kW(t,e,"set");return IW(t,n,o),o}function kW(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function IW(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var AW=new WeakMap,OW=new WeakMap,PW=new WeakMap,NW=new WeakMap,_W=new WeakMap,LW=new WeakMap,DW=new WeakMap;class WW{constructor(t,e,o){EW(this,AW,{writable:!0,value:void 0}),EW(this,OW,{writable:!0,value:void 0}),EW(this,PW,{writable:!0,value:void 0}),EW(this,NW,{writable:!0,value:[]}),EW(this,_W,{writable:!0,value:[]}),EW(this,LW,{writable:!0,value:void 0}),EW(this,DW,{writable:!0,value:[]}),xW(this,AW,t),xW(this,OW,e),xW(this,PW,o)}setRemovedHfIndexes(t){return xW(this,DW,t.map((t=>{const e=MW(this,OW).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(e)}))),MW(this,DW)}getRemovedHfIndexes(){return MW(this,DW)}getHfIndexFromVisualIndex(t){const e=MW(this,OW).getIndexesSequence(),o=MW(this,OW).getNotTrimmedIndexes();return e.indexOf(o[t])}syncMoves(t){const e=1,o=`move${lt(MW(this,AW))}s`;MW(this,PW).getEngine().batch((()=>{t.forEach((t=>{const n=t.from!==t.to,i=t.from+1!==t.to;n&&i&&MW(this,PW).getEngine()[o](MW(this,PW).getSheetId(),t.from,e,t.to)}))}))}storeMovesInformation(t,e,o){!1!==o&&(xW(this,_W,t.map((t=>this.getHfIndexFromVisualIndex(t)))),xW(this,LW,this.getHfIndexFromVisualIndex(e)))}getMoveLine(t,e){const o=MW(this,OW).getNumberOfIndexes(),n=Array.from(Array(o).keys()).filter((e=>!1===t.includes(e)));var i;return 0===e?null!==(i=n[e])&&void 0!==i?i:0:n[e-1]+1}getInitiallyCalculatedMoves(t,e){let o=this.getMoveLine(t,e);const n=[];return t.forEach((t=>{const e={from:t,to:o};n.forEach((t=>{const o=t.from>t.to,n=t.to<=e.from,i=t.from>e.from;i&&n&&o&&(e.from+=1)})),e.from>=o&&(o+=1),n.push(e)})),n}adjustedCalculatedMoves(t){return t.forEach(((e,o)=>{const n=t.slice(o+1);n.forEach((t=>{const o=t.from<t.to;t.from>e.from&&o&&(t.from-=1)}))})),t}calculateAndSyncMoves(t,e){if(MW(this,PW).isPerformingUndoRedo())return;if(!1===t||!1===e)return;const o=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(MW(this,_W),MW(this,LW)));null===MW(this,PW).getSheetId()?MW(this,PW).getPostponeAction((()=>this.syncMoves(o))):this.syncMoves(o)}getIndexesChangeSyncMethod(){const t=`set${lt(MW(this,AW))}Order`;return e=>{if(MW(this,PW).isPerformingUndoRedo())return;const o=MW(this,OW).getIndexesSequence();if("update"===e){const e=MW(this,NW).map((t=>o.indexOf(t))),n=MW(this,PW).getEngine().getSheetDimensions(MW(this,PW).getSheetId());let i;i="row"===MW(this,AW)?n.height:n.width;const r=e.length;for(let t=r;t<i;t+=1)e.push(t);MW(this,PW).getEngine()[t](MW(this,PW).getSheetId(),e)}xW(this,NW,o)}}init(){xW(this,NW,MW(this,OW).getIndexesSequence())}}var VW=WW;function FW(t,e,o){jW(t,e),e.set(t,o)}function jW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BW(t,e){var o=$W(t,e,"get");return zW(t,o)}function zW(t,e){return e.get?e.get.call(t):e.value}function UW(t,e,o){var n=$W(t,e,"set");return GW(t,n,o),o}function $W(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function GW(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var YW=new WeakMap,KW=new WeakMap,XW=new WeakMap,qW=new WeakMap,QW=new WeakMap,JW=new WeakMap,ZW=new WeakMap;class tV{constructor(t,e,o){FW(this,YW,{writable:!0,value:void 0}),FW(this,KW,{writable:!0,value:void 0}),FW(this,XW,{writable:!0,value:void 0}),FW(this,qW,{writable:!0,value:!1}),FW(this,QW,{writable:!0,value:!1}),FW(this,JW,{writable:!0,value:null}),FW(this,ZW,{writable:!0,value:null}),UW(this,YW,new VW("row",t,this)),UW(this,KW,new VW("column",e,this)),UW(this,XW,o)}getForAxis(t){return BW(this,"row"===t?YW:KW)}setPerformUndo(t){UW(this,qW,t)}setPerformRedo(t){UW(this,QW,t)}isPerformingUndoRedo(){return BW(this,qW)||BW(this,QW)}getSheetId(){return BW(this,ZW)}getEngine(){return BW(this,JW)}getPostponeAction(){return BW(this,XW)}setupSyncEndpoint(t,e){UW(this,JW,t),UW(this,ZW,e),BW(this,YW).init(),BW(this,KW).init()}}var eV=tV;function oV(t,e){lV(t,e),e.add(t)}function nV(t,e,o){return e=iV(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function iV(t){var e=rV(t,"string");return"symbol"==typeof e?e:String(e)}function rV(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function sV(t,e,o){lV(t,e),e.set(t,o)}function lV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aV(t,e,o){var n=uV(t,e,"set");return hV(t,n,o),o}function hV(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function cV(t,e){var o=uV(t,e,"get");return dV(t,o)}function uV(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function dV(t,e){return e.get?e.get.call(t):e.value}function gV(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const fV="formulas",mV=["maxRows","maxColumns","language"],pV=260;Mn.getSingleton().register("afterNamedExpressionAdded"),Mn.getSingleton().register("afterNamedExpressionRemoved"),Mn.getSingleton().register("afterSheetAdded"),Mn.getSingleton().register("afterSheetRemoved"),Mn.getSingleton().register("afterSheetRenamed"),Mn.getSingleton().register("afterFormulasValuesUpdate");const wV=t=>"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t;var vV=new WeakMap,CV=new WeakMap,yV=new WeakMap,bV=new WeakSet,SV=new WeakSet,RV=new WeakSet,EV=new WeakSet,TV=new WeakSet,MV=new WeakSet,HV=new WeakSet,xV=new WeakSet,kV=new WeakSet,IV=new WeakSet,AV=new WeakSet,OV=new WeakSet,PV=new WeakSet,NV=new WeakSet,_V=new WeakSet,LV=new WeakSet,DV=new WeakSet,WV=new WeakSet,VV=new WeakSet,FV=new WeakSet,jV=new WeakSet,BV=new WeakSet,zV=new WeakSet,UV=new WeakSet;class $V extends _S{constructor(){var t;super(...arguments),t=this,oV(this,UV),oV(this,zV),oV(this,BV),oV(this,jV),oV(this,FV),oV(this,VV),oV(this,WV),oV(this,DV),oV(this,LV),oV(this,_V),oV(this,NV),oV(this,PV),oV(this,OV),oV(this,AV),oV(this,IV),oV(this,kV),oV(this,xV),oV(this,HV),oV(this,MV),oV(this,TV),oV(this,EV),oV(this,RV),oV(this,SV),oV(this,bV),sV(this,vV,{writable:!0,value:!1}),sV(this,CV,{writable:!0,value:!1}),sV(this,yV,{writable:!0,value:[["valuesUpdated",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return gV(t,VV,cF).call(t,...o)}],["namedExpressionAdded",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return gV(t,FV,uF).call(t,...o)}],["namedExpressionRemoved",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return gV(t,jV,dF).call(t,...o)}],["sheetAdded",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return gV(t,BV,gF).call(t,...o)}],["sheetRenamed",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return gV(t,zV,fF).call(t,...o)}],["sheetRemoved",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return gV(t,UV,mF).call(t,...o)}]]}),nV(this,"staticRegister",xn("formulas")),nV(this,"engine",null),nV(this,"sheetName",null),nV(this,"indexSyncer",null),nV(this,"rowAxisSyncer",null),nV(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return fV}static get PLUGIN_PRIORITY(){return pV}static get SETTING_KEYS(){return[fV,...mV]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[fV]}enablePlugin(){var t,e=this;if(!this.enabled)if(this.engine=null!==(t=lW(this.hot))&&void 0!==t?t:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const t=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==t&&(this.sheetName=t)}this.addHook("beforeLoadData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,RV,KV).call(e,...o)})),this.addHook("afterLoadData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,TV,qV).call(e,...o)})),this.addHook("beforeUpdateData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,RV,KV).call(e,...o)})),this.addHook("afterUpdateData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,TV,qV).call(e,...o)})),this.addHook("modifyData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,MV,QV).call(e,...o)})),this.addHook("modifySourceData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,HV,JV).call(e,...o)})),this.addHook("beforeValidate",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,bV,GV).call(e,...o)})),this.addHook("afterSetSourceDataAtCell",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,kV,tF).call(e,...o)})),this.addHook("afterSetDataAtCell",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,xV,ZV).call(e,...o)})),this.addHook("afterSetDataAtRowProp",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,xV,ZV).call(e,...o)})),this.addHook("beforeCreateRow",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,IV,eF).call(e,...o)})),this.addHook("beforeCreateCol",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,AV,oF).call(e,...o)})),this.addHook("afterCreateRow",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,NV,rF).call(e,...o)})),this.addHook("afterCreateCol",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,_V,sF).call(e,...o)})),this.addHook("beforeRemoveRow",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,OV,nF).call(e,...o)})),this.addHook("beforeRemoveCol",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,PV,iF).call(e,...o)})),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,LV,lF).call(e,...o)})),this.addHook("afterRemoveCol",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,DV,aF).call(e,...o)})),this.indexSyncer=new eV(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(t=>{this.hot.addHookOnce("init",(()=>{t()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",((t,e,o,n)=>{this.rowAxisSyncer.storeMovesInformation(t,e,n)})),this.hot.addHook("beforeColumnMove",((t,e,o,n)=>{this.columnAxisSyncer.storeMovesInformation(t,e,n)})),this.hot.addHook("afterRowMove",((t,e,o,n,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(n,i)})),this.hot.addHook("afterColumnMove",((t,e,o,n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(n,i)})),this.hot.addHook("beforeColumnFreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart,e)})),this.hot.addHook("afterColumnFreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.hot.addHook("beforeColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart-1,e)})),this.hot.addHook("afterColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.addHook("afterCellMetaReset",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,EV,XV).call(e,...o)})),this.addHook("beforeUndo",(()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()})),this.addHook("beforeRedo",(()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,WV,hF).call(e,...o)})),this.addHook("beforeAutofill",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return gV(e,SV,YV).call(e,...o)})),cV(this,yV).forEach((t=>{let[e,o]=t;return this.engine.on(e,o)})),super.enablePlugin()}else fn("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){cV(this,yV).forEach((t=>{let[e,o]=t;return this.engine.off(e,o)})),cW(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(t){const e=nW(this.hot.getSettings());iW(this.engine.getConfig(),e)&&this.engine.updateConfig(e);const o=this.hot.getSettings()[fV];if(U(o)&&U(o.sheetName)&&o.sheetName!==this.sheetName&&this.switchSheet(o.sheetName),!t.data&&null===this.sheetName){const t=this.hot.getSettings()[fV].sheetName;t&&this.engine.doesSheetExist(t)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!==t&&void 0!==t?t:void 0,this.hot.getSourceDataArray())}super.updatePlugin(t)}destroy(){cV(this,yV).forEach((t=>{var e;let[o,n]=t;return null===(e=this.engine)||void 0===e?void 0:e.off(o,n)})),aV(this,yV,null),cW(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(t,e){if(U(e)&&!yu(e))return fn("The provided data should be an array of arrays."),!1;if(void 0!==t&&null!==t&&this.engine.doesSheetExist(t))return fn("Sheet with the provided name already exists."),!1;try{const o=this.engine.addSheet(null!==t&&void 0!==t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(o),e),o}catch(o){return fn(o.message),!1}}switchSheet(t){if(!this.engine.doesSheetExist(t))return void mn(`The sheet named \`${t}\` does not exist, switch aborted.`);this.sheetName=t;const e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,`${lt(fV)}.switchSheet`)}getCellType(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const n=this.hot.toPhysicalRow(t),i=this.hot.toPhysicalColumn(e);return null!==n&&null!==i?this.engine.getCellType({sheet:o,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)}):"EMPTY"}isFormulaCellType(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:o,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)})}renderDependentSheets(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=new Set;t.forEach((t=>{var e;const n=null===t||void 0===t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0!==n&&(o.has(n)||o.add(n))})),hW(this.engine).forEach(((t,n)=>{var i;(e||n!==this.sheetId)&&o.has(n)&&(t.render(),null===(i=t.view)||void 0===i||i.adjustElementsSize())}))}validateDependentCells(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=t=>{var e;const{row:o,col:n,sheet:i}=null!==(e=null===t||void 0===t?void 0:t.address)&&void 0!==e?e:{};return U(i)?`${i}:${o}x${n}`:""},n=new Set(e.map((t=>o(t))));t.forEach((t=>{var e,i;const{row:r,col:s}=null!==(e=t.address)&&void 0!==e?e:{};if(!1===U(r)||!1===U(s)||r>=this.hot.countRows()||s>=this.hot.countCols())return;const l=null===t||void 0===t||null===(i=t.address)||void 0===i?void 0:i.sheet,a=o(t);if(void 0!==l&&!n.has(a)){const t=hW(this.engine).get(l);if(!t)return;t.validateCell(t.getDataAtCell(r,s),t.getCellMeta(r,s),(()=>{}))}}))}syncChangeWithEngine(t,e,o){const n={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(n))return void fn(`Not possible to set cell data at ${JSON.stringify(n)}`);const i=this.hot.getCellMeta(t,e);return CW(o,i.type)&&(yW(o,i.dateFormat)?o=bW(o,i.dateFormat):!1===vW(o)&&(o=`'${o}`)),this.engine.setCellContents(n,o)}}function GV(t,e,o){const n=this.hot.propToCol(o);if(this.isFormulaCellType(e,n)){const t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},o=this.hot.getCellMeta(e,n);let i=this.engine.getCellValue(t);return"date"===o.type&&Di(i)&&(i=RW(i,o.dateFormat)),"object"===typeof i&&null!==i?i.value:i}return t}function YV(t,e,o){const{row:n,col:i}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),{row:l,col:a}=o.getTopStartCorner(),{row:h,col:c}=o.getBottomEndCorner(),u={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(d))return!1;const g=this.engine.getFillRangeData(u,d),{row:f,col:m}=u.start,{row:p,col:w}=u.end,v=p-f+1,C=w-m+1;for(let y=0;y<g.length;y+=1)for(let t=0;t<g[y].length;t+=1){const e=g[y][t],o=y%v,n=t%C,i=this.hot.getCellMeta(o,n);CW(e,i.type)&&(e.startsWith("'")?g[y][t]=e.slice(1):!1===this.isFormulaCellType(o,n,this.sheetId)&&(g[y][t]=SW(e,i.dateFormat)))}return g}function KV(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";o.includes(lt(fV))||aV(this,CV,$(this.hot.getSettings().data))}function XV(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach(((o,n)=>{o.forEach(((o,i)=>{const r=this.hot.getCellMeta(n,i),s=r.dateFormat;CW(o,r.type)&&(e=!0,yW(o,s)?t[n][i]=bW(o,s):!1===this.isFormulaCellType(n,i)&&(t[n][i]=`'${o}`))}))})),!0===e&&(aV(this,vV,!0),this.engine.setSheetContent(this.sheetId,t),aV(this,vV,!1))}function qV(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!o.includes(lt(fV)))if(this.sheetName=fW(this.engine,this.hot.getSettings()[fV].sheetName),cV(this,CV))this.switchSheet(this.sheetName);else{const t=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,t)){aV(this,vV,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),aV(this,vV,!1)}}}function QV(t,e,o,n){if("get"!==n||cV(this,vV)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(null===i||null===e)return;const r=this.isFormulaCellType(i,e);if(!r){const t=this.getCellType(i,e);if("ARRAY"!==t)return void(pW(o.value)&&(o.value=wW(o.value)))}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let l=this.engine.getCellValue(s);const a=this.hot.getCellMeta(i,e);"date"===a.type&&Di(l)&&(l=RW(l,a.dateFormat));const h="object"===typeof l&&null!==l?l.value:l;o.value=h}function JV(t,e,o,n){if("get"!==n||cV(this,vV)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),r=this.hot.propToCol(e);if(null===i||null===r)return;const s=this.isFormulaCellType(i,r);if(!s){const t=this.getCellType(i,r);if("ARRAY"!==t)return}const l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===l.width&&0===l.height)return;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};o.value=this.engine.getCellSerialized(a)}function ZV(t,e){if(wV(e))return;const o=[],n=[],i=this.engine.batch((()=>{t.forEach((t=>{let[e,i,,r]=t;const s=this.hot.propToCol(i),l=this.hot.toPhysicalRow(e),a=this.hot.toPhysicalColumn(s),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};null!==l&&null!==a?this.syncChangeWithEngine(e,s,r):o.push([e,s,r]),n.push({address:h})}))}));o.length&&this.hot.addHookOnce("afterChange",(()=>{const t=this.engine.batch((()=>{o.forEach((t=>{let[e,o,n]=t;this.syncChangeWithEngine(e,o,n)}))}));this.renderDependentSheets(t,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,n)}function tF(t,e){if(wV(e))return;const o=[],n=[];t.forEach((t=>{let[e,i,,r]=t;const s=this.hot.propToCol(i);if(!Di(s))return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(l)?(n.push({address:l}),o.push(...this.engine.setCellContents(l,r))):fn(`Not possible to set source cell data at ${JSON.stringify(l)}`)})),this.renderDependentSheets(o),this.validateDependentCells(o,n)}function eF(t,e){let o=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(o=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[o,e]))return!1}function oF(t,e){let o=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(o=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[o,e]))return!1}function nF(t,e,o){const n=this.rowAxisSyncer.setRemovedHfIndexes(o),i=n.every((t=>this.engine.isItPossibleToRemoveRows(this.sheetId,[t,1])));return!1!==i&&void 0}function iF(t,e,o){const n=this.columnAxisSyncer.setRemovedHfIndexes(o),i=n.every((t=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[t,1])));return!1!==i&&void 0}function rF(t,e,o){if(wV(o))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function sF(t,e,o){if(wV(o))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function lF(t,e,o,n){if(wV(n))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),r=this.engine.batch((()=>{i.forEach((t=>{this.engine.removeRows(this.sheetId,[t,1])}))}));this.renderDependentSheets(r)}function aF(t,e,o,n){if(wV(n))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),r=this.engine.batch((()=>{i.forEach((t=>{this.engine.removeColumns(this.sheetId,[t,1])}))}));this.renderDependentSheets(r)}function hF(t,e,o){var n;aV(this,vV,!0);const i=this.hot.getSourceDataArray(o,0,o+((null===(n=e.__children)||void 0===n?void 0:n.length)||0),this.hot.countSourceCols());aV(this,vV,!1),i.forEach(((t,e)=>{t.forEach(((t,n)=>{this.engine.setCellContents({col:n,row:o+e,sheet:this.sheetId},[[t]])}))}))}function cF(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function uF(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function dF(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function gF(t){this.hot.runHooks("afterSheetAdded",t)}function fF(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function mF(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function pF(t){return{key:"hidden_columns_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[,o,,n]=t;o-n!==0&&(e=1)}return this.getTranslatedPhrase(kg,e)},callback(){const{from:e,to:o}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,o.col),0),i=Math.max(e.col,o.col),r=[];for(let t=n;t<=i;t+=1)r.push(t);t.hideColumns(r);const s=r[r.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function wF(t){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(Ig,t)},callback(){var o,n;if(0===e.length)return;let i=e[0],r=e[e.length-1];i=null!==(o=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==o?o:0,r=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==n?n:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0);const s=r-i+1===this.countCols();s||this.selectColumns(i,r)},disabled:!1,hidden(){const o=I(t.getHiddenColumns(),(t=>this.toPhysicalColumn(t)));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||o.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().col,r=n.getBottomEndCorner().col,s=this.columnIndexMapper,l=s.getRenderableFromVisualIndex(i),a=s.getRenderableFromVisualIndex(r),h=s.getNotTrimmedIndexes(),c=[];if(i!==r){const t=r-i+1,e=a-l+1;if(t>e){const t=h.slice(i,r+1);c.push(...t.filter((t=>o.includes(t))))}}else if(0===l&&l<i)c.push(...h.slice(0,i));else if(null===l)c.push(...h.slice(0,this.countCols()));else{const t=this.countCols()-1,e=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1));a===e&&t>r&&c.push(...h.slice(r+1))}return A(c,(t=>{e.push(this.toVisualColumn(t))})),0===e.length}}}function vF(t,e){yF(t,e),e.add(t)}function CF(t,e,o){yF(t,e),e.set(t,o)}function yF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bF(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function SF(t,e){var o=TF(t,e,"get");return RF(t,o)}function RF(t,e){return e.get?e.get.call(t):e.value}function EF(t,e,o){var n=TF(t,e,"set");return MF(t,n,o),o}function TF(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function MF(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}Mn.getSingleton().register("beforeHideColumns"),Mn.getSingleton().register("afterHideColumns"),Mn.getSingleton().register("beforeUnhideColumns"),Mn.getSingleton().register("afterUnhideColumns");const HF="hiddenColumns",xF=310;var kF=new WeakMap,IF=new WeakMap,AF=new WeakSet,OF=new WeakSet,PF=new WeakSet,NF=new WeakSet,_F=new WeakSet,LF=new WeakSet;class DF extends _S{constructor(){super(...arguments),vF(this,LF),vF(this,_F),vF(this,NF),vF(this,PF),vF(this,OF),vF(this,AF),CF(this,kF,{writable:!0,value:{}}),CF(this,IF,{writable:!0,value:null})}static get PLUGIN_KEY(){return HF}static get PLUGIN_PRIORITY(){return xF}isEnabled(){return!!this.hot.getSettings()[HF]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[HF];Ro(e)&&(EF(this,kF,e),$(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),EF(this,IF,new Bu),SF(this,IF).addLocalHook("init",(()=>bF(this,LF,zF).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,SF(this,IF)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return bF(t,_F,BF).call(t,...o)})),this.addHook("afterGetCellMeta",((t,e,o)=>bF(this,OF,VF).call(this,t,e,o))),this.addHook("modifyColWidth",((t,e)=>bF(this,AF,WF).call(this,t,e))),this.addHook("afterGetColHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return bF(t,NF,jF).call(t,...o)})),this.addHook("modifyCopyableRange",(t=>bF(this,PF,FF).call(this,t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),EF(this,kF,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(t){const e=this.getHiddenColumns(),o=this.isValidConfig(t);let n=e;const i=SF(this,IF).getValues().slice(),r=t.length>0;if(o&&r){const e=t.map((t=>this.hot.toPhysicalColumn(t)));A(e,(t=>{i[t]=!1})),n=x(i,((t,e,o)=>(e&&t.push(this.hot.toVisualColumn(o)),t)),[])}const s=this.hot.runHooks("beforeUnhideColumns",e,n,o&&r);!1!==s&&(o&&r&&SF(this,IF).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",e,n,o&&r,o&&n.length<e.length))}showColumn(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.showColumns(e)}hideColumns(t){const e=this.getHiddenColumns(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t))));const i=this.hot.runHooks("beforeHideColumns",e,n,o);!1!==i&&(o&&this.hot.batchExecution((()=>{A(t,(t=>{SF(this,IF).setValueAtIndex(this.hot.toPhysicalColumn(t),!0)}))}),!0),this.hot.runHooks("afterHideColumns",e,n,o,o&&n.length>e.length))}hideColumn(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.hideColumns(e)}getHiddenColumns(){return I(SF(this,IF).getHiddenIndexes(),(t=>this.hot.toVisualColumn(t)))}isHidden(t){return SF(this,IF).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}isValidConfig(t){const e=this.hot.countCols();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){A(this.hot.getCellsMeta(),(t=>{t&&(t.skipColumnOnPaste=!1)}))}destroy(){EF(this,kF,null),EF(this,IF,null),super.destroy()}}function WF(t,e){return this.isHidden(e)?0:SF(this,kF).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"===typeof t&&this.hot.hasColHeaders()?t+15:void 0}function VF(t,e,o){if(!1===SF(this,kF).copyPasteEnabled&&this.isHidden(e)&&(o.skipColumnOnPaste=!0),this.isHidden(e-1))o.className=o.className||"",-1===o.className.indexOf("afterHiddenColumn")&&(o.className+=" afterHiddenColumn");else if(o.className){const t=o.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenColumn");e>-1&&t.splice(e,1),o.className=t.join(" ")}}}function FF(t){if(SF(this,kF).copyPasteEnabled)return t;const e=[],o=(t,o,n,i)=>{e.push({startRow:t,endRow:o,startCol:n,endCol:i})};return A(t,(t=>{let e=!0,n=0;Vi(t.startCol,t.endCol,(i=>{this.isHidden(i)?(e||o(t.startRow,t.endRow,n,i-1),e=!0):(e&&(n=i),i===t.endCol&&o(t.startRow,t.endRow,n,i),e=!1)}))})),e}function jF(t,e){if(!SF(this,kF).indicators||t<0)return;const o=[];t>=1&&this.isHidden(t-1)&&o.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&o.push("beforeHiddenColumn"),de(e,o)}function BF(t){t.items.push({name:QM},pF(this),wF(this))}function zF(){Array.isArray(SF(this,kF).columns)&&this.hideColumns(SF(this,kF).columns)}function UF(t){return{key:"hidden_rows_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[o,,n]=t;o-n!==0&&(e=1)}return this.getTranslatedPhrase(Ag,e)},callback(){const{from:e,to:o}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,o.row),0),i=Math.max(e.row,o.row),r=[];for(let t=n;t<=i;t+=1)r.push(t);t.hideRows(r);const s=r[r.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function $F(t){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(Og,t)},callback(){var o,n;if(0===e.length)return;let i=e[0],r=e[e.length-1];i=null!==(o=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==o?o:0,r=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==n?n:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0);const s=r-i+1===this.countRows();s||this.selectRows(i,r)},disabled:!1,hidden(){const o=I(t.getHiddenRows(),(t=>this.toPhysicalRow(t)));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||o.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().row,r=n.getBottomEndCorner().row,s=this.rowIndexMapper,l=s.getRenderableFromVisualIndex(i),a=s.getRenderableFromVisualIndex(r),h=s.getNotTrimmedIndexes(),c=[];if(i!==r){const t=r-i+1,e=a-l+1;if(t>e){const t=h.slice(i,r+1);c.push(...t.filter((t=>o.includes(t))))}}else if(0===l&&l<i)c.push(...h.slice(0,i));else if(null===l)c.push(...h.slice(0,this.countRows()));else{const t=this.countRows()-1,e=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1));a===e&&t>r&&c.push(...h.slice(r+1))}return A(c,(t=>{e.push(this.toVisualRow(t))})),0===e.length}}}function GF(t,e){KF(t,e),e.add(t)}function YF(t,e,o){KF(t,e),e.set(t,o)}function KF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XF(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function qF(t,e){var o=ZF(t,e,"get");return QF(t,o)}function QF(t,e){return e.get?e.get.call(t):e.value}function JF(t,e,o){var n=ZF(t,e,"set");return tj(t,n,o),o}function ZF(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function tj(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}Mn.getSingleton().register("beforeHideRows"),Mn.getSingleton().register("afterHideRows"),Mn.getSingleton().register("beforeUnhideRows"),Mn.getSingleton().register("afterUnhideRows");const ej="hiddenRows",oj=320;var nj=new WeakMap,ij=new WeakMap,rj=new WeakSet,sj=new WeakSet,lj=new WeakSet,aj=new WeakSet,hj=new WeakSet,cj=new WeakSet;class uj extends _S{constructor(){super(...arguments),GF(this,cj),GF(this,hj),GF(this,aj),GF(this,lj),GF(this,sj),GF(this,rj),YF(this,nj,{writable:!0,value:{}}),YF(this,ij,{writable:!0,value:null})}static get PLUGIN_KEY(){return ej}static get PLUGIN_PRIORITY(){return oj}isEnabled(){return!!this.hot.getSettings()[ej]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[ej];Ro(e)&&(JF(this,nj,e),$(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),JF(this,ij,new Bu),qF(this,ij).addLocalHook("init",(()=>XF(this,cj,wj).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,qF(this,ij)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XF(t,hj,pj).call(t,...o)})),this.addHook("afterGetCellMeta",((t,e,o)=>XF(this,sj,gj).call(this,t,e,o))),this.addHook("modifyRowHeight",((t,e)=>XF(this,rj,dj).call(this,t,e))),this.addHook("afterGetRowHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XF(t,aj,mj).call(t,...o)})),this.addHook("modifyCopyableRange",(t=>XF(this,lj,fj).call(this,t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),JF(this,nj,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(t){const e=this.getHiddenRows(),o=this.isValidConfig(t);let n=e;const i=qF(this,ij).getValues().slice(),r=t.length>0;if(o&&r){const e=t.map((t=>this.hot.toPhysicalRow(t)));A(e,(t=>{i[t]=!1})),n=x(i,((t,e,o)=>(e&&t.push(this.hot.toVisualRow(o)),t)),[])}const s=this.hot.runHooks("beforeUnhideRows",e,n,o&&r);!1!==s&&(o&&r&&qF(this,ij).setValues(i),this.hot.runHooks("afterUnhideRows",e,n,o&&r,o&&n.length<e.length))}showRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.showRows(e)}hideRows(t){const e=this.getHiddenRows(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t))));const i=this.hot.runHooks("beforeHideRows",e,n,o);!1!==i&&(o&&this.hot.batchExecution((()=>{A(t,(t=>{qF(this,ij).setValueAtIndex(this.hot.toPhysicalRow(t),!0)}))}),!0),this.hot.runHooks("afterHideRows",e,n,o,o&&n.length>e.length))}hideRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.hideRows(e)}getHiddenRows(){return I(qF(this,ij).getHiddenIndexes(),(t=>this.hot.toVisualRow(t)))}isHidden(t){return qF(this,ij).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}isValidConfig(t){const e=this.hot.countRows();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){A(this.hot.getCellsMeta(),(t=>{t&&(t.skipRowOnPaste=!1)}))}destroy(){JF(this,nj,null),JF(this,ij,null),super.destroy()}}function dj(t,e){return this.isHidden(e)?0:t}function gj(t,e,o){if(!1===qF(this,nj).copyPasteEnabled&&this.isHidden(t)&&(o.skipRowOnPaste=!0),this.isHidden(t-1))o.className=o.className||"",-1===o.className.indexOf("afterHiddenRow")&&(o.className+=" afterHiddenRow");else if(o.className){const t=o.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenRow");e>-1&&t.splice(e,1),o.className=t.join(" ")}}}function fj(t){if(qF(this,nj).copyPasteEnabled)return t;const e=[],o=(t,o,n,i)=>{e.push({startRow:t,endRow:o,startCol:n,endCol:i})};return A(t,(t=>{let e=!0,n=0;Vi(t.startRow,t.endRow,(i=>{this.isHidden(i)?(e||o(n,i-1,t.startCol,t.endCol),e=!0):(e&&(n=i),i===t.endRow&&o(n,i,t.startCol,t.endCol),e=!1)}))})),e}function mj(t,e){if(!qF(this,nj).indicators||t<0)return;const o=[];t>=1&&this.isHidden(t-1)&&o.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&o.push("beforeHiddenRow"),de(e,o)}function pj(t){t.items.push({name:QM},UF(this),$F(this))}function wj(){Array.isArray(qF(this,nj).rows)&&this.hideRows(qF(this,nj).rows)}function vj(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(rg)},callback(e,o){const[{start:{col:n}}]=o;t.freezeColumn(n),this.render(),this.view.adjustElementsSize(!0)},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}}function Cj(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(sg)},callback(e,o){const[{start:{col:n}}]=o;t.unfreezeColumn(n),this.render(),this.view.adjustElementsSize(!0)},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}}function yj(t,e){Sj(t,e),e.add(t)}function bj(t,e,o){Sj(t,e),e.set(t,o)}function Sj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rj(t,e){var o=Mj(t,e,"get");return Ej(t,o)}function Ej(t,e){return e.get?e.get.call(t):e.value}function Tj(t,e,o){var n=Mj(t,e,"set");return Hj(t,n,o),o}function Mj(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Hj(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function xj(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}Mn.getSingleton().register("beforeColumnFreeze"),Mn.getSingleton().register("afterColumnFreeze"),Mn.getSingleton().register("beforeColumnUnfreeze"),Mn.getSingleton().register("afterColumnUnfreeze");const kj="manualColumnFreeze",Ij=110;var Aj=new WeakMap,Oj=new WeakSet,Pj=new WeakSet;class Nj extends _S{constructor(){super(...arguments),yj(this,Pj),yj(this,Oj),bj(this,Aj,{writable:!0,value:!1})}static get PLUGIN_KEY(){return kj}static get PLUGIN_PRIORITY(){return Ij}isEnabled(){return!!this.hot.getSettings()[kj]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>xj(this,Oj,_j).call(this,t))),this.addHook("beforeColumnMove",((t,e)=>xj(this,Pj,Lj).call(this,t,e))),super.enablePlugin())}disablePlugin(){Tj(this,Aj,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(t){const e=this.hot.getSettings(),o=e.fixedColumnsStart<this.hot.countCols()&&t>e.fixedColumnsStart-1;Rj(this,Aj)||Tj(this,Aj,!0);const n=this.hot.runHooks("beforeColumnFreeze",t,o);!1!==n&&(o&&(this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart),e._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,o))}unfreezeColumn(t){const e=this.hot.getSettings(),o=e.fixedColumnsStart>0&&t<=e.fixedColumnsStart-1;Rj(this,Aj)||Tj(this,Aj,!0);const n=this.hot.runHooks("beforeColumnUnfreeze",t,o);!1!==n&&(o&&(e._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,o))}}function _j(t){t.items.push({name:"---------"},vj(this),Cj(this))}function Lj(t,e){if(Rj(this,Aj)){const o=this.hot.getSettings().fixedColumnsStart;if(e<o)return!1;if(t.some((t=>t<o)))return!1}}function Dj(t,e,o){return e=Wj(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Wj(t){var e=Vj(t,"string");return"symbol"==typeof e?e:String(e)}function Vj(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Fj=0,jj=1,Bj=2,zj="px";class Uj{constructor(t){Dj(this,"hot",void 0),Dj(this,"_element",null),Dj(this,"state",Fj),Dj(this,"inlineProperty",void 0),this.hot=t,this.inlineProperty=t.isRtl()?"right":"left"}appendTo(t){t.appendChild(this._element),this.state=Bj}build(){this.state===Fj&&(this._element=this.hot.rootDocument.createElement("div"),this.state=jj)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Fj}isAppended(){return this.state===Bj}isBuilt(){return this.state>=jj}setPosition(t,e){Di(t)&&(this._element.style.top=t+zj),Di(e)&&(this._element.style[this.inlineProperty]=e+zj)}getPosition(){const t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}setSize(t,e){Di(t)&&(this._element.style.width=t+zj),Di(e)&&(this._element.style.height=e+zj)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){Di(t)&&(this._element.style.marginTop=t+zj),Di(e)&&(this._element.style[`margin${lt(this.inlineProperty)}`]=e+zj)}getOffset(){const t=this._element.style,e=`margin${lt(this.inlineProperty)}`;return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[e]?parseInt(t[e],10):0}}}var $j=Uj;const Gj="ht__manualColumnMove--backlight";class Yj extends $j{build(){super.build(),de(this._element,Gj)}}var Kj=Yj;const Xj="ht__manualColumnMove--guideline";class qj extends $j{build(){super.build(),de(this._element,Xj)}}var Qj=qj;function Jj(t,e){tB(t,e),e.add(t)}function Zj(t,e,o){tB(t,e),e.set(t,o)}function tB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eB(t,e,o){var n=iB(t,e,"set");return oB(t,n,o),o}function oB(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function nB(t,e){var o=iB(t,e,"get");return rB(t,o)}function iB(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function rB(t,e){return e.get?e.get.call(t):e.value}function sB(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}Mn.getSingleton().register("beforeColumnMove"),Mn.getSingleton().register("afterColumnMove");const lB="manualColumnMove",aB=120,hB="ht__manualColumnMove",cB="show-ui",uB="on-moving--columns",dB="after-selection--columns";var gB=new WeakMap,fB=new WeakMap,mB=new WeakMap,pB=new WeakMap,wB=new WeakMap,vB=new WeakMap,CB=new WeakMap,yB=new WeakMap,bB=new WeakMap,SB=new WeakMap,RB=new WeakMap,EB=new WeakSet,TB=new WeakSet,MB=new WeakSet,HB=new WeakSet,xB=new WeakSet,kB=new WeakSet;class IB extends _S{constructor(){super(...arguments),Jj(this,kB),Jj(this,xB),Jj(this,HB),Jj(this,MB),Jj(this,TB),Jj(this,EB),Zj(this,gB,{writable:!0,value:new Kj(this.hot)}),Zj(this,fB,{writable:!0,value:new Qj(this.hot)}),Zj(this,mB,{writable:!0,value:[]}),Zj(this,pB,{writable:!0,value:0}),Zj(this,wB,{writable:!0,value:!1}),Zj(this,vB,{writable:!0,value:{}}),Zj(this,CB,{writable:!0,value:void 0}),Zj(this,yB,{writable:!0,value:void 0}),Zj(this,bB,{writable:!0,value:void 0}),Zj(this,SB,{writable:!0,value:void 0}),Zj(this,RB,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return lB}static get PLUGIN_PRIORITY(){return aB}isEnabled(){return!!this.hot.getSettings()[lB]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return sB(t,EB,AB).call(t,...o)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return sB(t,MB,PB).call(t,...o)})),this.addHook("afterScrollVertically",(()=>sB(this,xB,_B).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return sB(t,kB,LB).call(t,...o)})),this.buildPluginUI(),this.registerEvents(),de(this.hot.rootElement,hB),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ge(this.hot.rootElement,hB),this.unregisterEvents(),nB(this,gB).destroy(),nB(this,fB).destroy(),super.disablePlugin()}moveColumn(t,e){return this.moveColumns([t],e)}moveColumns(t,e){const o=nB(this,CB),n=this.isMovePossible(t,e),i=this.hot.runHooks("beforeColumnMove",t,e,o,n);if(eB(this,CB,void 0),!1===i)return;n&&this.hot.columnIndexMapper.moveIndexes(t,e);const r=n&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,o,n,r),r}dragColumn(t,e){return this.dragColumns([t],e)}dragColumns(t,e){const o=this.countFinalIndex(t,e);return eB(this,CB,e),this.moveColumns(t,o)}isMovePossible(t,e){const o=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),n=t.length+e>o,i=e<0,r=t.some((t=>t<0)),s=t.some((t=>t>=o));return!(n||i||r||s)}isColumnOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}countFinalIndex(t,e){const o=x(t,((t,o)=>(o<e&&(t+=1),t)),0);return e-o}getColumnsWidth(t,e){const o=this.hot.columnIndexMapper;let n=0;for(let i=t;i<=e;i+=1){const t=o.getRenderableFromVisualIndex(i);i<0?n+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==t&&(n+=this.hot.view._wt.wtTable.getStretchedColumnWidth(t)||0)}return n}moveBySettingsOrLoad(){const t=this.hot.getSettings()[lB];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(t){return t<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}prepareColumnsToMoving(t,e){const o=[];return Vi(t,e,(t=>{o.push(t)})),o}refreshPositions(){const t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(nB(this,yB))&&t>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1)});const e=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtOverlays.scrollableElement,n="number"===typeof o.scrollX?o.scrollX:o.scrollLeft;let i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,nB(this,yB)-1);const r=e.hider.offsetWidth,s=e.TBODY.offsetLeft,l=nB(this,gB).getOffset().start,a=nB(this,gB).getSize().width;let h=0,c=0;if(this.hot.isRtl()){const t=this.hot.rootWindow,e=Oe(this.hot.rootElement),i=t.innerWidth-nB(this,bB)-e;c=t.innerWidth-nB(this,vB).eventPageX-i-(void 0===o.scrollX?n:0)}else c=nB(this,vB).eventPageX-(nB(this,bB)-(void 0===o.scrollX?n:0));if(nB(this,SB)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(nB(this,yB))&&(i+=n),i+=h,nB(this,yB)<0)nB(this,RB)>0?nB(this,vB).col=0:nB(this,vB).col=t>0?t-1:t;else if(nB(this,vB).TD.offsetWidth/2+i<=c){const t=nB(this,yB)>=nB(this,pB)?nB(this,pB)-1:nB(this,yB);nB(this,vB).col=t+1,i+=nB(this,vB).TD.offsetWidth}else nB(this,vB).col=nB(this,yB);let u=c,d=i;c+a+l>=r?u=r-a-l:c+l<s+h&&(u=s+h+Math.abs(l)),i>=r-1?d=r-1:0===d?d=1:void 0!==o.scrollX&&nB(this,yB)<nB(this,RB)&&(d-=nB(this,bB)<=o.scrollX?nB(this,bB):0),nB(this,gB).setPosition(null,u),nB(this,fB).setPosition(null,d)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>sB(this,TB,OB).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>sB(this,HB,NB).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){nB(this,gB).build(),nB(this,fB).build()}destroy(){nB(this,gB).destroy(),nB(this,fB).destroy(),super.destroy()}}function AB(t,e,o,n){const i=this.hot.view._wt.wtTable,r=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),l=ue(t.target,"sortAction");if(!s||!r||nB(this,wB)||0!==t.button||l)return eB(this,wB,!1),nB(this,mB).length=0,void ge(this.hot.rootElement,[uB,cB]);const a=nB(this,fB).isBuilt()&&!nB(this,fB).isAppended(),h=nB(this,gB).isBuilt()&&!nB(this,gB).isAppended();a&&h&&(nB(this,fB).appendTo(i.hider),nB(this,gB).appendTo(i.hider));const{from:c,to:u}=s,d=Math.min(c.col,u.col),g=Math.max(c.col,u.col);if(e.row<0&&e.col>=d&&e.col<=g){n.column=!0,eB(this,wB,!0);const r=o.firstChild?gn(t,o.firstChild).x:t.offsetX;nB(this,vB).eventPageX=t.pageX,eB(this,yB,e.col),nB(this,vB).TD=o,nB(this,vB).col=e.col,eB(this,mB,this.prepareColumnsToMoving(d,g)),eB(this,SB,!!this.hot.getSettings().rowHeaders),eB(this,pB,this.hot.countCols()),eB(this,RB,this.hot.getSettings().fixedColumnsStart),eB(this,bB,Se(this.hot.rootElement).left);const s=nB(this,SB)?-1:0,l=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,a=e.col<nB(this,RB),h=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),c=Math.abs(r-(this.hot.isRtl()?o.offsetWidth:0)),u=this.getColumnsWidth(d,e.col-1)+c,f=this.getColumnsWidth(s,d-1)+(a?h:0)+u;nB(this,gB).setPosition(l,f),nB(this,gB).setSize(this.getColumnsWidth(d,g),i.hider.offsetHeight-l),nB(this,gB).setOffset(null,-u),de(this.hot.rootElement,uB)}else ge(this.hot.rootElement,dB),eB(this,wB,!1),nB(this,mB).length=0}function OB(t){nB(this,wB)&&(nB(this,vB).eventPageX=t.pageX,this.refreshPositions())}function PB(t,e,o,n){const i=this.hot.getSelectedRangeLast();i&&nB(this,wB)&&(nB(this,mB).indexOf(e.col)>-1?ge(this.hot.rootElement,cB):de(this.hot.rootElement,cB),n.row=!0,n.column=!0,n.cell=!0,eB(this,yB,e.col),nB(this,vB).TD=o)}function NB(){const t=nB(this,vB).col,e=nB(this,mB).length;if(eB(this,yB,void 0),eB(this,wB,!1),ge(this.hot.rootElement,[uB,cB,dB]),this.hot.selection.isSelectedByColumnHeader()&&de(this.hot.rootElement,dB),e<1||void 0===t)return;const o=nB(this,mB)[0],n=this.hot.toPhysicalColumn(o),i=this.dragColumns(nB(this,mB),t);if(nB(this,mB).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const t=this.hot.toVisualColumn(n),o=t+e-1;this.hot.selectColumns(t,o)}}function _B(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,o=t.holder.scrollTop,n=e+o;nB(this,gB).setPosition(n),nB(this,gB).setSize(null,t.hider.offsetHeight-n)}function LB(){this.moveBySettingsOrLoad()}function DB(t,e){VB(t,e),e.add(t)}function WB(t,e,o){VB(t,e),e.set(t,o)}function VB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FB(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function jB(t,e,o){var n=UB(t,e,"set");return BB(t,n,o),o}function BB(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function zB(t,e){var o=UB(t,e,"get");return $B(t,o)}function UB(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function $B(t,e){return e.get?e.get.call(t):e.value}const GB="manualColumnResize",YB=130,KB="manualColumnWidths";var XB=new WeakMap,qB=new WeakMap,QB=new WeakMap,JB=new WeakMap,ZB=new WeakMap,tz=new WeakMap,ez=new WeakMap,oz=new WeakMap,nz=new WeakMap,iz=new WeakMap,rz=new WeakMap,sz=new WeakMap,lz=new WeakMap,az=new WeakMap,hz=new WeakMap,cz=new WeakMap,uz=new WeakSet,dz=new WeakSet,gz=new WeakSet,fz=new WeakSet,mz=new WeakSet,pz=new WeakSet,wz=new WeakSet,vz=new WeakSet,Cz=new WeakSet;class yz extends _S{static get PLUGIN_KEY(){return GB}static get PLUGIN_PRIORITY(){return YB}constructor(t){super(t),DB(this,Cz),DB(this,vz),DB(this,wz),DB(this,pz),DB(this,mz),DB(this,fz),DB(this,gz),DB(this,dz),DB(this,uz),WB(this,XB,{writable:!0,value:null}),WB(this,qB,{writable:!0,value:null}),WB(this,QB,{writable:!0,value:[]}),WB(this,JB,{writable:!0,value:null}),WB(this,ZB,{writable:!0,value:null}),WB(this,tz,{writable:!0,value:null}),WB(this,ez,{writable:!0,value:null}),WB(this,oz,{writable:!0,value:null}),WB(this,nz,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),WB(this,iz,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),WB(this,rz,{writable:!0,value:null}),WB(this,sz,{writable:!0,value:!1}),WB(this,lz,{writable:!0,value:0}),WB(this,az,{writable:!0,value:null}),WB(this,hz,{writable:!0,value:void 0}),WB(this,cz,{writable:!0,value:void 0}),de(zB(this,nz),"manualColumnResizer"),de(zB(this,iz),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[GB]}enablePlugin(){this.enabled||(jB(this,hz,new ju),zB(this,hz).addLocalHook("init",(()=>FB(this,uz,bz).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,zB(this,hz)),this.addHook("modifyColWidth",((t,e)=>FB(this,wz,Hz).call(this,t,e))),this.addHook("beforeStretchingColumnWidth",((t,e)=>FB(this,vz,xz).call(this,t,e))),this.addHook("beforeColumnResize",((t,e,o)=>FB(this,Cz,kz).call(this,t,e,o))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){jB(this,cz,zB(this,hz).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",KB,zB(this,hz).getValues())}loadManualColumnWidths(){const t={};return this.hot.runHooks("persistentStateLoad",KB,t),t.value}setManualSize(t,e){const o=Math.max(e,20),n=this.hot.toPhysicalColumn(t);return zB(this,hz).setValueAtIndex(n,o),o}clearManualSize(t){const e=this.hot.toPhysicalColumn(t);zB(this,hz).setValueAtIndex(e,null)}setupHandlePosition(t){if(!t.parentNode)return;jB(this,XB,t);const{_wt:e}=this.hot.view,o=e.wtTable.getCoords(zB(this,XB)),n=o.col;if(n<0)return;const i=Pe(zB(this,XB)),r=zB(this,XB).getBoundingClientRect(),s=n<e.getSetting("fixedColumnsStart");let l;s&&(l=e.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(zB(this,XB),o.row,o.col)),l||(l=e.wtOverlays.topOverlay.getRelativeCellPosition(zB(this,XB),o.row,o.col)),jB(this,qB,this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)),jB(this,QB,[]);const a=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&a){const t=this.hot.getSelectedRange();A(t,(t=>{const e=t.getTopStartCorner().col,o=t.getBottomEndCorner().col;Vi(e,o,(t=>{zB(this,QB).includes(t)||zB(this,QB).push(t)}))}))}zB(this,QB).includes(zB(this,qB))||jB(this,QB,[zB(this,qB)]),jB(this,oz,l.start-6),jB(this,ez,parseInt(r.width,10)),zB(this,nz).style.top=`${l.top}px`,zB(this,nz).style[this.inlineDir]=`${zB(this,oz)+zB(this,ez)}px`,zB(this,nz).style.height=`${i}px`,this.hot.rootElement.appendChild(zB(this,nz))}refreshHandlePosition(){zB(this,nz).style[this.inlineDir]=`${zB(this,oz)+zB(this,JB)}px`}setupGuidePosition(){const t=parseInt(Pe(zB(this,nz)),10),e=parseInt(zB(this,nz).style.top,10)+t,o=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);de(zB(this,nz),"active"),de(zB(this,iz),"active"),zB(this,iz).style.top=`${e}px`,this.refreshGuidePosition(),zB(this,iz).style.height=o-t+"px",this.hot.rootElement.appendChild(zB(this,iz))}refreshGuidePosition(){zB(this,iz).style[this.inlineDir]=zB(this,nz).style[this.inlineDir]}hideHandleAndGuide(){ge(zB(this,nz),"active"),ge(zB(this,iz),"active")}checkIfColumnHeader(t){const e=ie(t,["THEAD"],this.hot.rootElement),{topOverlay:o,topInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;return[o.clone.wtTable.THEAD,n.clone.wtTable.THEAD].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{const n=this.hot.runHooks("beforeColumnResize",zB(this,ZB),e,!0);void 0!==n&&jB(this,ZB,n),"all"===this.hot.getSettings().stretchH?this.clearManualSize(e):this.setManualSize(e,zB(this,ZB)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",zB(this,ZB),e,!0),o&&t()};if(zB(this,lz)>=2){const o=zB(this,QB).length;o>1?(A(zB(this,QB),(t=>{e(t)})),t()):A(zB(this,QB),(t=>{e(t,!0)}))}jB(this,lz,0),jB(this,az,null)}bindEvents(){const{rootWindow:t,rootElement:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",(t=>FB(this,dz,Sz).call(this,t))),this.eventManager.addEventListener(e,"mousedown",(t=>FB(this,gz,Rz).call(this,t))),this.eventManager.addEventListener(t,"mousemove",(t=>FB(this,fz,Ez).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>FB(this,mz,Tz).call(this))),this.eventManager.addEventListener(zB(this,nz),"contextmenu",(()=>FB(this,pz,Mz).call(this)))}destroy(){super.destroy()}}function bz(){const t=this.hot.getSettings()[GB],e=this.loadManualColumnWidths();"undefined"!==typeof e?this.hot.batchExecution((()=>{e.forEach(((t,e)=>{zB(this,hz).setValueAtIndex(e,t)}))}),!0):Array.isArray(t)?(this.hot.batchExecution((()=>{t.forEach(((t,e)=>{zB(this,hz).setValueAtIndex(e,t)}))}),!0),jB(this,cz,t)):!0===t&&Array.isArray(zB(this,cz))&&this.hot.batchExecution((()=>{zB(this,cz).forEach(((t,e)=>{zB(this,hz).setValueAtIndex(e,t)}))}),!0)}function Sz(t){if(!to(t.target)&&!0!==zB(this,sz)&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const o=e.getAttribute("colspan");!e||null!==o&&"1"!==o||zB(this,rz)||this.setupHandlePosition(e)}}function Rz(t){ue(t.target,"manualColumnResizer")&&(this.setupHandlePosition(zB(this,XB)),this.setupGuidePosition(),jB(this,rz,!0),null===zB(this,az)&&(jB(this,az,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(zB(this,az))),jB(this,lz,zB(this,lz)+1),this.startX=t.pageX,jB(this,ZB,zB(this,ez)))}function Ez(t){if(zB(this,rz)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();jB(this,JB,zB(this,ez)+e),A(zB(this,QB),(t=>{jB(this,ZB,this.setManualSize(t,zB(this,JB)))})),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Tz(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{this.hot.runHooks("beforeColumnResize",zB(this,ZB),e,!1),o&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",zB(this,ZB),e,!1)};if(zB(this,rz)){if(this.hideHandleAndGuide(),jB(this,rz,!1),zB(this,ZB)!==zB(this,ez)){const o=zB(this,QB).length;o>1?(A(zB(this,QB),(t=>{e(t)})),t()):A(zB(this,QB),(t=>{e(t,!0)}))}this.setupHandlePosition(zB(this,XB))}}function Mz(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(zB(this,nz)),this.hot.rootElement.removeChild(zB(this,iz)),jB(this,rz,!1),jB(this,sz,!0),this.hot._registerImmediate((()=>{jB(this,sz,!1)}))}function Hz(t,e){let o=t;if(this.enabled){const t=this.hot.toPhysicalColumn(e),n=zB(this,hz).getValueAtIndex(t);this.hot.getSettings()[GB]&&n&&(o=n)}return o}function xz(t,e){let o=zB(this,hz).getValueAtIndex(e);return null===o&&(o=t),o}function kz(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Iz(t,e,o){return e=Az(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Az(t){var e=Oz(t,"string");return"symbol"==typeof e?e:String(e)}function Oz(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Pz=0,Nz=1,_z=2,Lz="px";class Dz{constructor(t){Iz(this,"hot",void 0),Iz(this,"_element",null),Iz(this,"state",Pz),this.hot=t}appendTo(t){t.appendChild(this._element),this.state=_z}build(){this.state===Pz&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Nz)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Pz}isAppended(){return this.state===_z}isBuilt(){return this.state>=Nz}setPosition(t,e){void 0!==t&&(this._element.style.top=t+Lz),void 0!==e&&(this._element.style.left=e+Lz)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(t,e){t&&(this._element.style.width=t+Lz),e&&(this._element.style.height=e+Lz)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){t&&(this._element.style.marginTop=t+Lz),e&&(this._element.style.marginLeft=e+Lz)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}var Wz=Dz;const Vz="ht__manualRowMove--backlight";class Fz extends Wz{build(){super.build(),de(this._element,Vz)}}var jz=Fz;const Bz="ht__manualRowMove--guideline";class zz extends Wz{build(){super.build(),de(this._element,Bz)}}var Uz=zz;function $z(t,e){Yz(t,e),e.add(t)}function Gz(t,e,o){Yz(t,e),e.set(t,o)}function Yz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kz(t,e,o){var n=Qz(t,e,"set");return Xz(t,n,o),o}function Xz(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function qz(t,e){var o=Qz(t,e,"get");return Jz(t,o)}function Qz(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Jz(t,e){return e.get?e.get.call(t):e.value}function Zz(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}Mn.getSingleton().register("beforeRowMove"),Mn.getSingleton().register("afterRowMove");const tU="manualRowMove",eU=140,oU="ht__manualRowMove",nU="show-ui",iU="on-moving--rows",rU="after-selection--rows";var sU=new WeakMap,lU=new WeakMap,aU=new WeakMap,hU=new WeakMap,cU=new WeakMap,uU=new WeakMap,dU=new WeakSet,gU=new WeakSet,fU=new WeakSet,mU=new WeakSet,pU=new WeakSet,wU=new WeakSet;class vU extends _S{constructor(){super(...arguments),$z(this,wU),$z(this,pU),$z(this,mU),$z(this,fU),$z(this,gU),$z(this,dU),Gz(this,sU,{writable:!0,value:new jz(this.hot)}),Gz(this,lU,{writable:!0,value:new Uz(this.hot)}),Gz(this,aU,{writable:!0,value:[]}),Gz(this,hU,{writable:!0,value:void 0}),Gz(this,cU,{writable:!0,value:{}}),Gz(this,uU,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return tU}static get PLUGIN_PRIORITY(){return eU}isEnabled(){return!!this.hot.getSettings()[tU]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Zz(t,dU,CU).call(t,...o)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Zz(t,fU,bU).call(t,...o)})),this.addHook("afterScrollHorizontally",(()=>Zz(this,pU,RU).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Zz(t,wU,EU).call(t,...o)})),this.buildPluginUI(),this.registerEvents(),de(this.hot.rootElement,oU),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ge(this.hot.rootElement,oU),this.unregisterEvents(),qz(this,sU).destroy(),qz(this,lU).destroy(),super.disablePlugin()}moveRow(t,e){return this.moveRows([t],e)}moveRows(t,e){const o=qz(this,uU),n=this.isMovePossible(t,e),i=this.hot.runHooks("beforeRowMove",t,e,o,n);if(Kz(this,uU,void 0),!1===i)return;n&&this.hot.rowIndexMapper.moveIndexes(t,e);const r=n&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,o,n,r),r}dragRow(t,e){return this.dragRows([t],e)}dragRows(t,e){const o=this.countFinalIndex(t,e);return Kz(this,uU,e),this.moveRows(t,o)}isMovePossible(t,e){const o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),n=t.length+e>o,i=e<0,r=t.some((t=>t<0)),s=t.some((t=>t>=o));return!(n||i||r||s)}isRowOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}countFinalIndex(t,e){const o=x(t,((t,o)=>(o<e&&(t+=1),t)),0);return e-o}getRowsHeight(t,e){const o=this.hot.rowIndexMapper;let n=0;for(let i=t;i<=e;i++){const t=o.getRenderableFromVisualIndex(i);null!==t&&(n+=this.hot.view._wt.wtTable.getRowHeight(t)||23)}return n}moveBySettingsOrLoad(){const t=this.hot.getSettings()[tU];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(t){return t<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}prepareRowsToMoving(){const t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;const{from:o,to:n}=t,i=Math.min(o.row,n.row),r=Math.max(o.row,n.row);return Vi(i,r,(t=>{e.push(t)})),e}refreshPositions(){const t=qz(this,cU).coords,e=this.hot.view.getFirstFullyVisibleRow(),o=this.hot.view.getLastFullyVisibleRow(),n=this.hot.countRows();this.isFixedRowTop(t.row)&&e>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(e-1,-1)),this.isFixedRowBottom(t.row)&&o<n&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o+1,1),void 0,!0);const i=this.hot.view._wt.wtTable,r=qz(this,cU).TD,s=this.hot.rootElement,l=Se(s),a=xe(s),h=i.holder.scrollTop,c=this.hot.rootWindow!==a?a.scrollTop:0,u=l.top-c,d=qz(this,cU).eventPageY-u+h,g=i.hider.offsetHeight,f=i.TBODY.offsetTop,m=qz(this,sU).getOffset().top,p=qz(this,sU).getSize().height,w=r.offsetHeight/2,v=r.offsetHeight;let C=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1);const y=d>=C+w;this.isFixedRowTop(t.row)&&(C+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),t.row<0?qz(this,cU).row=e>0?e-1:e:y?(qz(this,cU).row=t.row+1,C+=0===t.row?v-1:v):qz(this,cU).row=t.row;let b=d,S=C;d+p+m>=g?b=g-p-m:d+m<f&&(b=f+Math.abs(m)),C>=g-1&&(S=g-1),qz(this,sU).setPosition(b),qz(this,lU).setPosition(S)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>Zz(this,gU,yU).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>Zz(this,mU,SU).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){qz(this,sU).build(),qz(this,lU).build()}destroy(){qz(this,sU).destroy(),qz(this,lU).destroy(),super.destroy()}}function CU(t,e,o,n){const{wtTable:i,wtViewport:r}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast();if(!l||!s||qz(this,hU)||0!==t.button)return Kz(this,hU,!1),qz(this,aU).length=0,void ge(this.hot.rootElement,[iU,nU]);const a=qz(this,lU).isBuilt()&&!qz(this,lU).isAppended(),h=qz(this,sU).isBuilt()&&!qz(this,sU).isAppended();a&&h&&(qz(this,lU).appendTo(i.hider),qz(this,sU).appendTo(i.hider));const{from:c,to:u}=l,d=Math.min(c.row,u.row),g=Math.max(c.row,u.row);if(e.col<0&&e.row>=d&&e.row<=g){n.row=!0,Kz(this,hU,!0),qz(this,cU).eventPageY=t.pageY,qz(this,cU).coords=e,qz(this,cU).TD=o,Kz(this,aU,this.prepareRowsToMoving());const s=i.holder.scrollLeft+r.getRowHeaderWidth(),l=this.getRowsHeight(d,e.row-1)+t.offsetY;qz(this,sU).setPosition(null,s),qz(this,sU).setSize(i.hider.offsetWidth-s,this.getRowsHeight(d,g)),qz(this,sU).setOffset(-l,null),de(this.hot.rootElement,iU),this.refreshPositions()}else ge(this.hot.rootElement,rU),Kz(this,hU,!1),qz(this,aU).length=0}function yU(t){qz(this,hU)&&(qz(this,cU).eventPageY=t.pageY,this.refreshPositions())}function bU(t,e,o,n){const i=this.hot.getSelectedRangeLast();i&&qz(this,hU)&&(qz(this,aU).indexOf(e.row)>-1?ge(this.hot.rootElement,nU):de(this.hot.rootElement,nU),n.row=!0,n.column=!0,n.cell=!0,qz(this,cU).coords=e,qz(this,cU).TD=o)}function SU(){const t=qz(this,cU).row,e=qz(this,aU).length;if(Kz(this,hU,!1),ge(this.hot.rootElement,[iU,nU,rU]),this.hot.selection.isSelectedByRowHeader()&&de(this.hot.rootElement,rU),e<1||void 0===t)return;const o=qz(this,aU)[0],n=this.hot.toPhysicalRow(o),i=this.dragRows(qz(this,aU),t);if(qz(this,aU).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const t=this.hot.toVisualRow(n),o=t+e-1;this.hot.selectRows(t,o)}}function RU(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),o=t.holder.scrollLeft,n=e+o;qz(this,sU).setPosition(null,n),qz(this,sU).setSize(t.hider.offsetWidth-n)}function EU(){this.moveBySettingsOrLoad()}function TU(t,e){HU(t,e),e.add(t)}function MU(t,e,o){HU(t,e),e.set(t,o)}function HU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xU(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function kU(t,e,o){var n=OU(t,e,"set");return IU(t,n,o),o}function IU(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function AU(t,e){var o=OU(t,e,"get");return PU(t,o)}function OU(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function PU(t,e){return e.get?e.get.call(t):e.value}const NU="manualRowResize",_U=30,LU="manualRowHeights";var DU=new WeakMap,WU=new WeakMap,VU=new WeakMap,FU=new WeakMap,jU=new WeakMap,BU=new WeakMap,zU=new WeakMap,UU=new WeakMap,$U=new WeakMap,GU=new WeakMap,YU=new WeakMap,KU=new WeakMap,XU=new WeakMap,qU=new WeakMap,QU=new WeakMap,JU=new WeakMap,ZU=new WeakSet,t$=new WeakSet,e$=new WeakSet,o$=new WeakSet,n$=new WeakSet,i$=new WeakSet,r$=new WeakSet;class s$ extends _S{static get PLUGIN_KEY(){return NU}static get PLUGIN_PRIORITY(){return _U}constructor(t){super(t),TU(this,r$),TU(this,i$),TU(this,n$),TU(this,o$),TU(this,e$),TU(this,t$),TU(this,ZU),MU(this,DU,{writable:!0,value:null}),MU(this,WU,{writable:!0,value:null}),MU(this,VU,{writable:!0,value:[]}),MU(this,FU,{writable:!0,value:null}),MU(this,jU,{writable:!0,value:null}),MU(this,BU,{writable:!0,value:null}),MU(this,zU,{writable:!0,value:null}),MU(this,UU,{writable:!0,value:null}),MU(this,$U,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),MU(this,GU,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),MU(this,YU,{writable:!0,value:!1}),MU(this,KU,{writable:!0,value:!1}),MU(this,XU,{writable:!0,value:0}),MU(this,qU,{writable:!0,value:null}),MU(this,QU,{writable:!0,value:void 0}),MU(this,JU,{writable:!0,value:void 0}),de(AU(this,$U),"manualRowResizer"),de(AU(this,GU),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[NU]}enablePlugin(){this.enabled||(kU(this,QU,new ju),AU(this,QU).addLocalHook("init",(()=>xU(this,r$,g$).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,AU(this,QU)),this.addHook("modifyRowHeight",((t,e)=>xU(this,i$,d$).call(this,t,e))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){kU(this,JU,AU(this,QU).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",LU,AU(this,QU).getValues())}loadManualRowHeights(){const t={};return this.hot.runHooks("persistentStateLoad",LU,t),t.value}setManualSize(t,e){const o=this.hot.toPhysicalRow(t),n=Math.max(e,Ih.DEFAULT_HEIGHT);return AU(this,QU).setValueAtIndex(o,n),n}setupHandlePosition(t){kU(this,DU,t);const{view:e}=this.hot,{_wt:o}=e,n=o.wtTable.getCoords(AU(this,DU)),i=n.row;if(i<0)return;const r=Oe(AU(this,DU)),s=AU(this,DU).getBoundingClientRect(),l=i<o.getSetting("fixedRowsTop"),a=i>=e.countNotHiddenRowIndexes(0,1)-o.getSetting("fixedRowsBottom");let h;l?h=o.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(AU(this,DU),n.row,n.col):a&&(h=o.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(AU(this,DU),n.row,n.col)),h||(h=o.wtOverlays.inlineStartOverlay.getRelativeCellPosition(AU(this,DU),n.row,n.col)),kU(this,WU,this.hot.rowIndexMapper.getVisualFromRenderableIndex(i)),kU(this,VU,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&c){const t=this.hot.getSelectedRange();A(t,(t=>{const e=t.getTopStartCorner().row,o=t.getBottomStartCorner().row;Vi(e,o,(t=>{AU(this,VU).includes(t)||AU(this,VU).push(t)}))}))}AU(this,VU).includes(AU(this,WU))||kU(this,VU,[AU(this,WU)]),kU(this,UU,h.top-6),kU(this,zU,parseInt(s.height,10)),AU(this,$U).style.top=`${AU(this,UU)+AU(this,zU)}px`,AU(this,$U).style[this.inlineDir]=`${h.start}px`,AU(this,$U).style.width=`${r}px`,this.hot.rootElement.appendChild(AU(this,$U))}refreshHandlePosition(){AU(this,$U).style.top=`${AU(this,UU)+AU(this,FU)}px`}setupGuidePosition(){const t=parseInt(Oe(AU(this,$U)),10),e=parseInt(AU(this,$U).style[this.inlineDir],10)+t,o=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);de(AU(this,$U),"active"),de(AU(this,GU),"active"),AU(this,GU).style.top=AU(this,$U).style.top,AU(this,GU).style[this.inlineDir]=`${e}px`,AU(this,GU).style.width=o-t+"px",this.hot.rootElement.appendChild(AU(this,GU))}refreshGuidePosition(){AU(this,GU).style.top=AU(this,$U).style.top}hideHandleAndGuide(){ge(AU(this,$U),"active"),ge(AU(this,GU),"active")}checkIfRowHeader(t){const e=ie(t,["TBODY"],this.hot.rootElement),{inlineStartOverlay:o,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[o.clone.wtTable.TBODY,n.clone.wtTable.TBODY,i.clone.wtTable.TBODY].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}getActualRowHeight(t){const e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&AU(this,jU)<e?e:AU(this,jU)}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{const n=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!0);void 0!==n&&kU(this,jU,n),this.setManualSize(e,AU(this,jU)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!0),o&&t()};if(AU(this,XU)>=2){const o=AU(this,VU).length;o>1?(A(AU(this,VU),(t=>{e(t)})),t()):A(AU(this,VU),(t=>{e(t,!0)}))}kU(this,XU,0),kU(this,qU,null)}bindEvents(){const{rootElement:t,rootWindow:e}=this.hot;this.eventManager.addEventListener(t,"mouseover",(t=>xU(this,ZU,l$).call(this,t))),this.eventManager.addEventListener(t,"mousedown",(t=>xU(this,t$,a$).call(this,t))),this.eventManager.addEventListener(e,"mousemove",(t=>xU(this,e$,h$).call(this,t))),this.eventManager.addEventListener(e,"mouseup",(()=>xU(this,o$,c$).call(this))),this.eventManager.addEventListener(AU(this,$U),"contextmenu",(()=>xU(this,n$,u$).call(this)))}destroy(){super.destroy()}}function l$(t){if(!to(t.target)&&!0!==AU(this,KU)&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(AU(this,YU)||this.setupHandlePosition(e))}}function a$(t){ue(t.target,"manualRowResizer")&&(this.setupHandlePosition(AU(this,DU)),this.setupGuidePosition(),kU(this,YU,!0),null===AU(this,qU)&&(kU(this,qU,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(AU(this,qU))),kU(this,XU,AU(this,XU)+1),kU(this,BU,t.pageY),kU(this,jU,AU(this,zU)))}function h$(t){AU(this,YU)&&(kU(this,FU,AU(this,zU)+(t.pageY-AU(this,BU))),A(AU(this,VU),(t=>{kU(this,jU,this.setManualSize(t,AU(this,FU)))})),this.refreshHandlePosition(),this.refreshGuidePosition())}function c$(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!1),o&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!1)};if(AU(this,YU)){if(this.hideHandleAndGuide(),kU(this,YU,!1),AU(this,jU)!==AU(this,zU)){const o=AU(this,VU).length;o>1?(A(AU(this,VU),(t=>{e(t)})),t()):A(AU(this,VU),(t=>{e(t,!0)}))}this.setupHandlePosition(AU(this,DU))}}function u$(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(AU(this,$U)),this.hot.rootElement.removeChild(AU(this,GU)),kU(this,YU,!1),kU(this,KU,!0),this.hot._registerImmediate((()=>{kU(this,KU,!1)}))}function d$(t,e){let o=t;if(this.enabled){const t=this.hot.toPhysicalRow(e),n=AU(this,QU).getValueAtIndex(t);this.hot.getSettings()[NU]&&n&&(o=n)}return o}function g$(){const t=this.hot.getSettings()[NU],e=this.loadManualRowHeights();this.hot.batchExecution((()=>{"undefined"!==typeof e?e.forEach(((t,e)=>{AU(this,QU).setValueAtIndex(e,t)})):Array.isArray(t)?(t.forEach(((t,e)=>{AU(this,QU).setValueAtIndex(e,t)})),kU(this,JU,t)):!0===t&&Array.isArray(AU(this,JU))&&AU(this,JU).forEach(((t,e)=>{AU(this,QU).setValueAtIndex(e,t)}))}),!0)}function f$(t,e,o){return e=m$(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function m$(t){var e=p$(t,"string");return"symbol"==typeof e?e:String(e)}function p$(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class w${constructor(t,e,o,n,i,r){f$(this,"row",void 0),f$(this,"col",void 0),f$(this,"rowspan",void 0),f$(this,"colspan",void 0),f$(this,"removed",!1),f$(this,"cellCoordsFactory",void 0),f$(this,"cellRangeFactory",void 0),this.row=t,this.col=e,this.rowspan=o,this.colspan=n,this.cellCoordsFactory=i,this.cellRangeFactory=r}static NEGATIVE_VALUES_WARNING(t){return B`The merged cell declared with {row: ${t.row}, col: ${t.col},\x20
      rowspan: ${t.rowspan}, colspan: ${t.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(t){return B`The merged cell declared at [${t.row}, ${t.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(t){return B`The merged cell declared at [${t.row}, ${t.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(t){return B`The merged cell declared at [${t.row}, ${t.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}static isSingleCell(t){return 1===t.colspan&&1===t.rowspan}static containsZeroSpan(t){return 0===t.colspan||0===t.rowspan}static isOutOfBounds(t,e,o){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=o||t.col+t.colspan-1>=o}normalize(t){const e=t.countRows(),o=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}includes(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}includesHorizontally(t){return this.col<=t&&this.col+this.colspan-1>=t}includesVertically(t){return this.row<=t&&this.row+this.rowspan-1>=t}shift(t,e){const o=t[0]||t[1],n=e+Math.abs(t[0]||t[1])-1,i=t[0]?"colspan":"rowspan",r=t[0]?"col":"row",s=Math.min(e,n),l=Math.max(e,n),a=this[r],h=this[r]+this[i]-1;if(a>=e&&(this[r]+=o),o>0)e<=h&&e>a&&(this[i]+=o);else if(o<0){if(s<=a&&l>=h)return this.removed=!0,!1;if(a>=s&&a<=l){const t=l-a+1,e=Math.abs(o)-t;this[r]-=e+o,this[i]-=t}else if(a<=s&&h>=l)this[i]+=o;else if(a<=s&&h>=s&&h<l){const t=h-s+1;this[i]-=t}}return!0}isFarther(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}var v$=w$;function C$(t,e,o,n){e?e.row===o&&e.col===n?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function y$(t,e,o){return e=b$(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function b$(t){var e=S$(t,"string");return"symbol"==typeof e?e:String(e)}function S$(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class R${constructor(t){y$(this,"plugin",void 0),y$(this,"mergedCells",[]),y$(this,"hot",void 0),this.plugin=t,this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){return B`The merged cell declared at [${t.row}, ${t.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(t,e){const o=this.mergedCells;let n=!1;return A(o,(o=>!(o.row<=t&&o.row+o.rowspan-1>=t&&o.col<=e&&o.col+o.colspan-1>=e)||(n=o,!1))),n}getByRange(t){const e=this.mergedCells;let o=!1;return A(e,(e=>!(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col)||(o=e,o))),o}getWithinRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.mergedCells,n=[];let i=t;if(!i.includesRange){const t=this.hot._createCellCoords(i.from.row,i.from.col),e=this.hot._createCellCoords(i.to.row,i.to.col);i=this.hot._createCellRange(t,t,e)}return A(o,(t=>{const o=this.hot._createCellCoords(t.row,t.col),r=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),s=this.hot._createCellRange(o,o,r);e?i.overlaps(s)&&n.push(t):i.includesRange(s)&&n.push(t)})),!!n.length&&n}add(t){const e=this.mergedCells,o=t.row,n=t.col,i=t.rowspan,r=t.colspan,s=new v$(o,n,i,r,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(o,n),a=this.isOverlapping(s);return l||a?(fn(R$.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),e.push(s),s)}remove(t,e){const o=this.mergedCells,n=this.get(t,e),i=n?this.mergedCells.indexOf(n):-1;return!(!n||-1===i)&&(o.splice(i,1),n)}clear(){const t=this.mergedCells,e=[],o=[];A(t,(t=>{const o=this.hot.getCell(t.row,t.col);o&&e.push([o,this.get(t.row,t.col),t.row,t.col])})),this.mergedCells.length=0,A(e,((t,n)=>{Vi(0,t.rowspan-1,(e=>{Vi(0,t.colspan-1,(n=>{if(0!==n||0!==e){const i=this.hot.getCell(t.row+e,t.col+n);i&&o.push([i,null,null,null])}}))})),e[n][1]=null})),A(e,(t=>{C$(...t)})),A(o,(t=>{C$(...t)}))}isOverlapping(t){const e=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1));let o=!1;return A(this.mergedCells,(t=>{const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1));return!n.overlaps(e)||(o=!0,!1)})),o}isFirstRenderableMergedCell(t,e){const o=this.get(t,e);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===e}getFirstRenderableCoords(t,e){const o=this.get(t,e);if(!o||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);const n=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(n,i)}shiftCollections(t,e,o){const n=[0,0];switch(t){case"right":n[0]+=o;break;case"left":n[0]-=o;break;case"down":n[1]+=o;break;case"up":n[1]-=o;break;default:}A(this.mergedCells,(t=>{t.shift(n,e)})),Fi(this.mergedCells.length-1,0,(t=>{const e=this.mergedCells[t];e&&e.removed&&this.mergedCells.splice(this.mergedCells.indexOf(e),1)}))}}var E$=R$;function T$(t,e,o){return e=M$(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function M$(t){var e=H$(t,"string");return"symbol"==typeof e?e:String(e)}function H$(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class x${constructor(t){T$(this,"plugin",void 0),T$(this,"mergedCellsCollection",void 0),T$(this,"currentFillData",null),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(t){if(t[0]===t[2]&&t[1]===t[3]){const e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}getDirection(t,e){let o=null;return o=e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left",o}snapDragArea(t,e,o,n){const i=e.slice(0),r=this.getAutofillSize(t,e,o),[s,l,a,h]=t,c=["up","down"].indexOf(o)>-1,u=c?a-s+1:h-l+1,d=Math.floor(r/u)*u,g=r-d,f=this.getFarthestCollection(t,e,o,n);if(f)if("down"===o){const t=f.row+f.rowspan-s-g,e=i[2]+t;e>=this.plugin.hot.countRows()?i[2]-=g:i[2]+=g?t:0}else if("right"===o){const t=f.col+f.colspan-l-g,e=i[3]+t;e>=this.plugin.hot.countCols()?i[3]-=g:i[3]+=g?t:0}else if("up"===o){const t=a-g-f.row+1,e=i[0]+t;e<0?i[0]+=g:i[0]-=g?t:0}else if("left"===o){const t=h-g-f.col+1,e=i[1]+t;e<0?i[1]+=g:i[1]-=g?t:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:o,foundMergedCells:n,fillSize:r,dragArea:i,cycleLength:u}),i}updateCurrentFillCache(t){this.currentFillData||(this.currentFillData={}),wo(this.currentFillData,t)}getAutofillSize(t,e,o){const[n,i,r,s]=t,[l,a,h,c]=e;switch(o){case"up":return n-l;case"down":return h-r;case"left":return i-a;case"right":return c-s;default:return null}}getDragArea(t,e,o){const[n,i,r,s]=t,[l,a,h,c]=e;switch(o){case"up":return[l,a,n-1,s];case"down":return[r+1,i,h,s];case"left":return[l,a,r,i-1];case"right":return[n,s+1,h,c];default:return null}}getFarthestCollection(t,e,o,n){const[i,r,s,l]=t,a=["up","down"].indexOf(o)>-1,h=a?s:l,c=a?i:r,u=this.getAutofillSize(t,e,o),d=a?s-i+1:l-r+1,g=Math.floor(u/d)*d,f=u-g;let m=null,p=null,w=null;switch(o){case"up":m="includesVertically",w=h-f+1;break;case"left":m="includesHorizontally",w=h-f+1;break;case"down":m="includesVertically",w=c+f-1;break;case"right":m="includesHorizontally",w=c+f-1;break;default:}return A(n,(t=>{t[m](w)&&t.isFarther(p,o)&&(p=t)})),p}recreateAfterDataPopulation(t){if(!this.currentFillData)return;const e=this.getRangeFromChanges(t),o=this.currentFillData.foundMergedCells,n=this.currentFillData.dragDirection,i=(t,o)=>{switch(n){case"up":return t.row-o>=e.from.row;case"down":return t.row+t.rowspan-1+o<=e.to.row;case"left":return t.col-o>=e.from.column;case"right":return t.col+t.colspan-1+o<=e.to.column;default:return null}};let r=0,s=null,l=1;do{for(let t=0;t<o.length;t+=1){if(s=o[t],r=l*this.currentFillData.cycleLength,i(s,r))switch(n){case"up":this.plugin.mergedCellsCollection.add({row:s.row-r,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+r,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-r,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+r,colspan:s.colspan});break;default:}t===o.length-1&&(l+=1)}}while(i(s,r));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(t){const e={min:null,max:null},o={min:null,max:null};return A(t,(t=>{const n=t[0],i=this.plugin.hot.propToCol(t[1]);(null===e.min||n<e.min)&&(e.min=n),(null===e.max||n>e.max)&&(e.max=n),(null===o.min||i<o.min)&&(o.min=i),(null===o.max||i>o.max)&&(o.max=i)})),{from:{row:e.min,column:o.min},to:{row:e.max,column:o.max}}}dragAreaOverlapsCollections(t,e,o){const n=this.getDragArea(t,e,o),[i,r,s,l]=n,a=this.plugin.hot._createCellCoords(i,r),h=this.plugin.hot._createCellCoords(s,l),c=this.plugin.hot._createCellRange(a,a,h);return!!this.mergedCellsCollection.getWithinRange(c,!0)}}var k$=x$;function I$(t,e,o){return e=A$(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function A$(t){var e=O$(t,"string");return"symbol"==typeof e?e:String(e)}function O$(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class P${constructor(t){I$(this,"plugin",void 0),I$(this,"hot",void 0),I$(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=t,this.hot=t.hot}snapDelta(t,e,o){const n=e.to,i=n.row+t.row,r=n.col+t.col;t.row?this.jumpOverMergedCell(t,o,i):t.col&&this.jumpOverMergedCell(t,o,r)}jumpOverMergedCell(t,e,o){let n=t.row||t.col,i=null,r=null,s=null;t.row?(i=e.includesVertically(o),r=e.row,s=e.getLastRow()):t.col&&(i=e.includesHorizontally(o),r=e.col,s=e.getLastColumn()),0!==n&&(n>0?i&&o!==r&&(n+=s-o+1):i&&o!==s&&(n-=o-r+1),t.row?t.row=n:t.col&&(t.col=n))}getUpdatedSelectionRange(t,e){return this.hot._createCellRange(t.highlight,t.from,this.hot._createCellCoords(t.to.row+e.row,t.to.col+e.col))}getSelectedMergedCellClassName(t,e,o,n){const i=Math.min(o[0],o[2]),r=Math.min(o[1],o[3]),s=Math.max(o[0],o[2]),l=Math.max(o[1],o[3]);if(void 0===n)return;const a=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e);if(!a)return;const h=this.plugin.mergedCellsCollection.get(t,e);if(!h)return;const c=h.getLastRow(),u=h.getLastColumn(),d=i<=h.row&&r<=h.col&&s>=c&&l>=u;return d?`${this.fullySelectedMergedCellClassName}-${n}`:this.plugin.selectionCalculations.isMergeCellFullySelected(h,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(t,e){const o=[];if(!e||!t)return!1;for(let n=0;n<t.rowspan;n+=1)for(let e=0;e<t.colspan;e+=1)o.push(this.hot._createCellCoords(t.row+n,t.col+e));for(let n=0;n<o.length;n+=1){const t=[];for(let i=0;i<e.length;i+=1)t[i]=e[i].includes(o[n]);if(!t.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const t=[];for(let e=0;e<=7;e+=1)t.push(`${this.fullySelectedMergedCellClassName}-${e}`);return t.push(`${this.fullySelectedMergedCellClassName}-multiple`),t}}var N$=P$;function _$(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const o=t.mergedCellsCollection.get(e[0],e[1]);if(o.row===e[0]&&o.col===e[1]&&o.row+o.rowspan-1===e[2]&&o.col+o.colspan-1===e[3])return this.getTranslatedPhrase(ag)}return this.getTranslatedPhrase(lg)},callback(){t.toggleMergeOnSelection()},disabled(){const t=this.getSelectedLast();if(!t)return!0;const e=v$.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1});return e||this.selection.isSelectedByCorner()},hidden:!1}}function L$(t,e){W$(t,e),e.add(t)}function D$(t,e,o){W$(t,e),e.set(t,o)}function W$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function V$(t,e,o){return e=F$(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function F$(t){var e=j$(t,"string");return"symbol"==typeof e?e:String(e)}function j$(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function B$(t,e,o){var n=$$(t,e,"set");return z$(t,n,o),o}function z$(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function U$(t,e){var o=$$(t,e,"get");return G$(t,o)}function $$(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function G$(t,e){return e.get?e.get.call(t):e.value}function Y$(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}Mn.getSingleton().register("beforeMergeCells"),Mn.getSingleton().register("afterMergeCells"),Mn.getSingleton().register("beforeUnmergeCells"),Mn.getSingleton().register("afterUnmergeCells");const K$="mergeCells",X$=150,q$=K$;var Q$=new WeakMap,J$=new WeakSet,Z$=new WeakSet,tG=new WeakSet,eG=new WeakSet,oG=new WeakSet,nG=new WeakSet,iG=new WeakSet,rG=new WeakSet,sG=new WeakSet,lG=new WeakSet,aG=new WeakSet,hG=new WeakSet,cG=new WeakSet,uG=new WeakSet,dG=new WeakSet,gG=new WeakSet,fG=new WeakSet,mG=new WeakSet,pG=new WeakSet,wG=new WeakSet,vG=new WeakSet,CG=new WeakSet;class yG extends _S{constructor(){super(...arguments),L$(this,CG),L$(this,vG),L$(this,wG),L$(this,pG),L$(this,mG),L$(this,fG),L$(this,gG),L$(this,dG),L$(this,uG),L$(this,cG),L$(this,hG),L$(this,aG),L$(this,lG),L$(this,sG),L$(this,rG),L$(this,iG),L$(this,nG),L$(this,oG),L$(this,eG),L$(this,tG),L$(this,Z$),L$(this,J$),V$(this,"mergedCellsCollection",null),V$(this,"autofillCalculations",null),V$(this,"selectionCalculations",null),D$(this,Q$,{writable:!0,value:null})}static get PLUGIN_KEY(){return K$}static get PLUGIN_PRIORITY(){return X$}isEnabled(){return!!this.hot.getSettings()[K$]}enablePlugin(){var t=this;this.enabled||(this.mergedCellsCollection=new E$(this),this.autofillCalculations=new k$(this),this.selectionCalculations=new N$(this),this.addHook("afterInit",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,J$,bG).call(t,...o)})),this.addHook("modifyTransformStart",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,tG,RG).call(t,...o)})),this.addHook("afterModifyTransformStart",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,wG,FG).call(t,...o)})),this.addHook("modifyTransformEnd",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,eG,EG).call(t,...o)})),this.addHook("modifyGetCellCoords",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,oG,TG).call(t,...o)})),this.addHook("beforeSetRangeStart",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,rG,xG).call(t,...o)})),this.addHook("beforeSetRangeStartOnly",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,rG,xG).call(t,...o)})),this.addHook("beforeSetRangeEnd",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,sG,kG).call(t,...o)})),this.addHook("afterIsMultipleSelection",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,Z$,SG).call(t,...o)})),this.addHook("afterRenderer",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,iG,HG).call(t,...o)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,nG,MG).call(t,...o)})),this.addHook("afterGetCellMeta",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,lG,IG).call(t,...o)})),this.addHook("afterViewportRowCalculatorOverride",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,aG,AG).call(t,...o)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,hG,OG).call(t,...o)})),this.addHook("modifyAutofillRange",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,cG,PG).call(t,...o)})),this.addHook("afterCreateCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,uG,NG).call(t,...o)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,dG,_G).call(t,...o)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,gG,LG).call(t,...o)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,fG,DG).call(t,...o)})),this.addHook("afterChange",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,mG,WG).call(t,...o)})),this.addHook("beforeDrawBorders",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,pG,VG).call(t,...o)})),this.addHook("afterDrawSelection",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,vG,jG).call(t,...o)})),this.addHook("beforeRemoveCellClassNames",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Y$(t,CG,BG).call(t,...o)})),this.addHook("beforeUndoStackChange",((t,e)=>{if("MergeCells"===e)return!1})),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const t=this.hot.getSettings()[K$];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),super.updatePlugin()}ifChromeForceRepaint(){if(!Bo())return;const t=[];let e=[];this.mergedCellsCollection.mergedCells.forEach((t=>{const{row:o,rowspan:n}=t;for(let i=o+1;i<o+n;i++)e.push(i)})),e=[...new Set(e)],e.forEach((e=>{const o=this.hot.rowIndexMapper.getRenderableFromVisualIndex(e);this.hot.view._wt.wtOverlays.getOverlays(!0).map((t=>"master"===(null===t||void 0===t?void 0:t.name)?t:t.clone.wtTable)).forEach((e=>{const n=e.getRow(o);n&&(n.style.background=ke(n,"backgroundColor").replace(")",", 0.99)"),t.push(n))}))})),this.hot._registerTimeout((()=>{t.forEach((t=>{t.style.background=ke(t,"backgroundColor").replace(", 0.99)",")")}))}),1)}validateSetting(t){let e=!0;return!!t&&(v$.containsNegativeValues(t)?(fn(v$.NEGATIVE_VALUES_WARNING(t)),e=!1):v$.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(fn(v$.IS_OUT_OF_BOUNDS_WARNING(t)),e=!1):v$.isSingleCell(t)?(fn(v$.IS_SINGLE_CELL(t)),e=!1):v$.containsZeroSpan(t)&&(fn(v$.ZERO_SPAN_WARNING(t)),e=!1),e)}generateFromSettings(t){if(Array.isArray(t)){const e=[];if(A(t,(t=>{if(!this.validateSetting(t))return;const o=this.hot._createCellCoords(t.row,t.col),n=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),i=this.hot._createCellRange(o,o,n);this.mergeRange(i,!0,!0),Vi(t.row,t.row+t.rowspan-1,(o=>{Vi(t.col,t.col+t.colspan-1,(n=>{!1===(o===t.row&&n===t.col)&&e.push([o,n,null])}))}))})),0===e.length)return;this.hot.setDataAtCell(e)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!e||this.validateSetting(t)}toggleMergeOnSelection(){const t=this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:e,to:o}=t;this.toggleMerge(t),this.hot.selectCell(e.row,e.col,o.row,o.col,!1)}mergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:e,to:o}=t;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,o.row,o.col,!1)}unmergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;const{from:e,to:o}=t;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,o.row,o.col,!1)}mergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=t.getTopStartCorner(),i=t.getBottomEndCorner(),r={row:n.row,col:n.col,rowspan:i.row-n.row+1,colspan:i.col-n.col+1},s=[];let l=null;if(!this.canMergeRange(r,e))return!1;this.hot.runHooks("beforeMergeCells",t,e),Vi(0,r.rowspan-1,(t=>{Vi(0,r.colspan-1,(e=>{let o=null;s[t]||(s[t]=[]),0===t&&0===e?o=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r.row),this.hot.toPhysicalColumn(r.col)):this.hot.setCellMeta(r.row+t,r.col+e,"hidden",!0),s[t][e]=o}))})),this.hot.setCellMeta(r.row,r.col,"spanned",!0);const a=this.mergedCellsCollection.add(r);return!a||(o?l=[r.row,r.col,s]:this.hot.populateFromArray(r.row,r.col,s,void 0,void 0,this.pluginName),e||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,r,e),l)}unmergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.mergedCellsCollection.getWithinRange(t);o&&(this.hot.runHooks("beforeUnmergeCells",t,e),A(o,(t=>{this.mergedCellsCollection.remove(t.row,t.col),Vi(0,t.rowspan-1,(e=>{Vi(0,t.colspan-1,(o=>{this.hot.removeCellMeta(t.row+e,t.col+o,"hidden"),this.hot.removeCellMeta(t.row+e,t.col+o,"copyable")}))})),this.hot.removeCellMeta(t.row,t.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",t,e),this.hot.render())}toggleMerge(t){const e=this.mergedCellsCollection.get(t.from.row,t.from.col),o=e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col;o?this.unmergeRange(t):this.mergeSelection(t)}merge(t,e,o,n){const i=this.hot._createCellCoords(t,e),r=this.hot._createCellCoords(o,n);this.mergeRange(this.hot._createCellRange(i,i,r))}unmerge(t,e,o,n){const i=this.hot._createCellCoords(t,e),r=this.hot._createCellCoords(o,n);this.unmergeRange(this.hot._createCellRange(i,i,r))}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid");e.addShortcut({keys:[["Control","m"]],callback:()=>{const t=this.hot.getSelectedRangeLast();t&&!t.isSingleHeader()&&(this.toggleMerge(t),this.hot.render())},runOnlyIf:t=>!t.altKey,group:q$})}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(q$)}modifyViewportRowStart(t,e){const o=this.hot.rowIndexMapper,n=o.getVisualFromRenderableIndex(t.startRow);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(n,i);if(Ro(r)){const n=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r.row,1));if(n<t.startRow)return t.startRow=n,void this.modifyViewportRowStart(t,e)}}}modifyViewportRowEnd(t,e){const o=this.hot.rowIndexMapper,n=o.getVisualFromRenderableIndex(t.endRow);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(n,i);if(Ro(r)){const n=r.row+r.rowspan-1,i=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1));if(i>t.endRow)return t.endRow=i,void this.modifyViewportRowEnd(t,e)}}}modifyViewportColumnStart(t,e){const o=this.hot.columnIndexMapper,n=o.getVisualFromRenderableIndex(t.startColumn);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(i,n);if(Ro(r)){const n=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r.col,1));if(n<t.startColumn)return t.startColumn=n,void this.modifyViewportColumnStart(t,e)}}}modifyViewportColumnEnd(t,e){const o=this.hot.columnIndexMapper,n=o.getVisualFromRenderableIndex(t.endColumn);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(i,n);if(Ro(r)){const n=r.col+r.colspan-1,i=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1));if(i>t.endColumn)return t.endColumn=i,void this.modifyViewportColumnEnd(t,e)}}}translateMergedCellToRenderable(t,e,o,n){const{rowIndexMapper:i,columnIndexMapper:r}=this.hot;let s,l;s=0===e?i.getNearestNotHiddenIndex(t,1):i.getNearestNotHiddenIndex(t+e-1,-1),l=0===n?r.getNearestNotHiddenIndex(o,1):r.getNearestNotHiddenIndex(o+n-1,-1);const a=t>=0?i.getRenderableFromVisualIndex(s):t,h=o>=0?r.getRenderableFromVisualIndex(l):o;return[a,h]}}function bG(){this.generateFromSettings(this.hot.getSettings()[K$]),this.hot.render()}function SG(t){if(t){const t=this.mergedCellsCollection.mergedCells,e=this.hot.getSelectedRangeLast();for(let o=0;o<t.length;o+=1)if(e.from.row===t[o].row&&e.from.col===t[o].col&&e.to.row===t[o].row+t[o].rowspan-1&&e.to.col===t[o].col+t[o].colspan-1)return!1}return t}function RG(t){const e=this.hot.getSelectedRangeLast();let o={row:t.row,col:t.col},n=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),r=this.mergedCellsCollection.get(i.row,i.col);if(U$(this,Q$)||B$(this,Q$,this.hot._createCellCoords(null,null)),r){const e=this.hot._createCellCoords(r.row,r.col),n=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(e,e,n);s.includes(U$(this,Q$))||B$(this,Q$,this.hot._createCellCoords(null,null)),o.row=U$(this,Q$).row?U$(this,Q$).row-i.row:o.row,o.col=U$(this,Q$).col?U$(this,Q$).col-i.col:o.col,t.row>0?o.row=r.row+r.rowspan-1-i.row+t.row:t.row<0&&(o.row=i.row-r.row+t.row),t.col>0?o.col=r.col+r.colspan-1-i.col+t.col:t.col<0&&(o.col=i.col-r.col+t.col)}n=this.hot._createCellCoords(e.highlight.row+o.row,e.highlight.col+o.col);const s=this.mergedCellsCollection.get(n.row,n.col);if(s){const t=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);B$(this,Q$,n),o={row:t.row-i.row,col:t.col-i.col}}0!==o.row&&(t.row=o.row),0!==o.col&&(t.col=o.col)}function EG(t){const e=this.hot.getSelectedRangeLast(),o=yo(t),n=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=yo(o);const r=this.mergedCellsCollection.getWithinRange(n,!0);do{i=yo(o),this.selectionCalculations.getUpdatedSelectionRange(e,o),A(r,(t=>{this.selectionCalculations.snapDelta(o,e,t)}))}while(o.row!==i.row||o.col!==i.col);t.row=o.row,t.col=o.col}function TG(t,e){if(t<0||e<0)return;const o=this.mergedCellsCollection.get(t,e);if(!o)return;const{row:n,col:i,colspan:r,rowspan:s}=o;return[n,i,n+s-1,i+r-1]}function MG(t){t.items.push({name:"---------"},_$(this))}function HG(t,e,o){const n=this.mergedCellsCollection.get(e,o),i=Ro(n)?yo(n):void 0;if(Ro(i)){const{rowIndexMapper:t,columnIndexMapper:n}=this.hot,{row:r,col:s,colspan:l,rowspan:a}=i,[h,c]=this.translateMergedCellToRenderable(r,a,s,l),u=t.getRenderableFromVisualIndex(e),d=n.getRenderableFromVisualIndex(o),g=h-u+1,f=c-d+1;i.row=t.getNearestNotHiddenIndex(i.row,1),i.col=n.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,g),i.colspan=Math.min(i.colspan,f)}C$(t,i,e,o)}function xG(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function kG(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let o=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{o=!1;for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1){const i=this.mergedCellsCollection.mergedCells[n],r=i.getRange();e.expandByRange(r)&&(t.row=e.to.row,t.col=e.to.col,o=!0)}}while(o)}function IG(t,e,o){const n=this.mergedCellsCollection.get(t,e);n&&(n.row!==t||n.col!==e?o.copyable=!1:(o.rowspan=n.rowspan,o.colspan=n.colspan))}function AG(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function OG(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function PG(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const o=this.autofillCalculations.getDirection(e,t);let n=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,n,o))return n=e,n;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i?(n=this.autofillCalculations.snapDragArea(e,n,o,i),n):n}function NG(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function _G(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function LG(t,e,o){"auto"!==o&&this.mergedCellsCollection.shiftCollections("down",t,e)}function DG(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function WG(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}function VG(t,e){if(e&&"area"===e){const e=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getWithinRange(e);A(o,(o=>{e.getBottomEndCorner().row===o.getLastRow()&&e.getBottomEndCorner().col===o.getLastColumn()&&(t[2]=o.row,t[3]=o.col)}))}}function FG(t,e,o){if(!this.enabled)return;const n=this.mergedCellsCollection.get(t.row,t.col);if(!n)return;const i=e>0,r=e<0,s=o<0,l=o>0,a=n.row+n.rowspan-1===this.hot.countRows()-1,h=0===n.row,c=n.col+n.colspan-1===this.hot.countCols()-1,u=0===n.col;(i&&a||r&&h||l&&c||s&&u)&&(t.row=n.row,t.col=n.col)}function jG(t,e,o,n){if(o)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,o,n)}function BG(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function zG(t,e){return function(o,n){const[,...i]=o,[,...r]=n;return function o(n){const s=t[n],l=e[n],a=i[n],h=r[n],c=l.multiColumnSorting,u=c.compareFunctionFactory?c.compareFunctionFactory:qT(l.type),d=u(s,l,c)(a,h);if(d===PT){const t=n+1;if("undefined"!==typeof e[t])return o(t)}return d}(0)}}function UG(){fn(B`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const $G="sort";function GG(t,e,o){const n=[];return!1===o||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push(`${$G}-${t.getIndexOfColumnInSortQueue(e)+1}`),n}function YG(t){const e=t.className.split(" "),o=new RegExp(`^${$G}-[0-9]{1,2}$`);return e.filter((t=>o.test(t)))}function KG(t,e,o){return e=XG(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function XG(t){var e=qG(t,"string");return"symbol"==typeof e?e:String(e)}function qG(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const QG="multiColumnSorting",JG=170,ZG="columnSorting",tY=QG;KT(QG,zG);class eY extends gM{constructor(){super(...arguments),KG(this,"pluginKey",QG)}static get PLUGIN_KEY(){return QG}static get PLUGIN_PRIORITY(){return JG}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[ZG]&&UG(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();-1===t.row&&t.col>=0&&this.sort(this.getNextSortConfig(t.col,sM))},runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()},group:tY})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tY)}sort(t){super.sort(t)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(t){return super.getSortConfig(t)}setSortConfig(t){super.setSortConfig(t)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}updateHeaderClasses(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];super.updateHeaderClasses(t,...o),ge(t,YG(t)),!1!==this.enabled&&de(t,GG(...o))}onUpdateSettings(t){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[ZG]&&UG(),super.onUpdateSettings(t)}onAfterOnCellMouseDown(t,e){!1!==ET(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,sM))):this.sort(this.getColumnNextConfig(e.col)))}}function oY(t,e,o){return e=nY(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function nY(t){var e=iY(t,"string");return"symbol"==typeof e?e:String(e)}function iY(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const rY="multipleSelectionHandles",sY=160;class lY extends _S{constructor(){super(...arguments),oY(this,"dragged",[]),oY(this,"lastSetCell",null)}static get PLUGIN_KEY(){return rY}static get PLUGIN_PRIORITY(){return sY}isEnabled(){return Xo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const t=this,{rootElement:e}=this.hot;function o(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;const o=t.dragged.indexOf(e);if(-1===o)return!1;0===o?t.dragged=t.dragged.slice(0,1):1===o&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(e,"touchstart",(e=>{let o;return ue(e.target,"topSelectionHandle-HitArea")?(o=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},e.preventDefault(),!1):ue(e.target,"bottomSelectionHandle-HitArea")?(o=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(e,"touchend",(e=>ue(e.target,"topSelectionHandle-HitArea")?(o.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):ue(e.target,"bottomSelectionHandle-HitArea")?(o.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0)),this.eventManager.addEventListener(e,"touchmove",(e=>{const{rootDocument:o}=this.hot;let n,i,r,s,l,a;if(0===t.dragged.length)return;const h=o.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);h&&h!==t.lastSetCell&&("TD"!==h.nodeName&&"TH"!==h.nodeName||(n=t.hot.getCoords(h),-1===n.col&&(n.col=0),i=t.hot.getSelectedRangeLast(),r=i.getWidth(),s=i.getHeight(),l=i.getDirection(),1===r&&1===s&&t.hot.selection.setRangeEnd(n),a=t.getCurrentRangeCoords(i,n,t.touchStartRange.direction,l,t.dragged[0]),null!==a.start&&t.hot.selection.setRangeStart(a.start),t.hot.selection.setRangeEnd(a.end),t.lastSetCell=h),e.preventDefault())}))}getCurrentRangeCoords(t,e,o,n,i){const r=t.getTopStartCorner(),s=t.getBottomEndCorner(),l=t.getBottomStartCorner(),a=t.getTopEndCorner();let h={start:null,end:null};switch(o){case"NE-SW":switch(n){case"NE-SW":case"NW-SE":h="top"===i?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,r.col)};break;case"SE-NW":"bottom"===i&&(h={start:this.hot._createCellCoords(s.row,e.col),end:this.hot._createCellCoords(e.row,r.col)});break;default:break}break;case"NW-SE":switch(n){case"NE-SW":"top"===i?h={start:e,end:l}:h.end=e;break;case"NW-SE":"top"===i?h={start:e,end:s}:h.end=e;break;case"SE-NW":"top"===i?h={start:e,end:r}:h.end=e;break;case"SW-NE":"top"===i?h={start:e,end:a}:h.end=e;break;default:break}break;case"SW-NE":switch(n){case"NW-SE":h="bottom"===i?{start:this.hot._createCellCoords(e.row,r.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(r.row,e.col),end:this.hot._createCellCoords(e.row,s.col)};break;case"SW-NE":h="top"===i?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,s.col)}:{start:this.hot._createCellCoords(e.row,r.col),end:this.hot._createCellCoords(r.row,e.col)};break;case"SE-NW":"bottom"===i?h={start:this.hot._createCellCoords(e.row,a.col),end:this.hot._createCellCoords(r.row,e.col)}:"top"===i&&(h={start:l,end:e});break;default:break}break;case"SE-NW":switch(n){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(h.end=e);break;case"SE-NW":"top"===i?h.end=e:h={start:e,end:r};break;default:break}break;default:break}return h}isDragged(){return this.dragged.length>0}}function aY(){let{label:t="",colspan:e=1,origColspan:o=1,collapsible:n=!1,crossHiddenColumns:i=[],isCollapsed:r=!1,isHidden:s=!1,isRoot:l=!1,isPlaceholder:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:t,colspan:e,origColspan:o,collapsible:n,isCollapsed:r,crossHiddenColumns:i,isHidden:s,isRoot:l,isPlaceholder:a}}function hY(){return{label:"",isPlaceholder:!0}}function cY(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const o=[];if(0===e)return o;A(t,(t=>{const n=[];let i=0;o.push(n),A(t,(t=>{const o=aY();if(Ro(t)){const{label:e,colspan:n}=t;o.label=z(e),"number"===typeof n&&n>1&&(o.colspan=n,o.origColspan=n)}else o.label=z(t);i+=o.origColspan;let r=!1;if(i>=e&&(o.colspan=o.origColspan-(i-e),o.origColspan=o.colspan,r=!0),n.push(o),o.colspan>1)for(let e=0;e<o.colspan-1;e++)n.push(hY());return!r}))}));const n=Math.max(...I(o,(t=>t.length)));return A(o,(t=>{if(t.length<n){const e=I(new Array(n-t.length),(()=>aY()));t.splice(t.length,0,...e)}})),o}function uY(t,e,o){dY(t,e),e.set(t,o)}function dY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gY(t,e){var o=pY(t,e,"get");return fY(t,o)}function fY(t,e){return e.get?e.get.call(t):e.value}function mY(t,e,o){var n=pY(t,e,"set");return wY(t,n,o),o}function pY(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function wY(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const vY=["label","collapsible"];var CY=new WeakMap,yY=new WeakMap,bY=new WeakMap;class SY{constructor(){uY(this,CY,{writable:!0,value:[]}),uY(this,yY,{writable:!0,value:0}),uY(this,bY,{writable:!0,value:1/0})}setColumnsLimit(t){mY(this,bY,t)}setData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];mY(this,CY,cY(t,gY(this,bY))),mY(this,yY,gY(this,CY).length)}getData(){return gY(this,CY)}mergeWith(t){A(t,(t=>{let{row:e,col:o,...n}=t;const i=this.getHeaderSettings(e,o);null!==i&&wo(i,n,vY)}))}map(t){A(gY(this,CY),(e=>{A(e,(e=>{const o=t({...e});Ro(o)&&wo(e,o,vY)}))}))}getHeaderSettings(t,e){var o;if(t>=gY(this,yY)||t<0)return null;const n=gY(this,CY)[t];return e>=n.length?null:null!==(o=n[e])&&void 0!==o?o:null}getHeadersSettings(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const n=[];if(t>=gY(this,yY)||t<0)return n;const i=gY(this,CY)[t];let r=0;for(let s=e;s<i.length;s++){const t=i[s];if(t.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(r+=t.colspan,n.push(t),t.colspan>1&&(s+=t.colspan-1),r===o)break;if(r>o)throw new Error("The last column settings cannot overlap the other header layers")}return n}getLayersCount(){return gY(this,yY)}getColumnsCount(){return gY(this,yY)>0?gY(this,CY)[0].length:0}clear(){mY(this,CY,[]),mY(this,yY,0)}}function RY(t,e,o){return e=EY(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function EY(t){var e=TY(t,"string");return"symbol"==typeof e?e:String(e)}function TY(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const MY="DF-pre-order";function HY(t,e){let o=t.call(e,this);for(let n=0;n<this.childs.length;n++){if(!1===o)return!1;o=HY.call(this.childs[n],t,e)}return o}const xY="DF-post-order";function kY(t,e){for(let o=0;o<this.childs.length;o++){const n=kY.call(this.childs[o],t,e);if(!1===n)return!1}return t.call(e,this)}const IY="BF";function AY(t,e){const o=[this];function n(){if(0===o.length)return;const i=o.shift();o.push(...i.childs),!1!==t.call(e,i)&&n()}n()}const OY=IY,PY=new Map([[MY,HY],[xY,kY],[IY,AY]]);class NY{constructor(t){RY(this,"data",{}),RY(this,"parent",null),RY(this,"childs",[]),this.data=t}addChild(t){t.parent=this,this.childs.push(t)}cloneTree(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const e=new NY({...t.data});for(let o=0;o<t.childs.length;o++)e.addChild(this.cloneTree(t.childs[o]));return e}replaceTreeWith(t){this.data={...t.data},this.childs=[];for(let e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}walkDown(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:OY;if(!PY.has(e))throw new Error(`Traversal strategy "${e}" does not exist`);PY.get(e).call(this,t,this)}walkUp(t){const e=this,o=n=>{const i=t.call(e,n);!1!==i&&null!==n.parent&&o(n.parent)};o(this)}}function _Y(t,e,o){LY(t,e),e.set(t,o)}function LY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DY(t,e){var o=FY(t,e,"get");return WY(t,o)}function WY(t,e){return e.get?e.get.call(t):e.value}function VY(t,e,o){var n=FY(t,e,"set");return jY(t,n,o),o}function FY(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function jY(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var BY=new WeakMap,zY=new WeakMap,UY=new WeakMap;class $Y{constructor(t){_Y(this,BY,{writable:!0,value:new Map}),_Y(this,zY,{writable:!0,value:new Map}),_Y(this,UY,{writable:!0,value:null}),VY(this,UY,t)}getRoots(){return Array.from(DY(this,BY).values())}getRootByColumn(t){let e;return DY(this,zY).has(t)&&(e=DY(this,BY).get(DY(this,zY).get(t))),e}getNode(t,e){const o=this.getRootByColumn(e);if(!o)return;const n=e-DY(this,zY).get(e);let i,r=0;return o.walkDown((o=>{const{data:{origColspan:s,headerLevel:l}}=o;if(t===l){if(n>=r&&n<=r+s-1)return i=o,i.data.isRoot=e===i.data.columnIndex,!1;r+=s}})),i}rebuildTreeIndex(){let t=0;DY(this,zY).clear(),A(DY(this,BY),(e=>{let[,{data:{colspan:o}}]=e;for(let n=t;n<t+o;n++)DY(this,zY).set(n,t);t+=o}))}buildTree(){this.clear();const t=DY(this,UY).getColumnsCount();let e=0;while(e<t){const t=DY(this,UY).getHeaderSettings(0,e),o=new NY;DY(this,BY).set(e,o),this.buildLeaves(o,e,0,t.origColspan),e+=t.origColspan}this.rebuildTreeIndex()}buildLeaves(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=DY(this,UY).getHeadersSettings(o,e,n);o+=1,A(i,(n=>{const i={...n,headerLevel:o-1,columnIndex:e};let r;1===o?(t.data=i,r=t):(r=new NY(i),t.addChild(r)),o<DY(this,UY).getLayersCount()&&this.buildLeaves(r,e,o,n.origColspan),e+=n.origColspan}))}clear(){DY(this,BY).clear(),DY(this,zY).clear()}}function GY(t,e){t.walkDown((t=>{let{data:o,childs:n}=t;if(!o.isHidden&&(e(o.columnIndex),0===n.length))for(let i=1;i<o.colspan;i++)e(o.columnIndex+i)}))}function YY(t,e){let{childs:o}=t;if(0!==o.length)return o[0].data[e]}function KY(t){return YY(t,"origColspan")===t.data.origColspan}function XY(t){const{data:e,childs:o}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};const n=KY(t);if(n)return XY(o[0]);e.isCollapsed=!1;const i=o.slice(1),r=new Set;let s=0;if(i.length>0)A(i,(t=>{t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;const e=t.data;s+=e.colspan,GY(t,(t=>{r.add(t)}))}));else{const{colspan:t,origColspan:o,columnIndex:n}=e;s=o-t;for(let e=1;e<o;e++)r.add(n+e)}return t.walkUp((t=>{const{data:e}=t;e.colspan+=s,e.colspan>=e.origColspan?(e.colspan=e.origColspan,e.isCollapsed=!1):KY(t)&&(e.isCollapsed=YY(t,"isCollapsed"))})),{rollbackModification:()=>qY(t),affectedColumns:Array.from(r),colspanCompensation:s}}function qY(t){var e;const{data:o,childs:n}=t;if(o.isCollapsed||o.isHidden||o.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};const i=KY(t);if(i)return qY(n[0]);o.isCollapsed=!0;const r=n.slice(1),s=new Set;if(r.length>0)A(r,(t=>{GY(t,(t=>{s.add(t)})),t.data.clonedTree=t.cloneTree(),t.walkDown((t=>{let{data:e}=t;e.isHidden=!0}))}));else{const{origColspan:t,columnIndex:e}=o;for(let o=1;o<t;o++){const t=e+o;s.add(t)}}const l=o.colspan-(null!==(e=YY(t,"colspan"))&&void 0!==e?e:1);return t.walkUp((t=>{const{data:e}=t;e.colspan-=l,e.colspan<=1?(e.colspan=1,e.isCollapsed=!0):KY(t)&&(e.isCollapsed=YY(t,"isCollapsed"))})),{rollbackModification:()=>XY(t),affectedColumns:Array.from(s),colspanCompensation:l}}function QY(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(B`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:o}=t.data;if(o.includes(e))return;let n=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return n=!0,!1})),n||t.walkUp((t=>{const{data:o}=t;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0}))}function JY(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(B`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:o}=t.data;if(!o.includes(e))return;let n=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return n=!0,!1})),n||t.walkUp((t=>{const{data:o}=t;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1}))}const ZY=new Map([["collapse",qY],["expand",XY],["hide-column",QY],["show-column",JY]]);function tK(t,e,o){if(!ZY.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return ZY.get(t)(e,o)}function eK(t){const e=[];return A(t,(t=>{t.walkDown((t=>{const o=t.data,{origColspan:n,columnIndex:i,headerLevel:r,crossHiddenColumns:s}=o,l=nK(e,r);let a=!1;for(let e=i;e<i+n;e++){const t=s.includes(e);if(t||a)l.push(hY(o));else{const t=oK(o);t.isRoot=!0,l.push(t),a=!0}}}))})),e}function oK(t){const{crossHiddenColumns:e,...o}=aY(t);return o}function nK(t,e){let o;return Array.isArray(t[e])?o=t[e]:(o=[],t[e]=o),o}function iK(t,e,o){rK(t,e),e.set(t,o)}function rK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sK(t,e,o){var n=hK(t,e,"set");return lK(t,n,o),o}function lK(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function aK(t,e){var o=hK(t,e,"get");return cK(t,o)}function hK(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function cK(t,e){return e.get?e.get.call(t):e.value}var uK=new WeakMap,dK=new WeakMap,gK=new WeakMap;class fK{constructor(){iK(this,uK,{writable:!0,value:new SY}),iK(this,dK,{writable:!0,value:new $Y(aK(this,uK))}),iK(this,gK,{writable:!0,value:[[]]})}setState(t){aK(this,uK).setData(t);let e=!1;try{aK(this,dK).buildTree()}catch(o){aK(this,dK).clear(),aK(this,uK).clear(),e=!0}return sK(this,gK,eK(aK(this,dK).getRoots())),e}setColumnsLimit(t){aK(this,uK).setColumnsLimit(t)}mergeStateWith(t){const e=I(t,(t=>{let{row:e,...o}=t;return{row:e<0?this.rowCoordsToLevel(e):e,...o}}));aK(this,uK).mergeWith(e),aK(this,dK).buildTree(),sK(this,gK,eK(aK(this,dK).getRoots()))}mapState(t){aK(this,uK).map(t),aK(this,dK).buildTree(),sK(this,gK,eK(aK(this,dK).getRoots()))}mapNodes(t){return x(aK(this,dK).getRoots(),((e,o)=>(o.walkDown((o=>{const n=t(o.data);void 0!==n&&e.push(n)})),e)),[])}triggerNodeModification(t,e,o){e<0&&(e=this.rowCoordsToLevel(e));const n=aK(this,dK).getNode(e,o);let i;return n&&(i=tK(t,n,o),sK(this,gK,eK(aK(this,dK).getRoots()))),i}triggerColumnModification(t,e){return this.triggerNodeModification(t,-1,e)}rowCoordsToLevel(t){if(t>=0)return null;const e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}levelToRowCoords(t){if(t<0)return null;const e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}getHeaderSettings(t,e){var o,n;return t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount()?null:null!==(o=null===(n=aK(this,gK)[t])||void 0===n?void 0:n[e])&&void 0!==o?o:null}getHeaderTreeNodeData(t,e){const o=this.getHeaderTreeNode(t,e);return o?{...o.data}:null}getHeaderTreeNode(t,e){if(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())return null;const o=aK(this,dK).getNode(t,e);return o||null}findTopMostEntireHeaderLevel(t){var e;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;const n=o-t+1;let i=!1,r=null;for(let s=t;s<=o;s++){const e=aK(this,dK).getRootByColumn(s);if(!e)break;i=!0,e.walkDown((e=>{const{columnIndex:i,headerLevel:s,origColspan:l,isHidden:a}=e.data;a||l<=n&&i>=t&&i+l-1<=o&&(null===r||s<r)&&(r=s)}),MY)}return i&&null===r?-1:this.levelToRowCoords(null!==(e=r)&&void 0!==e?e:0)}findLeftMostColumnIndex(t,e){var o;const{isRoot:n}=null!==(o=this.getHeaderSettings(t,e))&&void 0!==o?o:{isRoot:!0};if(n)return e;let i=e-1;while(i>=0){var r;const{isRoot:e}=null!==(r=this.getHeaderSettings(t,i))&&void 0!==r?r:{isRoot:!0};if(e)break;i-=1}return i}findRightMostColumnIndex(t,e){var o;const{isRoot:n,origColspan:i}=null!==(o=this.getHeaderSettings(t,e))&&void 0!==o?o:{isRoot:!0,origColspan:1};if(n)return e+i-1;let r=e+1;while(r<this.getColumnsCount()){var s;const{isRoot:e}=null!==(s=this.getHeaderSettings(t,r))&&void 0!==s?s:{isRoot:!0};if(e)break;r+=1}return r-1}getLayersCount(){return aK(this,uK).getLayersCount()}getColumnsCount(){return aK(this,uK).getColumnsCount()}clear(){sK(this,gK,[]),aK(this,uK).clear(),aK(this,dK).clear()}}function mK(t,e,o){return e=pK(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function pK(t){var e=wK(t,"string");return"symbol"==typeof e?e:String(e)}function wK(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class vK{constructor(t,e){mK(this,"hot",void 0),mK(this,"nestedHeaderSettingsGetter",void 0),mK(this,"layersCount",0),mK(this,"container",void 0),mK(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=e,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(t){return this.layersCount=t,this}getWidth(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length;this.widthsMap.clear();for(let o=0;o<e;o++){const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),n=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(n,t[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(t){const{rootDocument:e,columnIndexMapper:o}=this.hot,n=e.createDocumentFragment(),i=e.createElement("table"),r=!!this.hot.getSettings().dropdownMenu,s=o.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const t=e.createElement("tr");for(let n=0;n<s;n++){let i=o.getVisualFromRenderableIndex(n);null===i&&(i=n);const s=e.createElement("th"),a=this.nestedHeaderSettingsGetter(l,i);if(a&&(!a.isPlaceholder||a.isHidden)){let e=a.label;r&&(e+='<button class="changeType"></button>'),Ce(s,e),s.colSpan=a.colspan,t.appendChild(s)}}i.appendChild(t)}n.appendChild(i),t.appendChild(n)}clear(){this.widthsMap.clear(),this.container=null}}var CK=vK;function yK(t,e){TK(t,e),e.add(t)}function bK(t,e,o){return e=SK(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function SK(t){var e=RK(t,"string");return"symbol"==typeof e?e:String(e)}function RK(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function EK(t,e,o){TK(t,e),e.set(t,o)}function TK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MK(t,e,o){var n=kK(t,e,"set");return HK(t,n,o),o}function HK(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function xK(t,e){var o=kK(t,e,"get");return IK(t,o)}function kK(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function IK(t,e){return e.get?e.get.call(t):e.value}function AK(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const OK="nestedHeaders",PK=280;var NK=new WeakMap,_K=new WeakMap,LK=new WeakMap,DK=new WeakMap,WK=new WeakSet,VK=new WeakSet,FK=new WeakSet,jK=new WeakSet,BK=new WeakSet,zK=new WeakSet,UK=new WeakSet,$K=new WeakSet,GK=new WeakSet,YK=new WeakSet,KK=new WeakSet,XK=new WeakSet,qK=new WeakSet,QK=new WeakSet,JK=new WeakSet,ZK=new WeakSet,tX=new WeakSet,eX=new WeakSet;class oX extends _S{constructor(){super(...arguments),yK(this,eX),yK(this,tX),yK(this,ZK),yK(this,JK),yK(this,QK),yK(this,qK),yK(this,XK),yK(this,KK),yK(this,YK),yK(this,GK),yK(this,$K),yK(this,UK),yK(this,zK),yK(this,BK),yK(this,jK),yK(this,FK),yK(this,VK),yK(this,WK),EK(this,NK,{writable:!0,value:new fK}),EK(this,_K,{writable:!0,value:null}),EK(this,LK,{writable:!0,value:null}),EK(this,DK,{writable:!0,value:!1}),bK(this,"ghostTable",new CK(this.hot,((t,e)=>this.getHeaderSettings(t,e)))),bK(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return OK}static get PLUGIN_PRIORITY(){return PK}isEnabled(){return!!this.hot.getSettings()[OK]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();Array.isArray(e)&&Array.isArray(e[0])||fn(B`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",(()=>AK(this,tX,CX).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,eX,yX).call(t,...o)})),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,BK,lX).call(t,...o)})),this.addHook("afterOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,zK,aX).call(t,...o)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,UK,hX).call(t,...o)})),this.addHook("beforeOnCellMouseUp",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,$K,cX).call(t,...o)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,GK,uX).call(t,...o)})),this.addHook("modifyTransformStart",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,YK,dX).call(t,...o)})),this.addHook("afterSelection",(()=>AK(this,WK,nX).call(this))),this.addHook("beforeViewportScrollHorizontally",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,VK,iX).call(t,...o)})),this.addHook("afterGetColumnHeaderRenderers",(t=>AK(this,XK,fX).call(this,t))),this.addHook("modifyColWidth",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,QK,pX).call(t,...o)})),this.addHook("modifyColumnHeaderValue",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,JK,wX).call(t,...o)})),this.addHook("beforeHighlightingColumnHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,FK,rX).call(t,...o)})),this.addHook("beforeCopy",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,jK,sX).call(t,...o)})),this.addHook("beforeSelectColumns",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,KK,gX).call(t,...o)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,qK,mX).call(t,...o)})),this.addHook("modifyFocusedElement",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AK(t,ZK,vX).call(t,...o)})),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",(()=>AK(this,WK,nX).call(this))),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",(()=>AK(this,WK,nX).call(this))),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:t}=this.hot.getSettings();xK(this,NK).setColumnsLimit(this.hot.countCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=xK(this,NK).setState(t)),this.detectedOverlappedHeaders&&fn(B`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(((t,e)=>{const o=!0===t?"hide-column":"show-column";xK(this,NK).triggerColumnModification(o,e)})),!xK(this,_K)&&this.enabled&&MK(this,_K,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((t=>{t.forEach((t=>{let{op:e,index:o,newValue:n}=t;if("replace"===e){const t=!0===n?"hide-column":"show-column";xK(this,NK).triggerColumnModification(t,o)}})),this.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),xK(this,NK).clear(),xK(this,_K).unsubscribe(),MK(this,_K,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return xK(this,NK)}getLayersCount(){return xK(this,NK).getLayersCount()}getHeaderSettings(t,e){return xK(this,NK).getHeaderSettings(t,e)}clearColspans(){if(!this.hot.view)return;const{_wt:t}=this.hot.view,e=t.getSetting("columnHeaders").length,o=t.wtTable.THEAD,n=t.wtOverlays.topOverlay.clone.wtTable.THEAD,i=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let r=0;r<e;r++){const t=o.childNodes[r];if(!t)break;const e=n.childNodes[r],s=i?i.childNodes[r]:null;for(let o=0,n=t.childNodes.length;o<n;o++)t.childNodes[o].removeAttribute("colspan"),ge(t.childNodes[o],"hiddenHeader"),e&&e.childNodes[o]&&(e.childNodes[o].removeAttribute("colspan"),ge(e.childNodes[o],"hiddenHeader")),i&&s&&s.childNodes[o]&&(s.childNodes[o].removeAttribute("colspan"),ge(s.childNodes[o],"hiddenHeader"))}}headerRendererFactory(t){var e=this;const o=this.hot.view._wt.getSetting("fixedColumnsStart");return(n,i)=>{var r;const{columnIndexMapper:s,view:l}=this.hot;let a=s.getVisualFromRenderableIndex(n);null===a&&(a=n),i.removeAttribute("colspan"),ge(i,"hiddenHeader");const{colspan:h,isHidden:c,isPlaceholder:u}=null!==(r=xK(this,NK).getHeaderSettings(t,a))&&void 0!==r?r:{label:""};if(u||c)de(i,"hiddenHeader");else if(h>1){var d,g;const{wtOverlays:t}=l._wt,e=null===(d=t.topInlineStartCornerOverlay)||void 0===d?void 0:d.clone.wtTable.THEAD.contains(i),r=null===(g=t.inlineStartOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(i),s=e||r?Math.min(h,o-n):h;s>1&&i.setAttribute("colspan",s)}this.hot.view.appendColHeader(a,i,(function(){return e.getColumnHeaderValue(...arguments)}),t)}}getColumnHeaderValue(t,e){var o;const{isHidden:n,isPlaceholder:i}=null!==(o=xK(this,NK).getHeaderSettings(e,t))&&void 0!==o?o:{};return i||n?"":this.hot.getColHeader(t,e)}destroy(){MK(this,NK,null),null!==xK(this,_K)&&(xK(this,_K).unsubscribe(),MK(this,_K,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(t){if(!(t.row>=0||t.col<0))return xK(this,NK).getHeaderTreeNodeData(t.row,t.col)}}function nX(){var t;const e=null===(t=this.hot)||void 0===t?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:o}=e,n=o.isHeader()&&o.col>=0;if(n){const t=xK(this,NK).findLeftMostColumnIndex(o.row,o.col),e=this.hot.selection.highlight.getFocus();e.visualCellRange.highlight.col=t,e.visualCellRange.from.col=t,e.visualCellRange.to.col=t,e.commit()}}function iX(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:o}=e,n=o.isHeader()&&o.col>=0;if(!n)return t;const i=this.hot.view.getFirstFullyVisibleColumn(),r=this.hot.view.getLastFullyVisibleColumn(),s=xK(this,NK).findLeftMostColumnIndex(o.row,o.col),l=xK(this,NK).findRightMostColumnIndex(o.row,o.col);return s<i&&l>r?t:s<i?s:l}function rX(t,e,o){const n=xK(this,NK).getHeaderTreeNodeData(e,t);if(!n)return t;const{columnCursor:i,selectionType:r,selectionWidth:s}=o,{isRoot:l,colspan:a}=xK(this,NK).getHeaderSettings(e,t);if(r===_f){if(!l)return n.columnIndex}else if(r===Nf&&(a>s-i||!l))return null;return t}function sX(t,e,o){let{columnHeadersCount:n}=o;if(0!==n)for(let r=0;r<e.length;r++){const{startRow:o,startCol:n,endRow:s,endCol:l}=e[r],a=s-o+1,h=n-l+1;if(o>=0||1===h)break;for(let e=n;e<=l;e++)for(let r=o;r<=s;r++){var i;const o=a+r,s=e-n;if(0===s)continue;const l=null===(i=xK(this,NK).getHeaderTreeNodeData(r,e))||void 0===i?void 0:i.isRoot;!1===l&&(t[o][s]="")}}}function lX(t,e,o,n){const i=this._getHeaderTreeNodeDataByCoords(e);i&&(n.column=!0)}function aX(t,e){const o=this._getHeaderTreeNodeDataByCoords(e);if(!o)return;MK(this,LK,e.clone()),MK(this,DK,!0);const{selection:n}=this.hot,i=n.isSelected()?n.getSelectedRange().current():null,r=[],{columnIndex:s,origColspan:l}=o,a=!n.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?r.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?r.push(i.getTopStartCorner().col,s+l-1,e.row):r.push(s,s+l-1,e.row):(dn(t)||un(t)&&a)&&r.push(s,s+l-1,e.row),n.selectColumns(...r)}function hX(t,e,o,n){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:r,origColspan:s}=i,l=this.hot.getSelectedRangeLast(),a=l.getTopStartCorner(),h=l.getBottomEndCorner(),{from:c}=l;n.column=!0,n.cell=!0;const u=[],d=Bi(e.row,-1/0,-1);e.col<c.col?u.push(h.col,r,d):e.col>c.col?u.push(a.col,r+s-1,d):u.push(r,r+s-1,d),this.hot.selection.selectColumns(...u)}function cX(){MK(this,DK,!1)}function uX(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!xK(this,DK)||!t)return;const e=this.hot.getSelectedRangeLast(),o=e.getTopStartCorner().col,n=e.getBottomEndCorner().col,{columnIndex:i,origColspan:r}=xK(this,NK).getHeaderTreeNodeData(xK(this,LK).row,xK(this,LK).col);if(e.setHighlight(xK(this,LK)),r>e.getWidth()||i<o||i+r-1>n){const t=xK(this,NK).findTopMostEntireHeaderLevel(Bi(o,i,i+r-1),Bi(n,i,i+r-1));e.highlight.row=t,e.highlight.col=e.from.col}}function dX(t){const{highlight:e}=this.hot.getSelectedRangeLast(),o=this.hot._createCellCoords(e.row+t.row,e.col+t.col),n=o.isHeader()&&o.col>=0;if(!n)return;const i=xK(this,NK).findLeftMostColumnIndex(o.row,o.col),r=xK(this,NK).findRightMostColumnIndex(o.row,o.col);if(t.col<0){const o=e.col>=i&&e.col<=r?i-1:r,n=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);t.col=null===n?-this.hot.view.countRenderableColumnsInRange(0,e.col):-Math.max(this.hot.view.countRenderableColumnsInRange(n,e.col)-1,1)}else if(t.col>0){const o=e.col>=i&&e.col<=r?r+1:i,n=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);t.col=null===n?this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(e.col,n)-1,1)}}function gX(t,e){const o=t.row,n=this._getHeaderTreeNodeDataByCoords({row:o,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:o,col:e.col});e.col<t.col?(n&&(t.col=n.columnIndex+n.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(n&&(t.col=n.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function fX(t){t.length=0;for(let e=0;e<xK(this,NK).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function mX(t){const e=xK(this,NK).getLayersCount();let o=t.startColumn,n=!!e;for(let i=0;i<e;i++){const e=xK(this,NK).findLeftMostColumnIndex(i,t.startColumn),r=this.hot.columnIndexMapper.getRenderableFromVisualIndex(e);if(e>=0&&(n=!1),Di(r)&&r<t.startColumn){o=r;break}}t.startColumn=n?xK(this,NK).getHeaderTreeNodeData(0,o).columnIndex:o}function pX(t,e){const o=this.ghostTable.getWidth(e);return t>o?t:o}function wX(t,e,o){var n;const{label:i}=null!==(n=xK(this,NK).getHeaderTreeNodeData(o,e))&&void 0!==n?n:{label:""};return i}function vX(t,e){if(t<0)return this.hot.getCell(t,xK(this,NK).findLeftMostColumnIndex(t,e),!0)}function CX(){this.updatePlugin()}function yX(t,e){e||this.updatePlugin()}function bX(t,e,o){return e=SX(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function SX(t){var e=RX(t,"string");return"symbol"==typeof e?e:String(e)}function RX(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class EX{constructor(t,e){bX(this,"hot",void 0),bX(this,"data",null),bX(this,"plugin",void 0),bX(this,"parentReference",new WeakMap),bX(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=e,this.plugin=t}setData(t){this.data=t}getData(){return this.data}getRawSourceData(){let t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}updateWithData(t){this.setData(t),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Vi(0,this.data.length-1,(t=>{this.cacheNode(this.data[t],0,null)}))}cacheNode(t,e,o){this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:o,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&A(t.__children,(o=>{this.cacheNode(o,e+1,t)}))}getDataObject(t){return null===t||void 0===t?null:this.cache.rows[t]}readTreeNodes(t,e,o,n){let i=!1,r=e;if(isNaN(r)&&r.end)return r;let s=t;return s||(s={__children:this.data},i=!0,r-=1),null!==o&&void 0!==o&&r===o?{result:s,end:!0}:null!==n&&void 0!==n&&s===n?{result:r,end:!0}:(r+=1,s.__children&&A(s.__children,(t=>{if(this.parentReference.set(t,i?null:s),r=this.readTreeNodes(t,r,o,n),isNaN(r)&&r.end)return!1})),r)}mockParent(){const t=this.mockNode();return t.__children=this.data,t}mockNode(){const t={};return To(this.data[0],((e,o)=>{t[o]=null})),t}getRowIndex(t){return null===t||void 0===t?null:this.cache.nodeInfo.get(t).row}getRowIndexWithinParent(t){let e=null;e=isNaN(t)?t:this.getDataObject(t);const o=this.getRowParent(t);return null===o||void 0===o?this.data.indexOf(e):o.__children.indexOf(e)}countAllRows(){const t={__children:this.data};return this.countChildren(t)}countChildren(t){let e=0,o=t;return isNaN(o)||(o=this.getDataObject(o)),o&&o.__children?(A(o.__children,(t=>{e+=1,t.__children&&(e+=this.countChildren(t))})),e):0}getRowParent(t){let e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}getRowObjectParent(t){return t&&"object"===typeof t?this.cache.nodeInfo.get(t).parent:null}getRowLevel(t){let e=null;return e=isNaN(t)?t:this.getDataObject(t),e?this.getRowObjectLevel(e):null}getRowObjectLevel(t){return null===t||void 0===t?null:this.cache.nodeInfo.get(t).level}hasChildren(t){let e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}isChild(t){return null!==this.getRowParent(t)}getChild(t,e){var o;return(null===(o=t.__children)||void 0===o?void 0:o[e])||null}isRowHighestLevel(t){return!this.isChild(t)}isParent(t){var e;let o=t;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&0!==(null===(e=o.__children)||void 0===e?void 0:e.length)}addChild(t,e){let o=e;this.hot.runHooks("beforeAddChild",t,o);let n=null;t&&(n=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(t)+1,1);let i=t;t||(i=this.mockParent()),i.__children||(i.__children=[]),o||(o=this.mockNode()),i.__children.push(o),this.rewriteCache();const r=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(r,1),this.hot.runHooks("afterCreateRow",r,1),this.hot.runHooks("afterAddChild",t,o)}addChildAtIndex(t,e,o){let n,i=o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",t,i,e),t){const o=this.getRowIndex(t),r=o+e+1;this.hot.runHooks("beforeCreateRow",r,1),t.__children.splice(e,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(r,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",r,1),n=r}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),n=this.getRowIndex(this.data[e]);i=this.getDataObject(n),this.hot.runHooks("afterAddChild",t,i,e)}addSibling(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const o=this.translateTrimmedRow(t),n=this.getRowParent(o),i=this.getRowIndexWithinParent(o);switch(e){case"below":this.addChildAtIndex(n,i+1,null);break;case"above":this.addChildAtIndex(n,i,null);break;default:break}}detachFromParent(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=null;const n=[];Array.isArray(t)?(Vi(t[0],t[2],(t=>{const e=this.translateTrimmedRow(t);n.push(this.getDataObject(e))})),Vi(0,n.length-2,(t=>{this.detachFromParent(n[t],!1)})),o=n[n.length-1]):o=t;const i=this.getRowIndex(o),r=this.countChildren(o),s=this.getRowIndexWithinParent(o),l=this.getRowParent(o),a=this.getRowParent(l),h=this.getRowIndex(a);let c=null;if(this.hot.runHooks("beforeDetachChild",l,o),null!==s&&void 0!==s){const t=Array.from(new Array(i+r+1).keys()).splice(-1*(r+1));if(this.hot.runHooks("beforeRemoveRow",i,r+1,t,this.plugin.pluginName),l.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,r+1,t,this.plugin.pluginName),a){c=h+this.countChildren(a);const t=this.getChild(a,this.countChildren(a)-1),e=this.getRowIndex(t);this.hot.runHooks("beforeCreateRow",e+1,r+1,this.plugin.pluginName),a.__children.push(o)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,r+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,r+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,o,this.getRowIndex(o)),e&&this.hot.render()}filterData(t,e,o){const n=[];A(o,(t=>{n.push(this.getDataObject(t))})),A(n,(t=>{const e=this.getRowIndexWithinParent(t),o=this.getRowParent(t);null===o?this.data.splice(e,1):o.__children.splice(e,1)})),this.rewriteCache()}spliceData(t,e,o){const n=this.getDataObject(t-1);let i=null,r=t;n&&n.__children&&0===n.__children.length?(i=n,r=0):t<this.countAllRows()&&(i=this.getRowParent(t),r=this.getRowIndexWithinParent(t)),i?o?i.__children.splice(r,e,...o):i.__children.splice(r,e):o?this.data.splice(r,e,...o):this.data.splice(r,e),this.rewriteCache()}syncRowWithRawSource(t){let e=t,o=null;do{o=this.getRowParent(o),null!==o&&(e=o)}while(null!==o);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(t,e,o,n){const i=e===this.hot.countRows(),r=this.getRowParent(t),s=this.getRowIndexWithinParent(t),l=r.__children.slice(s,s+1),a=t>e;let h=i?this.getRowParent(e-1):this.getRowParent(e);null!==h&&void 0!==h||(h=this.getRowParent(e-1)),null!==h&&void 0!==h||(h=this.getDataObject(e-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(e),h.__children=[]);const c=i||o||n?h.__children.length:this.getRowIndexWithinParent(e),u=r===h;h.__children.splice(c,0,l[0]),r.__children.splice(s+(a&&u?1:0),1),this.syncRowWithRawSource(r),u||this.syncRowWithRawSource(h)}translateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}untranslateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}}var TX=EX;function MX(t,e,o){return e=HX(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function HX(t){var e=xX(t,"string");return"symbol"==typeof e?e:String(e)}function xX(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class kX{constructor(t,e){MX(this,"hot",void 0),MX(this,"plugin",void 0),this.hot=e,this.plugin=t}}var IX=kX;class AX extends IX{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(t,e){super(t,e),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(t,e){const o=this.hot.toPhysicalRow(t),n=this.dataManager.getRowLevel(o),i=this.dataManager.getDataObject(o),r=e.getElementsByTagName("DIV")[0],s=r.querySelector("span.rowHeader"),l=r.querySelectorAll('[class^="ht_nesting"]'),a=this.hot.getSettings().ariaTags;if(A(l,(t=>{t&&r.removeChild(t)})),de(e,AX.CSS_CLASSES.indicatorContainer),n){const{rootDocument:t}=this.hot,e=s.cloneNode(!0);r.innerHTML="",Vi(0,n-1,(()=>{const e=t.createElement("SPAN");de(e,AX.CSS_CLASSES.emptyIndicator),r.appendChild(e)})),r.appendChild(e)}if(this.dataManager.hasChildren(i)){const t=this.hot.rootDocument.createElement("DIV");a&&fe(t,[Ot()]),de(e,AX.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(o)?(de(t,`${AX.CSS_CLASSES.button} ${AX.CSS_CLASSES.expandButton}`),a&&fe(e,[Ft(!1)])):(de(t,`${AX.CSS_CLASSES.button} ${AX.CSS_CLASSES.collapseButton}`),a&&fe(e,[Ft(!0)])),r.appendChild(t)}}updateRowHeaderWidth(t){let e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}var OX=AX;class PX extends IX{constructor(t,e){var o;super(t,e),o=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,t)},shiftStash:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==e&&void 0!==e||(e=1/0),A(o.lastCollapsedRows,((i,r)=>{i>=t&&i<e&&(o.lastCollapsedRows[r]=i+n)}))},applyStash:function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o.collapseMultipleChildren(o.lastCollapsedRows,t),o.lastCollapsedRows=void 0},trimStash:(t,e)=>{Vi(t,t+e-1,(t=>{const e=this.lastCollapsedRows.indexOf(t);e>-1&&this.lastCollapsedRows.splice(e,1)}))}}}collapseChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];let i=null,r=null,s=null;return isNaN(t)?(i=t,r=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(t),r=t),this.dataManager.hasChildren(i)&&A(i.__children,(t=>{n.push(this.dataManager.getRowIndex(t))})),s=this.collapseRows(n,!0,!1),o&&this.trimRows(s),e&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(r)&&this.collapsedRows.push(r),s}collapseMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];A(t,(t=>{n.push(...this.collapseChildren(t,!1,!1))})),o&&this.trimRows(n),e&&this.renderAndAdjust()}collapseRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([t],e)}collapseRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[];return A(t,(t=>{n.push(t),e&&this.collapseChildRows(t,n)})),o&&this.trimRows(n),n}collapseChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){const o=this.dataManager.getDataObject(t);A(o.__children,(t=>{const o=this.dataManager.getRowIndex(t);e.push(o),this.collapseChildRows(o,e)}))}o&&this.trimRows(e)}expandRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([t],e)}expandRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[];return A(t,(t=>{n.push(t),e&&this.expandChildRows(t,n)})),o&&this.untrimRows(n),n}expandChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){const o=this.dataManager.getDataObject(t);A(o.__children,(t=>{if(!this.isAnyParentCollapsed(t)){const o=this.dataManager.getRowIndex(t);e.push(o),this.expandChildRows(o,e)}}))}o&&this.untrimRows(e)}expandChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];let i=null,r=null,s=null;return isNaN(t)?(i=t,r=this.dataManager.getRowIndex(t)):(i=this.dataManager.getDataObject(t),r=t),this.collapsedRows.splice(this.collapsedRows.indexOf(r),1),this.dataManager.hasChildren(i)&&A(i.__children,(t=>{const e=this.dataManager.getRowIndex(t);n.push(e)})),s=this.expandRows(n,!0,!1),o&&this.untrimRows(s),e&&this.renderAndAdjust(),s}expandMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];A(t,(t=>{n.push(...this.expandChildren(t,!1,!1))})),o&&this.untrimRows(n),e&&this.renderAndAdjust()}collapseAll(){const t=this.dataManager.getData(),e=[];A(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.collapseMultipleChildren(e),this.renderAndAdjust()}expandAll(){const t=this.dataManager.getData(),e=[];A(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.expandMultipleChildren(e),this.renderAndAdjust()}trimRows(t){this.hot.batchExecution((()=>{A(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)}))}),!0)}untrimRows(t){this.hot.batchExecution((()=>{A(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)}))}),!0)}areChildrenCollapsed(t){let e=isNaN(t)?t:this.dataManager.getDataObject(t),o=!0;return null===e&&(e={__children:this.dataManager.data}),this.dataManager.hasChildren(e)&&A(e.__children,(t=>{const e=this.dataManager.getRowIndex(t);if(!this.plugin.collapsedRowsMap.getValueAtIndex(e))return o=!1,!1})),o}isAnyParentCollapsed(t){let e=t;while(null!==e){e=this.dataManager.getRowParent(e);const t=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(t)>-1)return!0}return!1}toggleState(t,e){if(e.col>=0)return;const o=this.translateTrimmedRow(e.row);ue(t.target,OX.CSS_CLASSES.button)&&(this.areChildrenCollapsed(o)?this.expandChildren(o):this.collapseChildren(o),hn(t))}translateTrimmedRow(t){return this.hot.toPhysicalRow(t)}untranslateTrimmedRow(t){return this.hot.toVisualRow(t)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}var NX=PX;function _X(t,e,o){LX(t,e),e.set(t,o)}function LX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DX(t,e,o){return e=WX(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function WX(t){var e=VX(t,"string");return"symbol"==typeof e?e:String(e)}function VX(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function FX(t,e){var o=jX(t,e,"get");return BX(t,o)}function jX(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function BX(t,e){return e.get?e.get.call(t):e.value}var zX=new WeakMap;class UX extends IX{constructor(){super(...arguments),DX(this,"dataManager",this.plugin.dataManager),_X(this,zX,{writable:!0,value:{row_above:(t,e)=>{const o=e[e.length-1];this.dataManager.addSibling(o.start.row,"above")},row_below:(t,e)=>{const o=e[e.length-1];this.dataManager.addSibling(o.start.row,"below")}}})}appendOptions(t){const e=[{key:"add_child",name(){return this.getTranslatedPhrase(Hg)},callback:()=>{const t=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),e=this.dataManager.getDataObject(t);this.dataManager.addChild(e)},disabled:()=>{const t=this.hot.getSelectedLast();return!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(xg)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const t=this.hot.getSelectedLast(),e=this.dataManager.translateTrimmedRow(t[0]),o=this.dataManager.getRowParent(e);return!o||!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Vi(0,t.items.length-1,(o=>{if(0===o)return A(e,((e,n)=>{t.items.splice(o+n,0,e)})),!1})),this.modifyRowInsertingOptions(t)}modifyRowInsertingOptions(t){return Vi(0,t.items.length-1,(e=>{const o=FX(this,zX)[t.items[e].key];null!==o&&void 0!==o&&(t.items[e].callback=o)})),t}}var $X=UX;function GX(t,e,o){return e=YX(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function YX(t){var e=KX(t,"string");return"symbol"==typeof e?e:String(e)}function KX(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class XX{constructor(t){GX(this,"plugin",void 0),GX(this,"hot",void 0),GX(this,"dataManager",void 0),GX(this,"collapsingUI",void 0),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}onBeforeRowMove(t,e,o,n){const i=this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:o,movePossible:n});if(i)return!1;this.movedToCollapsed=!1;const r=o===this.hot.countRows(),s=r?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o);let l=!0;const a=t.map((t=>{if(!l)return!1;const e=this.dataManager.translateTrimmedRow(t);return l=this.shouldAllowMoving(e,s),e})),h=-1===a.indexOf(s);if(!l||!h)return!1;const c=this.getBaseParent(a),u=this.getTargetParent(r,s),d=c===u;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(u),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(a,s,d),this.moveRows(a,s,u),this.dataManager.rewriteCache(),this.moveCellsMeta(a,s),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,o,n,n&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,o),!1}displayAPICompatibilityWarning(t){const{rows:e,finalIndex:o,dropIndex:n,movePossible:i}=t;let r=!1;return $(n)&&(fn(B`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",e,o,n,i,!1),r=!0),r}shouldAllowMoving(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}getBaseParent(t){return this.dataManager.getRowParent(t[0])}getTargetParent(t,e){let o=this.dataManager.getRowParent(t?e-1:e);return null!==o&&void 0!==o||(o=this.dataManager.getRowParent(e-1)),o}shiftCollapsibleParentsLocations(t,e,o){o||(Math.max(...t)<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}moveRows(t,e,o){const n=e===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender((()=>{t.forEach((t=>{this.dataManager.moveRow(t,e,this.movedToCollapsed,n)}))}))}moveCellsMeta(t,e){const o=[],n=Math.max(...t)<e;t.forEach((t=>{o.push(this.hot.getCellMetaAtRow(t))})),this.hot.spliceCellsMeta(t[0],t.length),this.hot.spliceCellsMeta(e-(n?o.length:0),0,...o)}selectCells(t,e){const o=t.length;let n=0,i=0,r=null,s=null;if(this.movedToCollapsed){let r=null;r=t[o-1]<e?this.dataManager.translateTrimmedRow(e-o):this.dataManager.translateTrimmedRow(e);const s=this.dataManager.getRowParent(null===r?this.hot.countSourceRows()-1:r-1),l=this.dataManager.getRowIndex(s);n=this.dataManager.untranslateTrimmedRow(l),i=n}else t[o-1]<e?(i=e-1,n=i-o+1):(n=e,i=n+o-1);r=this.hot.selection,s=this.hot.countCols()-1,r.setRangeStart(this.hot._createCellCoords(n,0)),r.setRangeEnd(this.hot._createCellCoords(i,s),!0)}isRowOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}}function qX(t,e){JX(t,e),e.add(t)}function QX(t,e,o){JX(t,e),e.set(t,o)}function JX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZX(t,e,o){return e=tq(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function tq(t){var e=eq(t,"string");return"symbol"==typeof e?e:String(e)}function eq(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function oq(t,e){var o=rq(t,e,"get");return nq(t,o)}function nq(t,e){return e.get?e.get.call(t):e.value}function iq(t,e,o){var n=rq(t,e,"set");return sq(t,n,o),o}function rq(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function sq(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function lq(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const aq="nestedRows",hq=300,cq=aq,uq="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var dq=new WeakMap,gq=new WeakMap,fq=new WeakSet,mq=new WeakSet,pq=new WeakSet,wq=new WeakSet,vq=new WeakSet,Cq=new WeakSet,yq=new WeakSet,bq=new WeakSet,Sq=new WeakSet,Rq=new WeakSet,Eq=new WeakSet,Tq=new WeakSet,Mq=new WeakSet,Hq=new WeakSet,xq=new WeakSet,kq=new WeakSet;class Iq extends _S{constructor(){super(...arguments),qX(this,kq),qX(this,xq),qX(this,Hq),qX(this,Mq),qX(this,Tq),qX(this,Eq),qX(this,Rq),qX(this,Sq),qX(this,bq),qX(this,yq),qX(this,Cq),qX(this,vq),qX(this,wq),qX(this,pq),qX(this,mq),qX(this,fq),ZX(this,"dataManager",null),ZX(this,"headersUI",null),ZX(this,"collapsedRowsMap",null),QX(this,dq,{writable:!0,value:!1}),QX(this,gq,{writable:!0,value:!1})}static get PLUGIN_KEY(){return aq}static get PLUGIN_PRIORITY(){return hq}isEnabled(){return!!this.hot.getSettings()[aq]}enablePlugin(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Yu),this.dataManager=new TX(this,this.hot),this.collapsingUI=new NX(this,this.hot),this.headersUI=new OX(this,this.hot),this.contextMenuUI=new $X(this,this.hot),this.rowMoveController=new XX(this),this.addHook("afterInit",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,Hq,Uq).call(t,...o)})),this.addHook("beforeViewRender",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,xq,$q).call(t,...o)})),this.addHook("modifyRowData",(function(){return t.onModifyRowData(...arguments)})),this.addHook("modifySourceLength",(function(){return t.onModifySourceLength(...arguments)})),this.addHook("beforeDataSplice",(function(){return t.onBeforeDataSplice(...arguments)})),this.addHook("filterData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,pq,Pq).call(t,...o)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,wq,Nq).call(t,...o)})),this.addHook("afterGetRowHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,vq,_q).call(t,...o)})),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,mq,Oq).call(t,...o)})),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,bq,Wq).call(t,...o)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,yq,Dq).call(t,...o)})),this.addHook("beforeAddChild",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,Sq,Vq).call(t,...o)})),this.addHook("afterAddChild",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,Rq,Fq).call(t,...o)})),this.addHook("beforeDetachChild",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,Eq,jq).call(t,...o)})),this.addHook("afterDetachChild",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,Tq,Bq).call(t,...o)})),this.addHook("modifyRowHeaderWidth",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,Cq,Lq).call(t,...o)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,Mq,zq).call(t,...o)})),this.addHook("beforeRowMove",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return lq(t,fq,Aq).call(t,...o)})),this.addHook("beforeLoadData",(t=>lq(this,kq,Gq).call(this,t))),this.addHook("beforeUpdateData",(t=>lq(this,kq,Gq).call(this,t))),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();if(-1===t.col&&t.row>=0){const e=this.collapsingUI.translateTrimmedRow(t.row);this.collapsingUI.areChildrenCollapsed(e)?this.collapsingUI.expandChildren(e):this.collapsingUI.collapseChildren(e)}},runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()},group:cq})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(cq)}disableCoreAPIModifiers(){iq(this,gq,!0)}enableCoreAPIModifiers(){iq(this,gq,!1)}onModifyRowData(t){if(!oq(this,gq))return this.dataManager.getDataObject(t)}onModifySourceLength(){if(!oq(this,gq))return this.dataManager.countAllRows()}onBeforeDataSplice(t,e,o){return!(!oq(this,gq)&&!this.dataManager.isRowHighestLevel(t))||(this.dataManager.spliceData(t,e,o),!1)}destroy(){super.destroy()}}function Aq(t,e,o,n){return this.rowMoveController.onBeforeRowMove(t,e,o,n)}function Oq(t,e,o){this.collapsingUI.toggleState(t,e,o)}function Pq(t,e,o){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(o[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(o[0],null,-1*e),this.dataManager.filterData(t,e,o),iq(this,dq,!0),this.dataManager.getData().slice()}function Nq(t){return this.contextMenuUI.appendOptions(t)}function _q(t,e){this.headersUI.appendLevelIndicators(t,e)}function Lq(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Dq(t,e,o,n){n!==this.pluginName&&this.hot._registerTimeout((()=>{iq(this,dq,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()}))}function Wq(t,e,o){const n=Array.from(o.reduce(((t,e)=>{if(this.dataManager.isParent(e)){const o=this.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(o)&&o.forEach((e=>t.add(this.dataManager.getRowIndex(e)))),t}return t.add(e)}),new Set));o.length=0,o.push(...n)}function Vq(){this.collapsingUI.collapsedRowsStash.stash()}function Fq(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function jq(){this.collapsingUI.collapsedRowsStash.stash()}function Bq(t,e,o){this.collapsingUI.collapsedRowsStash.shiftStash(o,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function zq(){this.dataManager.rewriteCache()}function Uq(){this.headersUI.updateRowHeaderWidth()}function $q(t,e){oq(this,dq)&&(e.skipRender=!0)}function Gq(t){if(!bu(t))return mn(uq),this.hot.getSettings()[aq]=!1,void this.disablePlugin();this.dataManager.setData(t),this.dataManager.rewriteCache()}function Yq(t,e,o){return e=Kq(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Kq(t){var e=Xq(t,"string");return"symbol"==typeof e?e:String(e)}function Xq(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class qq{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;Yq(this,"rootWindow",void 0),Yq(this,"prefix",void 0),Yq(this,"savedKeys",[]),this.rootWindow=e,this.prefix=t,this.loadSavedKeys()}saveValue(t,e){this.rootWindow.localStorage.setItem(`${this.prefix}_${t}`,JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}loadValue(t,e){const o="undefined"===typeof t?e:t,n=this.rootWindow.localStorage.getItem(`${this.prefix}_${o}`);return null===n?void 0:JSON.parse(n)}reset(t){this.rootWindow.localStorage.removeItem(`${this.prefix}_${t}`)}resetAll(){A(this.savedKeys,((t,e)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[e]}`)})),this.clearSavedKeys()}loadSavedKeys(){const t=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),e="string"===typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}var Qq=qq;function Jq(t,e,o){return e=Zq(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Zq(t){var e=tQ(t,"string");return"symbol"==typeof e?e:String(e)}function tQ(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Mn.getSingleton().register("persistentStateSave"),Mn.getSingleton().register("persistentStateLoad"),Mn.getSingleton().register("persistentStateReset");const eQ="persistentState",oQ=0;class nQ extends _S{constructor(){super(...arguments),Jq(this,"storage",void 0)}static get PLUGIN_KEY(){return eQ}static get PLUGIN_PRIORITY(){return oQ}isEnabled(){return!!this.hot.getSettings()[eQ]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Qq(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",((t,e)=>this.saveValue(t,e))),this.addHook("persistentStateLoad",((t,e)=>this.loadValue(t,e))),this.addHook("persistentStateReset",(()=>this.resetValue())),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(t,e){e.value=this.storage.loadValue(t)}saveValue(t,e){this.storage.saveValue(t,e)}resetValue(t){"undefined"===typeof t?this.storage.resetAll():this.storage.reset(t)}destroy(){super.destroy()}}function iQ(t,e){rQ(t,e),e.add(t)}function rQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sQ(t,e,o){return e=lQ(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function lQ(t){var e=aQ(t,"string");return"symbol"==typeof e?e:String(e)}function aQ(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function hQ(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const cQ="search",uQ=190,dQ="htSearchResult",gQ=function(t,e,o,n,i){t.getCellMeta(e,o).isSearchResult=i},fQ=function(t,e,o){return!($(t)||null===t||!t.toLocaleLowerCase||0===t.length)&&(!$(e)&&null!==e&&-1!==e.toString().toLocaleLowerCase(o.locale).indexOf(t.toLocaleLowerCase(o.locale)))};var mQ=new WeakSet;class pQ extends _S{constructor(){super(...arguments),iQ(this,mQ),sQ(this,"callback",gQ),sQ(this,"queryMethod",fQ),sQ(this,"searchResultClass",dQ)}static get PLUGIN_KEY(){return cQ}static get PLUGIN_PRIORITY(){return uQ}isEnabled(){return this.hot.getSettings()[cQ]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[cQ];this.updatePluginSettings(e),this.addHook("beforeRenderer",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return hQ(t,mQ,wQ).call(t,...o)})),super.enablePlugin()}disablePlugin(){var t=this;const e=function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return hQ(t,mQ,wQ).call(t,...o)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("beforeRenderer",e)})),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const n=this.hot.countRows(),i=this.hot.countCols(),r=[],s=this.hot;return Vi(0,n-1,(n=>{Vi(0,i-1,(i=>{const l=this.hot.getDataAtCell(n,i),a=this.hot.getCellMeta(n,i),h=a.search.callback||e,c=a.search.queryMethod||o,u=c(t,l,a);if(u){const t={row:n,col:i,data:l};r.push(t)}h&&h(s,n,i,l,u)}))})),r}getCallback(){return this.callback}setCallback(t){this.callback=t}getQueryMethod(){return this.queryMethod}setQueryMethod(t){this.queryMethod=t}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(t){this.searchResultClass=t}updatePluginSettings(t){Ro(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}destroy(){super.destroy()}}function wQ(t,e,o,n,i,r){const s=r.className||[];let l=[];"string"===typeof s?l=s.split(" "):l.push(...s),this.isEnabled()&&r.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),r.className=l.join(" ")}function vQ(t,e){CQ(t,e),e.add(t)}function CQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yQ(t,e,o){return e=bQ(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function bQ(t){var e=SQ(t,"string");return"symbol"==typeof e?e:String(e)}function SQ(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function RQ(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const EQ="touchScroll",TQ=200;var MQ=new WeakSet,HQ=new WeakSet,xQ=new WeakSet;class kQ extends _S{constructor(){super(...arguments),vQ(this,xQ),vQ(this,HQ),vQ(this,MQ),yQ(this,"scrollbars",[]),yQ(this,"clones",[]),yQ(this,"lockedCollection",!1),yQ(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return EQ}static get PLUGIN_PRIORITY(){return TQ}static get SETTING_KEYS(){return!0}isEnabled(){return Po()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",(()=>RQ(this,MQ,IQ).call(this))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",(()=>RQ(this,HQ,AQ).call(this))),this.addHook("afterMomentumScroll",(()=>RQ(this,xQ,OQ).call(this)))}}function IQ(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:o,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(o),n&&this.scrollbars.push(n),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function AQ(){this.freezeOverlays=!0,A(this.clones,(t=>{de(t,"hide-tween")}))}function OQ(){this.freezeOverlays=!1,A(this.clones,(t=>{ge(t,"hide-tween"),de(t,"show-tween")})),this.hot._registerTimeout((()=>{A(this.clones,(t=>{ge(t,"show-tween")}))}),400),A(this.scrollbars,(t=>{t.refresh(),t.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function PQ(t,e){NQ(t,e),e.add(t)}function NQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _Q(t,e,o){return e=LQ(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function LQ(t){var e=DQ(t,"string");return"symbol"==typeof e?e:String(e)}function DQ(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function WQ(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const VQ="trimRows",FQ=330;var jQ=new WeakSet;class BQ extends _S{constructor(){super(...arguments),PQ(this,jQ),_Q(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return VQ}static get PLUGIN_PRIORITY(){return FQ}isEnabled(){return!!this.hot.getSettings()[VQ]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Yu),this.trimmedRowsMap.addLocalHook("init",(()=>WQ(this,jQ,zQ).call(this))),super.enablePlugin())}updatePlugin(){const t=this.hot.getSettings()[VQ];Array.isArray(t)&&this.hot.batchExecution((()=>{this.trimmedRowsMap.clear(),A(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(t){const e=this.getTrimmedRows(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t))));const i=this.hot.runHooks("beforeTrimRow",e,n,o);!1!==i&&(o&&this.hot.batchExecution((()=>{A(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),this.hot.runHooks("afterTrimRow",e,n,o,o&&n.length>e.length))}trimRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.trimRows(e)}untrimRows(t){const e=this.getTrimmedRows(),o=this.isValidConfig(t);let n=e;const i=this.trimmedRowsMap.getValues().slice(),r=t.length>0;o&&r&&(A(t,(t=>{i[t]=!1})),n=x(i,((t,e,o)=>(e&&t.push(o),t)),[]));const s=this.hot.runHooks("beforeUntrimRow",e,n,o&&r);!1!==s&&(o&&r&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",e,n,o&&r,o&&n.length<e.length))}untrimRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.untrimRows(e)}isTrimmed(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(t){const e=this.hot.countSourceRows();return t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}destroy(){super.destroy()}}function zQ(){const t=this.hot.getSettings()[VQ];Array.isArray(t)&&this.hot.batchExecution((()=>{A(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0)}o(5846);const UQ="undoRedo",$Q="undoRedo";function GQ(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",(function(o,n){const i=o&&o.length;if(!i)return;const r=o.find((t=>{const[,,e,o]=t;return e!==o}));if(!r)return;const s=()=>{const e=o.reduce(((t,e)=>(t.push([...e]),t)),[]);A(e,(e=>{e[1]=t.propToCol(e[1])}));const n=i>1?this.getSelected():[[e[0][0],e[0][1]]];return new GQ.ChangeAction(e,n)};e.done(s,n)})),t.addHook("afterCreateRow",((t,o,n)=>{e.done((()=>new GQ.CreateRowAction(t,o)),n)}));const o=(e,o,n,i)=>{const r=["visualRow","visualCol","row","col","prop"],s=r.length,l=[];return Vi(n,i,(n=>{Vi(e,o,(e=>{const o=t.getCellMeta(e,n);if(Object.keys(o).length!==s){const t=Object.fromEntries(Object.entries(o).filter((t=>{let[e]=t;return!1===r.includes(e)})));l.push([o.visualRow,o.visualCol,t])}}))})),l};t.addHook("beforeRemoveRow",((n,i,r,s)=>{const l=()=>{const r=t.toPhysicalRow(n),s=r+i-1,l=Co(e.instance.getSourceData(r,0,r+i-1,e.instance.countSourceCols()-1));return new GQ.RemoveRowAction(r,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),o(r,s,0,t.countCols()-1))};e.done(l,s)})),t.addHook("afterCreateCol",((t,o,n)=>{e.done((()=>new GQ.CreateColumnAction(t,o)),n)})),t.addHook("beforeRemoveCol",((n,i,r,s)=>{const l=()=>{const r=e.instance.getSourceDataArray(),s=(e.instance.countCols()+n)%e.instance.countCols(),l=s+i-1,a=[],h=[],c=[];Vi(r.length-1,(e=>{const o=[],n=r[e];Vi(s,l,(e=>{o.push(n[t.toPhysicalColumn(e)])})),a.push(o)})),Vi(i-1,(e=>{c.push(t.toPhysicalColumn(s+e))})),Array.isArray(t.getSettings().colHeaders)&&Vi(i-1,(e=>{h.push(t.getSettings().colHeaders[t.toPhysicalColumn(s+e)]||null)}));const u=t.columnIndexMapper.getIndexesSequence(),d=t.rowIndexMapper.getIndexesSequence();return new GQ.RemoveColumnAction(s,c,a,h,u,d,t.getSettings().fixedColumnsStart,o(0,t.countRows(),s,l))};e.done(l,s)})),t.addHook("beforeCellAlignment",((t,o,n,i)=>{e.done((()=>new GQ.CellAlignmentAction(t,o,n,i)))})),t.addHook("beforeFilter",(t=>{e.done((()=>new GQ.FiltersAction(t)))})),t.addHook("beforeRowMove",((t,o)=>{!1!==t&&e.done((()=>new GQ.RowMoveAction(t,o)))})),t.addHook("beforeMergeCells",((o,n)=>{n||e.done((()=>new GQ.MergeCellsAction(t,o)))})),t.addHook("afterUnmergeCells",((o,n)=>{n||e.done((()=>new GQ.UnmergeCellsAction(t,o)))})),t.addHook("afterInit",(()=>{e.init()}))}GQ.prototype.done=function(t,e){if(this.ignoreNewActions)return;const o="UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;if(o)return;const n=this.doneActions.slice(),i=this.instance.runHooks("beforeUndoStackChange",n,e);if(!1===i)return;const r=t(),s=this.undoneActions.slice();this.doneActions.push(r),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())},GQ.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const o=Co(e),n=this.instance.runHooks("beforeUndo",o);if(!1===n)return;this.ignoreNewActions=!0;const i=this,r=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",r),e.undo(this.instance,(()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)})),this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice()),this.instance.runHooks("afterUndo",o)}},GQ.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const o=Co(e),n=this.instance.runHooks("beforeRedo",o);if(!1===n)return;this.ignoreNewActions=!0;const i=this,r=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",r),e.redo(this.instance,(()=>{i.ignoreNewActions=!1,i.doneActions.push(e)})),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("afterRedo",o)}},GQ.prototype.isUndoAvailable=function(){return this.doneActions.length>0},GQ.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},GQ.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},GQ.prototype.isEnabled=function(){return this.enabled},GQ.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,qQ(t),this.registerShortcuts(),t.addHook("afterChange",XQ)},GQ.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,QQ(t),this.unregisterShortcuts(),t.removeHook("afterChange",XQ)},GQ.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},GQ.Action=function(){},GQ.Action.prototype.undo=function(){},GQ.Action.prototype.redo=function(){},GQ.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},po(GQ.ChangeAction,GQ.Action),GQ.ChangeAction.prototype.undo=function(t,e){const o=Co(this.changes),n=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let r=0,s=o.length;r<s;r++)o[r].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(o,null,null,"UndoRedo.undo");for(let r=0,s=o.length;r<s;r++){const[e,s]=o[r];t.getSettings().minSpareRows&&e+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(e+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&s+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(s+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)},GQ.ChangeAction.prototype.redo=function(t,e){const o=Co(this.changes);for(let n=0,i=o.length;n<i;n++)o[n].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(o,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},GQ.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},po(GQ.CreateRowAction,GQ.Action),GQ.CreateRowAction.prototype.undo=function(t,e){const o=t.countRows(),n=t.getSettings().minSpareRows;this.index>=o&&this.index-n<o&&(this.index-=n),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},GQ.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},GQ.RemoveRowAction=function(t,e,o,n,i,r){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=o,this.fixedRowsTop=n,this.rowIndexesSequence=i,this.removedCellMetas=r},po(GQ.RemoveRowAction,GQ.Action),GQ.RemoveRowAction.prototype.undo=function(t,e){const o=t.getSettings(),n=[];o.fixedRowsBottom=this.fixedRowsBottom,o.fixedRowsTop=this.fixedRowsTop,this.data.forEach(((t,e)=>{Object.keys(t).forEach((o=>{const i=parseInt(o,10);n.push([this.index+e,isNaN(i)?o:i,t[o]])}))})),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach((e=>{let[o,n,i]=e;t.setCellMetaObject(o,n,i)})),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(n,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},GQ.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},GQ.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},po(GQ.CreateColumnAction,GQ.Action),GQ.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},GQ.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},GQ.RemoveColumnAction=function(t,e,o,n,i,r,s,l){this.index=t,this.indexes=e,this.data=o,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=r.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=l},po(GQ.RemoveColumnAction,GQ.Action),GQ.RemoveColumnAction.prototype.undo=function(t,e){const o=t.getSettings();o.fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),i=(t,e,o)=>o[this.indexes.indexOf(n[e])],r=this.data.length,s=[];for(let h=0;h<r;h++)s.push(I(this.data[h],i));const l=I(this.headers,i),a=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),A(t.getSourceDataArray(),((t,e)=>{A(n,((o,n)=>{t[o]=s[e][n],a.push([e,o,t[o]])}))})),t.setSourceDataAtCell(a,void 0,void 0,"UndoRedo.undo"),"undefined"!==typeof this.headers&&A(l,((e,o)=>{t.getSettings().colHeaders[n[o]]=e})),this.removedCellMetas.forEach((e=>{let[o,n,i]=e;t.setCellMetaObject(o,n,i)})),t.batchExecution((()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)}),!0),t.addHookOnce("afterViewRender",e),t.render()},GQ.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},GQ.CellAlignmentAction=function(t,e,o,n){this.stateBefore=t,this.range=e,this.type=o,this.alignment=n},GQ.CellAlignmentAction.prototype.undo=function(t,e){A(this.range,(e=>{e.forAll(((e,o)=>{e>=0&&o>=0&&t.setCellMeta(e,o,"className",this.stateBefore[e][o]||" htLeft")}))})),t.addHookOnce("afterViewRender",e),t.render()},GQ.CellAlignmentAction.prototype.redo=function(t,e){iH(this.range,this.type,this.alignment,((e,o)=>t.getCellMeta(e,o)),((e,o,n,i)=>t.setCellMeta(e,o,n,i))),t.addHookOnce("afterViewRender",e),t.render()},GQ.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},po(GQ.FiltersAction,GQ.Action),GQ.FiltersAction.prototype.undo=function(t,e){const o=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),o.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),o.filter()},GQ.FiltersAction.prototype.redo=function(t,e){const o=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),o.conditionCollection.importAllConditions(this.conditionsStack),o.filter()};class YQ extends GQ.Action{constructor(t,e){super(),this.cellRange=e;const o=this.cellRange.getTopStartCorner(),n=this.cellRange.getBottomEndCorner();this.rangeData=t.getData(o.row,o.col,n.row,n.col)}undo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.unmergeRange(this.cellRange,!0);const n=this.cellRange.getTopStartCorner();t.populateFromArray(n.row,n.col,this.rangeData,void 0,void 0,"MergeCells")}redo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.mergeRange(this.cellRange)}}GQ.MergeCellsAction=YQ;class KQ extends GQ.Action{constructor(t,e){super(),this.cellRange=e}undo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.mergeRange(this.cellRange,!0)}redo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.unmergeRange(this.cellRange,!0),t.render()}}function XQ(t,e){const o=this;if("loadData"===e)return o.undoRedo.clear()}function qQ(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function QQ(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}GQ.UnmergeCellsAction=KQ,GQ.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"},po(GQ.RowMoveAction,GQ.Action),GQ.RowMoveAction.prototype.undo=function(t,e){const o=t.getPlugin("manualRowMove"),n=[].concat(this.rows),i=n.filter((t=>t>this.finalIndex)),r=n.filter((t=>t<=this.finalIndex)),s=i.sort(((t,e)=>e-t)).concat(r.sort(((t,e)=>t-e)));t.addHookOnce("afterViewRender",e);for(let l=0;l<s.length;l+=1){const e=t.toVisualRow(s[l]);o.moveRow(e,s[l])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},GQ.RowMoveAction.prototype.redo=function(t,e){const o=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),o.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},GQ.prototype.init=function(){const t=this.instance.getSettings().undo,e="undefined"===typeof t||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},GQ.prototype.registerShortcuts=function(){const t=this.instance.getShortcutManager(),e=t.getContext("grid"),o=t=>!t.altKey,n={runOnlyIf:o,group:UQ};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],n)},GQ.prototype.unregisterShortcuts=function(){const t=this.instance.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(UQ)};const JQ=Mn.getSingleton();JQ.add("afterUpdateSettings",(function(){var t;null===(t=this.getPlugin("undoRedo"))||void 0===t||t.init()})),JQ.register("beforeUndo"),JQ.register("afterUndo"),JQ.register("beforeRedo"),JQ.register("afterRedo"),GQ.PLUGIN_KEY=$Q,GQ.SETTING_KEYS=!0;var ZQ,tJ,eJ,oJ,nJ,iJ=GQ;function rJ(){ar(mR),ar(jR),ar(sE),ar(OE),ar(nT),ar(gM),ar(_M),ar(YH),ar(Jk),ar(uA),ar(QA),ar(hO),ar(xO),ar(oP),ar(BD),ar($V),ar(DF),ar(uj),ar(Nj),ar(IB),ar(yz),ar(vU),ar(s$),ar(yG),ar(eY),ar(lY),ar(oX),ar(Iq),ar(nQ),ar(pQ),ar(kQ),ar(BQ),ar(iJ)}function sJ(){lb(),Nb(),Yb(),vS(),rJ()}function lJ(t){const e="undefined"!==typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){const o=this.first();let n,i=o.data("handsontable");if("string"!==typeof e){const n=e||{};return i?i.updateSettings(n):(i=new t.Core(o[0],n),o.data("handsontable",i),i.init()),o}if(i){if("undefined"===typeof i[e])throw new Error(`Handsontable do not provide action: ${e}`);for(var r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];n=i[e].call(i,...s),"destroy"===e&&o.removeData()}return n})}sJ(),lJ(fC),fC.__GhostTable=jS,fC._getListenersCounter=Gn,fC._getRegisteredMapsCounter=ed,fC.EventManager=$n;const aJ=[n,c,m,w,h,l,i,f,a,r,u,g],hJ=[s,d];fC.helper={},fC.dom={},A(aJ,(t=>{A(Object.getOwnPropertyNames(t),(e=>{"_"!==e.charAt(0)&&(fC.helper[e]=t[e])}))})),A(hJ,(t=>{A(Object.getOwnPropertyNames(t),(e=>{"_"!==e.charAt(0)&&(fC.dom[e]=t[e])}))})),fC.cellTypes=null!==(ZQ=fC.cellTypes)&&void 0!==ZQ?ZQ:{},A(Cp(),(t=>{fC.cellTypes[t]=bp(t)})),fC.cellTypes.registerCellType=Sp,fC.cellTypes.getCellType=bp,fC.editors=null!==(tJ=fC.editors)&&void 0!==tJ?tJ:{},A(Pn(),(t=>{fC.editors[`${lt(t)}Editor`]=Dn(t)})),fC.editors.registerEditor=Wn,fC.editors.getEditor=Dn,fC.renderers=null!==(eJ=fC.renderers)&&void 0!==eJ?eJ:{},A(fr(),(t=>{const e=pr(t);"base"===t&&(fC.renderers.cellDecorator=e),fC.renderers[`${lt(t)}Renderer`]=e})),fC.renderers.registerRenderer=wr,fC.renderers.getRenderer=pr,fC.validators=null!==(oJ=fC.validators)&&void 0!==oJ?oJ:{},A(br(),(t=>{fC.validators[`${lt(t)}Validator`]=Rr(t)})),fC.validators.registerValidator=Er,fC.validators.getValidator=Rr,fC.plugins=null!==(nJ=fC.plugins)&&void 0!==nJ?nJ:{},A(rr(),(t=>{fC.plugins[t]=sr(t)})),fC.plugins[`${lt(_S.PLUGIN_KEY)}Plugin`]=_S,fC.plugins.registerPlugin=ar,fC.plugins.getPlugin=sr;var cJ=fC,uJ=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]),dJ=function(t,e,o,n,i,r){if(0===o){var s=t.parentElement;null!==s&&(e%2===0?cJ.dom.addClass(s,Ey):cJ.dom.removeClass(s,Ey))}};function gJ(t,e){if(!(t<0)){var o=this.isRtl()?"htRight":"htLeft";e.firstChild&&(uJ.has(t.toString())?(cJ.dom.removeClass(e.firstChild,o),cJ.dom.addClass(e.firstChild,uJ.get(t.toString()))):cJ.dom.addClass(e.firstChild,o))}}var fJ={name:"DataGrid",data:function(){return{hotSettings:{navigableHeaders:!0,height:450,dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterGetColHeader:gJ,beforeRenderer:dJ,colWidths:[170,222,130,120,120,130,156],colHeaders:["Company name","Name","Sell date","In stock","Qty","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:5,type:"text"},{data:2,type:"text"}],licenseKey:"non-commercial-and-evaluation"},data:Ty()}},components:{HotTable:oy}},mJ=fJ,pJ=o(9917),wJ=(0,pJ.Z)(mJ,b,S,!1,null,null,null),vJ=wJ.exports,CJ={name:"App",components:{DataGrid:vJ}},yJ=CJ,bJ=(0,pJ.Z)(yJ,C,y,!1,null,null,null),SJ=bJ.exports;console.log("Handsontable: v".concat(cJ.version," (").concat(cJ.buildDate,") Wrapper: v").concat(oy.version," Vue: v").concat(v.ZP.version)),v.ZP.config.silent=!0,new v.ZP({render:function(t){return t(SJ)}}).$mount("#app")},5131:function(t,e,o){var n={"./af":4466,"./af.js":4466,"./ar":9252,"./ar-dz":6520,"./ar-dz.js":6520,"./ar-kw":2358,"./ar-kw.js":2358,"./ar-ly":3229,"./ar-ly.js":3229,"./ar-ma":1707,"./ar-ma.js":1707,"./ar-sa":3237,"./ar-sa.js":3237,"./ar-tn":8206,"./ar-tn.js":8206,"./ar.js":9252,"./az":9665,"./az.js":9665,"./be":2888,"./be.js":2888,"./bg":5945,"./bg.js":5945,"./bm":6375,"./bm.js":6375,"./bn":758,"./bn-bd":533,"./bn-bd.js":533,"./bn.js":758,"./bo":5502,"./bo.js":5502,"./br":70,"./br.js":70,"./bs":295,"./bs.js":295,"./ca":6647,"./ca.js":6647,"./cs":4343,"./cs.js":4343,"./cv":9886,"./cv.js":9886,"./cy":2985,"./cy.js":2985,"./da":139,"./da.js":139,"./de":472,"./de-at":994,"./de-at.js":994,"./de-ch":4824,"./de-ch.js":4824,"./de.js":472,"./dv":9271,"./dv.js":9271,"./el":5195,"./el.js":5195,"./en-au":8847,"./en-au.js":8847,"./en-ca":1348,"./en-ca.js":1348,"./en-gb":9053,"./en-gb.js":9053,"./en-ie":1853,"./en-ie.js":1853,"./en-il":4135,"./en-il.js":4135,"./en-in":7122,"./en-in.js":7122,"./en-nz":3011,"./en-nz.js":3011,"./en-sg":6714,"./en-sg.js":6714,"./eo":197,"./eo.js":197,"./es":4293,"./es-do":8029,"./es-do.js":8029,"./es-mx":1154,"./es-mx.js":1154,"./es-us":8357,"./es-us.js":8357,"./es.js":4293,"./et":6720,"./et.js":6720,"./eu":5808,"./eu.js":5808,"./fa":4924,"./fa.js":4924,"./fi":5949,"./fi.js":5949,"./fil":6108,"./fil.js":6108,"./fo":2687,"./fo.js":2687,"./fr":6724,"./fr-ca":9466,"./fr-ca.js":9466,"./fr-ch":867,"./fr-ch.js":867,"./fr.js":6724,"./fy":9550,"./fy.js":9550,"./ga":4735,"./ga.js":4735,"./gd":9878,"./gd.js":9878,"./gl":9787,"./gl.js":9787,"./gom-deva":6492,"./gom-deva.js":6492,"./gom-latn":5339,"./gom-latn.js":5339,"./gu":836,"./gu.js":836,"./he":9315,"./he.js":9315,"./hi":3724,"./hi.js":3724,"./hr":3730,"./hr.js":3730,"./hu":7657,"./hu.js":7657,"./hy-am":1918,"./hy-am.js":1918,"./id":2215,"./id.js":2215,"./is":4095,"./is.js":4095,"./it":2446,"./it-ch":1947,"./it-ch.js":1947,"./it.js":2446,"./ja":9545,"./ja.js":9545,"./jv":1437,"./jv.js":1437,"./ka":1330,"./ka.js":1330,"./kk":8900,"./kk.js":8900,"./km":5620,"./km.js":5620,"./kn":7081,"./kn.js":7081,"./ko":8130,"./ko.js":8130,"./ku":5295,"./ku.js":5295,"./ky":8578,"./ky.js":8578,"./lb":8773,"./lb.js":8773,"./lo":6366,"./lo.js":6366,"./lt":2532,"./lt.js":2532,"./lv":3902,"./lv.js":3902,"./me":3636,"./me.js":3636,"./mi":4059,"./mi.js":4059,"./mk":6005,"./mk.js":6005,"./ml":2982,"./ml.js":2982,"./mn":5543,"./mn.js":5543,"./mr":4898,"./mr.js":4898,"./ms":4145,"./ms-my":8766,"./ms-my.js":8766,"./ms.js":4145,"./mt":4780,"./mt.js":4780,"./my":3445,"./my.js":3445,"./nb":4372,"./nb.js":4372,"./ne":2862,"./ne.js":2862,"./nl":2254,"./nl-be":3293,"./nl-be.js":3293,"./nl.js":2254,"./nn":6986,"./nn.js":6986,"./oc-lnc":6623,"./oc-lnc.js":6623,"./pa-in":3802,"./pa-in.js":3802,"./pl":2560,"./pl.js":2560,"./pt":6467,"./pt-br":9012,"./pt-br.js":9012,"./pt.js":6467,"./ro":5092,"./ro.js":5092,"./ru":2238,"./ru.js":2238,"./sd":5555,"./sd.js":5555,"./se":7291,"./se.js":7291,"./si":3013,"./si.js":3013,"./sk":7005,"./sk.js":7005,"./sl":284,"./sl.js":284,"./sq":7274,"./sq.js":7274,"./sr":1344,"./sr-cyrl":1521,"./sr-cyrl.js":1521,"./sr.js":1344,"./ss":9573,"./ss.js":9573,"./sv":8865,"./sv.js":8865,"./sw":1769,"./sw.js":1769,"./ta":1108,"./ta.js":1108,"./te":2002,"./te.js":2002,"./tet":3164,"./tet.js":3164,"./tg":6599,"./tg.js":6599,"./th":1806,"./th.js":1806,"./tk":2315,"./tk.js":2315,"./tl-ph":3296,"./tl-ph.js":3296,"./tlh":3102,"./tlh.js":3102,"./tr":5886,"./tr.js":5886,"./tzl":6963,"./tzl.js":6963,"./tzm":1203,"./tzm-latn":4676,"./tzm-latn.js":4676,"./tzm.js":1203,"./ug-cn":1444,"./ug-cn.js":1444,"./uk":2676,"./uk.js":2676,"./ur":5026,"./ur.js":5026,"./uz":9895,"./uz-latn":1873,"./uz-latn.js":1873,"./uz.js":9895,"./vi":5646,"./vi.js":5646,"./x-pseudo":7377,"./x-pseudo.js":7377,"./yo":9632,"./yo.js":9632,"./zh-cn":5665,"./zh-cn.js":5665,"./zh-hk":4041,"./zh-hk.js":4041,"./zh-mo":7922,"./zh-mo.js":7922,"./zh-tw":8973,"./zh-tw.js":8973};function i(t){var e=r(t);return o(e)}function r(t){if(!o.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}i.keys=function(){return Object.keys(n)},i.resolve=r,t.exports=i,i.id=5131}},e={};function o(n){var i=e[n];if(void 0!==i)return i.exports;var r=e[n]={id:n,loaded:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.loaded=!0,r.exports}o.m=t,function(){var t=[];o.O=function(e,n,i,r){if(!n){var s=1/0;for(c=0;c<t.length;c++){n=t[c][0],i=t[c][1],r=t[c][2];for(var l=!0,a=0;a<n.length;a++)(!1&r||s>=r)&&Object.keys(o.O).every((function(t){return o.O[t](n[a])}))?n.splice(a--,1):(l=!1,r<s&&(s=r));if(l){t.splice(c--,1);var h=i();void 0!==h&&(e=h)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[n,i,r]}}(),function(){o.d=function(t,e){for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){o.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,n){var i,r,s=n[0],l=n[1],a=n[2],h=0;if(s.some((function(e){return 0!==t[e]}))){for(i in l)o.o(l,i)&&(o.m[i]=l[i]);if(a)var c=a(o)}for(e&&e(n);h<s.length;h++)r=s[h],o.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return o.O(c)},n=self["webpackChunkvue_template"]=self["webpackChunkvue_template"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(7180)}));n=o.O(n)})();
//# sourceMappingURL=app.992277c3.js.map