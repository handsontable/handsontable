(function(){var t={4877:function(t,e,o){"use strict";var n={};o.r(n),o.d(n,{arrayAvg:function(){return _},arrayEach:function(){return A},arrayFilter:function(){return k},arrayFlatten:function(){return L},arrayMap:function(){return I},arrayMax:function(){return P},arrayMin:function(){return N},arrayReduce:function(){return x},arraySum:function(){return O},arrayUnique:function(){return D},extendArray:function(){return M},getDifferenceOfArrays:function(){return W},getIntersectionOfArrays:function(){return V},getUnionOfArrays:function(){return F},pivot:function(){return H},stringToArray:function(){return j},to2dArray:function(){return T}});var i={};o.r(i),o.d(i,{_injectProductInfo:function(){return rt},isDefined:function(){return U},isEmpty:function(){return G},isRegExp:function(){return Y},isUndefined:function(){return $},stringify:function(){return z}});var r={};o.r(r),o.d(r,{equalsIgnoreCase:function(){return at},isPercentValue:function(){return ct},randomString:function(){return ht},sanitize:function(){return gt},stripTags:function(){return dt},substitute:function(){return ut},toUpperCaseFirst:function(){return lt}});var s={};o.r(s),o.d(s,{HTML_CHARACTERS:function(){return ve},addClass:function(){return de},addEvent:function(){return Le},appendElement:function(){return ro},clearTextSelection:function(){return je},closest:function(){return ie},closestDown:function(){return re},empty:function(){return we},fastInnerHTML:function(){return Ce},fastInnerText:function(){return ye},getCaretPosition:function(){return We},getComputedStyle:function(){return Ae},getCssTransform:function(){return Xe},getFrameElement:function(){return ee},getParent:function(){return Zt},getParentWindow:function(){return oe},getScrollLeft:function(){return Me},getScrollTop:function(){return Te},getScrollableElement:function(){return He},getScrollbarWidth:function(){return $e},getSelectionEndPosition:function(){return Ve},getSelectionText:function(){return Fe},getStyle:function(){return ke},getTrimmingContainer:function(){return xe},getWindowScrollLeft:function(){return Ee},getWindowScrollTop:function(){return Re},hasAccessToParentWindow:function(){return ne},hasClass:function(){return ue},hasHorizontalScrollbar:function(){return Ye},hasVerticalScrollbar:function(){return Ge},index:function(){return le},innerHeight:function(){return Ne},innerWidth:function(){return _e},isChildOf:function(){return se},isDetached:function(){return to},isInput:function(){return Qe},isOutsideInput:function(){return Je},isThisHotChild:function(){return te},isVisible:function(){return be},makeElementContentEditableAndSelectItsContent:function(){return oo},matchesCSSRules:function(){return Ie},observeVisibilityChangeOnce:function(){return eo},offset:function(){return Se},outerHeight:function(){return Pe},outerWidth:function(){return Oe},overlayContainsElement:function(){return ae},removeAttribute:function(){return me},removeClass:function(){return ge},removeContentEditableFromElementAndDeselect:function(){return no},removeEvent:function(){return De},removeTextNodes:function(){return pe},resetCssTransform:function(){return qe},runWithSelectedContendEditableElement:function(){return io},selectElementIfAllowed:function(){return Ze},setAttribute:function(){return fe},setCaretPosition:function(){return Be},setOverlayPosition:function(){return Ke}});var l={};o.r(l),o.d(l,{curry:function(){return go},curryRight:function(){return fo},debounce:function(){return ho},fastCall:function(){return mo},isFunction:function(){return so},partial:function(){return uo},pipe:function(){return co},throttle:function(){return lo},throttleAfterHits:function(){return ao}});var a={};o.r(a),o.d(a,{clone:function(){return bo},createObjectPropListener:function(){return Io},deepClone:function(){return yo},deepExtend:function(){return Co},deepObjectSize:function(){return ko},defineGetter:function(){return To},duckSchema:function(){return po},extend:function(){return vo},getProperty:function(){return Ho},hasOwnProperty:function(){return Ao},inherit:function(){return wo},isObject:function(){return Eo},isObjectEqual:function(){return Ro},mixin:function(){return So},objectEach:function(){return Mo},setProperty:function(){return xo}});var h={};o.r(h),o.d(h,{isChrome:function(){return Do},isChromeWebKit:function(){return Wo},isEdge:function(){return Bo},isEdgeWebKit:function(){return zo},isFirefox:function(){return Vo},isFirefoxWebKit:function(){return Fo},isIOS:function(){return $o},isIpadOS:function(){return Go},isLinuxOS:function(){return Xo},isMacOS:function(){return Ko},isMobileBrowser:function(){return Uo},isSafari:function(){return jo},isWindowsOS:function(){return Yo},setBrowserMeta:function(){return _o},setPlatformMeta:function(){return Lo}});var c={};o.r(c),o.d(c,{KEY_CODES:function(){return qo},isCtrlKey:function(){return tn},isCtrlMetaKey:function(){return en},isFunctionKey:function(){return Zo},isKey:function(){return on},isPrintableChar:function(){return Jo}});var u={};o.r(u),o.d(u,{isImmediatePropagationStopped:function(){return rn},isLeftClick:function(){return ln},isRightClick:function(){return sn},offsetRelativeTo:function(){return an},stopImmediatePropagation:function(){return nn}});var d={};o.r(d),o.d(d,{_dataToHTML:function(){return ki},htmlToGridSettings:function(){return Ii},instanceToHTML:function(){return xi}});var g={};o.r(g),o.d(g,{clamp:function(){return Li},isNumeric:function(){return Ai},isNumericLike:function(){return Oi},rangeEach:function(){return Pi},rangeEachReverse:function(){return Ni},valueAccordingPercent:function(){return _i}});var f={};o.r(f),o.d(f,{cancelAnimationFrame:function(){return yr},getComparisonFunction:function(){return Rr},isTouchSupported:function(){return br},requestAnimationFrame:function(){return Cr}});var m={};o.r(m),o.d(m,{countFirstRowKeys:function(){return Uc},createEmptySpreadsheetData:function(){return Bc},createSpreadsheetData:function(){return Fc},createSpreadsheetObjectData:function(){return jc},dataRowToChangesArray:function(){return zc},isArrayOfArrays:function(){return $c},isArrayOfObjects:function(){return Gc},spreadsheetColumnIndex:function(){return Vc},spreadsheetColumnLabel:function(){return Wc}});var p={};o.r(p),o.d(p,{CHECKBOX_CHECKED:function(){return Fg},CHECKBOX_RENDERER_NAMESPACE:function(){return Vg},CHECKBOX_UNCHECKED:function(){return jg},COLUMN_HEADER_DESCRIPTION_COLLAPSE_COLUMN:function(){return Ug},COLUMN_HEADER_DESCRIPTION_EXPAND_COLUMN:function(){return zg},COLUMN_HEADER_DESCRIPTION_SORT_ROWS:function(){return $g},COLUMN_HEADER_LABEL_AFTER_HIDDEN_COLUMN:function(){return Xg},COLUMN_HEADER_LABEL_BEFORE_HIDDEN_COLUMN:function(){return Kg},COLUMN_HEADER_LABEL_MULTI_COLUMN_SORT_ORDER:function(){return Gg},COLUMN_HEADER_LABEL_OPEN_MENU:function(){return Yg},COLUMN_HEADER_NAMESPACE:function(){return Bg},CONTEXTMENU_ITEMS_ADD_COMMENT:function(){return Nd},CONTEXTMENU_ITEMS_ALIGNMENT:function(){return Wd},CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:function(){return $d},CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:function(){return Fd},CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:function(){return Bd},CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:function(){return Vd},CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:function(){return Ud},CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:function(){return jd},CONTEXTMENU_ITEMS_ALIGNMENT_TOP:function(){return zd},CONTEXTMENU_ITEMS_BORDERS:function(){return Gd},CONTEXTMENU_ITEMS_BORDERS_BOTTOM:function(){return Xd},CONTEXTMENU_ITEMS_BORDERS_LEFT:function(){return qd},CONTEXTMENU_ITEMS_BORDERS_RIGHT:function(){return Kd},CONTEXTMENU_ITEMS_BORDERS_TOP:function(){return Yd},CONTEXTMENU_ITEMS_CLEAR_COLUMN:function(){return Ed},CONTEXTMENU_ITEMS_COPY:function(){return Td},CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:function(){return xd},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:function(){return Hd},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:function(){return Md},CONTEXTMENU_ITEMS_CUT:function(){return kd},CONTEXTMENU_ITEMS_EDIT_COMMENT:function(){return _d},CONTEXTMENU_ITEMS_FREEZE_COLUMN:function(){return Id},CONTEXTMENU_ITEMS_HIDE_COLUMN:function(){return tg},CONTEXTMENU_ITEMS_HIDE_ROW:function(){return og},CONTEXTMENU_ITEMS_INSERT_LEFT:function(){return wd},CONTEXTMENU_ITEMS_INSERT_RIGHT:function(){return vd},CONTEXTMENU_ITEMS_MERGE_CELLS:function(){return Od},CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:function(){return Zd},CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:function(){return Jd},CONTEXTMENU_ITEMS_NO_ITEMS:function(){return fd},CONTEXTMENU_ITEMS_READ_ONLY:function(){return Rd},CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:function(){return Dd},CONTEXTMENU_ITEMS_REDO:function(){return Sd},CONTEXTMENU_ITEMS_REMOVE_BORDERS:function(){return Qd},CONTEXTMENU_ITEMS_REMOVE_COLUMN:function(){return yd},CONTEXTMENU_ITEMS_REMOVE_COMMENT:function(){return Ld},CONTEXTMENU_ITEMS_REMOVE_ROW:function(){return Cd},CONTEXTMENU_ITEMS_ROW_ABOVE:function(){return md},CONTEXTMENU_ITEMS_ROW_BELOW:function(){return pd},CONTEXTMENU_ITEMS_SHOW_COLUMN:function(){return eg},CONTEXTMENU_ITEMS_SHOW_ROW:function(){return ng},CONTEXTMENU_ITEMS_UNDO:function(){return bd},CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:function(){return Ad},CONTEXTMENU_ITEMS_UNMERGE_CELLS:function(){return Pd},CONTEXT_MENU_ITEMS_NAMESPACE:function(){return dd},FILTERS_BUTTONS_CANCEL:function(){return _g},FILTERS_BUTTONS_CLEAR:function(){return Pg},FILTERS_BUTTONS_OK:function(){return Ng},FILTERS_BUTTONS_PLACEHOLDER_SEARCH:function(){return Lg},FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:function(){return Wg},FILTERS_BUTTONS_PLACEHOLDER_VALUE:function(){return Dg},FILTERS_BUTTONS_SELECT_ALL:function(){return Og},FILTERS_CONDITIONS_AFTER:function(){return Sg},FILTERS_CONDITIONS_BEFORE:function(){return Rg},FILTERS_CONDITIONS_BEGINS_WITH:function(){return ug},FILTERS_CONDITIONS_BETWEEN:function(){return yg},FILTERS_CONDITIONS_BY_VALUE:function(){return mg},FILTERS_CONDITIONS_CONTAINS:function(){return gg},FILTERS_CONDITIONS_EMPTY:function(){return lg},FILTERS_CONDITIONS_ENDS_WITH:function(){return dg},FILTERS_CONDITIONS_EQUAL:function(){return hg},FILTERS_CONDITIONS_GREATER_THAN:function(){return pg},FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:function(){return wg},FILTERS_CONDITIONS_LESS_THAN:function(){return vg},FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:function(){return Cg},FILTERS_CONDITIONS_NAMESPACE:function(){return rg},FILTERS_CONDITIONS_NONE:function(){return sg},FILTERS_CONDITIONS_NOT_BETWEEN:function(){return bg},FILTERS_CONDITIONS_NOT_CONTAIN:function(){return fg},FILTERS_CONDITIONS_NOT_EMPTY:function(){return ag},FILTERS_CONDITIONS_NOT_EQUAL:function(){return cg},FILTERS_CONDITIONS_TODAY:function(){return Eg},FILTERS_CONDITIONS_TOMORROW:function(){return Tg},FILTERS_CONDITIONS_YESTERDAY:function(){return Mg},FILTERS_DIVS_FILTER_BY_CONDITION:function(){return Hg},FILTERS_DIVS_FILTER_BY_VALUE:function(){return xg},FILTERS_LABELS_CONJUNCTION:function(){return kg},FILTERS_LABELS_DISJUNCTION:function(){return Ig},FILTERS_NAMESPACE:function(){return ig},FILTERS_VALUES_BLANK_CELLS:function(){return Ag},ROW_HEADER_DESCRIPTION_COLLAPSE_ROW:function(){return Jg},ROW_HEADER_DESCRIPTION_EXPAND_ROW:function(){return Qg},ROW_HEADER_LABEL_AFTER_HIDDEN_ROW:function(){return tf},ROW_HEADER_LABEL_BEFORE_HIDDEN_ROW:function(){return Zg},ROW_HEADER_NAMESPACE:function(){return qg}});var w={};o.r(w),o.d(w,{getNormalizedDate:function(){return wb}});var v=o(6427),C=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("DataGrid")],1)},y=[],b=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"example"}},[e("hot-table",{ref:"hotTableComponent",attrs:{data:t.data,settings:t.hotSettings}})],1)},S=[],R=(o(9796),o(3247),o(9028),o(9757)),E=o(8289);function T(t){const e=t.length;let o=0;while(o<e)t[o]=[t[o]],o+=1}function M(t,e){const o=e.length;let n=0;while(n<o)t.push(e[n]),n+=1}function H(t){const e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;const o=t.length,n=t[0].length;for(let i=0;i<o;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function x(t,e,o,n){let i=-1,r=t,s=o;Array.isArray(t)||(r=Array.from(t));const l=r.length;n&&l&&(i+=1,s=r[i]),i+=1;while(i<l)s=e(s,r[i],i,r),i+=1;return s}function k(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,r=[];let s=-1;while(o<i){const t=n[o];e(t,o,n)&&(s+=1,r[s]=t),o+=1}return r}function I(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,r=[];let s=-1;while(o<i){const t=n[o];s+=1,r[s]=e(t,o,n),o+=1}return r}function A(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;while(o<i){if(!1===e(n[o],o,n))break;o+=1}return t}function O(t){return x(t,((t,e)=>t+e),0)}function P(t){return x(t,((t,e)=>t>e?t:e),Array.isArray(t)?t[0]:void 0)}function N(t){return x(t,((t,e)=>t<e?t:e),Array.isArray(t)?t[0]:void 0)}function _(t){return t.length?O(t)/t.length:0}function L(t){return x(t,((t,e)=>t.concat(Array.isArray(e)?L(e):e)),[])}function D(t){const e=[];return A(t,(t=>{-1===e.indexOf(t)&&e.push(t)})),e}function W(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...i]=[...e];let r=n;return A(i,(t=>{r=r.filter((e=>!t.includes(e)))})),r}function V(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...i]=[...e];let r=n;return A(i,(t=>{r=r.filter((e=>t.includes(e)))})),r}function F(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...i]=[...e],r=new Set(n);return A(i,(t=>{A(t,(t=>{r.has(t)||r.add(t)}))})),Array.from(r)}function j(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}function B(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];const i=x(t,((t,e,n)=>{const i=e.replace(/\r?\n\s*/g,""),r=o[n]?o[n]:"";return t+i+r}),"");return i.trim()}function z(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function U(t){return"undefined"!==typeof t}function $(t){return"undefined"===typeof t}function G(t){return null===t||""===t||$(t)}function Y(t){return"[object RegExp]"===Object.prototype.toString.call(t)}const K="length",X=t=>parseInt(t,16),q=t=>parseInt(t,10),Q=(t,e,o)=>t["substr"](e,o),J=t=>t["codePointAt"](0)-65,Z=t=>`${t}`.replace(/\-/g,""),tt=t=>X(Q(Z(t),X("12"),J("F")))/(X(Q(Z(t),J("B"),~~![][K]))||9),et=()=>"undefined"!==typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let ot=!1;const nt={invalid:()=>B`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:o}=t;return B`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${o}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>B`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},it={invalid:()=>B`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:o}=t;return B`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${o}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>B`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function rt(t,e){const o=!G(t),n="string"===typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),i="13.1.0";let r,s="invalid",l="invalid";t=Z(t||"");const a=st(t);if(o||n||a)if(a){const e=E("31/08/2023","DD/MM/YYYY"),o=Math.floor(e.toDate().getTime()/864e5),n=tt(t);r=E(864e5*(n+1),"x").format("MMMM DD, YYYY"),o>n?(s="expired",l="expired"):(s="valid",l="valid")}else n?(s="non_commercial",l="valid"):(s="invalid",l="invalid");else s="missing",l="missing";if(et()&&(s="valid",l="valid"),!ot&&"valid"!==s){const t=nt[s]({keyValidityDate:r,hotVersion:i});t&&console["non_commercial"===s?"info":"warn"](nt[s]({keyValidityDate:r,hotVersion:i})),ot=!0}if("valid"!==l&&e.parentNode){const t=it[l]({keyValidityDate:r,hotVersion:i});if(t){const t=document.createElement("div");t.className="hot-display-license-info",t.innerHTML=it[l]({keyValidityDate:r,hotVersion:i}),e.parentNode.insertBefore(t,e.nextSibling)}}}function st(t){let e=[][K],o=e;if(t[K]!==J("Z"))return!1;for(let n="",i="B<H4P+".split(""),r=J(i.shift());r;r=J(i.shift()||"A"))--r<""[K]?o|=(q(`${q(X(n)+(X(Q(t,Math.abs(r),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=Q(t,r,r?1===i[K]?9:8:6);return o===e}function lt(t){return t[0].toUpperCase()+t.substr(1)}function at(){const t=[];for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];let i=o.length;while(i){i-=1;const e=z(o[i]).toLowerCase();-1===t.indexOf(e)&&t.push(e)}return 1===t.length}function ht(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function ct(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function ut(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,((t,o)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[o]?"":e[o]))}function dt(t){return gt(`${t}`,{ALLOWED_TAGS:[]})}function gt(t,e){return R.sanitize(t,e)}const ft=t=>["tabindex",t],mt=()=>["role","treegrid"],pt=()=>["role","presentation"],wt=()=>["role","gridcell"],vt=()=>["role","rowheader"],Ct=()=>["role","columnheader"],yt=()=>["role","row"],bt=()=>["role","menu"],St=()=>["role","menuitem"],Rt=()=>["role","combobox"],Et=()=>["role","listbox"],Tt=()=>["role","option"],Mt=()=>["role","checkbox"],Ht=()=>["scope","col"],xt=()=>["scope","row"],kt=()=>["type","text"],It=t=>["aria-label",t],At=t=>["aria-description",t],Ot=()=>["aria-hidden","true"],Pt=()=>["aria-disabled","true"],Nt=()=>["aria-multiselectable","true"],_t=t=>["aria-haspopup",t],Lt=t=>["aria-rowcount",t],Dt=t=>["aria-colcount",t],Wt=t=>["aria-rowindex",t],Vt=t=>["aria-colindex",t],Ft=t=>["aria-expanded",t],jt=t=>["aria-sort",t],Bt=()=>["aria-readonly","true"],zt=()=>["aria-invalid","true"],Ut=t=>["aria-checked",t],$t=()=>["aria-selected","true"],Gt=()=>["aria-autocomplete","list"],Yt=t=>["aria-controls",t],Kt=t=>["aria-activedescendant",t],Xt=t=>["aria-live",t],qt=t=>["aria-relevant",t],Qt=t=>["aria-setsize",t],Jt=t=>["aria-posinset",t];function Zt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=-1,n=null,i=t;while(null!==i){if(o===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(o+=1,i=i.parentNode)}return n}function te(t,e){const o=t.closest(".handsontable");return!!o&&(o.parentNode===e||o===e)}function ee(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function oe(t){return ee(t)&&t.parent}function ne(t){return!!Object.getPrototypeOf(t.parent)}function ie(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let r=t;while(null!==r&&void 0!==r&&r!==o){const{nodeType:t,nodeName:o}=r;if(t===n&&(e.includes(o)||e.includes(r)))return r;const{host:s}=r;r=s&&t===i?s:r.parentNode}return null}function re(t,e,o){const n=[];let i=t;while(i){if(i=ie(i,e,o),!i||o&&!o.contains(i))break;n.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode}const r=n.length;return r?n[r-1]:null}function se(t,e){let o=t.parentNode,n=[];"string"===typeof e?n=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);while(null!==o){if(n.indexOf(o)>-1)return!0;o=o.parentNode}return!1}function le(t){let e=0,o=t;if(o.previousSibling)while(o=o.previousSibling)e+=1;return e}function ae(t,e,o){const n=o.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function he(t){return t&&t.length?t.filter((t=>!!t)):[]}function ce(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const o=[],n=[];return n.push(...t.filter((t=>{const n=t instanceof RegExp;return n&&e&&o.push(t),!n}))),e?{regexFree:n,regexes:o}:n}function ue(t,e){return void 0!==t.classList&&"string"===typeof e&&""!==e&&t.classList.contains(e)}function de(t,e){"string"===typeof e&&(e=e.split(" ")),e=he(e),e.length>0&&t.classList.add(...e)}function ge(t,e){"string"===typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:o,regexes:n}=ce(e,!0);o=he(o),o.length>0&&t.classList.remove(...o),n.forEach((e=>{t.classList.forEach((o=>{e.test(o)&&t.classList.remove(o)}))}))}function fe(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,o]]),e.forEach((e=>{Array.isArray(e)&&""!==e[0]&&t.setAttribute(...e)}))}function me(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"===typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:o,regexes:n}=ce(e,!0);o.forEach((e=>{""!==e&&t.removeAttribute(e)})),n.forEach((e=>{t.getAttributeNames().forEach((o=>{e.test(o)&&t.removeAttribute(o)}))}))}function pe(t){if(3===t.nodeType)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let t=e.length-1;t>=0;t--)pe(e[t])}}function we(t){let e;while(e=t.lastChild)t.removeChild(e)}const ve=/(<(.*)>|&(.*);)/;function Ce(t,e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];ve.test(e)?t.innerHTML=o?gt(e):e:ye(t,e)}function ye(t,e){const o=t.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=e:(we(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function be(t){const e=t.ownerDocument.documentElement;let o=t;while(o!==e){if(null===o)return!1;if(o.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(o.host){if(o.host.impl)return be(o.host.impl);if(o.host)return be(o.host);throw new Error("Lost in Web Components world")}return!1}if("none"===Ae(o).display)return!1;o=o.parentNode}return!0}function Se(t){const e=t.ownerDocument,o=e.defaultView,n=e.documentElement;let i,r,s,l=t;i=l.offsetLeft,r=l.offsetTop,s=l;while(l=l.offsetParent){if(l===e.body)break;if(!("offsetLeft"in l))break;i+=l.offsetLeft,r+=l.offsetTop,s=l}return s&&"fixed"===s.style.position&&(i+=o.pageXOffset||n.scrollLeft,r+=o.pageYOffset||n.scrollTop),{left:i,top:r}}function Re(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollY}function Ee(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollX}function Te(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?Re(e):t.scrollTop}function Me(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?Ee(e):t.scrollLeft}function He(t){let e=t.ownerDocument,o=e?e.defaultView:void 0;e||(e=t.document?t.document:t,o=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;while(i&&i.style&&e.body!==i){let{overflow:t,overflowX:e,overflowY:r}=i.style;if([t,e,r].includes("scroll"))return i;if(({overflow:t,overflowX:e,overflowY:r}=o.getComputedStyle(i)),n.includes(t)||n.includes(e)||n.includes(r))return i;if(i.clientHeight<=i.scrollHeight+1&&(n.includes(r)||n.includes(t)))return i;if(i.clientWidth<=i.scrollWidth+1&&(n.includes(e)||n.includes(t)))return i;i=i.parentNode}return o}function xe(t){const e=t.ownerDocument,o=e.defaultView;let n=t.parentNode;while(n&&n.style&&e.body!==n){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;const t=Ae(n,o),e=["scroll","hidden","auto"],i=t.getPropertyValue("overflow"),r=t.getPropertyValue("overflow-y"),s=t.getPropertyValue("overflow-x");if(e.includes(i)||e.includes(r)||e.includes(s))return n;n=n.parentNode}return o}function ke(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!t)return;if(t===o)return"width"===e?`${o.innerWidth}px`:"height"===e?`${o.innerHeight}px`:void 0;const n=t.style[e];if(""!==n&&void 0!==n)return n;const i=Ae(t,o);return""!==i[e]&&void 0!==i[e]?i[e]:void 0}function Ie(t,e){const{selectorText:o}=e;let n=!1;return e.type===CSSRule.STYLE_RULE&&o&&(t.msMatchesSelector?n=t.msMatchesSelector(o):t.matches&&(n=t.matches(o))),n}function Ae(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function Oe(t){return t.offsetWidth}function Pe(t){return t.offsetHeight}function Ne(t){return t.clientHeight||t.innerHeight}function _e(t){return t.clientWidth||t.innerWidth}function Le(t,e,o){t.addEventListener(e,o,!1)}function De(t,e,o){t.removeEventListener(e,o,!1)}function We(t){return t.selectionStart?t.selectionStart:0}function Ve(t){return t.selectionEnd?t.selectionEnd:0}function Fe(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;const e=t.document;let o="";return t.getSelection?o=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(o=e.selection.createRange().text),o}function je(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Be(t,e,o){if(void 0===o&&(o=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,o)}catch(n){const i=t.parentNode,r=i.style.display;i.style.display="block",t.setSelectionRange(e,o),i.style.display=r}}}let ze;function Ue(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const o=t.createElement("div");o.style.boxSizing="content-box",o.style.height="150px",o.style.left="0px",o.style.overflow="hidden",o.style.position="absolute",o.style.top="0px",o.style.width="200px",o.style.visibility="hidden",o.appendChild(e),(t.body||t.documentElement).appendChild(o);const n=e.offsetWidth;o.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=o.clientWidth),(t.body||t.documentElement).removeChild(o),n-i}function $e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===ze&&(ze=Ue(t)),ze}function Ge(t){return t.offsetWidth!==t.clientWidth}function Ye(t){return t.offsetHeight!==t.clientHeight}function Ke(t,e,o){t.style.transform=`translate3d(${e},${o},0)`}function Xe(t){let e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:-1}function qe(t){t.style.transform&&""!==t.style.transform&&(t.style.transform="")}function Qe(t){const e=["INPUT","SELECT","TEXTAREA"];return t&&(e.indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function Je(t){return Qe(t)&&!1===t.hasAttribute("data-hot-input")}function Ze(t){const e=t.ownerDocument.activeElement;Je(e)||t.select()}function to(t){return!t.parentNode}function eo(t,e){const o=new IntersectionObserver(((o,n)=>{o.forEach((o=>{o.isIntersecting&&null!==t.offsetParent&&(e(),n.unobserve(t))}))}),{root:t.ownerDocument.body});o.observe(t)}function oo(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=t.ownerDocument,i=n.createRange(),r=n.defaultView.getSelection();fe(t,"contenteditable",!0),o&&fe(t,...Ot()),e&&de(t,"invisibleSelection"),i.selectNodeContents(t),r.removeAllRanges(),r.addRange(i)}function no(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),o.removeAllRanges(),e&&ge(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function io(t,e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];oo(t,o),e(),no(t,o)}function ro(t,e){let{tagName:o,className:n,attributes:i}=e;const r=t.ownerDocument.createElement(o);return n&&de(r,n),i&&i.length&&fe(r,i),t.appendChild(r),r}function so(t){return"function"===typeof t}function lo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=0;const n={lastCallThrottled:!0};let i=null;function r(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];const a=Date.now();let h=!1;n.lastCallThrottled=!0,o||(o=a,h=!0);const c=e-(a-o);return h?(n.lastCallThrottled=!1,t.apply(this,s)):(i&&clearTimeout(i),i=setTimeout((()=>{n.lastCallThrottled=!1,t.apply(this,s),o=0,i=void 0}),c)),n}return r}function ao(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;const n=lo(t,e);let i=o;function r(){i=o}function s(){for(var e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];return i?(i-=1,t.apply(this,o)):n.apply(this,o)}return s.clearHits=r,s}function ho(t){let e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=null;function i(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n&&clearTimeout(n),n=setTimeout((()=>{e=t.apply(this,r)}),o),e}return i}function co(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...i]=e;return function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return x(i,((t,e)=>e(t)),n.apply(this,e))}}function uo(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(this,o.concat(n))}}function go(t){const e=t.length;function o(n){return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const l=n.concat(r);let a;return a=l.length>=e?t.apply(this,l):o(l),a}}return o([])}function fo(t){const e=t.length;function o(n){return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const l=n.concat(r.reverse());let a;return a=l.length>=e?t.apply(this,l):o(l),a}}return o([])}function mo(t,e,o,n,i,r,s,l){return U(l)?t.call(e,o,n,i,r,s,l):U(s)?t.call(e,o,n,i,r,s):U(r)?t.call(e,o,n,i,r):U(i)?t.call(e,o,n,i):U(n)?t.call(e,o,n):U(o)?t.call(e,o):t.call(e)}o(7751);function po(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Mo(t,((t,o)=>{"__children"!==o&&(t&&"object"===typeof t&&!Array.isArray(t)?e[o]=po(t):Array.isArray(t)?t.length&&"object"===typeof t[0]&&!Array.isArray(t[0])?e[o]=[po(t[0])]:e[o]=[]:e[o]=null)}))),e}function wo(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function vo(t,e,o){const n=Array.isArray(o);return Mo(e,((e,i)=>{(!1===n||o.includes(i))&&(t[i]=e)})),t}function Co(t,e){Mo(e,((o,n)=>{e[n]&&"object"===typeof e[n]?(t[n]||(Array.isArray(e[n])?t[n]=[]:"[object Date]"===Object.prototype.toString.call(e[n])?t[n]=e[n]:t[n]={}),Co(t[n],e[n])):t[n]=e[n]}))}function yo(t){return"object"===typeof t?JSON.parse(JSON.stringify(t)):t}function bo(t){const e={};return Mo(t,((t,o)=>{e[o]=t})),e}function So(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];return A(o,(e=>{t.MIXINS.push(e.MIXIN_NAME),Mo(e,((e,o)=>{if(void 0!==t.prototype[o])throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if("function"===typeof e)t.prototype[o]=e;else{const n=function(t,e){const o=`_${t}`,n=t=>{let e=t;return(Array.isArray(e)||Eo(e))&&(e=yo(e)),e};return function(){return void 0===this[o]&&(this[o]=n(e)),this[o]}},i=function(t){const e=`_${t}`;return function(t){this[e]=t}};Object.defineProperty(t.prototype,o,{get:n(o,e),set:i(o),configurable:!0})}}))})),t}function Ro(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Eo(t){return"[object Object]"===Object.prototype.toString.call(t)}function To(t,e,o,n){n.value=o,n.writable=!1!==n.writable,n.enumerable=!1!==n.enumerable,n.configurable=!1!==n.configurable,Object.defineProperty(t,e,n)}function Mo(t,e){for(const o in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,o))&&!1===e(t[o],o,t))break;return t}function Ho(t,e){const o=e.split(".");let n=t;return Mo(o,(t=>{if(n=n[t],void 0===n)return n=void 0,!1})),n}function xo(t,e,o){const n=e.split(".");let i=t;n.forEach(((t,e)=>{e!==n.length-1?(Ao(i,t)||(i[t]={}),i=i[t]):i[t]=o}))}function ko(t){if(!Eo(t))return 0;const e=function(t){let o=0;return Eo(t)?Mo(t,((t,n)=>{"__children"!==n&&(o+=e(t))})):o+=1,o};return e(t)}function Io(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const o=`_${e}`,n={_touched:!1,[o]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[o]},set(t){this._touched=!0,this[o]=t},enumerable:!0,configurable:!0}),n}function Ao(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const Oo=t=>{const e={value:!1,test:(o,n)=>{e.value=t(o,n)}};return e},Po={chrome:Oo(((t,e)=>/Chrome/.test(t)&&/Google/.test(e))),chromeWebKit:Oo((t=>/CriOS/.test(t))),edge:Oo((t=>/Edge/.test(t))),edgeWebKit:Oo((t=>/EdgiOS/.test(t))),firefox:Oo((t=>/Firefox/.test(t))),firefoxWebKit:Oo((t=>/FxiOS/.test(t))),mobile:Oo((t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t))),safari:Oo(((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e)))},No={mac:Oo((t=>/^Mac/.test(t))),win:Oo((t=>/^Win/.test(t))),linux:Oo((t=>/^Linux/.test(t))),ios:Oo((t=>/iPhone|iPad|iPod/i.test(t)))};function _o(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Mo(Po,(o=>{let{test:n}=o;n(t,e)}))}function Lo(){let{platform:t=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Mo(No,(e=>{let{test:o}=e;o(t)}))}function Do(){return Po.chrome.value}function Wo(){return Po.chromeWebKit.value}function Vo(){return Po.firefox.value}function Fo(){return Po.firefoxWebKit.value}function jo(){return Po.safari.value}function Bo(){return Po.edge.value}function zo(){return Po.edgeWebKit.value}function Uo(){return Po.mobile.value}function $o(){return No.ios.value}function Go(){let{maxTouchPoints:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t>2&&No.mac.value}function Yo(){return No.win.value}function Ko(){return No.mac.value}function Xo(){return No.linux.value}_o(),Lo();const qo={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Vo()?182:174,AUDIO_MUTE:Vo()?181:173,AUDIO_UP:Vo()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Qo=[qo.ALT,qo.ARROW_DOWN,qo.ARROW_LEFT,qo.ARROW_RIGHT,qo.ARROW_UP,qo.AUDIO_DOWN,qo.AUDIO_MUTE,qo.AUDIO_UP,qo.BACKSPACE,qo.CAPS_LOCK,qo.DELETE,qo.END,qo.ENTER,qo.ESCAPE,qo.F1,qo.F2,qo.F3,qo.F4,qo.F5,qo.F6,qo.F7,qo.F8,qo.F9,qo.F10,qo.F11,qo.F12,qo.F13,qo.F14,qo.F15,qo.F16,qo.F17,qo.F18,qo.F19,qo.HOME,qo.INSERT,qo.MEDIA_NEXT,qo.MEDIA_PLAY_PAUSE,qo.MEDIA_PREV,qo.MEDIA_STOP,qo.NULL,qo.NUM_LOCK,qo.PAGE_DOWN,qo.PAGE_UP,qo.PAUSE,qo.SCROLL_LOCK,qo.SHIFT,qo.TAB];function Jo(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Zo(t){return Qo.includes(t)}function tn(t){const e=[];return Ko()?e.push(qo.COMMAND_LEFT,qo.COMMAND_RIGHT,qo.COMMAND_FIREFOX):e.push(qo.CONTROL),e.includes(t)}function en(t){return[qo.CONTROL,qo.COMMAND_LEFT,qo.COMMAND_RIGHT,qo.COMMAND_FIREFOX].includes(t)}function on(t,e){const o=e.split("|");let n=!1;return A(o,(e=>{if(t===qo[e])return n=!0,!1})),n}function nn(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function rn(t){return!1===t.isImmediatePropagationEnabled}function sn(t){return 2===t.button}function ln(t){return 0===t.button}function an(t,e){const o={x:t.offsetX,y:t.offsetY};let n=t.target;if(!(e instanceof HTMLElement)||n!==e&&n.contains(e))return o;while(n!==e)o.x+=n.offsetLeft,o.y+=n.offsetTop,n=n.offsetParent;return o}function hn(){U(console)&&console.warn(...arguments)}function cn(){U(console)&&console.error(...arguments)}function un(t,e,o){return e=dn(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function dn(t){var e=gn(t,"string");return"symbol"===typeof e?e:String(e)}function gn(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const fn=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],mn=B`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,pn=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),wn=new Map([[]]);class vn{static getSingleton(){return yn()}constructor(){un(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const t=Object.create(null);return A(fn,(e=>t[e]=[])),t}getBucket(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}add(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))A(e,(e=>this.add(t,e,o)));else{pn.has(t)&&hn(ut(mn,{hookName:t,removedInVersion:pn.get(t)})),wn.has(t)&&hn(wn.get(t));const n=this.getBucket(o);if("undefined"===typeof n[t]&&(this.register(t),n[t]=[]),e.skip=!1,-1===n[t].indexOf(e)){let o=!1;e.initialHook&&A(n[t],((i,r)=>{if(i.initialHook)return n[t][r]=e,o=!0,!1})),o||n[t].push(e)}}return this}once(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?A(e,(e=>this.once(t,e,o))):(e.runOnce=!0,this.add(t,e,o))}remove(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=this.getBucket(o);return"undefined"!==typeof n[t]&&n[t].indexOf(e)>=0&&(e.skip=!0,!0)}has(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const o=this.getBucket(e);return!(void 0===o[t]||!o[t].length)}run(t,e,o,n,i,r,s,l){{const a=this.globalBucket[e],h=a?a.length:0;let c=0;if(h)while(c<h){if(!a[c]||a[c].skip){c+=1;continue}const h=mo(a[c],t,o,n,i,r,s,l);void 0!==h&&(o=h),a[c]&&a[c].runOnce&&this.remove(e,a[c]),c+=1}}{const a=this.getBucket(t)[e],h=a?a.length:0;let c=0;if(h)while(c<h){if(!a[c]||a[c].skip){c+=1;continue}const h=mo(a[c],t,o,n,i,r,s,l);void 0!==h&&(o=h),a[c]&&a[c].runOnce&&this.remove(e,a[c],t),c+=1}}return o}destroy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Mo(this.getBucket(t),((t,e,o)=>o[e].length=0))}register(t){this.isRegistered(t)||fn.push(t)}deregister(t){this.isRegistered(t)&&fn.splice(fn.indexOf(t),1)}isDeprecated(t){return wn.has(t)||pn.has(t)}isRegistered(t){return fn.indexOf(t)>=0}getRegistered(){return fn}}const Cn=new vn;function yn(){return Cn}var bn=vn;const Sn=new Map;function Rn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";Sn.has(t)||Sn.set(t,new Map);const e=Sn.get(t);function o(t,o){e.set(t,o)}function n(t){return e.get(t)}function i(t){return e.has(t)}function r(){return[...e.keys()]}function s(){return[...e.values()]}return{register:o,getItem:n,hasItem:i,getNames:r,getValues:s}}const En=new WeakMap,{register:Tn,getItem:Mn,hasItem:Hn,getNames:xn,getValues:kn}=Rn("editors");function In(t){const e={},o=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new o(t)),e[t.guid]},bn.getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function An(t,e){let o;if("function"===typeof t)En.get(t)||Pn(null,t),o=En.get(t);else{if("string"!==typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');o=Mn(t)}if(!o)throw Error(`No editor registered under name "${t}"`);return o.getInstance(e)}function On(t){if("function"===typeof t)return t;if(!Hn(t))throw Error(`No registered editor found under "${t}" name`);return Mn(t).getConstructor()}function Pn(t,e){t&&"string"!==typeof t&&(e=t,t=e.EDITOR_TYPE);const o=new In(e);"string"===typeof t&&Tn(t,o),En.set(e,o)}function Nn(t,e,o){return e=_n(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function _n(t){var e=Ln(t,"string");return"symbol"===typeof e?e:String(e)}function Ln(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}let Dn=0;class Wn{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Nn(this,"context",void 0),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(t){o.call(this,Vn(t))}return this.context.eventListeners.push({element:t,event:e,callback:o,callbackProxy:i,options:n,eventManager:this}),t.addEventListener(e,i,n),Dn+=1,()=>{this.removeEventListener(t,e,o)}}removeEventListener(t,e,o){let n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.context.eventListeners.length;while(r)if(r-=1,n=this.context.eventListeners[r],n.event===e&&n.element===t){if(o&&o!==n.callback)continue;if(i&&n.eventManager!==this)continue;this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),Dn-=1}}clearEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let e=this.context.eventListeners.length;while(e){e-=1;const o=this.context.eventListeners[e];t&&o.eventManager!==this||(this.context.eventListeners.splice(e,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),Dn-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(t,e){let o=t.document,n=t;o||(o=t.ownerDocument?t.ownerDocument:t,n=o.defaultView);const i={bubbles:!0,cancelable:"mousemove"!==e,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let r;o.createEvent?(r=o.createEvent("MouseEvents"),r.initMouseEvent(e,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||o.body.parentNode)):r=o.createEventObject(),t.dispatchEvent?t.dispatchEvent(r):t.fireEvent(`on${e}`,r)}}function Vn(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),nn(this)},t}var Fn=Wn;function jn(){return Dn}function Bn(t,e){zn(t,e),e.add(t)}function zn(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Un(t,e,o){return e=$n(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function $n(t){var e=Gn(t,"string");return"symbol"===typeof e?e:String(e)}function Gn(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Yn(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const Kn="editorManager.navigation";var Xn=new WeakSet,qn=new WeakSet;class Qn{constructor(t,e,o){Bn(this,qn),Bn(this,Xn),Un(this,"hot",void 0),Un(this,"tableMeta",void 0),Un(this,"selection",void 0),Un(this,"eventManager",void 0),Un(this,"destroyed",!1),Un(this,"lock",!1),Un(this,"activeEditor",void 0),Un(this,"cellProperties",void 0),this.hot=t,this.tableMeta=e,this.selection=o,this.eventManager=new Fn(t),this.hot.addHook("afterDocumentKeyDown",(t=>Yn(this,Xn,Jn).call(this,t))),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",(t=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",t)})),this.hot.view._wt.update("onCellDblClick",((t,e,o)=>Yn(this,qn,Zn).call(this,t,e,o)))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(t){this.lock||this.closeEditor(t)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(t=>{t&&this.prepareEditor()}));const{highlight:t}=this.hot.getSelectedRangeLast();if(t.isHeader())return;const{row:e,col:o}=t,n=this.hot.runHooks("modifyGetCellCoords",e,o);let i=e,r=o;if(Array.isArray(n)&&([i,r]=n),this.cellProperties=this.hot.getCellMeta(i,r),!this.isCellEditable())return void this.clearActiveEditor();const s=this.hot.getCell(e,o,!0);if(s){const t=this.hot.getCellEditor(this.cellProperties),n=this.hot.colToProp(r),l=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(i),r);this.activeEditor=An(t,this.hot),this.activeEditor.prepare(e,o,n,s,l,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isCellEditable()?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))):this.clearActiveEditor()}closeEditor(t,e,o){this.activeEditor?this.activeEditor.finishEditing(t,e,o):o&&o(!1)}closeEditorAndSaveChanges(t){this.closeEditor(!1,t)}closeEditorAndRestoreOriginalValue(t){this.closeEditor(!0,t)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const t=this.hot.getSelectedRangeLast();if(!t)return!1;const e=this.hot.getCellEditor(this.cellProperties),{row:o,col:n}=t.highlight,{rowIndexMapper:i,columnIndexMapper:r}=this.hot,s=i.isHidden(this.hot.toPhysicalRow(o))||r.isHidden(this.hot.toPhysicalColumn(n));return!(this.cellProperties.readOnly||!e||s)}moveSelectionAfterEnter(t){const e="function"===typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function Jn(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||rn(t))return;const{keyCode:o}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Zo(o)&&!en(o)&&!n&&!this.isEditorOpened()){const e=this.hot.getShortcutManager(),o=e.getContext("editor"),n={runOnlyIf:()=>U(this.hot.getSelected()),group:Kn};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],n),this.openEditor("",t)}}function Zn(t,e,o){"TD"===o.nodeName&&this.openEditor(null,t,!0)}const ti=new WeakMap;Qn.getInstance=function(t,e,o){let n=ti.get(t);return n||(n=new Qn(t,e,o),ti.set(t,n)),n};var ei=Qn;function oi(t,e){ii(t,e),e.add(t)}function ni(t,e,o){ii(t,e),e.set(t,o)}function ii(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ri(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function si(t,e){var o=hi(t,e,"get");return li(t,o)}function li(t,e){return e.get?e.get.call(t):e.value}function ai(t,e,o){var n=hi(t,e,"set");return ci(t,n,o),o}function hi(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function ci(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const ui=Object.freeze({CELL:"cell",MIXED:"mixed"});var di=new WeakMap,gi=new WeakMap,fi=new WeakMap,mi=new WeakMap,pi=new WeakSet,wi=new WeakSet,vi=new WeakSet,Ci=new WeakSet;class yi{constructor(t){var e=this;oi(this,Ci),oi(this,vi),oi(this,wi),oi(this,pi),ni(this,di,{writable:!0,value:void 0}),ni(this,gi,{writable:!0,value:void 0}),ni(this,fi,{writable:!0,value:50}),ni(this,mi,{writable:!0,value:null});const o=t.getSettings();ai(this,di,t),ai(this,gi,o.imeFastEdit?ui.MIXED:ui.CELL),si(this,di).addHook("afterUpdateSettings",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return ri(e,Ci,Ei).call(e,...o)})),si(this,di).addHook("afterSelection",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return ri(e,vi,Ri).call(e,...o)}))}getFocusMode(){return si(this,gi)}setFocusMode(t){Object.values(ui).includes(t)?ai(this,gi,t):hn(`"${t}" is not a valid focus mode.`)}getRefocusDelay(){return si(this,fi)}setRefocusDelay(t){ai(this,fi,t)}setRefocusElementGetter(t){ai(this,mi,t)}getRefocusElement(){return"function"===typeof si(this,mi)?si(this,mi).call(this):null===(t=si(this,di).getActiveEditor())||void 0===t?void 0:t.TEXTAREA;var t}focusOnHighlightedCell(t){var e;const o=ri(this,pi,bi).call(this),n=t||ri(this,wi,Si).call(this);let i=si(this,di).runHooks("modifyFocusedElement",o.row,o.col,n);i instanceof HTMLElement||(i=n),!i||null!==(e=si(this,di).getActiveEditor())&&void 0!==e&&e.isOpened()||i.focus({preventScroll:!0})}refocusToEditorTextarea(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:si(this,fi);const e=this.getRefocusElement();si(this,di).getSettings().imeFastEdit&&e&&si(this,di)._registerTimeout((()=>{e.select()}),t)}}function bi(){const t=si(this,di).getSelectedRangeLast();return t.highlight}function Si(){const t=ri(this,pi,bi).call(this);return si(this,di).getCell(t.row,t.col,!0)}function Ri(){const t=ri(this,wi,Si).call(this),{activeElement:e}=si(this,di).rootDocument;e&&Je(e)&&e.blur(),this.focusOnHighlightedCell(t),this.getFocusMode()===ui.MIXED&&"TD"===t.nodeName&&si(this,di).addHookOnce("afterSelectionEnd",(()=>{this.refocusToEditorTextarea()}))}function Ei(t){t.imeFastEdit&&this.getFocusMode()!==ui.MIXED?this.setFocusMode(ui.MIXED):t.imeFastEdit||this.getFocusMode()===ui.CELL||this.setFocusMode(ui.CELL)}const Ti={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Mi=new RegExp(Object.keys(Ti).map((t=>`(${t})`)).join("|"),"gi");function Hi(t){return"TABLE"===(t&&t.nodeName||"")}function xi(t){const e=t.hasColHeaders(),o=t.hasRowHeaders(),n=[e?-1:0,o?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),r=i.length,s=r>0?i[0].length:0,l=["<table>","</table>"],a=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],c=o?1:0,u=e?1:0;for(let d=0;d<r;d+=1){const n=e&&0===d,r=[];for(let e=0;e<s;e+=1){const s=!n&&o&&0===e;let l="";if(n)l=`<th>${t.getColHeader(e-c)}</th>`;else if(s)l=`<th>${t.getRowHeader(d-u)}</th>`;else{const o=i[d][e],{hidden:n,rowspan:r,colspan:s}=t.getCellMeta(d-u,e-c);if(!n){const t=[];if(r&&t.push(`rowspan="${r}"`),s&&t.push(`colspan="${s}"`),G(o))l=`<td ${t.join(" ")}></td>`;else{const e=o.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l=`<td ${t.join(" ")}>${e}</td>`}}}r.push(l)}const l=["<tr>",...r,"</tr>"].join("");n?a.splice(1,0,l):h.splice(-1,0,l)}return l.splice(1,0,a.join(""),h.join("")),l.join("")}function ki(t){const e=t.length,o=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],r=i.length,s=[];0===n&&o.push("<tbody>");for(let t=0;t<r;t+=1){const e=i[t],o=G(e)?"":e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`)).replace(/\t/gi,"&#9;");s.push(`<td>${o}</td>`)}o.push("<tr>",...s,"</tr>"),n+1===e&&o.push("</tbody>")}return o.push("</table>"),o.join("")}function Ii(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const o={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let r=t;if("string"===typeof r){const t=r.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(t=>{const e=t.match(/<td\b[^>]*?>/g)[0],o=t.substring(e.length,t.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),n="</td>";return`${e}${o}${n}`}));i.insertAdjacentHTML("afterbegin",`${t}`),r=i.querySelector("table")}if(!r||!Hi(r))return;const s=i.querySelector('meta[name$="enerator"]'),l=null!==r.querySelector("tbody th"),a=r.querySelector("tr"),h=a?Array.from(a.cells).reduce(((t,e)=>t+e.colSpan),0)-(l?1:0):0,c=r.tFoot&&Array.from(r.tFoot.rows)||[],u=[];let d=!1,g=0,f=0;if(r.tHead){const t=Array.from(r.tHead.rows).filter((t=>{const e=null!==t.querySelector("td");return e&&u.push(t),!e}));g=t.length,d=g>0,g>1?o.nestedHeaders=Array.from(t).reduce(((t,e)=>{const o=Array.from(e.cells).reduce(((t,e,o)=>{if(l&&0===o)return t;const{colSpan:n,innerHTML:i}=e,r=n>1?{label:i,colspan:n}:i;return t.push(r),t}),[]);return t.push(o),t}),[]):d&&(o.colHeaders=Array.from(t[0].children).reduce(((t,e,o)=>(l&&0===o||t.push(e.innerHTML),t)),[]))}u.length&&(o.fixedRowsTop=u.length),c.length&&(o.fixedRowsBottom=c.length);const m=[...u,...Array.from(r.tBodies).reduce(((t,e)=>(t.push(...Array.from(e.rows)),t)),[]),...c];f=m.length;const p=new Array(f);for(let C=0;C<f;C++)p[C]=new Array(h);const w=[],v=[];for(let C=0;C<f;C++){const t=m[C],e=Array.from(t.cells),o=e.length;for(let n=0;n<o;n++){const t=e[n],{nodeName:o,innerHTML:i,rowSpan:r,colSpan:l}=t,a=p[C].findIndex((t=>void 0===t));if("TD"===o){if(r>1||l>1){for(let t=C;t<C+r;t++)if(t<f)for(let e=a;e<a+l;e++)p[t][e]=null;const e=t.getAttribute("style"),o=e&&e.includes("mso-ignore:colspan");o||w.push({col:a,row:C,rowspan:r,colspan:l})}let e="";e=s&&/excel/gi.test(s.content)?i.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):i.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),p[C][a]=e.replace(Mi,(t=>Ti[t]))}else v.push(i)}}return w.length&&(o.mergeCells=w),v.length&&(o.rowHeaders=v),p.length&&(o.data=p),o}function Ai(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=typeof t;if("number"===o)return!isNaN(t)&&isFinite(t);if("string"===o){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);const o=Array.from(new Set([".",...e])).map((t=>`\\${t}`)).join("|");return new RegExp(`^[+-]?\\s*(((${o})?\\d+((${o})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}return"object"===o&&(!!t&&"number"===typeof t.valueOf()&&!(t instanceof Date))}function Oi(t){return Ai(t,[","])}function Pi(t,e,o){let n=-1;"function"===typeof e?(o=e,e=t):n=t-1;while(++n<=e)if(!1===o(n))break}function Ni(t,e,o){let n=t+1;"function"===typeof e&&(o=e,e=0);while(--n>=e)if(!1===o(n))break}function _i(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Li(t,e,o){return Math.min(t,e)===t?e:Math.max(t,o)===t?o:t}const Di="asc",Wi="desc",Vi=new Map([[Di,[-1,1]],[Wi,[1,-1]]]),Fi=t=>`The priority '${t}' is already declared in a map.`,ji=t=>`The priority '${t}' is not a number.`;function Bi(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=new Map;function n(n,i){if(!Ai(n))throw new Error(e(n));if(o.has(n))throw new Error(t(n));o.set(n,i)}function i(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Di;const[e,n]=Vi.get(t)||Vi.get(Di);return[...o].sort(((t,o)=>t[0]<o[0]?e:n)).map((t=>t[1]))}return t=so(t)?t:Fi,e=so(e)?e:ji,{addItem:n,getItems:i}}const zi=t=>`The id '${t}' is already declared in a map.`;function Ui(){let{errorIdExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Map;function o(o,n){if(a(o))throw new Error(t(o));e.set(o,n)}function n(t){return e.delete(t)}function i(){e.clear()}function r(t){const[e]=l().find((e=>{let[o,n]=e;return t===n&&o}))||[null];return e}function s(t){return e.get(t)}function l(){return[...e]}function a(t){return e.has(t)}return t=so(t)?t:zi,{addItem:o,clear:i,getId:r,getItem:s,getItems:l,hasItem:a,removeItem:n}}const $i=t=>`'${t}' value is already declared in a unique set.`;function Gi(){let{errorItemExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Set;function o(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return t=so(t)?t:$i,{addItem:o,clear:i,getItems:n}}const Yi=t=>`There is already registered "${t}" plugin.`,Ki=t=>`There is already registered plugin on priority "${t}".`,Xi=t=>`The priority "${t}" is not a number.`,qi=Bi({errorPriorityExists:Ki,errorPriorityNaN:Xi}),Qi=Gi({errorItemExists:Yi}),Ji=Ui({errorIdExists:Yi});function Zi(){return[...qi.getItems(),...Qi.getItems()]}function tr(t){const e=lt(t);return Ji.getItem(e)}function er(t){return!!tr(t)}function or(t,e,o){[t,e,o]=ir(t,e,o),void 0===tr(t)&&nr(t,e,o)}function nr(t,e,o){const n=lt(t);if(Ji.hasItem(n))throw new Error(Yi(n));void 0===o?Qi.addItem(n):qi.addItem(o,n),Ji.addItem(n,e)}function ir(t,e,o){return"function"===typeof t&&(e=t,t=e.PLUGIN_KEY,o=e.PLUGIN_PRIORITY),[t,e,o]}const{register:rr,getItem:sr,hasItem:lr,getNames:ar,getValues:hr}=Rn("renderers");function cr(t){if("function"===typeof t)return t;if(!lr(t))throw Error(`No registered renderer found under "${t}" name`);return sr(t)}function ur(t,e){"string"!==typeof t&&(e=t,t=e.RENDERER_TYPE),rr(t,e)}const{register:dr,getItem:gr,hasItem:fr,getNames:mr,getValues:pr}=Rn("validators");function wr(t){if("function"===typeof t)return t;if(!fr(t))throw Error(`No registered validator found under "${t}" name`);return gr(t)}function vr(t,e){"string"!==typeof t&&(e=t,t=e.VALIDATOR_TYPE),dr(t,e)}function Cr(t){return window.requestAnimationFrame(t)}function yr(t){window.cancelAnimationFrame(t)}function br(){return"ontouchstart"in window}let Sr;function Rr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Sr||(Sr="object"===typeof Intl?new Intl.Collator(t,e).compare:"function"===typeof String.prototype.localeCompare?(t,e)=>`${t}`.localeCompare(e):(t,e)=>t===e?0:t>e?-1:1,Sr)}function Er(t,e,o){Tr(t,e),e.set(t,o)}function Tr(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mr(t,e){var o=kr(t,e,"get");return Hr(t,o)}function Hr(t,e){return e.get?e.get.call(t):e.value}function xr(t,e,o){var n=kr(t,e,"set");return Ir(t,n,o),o}function kr(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Ir(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var Ar=new WeakMap,Or=new WeakMap,Pr=new WeakMap,Nr=new WeakMap,_r=new WeakMap,Lr=new WeakMap,Dr=new WeakMap,Wr=new WeakMap,Vr=new WeakMap,Fr=new WeakMap;class jr{constructor(t,e,o,n,i,r){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Er(this,Ar,{writable:!0,value:void 0}),Er(this,Or,{writable:!0,value:void 0}),Er(this,Pr,{writable:!0,value:void 0}),Er(this,Nr,{writable:!0,value:void 0}),Er(this,_r,{writable:!0,value:void 0}),Er(this,Lr,{writable:!0,value:void 0}),Er(this,Dr,{writable:!0,value:void 0}),Er(this,Wr,{writable:!0,value:void 0}),Er(this,Vr,{writable:!0,value:[null,null]}),Er(this,Fr,{writable:!0,value:[null,null]}),xr(this,Ar,o),xr(this,Or,e),xr(this,Pr,i),xr(this,Nr,r),xr(this,_r,s),xr(this,Lr,n),xr(this,Dr,t),this.registerEvents()}registerEvents(){Mr(this,Lr).addEventListener(Mr(this,Pr).holder,"contextmenu",(t=>this.onContextMenu(t))),Mr(this,Lr).addEventListener(Mr(this,Pr).TABLE,"mouseover",(t=>this.onMouseOver(t))),Mr(this,Lr).addEventListener(Mr(this,Pr).TABLE,"mouseout",(t=>this.onMouseOut(t)));const t=()=>{Mr(this,Lr).addEventListener(Mr(this,Pr).holder,"touchstart",(t=>this.onTouchStart(t))),Mr(this,Lr).addEventListener(Mr(this,Pr).holder,"touchend",(t=>this.onTouchEnd(t))),this.momentumScrolling||(this.momentumScrolling={}),Mr(this,Lr).addEventListener(Mr(this,Pr).holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Mr(this,Ar).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Mr(this,Ar).getSetting("onAfterMomentumScroll"))}),200)}))},e=()=>{Mr(this,Lr).addEventListener(Mr(this,Pr).holder,"mouseup",(t=>this.onMouseUp(t))),Mr(this,Lr).addEventListener(Mr(this,Pr).holder,"mousedown",(t=>this.onMouseDown(t)))};Uo()?t():(br()&&t(),e())}selectedCellWasTouched(t){const e=this.parentCell(t),o=e.coords;if(Mr(this,Wr)&&o){const[t,e]=[o.row,Mr(this,Wr).from.row],[n,i]=[o.col,Mr(this,Wr).from.col];return t===e&&n===i}return!1}parentCell(t){const e={},o=Mr(this,Pr).TABLE,n=re(t,["TD","TH"],o);return n?(e.coords=Mr(this,Pr).getCoords(n),e.TD=n):ue(t,"wtBorder")&&ue(t,"current")?(e.coords=Mr(this,Nr).getFocusSelection().cellRange.highlight,e.TD=Mr(this,Pr).getCell(e.coords)):ue(t,"wtBorder")&&ue(t,"area")&&Mr(this,Nr).getAreaSelection().cellRange&&(e.coords=Mr(this,Nr).getAreaSelection().cellRange.to,e.TD=Mr(this,Pr).getCell(e.coords)),e}onMouseDown(t){const e=Mr(this,Or).rootDocument.activeElement,o=uo(Zt,t.target),n=t.target;if(!["TD","TH"].includes(e.nodeName)&&(n===e||o(0)===e||o(1)===e))return;const i=this.parentCell(n);ue(n,"corner")?Mr(this,Ar).getSetting("onCellCornerMouseDown",t,n):i.TD&&Mr(this,Ar).has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,i.coords,i.TD),(0===t.button||this.touchApplied)&&i.TD&&(Mr(this,Fr)[0]=i.TD,clearTimeout(Mr(this,Vr)[0]),Mr(this,Vr)[0]=setTimeout((()=>{Mr(this,Fr)[0]=null}),1e3))}onContextMenu(t){if(Mr(this,Ar).has("onCellContextMenu")){const e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}onMouseOver(t){if(!Mr(this,Ar).has("onCellMouseOver"))return;const e=Mr(this,Pr).TABLE,o=re(t.target,["TD","TH"],e),n=Mr(this,_r)||this;o&&o!==n.lastMouseOver&&se(o,e)&&(n.lastMouseOver=o,this.callListener("onCellMouseOver",t,Mr(this,Pr).getCoords(o),o))}onMouseOut(t){if(!Mr(this,Ar).has("onCellMouseOut"))return;const e=Mr(this,Pr).TABLE,o=re(t.target,["TD","TH"],e),n=re(t.relatedTarget,["TD","TH"],e),i=Mr(this,_r)||this;o&&o!==n&&se(o,e)&&(this.callListener("onCellMouseOut",t,Mr(this,Pr).getCoords(o),o),null===n&&(i.lastMouseOver=null))}onMouseUp(t){const e=this.parentCell(t.target);e.TD&&Mr(this,Ar).has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,e.coords,e.TD),(0===t.button||this.touchApplied)&&(e.TD===Mr(this,Fr)[0]&&e.TD===Mr(this,Fr)[1]?(ue(t.target,"corner")?this.callListener("onCellCornerDblClick",t,e.coords,e.TD):this.callListener("onCellDblClick",t,e.coords,e.TD),Mr(this,Fr)[0]=null,Mr(this,Fr)[1]=null):e.TD===Mr(this,Fr)[0]&&(Mr(this,Fr)[1]=e.TD,clearTimeout(Mr(this,Vr)[1]),Mr(this,Vr)[1]=setTimeout((()=>{Mr(this,Fr)[1]=null}),500)))}onTouchStart(t){xr(this,Wr,Mr(this,Nr).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(t)}onTouchEnd(t){var e;const o=t.target,n=null===(e=this.parentCell(o))||void 0===e?void 0:e.coords,i=U(n)&&n.row>=0&&n.col>=0,r=t.cancelable&&i&&Mr(this,Ar).getSetting("isDataViewInstance");if(r){const e=["A","BUTTON","INPUT"];$o()&&(Wo()||Fo())&&this.selectedCellWasTouched(o)&&!e.includes(o.tagName)?t.preventDefault():this.selectedCellWasTouched(o)||t.preventDefault()}this.onMouseUp(t),this.touchApplied=!1}callListener(t,e,o,n){const i=Mr(this,Ar).getSettingPure(t);i&&i(e,o,n,Mr(this,Dr).call(this))}destroy(){clearTimeout(Mr(this,Vr)[0]),clearTimeout(Mr(this,Vr)[1]),Mr(this,Lr).destroy()}}var Br=jr;function zr(t,e,o){return e=Ur(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ur(t){var e=$r(t,"string");return"symbol"===typeof e?e:String(e)}function $r(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Gr{constructor(t,e,o){zr(this,"offset",void 0),zr(this,"total",void 0),zr(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=o}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleRowHeadedColumnToSourceColumn(t){return this.renderedToSource(this.offsettedTH(t))}sourceColumnToVisibleRowHeadedColumn(t){return this.unOffsettedTH(this.sourceToRendered(t))}}var Yr=Gr;function Kr(t,e,o){return e=Xr(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Xr(t){var e=qr(t,"string");return"symbol"===typeof e?e:String(e)}function qr(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Qr{constructor(t,e,o){Kr(this,"offset",void 0),Kr(this,"total",void 0),Kr(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=o}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleColHeadedRowToSourceRow(t){return this.renderedToSource(this.offsettedTH(t))}sourceRowToVisibleColHeadedRow(t){return this.unOffsettedTH(this.sourceToRendered(t))}}var Jr=Qr;const Zr=0,ts=1,es=2;function os(t,e,o){return e=ns(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ns(t){var e=is(t,"string");return"symbol"===typeof e?e:String(e)}function is(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class rs{constructor(){os(this,"currentSize",0),os(this,"nextSize",0),os(this,"currentOffset",0),os(this,"nextOffset",0)}setSize(t){this.currentSize=this.nextSize,this.nextSize=t}setOffset(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}function ss(t,e,o){return e=ls(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ls(t){var e=as(t,"string");return"symbol"===typeof e?e:String(e)}function as(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class hs{constructor(){ss(this,"size",new rs),ss(this,"workingSpace",Zr),ss(this,"sharedSize",null)}setSize(t){this.size.setSize(t)}setOffset(t){this.size.setOffset(t)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof rs}isPlaceOn(t){return this.workingSpace===t}append(t){this.workingSpace=ts,t.workingSpace=es,this.sharedSize=t.getViewSize()}prepend(t){this.workingSpace=es,t.workingSpace=ts,this.sharedSize=t.getViewSize()}}function cs(t,e,o){return e=us(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function us(t){var e=ds(t,"string");return"symbol"===typeof e?e:String(e)}function ds(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class gs{constructor(t,e,o){cs(this,"rootNode",void 0),cs(this,"nodesPool",void 0),cs(this,"sizeSet",new hs),cs(this,"childNodeType",void 0),cs(this,"visualIndex",0),cs(this,"collectedNodes",[]),this.rootNode=t,this.nodesPool=e,this.childNodeType=o.toUpperCase()}setSize(t){return this.sizeSet.setSize(t),this}setOffset(t){return this.sizeSet.setOffset(t),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}getCurrentNode(){const t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}getRenderedChildCount(){const{rootNode:t,sizeSet:e}=this;let o=0;if(this.isSharedViewSet()){let n=t.firstElementChild;while(n){if(n.tagName===this.childNodeType)o+=1;else if(e.isPlaceOn(ts))break;n=n.nextElementSibling}}else o=t.childElementCount;return o}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:t,sizeSet:e}=this,o=this.isSharedViewSet(),{nextSize:n}=e.getViewSize();let i=this.getRenderedChildCount();while(i<n){const n=this.nodesPool();!o||o&&e.isPlaceOn(es)?t.appendChild(n):t.insertBefore(n,t.firstChild),i+=1}const r=o&&e.isPlaceOn(ts);while(i>n)t.removeChild(r?t.firstChild:t.lastChild),i-=1}render(){const{rootNode:t,sizeSet:e}=this;let o=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(es)&&(o+=e.sharedSize.nextSize);let n=t.childNodes[o];if(n.tagName!==this.childNodeType){const e=this.nodesPool();t.replaceChild(e,n),n=e}this.collectedNodes.push(n),this.visualIndex+=1}end(){}}class fs extends gs{prependView(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}appendView(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}function ms(t,e,o){return e=ps(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ps(t){var e=ws(t,"string");return"symbol"===typeof e?e:String(e)}function ws(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class vs{constructor(t){ms(this,"nodeType",void 0),this.nodeType=t.toUpperCase()}setRootDocument(t){this.rootDocument=t}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Cs(t,e,o){return e=ys(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ys(t){var e=bs(t,"string");return"symbol"===typeof e?e:String(e)}function bs(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ss{constructor(t,e){Cs(this,"nodesPool",null),Cs(this,"nodeType",void 0),Cs(this,"rootNode",void 0),Cs(this,"table",null),Cs(this,"renderedNodes",0),this.nodesPool="string"===typeof t?new vs(t):null,this.nodeType=t,this.rootNode=e}setTable(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}adjust(){}render(){}}function Rs(t,e,o){return e=Es(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Es(t){var e=Ts(t,"string");return"symbol"===typeof e?e:String(e)}function Ts(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ms extends Ss{constructor(){super("TH"),Rs(this,"orderViews",new WeakMap),Rs(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new fs(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,rowHeaderFunctions:e,rowHeadersCount:o,rows:n,cells:i}=this.table;for(let r=0;r<t;r++){const t=this.table.renderedRowToSource(r),s=n.getRenderedNode(r);this.sourceRowIndex=t;const l=this.obtainOrderView(s),a=i.obtainOrderView(s);l.appendView(a).setSize(o).setOffset(this.table.renderedColumnToSource(0)).start();for(let n=0;n<o;n++){l.render();const o=l.getCurrentNode();o.className="",o.removeAttribute("style"),me(o,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&fe(o,[vt(),xt(),Vt(n+1),ft(-1)]),e[n](t,o,n)}l.end()}}}class Hs extends Ss{constructor(t){super(null,t)}adjust(){const{columnHeadersCount:t,rowHeadersCount:e}=this.table;let o=this.rootNode.firstChild;if(t){const{columnsToRender:n}=this.table,i=n+e;for(let e=0,s=t;e<s;e++){o=this.rootNode.childNodes[e],o||(o=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(o)),this.renderedNodes=o.childNodes.length;while(this.renderedNodes<i)o.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;while(this.renderedNodes>i)o.removeChild(o.lastChild),this.renderedNodes-=1}const r=this.rootNode.childNodes.length;if(r>t)for(let e=t;e<r;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else o&&we(o)}render(){const{columnHeadersCount:t}=this.table;this.table.isAriaEnabled()&&fe(this.rootNode,[pt()]);for(let e=0;e<t;e+=1){const{columnHeaderFunctions:t,columnsToRender:o,rowHeadersCount:n}=this.table,i=this.rootNode.childNodes[e];this.table.isAriaEnabled()&&fe(i,[yt(),Wt(e+1)]);for(let r=-1*n;r<o;r+=1){const o=this.table.renderedColumnToSource(r),s=i.childNodes[r+n];s.className="",s.removeAttribute("style"),me(s,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&fe(s,[Vt(r+1+this.table.rowHeadersCount),ft(-1),...r<0?[pt()]:[Ct(),Ht()]]),t[e](o,s,e)}}}}class xs extends Ss{constructor(t){super(null,t)}adjust(){const{columnsToRender:t,rowHeadersCount:e}=this.table,o=t+e;while(this.renderedNodes<o)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;while(this.renderedNodes>o)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:t,rowHeadersCount:e}=this.table;for(let n=0;n<e;n++){const t=this.table.renderedColumnToSource(n),e=this.table.columnUtils.getHeaderWidth(t);this.rootNode.childNodes[n].style.width=`${e}px`}for(let n=0;n<t;n++){const t=this.table.renderedColumnToSource(n),o=this.table.columnUtils.getStretchedColumnWidth(t);this.rootNode.childNodes[n+e].style.width=`${o}px`}const o=this.rootNode.firstChild;o&&de(o,"rowHeader")}}function ks(t,e,o){return e=Is(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Is(t){var e=As(t,"string");return"symbol"===typeof e?e:String(e)}function As(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}let Os=!1;class Ps extends Ss{constructor(t){super("TR",t),ks(this,"orderView",void 0),this.orderView=new gs(t,(t=>this.nodesPool.obtain(t)),this.nodeType)}getRenderedNode(t){return this.orderView.getNode(t)}render(){const{rowsToRender:t}=this.table;!Os&&t>1e3&&(Os=!0,hn(B`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&fe(this.rootNode,[pt()]),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let n=0;n<t;n++){this.orderView.render();const t=this.orderView.getCurrentNode(),i=this.table.renderedRowToSource(n);var e,o;if(this.table.isAriaEnabled())fe(t,[yt(),Wt(i+(null!==(e=null===(o=this.table.rowUtils)||void 0===o||null===(o=o.dataAccessObject)||void 0===o?void 0:o.columnHeaders.length)&&void 0!==e?e:0)+1)])}this.orderView.end()}}function Ns(t,e,o){return e=_s(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function _s(t){var e=Ls(t,"string");return"symbol"===typeof e?e:String(e)}function Ls(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ds extends Ss{constructor(){super("TD"),Ns(this,"orderViews",new WeakMap),Ns(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new fs(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,columnsToRender:e,rows:o,rowHeaders:n}=this.table;for(let s=0;s<t;s++){const t=this.table.renderedRowToSource(s),l=o.getRenderedNode(s);this.sourceRowIndex=t;const a=this.obtainOrderView(l),h=n.obtainOrderView(l);a.prependView(h).setSize(e).setOffset(this.table.renderedColumnToSource(0)).start();for(let o=0;o<e;o++){a.render();const e=a.getCurrentNode(),n=this.table.renderedColumnToSource(o);var i,r;if(ue(e,"hide")||(e.className=""),e.removeAttribute("style"),e.removeAttribute("dir"),me(e,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(t,n,e),this.table.isAriaEnabled())fe(e,[...e.hasAttribute("role")?[]:[wt()],ft(-1),Vt(n+(null!==(i=null===(r=this.table.rowUtils)||void 0===r||null===(r=r.dataAccessObject)||void 0===r?void 0:r.rowHeaders.length)&&void 0!==i?i:0)+1)])}a.end()}}}function Ws(t,e,o){return e=Vs(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Vs(t){var e=Fs(t,"string");return"symbol"===typeof e?e:String(e)}function Fs(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class js{constructor(t){let{cellRenderer:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ws(this,"rootNode",void 0),Ws(this,"rootDocument",void 0),Ws(this,"rowHeaders",null),Ws(this,"columnHeaders",null),Ws(this,"colGroup",null),Ws(this,"rows",null),Ws(this,"cells",null),Ws(this,"rowFilter",null),Ws(this,"columnFilter",null),Ws(this,"rowUtils",null),Ws(this,"columnUtils",null),Ws(this,"rowsToRender",0),Ws(this,"columnsToRender",0),Ws(this,"rowHeaderFunctions",[]),Ws(this,"rowHeadersCount",0),Ws(this,"columnHeaderFunctions",[]),Ws(this,"columnHeadersCount",0),Ws(this,"cellRenderer",void 0),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=e}setAxisUtils(t,e){this.rowUtils=t,this.columnUtils=e}setViewportSize(t,e){this.rowsToRender=t,this.columnsToRender=e}setFilters(t,e){this.rowFilter=t,this.columnFilter=e}setHeaderContentRenderers(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}setRenderers(){let{rowHeaders:t,columnHeaders:e,colGroup:o,rows:n,cells:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setTable(this),e.setTable(this),o.setTable(this),n.setTable(this),i.setTable(this),this.rowHeaders=t,this.columnHeaders=e,this.colGroup=o,this.rows=n,this.cells=i}renderedRowToSource(t){return this.rowFilter.renderedToSource(t)}renderedColumnToSource(t){return this.columnFilter.renderedToSource(t)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:t,rows:e}=this;for(let o=0;o<t;o++){const t=e.getRenderedNode(o);if(t.firstChild){const e=this.renderedRowToSource(o),n=this.rowUtils.getHeight(e);t.firstChild.style.height=n?n-1+"px":""}}}}class Bs{constructor(){let{TABLE:t,THEAD:e,COLGROUP:o,TBODY:n,rowUtils:i,columnUtils:r,cellRenderer:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new js(t,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new Ms,columnHeaders:new Hs(e),colGroup:new xs(o),rows:new Ps(n),cells:new Ds}),this.renderer.setAxisUtils(i,r)}setFilters(t,e){return this.renderer.setFilters(t,e),this}setViewportSize(t,e){return this.renderer.setViewportSize(t,e),this}setHeaderContentRenderers(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function zs(t,e,o){return e=Us(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Us(t){var e=$s(t,"string");return"symbol"===typeof e?e:String(e)}function $s(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Gs{constructor(t,e){zs(this,"dataAccessObject",void 0),zs(this,"wtSettings",void 0),zs(this,"headerWidths",new Map),this.dataAccessObject=t,this.wtSettings=e}getWidth(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(t){const e=this.dataAccessObject.wtViewport.columnsRenderCalculator;let o=this.getWidth(t);if(e){const n=e.getStretchedColumnWidth(t,o);n&&(o=n)}return o}getHeaderHeight(t){let e=this.wtSettings.getSetting("defaultRowHeight");const o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==o&&(e=e?Math.max(e,o):o),e}getHeaderWidth(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}calculateWidths(){const{wtSettings:t}=this,{wtTable:e,wtViewport:o,cloneSource:n}=this.dataAccessObject,i=n?n.wtTable.holder:e.holder,r=i.offsetHeight<i.scrollHeight?$e():0;let s=t.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-r),s=t.getSetting("onModifyRowHeaderWidth",s),null!==s&&void 0!==s){const e=t.getSetting("rowHeaders").length,o=t.getSetting("defaultColumnWidth");for(let t=0;t<e;t++){let e=Array.isArray(s)?s[t]:s;e=null===e||void 0===e?o:e,this.headerWidths.set(t,e)}}}}function Ys(t,e,o){return e=Ks(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ks(t){var e=Xs(t,"string");return"symbol"===typeof e?e:String(e)}function Xs(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class qs{constructor(t,e){Ys(this,"dataAccessObject",void 0),Ys(this,"wtSettings",void 0),this.dataAccessObject=t,this.wtSettings=e}getHeight(t){let e=this.wtSettings.getSetting("rowHeight",t);const o=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==o&&(e=void 0===e?o:Math.max(e,o)),e}}const Qs="top",Js="bottom",Zs="inline_start",tl="top_inline_start_corner",el="bottom_inline_start_corner",ol=[Qs,Js,Zs,tl,el],nl=new Map([[Qs,`ht_clone_${Qs}`],[Js,`ht_clone_${Js}`],[Zs,`ht_clone_${Zs} ht_clone_left`],[tl,`ht_clone_${tl} ht_clone_top_left_corner`],[el,`ht_clone_${el} ht_clone_bottom_left_corner`]]);function il(t,e,o){return e=rl(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function rl(t){var e=sl(t,"string");return"symbol"===typeof e?e:String(e)}function sl(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ll{constructor(t,e,o,n,i){il(this,"wtSettings",null),il(this,"domBindings",void 0),il(this,"TBODY",null),il(this,"THEAD",null),il(this,"COLGROUP",null),il(this,"hasTableHeight",!0),il(this,"hasTableWidth",!0),il(this,"isTableVisible",!1),il(this,"tableOffset",0),il(this,"holderOffset",0),this.domBindings=o,this.isMaster="master"===i,this.name=i,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=o.rootTable,pe(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const r=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(r))),this.rowUtils=new qs(this.dataAccessObject,this.wtSettings),this.columnUtils=new Gs(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Bs({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(t){return this.name===t}fixTableDomTree(){const t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&ue(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",e&&e.insertBefore(o,t),o.appendChild(t)),o.style.position="relative",this.wtSettings.getSetting("ariaTags")&&fe(o,[pt()]),o}createHider(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&ue(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",e&&e.insertBefore(o,t),o.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&fe(o,[pt()]),o}createHolder(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&ue(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",e&&e.insertBefore(o,t),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&fe(o.parentNode,[pt()])),o.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&fe(o,[pt()]),o}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this,{wtOverlays:o,wtViewport:n}=this.dataAccessObject,i=e.getSetting("totalRows"),r=e.getSetting("totalColumns"),s=e.getSetting("rowHeaders"),l=s.length,a=e.getSetting("columnHeaders"),h=a.length;let c=!1,u=t;if(this.isMaster&&(this.holderOffset=Se(this.holder),u=n.createRenderCalculators(u),l&&!e.getSetting("fixedColumnsStart"))){const t=o.inlineStartOverlay.getScrollPosition(),e=this.correctHeaderWidth;this.correctHeaderWidth=0!==t,e!==this.correctHeaderWidth&&(u=!1)}if(this.isMaster&&(c=o.updateStateOfRendering()),u)this.isMaster&&n.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=Se(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const t=i>0?this.getFirstRenderedRow():0,e=r>0?this.getFirstRenderedColumn():0;this.rowFilter=new Jr(t,i,h),this.columnFilter=new Yr(e,r,l);let o=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const t={};this.wtSettings.getSetting("beforeDraw",!0,t),o=!0!==t.skipRender}if(o){let t;if(this.tableRenderer.setHeaderContentRenderers(s,a),(this.is(Js)||this.is(el))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(t=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Js))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const e=Oe(this.hider),o=Oe(this.TABLE);0!==e&&o!==e&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),t!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Js)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(d=o.bottomOverlay.resetFixedPosition()||d),d=o.inlineStartOverlay.resetFixedPosition()||d,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(o.refreshAll(),o.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(u),c&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(t){const e=this.columnFilter.renderedToSource(t);let o=this.wtSettings.getSetting("columnHeaders").length;const n=this.wtSettings.getSetting("defaultRowHeight");let i,r,s;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];while(o)o-=1,i=this.getColumnHeaderHeight(o),r=this.getColumnHeader(e,o),r&&(s=Ne(r),(!i&&n<s||i<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=s),Array.isArray(l)?null!==l[o]&&void 0!==l[o]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l[o]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(l[o]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l[o]||l))}adjustColumnHeaderHeights(){const{wtSettings:t}=this,e=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,n=t.getSetting("columnHeaders");for(let i=0,r=n.length;i<r;i++)if(o[i]){if(!e[i]||0===e[i].childNodes.length)return;e[i].childNodes[0].style.height=`${o[i]}px`}}resetOversizedRows(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject;if((this.isMaster||this.is(Js))&&!t.getSetting("externalRowCalculator")){const t=this.getRenderedRowsCount();for(let o=0;o<t;o++){const t=this.rowFilter.renderedToSource(o);e.oversizedRows&&e.oversizedRows[t]&&(e.oversizedRows[t]=void 0)}}}getCell(t){let e=t.row,o=t.col;const n=this.wtSettings.getSetting("onModifyGetCellCoords",e,o);if(n&&Array.isArray(n)&&([e,o]=n),this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;const i=this.getRow(e);if(!i&&e>=0)throw new Error("TR was expected to be rendered but is not");const r=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!r&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return r}getRow(t){let e=null,o=null;var n,i;t<0?(e=null===(n=this.rowFilter)||void 0===n?void 0:n.sourceRowToVisibleColHeadedRow(t),o=this.THEAD):(e=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(t),o=this.TBODY);return void 0!==e&&void 0!==o&&(!(o.childNodes.length<e+1)&&o.childNodes[e])}getColumnHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const o=this.THEAD.childNodes[e];return null===o||void 0===o?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}getColumnHeaders(t){const e=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach((t=>{const n=t.childNodes[o];n&&e.push(n)})),e}getRowHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const o=this.wtSettings.getSetting("rowHeaders").length;if(e>=o)return;const n=this.rowFilter.sourceToRendered(t),i=n<0?this.rowFilter.sourceRowToVisibleColHeadedRow(t):n,r=n<0?this.THEAD:this.TBODY,s=r.childNodes[i];return null===s||void 0===s?void 0:s.childNodes[e]}getRowHeaders(t){const e=[],o=this.wtSettings.getSetting("rowHeaders").length;for(let n=0;n<o;n++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],i=null===o||void 0===o?void 0:o.childNodes[n];i&&e.push(i)}return e}getCoords(t){let e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=ie(e,["TD","TH"])),null===e)return null;const o=e.parentNode,n=o.parentNode;let i=le(o),r=e.cellIndex;if(ae(tl,e,this.wtRootElement)||ae(Qs,e,this.wtRootElement))"THEAD"===n.nodeName&&(i-=n.childNodes.length);else if(ae(el,e,this.wtRootElement)||ae(Js,e,this.wtRootElement)){const t=this.wtSettings.getSetting("totalRows");i=t-n.childNodes.length+i}else i=n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i);return r=ae(tl,e,this.wtRootElement)||ae(Zs,e,this.wtRootElement)||ae(el,e,this.wtRootElement)?this.columnFilter.offsettedTH(r):this.columnFilter.visibleRowHeadedColumnToSourceColumn(r),this.wot.createCellCoords(i,r)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let t=this.TBODY.childNodes.length;const e=t*this.wtSettings.getSetting("defaultRowHeight"),o=Ne(this.TBODY)-1;let n,i,r,s,l;if(e!==o||this.wtSettings.getSetting("fixedRowsBottom"))while(t)t-=1,r=this.rowFilter.renderedToSource(t),n=this.getRowHeight(r),s=this.getTrForRow(r),l=s.querySelector("th"),i=l?Ne(l):Ne(s)-1,(!n&&this.wtSettings.getSetting("defaultRowHeight")<i||n<i)&&(i+=1,this.dataAccessObject.wtViewport.oversizedRows[r]=i)}getTrForRow(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}isColumnHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("rowHeaders"),o=e.length;return Math.abs(t)<=o}isRowHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("columnHeaders"),o=e.length;return Math.abs(t)<=o}isRowBeforeRenderedRows(t){const e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}isRowAfterRenderedRows(t){return t>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(t){const e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}isColumnAfterRenderedColumns(t){return this.columnFilter&&t>this.getLastRenderedColumn()}isColumnAfterViewport(t){return this.columnFilter&&t>this.getLastVisibleColumn()}isRowAfterViewport(t){return this.rowFilter&&t>this.getLastVisibleRow()}isColumnBeforeViewport(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(t){return this.rowUtils.getHeight(t)}getColumnHeaderHeight(t){return this.columnUtils.getHeaderHeight(t)}getColumnWidth(t){return this.columnUtils.getWidth(t)}getStretchedColumnWidth(t){return this.columnUtils.getStretchedColumnWidth(t)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Oe(this.TABLE)}getHeight(){return Pe(this.TABLE)}getTotalWidth(){const t=Oe(this.hider);return 0!==t?t:this.getWidth()}getTotalHeight(){const t=Pe(this.hider);return 0!==t?t:this.getHeight()}isVisible(){return be(this.TABLE)}_modifyRowHeaderWidth(t){let e=so(t)?t():null;return Array.isArray(e)?(e=[...e],e[e.length-1]=this._correctRowHeaderWidth(e[e.length-1])):e=this._correctRowHeaderWidth(e),e}_correctRowHeaderWidth(t){let e=t;return"number"!==typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}var al=ll;const hl="stickyRowsTop",cl={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows");return 0===t?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};To(cl,"MIXIN_NAME",hl,{writable:!1,enumerable:!1});var ul=cl;const dl="calculatedColumns",gl={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};To(gl,"MIXIN_NAME",dl,{writable:!1,enumerable:!1});var fl=gl;class ml extends al{constructor(t,e,o,n){super(t,e,o,n,Qs)}}So(ml,ul),So(ml,fl);var pl=ml;function wl(t,e,o){return e=vl(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function vl(t){var e=Cl(t,"string");return"symbol"===typeof e?e:String(e)}function Cl(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class yl{constructor(t){wl(this,"dataAccessObject",void 0),wl(this,"lastScrolledColumnPos",-1),wl(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}scrollViewport(t,e,o,n,i){const r=this.scrollViewportHorizontally(t.col,o,i),s=this.scrollViewportVertically(t.row,e,n);return r||s}scrollViewportHorizontally(t,e,o){const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n||!Number.isInteger(t)||t<0||t>i)return!1;const r=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn(),l=void 0===e&&void 0===o,{fixedColumnsStart:a,inlineStartOverlay:h}=this.dataAccessObject;if(l&&t<a)return!1;let c=!1;return t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",t),-1===r?c=h.scrollTo(t,l?t>this.lastScrolledColumnPos:e):(l&&(t<r||t>s)||!l)&&(c=h.scrollTo(t,l?t>s:e)),c&&(this.lastScrolledColumnPos=t),c}scrollViewportVertically(t,e,o){const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n||!Number.isInteger(t)||t<0||t>i)return!1;const r=this.getFirstVisibleRow(),s=this.getLastVisibleRow(),l=void 0===e&&void 0===o,{fixedRowsBottom:a,fixedRowsTop:h,topOverlay:c}=this.dataAccessObject;if(l&&(t<h||t>i-a-1))return!1;let u=!1;return t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",t),-1===r?u=c.scrollTo(t,l?t>this.lastScrolledRowPos:o):(l&&(t<r||t>s)||!l)&&(u=c.scrollTo(t,l?t>s:o)),u&&(this.lastScrolledRowPos=t),u}getFirstVisibleRow(){const{topOverlay:t,wtTable:e,wtViewport:o,totalRows:n,fixedRowsTop:i,rootWindow:r}=this.dataAccessObject;let s=e.getFirstVisibleRow();if(t.mainTableScrollableElement===r){const l=Se(e.wtRootElement),a=Ne(e.hider),h=Ne(r),c=Te(r,r);if(l.top+a-h<=c){let e=o.getColumnHeaderHeight();e+=t.sumCellSizes(0,i);for(let o=n;o>0;o--)if(e+=t.sumCellSizes(o-1,o),l.top+a-e<=c){s=o;break}}}return s}getLastVisibleRow(){const{topOverlay:t,wtTable:e,wtViewport:o,totalRows:n,rootWindow:i}=this.dataAccessObject;let r=e.getLastVisibleRow();if(t.mainTableScrollableElement===i){const s=Se(e.wtRootElement),l=Te(i,i);if(s.top>l){const e=Ne(i);let a=o.getColumnHeaderHeight();for(let o=1;o<=n;o++)if(a+=t.sumCellSizes(o-1,o),s.top+a-l>=e){r=o-2;break}}}return r}getFirstVisibleColumn(){const{inlineStartOverlay:t,wtTable:e,wtViewport:o,totalColumns:n,rootWindow:i}=this.dataAccessObject;let r=e.getFirstVisibleColumn();if(t.mainTableScrollableElement===i){const s=Se(e.wtRootElement),l=_e(e.hider),a=_e(i),h=Math.abs(Me(i,i));if(s.left+l-a<=h){let e=o.getRowHeaderWidth();for(let o=n;o>0;o--)if(e+=t.sumCellSizes(o-1,o),s.left+l-e<=h){r=o;break}}}return r}getLastVisibleColumn(){const{wtSettings:t,inlineStartOverlay:e,wtTable:o,wtViewport:n,totalColumns:i,rootWindow:r}=this.dataAccessObject;let s=o.getLastVisibleColumn();if(e.mainTableScrollableElement===r){const l=t.getSetting("rtlMode");let a=null;if(l){const t=o.TABLE.getBoundingClientRect(),e=this.dataAccessObject.rootWindow.document,n=e.documentElement.offsetWidth;a=Math.abs(t.right-n)}else{const t=Se(o.wtRootElement);a=t.left}const h=Math.abs(Me(r,r));if(a>h){const t=_e(r);let o=n.getRowHeaderWidth();for(let n=1;n<=i;n++)if(o+=e.sumCellSizes(n-1,n),a+o-h>=t){s=n-2;break}}}return s}}var bl=yl;function Sl(t,e,o){Rl(t,e),e.set(t,o)}function Rl(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function El(t,e,o){return e=Tl(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Tl(t){var e=Ml(t,"string");return"symbol"===typeof e?e:String(e)}function Ml(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Hl(t,e){var o=Il(t,e,"get");return xl(t,o)}function xl(t,e){return e.get?e.get.call(t):e.value}function kl(t,e,o){var n=Il(t,e,"set");return Al(t,n,o),o}function Il(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Al(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var Ol=new WeakMap;class Pl{constructor(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];El(this,"row",null),El(this,"col",null),Sl(this,Ol,{writable:!0,value:!1}),kl(this,Ol,o),"undefined"!==typeof t&&"undefined"!==typeof e&&(this.row=t,this.col=e)}isValid(t){const{countRows:e,countCols:o,countRowHeaders:n,countColHeaders:i}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...t};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col))&&(!(this.row<-i||this.col<-n)&&!(this.row>=e||this.col>=o))}isEqual(t){return t===this||this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Hl(this,Ol)}isSouthEastOf(t){return this.row>=t.row&&(Hl(this,Ol)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(Hl(this,Ol)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(Hl(this,Ol)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(Hl(this,Ol)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(t){return Number.isInteger(null===t||void 0===t?void 0:t.row)&&(this.row=t.row),Number.isInteger(null===t||void 0===t?void 0:t.col)&&(this.col=t.col),t instanceof Pl&&kl(this,Ol,t.isRtl()),this}clone(){return new Pl(this.row,this.col,Hl(this,Ol))}toObject(){return{row:this.row,col:this.col}}}var Nl=Pl;function _l(t,e,o){Ll(t,e),e.set(t,o)}function Ll(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dl(t,e,o){return e=Wl(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Wl(t){var e=Vl(t,"string");return"symbol"===typeof e?e:String(e)}function Vl(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Fl(t,e){var o=zl(t,e,"get");return jl(t,o)}function jl(t,e){return e.get?e.get.call(t):e.value}function Bl(t,e,o){var n=zl(t,e,"set");return Ul(t,n,o),o}function zl(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Ul(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var $l=new WeakMap;class Gl{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Dl(this,"highlight",null),Dl(this,"from",null),Dl(this,"to",null),_l(this,$l,{writable:!0,value:!1}),this.highlight=t.clone(),this.from=e.clone(),this.to=o.clone(),Bl(this,$l,n)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){const{row:e,col:o}=t,n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return n.row<=e&&i.row>=e&&n.col<=o&&i.col>=o}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopRightCorner().col>=t.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=t.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=t.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=t.getOuterTopLeftCorner().col}isOverlappingVertically(t){return this.getOuterBottomRightCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=t.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=t.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=t.getOuterTopRightCorner().row}expand(t){const e=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>o.row||t.col>o.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(o.row,t.row),Math.max(o.col,t.col)),!0)}expandByRange(t){if(this.includesRange(t)||!this.overlaps(t))return!1;const e=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),n=this.getDirection(),i=t.getOuterTopStartCorner(),r=t.getOuterBottomEndCorner(),s=Math.min(e.row,i.row),l=Math.min(e.col,i.col),a=Math.max(o.row,r.row),h=Math.max(o.col,r.col),c=this._createCellCoords(s,l),u=this._createCellCoords(a,h);return this.from=c,this.to=u,this.setDirection(n),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break;default:break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){const t=this.getDirection();switch(t){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}flipDirectionHorizontally(){const t=this.getDirection();switch(t){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Fl(this,$l)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Fl(this,$l)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Fl(this,$l)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Fl(this,$l)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Fl(this,$l)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Fl(this,$l)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Fl(this,$l)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Fl(this,$l)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t,e){return!!(e&&e.includes(t)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(e.from.row,e.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(e.from.row,e.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(e.to.row,e.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(e.to.row,e.to.col))))||(t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner()))}getOppositeCorner(t,e){if(!(t instanceof Nl))return!1;if(e){const{from:o,to:n}=e;if(e.includes(t)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,n.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(n.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterTopStartCorner()}}return t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}getBordersSharedWith(t){if(!this.includesRange(t))return[];const e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},n=[];return e.top===o.top&&n.push("top"),e.right===o.right&&n.push("right"),e.bottom===o.bottom&&n.push("bottom"),e.left===o.left&&n.push("left"),n}getInner(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),o=[];for(let n=t.row;n<=e.row;n++)for(let i=t.col;i<=e.col;i++)this.from.row===n&&this.from.col===i||this.to.row===n&&this.to.col===i||o.push(this._createCellCoords(n,i));return o}getAll(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),o=[];for(let n=t.row;n<=e.row;n++)for(let i=t.col;i<=e.col;i++)t.row===n&&t.col===i?o.push(t):e.row===n&&e.col===i?o.push(e):o.push(this._createCellCoords(n,i));return o}forAll(t){const e=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();for(let n=e.row;n<=o.row;n++)for(let i=e.col;i<=o.col;i++){const e=t(n,i);if(!1===e)return}}clone(){return new Gl(this.highlight,this.from,this.to,Fl(this,$l))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,e){return new Nl(t,e,Fl(this,$l))}}var Yl=Gl;function Kl(t,e,o){return e=Xl(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Xl(t){var e=ql(t,"string");return"symbol"===typeof e?e:String(e)}function ql(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ql{get eventManager(){return new Fn(this)}constructor(t,e){Kl(this,"wtTable",void 0),Kl(this,"wtScroll",void 0),Kl(this,"wtViewport",void 0),Kl(this,"wtOverlays",void 0),Kl(this,"selectionManager",void 0),Kl(this,"wtEvent",void 0),Kl(this,"guid",`wt_${ht()}`),Kl(this,"drawInterrupted",!1),Kl(this,"drawn",!1),Kl(this,"domBindings",void 0),Kl(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new bl(this.createScrollDao())}findOriginalHeaders(){const t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;e<o;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,o){ye(o,t[e])}])}}createCellCoords(t,e){return new Nl(t,e,this.wtSettings.getSetting("rtlMode"))}createCellRange(t,e,o){return new Yl(t,e,o,this.wtSettings.getSetting("rtlMode"))}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this.wtTable.getCell(t);const o=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),r=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<n&&t.col<r)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<r&&t.row>=o-i){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<r)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);if(t.row<o&&t.row>=o-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}scrollViewport(t,e,o,n,i){return!(t.col<0||t.row<0)&&this.wtScroll.scrollViewport(t,e,o,n,i)}scrollViewportHorizontally(t,e,o){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,o)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selectionManager(){return t.selectionManager},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return t.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return t.wtSettings.getSetting("rowHeaders")}}}}function Jl(t,e,o){return e=Zl(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Zl(t){var e=ta(t,"string");return"symbol"===typeof e?e:String(e)}function ta(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ea extends Ql{constructor(t,e,o){super(t,e),Jl(this,"cloneSource",void 0),Jl(this,"cloneOverlay",void 0);const n=this.wtSettings.getSetting("facade",this);this.cloneSource=o.source,this.cloneOverlay=o.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=o.viewport,this.selectionManager=o.selectionManager,this.wtEvent=new Br(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,o.event),this.findOriginalHeaders()}}function oa(t,e,o){return e=na(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function na(t){var e=ia(t,"string");return"symbol"===typeof e?e:String(e)}function ia(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ra{constructor(t,e,o,n,i){oa(this,"wtSettings",null),To(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=e,this.wtSettings=n;const{TABLE:r,hider:s,spreader:l,holder:a,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=o,this.mainTableScrollableElement=null,this.TABLE=r,this.hider=s,this.spreader=l,this.holder=a,this.wtRootElement=h,this.trimmingContainer=xe(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const t=this.needFullRender;this.needFullRender=this.shouldBeRendered();const e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=xe(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:t}=this.wot,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=He(t.TABLE)}getRelativeCellPosition(t,e,o){if(!1===this.clone.wtTable.holder.contains(t))return void hn(`The provided element is not a child of the ${this.type} overlay`);const n=this.mainTableScrollableElement===this.domBindings.rootWindow,i=o<this.wtSettings.getSetting("fixedColumnsStart"),r=e<this.wtSettings.getSetting("fixedRowsTop"),s=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,a={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(t),top:t.offsetTop};let c=null;return c=n?this.getRelativeCellPositionWithinWindow(r,i,h,a):this.getRelativeCellPositionWithinHolder(r,s,i,h,a),c}getRelativeStartPosition(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}getRelativeCellPositionWithinWindow(t,e,o,n){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let r=0,s=0;if(e){let t=i.left;this.isRtl()&&(t=this.domBindings.rootWindow.innerWidth-(i.left+i.width+$e())),r=t<=0?-1*t:0}else r=n.start;if(t){const t=this.clone.wtTable.TABLE.getBoundingClientRect();s=t.top-i.top}else s=n.top;return{start:o.start+r,top:o.top+s}}getRelativeCellPositionWithinHolder(t,e,o,n,i){const r={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let s=0,l=0;if(o||(s=r.horizontal-i.start),e){const t=this.wot.wtTable.wtRootElement.getBoundingClientRect(),e=this.clone.wtTable.TABLE.getBoundingClientRect();l=-1*e.top+t.top}else t||(l=r.vertical-i.top);return{start:n.start-s,top:n.top-l}}makeClone(){if(-1===ol.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:t,wtSettings:e}=this.wot,{rootDocument:o,rootWindow:n}=this.domBindings,i=o.createElement("DIV"),r=o.createElement("TABLE"),s=t.wtRootElement.parentNode;i.className=`${nl.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,e.getSetting("ariaTags")&&fe(i,[pt()]),r.className=t.TABLE.className;const l=t.TABLE.getAttribute("role");l&&r.setAttribute("role",t.TABLE.getAttribute("role")),i.appendChild(r),s.appendChild(i);const a=this.wtSettings.getSetting("preventOverflow");return!0===a||"horizontal"===a&&this.type===Qs||"vertical"===a&&this.type===Zs?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(s).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=He(t.TABLE),new ea(r,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}reset(){if(!this.clone)return;const t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,o=t.style,n=e.style,i=t.parentNode.style;A([o,n,i],(t=>{t.width="",t.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}const sa=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});function la(t,e,o){return e=aa(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function aa(t){var e=ha(t,"string");return"symbol"===typeof e?e:String(e)}function ha(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ca extends ra{constructor(t,e,o,n){super(t,e,Qs,o,n),la(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new pl(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode,{rootWindow:e}=this.domBindings,o=this.wtSettings.getSetting("preventOverflow");let n=0,i=!1;if(this.trimmingContainer!==e||o&&"vertical"===o)n=this.getScrollPosition(),qe(t);else{const{wtTable:e}=this.wot,o=e.hider.getBoundingClientRect(),r=Math.ceil(o.bottom),s=t.offsetHeight;i=r===s,n=this.getOverlayOffset(),Ke(t,"0px",`${n}px`)}const r=this.adjustHeaderBordersPosition(n,i);return this.adjustElementsSize(),r}setScrollPosition(t){const e=this.domBindings.rootWindow;let o=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(Ee(e),t),o=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const o=this.wtSettings.getSetting("defaultRowHeight");let n=t,i=0;while(n<e){const t=this.wot.wtTable.getRowHeight(n);i+=void 0===t?o:t,n+=1}return i}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:o}=this.domBindings,n=$e(e),i=this.clone.wtTable.holder.parentNode,r=i.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===s){let e=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=n),e=Math.min(e,t.wtRootElement.scrollWidth),r.width=`${e}px`}else r.width="";this.clone.wtTable.holder.style.width=r.width;let l=Pe(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),r.height=`${l}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(sa.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+e}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){const{wot:o,wtSettings:n}=this,i=o.cloneSource?o.cloneSource:o,r=i.wtTable.holder;let s=this.getTableParentOffset(),l=0;if(e){const o=this.wot.wtTable.getRowHeight(t),n=this.wot.wtViewport.getViewportHeight();o>n&&(e=!1)}if(e&&r.offsetHeight!==r.clientHeight&&(l=$e(this.domBindings.rootDocument)),e){const e=n.getSetting("fixedRowsBottom"),i=n.getSetting("totalRows");s+=this.sumCellSizes(0,t+1),s-=o.wtViewport.getViewportHeight()-this.sumCellSizes(i-e,i),s+=1}else s+=this.sumCellSizes(n.getSetting("fixedRowsTop"),t);return s+=l,this.setScrollPosition(s)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Te(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),n=t-e;o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),o>n&&(o=0)}return o}adjustHeaderBordersPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("totalColumns");n?ge(o,"emptyColumns"):de(o,"emptyColumns");let i=!1;if(!e){const e=this.wtSettings.getSetting("fixedRowsTop"),n=this.cachedFixedRowsTop!==e,r=this.wtSettings.getSetting("columnHeaders");if((n||0===e)&&r.length>0){const e=ue(o,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?(de(o,"innerBorderTop"),i=!e):(ge(o,"innerBorderTop"),i=e)}}return i}}const ua="stickyRowsBottom",da={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),o=t-e;return 0===t||0===e?-1:o<0?0:o},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};To(da,"MIXIN_NAME",ua,{writable:!1,enumerable:!1});var ga=da;class fa extends al{constructor(t,e,o,n){super(t,e,o,n,Js)}}So(fa,ga),So(fa,fl);var ma=fa;function pa(t,e,o){return e=wa(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function wa(t){var e=va(t,"string");return"symbol"===typeof e?e:String(e)}function va(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ca extends ra{constructor(t,e,o,n){super(t,e,Js,o,n),pa(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new ma(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,e=this.clone.wtTable.holder.parentNode;e.style.top="";let o=0;const n=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||n&&"vertical"===n?(o=this.getScrollPosition(),this.repositionOverlay()):(o=this.getOverlayOffset(),e.style.bottom=`${o}px`);const i=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let i=0;e.hasVerticalScroll()||(i+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(i+=$e(o)),n.style.bottom=`${i}px`}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let o=!1;return this.mainTableScrollableElement===e?(e.scrollTo(Ee(e),t),o=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const{wtTable:o,wtSettings:n}=this.wot,i=n.getSetting("defaultRowHeight");let r=t,s=0;while(r<e){const t=o.getRowHeight(r);s+=void 0===t?i:t,r+=1}return s}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o,rootWindow:n}=this.domBindings,i=$e(o),r=this.clone.wtTable.holder.parentNode,s=r.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===l){let o=e.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(o-=i),o=Math.min(o,t.wtRootElement.scrollWidth),s.width=`${o}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let a=Pe(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(a=0),s.height=`${a}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let o=this.getTableParentOffset();const n=this.wot.cloneSource?this.wot.cloneSource:this.wot,i=n.wtTable.holder;let r=0;e&&i.offsetHeight!==i.clientHeight&&(r=$e(this.domBindings.rootDocument)),e?(o+=this.sumCellSizes(0,t+1),o-=this.wot.wtViewport.getViewportHeight(),o+=1):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),o+=r,this.setScrollPosition(o)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Te(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),n=t-e,i=this.domBindings.rootDocument.documentElement.clientHeight;o=Math.max(this.getTableParentOffset()-this.getScrollPosition()-i+t,0),o>n&&(o=0)}return o}adjustHeaderBordersPosition(t){const e=this.wtSettings.getSetting("fixedRowsBottom"),o=this.cachedFixedRowsBottom!==e,n=this.wtSettings.getSetting("columnHeaders");let i=!1;if((o||0===e)&&n.length>0){const e=this.wot.wtTable.holder.parentNode,o=ue(e,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?(de(e,"innerBorderBottom"),i=!o):(ge(e,"innerBorderBottom"),i=o)}return i}}const ya="calculatedRows",ba={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};To(ba,"MIXIN_NAME",ya,{writable:!1,enumerable:!1});var Sa=ba;const Ra="stickyColumnsStart",Ea={getFirstRenderedColumn(){const t=this.wtSettings.getSetting("totalColumns");return 0===t?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};To(Ea,"MIXIN_NAME",Ra,{writable:!1,enumerable:!1});var Ta=Ea;class Ma extends al{constructor(t,e,o,n){super(t,e,o,n,Zs)}}So(Ma,Sa),So(Ma,Ta);var Ha=Ma;class xa extends ra{constructor(t,e,o,n){super(t,e,Zs,o,n)}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new Ha(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:t}=this.wot;if(!this.needFullRender||!t.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,o=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer!==e||n&&"horizontal"===n?(i=this.getScrollPosition(),qe(o)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),Ke(o,`${i}px`,"0px"));const r=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),r}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let o=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,Re(e)),o=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(t,e){const o=this.wtSettings.getSetting("defaultColumnWidth");let n=t,i=0;while(n<e)i+=this.wot.wtTable.getStretchedColumnWidth(n)||o,n+=1;return i}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:o}=this.domBindings,n=$e(e),i=this.clone.wtTable.holder.parentNode,r=i.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"vertical"===s){let e=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(e-=n),e=Math.min(e,t.wtRootElement.scrollHeight),r.height=`${e}px`}else r.height="";this.clone.wtTable.holder.style.height=r.height;const l=Oe(this.clone.wtTable.TABLE);r.width=`${l}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(sa.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+e}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[e]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(t,e){let o=this.getTableParentOffset();const n=this.wot.cloneSource?this.wot.cloneSource:this.wot,i=n.wtTable.holder;let r=0;if(e){const o=this.wot.wtTable.getColumnWidth(t),n=this.wot.wtViewport.getViewportWidth();o>n&&(e=!1)}return e&&i.offsetWidth!==i.clientWidth&&(r=$e(this.domBindings.rootDocument)),e?(o+=this.sumCellSizes(0,t+1),o-=this.wot.wtViewport.getViewportWidth()):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),o+=r,this.setScrollPosition(o)}getTableParentOffset(){const t=this.wtSettings.getSetting("preventOverflow");let e=0;return t||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs(Me(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===t&&(!e||"horizontal"!==e)){o=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const t=this.wot.wtTable.getTotalWidth(),e=this.clone.wtTable.getTotalWidth(),n=t-e;o>n&&(o=0)}return o}adjustHeaderBordersPosition(t){const e=this.wot.wtTable.holder.parentNode,o=this.wtSettings.getSetting("rowHeaders"),n=this.wtSettings.getSetting("fixedColumnsStart"),i=this.wtSettings.getSetting("totalRows");i?ge(e,"emptyRows"):de(e,"emptyRows");let r=!1;if(n&&!o.length)de(e,"innerBorderLeft innerBorderInlineStart");else if(!n&&o.length){const o=ue(e,"innerBorderInlineStart");t?(de(e,"innerBorderLeft innerBorderInlineStart"),r=!o):(ge(e,"innerBorderLeft innerBorderInlineStart"),r=o)}return r}}class ka extends al{constructor(t,e,o,n){super(t,e,o,n,tl)}}So(ka,ul),So(ka,Ta);var Ia=ka;function Aa(t,e,o){return e=Oa(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Oa(t){var e=Pa(t,"string");return"symbol"===typeof e?e:String(e)}function Pa(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Na extends ra{constructor(t,e,o,n,i,r){super(t,e,tl,o,n),Aa(this,"topOverlay",void 0),Aa(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=r}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new Ia(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Ke(t,`${e}px`,`${o}px`)}else qe(t);let e=Pe(this.clone.wtTable.TABLE);const o=Oe(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=`${e}px`,t.style.width=`${o}px`,!1}}class _a extends al{constructor(t,e,o,n){super(t,e,o,n,el)}}So(_a,ga),So(_a,Ta);var La=_a;class Da extends ra{constructor(t,e,o,n,i,r){super(t,e,el,o,n),this.bottomOverlay=i,this.inlineStartOverlay=r}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new La(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:t}=this;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const t=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]=`${t}px`,e.style.bottom=`${o}px`}else qe(e),this.repositionOverlay();let o=Pe(this.clone.wtTable.TABLE);const n=Oe(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),e.style.height=`${o}px`,e.style.width=`${n}px`,!1}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let i=0;e.hasVerticalScroll()||(i+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(i+=$e(o)),n.style.bottom=`${i}px`}}function Wa(t,e,o){return e=Va(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Va(t){var e=Fa(t,"string");return"symbol"===typeof e?e:String(e)}function Fa(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ja{constructor(t,e,o,n,i,r){Wa(this,"wot",null),Wa(this,"topOverlay",null),Wa(this,"bottomOverlay",null),Wa(this,"inlineStartOverlay",null),Wa(this,"topInlineStartCornerOverlay",null),Wa(this,"bottomInlineStartCornerOverlay",null),Wa(this,"browserLineHeight",void 0),Wa(this,"wtSettings",null),Wa(this,"resizeObserver",new ResizeObserver((t=>{Cr((()=>{Array.isArray(t)&&t.length&&this.wtSettings.getSetting("onContainerElementResize")}))}))),this.wot=t,this.wtSettings=n,this.domBindings=o,this.facadeGetter=e,this.wtTable=r;const{rootDocument:s,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=$e(s);const a="hidden"===l.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=a?r.holder:He(r.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&e.push(this.wtTable),e}initBrowserLineHeight(){const{rootWindow:t,rootDocument:e}=this.domBindings,o=t.getComputedStyle(e.body),n=parseInt(o.lineHeight,10),i=1.2*parseInt(o.fontSize,10);this.browserLineHeight=n||i}initOverlays(){const t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new ca(...t),this.bottomOverlay=new Ca(...t),this.inlineStartOverlay=new xa(...t),this.topInlineStartCornerOverlay=new Na(...t,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Da(...t,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:t,rootWindow:e}=this.domBindings,{mainTableScrollableElement:o}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(t.documentElement,"keydown",(t=>this.onKeyDown(t))),this.eventManager.addEventListener(t.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(t,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(o,"scroll",(t=>this.onTableScroll(t)),{passive:!0}),o!==n&&this.eventManager.addEventListener(n,"scroll",(t=>this.onTableScroll(t)),{passive:!0});const i=e.devicePixelRatio&&e.devicePixelRatio>1,r=this.scrollableElement===e,s=this.wtSettings.getSetting("preventWheel"),l={passive:r};(s||i||!Do())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(t=>this.onCloneWheel(t,s)),l);const a=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let h;a.forEach((t=>{if(t&&t.needFullRender){const{holder:e}=t.clone.wtTable;this.eventManager.addEventListener(e,"wheel",(t=>this.onCloneWheel(t,s)),l)}})),this.eventManager.addEventListener(e,"resize",(()=>{clearTimeout(h),h=setTimeout((()=>{this.wtSettings.getSetting("onWindowResize")}),200)})),r||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(t){const e=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,i=t.target;this.keyPressed&&(n!==e&&i!==e&&!t.target.contains(n)||o!==e&&i!==e&&!t.target.contains(o))||this.syncScrollPositions(t)}onCloneWheel(t,e){const{rootWindow:o}=this.domBindings,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,r=t.target,s=i!==o&&r!==o&&!r.contains(i),l=n!==o&&r!==o&&!r.contains(n);if(this.keyPressed&&(s||l))return;const a=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==o&&a)&&t.preventDefault()}onKeyDown(t){this.keyPressed=on(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(t){let e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,o=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(o+=o*this.browserLineHeight,e+=e*this.browserLineHeight);const n=this.scrollVertically(e),i=this.scrollHorizontally(o);return n||i}scrollVertically(t){const e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}scrollHorizontally(t){const e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:t}=this.domBindings,e=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,[n,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=e.scrollLeft!==n||this.lastScrollX!==t.scrollX,this.verticalScrolling=o.scrollTop!==i||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=n;const t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=n)}this.verticalScrolling&&(o.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){const t=this.topOverlay.mainTableScrollableElement,{scrollLeft:e,scrollTop:o}=t;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:t}=this,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=He(t.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.updateLastSpreaderSize();e&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}updateLastSpreaderSize(){const t=this.wtTable.spreader,e=t.clientWidth,o=t.clientHeight,n=e!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return n&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=o),n}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtViewport:e}=this.wot,{wtTable:o}=this,n=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),r=e.getRowHeaderWidth(),s=e.getColumnHeaderHeight(),l=o.hider.style;if(l.width=`${r+this.inlineStartOverlay.sumCellSizes(0,n)}px`,l.height=`${s+this.topOverlay.sumCellSizes(0,i)+1}px`,this.scrollbarSize>0){const{scrollHeight:t,scrollWidth:e}=o.wtRootElement,{scrollHeight:n,scrollWidth:i}=o.holder;this.hasScrollbarRight=t<n,this.hasScrollbarBottom=e<i,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>e?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>t&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;const e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let o=null;return A(e,(e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(o=e.clone)})),o}syncOverlayTableClassNames(){const t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];A(e,(e=>{e&&(e.clone.wtTable.TABLE.className=t.className)}))}}var Ba=ja;function za(t,e,o){return e=Ua(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ua(t){var e=$a(t,"string");return"symbol"===typeof e?e:String(e)}function $a(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ga{constructor(t){za(this,"settings",{}),za(this,"defaults",Object.freeze(this.getDefaults())),Mo(this.defaults,((e,o)=>{if(void 0!==t[o])this.settings[o]=t[o];else{if(void 0===e)throw new Error(`A required setting "${o}" was not provided`);this.settings[o]=e}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(t,e,o)=>{const n=this.getSetting("data",t,e);ye(o,void 0===n||null===n?"":n)},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:t=>t,onBeforeViewportScrollVertically:t=>t,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:t=>t,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:t=>t,onBeforeHighlightingColumnHeader:t=>t,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(t,e){return void 0===e?Mo(t,((t,e)=>{this.settings[e]=t})):this.settings[t]=e,this}getSetting(t,e,o,n,i){return"function"===typeof this.settings[t]?this.settings[t](e,o,n,i):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}getSettingPure(t){return this.settings[t]}has(t){return!!this.settings[t]}}class Ya extends al{constructor(t,e,o,n){super(t,e,o,n,"master")}alignOverlaysWithTrimmingContainer(){const t=xe(this.wtRootElement),{rootWindow:e}=this.domBindings;if(t===e){const t=this.wtSettings.getSetting("preventOverflow");t||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const o=t.parentElement,n=ke(t,"height",e),i=ke(t,"overflow",e),r=this.holder.style,{scrollWidth:s,scrollHeight:l}=t;let a=t.offsetWidth,h=t.offsetHeight;const c=["auto","hidden","scroll"];if(o&&c.includes(i)){const n=t.cloneNode(!1);n.style.overflow="auto",n.style.position="absolute",t.nextElementSibling?o.insertBefore(n,t.nextElementSibling):o.appendChild(n);const i=parseInt(Ae(n,e).height,10);o.removeChild(n),0===i&&(h=0)}h=Math.min(h,l),r.height="auto"===n?"auto":`${h}px`,a=Math.min(a,s),r.width=`${a}px`,r.overflow="",this.hasTableHeight="auto"===r.height||h>0,this.hasTableWidth=a>0}this.isTableVisible=be(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject,o="master",n=t.getSetting("columnHeaders"),i=n.length;if(i&&!e.hasOversizedColumnHeadersMarked[o]){const n=t.getSetting("rowHeaders"),r=n.length,s=this.getRenderedColumnsCount();for(let t=0;t<i;t++)for(let e=-1*r;e<s;e++)this.markIfOversizedColumnHeader(e);e.hasOversizedColumnHeadersMarked[o]=!0}}}So(Ya,Sa),So(Ya,fl);var Ka=Ya;const Xa=1,qa=2;o(2585);function Qa(t,e,o){Ja(t,e),e.set(t,o)}function Ja(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Za(t,e,o){return e=th(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function th(t){var e=eh(t,"string");return"symbol"===typeof e?e:String(e)}function eh(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function oh(t,e){var o=rh(t,e,"get");return nh(t,o)}function nh(t,e){return e.get?e.get.call(t):e.value}function ih(t,e,o){var n=rh(t,e,"set");return sh(t,n,o),o}function rh(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function sh(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var lh=new WeakMap;class ah{static get DEFAULT_HEIGHT(){return 23}constructor(t){Za(this,"count",0),Za(this,"startRow",null),Za(this,"endRow",null),Za(this,"startPosition",null),Za(this,"isVisibleInTrimmingContainer",!1),Qa(this,lh,{writable:!0,value:void 0}),ih(this,lh,t),this.calculate()}calculate(){const{calculationType:t,overrideFn:e,rowHeightFn:o,scrollOffset:n,totalRows:i,viewportHeight:r}=oh(this,lh),s=Math.max(oh(this,lh).scrollOffset,0),l=oh(this,lh).horizontalScrollbarHeight||0;let a=0,h=!0;const c=[];let u,d=0,g=0;for(let w=0;w<i;w++)if(u=o(w),isNaN(u)&&(u=ah.DEFAULT_HEIGHT),a<=s&&t!==qa&&(this.startRow=w,d=u),a>=s&&a+(t===qa?u:0)<=s+r-l&&(null===this.startRow&&(this.startRow=w,d=u),this.endRow=w),c.push(a),a+=u,g=u,t!==qa&&(this.endRow=w),a>=s+r-l){h=!1;break}const f=n+r-l,m=t===qa?d:0,p=t===qa?0:g;if(f<m||n>c.at(-1)+p?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===i-1&&h){this.startRow=this.endRow;while(this.startRow>0){const e=c[this.endRow]+u-c[this.startRow-1];if((e<=r-l||t!==qa)&&(this.startRow-=1),e>=r-l)break}}t===Xa&&null!==this.startRow&&e&&e(this),this.startPosition=c[this.startRow],void 0===this.startPosition&&(this.startPosition=null),i<this.endRow&&(this.endRow=i-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}var hh=ah;function ch(t,e,o){uh(t,e),e.set(t,o)}function uh(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dh(t,e,o){return e=gh(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function gh(t){var e=fh(t,"string");return"symbol"===typeof e?e:String(e)}function fh(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function mh(t,e){var o=vh(t,e,"get");return ph(t,o)}function ph(t,e){return e.get?e.get.call(t):e.value}function wh(t,e,o){var n=vh(t,e,"set");return Ch(t,n,o),o}function vh(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Ch(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var yh=new WeakMap,bh=new WeakMap;class Sh{static get DEFAULT_WIDTH(){return 50}constructor(t){dh(this,"count",0),dh(this,"startColumn",null),dh(this,"endColumn",null),dh(this,"startPosition",null),dh(this,"isVisibleInTrimmingContainer",!1),dh(this,"stretchAllRatio",0),dh(this,"stretchLastWidth",0),ch(this,yh,{writable:!0,value:0}),dh(this,"needVerifyLastColumnWidth",!0),dh(this,"stretchAllColumnsWidth",[]),ch(this,bh,{writable:!0,value:void 0}),wh(this,bh,t),"function"!==typeof mh(this,bh).stretchingColumnWidthFn&&(mh(this,bh).stretchingColumnWidthFn=t=>t),this.calculate()}calculate(){const{calculationType:t,overrideFn:e,scrollOffset:o,totalColumns:n,viewportWidth:i}=mh(this,bh),r=Math.max(mh(this,bh).scrollOffset,0),s=r>0?i+1:i;let l=0,a=!0;const h=[];let c,u=0,d=0;for(let p=0;p<n;p++)if(c=this._getColumnWidth(p),l<=r&&t!==qa&&(this.startColumn=p,u=c),l>=r&&l+(t===qa?c:0)<=r+s&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=p,u=c),this.endColumn=p),h.push(l),l+=c,d=c,t!==qa&&(this.endColumn=p),l>=r+i){a=!1;break}const g=o+i-s,f=t===qa?0:d,m=t===qa?u:0;if(g<-1*mh(this,bh).inlineStartOffset||o>h.at(-1)+f||-1*mh(this,bh).scrollOffset-mh(this,bh).viewportWidth>-1*m?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===n-1&&a){this.startColumn=this.endColumn;while(this.startColumn>0){const e=h[this.endColumn]+c-h[this.startColumn-1];if((e<=i||t!==qa)&&(this.startColumn-=1),e>i)break}}t===Xa&&null!==this.startColumn&&e&&e(this),this.startPosition=h[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),n<this.endColumn&&(this.endColumn=n-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(t){if("none"===mh(this,bh).stretchMode)return;let e=t;wh(this,yh,e);const o=mh(this,bh).totalColumns;let n=0;for(let r=0;r<o;r++){const t=this._getColumnWidth(r),o=mh(this,bh).stretchingColumnWidthFn(void 0,r);"number"===typeof o?e-=o:n+=t}const i=e-n;if("all"===mh(this,bh).stretchMode&&i>0)this.stretchAllRatio=e/n,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===mh(this,bh).stretchMode&&e!==1/0){const t=this._getColumnWidth(o-1),e=i+t;this.stretchLastWidth=e>=0?e:t}}getStretchedColumnWidth(t,e){let o=null;return"all"===mh(this,bh).stretchMode&&0!==this.stretchAllRatio?o=this._getStretchedAllColumnWidth(t,e):"last"===mh(this,bh).stretchMode&&0!==this.stretchLastWidth&&(o=this._getStretchedLastColumnWidth(t)),o}_getStretchedAllColumnWidth(t,e){let o=0;const n=mh(this,bh).totalColumns;if(!this.stretchAllColumnsWidth[t]){const o=Math.round(e*this.stretchAllRatio),n=mh(this,bh).stretchingColumnWidthFn(o,t);this.stretchAllColumnsWidth[t]=void 0===n?o:isNaN(n)?this._getColumnWidth(t):n}if(this.stretchAllColumnsWidth.length===n&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let t=0;t<this.stretchAllColumnsWidth.length;t++)o+=this.stretchAllColumnsWidth[t];o!==mh(this,yh)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=mh(this,yh)-o)}return this.stretchAllColumnsWidth[t]}_getStretchedLastColumnWidth(t){const e=mh(this,bh).totalColumns;return t===e-1?this.stretchLastWidth:null}_getColumnWidth(t){let e=mh(this,bh).columnWidthFn(t);return isNaN(e)&&(e=Sh.DEFAULT_WIDTH),e}}var Rh=Sh;class Eh{constructor(t,e,o,n,i){this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=o,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=n,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer;let o=0;if(e===this.domBindings.rootWindow)o=t.documentElement.clientHeight;else{const t=Pe(e);o=t>0&&e.clientHeight>0?e.clientHeight:1/0}return o}getWorkspaceWidth(){const{wtSettings:t}=this,{rootDocument:e,rootWindow:o}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=e.documentElement.offsetWidth,r=t.getSetting("totalColumns"),s=t.getSetting("preventOverflow"),l=t.getSetting("rtlMode"),a=this.wtTable.TABLE.getBoundingClientRect(),h=l?a.right-i:a.left,c=i-h;let u,d;if(s)return Oe(this.wtTable.wtRootElement);if(u=t.getSetting("freezeOverlays")?Math.min(c,i):Math.min(this.getContainerFillWidth(),c,i),n===o&&r>0&&this.sumColumnWidths(0,r-1)>u)return e.documentElement.clientWidth;if(n!==o&&(d=ke(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),"scroll"===d||"hidden"===d||"auto"===d))return Math.max(u,n.clientWidth);const g=t.getSetting("stretchH");return"none"!==g&&g?u:Math.max(u,Oe(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(t,e){let o=0,n=t;while(n<e)o+=this.wtTable.getColumnWidth(n),n+=1;return o}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);const o=e.offsetWidth;return this.containerWidth=o,t.removeChild(e),o}getWorkspaceOffset(){return Se(this.wtTable.TABLE)}getColumnHeaderHeight(){const t=this.wtSettings.getSetting("columnHeaders");return t.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Pe(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let t=this.getWorkspaceHeight();if(t===1/0)return t;const e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}getRowHeaderWidth(){const t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(let o=0,n=e.length;o<n;o++)this.rowHeaderWidth+=t[o]||t}if(isNaN(this.rowHeaderWidth))if(e.length){let t=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let o=0,n=e.length;o<n;o++)t?(this.rowHeaderWidth+=Oe(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const t=this.getWorkspaceWidth();if(t===1/0)return t;const e=this.getRowHeaderWidth();return e>0?t-e:t}createRowsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xa;const{wtSettings:e,wtTable:o}=this;let n,i,r;this.rowHeaderWidth=NaN,n=e.getSetting("renderAllRows")&&t===Xa?1/0:this.getViewportHeight();let s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=e.getSetting("fixedRowsTop"),a=e.getSetting("fixedRowsBottom"),h=e.getSetting("totalRows");return l&&s>=0&&(r=this.dataAccessObject.topOverlay.sumCellSizes(0,l),s+=r,n-=r),a&&this.dataAccessObject.bottomOverlay.clone&&(r=this.dataAccessObject.bottomOverlay.sumCellSizes(h-a,h),n-=r),i=o.holder.clientHeight===o.holder.offsetHeight?0:$e(this.domBindings.rootDocument),new hh({viewportHeight:n,scrollOffset:s,totalRows:e.getSetting("totalRows"),rowHeightFn:t=>o.getRowHeight(t),overrideFn:e.getSettingPure("viewportRowCalculatorOverride"),calculationType:t,horizontalScrollbarHeight:i})}createColumnsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xa;const{wtSettings:e,wtTable:o}=this;let n=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const r=e.getSetting("fixedColumnsStart");if(r&&i>=0){const t=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,r);i+=t,n-=t}return o.holder.clientWidth!==o.holder.offsetWidth&&(n-=$e(this.domBindings.rootDocument)),new Rh({viewportWidth:n,scrollOffset:i,totalColumns:e.getSetting("totalColumns"),columnWidthFn:t=>o.getColumnWidth(t),overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,stretchMode:e.getSetting("stretchH"),stretchingColumnWidthFn:(t,o)=>e.getSetting("onBeforeStretchingColumnWidth",t,o),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=t;if(e){const t=this.createRowsCalculator(qa),o=this.createColumnsCalculator(qa);this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(Xa),this.columnsRenderCalculator=this.createColumnsCalculator(Xa)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(qa),this.columnsVisibleCalculator=this.createColumnsCalculator(qa)}areAllProposedVisibleRowsAlreadyRendered(t){if(!this.rowsVisibleCalculator)return!1;const{startRow:e,endRow:o,isVisibleInTrimmingContainer:n}=t;if(null===e&&null===o)return!n;const{startRow:i,endRow:r}=this.rowsRenderCalculator;return!(e<i||e===i&&e>0)&&!(o>r||o===r&&o<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(t){if(!this.columnsVisibleCalculator)return!1;const{startColumn:e,endColumn:o,isVisibleInTrimmingContainer:n}=t;if(null===e&&null===o)return!n;const{startColumn:i,endColumn:r}=this.columnsRenderCalculator;return!(e<i||e===i&&e>0)&&!(o>r||o===r&&o<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Mo(this.hasOversizedColumnHeadersMarked,((t,e,o)=>{o[e]=void 0}))}}var Th=Eh;o(3599);function Mh(t,e){xh(t,e),e.add(t)}function Hh(t,e,o){xh(t,e),e.set(t,o)}function xh(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kh(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function Ih(t,e){var o=Ph(t,e,"get");return Ah(t,o)}function Ah(t,e){return e.get?e.get.call(t):e.value}function Oh(t,e,o){var n=Ph(t,e,"set");return Nh(t,n,o),o}function Ph(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Nh(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var _h=new WeakMap,Lh=new WeakMap,Dh=new WeakSet;class Wh{constructor(){Mh(this,Dh),Hh(this,_h,{writable:!0,value:void 0}),Hh(this,Lh,{writable:!0,value:void 0})}setActiveOverlay(t){return Oh(this,Lh,t),this}setActiveSelection(t){return Oh(this,_h,t),this}scan(){const t=Ih(this,_h).settings.selectionType,e=new Set;return"active-header"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t)))):"area"===t?this.scanCellsRange((t=>e.add(t))):"focus"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t))),this.scanCellsRange((t=>e.add(t)))):"fill"===t?this.scanCellsRange((t=>e.add(t))):"header"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t)))):"row"===t?(this.scanRowsInHeadersRange((t=>e.add(t))),this.scanRowsInCellsRange((t=>e.add(t)))):"column"===t&&(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanColumnsInCellsRange((t=>e.add(t)))),e}scanColumnsInHeadersRange(t){const[e,o,n,i]=Ih(this,_h).getCorners(),{wtTable:r}=Ih(this,Lh),s=r.getRenderedColumnsCount(),l=r.getColumnHeadersCount();let a=0;for(let h=-r.getRowHeadersCount();h<s;h++){const s=r.columnFilter.renderedToSource(h);if(!(s<o||s>i)){for(let h=-l;h<0;h++){if(h<e||h>n)continue;const c=h+l;let u=r.getColumnHeader(s,c);const d=Ih(this,Lh).getSetting("onBeforeHighlightingColumnHeader",s,c,{selectionType:Ih(this,_h).settings.selectionType,columnCursor:a,selectionWidth:i-o+1});null!==d&&(d!==s&&(u=r.getColumnHeader(d,c)),t(u))}a+=1}}}scanRowsInHeadersRange(t){const[e,o,n,i]=Ih(this,_h).getCorners(),{wtTable:r}=Ih(this,Lh),s=r.getRenderedRowsCount(),l=r.getRowHeadersCount();let a=0;for(let h=-r.getColumnHeadersCount();h<s;h++){const s=r.rowFilter.renderedToSource(h);if(!(s<e||s>n)){for(let h=-l;h<0;h++){if(h<o||h>i)continue;const c=h+l;let u=r.getRowHeader(s,c);const d=Ih(this,Lh).getSetting("onBeforeHighlightingRowHeader",s,c,{selectionType:Ih(this,_h).settings.selectionType,rowCursor:a,selectionHeight:n-e+1});null!==d&&(d!==s&&(u=r.getRowHeader(d,c)),t(u))}a+=1}}}scanCellsRange(t){const[e,o,n,i]=Ih(this,_h).getCorners(),{wtTable:r}=Ih(this,Lh);kh(this,Dh,Vh).call(this,((s,l)=>{if(s>=e&&s<=n&&l>=o&&l<=i){const e=r.getCell(Ih(this,Lh).createCellCoords(s,l)),o=Ih(this,Lh).getSetting("onAfterDrawSelection",s,l,Ih(this,_h).settings.layerLevel);"string"===typeof o&&de(e,o),t(e)}}))}scanRowsInCellsRange(t){const[e,,o]=Ih(this,_h).getCorners(),{wtTable:n}=Ih(this,Lh);kh(this,Dh,Vh).call(this,((i,r)=>{if(i>=e&&i<=o){const e=n.getCell(Ih(this,Lh).createCellCoords(i,r));t(e)}}))}scanColumnsInCellsRange(t){const[,e,,o]=Ih(this,_h).getCorners(),{wtTable:n}=Ih(this,Lh);kh(this,Dh,Vh).call(this,((i,r)=>{if(r>=e&&r<=o){const e=n.getCell(Ih(this,Lh).createCellCoords(i,r));t(e)}}))}}function Vh(t){const{wtTable:e}=Ih(this,Lh),o=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<o;i+=1){const o=e.rowFilter.renderedToSource(i);for(let i=0;i<n;i+=1)t(o,e.columnFilter.renderedToSource(i))}}class Fh{constructor(t,e){e&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=sa,this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners())}registerListeners(){const t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp()));for(let e=0,o=this.main.childNodes.length;e<o;e++){const t=this.main.childNodes[e];this.eventManager.addEventListener(t,"mouseenter",(t=>this.onMouseEnter(t,this.main.childNodes[e])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(t,e){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),nn(t);const o=this,n=this.wot.rootDocument.body,i=e.getBoundingClientRect();function r(t){return t.clientY<Math.floor(i.top)||(t.clientY>Math.ceil(i.top+i.height)||(t.clientX<Math.floor(i.left)||(t.clientX>Math.ceil(i.left+i.width)||void 0)))}function s(t){r(t)&&(o.eventManager.removeEventListener(n,"mousemove",s),e.style.display="block")}e.style.display="none",this.eventManager.addEventListener(n,"mousemove",s)}createBorders(t){const{rootDocument:e}=this.wot;this.main=e.createElement("div");const o=["top","start","bottom","end","corner"];let n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(let s=0;s<5;s++){const i=o[s],r=e.createElement("div");r.className=`wtBorder ${this.settings.className||""}`,this.settings[i]&&this.settings[i].hide&&(r.className+=" hidden"),n=r.style,n.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:t.border.color,n.height=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${t.border.width}px`,n.width=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${t.border.width}px`,this.main.appendChild(r)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Uo()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let r=i.bordersHolder;r||(r=e.createElement("div"),r.className="htBorders",i.bordersHolder=r,i.spreader.appendChild(r)),r.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:t}=this.wot;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")};const e=10,o=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const n={position:"absolute",height:`${o}px`,width:`${o}px`,"border-radius":`${parseInt(o/1.5,10)}px`};Mo(n,((t,e)=>{this.selectionHandles.styles.bottomHitArea[e]=t,this.selectionHandles.styles.topHitArea[e]=t}));const i={position:"absolute",height:`${e}px`,width:`${e}px`,"border-radius":`${parseInt(e/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Mo(i,((t,e)=>{this.selectionHandles.styles.bottom[e]=t,this.selectionHandles.styles.top[e]=t})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(t,e){const o=this.wot.selectionManager.getAreaSelection();return!(!o.cellRange||t===o.cellRange.to.row&&e===o.cellRange.to.col)}updateMultipleSelectionHandlesPosition(t,e,o,n,i,r){const s=this.wot.wtSettings.getSetting("rtlMode"),l=s?"right":"left",{top:a,topHitArea:h,bottom:c,bottomHitArea:u}=this.selectionHandles.styles,d=parseInt(a.borderWidth,10),g=parseInt(a.width,10),f=parseInt(h.width,10),m=this.wot.wtTable.getWidth(),p=this.wot.wtTable.getHeight();a.top=`${parseInt(o-g-1,10)}px`,a[l]=`${parseInt(n-g-1,10)}px`,h.top=`${parseInt(o-f/4*3,10)}px`,h[l]=`${parseInt(n-f/4*3,10)}px`;const w=Math.min(parseInt(n+i,10),m-g-2*d),v=Math.min(parseInt(n+i-f/4,10),m-f-2*d);c[l]=`${w}px`,u[l]=`${v}px`;const C=Math.min(parseInt(o+r,10),p-g-2*d),y=Math.min(parseInt(o+r-f/4,10),p-f-2*d);c.top=`${C}px`,u.top=`${y}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",h.display="block",this.isPartRange(t,e)?(c.display="none",u.display="none"):(c.display="block",u.display="block")):(a.display="none",c.display="none",h.display="none",u.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",h.zIndex="9999"):(a.zIndex="",h.zIndex="")}appear(t){if(this.disabled)return;const{wtTable:e,rootDocument:o,rootWindow:n}=this.wot;let i,r,s,l,a,h;const c=e.getRenderedRowsCount();for(let P=0;P<c;P+=1){const o=e.rowFilter.renderedToSource(P);if(o>=t[0]&&o<=t[2]){i=o,a=t[0];break}}for(let P=c-1;P>=0;P-=1){const o=e.rowFilter.renderedToSource(P);if(o>=t[0]&&o<=t[2]){r=o;break}}const u=e.getRenderedColumnsCount();for(let P=0;P<u;P+=1){const o=e.columnFilter.renderedToSource(P);if(o>=t[1]&&o<=t[3]){s=o,h=t[1];break}}for(let P=u-1;P>=0;P-=1){const o=e.columnFilter.renderedToSource(P);if(o>=t[1]&&o<=t[3]){l=o;break}}if(void 0===i||void 0===s)return void this.disappear();let d=e.getCell(this.wot.createCellCoords(i,s));const g=i!==r||s!==l,f=g?e.getCell(this.wot.createCellCoords(r,l)):d,m=Se(d),p=g?Se(f):m,w=Se(e.TABLE),v=Oe(e.TABLE),C=m.top,y=m.left,b=this.wot.wtSettings.getSetting("rtlMode");let S=0,R=0;if(b){const t=Oe(d),e=n.innerWidth-w.left-v;R=y+t-p.left,S=n.innerWidth-y-t-e-1}else R=p.left+Oe(f)-y,S=y-w.left-1;if(this.isEntireColumnSelected(i,r)){const t=this.getDimensionsFromHeader("columns",s,l,a,w);let e=null;t&&([e,S,R]=t),e&&(d=e)}let E=C-w.top-1,T=p.top+Pe(f)-C;if(this.isEntireRowSelected(s,l)){const t=this.getDimensionsFromHeader("rows",i,r,h,w);let e=null;t&&([e,E,T]=t),e&&(d=e)}const M=Ae(d,n);parseInt(M.borderTopWidth,10)>0&&(E+=1,T=T>0?T-1:0),parseInt(M[b?"borderRightWidth":"borderLeftWidth"],10)>0&&(S+=1,R=R>0?R-1:0);const H=b?"right":"left";this.topStyle.top=`${E}px`,this.topStyle[H]=`${S}px`,this.topStyle.width=`${R}px`,this.topStyle.display="block",this.startStyle.top=`${E}px`,this.startStyle[H]=`${S}px`,this.startStyle.height=`${T}px`,this.startStyle.display="block";const x=Math.floor(this.settings.border.width/2);this.bottomStyle.top=E+T-x+"px",this.bottomStyle[H]=`${S}px`,this.bottomStyle.width=`${R}px`,this.bottomStyle.display="block",this.endStyle.top=`${E}px`,this.endStyle[H]=S+R-x+"px",this.endStyle.height=`${T+1}px`,this.endStyle.display="block";let k=this.settings.border.cornerVisible;k="function"===typeof k?k(this.settings.layerLevel):k;const I=this.wot.getSetting("onModifyGetCellCoords",r,l);let[A,O]=[r,l];if(I&&Array.isArray(I)&&([,,A,O]=I),Uo()||!k||this.isPartRange(A,O))this.cornerStyle.display="none";else{this.cornerStyle.top=E+T+this.cornerCenterPointOffset-1+"px",this.cornerStyle[H]=S+R+this.cornerCenterPointOffset-1+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let t=xe(e.TABLE);const i=t===n;i&&(t=o.documentElement);const s=parseInt(this.cornerDefaultStyle.width,10)/2,a=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const e=i?f.getBoundingClientRect().left:f.offsetLeft;let o=!1,n=0;b?(n=e-parseInt(this.cornerDefaultStyle.width,10)/2,o=n<0):(n=e+Oe(f)+parseInt(this.cornerDefaultStyle.width,10)/2,o=n>=_e(t)),o&&(this.cornerStyle[H]=`${Math.floor(S+R+this.cornerCenterPointOffset-s)}px`,this.cornerStyle[b?"borderLeftWidth":"borderRightWidth"]=0)}if(r===this.wot.getSetting("totalRows")-1){const e=i?f.getBoundingClientRect().top:f.offsetTop,o=e+Pe(f)+parseInt(this.cornerDefaultStyle.height,10)/2,n=o>=Ne(t);n&&(this.cornerStyle.top=`${Math.floor(E+T+this.cornerCenterPointOffset-a)}px`,this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Uo()&&this.updateMultipleSelectionHandlesPosition(r,l,E,S,R,T)}isEntireColumnSelected(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(t,e,o,n,i){const{wtTable:r}=this.wot,s=r.wtRootElement.parentNode;let l=null,a=null,h=null,c=null,u=null,d=null,g=null,f=null;switch(t){case"rows":l=function(){return r.getRowHeader(...arguments)},a=function(){return Pe(...arguments)},h="ht__selection--rows",d="top";break;case"columns":l=function(){return r.getColumnHeader(...arguments)},a=function(){return Oe(...arguments)},h="ht__selection--columns",d="left";break;default:}if(s.classList.contains(h)){const t=this.wot.getSetting("columnHeaders").length;if(g=l(e,t-n),f=l(o,t-n),!g||!f)return!1;const r=Se(g),s=Se(f);return g&&f&&(c=r[d]-i[d]-1,u=s[d]+a(f)-r[d]),[g,c,u]}return!1}changeBorderStyle(t,e){const o=this[t].style,n=e[t];!n||n.hide?de(this[t],"hidden"):(ue(this[t],"hidden")&&ge(this[t],"hidden"),o.backgroundColor=n.color,"top"!==t&&"bottom"!==t||(o.height=`${n.width}px`),"start"!==t&&"end"!==t||(o.width=`${n.width}px`))}changeBorderToDefaultStyle(t){const e={width:1,color:"#000"},o=this[t].style;o.backgroundColor=e.color,o.width=`${e.width}px`,o.height=`${e.width}px`}toggleHiddenClass(t,e){this.changeBorderToDefaultStyle(t),e?de(this[t],"hidden"):ge(this[t],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Uo()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}var jh=Fh;function Bh(t,e){Uh(t,e),e.add(t)}function zh(t,e,o){Uh(t,e),e.set(t,o)}function Uh(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $h(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function Gh(t,e){var o=Xh(t,e,"get");return Yh(t,o)}function Yh(t,e){return e.get?e.get.call(t):e.value}function Kh(t,e,o){var n=Xh(t,e,"set");return qh(t,n,o),o}function Xh(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function qh(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var Qh=new WeakMap,Jh=new WeakMap,Zh=new WeakMap,tc=new WeakMap,ec=new WeakMap,oc=new WeakMap,nc=new WeakSet;class ic{constructor(t){Bh(this,nc),zh(this,Qh,{writable:!0,value:void 0}),zh(this,Jh,{writable:!0,value:void 0}),zh(this,Zh,{writable:!0,value:new Wh}),zh(this,tc,{writable:!0,value:new WeakMap}),zh(this,ec,{writable:!0,value:new WeakSet}),zh(this,oc,{writable:!0,value:new Map}),Kh(this,Jh,t)}setActiveOverlay(t){return Kh(this,Qh,t),Gh(this,Zh).setActiveOverlay(Gh(this,Qh)),Gh(this,tc).has(Gh(this,Qh))||Gh(this,tc).set(Gh(this,Qh),new Set),this}getFocusSelection(){return null!==Gh(this,Jh)?Gh(this,Jh).getFocus():null}getAreaSelection(){return null!==Gh(this,Jh)?Gh(this,Jh).createLayeredArea():null}getBorderInstance(t){if(!t.settings.border)return null;if(Gh(this,oc).has(t)){const e=Gh(this,oc).get(t);if(e.has(Gh(this,Qh)))return e.get(Gh(this,Qh));const o=new jh(Gh(this,Qh),t.settings);return e.set(Gh(this,Qh),o),o}const e=new jh(Gh(this,Qh),t.settings);return Gh(this,oc).set(t,new Map([[Gh(this,Qh),e]])),e}getBorderInstances(t){var e,o;return Array.from(null!==(e=null===(o=Gh(this,oc).get(t))||void 0===o?void 0:o.values())&&void 0!==e?e:[])}destroyBorders(t){Gh(this,oc).get(t).forEach((t=>t.destroy())),Gh(this,oc).delete(t)}render(t){if(null===Gh(this,Jh))return;t&&$h(this,nc,rc).call(this);const e=Array.from(Gh(this,Jh)),o=new Map;for(let n=0;n<e.length;n++){const t=e[n],{className:i,createLayers:r,selectionType:s}=t.settings;Gh(this,ec).has(t)||(Gh(this,ec).add(t),t.addLocalHook("destroy",(()=>this.destroyBorders(t))));const l=this.getBorderInstance(t);if(t.isEmpty()){null===l||void 0===l||l.disappear();continue}if(i){const e=Gh(this,Zh).setActiveSelection(t).scan();e.forEach((t=>{if(o.has(t)){const e=o.get(t);e.has(i)&&!0===r?e.set(i,e.get(i)+1):e.set(i,1)}else o.set(t,new Map([[i,1]]))}))}const a=t.getCorners();Gh(this,Qh).getSetting("onBeforeDrawBorders",a,s),null===l||void 0===l||l.appear(a)}o.forEach(((t,e)=>{var o,n;const i=Array.from(t).map((t=>{let[e,o]=t;return 1===o?e:[e,...Array.from({length:o-1},((t,o)=>`${e}-${o+1}`))]})).flat();i.forEach((t=>Gh(this,tc).get(Gh(this,Qh)).add(t))),de(e,i),"TD"===e.nodeName&&Array.isArray(null===(o=Gh(this,Jh).options)||void 0===o?void 0:o.cellAttributes)?fe(e,Gh(this,Jh).options.cellAttributes):"TH"===e.nodeName&&Array.isArray(null===(n=Gh(this,Jh).options)||void 0===n?void 0:n.headerAttributes)&&fe(e,Gh(this,Jh).options.headerAttributes)}))}}function rc(){const t=Gh(this,tc).get(Gh(this,Qh)),e=Gh(this,Qh).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let o=0;o<e.length;o++)t.add(e[o]);t.forEach((t=>{var e,o;const n=Gh(this,Qh).wtTable.TABLE.querySelectorAll(`.${t}`);let i=[];Array.isArray(null===(e=Gh(this,Jh).options)||void 0===e?void 0:e.cellAttributes)&&(i=Gh(this,Jh).options.cellAttributes.map((t=>t[0]))),Array.isArray(null===(o=Gh(this,Jh).options)||void 0===o?void 0:o.headerAttributes)&&(i=[...i,...Gh(this,Jh).options.headerAttributes.map((t=>t[0]))]);for(let r=0,s=n.length;r<s;r++)ge(n[r],t),me(n[r],i)})),t.clear()}class sc extends Ql{constructor(t,e){super(t,new Ga(e));const o=this.wtSettings.getSetting("facade",this);this.wtTable=new Ka(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=new Th(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new ic(this.wtSettings.getSetting("selections")),this.wtEvent=new Br(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Ba(this,o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const t={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},e=[],o=[];Mo(t,((t,n)=>{this.wtSettings.getSetting(n).length&&o.push(t),e.push(t)})),ge(this.wtTable.wtRootElement.parentNode,e),de(this.wtTable.wtRootElement.parentNode,o)}getViewportDao(){const t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}class lc{constructor(t){t instanceof Ql?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=t=>{const e=new lc(t);return()=>e},this._wot=new sc(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}createCellCoords(t,e){return this._wot.createCellCoords(t,e)}createCellRange(t,e,o){return this._wot.createCellRange(t,e,o)}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}scrollViewport(t,e,o,n,i){return this._wot.scrollViewport(t,e,o,n,i)}scrollViewportHorizontally(t,e,o){return this._wot.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return this._wot.scrollViewportVertically(t,e,o)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,e){return this._wot.wtSettings.update(t,e),this}getSetting(t,e,o,n,i){return this._wot.wtSettings.getSetting(t,e,o,n,i)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}}function ac(t){let{isShiftKey:e,isLeftClick:o,isRightClick:n,coords:i,selection:r,controller:s,cellCoordsFactory:l}=t;const a=r.isSelected()?r.getSelectedRange().current():null,h=r.isSelectedByCorner(),c=r.isSelectedByRowHeader();if(e&&a)i.row>=0&&i.col>=0&&!s.cell?r.setRangeEnd(i):(h||c)&&i.row>=0&&i.col>=0&&!s.cell?r.setRangeEnd(l(i.row,i.col)):h&&i.row<0&&!s.column?r.setRangeEnd(l(a.to.row,i.col)):c&&i.col<0&&!s.row?r.setRangeEnd(l(i.row,a.to.col)):(!h&&!c&&i.col<0||h&&i.col<0)&&!s.row?r.selectRows(Math.max(a.from.row,0),i.row,i.col):(!h&&!c&&i.row<0||c&&i.row<0)&&!s.column&&r.selectColumns(Math.max(a.from.col,0),i.col,i.row);else{const t=!r.inInSelection(i),e=o||n&&t;i.row<0&&i.col>=0&&!s.column?e&&r.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?e&&r.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?e&&r.setRangeStart(i):i.col<0&&i.row<0&&r.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function hc(t){let{isLeftClick:e,coords:o,selection:n,controller:i,cellCoordsFactory:r}=t;if(!e)return;const s=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),a=n.tableProps.countCols(),h=n.tableProps.countRows();l&&!i.column?n.setRangeEnd(r(h-1,o.col)):s&&!i.row?n.setRangeEnd(r(o.row,a-1)):i.cell||n.setRangeEnd(o)}const cc=new Map([["mousedown",ac],["mouseover",hc],["touchstart",ac]]);function uc(t,e){let{coords:o,selection:n,controller:i,cellCoordsFactory:r}=e;cc.get(t.type)({coords:o,selection:n,controller:i,cellCoordsFactory:r,isShiftKey:t.shiftKey,isLeftClick:ln(t)||"touchstart"===t.type,isRightClick:sn(t)})}const dc=new WeakMap,gc=Symbol("rootInstance");function fc(t){dc.set(t,!0)}function mc(t){return t===gc}function pc(t){return dc.has(t)}function wc(t,e,o){vc(t,e),e.set(t,o)}function vc(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cc(t,e,o){return e=yc(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function yc(t){var e=bc(t,"string");return"symbol"===typeof e?e:String(e)}function bc(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Sc(t,e){var o=Tc(t,e,"get");return Rc(t,o)}function Rc(t,e){return e.get?e.get.call(t):e.value}function Ec(t,e,o){var n=Tc(t,e,"set");return Mc(t,n,o),o}function Tc(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Mc(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var Hc=new WeakMap,xc=new WeakMap,kc=new WeakMap,Ic=new WeakMap,Ac=new WeakMap,Oc=new WeakMap,Pc=new WeakMap;class Nc{constructor(t){Cc(this,"hot",void 0),Cc(this,"eventManager",void 0),Cc(this,"settings",void 0),Cc(this,"THEAD",void 0),Cc(this,"TBODY",void 0),Cc(this,"_wt",void 0),Cc(this,"activeWt",void 0),wc(this,Hc,{writable:!0,value:0}),wc(this,xc,{writable:!0,value:0}),Cc(this,"postponedAdjustElementsSize",!1),wc(this,kc,{writable:!0,value:!1}),wc(this,Ic,{writable:!0,value:void 0}),wc(this,Ac,{writable:!0,value:void 0}),wc(this,Oc,{writable:!0,value:0}),wc(this,Pc,{writable:!0,value:0}),this.hot=t,this.eventManager=new Fn(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}getCellAtCoords(t,e){const o=this._wt.getCell(t,e);return o<0?null:o}scrollViewport(t,e,o,n,i){return this._wt.scrollViewport(t,e,o,n,i)}scrollViewportHorizontally(t,e,o){return this._wt.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return this._wt.scrollViewportVertically(t,e,o)}createElements(){const{rootElement:t,rootDocument:e}=this.hot,o=t.getAttribute("style");o&&t.setAttribute("data-originalstyle",o),de(t,"handsontable"),Ec(this,Ac,e.createElement("TABLE")),de(Sc(this,Ac),"htCore"),this.hot.getSettings().tableClassName&&de(Sc(this,Ac),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(fe(Sc(this,Ac),[pt()]),fe(t,[mt(),Lt(this.hot.countRows()),Dt(this.hot.countCols()),Nt()])),this.THEAD=e.createElement("THEAD"),Sc(this,Ac).appendChild(this.THEAD),this.TBODY=e.createElement("TBODY"),Sc(this,Ac).appendChild(this.TBODY),this.hot.table=Sc(this,Ac),this.hot.container.insertBefore(Sc(this,Ac),this.hot.container.firstChild)}registerEvents(){const{rootElement:t,rootDocument:e,selection:o}=this.hot,n=e.documentElement;this.eventManager.addEventListener(t,"mousedown",(t=>{if(Ec(this,kc,!0),!this.isTextSelectionAllowed(t.target)){const{rootWindow:e}=this.hot;je(e),t.preventDefault(),e.focus()}})),this.eventManager.addEventListener(t,"mouseup",(()=>{Ec(this,kc,!1)})),this.eventManager.addEventListener(t,"mousemove",(t=>{Sc(this,kc)&&!this.isTextSelectionAllowed(t.target)&&(this.settings.fragmentSelection&&je(this.hot.rootWindow),t.preventDefault())})),this.eventManager.addEventListener(n,"keyup",(t=>{o.isInProgress()&&!t.shiftKey&&o.finish()})),this.eventManager.addEventListener(n,"mouseup",(n=>{o.isInProgress()&&ln(n)&&o.finish(),Ec(this,Ic,!1);const i=Je(e.activeElement);i&&(!i&&(o.isSelected()||o.isSelectedByAnyHeader()||t.contains(n.target)||sn(n))||this.hot.unlisten())})),this.eventManager.addEventListener(n,"contextmenu",(t=>{o.isInProgress()&&sn(t)&&(o.finish(),Ec(this,Ic,!1))})),this.eventManager.addEventListener(n,"touchend",(()=>{o.isInProgress()&&o.finish(),Ec(this,Ic,!1)})),this.eventManager.addEventListener(n,"mousedown",(o=>{const i=o.target,r=o.x||o.clientX,s=o.y||o.clientY;let l=o.target;if(Sc(this,Ic)||!t||!this.hot.view)return;const{holder:a}=this.hot.view._wt.wtTable;if(l===a){const t=$e(e);if(e.elementFromPoint(r+t,s)!==a||e.elementFromPoint(r,s+t)!==a)return}else while(l!==n){if(null===l){if(o.isTargetWebComponent)break;return}if(l===t)return;l=l.parentNode}const h="function"===typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(i):this.settings.outsideClickDeselects;h?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)})),this.eventManager.addEventListener(Sc(this,Ac),"selectstart",(t=>{this.settings.fragmentSelection||Qe(t.target)||t.preventDefault()}))}translateFromRenderableToVisualCoords(t){let{row:e,col:o}=t;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(e,o))}translateFromRenderableToVisualIndex(t,e){let o=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t,n=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===o&&(o=t),null===n&&(n=e),[o,n]}countRenderableIndexes(t,e){const o=Math.min(t.getNotTrimmedIndexesLength(),e),n=t.getNearestNotHiddenIndex(o-1,-1);return null===n?0:t.getRenderableFromVisualIndex(n)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(t,e,o,n){if(isNaN(t)||t<0)return 0;const i=o.getNearestNotHiddenIndex(t,e),r=o.getRenderableFromVisualIndex(i);if(!Number.isInteger(r))return 0;let s=0;return e<0?s=r+1:e>0&&(s=n-r),s}countNotHiddenFixedColumnsStart(){const t=this.hot.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){const t=this.hot.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){const t=this.hot.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}countRenderableColumnsInRange(t,e){let o=0;for(let n=t;n<=e;n++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(n)&&(o+=1);return o}countRenderableRowsInRange(t,e){let o=0;for(let n=t;n<=e;n++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(n)&&(o+=1);return o}isMainTableNotFullyCoveredByOverlays(){const t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>t&&this.hot.countRenderedCols()>e}initializeWalkontable(){const t={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Sc(this,Ac),isDataViewInstance:()=>pc(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(t,e)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(t,e)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const t=[];return this.hot.hasRowHeaders()&&t.push(((t,e)=>{const o=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t;this.appendRowHeader(o,e)})),this.hot.runHooks("afterGetRowHeaderRenderers",t),Ec(this,xc,t.length),t},columnHeaders:()=>{const t=[];return this.hot.hasColHeaders()&&t.push(((t,e)=>{const o=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;this.appendColHeader(o,e)})),this.hot.runHooks("afterGetColumnHeaderRenderers",t),Ec(this,Hc,t.length),t},columnWidth:t=>{const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getColWidth(null===e?t:e)},rowHeight:t=>{const e=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getRowHeight(null===e?t:e)},cellRenderer:(t,e,o)=>{const[n,i]=this.translateFromRenderableToVisualIndex(t,e),r=this.hot.runHooks("modifyGetCellCoords",n,i);let s=n,l=i;Array.isArray(r)&&([s,l]=r);const a=this.hot.getCellMeta(s,l),h=this.hot.colToProp(l);let c=this.hot.getDataAtRowProp(s,h);this.hot.hasHook("beforeValueRender")&&(c=this.hot.runHooks("beforeValueRender",c,a)),this.hot.runHooks("beforeRenderer",o,n,i,h,c,a),this.hot.getCellRenderer(a)(this.hot,o,n,i,h,c,a),this.hot.runHooks("afterRenderer",o,n,i,h,c,a)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&be(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e),r={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=n,Ec(this,Ic,!0),this.hot.runHooks("beforeOnCellMouseDown",t,i,o,r),rn(t)||(uc(t,{coords:i,selection:this.hot.selection,controller:r,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseDown",t,i,o),this.activeWt=this._wt)},onCellContextMenu:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=n,Ec(this,Ic,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",t,i,o),rn(t)||(this.hot.runHooks("afterOnCellContextMenu",t,i,o),this.activeWt=this._wt)},onCellMouseOut:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=n,this.hot.runHooks("beforeOnCellMouseOut",t,i,o),rn(t)||(this.hot.runHooks("afterOnCellMouseOut",t,i,o),this.activeWt=this._wt)},onCellMouseOver:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e),r={row:!1,column:!1,cell:!1};this.activeWt=n,this.hot.runHooks("beforeOnCellMouseOver",t,i,o,r),rn(t)||(Sc(this,Ic)&&uc(t,{coords:i,selection:this.hot.selection,controller:r,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseOver",t,i,o),this.activeWt=this._wt)},onCellMouseUp:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=n,this.hot.runHooks("beforeOnCellMouseUp",t,i,o),rn(t)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",t,i,o),this.activeWt=this._wt)},onCellCornerMouseDown:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:(t,e)=>this.beforeRender(t,e),onDraw:t=>this.afterRender(t),onBeforeViewportScrollVertically:t=>{const e=this.hot.rowIndexMapper,o=t<0;let n=t;return o||(n=e.getVisualFromRenderableIndex(t),null!==n)?(n=this.hot.runHooks("beforeViewportScrollVertically",n),this.hot.runHooks("beforeViewportScroll"),o?n:e.getRenderableFromVisualIndex(n)):t},onBeforeViewportScrollHorizontally:t=>{const e=this.hot.columnIndexMapper,o=t<0;let n=t;return o||(n=e.getVisualFromRenderableIndex(t),null!==n)?(n=this.hot.runHooks("beforeViewportScrollHorizontally",n),this.hot.runHooks("beforeViewportScroll"),o?n:e.getRenderableFromVisualIndex(n)):t},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(t,e,o)=>{const n=this.hot.rowIndexMapper,i=t<0;let r=t;i||(r=n.getVisualFromRenderableIndex(t));const s=this.hot.runHooks("beforeHighlightingRowHeader",r,e,o);return i?s:n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(t,e,o)=>{const n=this.hot.columnIndexMapper,i=t<0;let r=t;i||(r=n.getVisualFromRenderableIndex(t));const s=this.hot.runHooks("beforeHighlightingColumnHeader",r,e,o);return i?s:n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(t,e,o)=>{let n;const[i,r]=this.translateFromRenderableToVisualIndex(t,e),s=this.hot.selection.getSelectedRange(),l=s.size();if(l>0){const t=s.peekByIndex(null!==o&&void 0!==o?o:0);n=[t.from.row,t.from.col,t.to.row,t.to.col]}return this.hot.runHooks("afterDrawSelection",i,r,n,o)},onBeforeDrawBorders:(t,e)=>{const[o,n,i,r]=t,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)];return this.hot.runHooks("beforeDrawBorders",s,e)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(t,e)=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.runHooks("beforeStretchingColumnWidth",t,o)},onModifyRowHeaderWidth:t=>this.hot.runHooks("modifyRowHeaderWidth",t),onModifyGetCellCoords:(t,e,o)=>{const n=this.hot.rowIndexMapper,i=this.hot.columnIndexMapper,r=e>=0?i.getVisualFromRenderableIndex(e):e,s=t>=0?n.getVisualFromRenderableIndex(t):t,l=this.hot.runHooks("modifyGetCellCoords",s,r,o);if(Array.isArray(l)){const[t,e,o,r]=l;return[t>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(t,1)):t,e>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,1)):e,o>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1)):o,r>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1)):r]}},viewportRowCalculatorOverride:t=>{let e=this.settings.viewportRowRenderingOffset;if("auto"===e&&this.settings.fixedRowsTop&&(e=10),e>0||"auto"===e){const o=this.countRenderableRows(),n=t.startRow,i=t.endRow;if("number"===typeof e)t.startRow=Math.max(n-e,0),t.endRow=Math.min(i+e,o-1);else if("auto"===e){const e=Math.ceil(i/o*12);t.startRow=Math.max(n-e,0),t.endRow=Math.min(i+e,o-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:t=>{let e=this.settings.viewportColumnRenderingOffset;if("auto"===e&&this.settings.fixedColumnsStart&&(e=10),e>0||"auto"===e){const o=this.countRenderableColumns(),n=t.startColumn,i=t.endColumn;if("number"===typeof e&&(t.startColumn=Math.max(n-e,0),t.endColumn=Math.min(i+e,o-1)),"auto"===e){const e=Math.ceil(i/o*6);t.startColumn=Math.max(n-e,0),t.endColumn=Math.min(i+e,o-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const t=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||t}};this.hot.runHooks("beforeInitWalkontable",t),this._wt=new lc(t),this.activeWt=this._wt;const e=this._wt.wtTable.spreader,{width:o,height:n}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(o,n),this.eventManager.addEventListener(e,"mousedown",(t=>{t.target===e&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(e,"contextmenu",(t=>{t.target===e&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(t){if(Qe(t))return!0;const e=se(t,this.hot.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return Sc(this,Ic)}isSelectedOnlyCell(){var t,e;return null!==(t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingleCell())&&void 0!==t&&t}isCellEdited(){const t=this.hot.getActiveEditor();return t&&t.isOpened()}beforeRender(t,e){t&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,e)}afterRender(t){t&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(t,e){if(e.firstChild){const o=e.firstChild;if(!ue(o,"relative"))return we(e),void this.appendRowHeader(t,e);this.updateCellHeader(o.querySelector(".rowHeader"),t,this.hot.getRowHeader)}else{const{rootDocument:o,getRowHeader:n}=this.hot,i=o.createElement("div"),r=o.createElement("span");i.className="relative",r.className="rowHeader",this.updateCellHeader(r,t,n),i.appendChild(r),e.appendChild(i)}this.hot.runHooks("afterGetRowHeader",t,e)}appendColHeader(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){const i=e.firstChild;ue(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),t,o,n):(we(e),this.appendColHeader(t,e,o,n))}else{const{rootDocument:i}=this.hot,r=i.createElement("div"),s=i.createElement("span");r.className="relative",s.className="colHeader",this.updateCellHeader(s,t,o,n),r.appendChild(s),e.appendChild(r)}this.hot.runHooks("afterGetColHeader",t,e,n)}updateCellHeader(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e;const r=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&(ue(t,"colHeader")?i=r.wtTable.columnFilter.sourceToRendered(e):ue(t,"rowHeader")&&(i=r.wtTable.rowFilter.sourceToRendered(e))),i>-1?Ce(t,o(e,n)):(ye(t,String.fromCharCode(160)),de(t,"cornerHeader"))}maximumVisibleElementWidth(t){const e=this._wt.wtViewport.getWorkspaceWidth(),o=e-t;return o>0?o:0}maximumVisibleElementHeight(t){const e=this._wt.wtViewport.getWorkspaceHeight(),o=e-t;return o>0?o:0}setLastSize(t,e){Ec(this,Oc,t),Ec(this,Pc,e)}getLastSize(){return{width:Sc(this,Oc),height:Sc(this,Pc)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return Sc(this,Hc)}getRowHeadersCount(){return Sc(this,xc)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}var _c=Nc;const Lc="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Dc=Lc.length;function Wc(t){let e,o=t+1,n="";while(o>0)e=(o-1)%Dc,n=String.fromCharCode(65+e)+n,o=parseInt((o-e)/Dc,10);return n}function Vc(t){let e=0;if(t)for(let o=0,n=t.length-1;o<t.length;o+=1,n-=1)e+=Dc**n*(Lc.indexOf(t[o])+1);return e-=1,e}function Fc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const o=[];let n,i;for(n=0;n<t;n++){const t=[];for(i=0;i<e;i++)t.push(Wc(i)+(n+1));o.push(t)}return o}function jc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const o=[];let n,i;for(n=0;n<t;n++){const t={};for(i=0;i<e;i++)t[`prop${i}`]=Wc(i)+(n+1);o.push(t)}return o}function Bc(t,e){const o=[];let n;for(let i=0;i<t;i++){n=[];for(let t=0;t<e;t++)n.push("");o.push(n)}return o}function zc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t;const n=[];return Array.isArray(t)&&Array.isArray(t[0])||(o=[t]),o.forEach(((t,o)=>{Array.isArray(t)?t.forEach(((t,i)=>{n.push([o+e,i,t])})):Object.keys(t).forEach((i=>{n.push([o+e,i,t[i]])}))})),n}function Uc(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Eo(t[0])&&(e=ko(t[0]))),e}function $c(t){return!!(Array.isArray(t)&&t.length&&t.every((t=>Array.isArray(t))))}function Gc(t){return!!(Array.isArray(t)&&t.length&&t.every((t=>"object"===typeof t&&!Array.isArray(t)&&null!==t)))}function Yc(t,e,o){return e=Kc(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Kc(t){var e=Xc(t,"string");return"symbol"===typeof e?e:String(e)}function Xc(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class qc{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Yc(this,"hot",void 0),Yc(this,"data",void 0),Yc(this,"dataType","array"),Yc(this,"colToProp",(()=>{})),Yc(this,"propToCol",(()=>{})),this.hot=t,this.data=e}modifyRowData(t){let e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}getData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}setData(t){this.data=t}getAtColumn(t){const e=[];return A(this.data,((o,n)=>{const i=this.getAtCell(n,t);e.push(i)})),e}getAtRow(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=void 0===e&&void 0===o;let r=null,s=null;if(r=this.modifyRowData(t),Array.isArray(r))s=[],i?r.forEach(((e,o)=>{s[o]=this.getAtPhysicalCell(t,o,r)})):Pi(e,o,(o=>{s[o-e]=this.getAtPhysicalCell(t,o,r)}));else if(Eo(r)||so(r))if(s=n?[]:{},!i||n){const i=0,l=this.countFirstRowKeys()-1;Pi(i,l,(a=>{const h=this.colToProp(a);if(a>=(e||i)&&a<=(o||l)&&!Number.isInteger(h)){const e=this.getAtPhysicalCell(t,h,r);n?s.push(e):xo(s,h,e)}}))}else Mo(r,((e,o)=>{xo(s,o,this.getAtPhysicalCell(t,o,r))}));return s}setAtCell(t,e,o){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const n=Io(o);this.hot.runHooks("modifySourceData",t,e,n,"set"),n.isTouched()&&(o=n.value)}Number.isInteger(e)?this.data[t][e]=o:xo(this.data[t],e,o)}}getAtPhysicalCell(t,e,o){let n=null;if(o&&(n="string"===typeof e?Ho(o,e):"function"===typeof e?e(o):o[e]),this.hot.hasHook("modifySourceData")){const o=Io(n);this.hot.runHooks("modifySourceData",t,e,o,"get"),o.isTouched()&&(n=o.value)}return n}getAtCell(t,e){const o=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),o)}getByRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,i=null,r=null,s=null,l=null;null===t||null===e?(n=!0,i=0,s=this.countRows()-1):(i=Math.min(t.row,e.row),r=Math.min(t.col,e.col),s=Math.max(t.row,e.row),l=Math.max(t.col,e.col));const a=[];return Pi(i,s,(t=>{a.push(n?this.getAtRow(t,void 0,void 0,o):this.getAtRow(t,r,l,o))})),a}countRows(){if(this.hot.hasHook("modifySourceLength")){const t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}countFirstRowKeys(){return Uc(this.data)}destroy(){this.data=null,this.hot=null}}var Qc=qc;const Jc="localHooks",Zc={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,o,n,i,r,s){if(this._localHooks[t]){const l=this._localHooks[t].length;for(let a=0;a<l;a++)mo(this._localHooks[t][a],this,e,o,n,i,r,s)}},clearLocalHooks(){return this._localHooks={},this}};To(Zc,"MIXIN_NAME",Jc,{writable:!1,enumerable:!1});var tu=Zc;function eu(t,e,o){return e=ou(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ou(t){var e=nu(t,"string");return"symbol"===typeof e?e:String(e)}function nu(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class iu{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;eu(this,"indexedValues",[]),eu(this,"initValueOrFn",void 0),this.initValueOrFn=t}getValues(){return this.indexedValues}getValueAtIndex(t){const e=this.indexedValues;if(t<e.length)return e[t]}setValues(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}setValueAtIndex(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,so(this.initValueOrFn)?Pi(t-1,(t=>this.indexedValues.push(this.initValueOrFn(t)))):Pi(t-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function ru(t,e,o){return[...t.slice(0,e),...o,...t.slice(e)]}function su(t,e){return k(t,(t=>!1===e.includes(t)))}function lu(t,e){return I(t,(t=>t-e.filter((e=>e<t)).length))}function au(t,e){const o=e[0],n=e.length;return I(t,(t=>t>=o?t+n:t))}So(iu,tu);class hu extends iu{constructor(){super((t=>t))}insert(t,e){const o=au(this.indexedValues,e);this.indexedValues=ru(o,t,e),super.insert(t,e)}remove(t){const e=su(this.indexedValues,t);this.indexedValues=lu(e,t),super.remove(t)}}function cu(t,e,o,n){const i=o.length?o[0]:void 0;return[...t.slice(0,i),...o.map(((t,e)=>so(n)?n(t,e):n)),...void 0===i?[]:t.slice(i)]}function uu(t,e){return k(t,((t,o)=>!1===e.includes(o)))}class du extends iu{insert(t,e){this.indexedValues=cu(this.indexedValues,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){this.indexedValues=uu(this.indexedValues,t),super.remove(t)}}class gu extends du{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getHiddenIndexes(){return x(this.getValues(),((t,e,o)=>(e&&t.push(o),t)),[])}}function fu(t,e,o){return e=mu(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function mu(t){var e=pu(t,"string");return"symbol"===typeof e?e:String(e)}function pu(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class wu extends iu{constructor(){super(...arguments),fu(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map((t=>this.indexedValues[t]))}setValues(t){this.orderOfIndexes=[...Array(t.length).keys()],super.setValues(t)}setValueAtIndex(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(o,0,t),this.runLocalHooks("change"),!0)}clearValue(t){this.orderOfIndexes=su(this.orderOfIndexes,[t]),so(this.initValueOrFn)?super.setValueAtIndex(t,this.initValueOrFn(t)):super.setValueAtIndex(t,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(t)}insert(t,e){this.indexedValues=cu(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=au(this.orderOfIndexes,e),super.insert(t,e)}remove(t){this.indexedValues=uu(this.indexedValues,t),this.orderOfIndexes=su(this.orderOfIndexes,t),this.orderOfIndexes=lu(this.orderOfIndexes,t),super.remove(t)}getEntries(){return this.orderOfIndexes.map((t=>[t,this.getValueAtIndex(t)]))}}class vu extends du{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getTrimmedIndexes(){return x(this.getValues(),((t,e,o)=>(e&&t.push(o),t)),[])}}const Cu=new Map([["hiding",gu],["index",iu],["linkedPhysicalIndexToValue",wu],["physicalIndexToValue",du],["trimming",vu]]);function yu(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Cu.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(Cu.get(t))(e)}function bu(t,e,o){return e=Su(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Su(t){var e=Ru(t,"string");return"symbol"===typeof e?e:String(e)}function Ru(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}let Eu=0;class Tu{constructor(){bu(this,"collection",new Map)}register(t,e){!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",(()=>this.runLocalHooks("change",e))),Eu+=1)}unregister(t){const e=this.collection.get(t);U(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),Eu-=1)}unregisterAll(){this.collection.forEach(((t,e)=>this.unregister(e))),this.collection.clear()}get(t){return $(t)?Array.from(this.collection.values()):this.collection.get(t)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach((e=>{e.remove(t)}))}insertToEvery(t,e){this.collection.forEach((o=>{o.insert(t,e)}))}initEvery(t){this.collection.forEach((e=>{e.init(t)}))}}function Mu(){return Eu}function Hu(t,e,o){return e=xu(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function xu(t){var e=ku(t,"string");return"symbol"===typeof e?e:String(e)}function ku(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}So(Tu,tu);class Iu extends Tu{constructor(t,e){super(),Hu(this,"mergedValuesCache",[]),Hu(this,"aggregationFunction",void 0),Hu(this,"fallbackValue",void 0),this.aggregationFunction=t,this.fallbackValue=e}getMergedValues(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.mergedValuesCache;if(0===this.getLength())return[];const e=I(this.get(),(t=>t.getValues())),o=[],n=U(e[0])&&e[0].length||0;for(let i=0;i<n;i+=1){const t=[];for(let o=0;o<this.getLength();o+=1)t.push(e[o][i]);o.push(t)}return I(o,this.aggregationFunction)}getMergedValueAtIndex(t,e){const o=this.getMergedValues(e)[t];return U(o)?o:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Au(t,e,o){Ou(t,e),e.set(t,o)}function Ou(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pu(t,e,o){var n=Lu(t,e,"set");return Nu(t,n,o),o}function Nu(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function _u(t,e){var o=Lu(t,e,"get");return Du(t,o)}function Lu(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Du(t,e){return e.get?e.get.call(t):e.value}var Wu=new WeakMap;class Vu{constructor(){Au(this,Wu,{writable:!0,value:[]})}subscribe(t){return this.addLocalHook("change",t),this._write(_u(this,Wu)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(t){return t.length>0&&this.runLocalHooks("change",t),this}_writeInitialChanges(t){Pu(this,Wu,t)}}function Fu(t,e){const o=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&o.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)o.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)o.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return o}function ju(t,e,o){Bu(t,e),e.set(t,o)}function Bu(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zu(t,e){var o=Gu(t,e,"get");return Uu(t,o)}function Uu(t,e){return e.get?e.get.call(t):e.value}function $u(t,e,o){var n=Gu(t,e,"set");return Yu(t,n,o),o}function Gu(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Yu(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}So(Vu,tu);var Ku=new WeakMap,Xu=new WeakMap,qu=new WeakMap,Qu=new WeakMap,Ju=new WeakMap;class Zu{constructor(){let{initialIndexValue:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ju(this,Ku,{writable:!0,value:new Set}),ju(this,Xu,{writable:!0,value:[]}),ju(this,qu,{writable:!0,value:[]}),ju(this,Qu,{writable:!0,value:!1}),ju(this,Ju,{writable:!0,value:!1}),$u(this,Ju,null!==t&&void 0!==t&&t)}createObserver(){const t=new Vu;return zu(this,Ku).add(t),t.addLocalHook("unsubscribe",(()=>{zu(this,Ku).delete(t)})),t._writeInitialChanges(Fu(zu(this,Xu),zu(this,qu))),t}emit(t){let e=zu(this,qu);zu(this,Qu)&&zu(this,Xu).length===t.length||(0===t.length?t=new Array(e.length).fill(zu(this,Ju)):$u(this,Xu,new Array(t.length).fill(zu(this,Ju))),zu(this,Qu)||($u(this,Qu,!0),e=zu(this,Xu)));const o=Fu(e,t);zu(this,Ku).forEach((t=>t._write(o))),$u(this,qu,t)}}function td(t,e,o){return e=ed(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ed(t){var e=od(t,"string");return"symbol"===typeof e?e:String(e)}function od(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}new Set;class nd{constructor(){td(this,"indexesSequence",new hu),td(this,"trimmingMapsCollection",new Iu((t=>t.some((t=>!0===t))),!1)),td(this,"hidingMapsCollection",new Iu((t=>t.some((t=>!0===t))),!1)),td(this,"variousMapsCollection",new Tu),td(this,"hidingChangesObservable",new Zu({initialIndexValue:!1})),td(this,"notTrimmedIndexesCache",[]),td(this,"notHiddenIndexesCache",[]),td(this,"isBatched",!1),td(this,"indexesSequenceChanged",!1),td(this,"indexesChangeSource",void 0),td(this,"trimmedIndexesChanged",!1),td(this,"hiddenIndexesChanged",!1),td(this,"renderablePhysicalIndexesCache",[]),td(this,"fromPhysicalToVisualIndexesCache",new Map),td(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(t=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(t=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(t=>{this.runLocalHooks("change",t,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(t){if("hiding"!==t)throw new Error(`Unsupported index map type "${t}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(t,e,o){return this.registerMap(t,yu(e,o))}registerMap(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error(`Map with name "${t}" has been already registered.`);e instanceof vu?this.trimmingMapsCollection.register(t,e):e instanceof gu?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);const o=this.getNumberOfIndexes();return o>0&&e.init(o),e}unregisterMap(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(t){const e=this.notTrimmedIndexesCache[t];return U(e)?e:null}getPhysicalFromRenderableIndex(t){const e=this.renderablePhysicalIndexesCache[t];return U(e)?e:null}getVisualFromPhysicalIndex(t){const e=this.fromPhysicalToVisualIndexesCache.get(t);return U(e)?e:null}getVisualFromRenderableIndex(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}getRenderableFromVisualIndex(t){const e=this.fromVisualToRenderableIndexesCache.get(t);return U(e)?e:null}getNearestNotHiddenIndex(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.getPhysicalFromVisualIndex(t);if(null===n)return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;const i=Array.from(this.fromVisualToRenderableIndexesCache.keys());let r=-1;return r=e>0?i.findIndex((e=>e>t)):i.reverse().findIndex((e=>e<t)),-1===r?o?this.getNearestNotHiddenIndex(t,-e,!1):null:i[r]}initToLength(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(t).keys()],this.notHiddenIndexesCache=[...new Array(t).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){const e=this.getNumberOfIndexes();if(t<e){const e=[...Array(this.getNumberOfIndexes()-t).keys()].map((e=>e+t));this.removeIndexes(e)}else this.insertIndexes(e,t-e)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;const e=this.getIndexesSequence();return e.filter((t=>!1===this.isTrimmed(t)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notHiddenIndexesCache;const e=this.getIndexesSequence();return e.filter((t=>!1===this.isHidden(t)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;const e=this.getNotTrimmedIndexes();return e.filter((t=>!1===this.isHidden(t)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(t,e){"number"===typeof t&&(t=[t]);const o=I(t,(t=>this.getPhysicalFromVisualIndex(t))),n=this.getNotTrimmedIndexesLength(),i=t.length,r=su(this.getIndexesSequence(),o),s=r.filter((t=>!1===this.isTrimmed(t)));let l=r.indexOf(s[s.length-1])+1;if(e+i<n){const t=s[e];l=r.indexOf(t)}this.indexesChangeSource="move",this.setIndexesSequence(ru(r,l,o)),this.indexesChangeSource=void 0}isTrimmed(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}isHidden(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}insertIndexes(t,e){const o=this.getNotTrimmedIndexes()[t],n=U(o)?o:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),r=I(new Array(e).fill(n),((t,e)=>t+e));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,r),this.hidingMapsCollection.insertToEvery(i,r),this.variousMapsCollection.insertToEvery(i,r),this.resumeOperations()}removeIndexes(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}updateCache(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(t,e)}}cacheFromVisualToRenderableIndexes(){const t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromRenderableIndex(e),o=this.getVisualFromPhysicalIndex(t);this.fromVisualToRenderableIndexesCache.set(o,e)}}}function id(t,e){return Mo(e,((e,o)=>{$(t[o])&&(t[o]=e)})),t}function rd(t){const e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,o=e.exec(t);return o?`${o[1].toLowerCase()}-${o[2].toUpperCase()}`:t}function sd(t){U(t)&&cn(B`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function ld(t,e){const o=Array.isArray(t)&&Number.isInteger(e);return o?t[e]:t}So(nd,tu);const{register:ad,getValues:hd}=Rn("phraseFormatters");function cd(t,e){ad(t,e)}function ud(){return hd()}cd("pluralize",ld);const dd="ContextMenu:items",gd=dd,fd=`${gd}.noItems`,md=`${gd}.insertRowAbove`,pd=`${gd}.insertRowBelow`,wd=`${gd}.insertColumnOnTheLeft`,vd=`${gd}.insertColumnOnTheRight`,Cd=`${gd}.removeRow`,yd=`${gd}.removeColumn`,bd=`${gd}.undo`,Sd=`${gd}.redo`,Rd=`${gd}.readOnly`,Ed=`${gd}.clearColumn`,Td=`${gd}.copy`,Md=`${gd}.copyWithHeaders`,Hd=`${gd}.copyWithGroupHeaders`,xd=`${gd}.copyHeadersOnly`,kd=`${gd}.cut`,Id=`${gd}.freezeColumn`,Ad=`${gd}.unfreezeColumn`,Od=`${gd}.mergeCells`,Pd=`${gd}.unmergeCells`,Nd=`${gd}.addComment`,_d=`${gd}.editComment`,Ld=`${gd}.removeComment`,Dd=`${gd}.readOnlyComment`,Wd=`${gd}.align`,Vd=`${gd}.align.left`,Fd=`${gd}.align.center`,jd=`${gd}.align.right`,Bd=`${gd}.align.justify`,zd=`${gd}.align.top`,Ud=`${gd}.align.middle`,$d=`${gd}.align.bottom`,Gd=`${gd}.borders`,Yd=`${gd}.borders.top`,Kd=`${gd}.borders.right`,Xd=`${gd}.borders.bottom`,qd=`${gd}.borders.left`,Qd=`${gd}.borders.remove`,Jd=`${gd}.nestedHeaders.insertChildRow`,Zd=`${gd}.nestedHeaders.detachFromParent`,tg=`${gd}.hideColumn`,eg=`${gd}.showColumn`,og=`${gd}.hideRow`,ng=`${gd}.showRow`,ig="Filters:",rg=`${ig}conditions`,sg=`${rg}.none`,lg=`${rg}.isEmpty`,ag=`${rg}.isNotEmpty`,hg=`${rg}.isEqualTo`,cg=`${rg}.isNotEqualTo`,ug=`${rg}.beginsWith`,dg=`${rg}.endsWith`,gg=`${rg}.contains`,fg=`${rg}.doesNotContain`,mg=`${rg}.byValue`,pg=`${rg}.greaterThan`,wg=`${rg}.greaterThanOrEqualTo`,vg=`${rg}.lessThan`,Cg=`${rg}.lessThanOrEqualTo`,yg=`${rg}.isBetween`,bg=`${rg}.isNotBetween`,Sg=`${rg}.after`,Rg=`${rg}.before`,Eg=`${rg}.today`,Tg=`${rg}.tomorrow`,Mg=`${rg}.yesterday`,Hg=`${ig}labels.filterByCondition`,xg=`${ig}labels.filterByValue`,kg=`${ig}labels.conjunction`,Ig=`${ig}labels.disjunction`,Ag=`${ig}values.blankCells`,Og=`${ig}buttons.selectAll`,Pg=`${ig}buttons.clear`,Ng=`${ig}buttons.ok`,_g=`${ig}buttons.cancel`,Lg=`${ig}buttons.placeholder.search`,Dg=`${ig}buttons.placeholder.value`,Wg=`${ig}buttons.placeholder.secondValue`,Vg="CheckboxRenderer:",Fg=`${Vg}checked`,jg=`${Vg}unchecked`,Bg="ColumnHeader:",zg=`${Bg}description.expandColumn`,Ug=`${Bg}description.collapseColumn`,$g=`${Bg}description.sortRows`,Gg=`${Bg}label.multiColumnSortOrder`,Yg=`${Bg}label.openMenu`,Kg=`${Bg}label.beforeHiddenColumn`,Xg=`${Bg}label.afterHiddenColumn`,qg="RowHeader:",Qg=`${qg}description.expandRow`,Jg=`${qg}description.collapseRow`,Zg=`${qg}label.beforeHiddenRow`,tf=`${qg}label.afterHiddenRow`,ef={languageCode:"en-US",[fd]:"No available options",[md]:"Insert row above",[pd]:"Insert row below",[wd]:"Insert column left",[vd]:"Insert column right",[Cd]:["Remove row","Remove rows"],[yd]:["Remove column","Remove columns"],[bd]:"Undo",[Sd]:"Redo",[Rd]:"Read only",[Ed]:"Clear column",[Wd]:"Alignment",[Vd]:"Left",[Fd]:"Center",[jd]:"Right",[Bd]:"Justify",[zd]:"Top",[Ud]:"Middle",[$d]:"Bottom",[Id]:"Freeze column",[Ad]:"Unfreeze column",[Gd]:"Borders",[Yd]:"Top",[Kd]:"Right",[Xd]:"Bottom",[qd]:"Left",[Qd]:"Remove border(s)",[Nd]:"Add comment",[_d]:"Edit comment",[Ld]:"Delete comment",[Dd]:"Read-only comment",[Od]:"Merge cells",[Pd]:"Unmerge cells",[Td]:"Copy",[Md]:["Copy with header","Copy with headers"],[Hd]:["Copy with group header","Copy with group headers"],[xd]:["Copy header only","Copy headers only"],[kd]:"Cut",[Jd]:"Insert child row",[Zd]:"Detach from parent",[tg]:["Hide column","Hide columns"],[eg]:["Show column","Show columns"],[og]:["Hide row","Hide rows"],[ng]:["Show row","Show rows"],[sg]:"None",[lg]:"Is empty",[ag]:"Is not empty",[hg]:"Is equal to",[cg]:"Is not equal to",[ug]:"Begins with",[dg]:"Ends with",[gg]:"Contains",[fg]:"Does not contain",[pg]:"Greater than",[wg]:"Greater than or equal to",[vg]:"Less than",[Cg]:"Less than or equal to",[yg]:"Is between",[bg]:"Is not between",[Sg]:"After",[Rg]:"Before",[Eg]:"Today",[Tg]:"Tomorrow",[Mg]:"Yesterday",[Ag]:"Blank cells",[Hg]:"Filter by condition",[xg]:"Filter by value",[kg]:"And",[Ig]:"Or",[Og]:"Select all",[Pg]:"Clear",[Ng]:"OK",[_g]:"Cancel",[Lg]:"Search",[Dg]:"Value",[Wg]:"Second value",[Fg]:"Checked",[jg]:"Unchecked",[zg]:"Press ENTER to expand column.",[Ug]:"Press ENTER to collapse column.",[$g]:"Press ENTER to change sorting.",[Gg]:"Multi-column sorting order:",[Yg]:"Press CTRL/CMD+ENTER to open menu.",[Kg]:"The next column is hidden.",[Xg]:"The previous column is hidden.",[Qg]:"Press ENTER to expand row.",[Jg]:"Press ENTER to collapse row.",[Zg]:"The next row is hidden.",[tf]:"The previous row is hidden."};var of=ef;const nf=p,rf=of.languageCode,{register:sf,getItem:lf,hasItem:af,getValues:hf}=Rn("languagesDictionaries");function cf(t,e){let o=t,n=e;return Eo(t)&&(n=t,o=n.languageCode),uf(o,n),sf(o,yo(n)),yo(n)}function uf(t,e){t!==rf&&id(e,lf(rf))}function df(t){return gf(t)?yo(lf(t)):null}function gf(t){return af(t)}function ff(){return hf()}function mf(t,e,o){const n=df(t);if(null===n)return null;const i=n[e];if($(i))return null;const r=pf(i,o);return Array.isArray(r)?r[0]:r}function pf(t,e){let o=t;return A(ud(),(n=>{o=n(t,e)})),o}function wf(t){let e=rd(t);return gf(e)||(e=rf,sd(t)),e}cf(of);const vf="active-header",Cf="header",yf="area",bf="focus",Sf="fill",Rf="row",Ef="column",Tf="custom-selection";class Mf{constructor(t,e){this.settings=t,this.cellRange=e||null}isEmpty(){return null===this.cellRange}add(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}replace(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}destroy(){this.runLocalHooks("destroy")}}So(Mf,tu);var Hf=Mf;function xf(t,e,o){return e=kf(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function kf(t){var e=If(t,"string");return"symbol"===typeof e?e:String(e)}function If(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Af extends Hf{constructor(t,e){super(t,null),xf(this,"visualCellRange",null),this.visualCellRange=e||null,this.commit()}add(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(t){let{from:e,to:o}=t,n=this.getNearestNotHiddenCoords(e,1),i=this.getNearestNotHiddenCoords(o,-1);return null===n||null===i?null:((n.row>i.row||n.col>i.col)&&(n=e,i=o),this.settings.createCellRange(n,n,i))}getNearestNotHiddenCoords(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const n=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,t.row,e);if(null===n)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,t.col,o);return null===i?null:this.settings.createCellCoords(n,i)}getNearestNotHiddenIndex(t,e,o){return e<0?e:t.getNearestNotHiddenIndex(e,o)}commit(){if(null===this.visualCellRange)return this;const t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===t?null:this.createRenderableCellRange(t.from,t.to),this}syncWith(t){const e=t.from.clone().normalize(),o="N-S"===t.getVerticalDirection()?1:-1,n="W-E"===t.getHorizontalDirection()?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let r=null;if(null!==i&&null!==i.col&&null!==i.row||(r=this.getNearestNotHiddenCoords(e,o,n)),null!==r&&t.overlaps(r)){const e=t.highlight.clone();if(e.row>=0&&(e.row=r.row),e.col>=0&&(e.col=r.col),null===this.cellRange){const t=this.settings.visualToRenderableCoords(e);this.cellRange=this.settings.createCellRange(t)}t.setHighlight(e)}return"focus"===this.settings.selectionType&&null!==i&&null===r&&t.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:t,to:e}=this.cellRange;return[Math.min(t.row,e.row),Math.min(t.col,e.col),Math.max(t.row,e.row),Math.max(t.col,e.col)]}getVisualCorners(){const t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}createRenderableCellRange(t,e){const o=this.settings.visualToRenderableCoords(t),n=this.settings.visualToRenderableCoords(e);return null===o.row||null===o.col||null===n.row||null===n.col?null:this.settings.createCellRange(o,o,n)}}var Of=Af;function Pf(t){let{activeHeaderClassName:e,...o}=t;return new Of({className:e,...o,selectionType:vf})}function Nf(t){let{areaCornerVisible:e,...o}=t;return new Of({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...o,selectionType:yf})}function _f(t){let{...e}=t;return new Of({className:"highlight",...e,selectionType:yf})}function Lf(t){let{columnClassName:e,...o}=t;return new Of({className:e,...o,selectionType:Ef})}function Df(t){let{cellCornerVisible:e,...o}=t;return new Of({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...o,selectionType:bf})}function Wf(t){let{border:e,visualCellRange:o,...n}=t;return new Of({...e,...n,selectionType:Tf},o)}function Vf(t){let{...e}=t;return new Of({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:Sf})}function Ff(t){let{headerClassName:e,...o}=t;return new Of({className:e,...o,selectionType:Cf})}function jf(t){let{rowClassName:e,...o}=t;return new Of({className:e,...o,selectionType:Rf})}let Bf;function zf(t,e){Uf(t,e),e.add(t)}function Uf(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $f(t,e,o){return e=Gf(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Gf(t){var e=Yf(t,"string");return"symbol"===typeof e?e:String(e)}function Yf(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Kf(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}var Xf=new WeakSet;Bf=Symbol.iterator;class qf{constructor(t){zf(this,Xf),$f(this,"options",void 0),$f(this,"layerLevel",0),$f(this,"focus",void 0),$f(this,"fill",void 0),$f(this,"layeredAreas",new Map),$f(this,"areas",new Map),$f(this,"rowHeaders",new Map),$f(this,"columnHeaders",new Map),$f(this,"activeRowHeaders",new Map),$f(this,"activeColumnHeaders",new Map),$f(this,"activeCornerHeaders",new Map),$f(this,"rowHighlights",new Map),$f(this,"columnHighlights",new Map),$f(this,"customSelections",[]),this.options=t,this.focus=Df(t),this.fill=Vf(t)}isEnabledFor(t,e){let o=t;t===bf&&(o="current");let n=this.options.disabledCellSelection(e.row,e.col);return"string"===typeof n&&(n=[n]),!1===n||Array.isArray(n)&&!n.includes(o)}useLayerLevel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Kf(this,Xf,Qf).call(this,this.layeredAreas,Nf)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Kf(this,Xf,Qf).call(this,this.areas,_f)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Kf(this,Xf,Qf).call(this,this.rowHeaders,Ff)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Kf(this,Xf,Qf).call(this,this.columnHeaders,Ff)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Kf(this,Xf,Qf).call(this,this.activeRowHeaders,Pf)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Kf(this,Xf,Qf).call(this,this.activeColumnHeaders,Pf)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Kf(this,Xf,Qf).call(this,this.activeCornerHeaders,Pf)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Kf(this,Xf,Qf).call(this,this.rowHighlights,jf)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Kf(this,Xf,Qf).call(this,this.columnHighlights,Lf)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(t){this.customSelections.push(Wf({...this.options,...t}))}clear(){this.focus.clear(),this.fill.clear(),A(this.areas.values(),(t=>{t.clear()})),A(this.layeredAreas.values(),(t=>{t.clear()})),A(this.rowHeaders.values(),(t=>{t.clear()})),A(this.columnHeaders.values(),(t=>{t.clear()})),A(this.activeRowHeaders.values(),(t=>{t.clear()})),A(this.activeColumnHeaders.values(),(t=>{t.clear()})),A(this.activeCornerHeaders.values(),(t=>{t.clear()})),A(this.rowHighlights.values(),(t=>{t.clear()})),A(this.columnHighlights.values(),(t=>{t.clear()}))}[Bf](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Qf(t,e){const o=this.layerLevel;if(t.has(o))return t.get(o);const n=e({layerLevel:o,...this.options});return t.set(o,n),n}var Jf=qf;let Zf;function tm(t,e,o){return e=em(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function em(t){var e=om(t,"string");return"symbol"===typeof e?e:String(e)}function om(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Zf=Symbol.iterator;class nm{constructor(t){tm(this,"ranges",[]),tm(this,"createCellRange",void 0),this.createCellRange=t}isEmpty(){return 0===this.size()}set(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}add(t){return this.ranges.push(this.createCellRange(t)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(t){return this.ranges.some((e=>e.includes(t)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Zf](){return this.ranges[Symbol.iterator]()}}var im=nm;function rm(t,e){lm(t,e),e.add(t)}function sm(t,e,o){lm(t,e),e.set(t,o)}function lm(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function am(t,e){var o=dm(t,e,"get");return hm(t,o)}function hm(t,e){return e.get?e.get.call(t):e.value}function cm(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function um(t,e,o){var n=dm(t,e,"set");return gm(t,n,o),o}function dm(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function gm(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var fm=new WeakMap,mm=new WeakMap,pm=new WeakMap,wm=new WeakSet,vm=new WeakSet,Cm=new WeakSet,ym=new WeakSet,bm=new WeakSet;class Sm{constructor(t,e){rm(this,bm),rm(this,ym),rm(this,Cm),rm(this,vm),rm(this,wm),sm(this,fm,{writable:!0,value:void 0}),sm(this,mm,{writable:!0,value:void 0}),sm(this,pm,{writable:!0,value:{x:0,y:0}}),um(this,fm,t),um(this,mm,e)}transformStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];cm(this,wm,Rm).call(this,{x:am(this,mm).navigableHeaders()?am(this,mm).countRowHeaders():0,y:am(this,mm).navigableHeaders()?am(this,mm).countColHeaders():0});const n=am(this,mm).createCellCoords(t,e);let i=am(this,fm).current().highlight;const r=am(this,mm).visualToRenderableCoords(i);let s=0,l=0;if(this.runLocalHooks("beforeTransformStart",n),null!==r.row&&null!==r.col){const{width:t,height:e}=cm(this,Cm,Tm).call(this),{row:r,col:a}=cm(this,ym,Mm).call(this,i),h=am(this,mm).fixedRowsBottom(),c=am(this,mm).minSpareRows(),u=am(this,mm).minSpareCols(),d=am(this,mm).autoWrapRow(),g=am(this,mm).autoWrapCol(),f=am(this,mm).createCellCoords(r+n.row,a+n.col);if(f.row>=e){const n=o&&c>0&&0===h,i=!n&&g,r=f.col+1,s=am(this,mm).createCellCoords(f.row-e,r>=t?r-t:r);this.runLocalHooks("beforeColumnWrap",i,cm(this,bm,Hm).call(this,s),r>=t),n?this.runLocalHooks("insertRowRequire",am(this,mm).countRenderableRows()):i&&f.assign(s)}else if(f.row<0){const o=f.col-1,n=am(this,mm).createCellCoords(e+f.row,o<0?t+o:o);this.runLocalHooks("beforeColumnWrap",g,cm(this,bm,Hm).call(this,n),o<0),g&&f.assign(n)}if(f.col>=t){const n=o&&u>0,i=!n&&d,r=f.row+1,s=am(this,mm).createCellCoords(r>=e?r-e:r,f.col-t);this.runLocalHooks("beforeRowWrap",i,cm(this,bm,Hm).call(this,s),r>=e),n?this.runLocalHooks("insertColRequire",am(this,mm).countRenderableColumns()):i&&f.assign(s)}else if(f.col<0){const o=f.row-1,n=am(this,mm).createCellCoords(o<0?e+o:o,t+f.col);this.runLocalHooks("beforeRowWrap",d,cm(this,bm,Hm).call(this,n),o<0),d&&f.assign(n)}const{rowDir:m,colDir:p}=cm(this,vm,Em).call(this,f);s=m,l=p,i=cm(this,bm,Hm).call(this,f)}return this.runLocalHooks("afterTransformStart",i,s,l),i}transformEnd(t,e){cm(this,wm,Rm).call(this,{x:am(this,mm).navigableHeaders()?am(this,mm).countRowHeaders():0,y:am(this,mm).navigableHeaders()?am(this,mm).countColHeaders():0});const o=am(this,mm).createCellCoords(t,e),n=am(this,fm).current(),i=am(this,mm).visualToRenderableCoords(n.highlight),r=n.to.clone();let s=0,l=0;if(this.runLocalHooks("beforeTransformEnd",o),null!==i.row&&null!==i.col){const{row:t,col:e}=cm(this,ym,Mm).call(this,n.to),i=am(this,mm).createCellCoords(t+o.row,e+o.col),{rowDir:a,colDir:h}=cm(this,vm,Em).call(this,i);s=a,l=h;const c=cm(this,bm,Hm).call(this,i);0===o.row&&0!==o.col?r.col=c.col:0!==o.row&&0===o.col?r.row=c.row:(r.row=c.row,r.col=c.col)}return this.runLocalHooks("afterTransformEnd",r,s,l),r}}function Rm(t){let{x:e,y:o}=t;um(this,pm,{x:e,y:o})}function Em(t){const{width:e,height:o}=cm(this,Cm,Tm).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=o&&(n=1,t.row=o-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function Tm(){return{width:am(this,pm).x+am(this,mm).countRenderableColumns(),height:am(this,pm).y+am(this,mm).countRenderableRows()}}function Mm(t){const{row:e,col:o}=am(this,mm).visualToRenderableCoords(t);return am(this,mm).createCellCoords(am(this,pm).y+e,am(this,pm).x+o)}function Hm(t){const e=t.clone();return e.col=t.col-am(this,pm).x,e.row=t.row-am(this,pm).y,am(this,mm).renderableToVisualCoords(e)}So(Sm,tu);var xm=Sm;const km=0,Im=1,Am=2,Om=3,Pm=[Om,Am],Nm=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],_m=Symbol("root"),Lm=Symbol("child");function Dm(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_m;if(e!==_m&&e!==Lm)throw new Error("The second argument is used internally only and cannot be overwritten.");const o=Array.isArray(t),n=e===_m;let i=km;if(o){const e=t[0];if(0===t.length)i=Im;else if(n&&e instanceof Yl)i=Om;else if(n&&Array.isArray(e))i=Dm(e,Lm);else if(t.length>=2&&t.length<=4){const e=!t.some(((t,e)=>!Nm[e].includes(typeof t)));e&&(i=Am)}}return i}function Wm(t){let{keepDirection:e=!1,propToCol:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Pm.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(n){const i=t===Om;let r=i?n.from.row:n[0],s=i?n.from.col:n[1],l=i?n.to.row:n[2],a=i?n.to.col:n[3];if("function"===typeof o&&("string"===typeof s&&(s=o(s)),"string"===typeof a&&(a=o(a))),$(l)&&(l=r),$(a)&&(a=s),!e){const t=r,e=s,o=l,n=a;r=Math.min(t,o),s=Math.min(e,n),l=Math.max(t,o),a=Math.max(e,n)}const h=new Nl(r,s),c=new Nl(l,a);return new Yl(h,h,c)}}function Vm(t){const e=Dm(t);if(e===km||e===Im)return[];const o=Wm(e),n=new Set;A(t,(t=>{const{from:e,to:i}=o(t),r=Math.max(e.col,0),s=i.col-r+1;A(Array.from(new Array(s),((t,e)=>r+e)),(t=>{n.has(t)||n.add(t)}))}));const i=Array.from(n).sort(((t,e)=>t-e)),r=x(i,((t,e,o,n)=>(0!==o&&e===n[o-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[]);return r}function Fm(t){const e=Dm(t);if(e===km||e===Im)return[];const o=Wm(e),n=new Set;A(t,(t=>{const{from:e,to:i}=o(t),r=Math.max(e.row,0),s=i.row-r+1;A(Array.from(new Array(s),((t,e)=>r+e)),(t=>{n.has(t)||n.add(t)}))}));const i=Array.from(n).sort(((t,e)=>t-e)),r=x(i,((t,e,o,n)=>(0!==o&&e===n[o-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[]);return r}function jm(t,e,o){Bm(t,e),e.set(t,o)}function Bm(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zm(t,e,o){return e=Um(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Um(t){var e=$m(t,"string");return"symbol"===typeof e?e:String(e)}function $m(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Gm(t,e,o){var n=Xm(t,e,"set");return Ym(t,n,o),o}function Ym(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function Km(t,e){var o=Xm(t,e,"get");return qm(t,o)}function Xm(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function qm(t,e){return e.get?e.get.call(t):e.value}var Qm=new WeakMap;class Jm{constructor(t,e){var o=this;zm(this,"settings",void 0),zm(this,"tableProps",void 0),zm(this,"inProgress",!1),zm(this,"selectedRange",new im(((t,e,o)=>this.tableProps.createCellRange(t,e,o)))),zm(this,"highlight",void 0),zm(this,"transformation",void 0),zm(this,"selectedByRowHeader",new Set),zm(this,"selectedByColumnHeader",new Set),jm(this,Qm,{writable:!0,value:!1}),this.settings=t,this.tableProps=e,this.highlight=new Jf({headerClassName:t.currentHeaderClassName,headerAttributes:[$t()],activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,cellAttributes:[$t()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(t,e)=>this.tableProps.isDisabledCellSelection(t,e),cellCornerVisible:function(){return o.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return o.isAreaCornerVisible(...arguments)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),createCellRange:(t,e,o)=>this.tableProps.createCellRange(t,e,o)}),this.transformation=new xm(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),navigableHeaders:()=>t.navigableHeaders,fixedRowsBottom:()=>t.fixedRowsBottom,minSpareRows:()=>t.minSpareRows,minSpareCols:()=>t.minSpareCols,autoWrapRow:()=>t.autoWrapRow,autoWrapCol:()=>t.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeModifyTransformStart",...e)})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("afterModifyTransformStart",...e)})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeModifyTransformEnd",...e)})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("afterModifyTransformEnd",...e)})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("insertRowRequire",...e)})),this.transformation.addLocalHook("insertColRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("insertColRequire",...e)})),this.transformation.addLocalHook("beforeRowWrap",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeRowWrap",...e)})),this.transformation.addLocalHook("beforeColumnWrap",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeColumnWrap",...e)}))}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;const i="multiple"===this.settings.selectionMode,r=$(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,s=t.clone();this.runLocalHooks("beforeSetRangeStart"+(o?"Only":""),s),(!i||i&&!r&&$(e))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(n.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),o||this.setRangeEnd(t)}setRangeStartOnly(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;this.setRangeStart(t,e,!0,o)}setRangeEnd(t){if(this.selectedRange.isEmpty())return;const e=t.clone(),o=this.tableProps.countRows(),n=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(t).isSingleHeader();if((o>0||n>0)&&(0===o&&e.col<0&&!i||0===n&&e.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",e),this.begin();const r=this.selectedRange.current();this.settings.navigableHeaders||r.highlight.normalize(),"single"===this.settings.selectionMode?(r.setFrom(r.highlight),r.setTo(r.highlight)):r.setTo(e),o>0&&n>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!r.isSingleHeader())&&r.to.normalize(),this.runLocalHooks("beforeHighlightSet");const s=this.highlight.getFocus();s.clear(),this.highlight.isEnabledFor(bf,r.highlight)&&s.add(this.selectedRange.current().highlight).commit().syncWith(r);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(A(this.highlight.getAreas(),(t=>{t.clear()})),A(this.highlight.getLayeredAreas(),(t=>{t.clear()})),A(this.highlight.getRowHeaders(),(t=>{t.clear()})),A(this.highlight.getColumnHeaders(),(t=>{t.clear()})),A(this.highlight.getActiveRowHeaders(),(t=>{t.clear()})),A(this.highlight.getActiveColumnHeaders(),(t=>{t.clear()})),A(this.highlight.getActiveCornerHeaders(),(t=>{t.clear()})),A(this.highlight.getRowHighlights(),(t=>{t.clear()})),A(this.highlight.getColumnHighlights(),(t=>{t.clear()}))),this.highlight.useLayerLevel(l);const a=this.highlight.createArea(),h=this.highlight.createLayeredArea(),c=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),f=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),p=this.highlight.createColumnHighlight();if(a.clear(),h.clear(),c.clear(),u.clear(),d.clear(),g.clear(),f.clear(),m.clear(),p.clear(),this.highlight.isEnabledFor(yf,r.highlight)&&(this.isMultiple()||l>=1)&&(a.add(r.from).add(r.to).commit(),h.add(r.from).add(r.to).commit(),1===l)){const t=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(t.from).commit().syncWith(t),this.highlight.createLayeredArea().add(t.from).commit().syncWith(t),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(Cf,r.highlight)){if(!r.isSingleHeader()){const t=this.tableProps.createCellCoords(Math.max(r.from.row,0),-1),e=this.tableProps.createCellCoords(r.to.row,-1),o=this.tableProps.createCellCoords(-1,Math.max(r.from.col,0)),n=this.tableProps.createCellCoords(-1,r.to.col);"single"===this.settings.selectionMode?(c.add(t).commit(),u.add(o).commit(),m.add(t).commit(),p.add(o).commit()):(c.add(t).add(e).commit(),u.add(o).add(n).commit(),m.add(t).add(e).commit(),p.add(o).add(n).commit())}const t=!Km(this,Qm)&&this.isEntireRowSelected()&&(n>0&&n===r.getWidth()||0===n&&this.isSelectedByRowHeader()),e=!Km(this,Qm)&&this.isEntireColumnSelected()&&(o>0&&o===r.getHeight()||0===o&&this.isSelectedByColumnHeader());t&&d.add(this.tableProps.createCellCoords(Math.max(r.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(r.to.row,0),-1)).commit(),e&&g.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(r.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(r.to.col,0))).commit(),t&&e&&f.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",t)}isMultiple(){const t=Io(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}transformStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(t,e,o))}transformEnd(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&(-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t))}isEntireRowSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{col:e}=t.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),n=this.tableProps.countCols();return(o>0&&e<0||0===o)&&t.getWidth()===n};if(-1===t)return Array.from(this.selectedRange).some((t=>e(t)));const o=this.selectedRange.peekByIndex(t);return!!o&&e(o)}isSelectedByColumnHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t))}isEntireColumnSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{row:e}=t.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),n=this.tableProps.countRows();return(o>0&&e<0||0===o)&&t.getHeight()===n};if(-1===t)return Array.from(this.selectedRange).some((t=>e(t)));const o=this.selectedRange.peekByIndex(t);return!!o&&e(o)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(t){return this.selectedRange.includes(t)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isAreaCornerVisible(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var t;let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),r=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),a=o?-l:0,h=e?-s:0;if(0===a&&0===h&&(0===i||0===r))return;let c=null===(t=this.getSelectedRange().current())||void 0===t?void 0:t.highlight;const{focusPosition:u,disableHeadersHighlight:d}=n;Gm(this,Qm,d),u&&Number.isInteger(null===u||void 0===u?void 0:u.row)&&Number.isInteger(null===u||void 0===u?void 0:u.col)&&(c=this.tableProps.createCellCoords(Li(u.row,a,i-1),Li(u.col,h,r-1)));const g=this.tableProps.createCellCoords(a,h),f=this.tableProps.createCellCoords(i-1,r-1);this.clear(),this.setRangeStartOnly(g,void 0,c),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),a<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.finish(),Gm(this,Qm,!1)}selectCells(t){const e=Dm(t);if(e===Im)return!1;if(e===km)throw new Error(B`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const o=Wm(e,{propToCol:t=>this.tableProps.propToCol(t),keepDirection:!0}),n=this.settings.navigableHeaders,i={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:n?this.tableProps.countRowHeaders():0,countColHeaders:n?this.tableProps.countColHeaders():0},r=!t.some((t=>{const e=o(t),n=e.isValid(i);return!(n&&!e.containsHeaders()||n&&e.containsHeaders()&&e.isSingleHeader())}));return r&&(this.clear(),A(t,(t=>{const{from:e,to:n}=o(t);this.setRangeStartOnly(e.clone(),!1),this.setRangeEnd(n.clone()),this.finish()}))),r}selectColumns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n="string"===typeof t?this.tableProps.propToCol(t):t,i="string"===typeof e?this.tableProps.propToCol(e):e,r=this.tableProps.countRows(),s=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),a=0===l?0:-l,h=new Nl(a,n),c=new Nl(r-1,i),u=new Yl(h,h,c).isValid({countRows:r,countCols:s,countRowHeaders:0,countColHeaders:l});if(u){const t=0===l?0:Li(o,a,-1),e=r-1,s=this.tableProps.createCellCoords(t,n),h=this.tableProps.createCellCoords(e,i),c=this.tableProps.createCellCoords(Li(o,a,r-1),n);this.runLocalHooks("beforeSelectColumns",s,h,c),s.row=t,h.row=e,this.setRangeStartOnly(s,void 0,c),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectColumns",s,h,c),this.finish()}return u}selectRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=this.tableProps.countRows(),i=this.tableProps.countCols(),r=this.tableProps.countRowHeaders(),s=0===r?0:-r,l=new Nl(t,s),a=new Nl(e,i-1),h=new Yl(l,l,a).isValid({countRows:n,countCols:i,countRowHeaders:r,countColHeaders:0});if(h){const n=0===r?0:Li(o,s,-1),l=i-1,a=this.tableProps.createCellCoords(t,n),h=this.tableProps.createCellCoords(e,l),c=this.tableProps.createCellCoords(t,Li(o,s,i-1));this.runLocalHooks("beforeSelectRows",a,h,c),a.col=n,h.col=l,this.setRangeStartOnly(a,void 0,c),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectRows",a,h,c),this.finish()}return h}refresh(){const t=this.highlight.getCustomSelections();if(t.forEach((t=>{t.commit()})),!this.isSelected())return;const e=this.highlight.getFocus(),o=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(let n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);const t=this.highlight.createArea(),e=this.highlight.createLayeredArea(),o=this.highlight.createRowHeader(),i=this.highlight.createColumnHeader(),r=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),l=this.highlight.createActiveCornerHeader(),a=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();t.commit(),e.commit(),o.commit(),i.commit(),r.commit(),s.commit(),l.commit(),a.commit(),h.commit()}this.highlight.useLayerLevel(o)}}So(Jm,tu);var Zm=Jm;const{register:tp,getItem:ep,hasItem:op,getNames:np,getValues:ip}=Rn("cellTypes");function rp(t){if(!op(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return ep(t)}function sp(t,e){"string"!==typeof t&&(e=t,t=e.CELL_TYPE);const{editor:o,renderer:n,validator:i}=e;o&&Pn(t,o),n&&ur(t,n),i&&vr(t,i),tp(t,e)}function lp(t,e){var o;return"CELL_TYPE"!==t&&((null===(o=e._automaticallyAssignedMetaProps)||void 0===o?void 0:o.has(t))||!Ao(e,t))}function ap(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const n="string"===typeof e.type?rp(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Mo(e,((e,o)=>{t._automaticallyAssignedMetaProps.delete(o)})),!Eo(n))return;o!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);const i={};Mo(n,((e,n)=>{var r;lp(n,o)&&(i[n]=e,null===(r=t._automaticallyAssignedMetaProps)||void 0===r||r.add(n))})),vo(t,i)}function hp(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function o(){}wo(o,t);for(let n=0;n<e.length;n++)o.prototype[e[n]]=void 0;return o}function cp(t){return Number.isInteger(t)&&t>=0}function up(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function dp(t){return null===t||void 0===t}var gp=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,o,n;for(e=0,o=this.countRows();e<o;e++)if(n=this.getDataAtCell(e,t),!1===G(n))return!1;return!0},isEmptyRow(t){let e,o,n,i;for(e=0,o=this.countCols();e<o;e++)if(n=this.getDataAtCell(t,e),!1===G(n))return"object"===typeof n&&(i=this.getCellMeta(t,e),Ro(this.getSchema()[i.prop],n));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,disableTabNavigation:!1,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function fp(t,e,o){return e=mp(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function mp(t){var e=pp(t,"string");return"symbol"===typeof e?e:String(e)}function pp(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function wp(){return class{}}class vp{constructor(t){fp(this,"metaCtor",wp()),fp(this,"meta",void 0),this.meta=this.metaCtor.prototype,vo(this.meta,gp()),this.meta.instance=t}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(t){var e;vo(this.meta,t),ap(this.meta,{...t,type:null!==(e=t.type)&&void 0!==e?e:this.meta.type},t)}}function Cp(t,e,o){return e=yp(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function yp(t){var e=bp(t,"string");return"symbol"===typeof e?e:String(e)}function bp(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Sp{constructor(t){Cp(this,"meta",void 0);const e=t.getMetaConstructor();this.meta=new e}getMeta(){return this.meta}updateMeta(t){vo(this.meta,t),ap(this.meta,t,t)}}let Rp;function Ep(t,e,o){return e=Tp(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Tp(t){var e=Mp(t,"string");return"symbol"===typeof e?e:String(e)}function Mp(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Rp=Symbol.iterator;class Hp{constructor(t){Ep(this,"valueFactory",void 0),Ep(this,"data",[]),Ep(this,"index",[]),Ep(this,"holes",new Set),this.valueFactory=t}obtain(t){up((()=>cp(t)),"Expecting an unsigned number.");const e=this._getStorageIndexByKey(t);let o;if(e>=0)o=this.data[e],void 0===o&&(o=this.valueFactory(t),this.data[e]=o);else if(o=this.valueFactory(t),this.holes.size>0){const e=this.holes.values().next().value;this.holes.delete(e),this.data[e]=o,this.index[t]=e}else this.data.push(o),this.index[t]=this.data.length-1;return o}insert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;up((()=>cp(t)||dp(t)),"Expecting an unsigned number or null/undefined argument.");const o=[],n=this.data.length;for(let r=0;r<e;r++)o.push(n+r),this.data.push(void 0);const i=dp(t)?this.index.length:t;this.index=[...this.index.slice(0,i),...o,...this.index.slice(i)]}remove(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;up((()=>cp(t)||dp(t)),"Expecting an unsigned number or null/undefined argument.");const o=this.index.splice(dp(t)?this.index.length-e:t,e);for(let n=0;n<o.length;n++){const t=o[n];"number"===typeof t&&this.holes.add(t)}}size(){return this.data.length-this.holes.size}values(){return k(this.data,((t,e)=>!this.holes.has(e)))[Symbol.iterator]()}entries(){const t=[];for(let o=0;o<this.data.length;o++){const e=this._getKeyByStorageIndex(o);-1!==e&&t.push([e,this.data[o]])}let e=0;return{next:()=>{if(e<t.length){const o=t[e];return e+=1,{value:o,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(t){return this.index.length>t?this.index[t]:-1}_getKeyByStorageIndex(t){return this.index.indexOf(t)}[Rp](){return this.entries()}}function xp(t,e,o){return e=kp(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function kp(t){var e=Ip(t,"string");return"symbol"===typeof e?e:String(e)}function Ip(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Ap=["data","width"];class Op{constructor(t){xp(this,"globalMeta",void 0),xp(this,"metas",new Hp((()=>this._createMeta()))),this.globalMeta=t,this.metas=new Hp((()=>this._createMeta()))}updateMeta(t,e){const o=this.getMeta(t);vo(o,e),ap(o,e)}createColumn(t,e){this.metas.insert(t,e)}removeColumn(t,e){this.metas.remove(t,e)}getMeta(t){return this.metas.obtain(t)}getMetaConstructor(t){return this.metas.obtain(t).constructor}clearCache(){this.metas.clear()}_createMeta(){return hp(this.globalMeta.getMetaConstructor(),Ap).prototype}}function Pp(t,e,o){return e=Np(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Np(t){var e=_p(t,"string");return"symbol"===typeof e?e:String(e)}function _p(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Lp{constructor(t){Pp(this,"columnMeta",void 0),Pp(this,"metas",new Hp((()=>this._createRow()))),this.columnMeta=t}updateMeta(t,e,o){const n=this.getMeta(t,e);vo(n,o),ap(n,o)}createRow(t,e){this.metas.insert(t,e)}createColumn(t,e){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(t,e)}removeRow(t,e){this.metas.remove(t,e)}removeColumn(t,e){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(t,e)}getMeta(t,e,o){const n=this.metas.obtain(t).obtain(e);return void 0===o?n:n[o]}setMeta(t,e,o,n){var i;const r=this.metas.obtain(t).obtain(e);null===(i=r._automaticallyAssignedMetaProps)||void 0===i||i.delete(o),r[o]=n}removeMeta(t,e,o){const n=this.metas.obtain(t).obtain(e);delete n[o]}getMetas(){const t=[],e=Array.from(this.metas.values());for(let o=0;o<e.length;o++)t.push(...e[o].values());return t}getMetasAtRow(t){up((()=>cp(t)),"Expecting an unsigned number.");const e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Hp((t=>this._createMeta(t)))}_createMeta(t){const e=this.columnMeta.getMetaConstructor(t);return new e}}class Dp{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new vp(t),this.tableMeta=new Sp(this.globalMeta),this.columnMeta=new Op(this.globalMeta),this.cellMeta=new Lp(this.columnMeta),o.forEach((t=>new t(this))),this.globalMeta.updateMeta(e)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(t){this.globalMeta.updateMeta(t)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(t){this.tableMeta.updateMeta(t)}getColumnMeta(t){return this.columnMeta.getMeta(t)}updateColumnMeta(t,e){this.columnMeta.updateMeta(t,e)}getCellMeta(t,e,o){let{visualRow:n,visualColumn:i}=o;const r=this.cellMeta.getMeta(t,e);return r.visualRow=n,r.visualCol=i,r.row=t,r.col=e,this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(t,e,o){if("string"!==typeof o)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,o)}setCellMeta(t,e,o,n){this.cellMeta.setMeta(t,e,o,n)}updateCellMeta(t,e,o){this.cellMeta.updateMeta(t,e,o)}removeCellMeta(t,e,o){this.cellMeta.removeMeta(t,e,o)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(t){return this.cellMeta.getMetasAtRow(t)}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}createColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}removeColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function Wp(t,e,o){return e=Vp(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Vp(t){var e=Fp(t,"string");return"symbol"===typeof e?e:String(e)}function Fp(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}So(Dp,tu);class jp{constructor(t){Wp(this,"metaManager",void 0),Wp(this,"metaSyncMemo",new Map),this.metaManager=t,t.addLocalHook("afterGetCellMeta",(t=>this.extendCellMeta(t))),bn.getSingleton().add("beforeRender",(t=>{t&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(t){var e;const{row:o,col:n}=t;if(null!==(e=this.metaSyncMemo.get(o))&&void 0!==e&&e.has(n))return;const{visualRow:i,visualCol:r}=t,s=this.metaManager.hot,l=s.colToProp(r);t.prop=l,s.runHooks("beforeGetCellMeta",i,r,t);const a=Ao(t,"type")?t.type:null;let h=so(t.cells)?t.cells(o,n,l):null;var c;a&&(h?h.type=null!==(c=h.type)&&void 0!==c?c:a:h={type:a});h&&this.metaManager.updateCellMeta(o,n,h),s.runHooks("afterGetCellMeta",i,r,t),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(n)}}function Bp(t,e,o){return e=zp(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function zp(t){var e=Up(t,"string");return"symbol"===typeof e?e:String(e)}function Up(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class $p{constructor(t){Bp(this,"metaManager",void 0),Bp(this,"usageTracker",new Set),Bp(this,"propDescriptors",new Map([["ariaTags",{onChange(t,e,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){const e=this.metaManager.hot.isRtl();if(e&&"fixedColumnsLeft"===t)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,e,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=t,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((t,e)=>{const{target:o,onChange:n=(()=>{})}=t,i="string"===typeof o,r=i?o:e,s=`_${r}`;this.metaManager.globalMeta.meta[s]=this.metaManager.globalMeta.meta[r],this.installPropWatcher(e,s,n),i&&this.installPropWatcher(o,s,n)}))}installPropWatcher(t,e,o){const n=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get(){return this[e]},set(i){const r=!n.usageTracker.has(t);n.usageTracker.add(t),o.call(n,t,i,r),this[e]=i},enumerable:!0,configurable:!0})}}const Gp=/^(\r\n|\n\r|\r|\n)/,Yp=/^[^\t\r\n]+/,Kp=/^\t/;function Xp(t){const e=[[""]];if(0===t.length)return e;let o,n=0,i=0;while(t.length>0){if(o===t.length)break;if(o=t.length,t.match(Kp))t=t.replace(Kp,""),n+=1,e[i][n]="";else if(t.match(Gp))t=t.replace(Gp,""),n=0,i+=1,e[i]=[""];else{let o="";if(t.startsWith('"')){let e=0,n=!0;while(n){const i=t.slice(0,1);'"'===i&&(e+=1),o+=i,t=t.slice(1),(0===t.length||t.match(/^[\t\r\n]/)&&e%2===0)&&(n=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(t=>new Array(Math.floor(t.length/2)).fill('"').join("")))}else{const e=t.match(Yp);o=e?e[0]:"",t=t.slice(o.length)}e[i][n]=o}}return e}function qp(t){let e,o,n,i,r,s="";for(e=0,o=t.length;e<o;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(s+="\t"),r=t[e][n],"string"===typeof r?r.indexOf("\n")>-1?s+=`"${r.replace(/"/g,'""')}"`:s+=r:s+=null===r||void 0===r?"":r;e!==o-1&&(s+="\n")}return s}function Qp(t,e,o){return e=Jp(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Jp(t){var e=Zp(t,"string");return"symbol"===typeof e?e:String(e)}function Zp(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class tw{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,e,o){Qp(this,"hot",void 0),Qp(this,"metaManager",void 0),Qp(this,"tableMeta",void 0),Qp(this,"dataSource",void 0),Qp(this,"duckSchema",void 0),Qp(this,"colToPropCache",void 0),Qp(this,"propToColCache",void 0),this.hot=t,this.metaManager=o,this.tableMeta=o.getTableMeta(),this.dataSource=e,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const t=this.getSchema();if("undefined"===typeof t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const e=this.tableMeta.columns;let o;if(this.colToPropCache=[],this.propToColCache=new Map,e){let n=0,i=0,r=!1;if("function"===typeof e){const e=ko(t);n=e>0?e:this.countFirstRowKeys(),r=!0}else{const t=this.tableMeta.maxCols;n=Math.min(t,e.length)}for(o=0;o<n;o++){const t=r?e(o):e[o];if(Eo(t)){if("undefined"!==typeof t.data){const e=r?i:o;this.colToPropCache[e]=t.data,this.propToColCache.set(t.data,e)}i+=1}}}else this.recursiveDuckColumns(t)}countFirstRowKeys(){return Uc(this.dataSource)}recursiveDuckColumns(t,e,o){let n,i=e,r=o;return"undefined"===typeof i&&(i=0,r=""),"object"!==typeof t||Array.isArray(t)||Mo(t,((t,e)=>{null===t?(n=r+e,this.colToPropCache.push(n),this.propToColCache.set(n,i),i+=1):i=this.recursiveDuckColumns(t,i,`${e}.`)})),i}colToProp(t){if(!1===Number.isInteger(t))return t;const e=this.hot.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&U(this.colToPropCache[e])?this.colToPropCache[e]:e}propToCol(t){const e=this.propToColCache.get(t);if(U(e))return this.hot.toVisualColumn(e);const o=this.hot.toVisualColumn(t);return null===o?t:o}getSchema(){const t=this.tableMeta.dataSchema;return t?"function"===typeof t?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?po(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:o,mode:n="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.hot.countSourceRows();let r=i,s=0,l=t;("number"!==typeof l||l>=i)&&(l=i),l<this.hot.countRows()&&(r=this.hot.toPhysicalRow(l));const a=this.hot.runHooks("beforeCreateRow",l,e,o);if(!1===a||null===r)return{delta:0};const h=this.tableMeta.maxRows,c=this.getSchema().length,u=[];while(s<e&&i+s<h){let t=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?t=yo(this.getSchema()):(t=[],Pi(c-1,(()=>t.push(null)))):"function"===this.hot.dataType?t=this.tableMeta.dataSchema(l+s):(t={},Co(t,this.getSchema())),u.push(t),s+=1}this.hot.rowIndexMapper.insertIndexes(l,s),"below"===n&&(r=Math.min(r+1,i)),this.spliceData(r,0,u);const d=this.hot.toVisualRow(r);return this.hot.countSourceRows()===u.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(void 0===t||null===t?this.metaManager.createRow(null,s):"auto"!==o&&this.metaManager.createRow(r,e)),this.hot.runHooks("afterCreateRow",d,s,o),this.hot.forceFullRender=!0,{delta:s,startPhysicalIndex:r}}createCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:o,mode:n="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,r=this.tableMeta.maxCols,s=this.hot.countSourceCols();let l=t;("number"!==typeof l||l>=s)&&(l=s);const a=this.hot.runHooks("beforeCreateCol",l,e,o);if(!1===a)return{delta:0};let h=s;l<this.hot.countCols()&&(h=this.hot.toPhysicalColumn(l));const c=this.hot.countSourceRows();let u=this.hot.countCols(),d=0,g=h;"end"===n&&(g=Math.min(g+1,s));const f=g;while(d<e&&u<r){if("number"!==typeof l||l>=u)if(c>0)for(let t=0;t<c;t+=1)"undefined"===typeof i[t]&&(i[t]=[]),i[t].push(null);else i.push([null]);else for(let t=0;t<c;t++)i[t].splice(g,0,null);d+=1,g+=1,u+=1}this.hot.columnIndexMapper.insertIndexes(l,d),d>0&&(void 0===t||null===t?this.metaManager.createColumn(null,d):"auto"!==o&&this.metaManager.createColumn(f,e));const m=this.hot.toVisualColumn(f);return this.hot.runHooks("afterCreateCol",m,d,o),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:d,startPhysicalIndex:f}}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,n=Number.isInteger(t)?t:-e;const i=this.visualRowsToPhysical(n,e),r=this.hot.countSourceRows();n=(r+n)%r;const s=this.hot.runHooks("beforeRemoveRow",n,i.length,i,o);if(!1===s)return!1;const l=i.length;if(this.filterData(n,l,i),n<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(i);const t=U(this.tableMeta.columns)||U(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===t&&this.hot.columnIndexMapper.setIndexesSequence([])}const a=i.slice(0).sort(((t,e)=>e-t));return a.forEach((t=>{this.metaManager.removeRow(t,1)})),this.hot.runHooks("afterRemoveRow",n,l,i,o),this.hot.forceFullRender=!0,!0}removeCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let n="number"!==typeof t?-e:t;n=(this.hot.countCols()+n)%this.hot.countCols();const i=this.visualColumnsToPhysical(n,e),r=i.slice(0).sort(((t,e)=>e-t)),s=this.hot.runHooks("beforeRemoveCol",n,e,i,o);if(!1===s)return!1;let l=!0;const a=r.length,h=this.dataSource;for(let c=0;c<a;c++)l&&i[0]!==i[c]-c&&(l=!1);if(l)for(let c=0,u=this.hot.countSourceRows();c<u;c++)h[c].splice(i[0],e),0===c&&this.metaManager.removeColumn(i[0],e);else for(let c=0,u=this.hot.countSourceRows();c<u;c++)for(let t=0;t<a;t++)h[c].splice(r[t],1),0===c&&this.metaManager.removeColumn(r[t],1);return n<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(i),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",n,e,i,o),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,e,o){const n=this.hot.getDataAtCol(t),i=n.slice(e,e+o),r=n.slice(e+o);for(var s=arguments.length,l=new Array(s>3?s-3:0),a=3;a<s;a++)l[a-3]=arguments[a];M(l,r);let h=0;while(h<o)l.push(null),h+=1;return T(l),this.hot.populateFromArray(e,t,l,null,null,"spliceCol"),i}spliceRow(t,e,o){const n=this.hot.getSourceDataAtRow(t),i=n.slice(e,e+o),r=n.slice(e+o);for(var s=arguments.length,l=new Array(s>3?s-3:0),a=3;a<s;a++)l[a-3]=arguments[a];M(l,r);let h=0;while(h<o)l.push(null),h+=1;return this.hot.populateFromArray(t,e,[l],null,null,"spliceRow"),i}spliceData(t,e,o){const n=this.hot.runHooks("beforeDataSplice",t,e,o);if(!1!==n){const e=[...this.dataSource.slice(0,t),...o,...this.dataSource.slice(t)];this.dataSource.length=0,e.forEach((t=>this.dataSource.push(t)))}}filterData(t,e,o){let n=this.hot.runHooks("filterData",t,e,o);!1===Array.isArray(n)&&(n=this.dataSource.filter(((t,e)=>-1===o.indexOf(e)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,n)}get(t,e){const o=this.hot.toPhysicalRow(t);let n=this.dataSource[o];const i=this.hot.runHooks("modifyRowData",o);n=isNaN(i)?i:n;let r=null;if(n&&n.hasOwnProperty&&Ao(n,e))r=n[e];else if("string"===typeof e&&e.indexOf(".")>-1){const t=e.split(".");let o=n;if(!o)return null;for(let e=0,n=t.length;e<n;e++)if(o=o[t[e]],"undefined"===typeof o)return null;r=o}else"function"===typeof e&&(r=e(this.dataSource.slice(o,o+1)[0]));if(this.hot.hasHook("modifyData")){const t=Io(r);this.hot.runHooks("modifyData",o,this.propToCol(e),t,"get"),t.isTouched()&&(r=t.value)}return r}getCopyable(t,e){return this.hot.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}set(t,e,o){const n=this.hot.toPhysicalRow(t);let i=o,r=this.dataSource[n];const s=this.hot.runHooks("modifyRowData",n);if(r=isNaN(s)?s:r,this.hot.hasHook("modifyData")){const t=Io(i);this.hot.runHooks("modifyData",n,this.propToCol(e),t,"set"),t.isTouched()&&(i=t.value)}if(r&&r.hasOwnProperty&&Ao(r,e))r[e]=i;else if("string"===typeof e&&e.indexOf(".")>-1){const t=e.split(".");let o,n=r,s=0;for(s=0,o=t.length-1;s<o;s++)"undefined"===typeof n[t[s]]&&(n[t[s]]={}),n=n[t[s]];n[t[s]]=i}else"function"===typeof e?e(this.dataSource.slice(n,n+1)[0],i):r[e]=i}visualRowsToPhysical(t,e){const o=this.hot.countSourceRows(),n=[];let i,r=(o+t)%o,s=e;while(r<o&&s)i=this.hot.toPhysicalRow(r),n.push(i),s-=1,r+=1;return n}visualColumnsToPhysical(t,e){const o=this.hot.countCols(),n=[];let i=(o+t)%o,r=e;while(i<o&&r){const t=this.hot.toPhysicalColumn(i);n.push(t),r-=1,i+=1}return n}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let e=0;e<this.hot.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){const t=this.tableMeta.maxRows;let e;e=t<0||0===t?0:t||1/0;const o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,e)}getAll(){const t={row:0,col:0},e={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return t.row-e.row!==0||this.hot.countSourceRows()?this.getRange(t,e,tw.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(t,e,o){const n=[];let i,r,s;const l=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===l||0===a)return[];const h=o===tw.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(l-1,0),Math.max(t.row,e.row)),u=Math.min(Math.max(a-1,0),Math.max(t.col,e.col));for(i=Math.min(t.row,e.row);i<=c;i++){s=[];const o=i>=0?this.hot.toPhysicalRow(i):i;for(r=Math.min(t.col,e.col);r<=u;r++){if(null===o)break;s.push(h.call(this,i,this.colToProp(r)))}null!==o&&n.push(s)}return n}getText(t,e){return qp(this.getRange(t,e,tw.DESTINATION_RENDERER))}getCopyableText(t,e){return qp(this.getRange(t,e,tw.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}var ew=tw;function ow(t,e,o,n){const{hotInstance:i,dataMap:r,dataSource:s,internalSource:l,source:a,metaManager:h,firstRun:c}=n,u=lt(l),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":so(d.dataSchema)?i.dataType="function":i.dataType="object",r&&r.destroy(),t=i.runHooks(`before${u}`,t,c,a);const g=new ew(i,t,h);if(e(g),"object"===typeof t&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error(`${l} only accepts array of objects or array of arrays (${typeof t} given)`);{const e=g.getSchema();let o;t=[];let n=0,r=0;for(n=0,r=d.startRows;n<r;n++)if("object"!==i.dataType&&"function"!==i.dataType||!d.dataSchema)if("array"===i.dataType)o=yo(e[0]),t.push(o);else{o=[];for(let t=0,e=d.startCols;t<e;t++)o.push(null);t.push(o)}else o=yo(e),t.push(o)}}Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),o(g),i.runHooks(`after${u}`,t,c,a),c||(i.runHooks("afterChange",null,l),i.render()),i.getSettings().ariaTags&&fe(i.rootElement,[Lt(i.countRows()),Dt(i.countCols())])}const nw="gridDefault",iw="editorManager.handlingEditor";function rw(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=t.rootElement,n=sw(t),i=sw(t);return n.addEventListener("focus",(()=>null===e||void 0===e?void 0:e.onFocusFromTop())),i.addEventListener("focus",(()=>null===e||void 0===e?void 0:e.onFocusFromBottom())),o.firstChild.before(n),o.lastChild.after(i),{activate(){t._registerTimeout((()=>{n.tabIndex=0,i.tabIndex=0}),10)},deactivate(){t._registerTimeout((()=>{n.tabIndex=-1,i.tabIndex=-1}),10)}}}function sw(t){const e=t.rootDocument,o=e.createElement("input");return o.type="text",o.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&fe(o,[pt()]),o}function lw(t){let e;const{activate:o,deactivate:n}=rw(t,{onFocusFromTop(){var o;const n=null!==(o=e)&&void 0!==o?o:aw(t);n&&(t.runHooks("modifyFocusOnTabNavigation","from_above",n),t.selectCell(n.row,n.col)),t.listen()},onFocusFromBottom(){var o;const n=null!==(o=e)&&void 0!==o?o:hw(t);n&&(t.runHooks("modifyFocusOnTabNavigation","from_below",n),t.selectCell(n.row,n.col)),t.listen()}}),i={wrapped:!1,flipped:!1};function r(){i.wrapped=!1,i.flipped=!1,t.deselectCell(),t.unlisten()}t.addHook("afterListen",(()=>n())),t.addHook("afterUnlisten",(()=>o())),t.addHook("afterSelection",(()=>{var o;e=null===(o=t.getSelectedRangeLast())||void 0===o?void 0:o.highlight})),t.addHook("beforeRowWrap",((t,e,o)=>{i.wrapped=!0,i.flipped=o})),t.getShortcutManager().getContext("grid").addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:o=>{const{disableTabNavigation:n,autoWrapRow:s}=t.getSettings();if(n||!t.selection.isSelected()||s&&i.wrapped&&i.flipped||!s&&i.wrapped)return s&&i.wrapped&&i.flipped&&(e=o.shiftKey?aw(t):hw(t)),r(),!1;o.preventDefault()},runOnlyIf:()=>!t.getSettings().minSpareCols,preventDefault:!1,stopPropagation:!1,position:"after",relativeToGroup:nw,group:"focusCatcher"})}function aw(t){const{rowIndexMapper:e,columnIndexMapper:o}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,r=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return 0===i&&(i=e.getVisualFromRenderableIndex(i)),0===r&&(r=o.getVisualFromRenderableIndex(r)),null===i||null===r?null:t._createCellCoords(i,r)}function hw(t){var e,o;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:r}=t.getSettings();let s=n.getRenderableIndexesLength()-1,l=i.getRenderableIndexesLength()-1;if(s<0){if(!r||0===t.countColHeaders())return null;s=-1}if(l<0){if(!r||0===t.countColHeaders())return null;l=-1}return t._createCellCoords(null!==(e=n.getVisualFromRenderableIndex(s))&&void 0!==e?e:s,null!==(o=i.getVisualFromRenderableIndex(l))&&void 0!==o?o:l)}const cw=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),uw=t=>t.map((t=>{const e=t.toLowerCase();return cw.has(e)?cw.get(e):e})).sort().join("+"),dw=t=>t.split("+"),gw=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),fw=t=>{let{key:e,code:o}=t;return(gw.test(o)?o.replace(gw,"$1"):e).toLowerCase()},mw=Symbol("shortcut-context");function pw(t){return Eo(t)&&t.__kindOf===mw}const ww=t=>{const e=Ui({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`}),o=function(){let{keys:t,callback:o,group:n,runOnlyIf:i=(()=>!0),captureCtrl:r=!1,preventDefault:s=!0,stopPropagation:l=!1,relativeToGroup:a,position:h,forwardToContext:c}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if($(n))throw new Error("You need to define the shortcut's group.");if(!1===so(o))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw new Error(B`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const u={callback:o,group:n,runOnlyIf:i,captureCtrl:r,preventDefault:s,stopPropagation:l};U(a)&&([u.relativeToGroup,u.position]=[a,h]),pw(c)&&(u.forwardToContext=c),t.forEach((t=>{const o=uw(t),n=e.hasItem(o);if(n){const t=e.getItem(o);let n=t.findIndex((t=>t.group===a));-1!==n?"before"===h?n-=1:n+=1:n=t.length,t.splice(n,0,u)}else e.addItem(o,[u])}))},n=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach((t=>{Mo(e,((o,n)=>{!1===Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=e[n])})),o(t)}))},i=t=>{const o=uw(t);e.removeItem(o)},r=t=>{const o=e.getItems();o.forEach((e=>{let[o,n]=e;const r=n.filter((e=>e.group!==t));0===r.length?i(dw(o)):(n.length=0,n.push(...r))}))},s=t=>{const o=uw(t),n=e.getItem(o);return U(n)?n.slice():[]},l=t=>{const o=uw(t);return e.hasItem(o)};return{__kindOf:mw,addShortcut:o,addShortcuts:n,getShortcuts:s,hasShortcut:l,removeShortcutsByKeys:i,removeShortcutsByGroup:r}};function vw(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Cw=["meta","alt","shift","control"],yw=vw();let bw=0;function Sw(t,e,o,n,i){const r=t=>Cw.includes(t),s=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=[];return t.altKey&&o.push("alt"),e&&(t.ctrlKey||t.metaKey)?o.push("control/meta"):(t.ctrlKey&&o.push("control"),t.metaKey&&o.push("meta")),t.shiftKey&&o.push("shift"),o},l=t=>{if(!1===e(t))return;const l=o(t);if(229===t.keyCode||!1===l||rn(t))return;const a=fw(t);let h=[];r(a)||(h=s(t));const c=[a].concat(h),u=i(t,c);!u&&(Ko()&&h.includes("meta")||!Ko()&&h.includes("control"))&&i(t,[a].concat(s(t,!0))),n(t)},a=t=>{const e=fw(t);r(e)&&yw.press(e)},h=t=>{const e=fw(t);r(e)&&yw.release(e)},c=()=>{yw.releaseAll()},u=()=>{let e=t;bw+=1;while(e)1===bw&&(e.document.documentElement.addEventListener("keydown",a),e.document.documentElement.addEventListener("keyup",h)),e.document.documentElement.addEventListener("keydown",l),e.document.documentElement.addEventListener("blur",c),e=oe(e)},d=()=>{let e=t;bw-=1;while(e)0===bw&&(e.document.documentElement.removeEventListener("keydown",a),e.document.documentElement.removeEventListener("keyup",h)),e.document.documentElement.removeEventListener("keydown",l),e.document.documentElement.removeEventListener("blur",c),e=oe(e)};return{mount:u,unmount:d,isPressed:t=>yw.isPressed(t),releasePressedKeys:()=>yw.releaseAll()}}const Rw=t=>{let{ownerWindow:e,handleEvent:o,beforeKeyDown:n,afterKeyDown:i}=t;const r=Ui({errorIdExists:t=>`The "${t}" context name is already registered.`});let s="grid";const l=t=>{const e=ww(t);return r.addItem(t,e),e},a=()=>s,h=t=>r.getItem(t),c=t=>{if(!r.hasItem(t))throw new Error(B`You've tried to activate the "${t}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=t};let u=!1;const d=function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a();const n=pw(o)?o:h(o);let i=!1;if(!n.hasShortcut(e))return i;const r=n.getShortcuts(e);for(let s=0;s<r.length;s++){const{callback:o,runOnlyIf:n,preventDefault:l,stopPropagation:a,captureCtrl:h,forwardToContext:c}=r[s];if(!1!==n(t)){if(u=h,i=!1===o(t,e),u=!1,l&&t.preventDefault(),a&&(nn(t),t.stopPropagation()),i)break;c&&d(t,e,c)}}return i},g=Sw(e,o,n,i,d);return g.mount(),{addContext:l,getActiveContextName:a,getContext:h,setActiveContextName:c,isCtrlPressed:()=>!u&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}},Ew={name:"editorCloseAndSave",callback(t,e,o){const n=t._getEditorManager();n.closeEditorAndSaveChanges(t.getShortcutManager().isCtrlPressed()),n.moveSelectionAfterEnter(o.includes("shift"))}},Tw={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Mw={name:"editorFastOpen",callback(t,e){const{highlight:o}=t.getSelectedRangeLast();o.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Hw={name:"editorOpen",callback(t,e,o){const n=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter():n.openEditor(null,e,!0):n.moveSelectionAfterEnter(o.includes("shift")),nn(e))}};function xw(){return[Ew,Tw,Mw,Hw]}const kw={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},Iw={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),o=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),n=t.rowIndexMapper.getNearestNotHiddenIndex(o,-1);if(null!==n){const o=t._createCellCoords(n,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),r=Math.min(o.row-i,t.countRows()-1);t.selection.setRangeEnd(o),t.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}},Aw={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},Ow={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},Pw={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:o,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(o.col,n.col,e.row)}},Nw={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:o}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||s){const n=o.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(n,r.col))}}},_w={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n}=t.getSelectedRangeLast();n.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,o.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},Lw={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n}=t.getSelectedRangeLast();n.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,o.getNearestNotHiddenIndex(0,1)))}},Dw={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||s){const n=o.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r.row,n))}}},Ww={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||s){const n=o.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r.row,n))}}},Vw={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:o}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||s){const n=o.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(n,r.col))}}},Fw={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:o,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(o.row,n.row,e.col)}},jw={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},Bw={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),o=Math.max(e.row-t.countVisibleRows(),0),n=t.rowIndexMapper.getNearestNotHiddenIndex(o,1);if(null!==n){const o=t._createCellCoords(n,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),r=Math.max(o.row-i,0);t.selection.setRangeEnd(o),t.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}};function zw(){return[kw,Iw,Aw,Ow,Pw,Nw,_w,Lw,Dw,Ww,Vw,Fw,jw,Bw]}const Uw={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},$w={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),o=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+o;n===t.countRows()-1?i=1:n+i>t.countRows()&&(i=t.countRows()-n-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},Gw={name:"moveCellSelectionInlineEnd",callback(t,e){const o=t.getSettings(),n="function"===typeof o.tabMoves?o.tabMoves(e):o.tabMoves;t.selection.transformStart(-n.row,-n.col)}},Yw={name:"moveCellSelectionInlineStart",callback(t,e){const o=t.getSettings(),n="function"===typeof o.tabMoves?o.tabMoves(e):o.tabMoves;t.selection.transformStart(n.row,n.col,!0)}},Kw={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},Xw={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},qw={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let o=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);null===o&&(o=-1),t.selection.setRangeStart(t._createCellCoords(o,e))}},Qw={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:o,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),r=o.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(r,s))}},Jw={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:o}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,o.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},Zw={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:o}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,r=o.getNearestNotHiddenIndex(n,1);e.setRangeStart(t._createCellCoords(i,r))}},tv={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:o}=t,n=t.getSelectedRangeLast().highlight.row;let i=o.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);null===i&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(n,i))}},ev={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:o}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=o.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);null===i&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(n,i))}},ov={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let o=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===o&&(o=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(o,e))}},nv={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:o,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),r=parseInt(t.getSettings().fixedColumnsStart,10),s=o.getNearestNotHiddenIndex(i,1),l=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(s,l))}},iv={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},rv={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),o=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+o);n===-o?i=-1:n+i<o&&(i=-(n+o)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function sv(){return[Uw,$w,Gw,Yw,Kw,Xw,qw,Qw,Jw,Zw,tv,ev,ov,nv,iv,rv]}const lv={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},av={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),o=t.view.getFirstFullyVisibleRow()-1,n=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,r=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(o,n),l=t._createCellCoords(i,r),a=t._createCellRange(s,s,l);if(!a.includes(e)&&(e.row>=0||e.col>=0)){const o={};if(e.col>=0){const n=Math.floor(t.countVisibleCols()/2);o.col=Math.max(e.col-n,0)}if(e.row>=0){const n=Math.floor(t.countVisibleRows()/2);o.row=Math.max(e.row-n,0)}t.scrollViewportTo({...o,verticalSnap:"top",horizontalSnap:"start"})}}},hv={name:"selectAll",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},cv={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:o,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(o,n),r=new Map;for(let s=0;s<e.length;s++)e[s].forAll(((e,s)=>{if(e>=0&&s>=0&&(e!==o||s!==n)){const{readOnly:o}=t.getCellMeta(e,s);o||r.set(`${e}x${s}`,[e,s,i])}}));t.setDataAtCell(Array.from(r.values()))}},uv=[...xw(),...zw(),...sv(),lv,av,hv,cv];function dv(t){const e={};return uv.forEach((o=>{let{name:n,callback:i}=o;e[n]=function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return i(t,...o)}})),e}function gv(t){const e=t.getShortcutManager().addContext("editor"),o=dv(t),n={group:iw};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(t,e)=>o.editorCloseAndSave(t,e)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>o.editorCloseWithoutSaving()}],n)}function fv(t){const e=t.getShortcutManager().addContext("grid"),o=dv(t),n={runOnlyIf:()=>{const{navigableHeaders:e}=t.getSettings();return U(t.getSelected())&&(e||!e&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:nw};e.addShortcuts([{keys:[["F2"]],callback:t=>o.editorFastOpen(t)},{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>o.editorOpen(t,e)},{keys:[["Backspace"],["Delete"]],callback:()=>o.emptySelectedCells()}],{group:iw,runOnlyIf:()=>U(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"],["Control/Meta","Shift","Space"]],callback:()=>o.selectAll()},{keys:[["Control/Meta","Enter"]],callback:()=>o.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>o.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>o.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>o.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>o.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>o.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>o.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>o.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>o.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>o.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>o.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>o.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>o.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>o.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>o.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>o.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>o.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>o.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>o.scrollToFocusedCell()}],n)}function mv(t){[gv,fv].forEach((e=>e(t)))}let pv=null;const wv=new Map;new Set;function vv(t,e){var o,n=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,s=this;const l=new Fn(s);let a,h,c,u,d,g=!0;mc(i)&&fc(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const f=null!==(o=null===e||void 0===e?void 0:e.layoutDirection)&&void 0!==o?o:"inherit",m=["rtl","ltr"].includes(f)?f:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return"rtl"===m},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=wf(e.language);const p=new Dp(s,e,[jp,$p]),w=p.getTableMeta(),v=p.getGlobalMeta(),C=Ui();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),pc(this)&&rt(e.licenseKey,t),this.guid=`ht_${ht()}`,wv.set(this.guid,this),this.columnIndexMapper=new nd,this.rowIndexMapper=new nd,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(t=>{s.runHooks("afterColumnSequenceChange",t)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(t=>{s.runHooks("afterRowSequenceChange",t)})),h=new Qc(s),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);const y=t=>{const{row:e,col:o}=t;return s._createCellCoords(e>=0?s.rowIndexMapper.getRenderableFromVisualIndex(e):e,o>=0?s.columnIndexMapper.getRenderableFromVisualIndex(o):o)},b=t=>{const{row:e,col:o}=t;return s._createCellCoords(e>=0?s.rowIndexMapper.getVisualFromRenderableIndex(e):e,o>=0?s.columnIndexMapper.getVisualFromRenderableIndex(o):o)};let S=new Zm(w,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:t=>a.propToCol(t),isEditorOpened:()=>!!s.getActiveEditor()&&s.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(t,e)=>s._createCellCoords(t,e),createCellRange:(t,e,o)=>s._createCellRange(t,e,o),visualToRenderableCoords:y,renderableToVisualCoords:b,isDisabledCellSelection:(t,e)=>t<0||e<0?s.getSettings().disableVisualSelection:s.getCellMeta(t,e).disableVisualSelection});this.selection=S;const R=t=>{let{hiddenIndexesChanged:e}=t;e&&this.selection.refresh()};function E(t){const e=rd(t);gf(e)?(s.runHooks("beforeLanguageChange",e),v.language=e,s.runHooks("afterLanguageChange",e)):sd(t)}function T(t,e){const o="className"===t?s.rootElement:s.table;if(g)de(o,e);else{let n=[],i=[];v[t]&&(n=Array.isArray(v[t])?v[t]:j(v[t])),e&&(i=Array.isArray(e)?e:j(e));const r=W(n,i),s=W(i,n);r.length&&ge(o,r),s.length&&de(o,s)}v[t]=e}function M(){let t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function k(t){const e=t.replace(",",".");return!1===isNaN(parseFloat(e))?parseFloat(e):t}function O(t,e,o){if(!t.length)return;const n=s.getActiveEditor(),i=new M;let r=!0;i.onQueueEmpty=t=>{n&&r&&n.cancelChanges(),o(t)};for(let l=t.length-1;l>=0;l--){const[o,n,,h]=t[l],c=a.propToCol(n),u=s.getCellMeta(o,c);"numeric"===u.type&&"string"===typeof h&&Oi(h)&&(t[l][3]=k(h)),s.getCellValidator(u)&&(i.addValidatorToQueue(),s.validateCell(t[l][3],u,function(e,o){return function(n){if("boolean"!==typeof n)throw new Error("Validation error: result is not boolean");if(!1===n&&!1===o.allowInvalid){r=!1,t.splice(e,1),o.valid=!0;const n=s.getCell(o.visualRow,o.visualCol);null!==n&&ge(n,w.invalidCellClassName)}i.removeValidatorFormQueue()}}(l,u),e))}i.checkIfQueueIsEmpty()}function P(t,e){let o=t.length-1;if(o<0)return;for(;o>=0;o--){let n=!1;if(null!==t[o]){if(null!==t[o][2]&&void 0!==t[o][2]||null!==t[o][3]&&void 0!==t[o][3]){if(w.allowInsertRow)while(t[o][0]>s.countRows()-1){const{delta:t}=a.createRow(void 0,void 0,{source:e});if(0===t){n=!0;break}}if("array"===s.dataType&&(!w.columns||0===w.columns.length)&&w.allowInsertColumn)while(a.propToCol(t[o][1])>s.countCols()-1){const{delta:t}=a.createCol(void 0,void 0,{source:e});if(0===t){n=!0;break}}n||a.set(t[o][0],t[o][1],t[o][3])}}else t.splice(o,1)}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",t,e),u.lockEditor(),s._refreshBorders(null),u.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",t,e||"edit");const n=s.getActiveEditor();n&&U(n.refreshValue)&&n.refreshValue()}function N(t,e,o){return Array.isArray(t)?t:[[t,e,o]]}function _(t,e){const o=s.getActiveEditor(),n=s.runHooks("beforeChange",t,e||"edit"),i=t.filter((t=>null!==t));return!1===n||0===i.length?(o&&o.cancelChanges(),[]):i}this.columnIndexMapper.addLocalHook("cacheUpdated",R),this.rowIndexMapper.addLocalHook("cacheUpdated",R),this.selection.addLocalHook("afterSetRangeEnd",(t=>{const e=Io(!1),o=this.selection.getSelectedRange(),{from:n,to:i}=o.current(),l=o.size()-1;this.runHooks("afterSelection",n.row,n.col,i.row,i.col,e,l),this.runHooks("afterSelectionByProp",n.row,s.colToProp(n.col),i.row,s.colToProp(i.col),e,l);let a=!0;r&&(a=!1),e.isTouched()&&(a=!e.value);const h=this.selection.selectedRange.current(),c=this.selection.isSelectedByAnyHeader(),u=this.selection.isSelectedByRowHeader(),d=this.selection.isSelectedByColumnHeader();if(!1!==a)if(c)u?this.scrollViewportTo({row:t.row}):d&&this.scrollViewportTo({col:t.col});else if(h&&!this.selection.isMultiple()){const{row:t,col:e}=h.from;t<0&&e>=0?this.scrollViewportTo({col:e}):e<0&&t>=0?this.scrollViewportTo({row:t}):this.scrollViewportTo({row:t,col:e})}else this.scrollViewportTo(t.toObject());u&&d?de(this.rootElement,["ht__selection--rows","ht__selection--columns"]):u?(ge(this.rootElement,"ht__selection--columns"),de(this.rootElement,"ht__selection--rows")):d?(ge(this.rootElement,"ht__selection--rows"),de(this.rootElement,"ht__selection--columns")):ge(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(t=>{const e=t.length-1,{from:o,to:n}=t[e];this.runHooks("afterSelectionEnd",o.row,o.col,n.row,n.col,e),this.runHooks("afterSelectionEndByProp",o.row,s.colToProp(o.col),n.row,s.colToProp(n.col),e)})),this.selection.addLocalHook("afterIsMultipleSelection",(t=>{const e=this.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)})),this.selection.addLocalHook("afterDeselect",(()=>{u.destroyEditor(),this._refreshBorders(),ge(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("beforeHighlightSet",(()=>this.runHooks("beforeSelectionHighlightSet"))).addLocalHook("beforeSetRangeStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSetRangeStart",...e)})).addLocalHook("beforeSetRangeStartOnly",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSetRangeStartOnly",...e)})).addLocalHook("beforeSetRangeEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSetRangeEnd",...e)})).addLocalHook("beforeSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSelectColumns",...e)})).addLocalHook("afterSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterSelectColumns",...e)})).addLocalHook("beforeSelectRows",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSelectRows",...e)})).addLocalHook("afterSelectRows",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterSelectRows",...e)})).addLocalHook("beforeModifyTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("modifyTransformStart",...e)})).addLocalHook("afterModifyTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterModifyTransformStart",...e)})).addLocalHook("beforeModifyTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("modifyTransformEnd",...e)})).addLocalHook("afterModifyTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterModifyTransformEnd",...e)})).addLocalHook("beforeRowWrap",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeRowWrap",...e)})).addLocalHook("beforeColumnWrap",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeColumnWrap",...e)})).addLocalHook("insertRowRequire",(t=>this.alter("insert_row_above",t,1,"auto"))).addLocalHook("insertColRequire",(t=>this.alter("insert_col_start",t,1,"auto"))),c={alter(t,e){var o,n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;const h=t=>{if(0===t.length)return[];const e=[...t];e.sort(((t,e)=>{let[o]=t,[n]=e;return o===n?0:o>n?1:-1}));const o=x(e,((t,e)=>{let[o,n]=e;const i=t[t.length-1],[r,s]=i,l=r+s;if(o<=l){const t=Math.max(n-(l-o),0);i[1]+=t}else t.push([o,n]);return t}),[e[0]]);return o};switch(t){case"insert_row_below":case"insert_row_above":const l=s.countSourceRows();if(w.maxRows===l)return;const u="insert_row_below"===t?"below":"above";e=null!==(o=e)&&void 0!==o?o:"below"===u?l:0;const{delta:d,startPhysicalIndex:g}=a.createRow(e,i,{source:r,mode:u});if(d){const t=S.selectedRange.current(),e=null===t||void 0===t?void 0:t.from,o=null===e||void 0===e?void 0:e.row,n=s.toVisualRow(g);if(S.isSelectedByCorner())S.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(U(o)&&o>=n){const{row:n,col:i}=t.to;let r=e.col;S.isSelectedByRowHeader()&&(r=-1),S.getSelectedRange().pop(),S.setRangeStartOnly(s._createCellCoords(o+d,r),!0),S.setRangeEnd(s._createCellCoords(n+d,i))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const f="insert_col_end"===t?"end":"start";e=null!==(n=e)&&void 0!==n?n:"end"===f?s.countSourceCols():0;const{delta:m,startPhysicalIndex:p}=a.createCol(e,i,{source:r,mode:f});if(m){if(Array.isArray(w.colHeaders)){const t=[s.toVisualColumn(p),0];t.length+=m,Array.prototype.splice.apply(w.colHeaders,t)}const t=S.selectedRange.current(),e=null===t||void 0===t?void 0:t.from,o=null===e||void 0===e?void 0:e.col,n=s.toVisualColumn(p);if(S.isSelectedByCorner())S.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(U(o)&&o>=n){const{row:n,col:i}=t.to;let r=e.row;S.isSelectedByColumnHeader()&&(r=-1),S.getSelectedRange().pop(),S.setRangeStartOnly(s._createCellCoords(r,o+m),!0),S.setRangeEnd(s._createCellCoords(n,i+m))}else s._refreshBorders()}break;case"remove_row":const v=t=>{let e=0;A(t,(t=>{let[o,n]=t;const i=G(o)?s.countRows()-1:Math.max(o-e,0);Number.isInteger(o)&&(o=Math.max(o-e,0));const l=a.removeRow(o,n,r);if(!l)return;const h=s.countRows(),c=w.fixedRowsTop;c>=i+1&&(w.fixedRowsTop-=Math.min(n,c-i));const u=w.fixedRowsBottom;u&&i>=h-u&&(w.fixedRowsBottom-=Math.min(n,u)),e+=n}))};Array.isArray(e)?v(h(e)):v([[e,i]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const C=t=>{let e=0;A(t,(t=>{let[o,n]=t;const i=G(o)?s.countCols()-1:Math.max(o-e,0);let l=s.toPhysicalColumn(i);Number.isInteger(o)&&(o=Math.max(o-e,0));const h=a.removeCol(o,n,r);if(!h)return;const c=w.fixedColumnsStart;c>=i+1&&(w.fixedColumnsStart-=Math.min(n,c-i)),Array.isArray(w.colHeaders)&&("undefined"===typeof l&&(l=-1),w.colHeaders.splice(l,n)),e+=n}))};Array.isArray(e)?C(h(e)):C([[e,i]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${t}"`)}l||c.adjustRowsAndCols()},adjustRowsAndCols(){const t=w.minRows,e=w.minSpareRows,o=w.minCols,n=w.minSpareCols;if(0===s.countRows()&&0===s.countCols()&&S.deselect(),t){const e=s.countRows();e<t&&a.createRow(e,t-e,{source:"auto"})}if(e){const t=s.countEmptyRows(!0);if(t<e){const o=e-t,n=Math.min(o,w.maxRows-s.countSourceRows());a.createRow(s.countRows(),n,{source:"auto"})}}{let t;(o||n)&&(t=s.countEmptyCols(!0));let e=s.countCols();if(o&&!w.columns&&e<o){const n=o-e;t+=n,a.createCol(e,n,{source:"auto"})}if(n&&!w.columns&&"array"===s.dataType&&t<n){e=s.countCols();const o=n-t,i=Math.min(o,w.maxCols-e);a.createCol(e,i,{source:"auto"})}}if(S.isSelected()){const t=s.countRows(),e=s.countCols();A(S.selectedRange,(o=>{let n=!1,i=o.from.row,r=o.from.col,l=o.to.row,a=o.to.col;i>t-1?(i=t-1,n=!0,l>i&&(l=i)):l>t-1&&(l=t-1,n=!0,i>l&&(i=l)),r>e-1?(r=e-1,n=!0,a>r&&(a=r)):a>e-1&&(a=e-1,n=!0,r>a&&(r=a)),n&&s.selectCell(i,r,l,a)}))}s.view&&s.view.adjustElementsSize()},populateFromArray(t,e,o,n,i){let r,l,a,h;const c=[],u={},d=[],g=t.row,f=t.col;if(l=e.length,0===l)return!1;let m=0,p=0;switch(Eo(o)&&(m=o.col-f+1,p=o.row-g+1),i){case"shift_down":const i=H(e),v=i.length,C=Math.max(v,m),y=s.getData().slice(g),b=H(y).slice(f,f+C);for(a=0;a<C;a+=1)if(a<v){for(r=0,l=i[a].length;r<p-l;r+=1)i[a].push(i[a][r%l]);a<b.length?d.push(i[a].concat(b[a])):d.push(i[a].concat(new Array(y.length).fill(null)))}else d.push(i[a%v].concat(b[a]));s.populateFromArray(g,f,H(d));break;case"shift_right":const S=e.length,R=Math.max(S,p),E=s.getData().slice(g).map((t=>t.slice(f)));for(r=0;r<R;r+=1)if(r<S){for(a=0,h=e[r].length;a<m-h;a+=1)e[r].push(e[r][a%h]);if(r<E.length)for(let t=0;t<E[r].length;t+=1)e[r].push(E[r][t]);else e[r].push(...new Array(E[0].length).fill(null))}else e.push(e[r%l].slice(0,R).concat(E[r]));s.populateFromArray(g,f,e);break;case"overwrite":default:u.row=t.row,u.col=t.col;let T,M=0,x=0,k=!0;const I=function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=e[t%e.length];return null!==o?n[o%n.length]:n},A=e.length,O=o?o.row-t.row+1:0;for(l=o?O:Math.max(A,O),r=0;r<l;r++){if(o&&u.row>o.row&&O>A||!w.allowInsertRow&&u.row>s.countRows()-1||u.row>=w.maxRows)break;const e=r-M,i=I(e).length,d=o?o.col-t.col+1:0;if(h=o?d:Math.max(i,d),u.col=t.col,T=s.getCellMeta(u.row,u.col),"CopyPaste.paste"!==n&&"Autofill.fill"!==n||!T.skipRowOnPaste){for(x=0,a=0;a<h;a++){if(o&&u.col>o.col&&d>i||!w.allowInsertColumn&&u.col>s.countCols()-1||u.col>=w.maxCols)break;if(T=s.getCellMeta(u.row,u.col),("CopyPaste.paste"===n||"Autofill.fill"===n)&&T.skipColumnOnPaste){x+=1,u.col+=1,h+=1;continue}if(T.readOnly&&"UndoRedo.undo"!==n){u.col+=1;continue}const t=a-x;let r=I(e,t),l=s.getDataAtCell(u.row,u.col);if(null!==r&&"object"===typeof r)if(Array.isArray(r)&&null===l&&(l=[]),null===l||"object"!==typeof l)k=!1;else{const t=po(Array.isArray(l)?l:l[0]||l),e=po(Array.isArray(r)?r:r[0]||r);Ro(t,e)||Array.isArray(t)&&Array.isArray(e)?r=yo(r):k=!1}else null!==l&&"object"===typeof l&&(k=!1);k&&c.push([u.row,u.col,r]),k=!0,u.col+=1}u.row+=1}else M+=1,u.row+=1,l+=1}s.setDataAtCell(c,null,null,n||"populateFromArray");break}}},this.init=function(){h.setData(w.data),s.runHooks("beforeInit"),(Uo()||Go())&&de(s.rootElement,"mobile"),this.updateSettings(w,!0),this.view=new _c(this),u=ei.getInstance(s,w,S),d=new yi(s),pc(this)&&lw(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&null===s.rootElement.offsetParent&&eo(s.rootElement,(()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()})),"object"===typeof g&&(s.runHooks("afterChange",g[0],g[1]),g=!1),s.runHooks("afterInit")},this._createCellCoords=function(t,e){return s.view._wt.createCellCoords(t,e)},this._createCellRange=function(t,e,o){return s.view._wt.createCellRange(t,e,o)},this.validateCell=function(t,e,o,n){let i=s.getCellValidator(e);function r(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!n||!0===e.hidden)return void o(t);const i=e.visualCol,r=e.visualRow,l=s.getCell(r,i,!0);if(l&&"TH"!==l.nodeName){const t=s.rowIndexMapper.getRenderableFromVisualIndex(r),e=s.columnIndexMapper.getRenderableFromVisualIndex(i);s.view._wt.getSetting("cellRenderer",t,e,l)}o(t)}Y(i)&&(i=function(t){return function(e,o){o(t.test(e))}}(i)),so(i)?(t=s.runHooks("beforeValidate",t,e.visualRow,e.prop,n),s._registerImmediate((()=>{i.call(e,t,(o=>{s&&(o=s.runHooks("afterValidate",o,t,e.visualRow,e.prop,n),e.valid=o,r(o),s.runHooks("postAfterValidate",o,t,e.visualRow,e.prop,n))}))}))):s._registerImmediate((()=>{e.valid=!0,r(e.valid,!1)}))},this.setDataAtCell=function(t,e,o,n){const i=N(t,e,o),r=[];let l,c,u,d=n;for(l=0,c=i.length;l<c;l++){if("object"!==typeof i[l])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof i[l][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");u=i[l][1]>=this.countCols()?i[l][1]:a.colToProp(i[l][1]),r.push([i[l][0],u,h.getAtCell(this.toPhysicalRow(i[l][0]),i[l][1]),i[l][2]])}d||"object"!==typeof t||(d=e);const g=_(r,n);s.runHooks("afterSetDataAtCell",g,d),O(g,d,(()=>{P(g,d)}))},this.setDataAtRowProp=function(t,e,o,n){const i=N(t,e,o),r=[];let l,a,c=n;for(l=0,a=i.length;l<a;l++)r.push([i[l][0],i[l][1],h.getAtCell(this.toPhysicalRow(i[l][0]),i[l][1]),i[l][2]]);c||"object"!==typeof t||(c=e);const u=_(r,n);s.runHooks("afterSetDataAtRowProp",u,c),O(u,c,(()=>{P(u,c)}))},this.listen=function(){s&&!s.isListening()&&(wv.forEach((t=>{s!==t&&t.unlisten()})),pv=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(pv=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return pv===s.guid},this.destroyEditor=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];s._refreshBorders(t,e)},this.populateFromArray=function(t,e,o,n,i,r,l){if("object"!==typeof o||"object"!==typeof o[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const a="number"===typeof n?s._createCellCoords(n,i):null;return c.populateFromArray(s._createCellCoords(t,e),o,a,r,l)},this.spliceCol=function(t,e,o){for(var n=arguments.length,i=new Array(n>3?n-3:0),r=3;r<n;r++)i[r-3]=arguments[r];return a.spliceCol(t,e,o,...i)},this.spliceRow=function(t,e,o){for(var n=arguments.length,i=new Array(n>3?n-3:0),r=3;r<n;r++)i[r-3]=arguments[r];return a.spliceRow(t,e,o,...i)},this.getSelected=function(){if(S.isSelected())return I(S.getSelectedRange(),(t=>{let{from:e,to:o}=t;return[e.row,e.col,o.row,o.col]}))},this.getSelectedLast=function(){const t=this.getSelected();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(S.isSelected())return Array.from(S.getSelectedRange())},this.getSelectedRangeLast=function(){const t=this.getSelectedRange();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(t){if(!S.isSelected()||0===this.countRows()||0===this.countCols())return;const e=[];A(S.getSelectedRange(),(t=>{if(t.isSingleHeader())return;const o=t.getTopStartCorner(),n=t.getBottomEndCorner();Pi(o.row,n.row,(t=>{Pi(o.col,n.col,(o=>{this.getCellMeta(t,o).readOnly||e.push([t,o,null])}))}))})),e.length>0&&this.setDataAtCell(e,t)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const t=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(t,0),this.isRenderSuspended()||t!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(u.lockEditor(),this._refreshBorders(null),u.unlockEditor()))},this.batchRender=function(t){this.suspendRender();const e=t();return this.resumeRender(),e},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(e,0),(!this.isExecutionSuspended()&&e===this.executionSuspendedCounter||t)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const o=t();return this.resumeExecution(e),o},this.batch=function(t){this.suspendRender(),this.suspendExecution();const e=t();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){if(!s.view)return;const{width:t,height:e}=s.view.getLastSize(),{width:o,height:n}=s.rootElement.getBoundingClientRect(),i=o!==t||n!==e,r=!1===s.runHooks("beforeRefreshDimensions",{width:t,height:e},{width:o,height:n},i);r||((i||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(o,n),s.render()),s.runHooks("afterRefreshDimensions",{width:t,height:e},{width:o,height:n},i))},this.updateData=function(t,e){ow(t,(t=>{a=t}),(t=>{a=t,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()}),{hotInstance:s,dataMap:a,dataSource:h,internalSource:"updateData",source:e,metaManager:p,firstRun:g})},this.loadData=function(t,e){ow(t,(t=>{a=t}),(()=>{p.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),g&&(g=[null,"loadData"])}),{hotInstance:s,dataMap:a,dataSource:h,internalSource:"loadData",source:e,metaManager:p,firstRun:g})},this.getInitialColumnCount=function(){const t=w.columns;let e=0;if(Array.isArray(t))e=t.length;else if(so(t))if("array"===s.dataType){const o=this.countSourceCols();for(let n=0;n<o;n+=1)t(n)&&(e+=1)}else"object"!==s.dataType&&"function"!==s.dataType||(e=a.colToPropCache.length);else if(U(w.dataSchema)){const t=a.getSchema();e=Array.isArray(t)?t.length:ko(t)}else e=this.countSourceCols();return e},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(t,e,o,n){return $(t)?a.getAll():a.getRange(s._createCellCoords(t,e),s._createCellCoords(o,n),a.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,o,n){return a.getCopyableText(s._createCellCoords(t,e),s._createCellCoords(o,n))},this.getCopyableData=function(t,e){return a.getCopyable(t,a.colToProp(e))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=(g?s.loadData:s.updateData).bind(this);let n,i,r=!1;if(U(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(U(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(U(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(n in t)"data"===n||("language"===n?E(t.language):"className"===n?T("className",t.className):"tableClassName"===n&&s.table?(T("tableClassName",t.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):bn.getSingleton().isRegistered(n)||bn.getSingleton().isDeprecated(n)?(so(t[n])||Array.isArray(t[n]))&&(t[n].initialHook=!0,s.addHook(n,t[n])):!e&&Ao(t,n)&&(v[n]=t[n]));void 0===t.data&&void 0===w.data?o(null,"updateSettings"):void 0!==t.data?o(t.data,"updateSettings"):void 0!==t.columns&&(a.createMap(),s.initIndexMappers());const l=s.countCols(),h=w.columns;if(h&&so(h)&&(r=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||p.clearCache(),l>0)for(n=0,i=0;n<l;n++){if(h){const t=r?h(n):h[i];t&&p.updateColumnMeta(i,t)}i+=1}U(t.cell)&&Mo(t.cell,(t=>{s.setCellMetaObject(t.row,t.col,t)})),s.runHooks("afterCellMetaReset");let d=s.rootElement.style.height;""!==d&&(d=parseInt(s.rootElement.style.height,10));let f=t.height;if(so(f)&&(f=f()),e){const t=s.rootElement.getAttribute("style");t&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"))}if(null===f){const t=s.rootElement.getAttribute("data-initialstyle");t&&(t.indexOf("height")>-1||t.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",t):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else void 0!==f&&(s.rootElement.style.height=isNaN(f)?`${f}`:`${f}px`,s.rootElement.style.overflow="hidden");if("undefined"!==typeof t.width){let e=t.width;so(e)&&(e=e()),s.rootElement.style.width=isNaN(e)?`${e}`:`${e}px`}e||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",t)),c.adjustRowsAndCols(),s.view&&!g&&(s.forceFullRender=!0,u.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),u.unlockEditor()),e||!s.view||""!==d&&""!==f&&void 0!==f||d===f||s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const t=s.getSelectedLast();if(w.getValue){if(so(w.getValue))return w.getValue.call(s);if(t)return s.getData()[t[0][0]][w.getValue]}else if(t)return s.getDataAtCell(t[0],t[1])},this.getSettings=function(){return w},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,o,n,i){c.alter(t,e,o,n,i)},this.getCell=function(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e,i=t;if(e>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(e)))return null;n=this.columnIndexMapper.getRenderableFromVisualIndex(e)}if(t>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(t)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(t)}return null===i||null===n?null:s.view.getCellAtCoords(s._createCellCoords(i,n),o)},this.getCoords=function(t){const e=this.view._wt.wtTable.getCoords(t);if(null===e)return null;const{row:o,col:n}=e;let i=o,r=n;return o>=0&&(i=this.rowIndexMapper.getVisualFromRenderableIndex(o)),n>=0&&(r=this.columnIndexMapper.getVisualFromRenderableIndex(n)),s._createCellCoords(i,r)},this.colToProp=function(t){return a.colToProp(t)},this.propToCol=function(t){return a.propToCol(t)},this.toVisualRow=t=>this.rowIndexMapper.getVisualFromPhysicalIndex(t),this.toVisualColumn=t=>this.columnIndexMapper.getVisualFromPhysicalIndex(t),this.toPhysicalRow=t=>this.rowIndexMapper.getPhysicalFromVisualIndex(t),this.toPhysicalColumn=t=>this.columnIndexMapper.getPhysicalFromVisualIndex(t),this.getDataAtCell=function(t,e){return a.get(t,a.colToProp(e))},this.getDataAtRowProp=function(t,e){return a.get(t,e)},this.getDataAtCol=function(t){const e=[],o=a.getRange(s._createCellCoords(0,t),s._createCellCoords(w.data.length-1,t),a.DESTINATION_RENDERER);for(let n=0;n<o.length;n+=1)for(let t=0;t<o[n].length;t+=1)e.push(o[n][t]);return e},this.getDataAtProp=function(t){const e=[],o=a.getRange(s._createCellCoords(0,a.propToCol(t)),s._createCellCoords(w.data.length-1,a.propToCol(t)),a.DESTINATION_RENDERER);for(let n=0;n<o.length;n+=1)for(let t=0;t<o[n].length;t+=1)e.push(o[n][t]);return e},this.getSourceData=function(t,e,o,n){let i;return i=void 0===t?h.getData():h.getByRange(s._createCellCoords(t,e),s._createCellCoords(o,n)),i},this.getSourceDataArray=function(t,e,o,n){let i;return i=void 0===t?h.getData(!0):h.getByRange(s._createCellCoords(t,e),s._createCellCoords(o,n),!0),i},this.getSourceDataAtCol=function(t){return h.getAtColumn(t)},this.setSourceDataAtCell=function(t,e,o,n){const i=N(t,e,o),r=this.hasHook("afterSetSourceDataAtCell"),l=[];r&&A(i,(t=>{let[e,o,n]=t;l.push([e,o,h.getAtCell(e,o),n])})),A(i,(t=>{let[e,o,n]=t;h.setAtCell(e,o,n)})),r&&this.runHooks("afterSetSourceDataAtCell",l,n),this.render();const a=s.getActiveEditor();a&&U(a.refreshValue)&&a.refreshValue()},this.getSourceDataAtRow=function(t){return h.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return h.getAtCell(t,e)},this.getDataAtRow=function(t){const e=a.getRange(s._createCellCoords(t,0),s._createCellCoords(t,this.countCols()-1),a.DESTINATION_RENDERER);return e[0]||[]},this.getDataType=function(t,e,o,n){const i=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,o,n],[r,s]=i;let[,,l,a]=i,h=null,c=null;void 0===l&&(l=r),void 0===a&&(a=s);let u="mixed";return Pi(Math.max(Math.min(r,l),0),Math.max(r,l),(t=>{let e=!0;return Pi(Math.max(Math.min(s,a),0),Math.max(s,a),(o=>{const n=this.getCellMeta(t,o);return c=n.type,h?e=h===c:h=c,e})),u=e?c:"mixed",e})),u},this.removeCellMeta=function(t,e,o){const[n,i]=[this.toPhysicalRow(t),this.toPhysicalColumn(e)];let r=p.getCellMetaKeyValue(n,i,o);const l=s.runHooks("beforeRemoveCellMeta",t,e,o,r);!1!==l&&(p.removeCellMeta(n,i,o),s.runHooks("afterRemoveCellMeta",t,e,o,r)),r=null},this.spliceCellsMeta=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var o=arguments.length,n=new Array(o>2?o-2:0),i=2;i<o;i++)n[i-2]=arguments[i];if(n.length>0&&!Array.isArray(n[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");e>0&&p.removeRow(this.toPhysicalRow(t),e),n.length>0&&A(n.reverse(),(e=>{p.createRow(this.toPhysicalRow(t)),A(e,((e,o)=>this.setCellMetaObject(t,o,e)))})),s.render()},this.setCellMetaObject=function(t,e,o){"object"===typeof o&&Mo(o,((o,n)=>{this.setCellMeta(t,e,n,o)}))},this.setCellMeta=function(t,e,o,n){const i=s.runHooks("beforeSetCellMeta",t,e,o,n);if(!1===i)return;let r=t,l=e;t<this.countRows()&&(r=this.toPhysicalRow(t)),e<this.countCols()&&(l=this.toPhysicalColumn(e)),p.setCellMeta(r,l,o,n),s.runHooks("afterSetCellMeta",t,e,o,n)},this.getCellsMeta=function(){return p.getCellsMeta()},this.getCellMeta=function(t,e){let o=this.toPhysicalRow(t),n=this.toPhysicalColumn(e);return null===o&&(o=t),null===n&&(n=e),p.getCellMeta(o,n,{visualRow:t,visualColumn:e})},this.getCellMetaAtRow=function(t){return p.getCellsMetaAtRow(t)},this.isColumnModificationAllowed=function(){return!("object"===s.dataType||w.columns)},this.getCellRenderer=function(t,e){const o="number"===typeof t?s.getCellMeta(t,e).renderer:t.renderer;return"string"===typeof o?cr(o):$(o)?cr("text"):o},this.getCellEditor=function(t,e){const o="number"===typeof t?s.getCellMeta(t,e).editor:t.editor;return"string"===typeof o?On(o):$(o)?On("text"):o},this.getCellValidator=function(t,e){const o="number"===typeof t?s.getCellMeta(t,e).validator:t.validator;return"string"===typeof o?wr(o):o},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,o){const n=new M;t&&(n.onQueueEmpty=t);let i=s.countRows()-1;while(i>=0){if(void 0!==e&&-1===e.indexOf(i)){i-=1;continue}let t=s.countCols()-1;while(t>=0)void 0===o||-1!==o.indexOf(t)?(n.addValidatorToQueue(),s.validateCell(s.getDataAtCell(i,t),s.getCellMeta(i,t),(t=>{if("boolean"!==typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(n.valid=!1),n.removeValidatorFormQueue()}),"validateCells"),t-=1):t-=1;i-=1}n.checkIfQueueIsEmpty()},this.getRowHeader=function(t){let e=w.rowHeaders,o=t;return void 0!==o&&(o=s.runHooks("modifyRowHeader",o)),void 0===o?(e=[],Pi(s.countRows()-1,(t=>{e.push(s.getRowHeader(t))}))):Array.isArray(e)&&void 0!==e[o]?e=e[o]:so(e)?e=e(o):e&&"string"!==typeof e&&"number"!==typeof e&&(e=o+1),e},this.hasRowHeaders=function(){return!!w.rowHeaders},this.hasColHeaders=function(){if(void 0!==w.colHeaders&&null!==w.colHeaders)return!!w.colHeaders;for(let t=0,e=s.countCols();t<e;t++)if(s.getColHeader(t))return!0;return!1},this.getColHeader=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const o=s.runHooks("modifyColHeader",t);if(void 0===o){const t=[],e=s.countCols();for(let o=0;o<e;o++)t.push(s.getColHeader(o));return t}let n=w.colHeaders;const i=function(t){const e=[],o=s.countCols();let n=0;for(;n<o;n++)so(w.columns)&&w.columns(n)&&e.push(n);return e[t]},r=s.toPhysicalColumn(o),l=i(r);return!1===w.colHeaders?n=null:w.columns&&so(w.columns)&&w.columns(l)&&w.columns(l).title?n=w.columns(l).title:w.columns&&w.columns[r]&&w.columns[r].title?n=w.columns[r].title:Array.isArray(w.colHeaders)&&void 0!==w.colHeaders[r]?n=w.colHeaders[r]:so(w.colHeaders)?n=w.colHeaders(r):w.colHeaders&&"string"!==typeof w.colHeaders&&"number"!==typeof w.colHeaders&&(n=Wc(o)),n=s.runHooks("modifyColumnHeaderValue",n,t,e),n},this._getColWidthFromSettings=function(t){let e;if(t>=0){const o=s.getCellMeta(0,t);e=o.width}if(void 0!==e&&e!==w.width||(e=w.colWidths),void 0!==e&&null!==e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t);break;default:break}"string"===typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(t){let e=s._getColWidthFromSettings(t);return e=s.runHooks("modifyColWidth",e,t),void 0===e&&(e=Rh.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){let e=w.rowHeights;if(void 0!==e&&null!==e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t);break;default:break}"string"===typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){let e=s._getRowHeightFromSettings(t);return e=s.runHooks("modifyRowHeight",e,t),e},this.countSourceRows=function(){return h.countRows()},this.countSourceCols=function(){return h.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const t=w.maxCols,e=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(t,e)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Ni(s.countRows()-1,(o=>{if(s.isEmptyRow(o))e+=1;else if(!0===t)return!1})),e},this.countEmptyCols=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Ni(s.countCols()-1,(o=>{if(s.isEmptyCol(o))e+=1;else if(!0===t)return!1})),e},this.isEmptyRow=function(t){return w.isEmptyRow.call(s,t)},this.isEmptyCol=function(t){return w.isEmptyCol.call(s,t)},this.selectCell=function(t,e,o,n){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!$(t)&&!$(e)&&this.selectCells([[t,e,o,n]],i,r)},this.selectCells=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===e&&(r=!0);const n=S.selectCells(t);return n&&o&&s.listen(),r=!1,n},this.selectColumns=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2?arguments[2]:void 0;return S.selectColumns(t,e,o)},this.selectRows=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2?arguments[2]:void 0;return S.selectRows(t,e,o)},this.deselectCell=function(){S.deselect()},this.selectAll=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2?arguments[2]:void 0;r=!0,S.selectAll(t,e,o),r=!1};const L=(t,e)=>t.getNearestNotHiddenIndex(e,1,!0);function D(t){return()=>{throw new Error(`The "${t}" method cannot be called because this Handsontable instance has been destroyed`)}}this.scrollViewportTo=function(){let t,e,o,n,{row:i,col:r,verticalSnap:l,horizontalSnap:a,considerHiddenIndexes:h}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};void 0!==l&&(t="top"===l,e=!t),void 0!==a&&(o="start"===a,n=!o);let c=i,u=r;if(void 0===h||h){const t=Number.isInteger(i)&&i>=0,e=Number.isInteger(r)&&r>=0,o=t?L(this.rowIndexMapper,i):void 0,n=e?L(this.columnIndexMapper,r):void 0;if(null===o||null===n)return!1;c=t?s.rowIndexMapper.getRenderableFromVisualIndex(o):i,u=e?s.columnIndexMapper.getRenderableFromVisualIndex(n):r}const d=Number.isInteger(c),g=Number.isInteger(u);return d&&c>=0&&g&&u>=0?s.view.scrollViewport(s._createCellCoords(c,u),t,n,e,o):d&&c>=0&&(g&&u<0||!g)?s.view.scrollViewportVertically(c,t,e):!!(g&&u>=0&&(d&&c<0||!d))&&s.view.scrollViewportHorizontally(u,n,o)},this.scrollToFocusedCell=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",t);const{highlight:e}=this.getSelectedRangeLast(),o=this.scrollViewportTo(e.toObject());o?this.view.render():(this.removeHook("afterScroll",t),this._registerImmediate((()=>t())))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),h&&h.destroy(),h=null,this.getShortcutManager().destroy(),p.clearCache(),wv.delete(this.guid),pc(s)){const t=this.rootDocument.querySelector(".hot-display-license-info");t&&t.parentNode.removeChild(t)}we(s.rootElement),l.destroy(),u&&u.destroy(),s.batchExecution((()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),C.getItems().forEach((t=>{let[,e]=t;e.destroy()})),C.clear(),s.runHooks("afterDestroy")}),!0),bn.getSingleton().destroy(s),Mo(s,((t,e,o)=>{so(t)?o[e]=D(e):"guid"!==e&&(o[e]=null)})),s.isDestroyed=!0,a&&a.destroy(),a=null,c=null,S=null,u=null,s=null},this.getActiveEditor=function(){return u.getActiveEditor()},this.getPlugin=function(t){const e=lt(t);return"UndoRedo"===e?this.undoRedo:C.getItem(e)},this.getPluginName=function(t){return t===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:C.getId(t)},this.getInstance=function(){return s},this.addHook=function(t,e){bn.getSingleton().add(t,e,s)},this.hasHook=function(t){return bn.getSingleton().has(t,s)||bn.getSingleton().has(t)},this.addHookOnce=function(t,e){bn.getSingleton().once(t,e,s)},this.removeHook=function(t,e){bn.getSingleton().remove(t,e,s)},this.runHooks=function(t,e,o,n,i,r,l){return bn.getSingleton().run(s,t,e,o,n,i,r,l)},this.getTranslatedPhrase=function(t,e){return mf(w.language,t,e)},this.toHTML=()=>xi(this),this.toTableElement=()=>{const t=this.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",xi(this)),t.firstElementChild},this.timeouts=[],this._registerTimeout=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t;"function"===typeof o&&(o=setTimeout(o,e)),this.timeouts.push(o)},this._clearTimeouts=function(){A(this.timeouts,(t=>{clearTimeout(t)}))},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){A(this.immediates,(t=>{clearImmediate(t)}))},this._refreshBorders=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];u.destroyEditor(t),s.view.render(),e&&S.isSelected()&&u.prepareEditor()},this._getEditorManager=function(){return u},this.isRtl=function(){return"rtl"===s.rootWindow.getComputedStyle(s.rootElement).direction},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const V=Rw({handleEvent(){return s.isListening()},beforeKeyDown:t=>this.runHooks("beforeKeyDown",t),afterKeyDown:t=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",t)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",(t=>{!1===t.ctrlKey&&!1===t.metaKey&&V.releasePressedKeys()})),this.getShortcutManager=function(){return V},this.getFocusManager=function(){return d},Zi().forEach((t=>{const e=tr(t);C.addItem(t,new e(this))})),mv(s),V.setActiveContextName("grid"),bn.getSingleton().run(s,"construct")}const Cv="hooksRefRegisterer",yv={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){A(this._hooksStorage[t]||[],(e=>{this.hot.removeHook(t,e)}))},clearHooks(){Mo(this._hooksStorage,((t,e)=>this.removeHooksByKey(e))),this._hooksStorage={}}};To(yv,"MIXIN_NAME",Cv,{writable:!1,enumerable:!1});var bv=yv;function Sv(t,e,o){return e=Rv(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Rv(t){var e=Ev(t,"string");return"symbol"===typeof e?e:String(e)}function Ev(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Tv="base",Mv=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Hv="baseEditor";class xv{static get EDITOR_TYPE(){return Tv}constructor(t){Sv(this,"hot",void 0),Sv(this,"state",Mv.VIRGIN),Sv(this,"_opened",!1),Sv(this,"_fullEditMode",!1),Sv(this,"_closeCallback",null),Sv(this,"TD",null),Sv(this,"row",null),Sv(this,"col",null),Sv(this,"prop",null),Sv(this,"originalValue",null),Sv(this,"cellProperties",null),this.hot=t,this.init()}_fireCallbacks(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(t,e,o,n,i,r){this.TD=n,this.row=t,this.col=e,this.prop=o,this.originalValue=i,this.cellProperties=r,this.state=Mv.VIRGIN}extend(){return class extends this.constructor{}}saveValue(t,e){let o,n,i,r;if(e){const t=this.hot.getSelectedLast();o=Math.max(Math.min(t[0],t[2]),0),n=Math.max(Math.min(t[1],t[3]),0),i=Math.max(t[0],t[2]),r=Math.max(t[1],t[3])}else[o,n,i,r]=[this.row,this.col,null,null];const s=this.hot.runHooks("modifyGetCellCoords",o,n);Array.isArray(s)&&([o,n]=s);const l=this.hot.getShortcutManager(),a=l.getContext("editor"),h={runOnlyIf:()=>U(this.hot.getSelected()),group:Hv};this.isInFullEditMode()&&a.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],h),this.hot.populateFromArray(o,n,t,i,r,"edit")}beginEditing(t,e){if(this.state!==Mv.VIRGIN)return;const o=this.hot,n=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(n,i)),this.state=Mv.EDITING,this.isInFullEditMode()){const e="string"===typeof t?t:z(this.originalValue);this.setValue(e)}this.open(e),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(t,e,o){let n;if(o){const t=this._closeCallback;this._closeCallback=e=>{t&&t(e),o(e),this.hot.view.render()}}if(this.isWaiting())return;const i=this.hot.getShortcutManager(),r=i.getContext("editor");if(r.removeShortcutsByGroup(Hv),r.removeShortcutsByGroup(Kn),this.state!==Mv.VIRGIN){if(this.state===Mv.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();const o=this.getValue();n=this.cellProperties.trimWhitespace?[["string"===typeof o?String.prototype.trim.call(o||""):o]]:[[o]],this.state=Mv.WAITING,this.saveValue(n,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(t=>{this.state=Mv.FINISHED,this.discardEditor(t)})):(this.state=Mv.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=Mv.FINISHED,this.discardEditor()}discardEditor(t){if(this.state===Mv.FINISHED)if(!1===t&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=Mv.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Mv.VIRGIN,this._fireCallbacks(!0);const t=this.hot.getShortcutManager();t.setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Mv.WAITING}getEditedCellRect(){var t;const e=this.getEditedCell();if(!e)return;const{wtOverlays:o,wtViewport:n}=this.hot.view._wt,i=this.hot.rootWindow,r=Se(e),s=Oe(e),l=Se(this.hot.rootElement),a=Oe(this.hot.rootElement),h=o.topOverlay.holder,c=o.inlineStartOverlay.holder,u=h!==i?h.scrollTop:0,d=c!==i?c.scrollLeft:0,g=i.innerWidth-l.left-a,{wtTable:f}=null!==(t=o.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,m=f.name,p=["master","inline_start"].includes(m)?u:0,w=["master","top","bottom"].includes(m)?d:0,v=r.top===l.top?0:1;let C=r.top-l.top-v-p,y=0;y=this.hot.isRtl()?i.innerWidth-r.left-s-g-1+w:r.left-l.left-1-w,["top","top_inline_start_corner"].includes(m)&&(C+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(y+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));const b=this.hot.hasColHeaders(),S=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),E=this.hot.rowIndexMapper.getRenderableIndexesLength(),T=E-this.hot.view._wt.getSetting("fixedRowsBottom");(b&&S<=0||S===T)&&(C+=1),R<=0&&(y+=1);const M=n.rowsRenderCalculator.startPosition,H=n.columnsRenderCalculator.startPosition,x=Math.abs(o.inlineStartOverlay.getScrollPosition()),k=o.topOverlay.getScrollPosition(),I=$e(this.hot.rootDocument);let A=e.offsetTop;if(["inline_start","master"].includes(m)&&(A+=M-k),["bottom","bottom_inline_start_corner"].includes(m)){const{wtViewport:t,wtTable:e}=o.bottomOverlay.clone;A+=t.getWorkspaceHeight()-e.getHeight()-I}let O=e.offsetLeft;this.hot.isRtl()?(O=O>=0?f.getWidth()-e.offsetLeft:Math.abs(O),O+=H-x-s):["top","master","bottom"].includes(m)&&(O+=H-x);const P=Ae(this.TD,this.hot.rootWindow),N=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",_=parseInt(P[N],10)>0?0:1,L=parseInt(P.borderTopWidth,10)>0?0:1,D=Oe(e)+_,W=Pe(e)+L,V=Ge(h)?I:0,F=Ye(c)?I:0,j=this.hot.view.maximumVisibleElementWidth(O)-V+_,B=Math.max(this.hot.view.maximumVisibleElementHeight(A)-F+L,23);return{top:C,start:y,height:W,maxHeight:B,width:D,maxWidth:j}}getEditedCellsLayerClass(){const t=this.checkEditorSection();switch(t){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const t=this.hot.countRows();let e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}function kv(){var t,e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},o=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),r=function(t,e,o){t.addEventListener(e,o,!1)},s=function(t,e,o){t.removeEventListener(e,o,!1)},l=function(r){var s,l;r?/^[a-zA-Z \.,\\\/\|0-9]$/.test(r)||(r="."):r="",void 0!==n.textContent?n.textContent=t.value+r:n.data=t.value+r,i.style.position="absolute",i.style.fontSize=u(t).fontSize,i.style.fontFamily=u(t).fontFamily,i.style.whiteSpace="pre",o.appendChild(i),s=i.clientWidth+2,o.removeChild(i),t.style.height=e.minHeight+"px",e.minWidth>s?t.style.width=e.minWidth+"px":s>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=s+"px",l=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>l?t.style.height=e.minHeight+"px":e.maxHeight<l?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=l+"px"},a=function(){window.setTimeout(l,0)},h=function(o){if(o&&o.minHeight)if("inherit"==o.minHeight)e.minHeight=t.clientHeight;else{var r=parseInt(o.minHeight);isNaN(r)||(e.minHeight=r)}if(o&&o.maxHeight)if("inherit"==o.maxHeight)e.maxHeight=t.clientHeight;else{var s=parseInt(o.maxHeight);isNaN(s)||(e.maxHeight=s)}if(o&&o.minWidth)if("inherit"==o.minWidth)e.minWidth=t.clientWidth;else{var l=parseInt(o.minWidth);isNaN(l)||(e.minWidth=l)}if(o&&o.maxWidth)if("inherit"==o.maxWidth)e.maxWidth=t.clientWidth;else{var a=parseInt(o.maxWidth);isNaN(a)||(e.maxWidth=a)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},c=function(o,n,i){t=o,h(n),"TEXTAREA"==t.nodeName&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),i&&(r(t,"change",l),r(t,"cut",a),r(t,"paste",a),r(t,"drop",a),r(t,"keydown",a),r(t,"focus",l),r(t,"compositionstart",a),r(t,"compositionupdate",a),r(t,"compositionend",a)),l()};function u(t){return t.currentStyle||document.defaultView.getComputedStyle(t)}return{init:function(t,e,o){c(t,e,o)},unObserve:function(){s(t,"change",l),s(t,"cut",a),s(t,"paste",a),s(t,"drop",a),s(t,"keydown",a),s(t,"focus",l),s(t,"compositionstart",a),s(t,"compositionupdate",a),s(t,"compositionend",a)},resize:l}}function Iv(t,e){const o=We(e),n=e.value.split("\n");let i=o,r=0;for(let s=0;s<n.length;s++){const e=n[s];0!==s&&(r+=n[s-1].length+1);const l=r+e.length;if("home"===t?i=r:"end"===t&&(i=l),o<=l)break}Be(e,i)}function Av(t,e,o){return e=Ov(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ov(t){var e=Pv(t,"string");return"symbol"===typeof e?e:String(e)}function Pv(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}So(xv,bv);const Nv="ht_editor_visible",_v="ht_editor_hidden",Lv="textEditor",Dv="text";class Wv extends xv{static get EDITOR_TYPE(){return Dv}constructor(t){super(t),Av(this,"eventManager",new Fn(this)),Av(this,"autoResize",kv()),Av(this,"TEXTAREA",void 0),Av(this,"textareaStyle",void 0),Av(this,"TEXTAREA_PARENT",void 0),Av(this,"textareaParentStyle",void 0),Av(this,"layerClass",void 0),this.eventManager=new Fn(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(t){this.TEXTAREA.value=t}open(){this.refreshDimensions(),this.showEditableElement();const t=this.hot.getShortcutManager();t.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",(t=>this.onAfterDocumentKeyDown(t))),this.registerShortcuts()}close(){this.autoResize.unObserve(),te(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(t,e,o,n,i,r){const s=this.state;if(super.prepare(t,e,o,n,i,r),!r.readOnly){this.refreshDimensions(!0);const{allowInvalid:t}=r;t&&(this.TEXTAREA.value=""),s!==Mv.FINISHED&&this.hideEditableElement()}}beginEditing(t,e){this.state===Mv.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(t,e))}focus(){this.TEXTAREA.select(),Be(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:t}=this.hot;this.TEXTAREA=t.createElement("TEXTAREA"),fe(this.TEXTAREA,[["data-hot-input",""],ft(-1)]),this.hot.getSettings().ariaTags&&fe(this.TEXTAREA,[Ot()]),de(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),de(this.TEXTAREA_PARENT,"handsontableInputHolder"),ue(this.TEXTAREA_PARENT,this.layerClass)&&ge(this.TEXTAREA_PARENT,this.layerClass),de(this.TEXTAREA_PARENT,_v),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Bo()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ge(this.TEXTAREA_PARENT,this.layerClass),de(this.TEXTAREA_PARENT,_v)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const t=this.TEXTAREA_PARENT.childNodes;let e=!1;Pi(t.length-1,(o=>{const n=t[o];if(ue(n,"handsontableEditor"))return e=!0,!1})),ue(this.TEXTAREA_PARENT,_v)&&ge(this.TEXTAREA_PARENT,_v),e?(this.layerClass=Nv,de(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),de(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==Mv.EDITING&&!t)return;if(this.TD=this.getEditedCell(),!this.TD)return void(t||this.close());const{top:e,start:o,width:n,maxWidth:i,height:r,maxHeight:s}=this.getEditedCellRect();this.textareaParentStyle.top=`${e}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${o}px`,this.showEditableElement();const l=Ae(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const a=Ae(this.TEXTAREA),h=parseInt(a.paddingLeft,10)+parseInt(a.paddingRight,10),c=parseInt(a.paddingTop,10)+parseInt(a.paddingBottom,10),u=n-h,d=r-c,g=i-h,f=s-c;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(u,g),minHeight:Math.min(d,f),maxWidth:g,maxHeight:f},!0)}bindEvents(){$o()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.state===Mv.EDITING&&this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.state===Mv.EDITING&&this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor"),o={runOnlyIf:()=>U(this.hot.getSelected()),group:Lv},n=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"]],callback:t=>{const e=this.hot.getSettings(),o="function"===typeof e.tabMoves?e.tabMoves(t):e.tabMoves;this.hot.selection.transformStart(o.row,o.col,!0)}},{keys:[["Shift","Tab"]],callback:t=>{const e=this.hot.getSettings(),o="function"===typeof e.tabMoves?e.tabMoves(t):e.tabMoves;this.hot.selection.transformStart(-o.row,-o.col)}},{keys:[["Control","Enter"]],callback:()=>(n(),!1),runOnlyIf:t=>!this.hot.selection.isMultiple()&&!t.altKey},{keys:[["Meta","Enter"]],callback:()=>(n(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(n(),!1)},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(t,e)=>{let[o]=e;Iv(o,this.TEXTAREA)}},{keys:[["End"]],callback:(t,e)=>{let[o]=e;Iv(o,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout((()=>{this.autoResize.resize()}),10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout((()=>{this.autoResize.resize()}),10)}}],o)}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(Kn),e.removeShortcutsByGroup(Lv),e.removeShortcutsByGroup(Hv)}onAfterDocumentKeyDown(t){const e=[qo.ARROW_UP,qo.ARROW_RIGHT,qo.ARROW_DOWN,qo.ARROW_LEFT];-1===e.indexOf(t.keyCode)&&this.autoResize.resize(String.fromCharCode(t.keyCode))}}const Vv="base";function Fv(t,e,o,n,i,r,s){const l=s.ariaTags,a=[],h=[],c=[],u=[];s.className&&de(e,s.className),s.readOnly?(a.push(s.readOnlyCellClassName),l&&u.push(Bt())):l&&c.push(Bt()[0]),!1===s.valid&&s.invalidCellClassName?(a.push(s.invalidCellClassName),l&&u.push(zt())):(h.push(s.invalidCellClassName),l&&c.push(zt()[0])),!1===s.wordWrap&&s.noWordWrapClassName&&a.push(s.noWordWrapClassName),!r&&s.placeholder&&a.push(s.placeholderCellClassName),ge(e,h),de(e,a),me(e,c),fe(e,u)}Fv.RENDERER_TYPE=Vv;const jv="text";function Bv(t,e,o,n,i,r,s){Fv.apply(this,[t,e,o,n,i,r,s]);let l=r;if(!l&&s.placeholder&&(l=s.placeholder),l=z(l),s.trimWhitespace&&(l=l.trim()),s.rendererTemplate){we(e);const n=t.rootDocument.createElement("TEMPLATE");n.setAttribute("bind","{{}}"),n.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(n),n.model=t.getSourceDataAtRow(o),e.appendChild(n)}else ye(e,l)}Bv.RENDERER_TYPE=jv;const zv="text",Uv={CELL_TYPE:zv,editor:Wv,renderer:Bv};function $v(t,e){const o=new vv(t,e||{},gc);return o.init(),o}sp(Uv),$v.editors={BaseEditor:xv},$v.Core=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new vv(t,e,gc)},$v.DefaultSettings=gp(),$v.hooks=bn.getSingleton(),$v.CellCoords=Nl,$v.CellRange=Yl,$v.packageName="handsontable",$v.buildDate="07/11/2023 13:34:02",$v.version="13.1.0",$v.languages={dictionaryKeys:nf,getLanguageDictionary:df,getLanguagesDictionaries:ff,registerLanguageDictionary:cf,getTranslatedPhrase:mf};var Gv=$v,Yv=o(1711);function Kv(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function Xv(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Kv(Object(o),!0).forEach((function(e){tC(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Kv(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function qv(t){return qv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qv(t)}function Qv(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jv(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hC(n.key),n)}}function Zv(t,e,o){return e&&Jv(t.prototype,e),o&&Jv(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function tC(t,e,o){return e=hC(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function eC(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nC(t,e)}function oC(t){return oC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},oC(t)}function nC(t,e){return nC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},nC(t,e)}function iC(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function rC(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sC(t,e){if(e&&("object"===typeof e||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rC(t)}function lC(t){var e=iC();return function(){var o,n=oC(t);if(e){var i=oC(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return sC(this,o)}}function aC(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function hC(t){var e=aC(t,"string");return"symbol"===typeof e?e:String(e)}var cC=Symbol("unassigned"),uC=null,dC="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function gC(t){t.hotInstance&&(t.hotInstance.addHook("beforeChange",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateCol",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveCol",(function(){t.__internalEdit=!0})))}function fC(t){var e=Gv.hooks.getRegistered(),o={};for(var n in Object.assign(o,Gv.DefaultSettings),o)o[n]={default:cC};for(var i=0;i<e.length;i++)o[e[i]]={default:cC};return o.settings={default:cC},"HotTable"===t&&(o.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},o.wrapperRendererCacheSize={type:Number,default:3e3}),o}function mC(t){var e={},o=t["settings"];if(o!==cC)for(var n in o)o.hasOwnProperty(n)&&o[n]!==cC&&(e[n]=o[n]);for(var i in t)t.hasOwnProperty(i)&&"settings"!==i&&t[i]!==cC&&(e[i]=t[i]);return e}function pC(t,e){var o=mC(t),n=t.settings?t.settings:o,i=t.settings?o:null,r={};for(var s in n)!n.hasOwnProperty(s)||void 0===n[s]||e&&"data"!==s&&yC(e[s],n[s])||(r[s]=n[s]);for(var l in i)!i.hasOwnProperty(l)||"id"===l||"settings"===l||"wrapperRendererCacheSize"===l||void 0===i[l]||e&&"data"!==l&&yC(e[l],i[l])||(r[l]=i[l]);return r}function wC(t,e){var o=null;return t.every((function(t,n){return!t.data||!t.data.attrs||void 0===t.data.attrs[e]||(o=t,!1)})),o}function vC(t){return t.filter((function(t){return"HotColumn"===t.$options.name}))}function CC(t,e,o,n){var i=e.$el?e.$el.ownerDocument:document,r={propsData:o,parent:e,data:n};uC||(uC=i.createElement("DIV"),uC.id="vueHotComponents",i.body.appendChild(uC));var s=i.createElement("DIV");return uC.appendChild(s),new t.componentOptions.Ctor(r).$mount(s)}function yC(t,e){return JSON.stringify(t)===JSON.stringify(e)}var bC="13.1.0";"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self&&self;function SC(t,e){return e={exports:{}},t(e,e.exports),e.exports}var RC=SC((function(t,e){(function(t,o){var n=e;o(n)})(0,(function(t){var e=Symbol("newer"),o=Symbol("older");function n(t,e){"number"!==typeof t&&(e=t,t=0),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this._keymap=new Map,e&&(this.assign(e),t<1&&(this.limit=this.size))}function i(t,n){this.key=t,this.value=n,this[e]=void 0,this[o]=void 0}t.LRUMap=n,n.prototype._markEntryAsUsed=function(t){t!==this.newest&&(t[e]&&(t===this.oldest&&(this.oldest=t[e]),t[e][o]=t[o]),t[o]&&(t[o][e]=t[e]),t[e]=void 0,t[o]=this.newest,this.newest&&(this.newest[e]=t),this.newest=t)},n.prototype.assign=function(t){var n,r=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var s=t[Symbol.iterator](),l=s.next();!l.done;l=s.next()){var a=new i(l.value[0],l.value[1]);if(this._keymap.set(a.key,a),n?(n[e]=a,a[o]=n):this.oldest=a,n=a,0==r--)throw new Error("overflow")}this.newest=n,this.size=this._keymap.size},n.prototype.get=function(t){var e=this._keymap.get(t);if(e)return this._markEntryAsUsed(e),e.value},n.prototype.set=function(t,n){var r=this._keymap.get(t);return r?(r.value=n,this._markEntryAsUsed(r),this):(this._keymap.set(t,r=new i(t,n)),this.newest?(this.newest[e]=r,r[o]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift(),this)},n.prototype.shift=function(){var t=this.oldest;if(t)return this.oldest[e]?(this.oldest=this.oldest[e],this.oldest[o]=void 0):(this.oldest=void 0,this.newest=void 0),t[e]=t[o]=void 0,this._keymap["delete"](t.key),--this.size,[t.key,t.value]},n.prototype.has=function(t){return this._keymap.has(t)}}))})),EC=RC.LRUMap,TC={name:"HotTable",props:fC("HotTable"),watch:{mergedHotSettings:function(t){this.hotInstance&&void 0!==t&&(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var t=this,e=new EC(this.wrapperRendererCacheSize);return e.shift=function(){var t=EC.prototype.shift.call(this);return t[1].component.$destroy(),t},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:e,editorCache:new Map,get hotInstance(){return!t.__hotInstance||t.__hotInstance&&!t.__hotInstance.isDestroyed?t.__hotInstance:(console.warn(dC),null)},set hotInstance(e){t.__hotInstance=e}}},computed:{mergedHotSettings:function(){return pC(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var t=this.getGlobalRendererVNode(),e=this.getGlobalEditorVNode(),o=pC(this.$props);o.columns=this.columnSettings?this.columnSettings:o.columns,e&&(o.editor=this.getEditorClass(e,this),e.child.$destroy()),t&&(o.renderer=this.getRendererWrapper(t,this),t.child.$destroy()),this.hotInstance=new Gv.Core(this.$el,o),this.hotInstance.init(),gC(this),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var e,o=this.hotInstance.getSourceData(),n=[],i=[],r=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),l=0;if(o&&o.length!==r&&o.length<r)for(var a=o.length;a<r;a++)n.push(a);if(s)if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),o&&o[0]&&(null===(e=o[0])||void 0===e?void 0:e.length)!==l&&o[0].length<l)for(var h=o[0].length;h<l;h++)i.push(h);this.hotInstance.batch((function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(r-1,o.length-r),s&&0!==o.length&&(i.length>0?t.hotInstance.columnIndexMapper.removeIndexes(i):t.hotInstance.columnIndexMapper.insertIndexes(l-1,o[0].length-l))}))}},getGlobalRendererVNode:function(){var t=this.$slots["default"]||[];return wC(t,"hot-renderer")},getGlobalEditorVNode:function(){var t=this.$slots["default"]||[];return wC(t,"hot-editor")},getColumnSettings:function(){var t=vC(this.$children),e=!1,o=t.map((function(t){return t.usesRendererComponent&&(e=!0),Xv({},t.columnSettings)}));return e&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),o.length?o:void 0},getRendererWrapper:function(t,e){var o=this;return function(n,i,r,s,l,a,h){if(i&&!i.getAttribute("ghost-table")){var c=o.rendererCache,u={hotInstance:n,TD:i,row:r,col:s,prop:l,value:a,cellProperties:h,isRenderer:!0};if(c&&!c.has("".concat(r,"-").concat(s))){var d=CC(t,e,t.componentOptions.propsData,u);c.set("".concat(r,"-").concat(s),{component:d,lastUsedTD:null})}var g=c.get("".concat(r,"-").concat(s)),f=g.component,m=g.lastUsedTD;if(Object.assign(f.$data,u),!f.$el.parentElement||m!==i){while(i.firstChild)i.removeChild(i.firstChild);i.appendChild(f.$el),g.lastUsedTD=i}}return i}},getEditorClass:function(t,e){var o=t.key?t.key.toString():null,n=t.componentOptions.Ctor.options.name,i=o?"".concat(n,":").concat(o):n,r=this.editorCache,s=null;return r.has(i)?s=r.get(i):(s=CC(t,e,t.componentOptions.propsData,{isEditor:!0}),r.set(i,s)),s.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:bC};function MC(t,e,o,n,i,r,s,l,a,h){"boolean"!==typeof s&&(a=l,l=s,s=!1);const c="function"===typeof o?o.options:o;let u;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),n&&(c._scopeId=n),r?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,a(t)),t&&t._registeredComponents&&t._registeredComponents.add(r)},c._ssrRegister=u):e&&(u=s?function(t){e.call(this,h(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,l(t))}),u)if(c.functional){const t=c.render;c.render=function(e,o){return u.call(o),t(e,o)}}else{const t=c.beforeCreate;c.beforeCreate=t?[].concat(t,u):[u]}return o}var HC=TC,xC=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:t.id}},[t._t("default")],2)},kC=[],IC=void 0,AC=void 0,OC=void 0,PC=!1,NC=MC({render:xC,staticRenderFns:kC},IC,HC,AC,PC,OC,!1,void 0,void 0,void 0);fC("HotColumn");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function _C(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s}function LC(t){return LC="function"===typeof Symbol&&"symbol"===qv(Symbol.iterator)?function(t){return qv(t)}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":qv(t)},LC(t)}function DC(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function WC(t){return VC(t)||FC(t)||jC()}function VC(t){if(Array.isArray(t)){for(var e=0,o=new Array(t.length);e<t.length;e++)o[e]=t[e];return o}}function FC(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function jC(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function BC(){return"undefined"!==typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function zC(t,e){UC(t,e),Object.getOwnPropertyNames(e.prototype).forEach((function(o){UC(t.prototype,e.prototype,o)})),Object.getOwnPropertyNames(e).forEach((function(o){UC(t,e,o)}))}function UC(t,e,o){var n=o?Reflect.getOwnMetadataKeys(e,o):Reflect.getOwnMetadataKeys(e);n.forEach((function(n){var i=o?Reflect.getOwnMetadata(n,e,o):Reflect.getOwnMetadata(n,e);o?Reflect.defineMetadata(n,i,t,o):Reflect.defineMetadata(n,i,t)}))}var $C={__proto__:[]},GC=$C instanceof Array;function YC(t){var e=LC(t);return null==t||"object"!==e&&"function"!==e}function KC(t,e){var o=e.prototype._init;e.prototype._init=function(){var e=this,o=Object.getOwnPropertyNames(t);if(t.$options.props)for(var n in t.$options.props)t.hasOwnProperty(n)||o.push(n);o.forEach((function(o){Object.defineProperty(e,o,{get:function(){return t[o]},set:function(e){t[o]=e},configurable:!0})}))};var n=new e;e.prototype._init=o;var i={};return Object.keys(n).forEach((function(t){void 0!==n[t]&&(i[t]=n[t])})),i}var XC=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function qC(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.name=e.name||t._componentTag||t.name;var o=t.prototype;Object.getOwnPropertyNames(o).forEach((function(t){if("constructor"!==t)if(XC.indexOf(t)>-1)e[t]=o[t];else{var n=Object.getOwnPropertyDescriptor(o,t);void 0!==n.value?"function"===typeof n.value?(e.methods||(e.methods={}))[t]=n.value:(e.mixins||(e.mixins=[])).push({data:function(){return DC({},t,n.value)}}):(n.get||n.set)&&((e.computed||(e.computed={}))[t]={get:n.get,set:n.set})}})),(e.mixins||(e.mixins=[])).push({data:function(){return KC(this,t)}});var n=t.__decorators__;n&&(n.forEach((function(t){return t(e)})),delete t.__decorators__);var i=Object.getPrototypeOf(t.prototype),r=i instanceof Yv.Z?i.constructor:Yv.Z,s=r.extend(e);return JC(s,t,r),BC()&&zC(s,t),s}var QC={prototype:!0,arguments:!0,callee:!0,caller:!0};function JC(t,e,o){Object.getOwnPropertyNames(e).forEach((function(n){if(!QC[n]){var i=Object.getOwnPropertyDescriptor(t,n);if(!i||i.configurable){var r=Object.getOwnPropertyDescriptor(e,n);if(!GC){if("cid"===n)return;var s=Object.getOwnPropertyDescriptor(o,n);if(!YC(r.value)&&s&&s.value===r.value)return}Object.defineProperty(t,n,r)}}}))}function ZC(t){return"function"===typeof t?qC(t):function(e){return qC(e,t)}}ZC.registerHooks=function(t){XC.push.apply(XC,WC(t))};var ty=function(t){eC(o,t);var e=lC(o);function o(){var t;return Qv(this,o),t=e.apply(this,arguments),t.name="BaseEditorComponent",t.instance=null,t.row=null,t.col=null,t.prop=null,t.TD=null,t.originalValue=null,t.cellProperties=null,t.state=null,t.hot=null,t}return Zv(o,[{key:"mounted",value:function(){var t=this;this.$data.hotCustomEditorClass=function(){var e=function(e){eC(n,e);var o=lC(n);function n(e){var i;return Qv(this,n),i=o.call(this,e),t.$data.hotCustomEditorInstance=rC(i),i}return Zv(n,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),n}(Gv.editors.BaseEditor);return Object.getOwnPropertyNames(Gv.editors.BaseEditor.prototype).forEach((function(o){"constructor"!==o&&(e.prototype[o]=function(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t[o]).call.apply(e,[this].concat(i))})})),e}()}},{key:"_fireCallbacks",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];(t=Gv.editors.BaseEditor.prototype._fireCallbacks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"beginEditing",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.beginEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"cancelChanges",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.cancelChanges).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"checkEditorSection",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.checkEditorSection).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"close",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.close).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"discardEditor",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.discardEditor).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"enableFullEditMode",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.enableFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"extend",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.extend).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"finishEditing",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.finishEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"focus",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.focus).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getValue",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.getValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"init",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.init).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isInFullEditMode",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.isInFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isOpened",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.isOpened).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isWaiting",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.isWaiting).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"open",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.open).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"prepare",value:function(t,e,o,n,i,r){return this.$data.hotInstance=r.instance,this.$data.row=t,this.$data.col=e,this.$data.prop=o,this.$data.TD=n,this.$data.originalValue=i,this.$data.cellProperties=r,Gv.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,t,e,o,n,i,r)}},{key:"saveValue",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.saveValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"setValue",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.setValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"addHook",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.addHook).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"removeHooksByKey",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.removeHooksByKey).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"clearHooks",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.clearHooks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCell",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.getEditedCell).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellRect",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.getEditedCellRect).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellsZIndex",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellsLayerClass",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Gv.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}}]),o}(Yv.Z);ty=_C([ZC({})],ty);var ey=[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]],oy="selected",ny="odd";function iy(){return ey}const ry="handsontableEditor",sy="handsontable";class ly extends Wv{static get EDITOR_TYPE(){return sy}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Be(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions(),this.hot.getSettings().ariaTags&&fe(this.TD,[Ft("true")])}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&fe(this.TD,[Ft("false")])}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r);const s=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(t,e){const o=this.getSourceData(e.row,e.col);void 0!==o&&s.setValue(o),s.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&vo(l,r.handsontable),this.htOptions=l}beginEditing(t,e){const o=this.hot.getSettings().onBeginEditing;o&&!1===o()||super.beginEditing(t,e)}createElements(){super.createElements();const t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}finishEditing(t,e,o){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const t=this.htEditor.getValue();void 0!==t&&this.setValue(t)}super.finishEditing(t,e,o)}assignHooks(){this.hot.addHook("afterDestroy",(()=>{this.htEditor&&this.htEditor.destroy()}))}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");super.registerShortcuts();const o={group:ry,relativeToGroup:Kn,position:"before"},n=(t,e)=>{const o=this.htEditor;if(void 0!==t&&(t<0||o.flipped&&t>o.countRows()-1?o.deselectCell():o.selectCell(t,0),o.getData().length))return e.preventDefault(),nn(e),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:t=>{const e=this.htEditor;let o,i;return!e.getSelectedLast()&&e.flipped?o=e.countRows()-1:e.getSelectedLast()&&(e.flipped?(i=e.getSelectedLast()[0],o=Math.max(0,i-1)):(i=e.getSelectedLast()[0],o=i-1)),n(o,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:t=>{const e=this.htEditor;let o,i;if(e.getSelectedLast()||e.flipped){if(e.getSelectedLast())if(e.flipped)o=e.getSelectedLast()[0]+1;else if(!e.flipped){const t=e.countRows()-1;i=e.getSelectedLast()[0],o=Math.min(t,i+1)}}else o=0;return n(o,t)},preventDefault:!1}],o)}unregisterShortcuts(){super.unregisterShortcuts();const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(ry)}}function ay(t,e,o){hy(t,e),e.set(t,o)}function hy(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cy(t,e,o){return e=uy(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function uy(t){var e=dy(t,"string");return"symbol"===typeof e?e:String(e)}function dy(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function gy(t,e){var o=fy(t,e,"get");return my(t,o)}function fy(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function my(t,e){return e.get?e.get.call(t):e.value}const py="autocomplete";var wy=new WeakMap;class vy extends ly{constructor(){super(...arguments),cy(this,"query",null),cy(this,"strippedChoices",[]),cy(this,"rawChoices",[]),ay(this,wy,{writable:!0,value:this.hot.guid.slice(0,9)}),cy(this,"sortByRelevance",(function(t,e,o){const n=[],i=[],r=t.length;let s,l,a,h,c=e.length;if(0===r){for(a=0;a<c;a++)i.push(a);return i}for(a=0;a<c;a++){if(l=dt(z(e[a])),o)h=l.indexOf(t);else{const e=this.cellProperties.locale;h=l.toLocaleLowerCase(e).indexOf(t.toLocaleLowerCase(e))}-1!==h&&(s=l.length-h-r,n.push({baseIndex:a,index:h,charsLeft:s,value:l}))}for(n.sort(((t,e)=>{if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0})),a=0,c=n.length;a<c;a++)i.push(n[a].baseIndex);return i}))}static get EDITOR_TYPE(){return py}getValue(){const t=this.rawChoices.find((t=>{const e=this.stripValueIfNeeded(t);return e===this.TEXTAREA.value}));return U(t)?t:this.TEXTAREA.value}createElements(){super.createElements(),de(this.htContainer,"autocompleteEditor"),de(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&fe(this.TEXTAREA,[kt(),Rt(),_t("listbox"),Gt()])}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r),this.hot.getSettings().ariaTags&&fe(this.TEXTAREA,[Ft("false"),Yt(`${gy(this,wy)}-listbox-${t}-${e}`)])}open(){super.open();const t=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,e=this.hot.getSettings().ariaTags,o=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,n=null===o||void 0===o?void 0:o.length,{row:i,col:r}=this;this.showEditableElement(),this.focus();let s=$e();0===s&&Ko()&&(s+=15),this.addHook("beforeKeyDown",(t=>this.onBeforeKeyDown(t))),this.htEditor.updateSettings({colWidths:t?[Oe(this.TEXTAREA)-2]:void 0,width:t?Oe(this.TEXTAREA)+s:void 0,autoColumnSize:!0,renderer:(t,i,r,s,l,a,h)=>{Bv(t,i,r,s,l,a,h);const{filteringCaseSensitive:c,allowHtml:u,locale:d}=this.cellProperties,g=this.query;let f,m,p=z(a);p&&!u&&(f=!0===c?p.indexOf(g):p.toLocaleLowerCase(d).indexOf(g.toLocaleLowerCase(d)),-1!==f&&(m=p.substr(f,g.length),p=p.replace(m,`<strong>${m}</strong>`))),e&&fe(i,[Tt(),...o?[Qt(n)]:[],...o?[Jt(o.indexOf(a)+1)]:[],["id",`${this.htEditor.rootElement.id}_${r}-${s}`]]),i.innerHTML=p},afterSelection:(t,o)=>{if(e){const e=this.htEditor.getCell(t,o,!0);fe(e,[$t()]),fe(this.TEXTAREA,...Kt(e.id))}}}),e&&(fe(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...pt()),fe(this.htEditor.rootElement,[Et(),Xt("polite"),qt("text"),["id",`${gy(this,wy)}-listbox-${i}-${r}`]]),fe(this.TEXTAREA,...Ft("true"))),this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}))}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&fe(this.TEXTAREA,[Ft("false")])}discardEditor(t){super.discardEditor(t),this.hot.view.render()}queryChoices(t){const e=this.cellProperties.source;this.query=t,"function"===typeof e?e.call(this.cellProperties,t,(t=>{this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))})):Array.isArray(e)?(this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))):this.updateChoicesList([])}updateChoicesList(t){const e=We(this.TEXTAREA),o=Ve(this.TEXTAREA),n=this.cellProperties.sortByRelevance,i=this.cellProperties.filter;let r=null,s=null,l=t;n&&(r=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const a=Array.isArray(r)?r.length:0;if(!1===i)a&&(s=r[0]);else{const t=[];for(let e=0,o=l.length;e<o;e++){if(n&&a<=e)break;a?t.push(l[r[e]]):t.push(l[e])}s=0,l=t}this.strippedChoices=l,this.htEditor.loadData(H([l])),0===l.length?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(s)),this.hot.listen(),Be(this.TEXTAREA,e,e===o?void 0:o)}flipDropdownIfNeeded(){const t=xe(this.hot.view._wt.wtTable.TABLE),e=t===this.hot.rootWindow,o=this.cellProperties.preventOverflow;if(e||!e&&(o||"horizontal"===o))return!1;const n=Se(this.TEXTAREA),i=Pe(this.TEXTAREA),r=this.getDropdownHeight(),s=t.scrollTop,l=Pe(this.hot.view._wt.wtTable.THEAD),a=Se(t),h=n.top-a.top-l+s,c=t.scrollHeight-h-l-i,u=r>c&&h>c;return u?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(u?h:c,r),u}limitDropdownIfNeeded(t,e){if(e>t){let o=0,n=0,i=0,r=null;do{i=this.htEditor.getRowHeight(n)||this.htEditor.view._wt.getSetting("defaultRowHeight"),o+=i,n+=1}while(o<t);r=o-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+e-r+"px"),this.setDropdownHeight(o-i)}}flipDropdown(t){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=-t+"px",this.htEditor.flipped=!0}unflipDropdown(){const t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const t=this.htEditor.getColWidth(0)+$e(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(t){this.htEditor.updateSettings({height:t})}highlightBestMatchingChoice(t){"number"===typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const t=this.htEditor.getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}stripValueIfNeeded(t){return this.stripValuesIfNeeded([t])[0]}stripValuesIfNeeded(t){const{allowHtml:e}=this.cellProperties,o=I(t,(t=>z(t))),n=I(o,(t=>e?t:dt(t)));return n}allowKeyEventPropagation(t){const e=this.htEditor.getSelectedRangeLast(),o={row:e?e.from.row:-1};let n=!1;return t===qo.ARROW_DOWN&&o.row>0&&o.row<this.htEditor.countRows()-1&&(n=!0),t===qo.ARROW_UP&&o.row>-1&&(n=!0),n}onBeforeKeyDown(t){if(Jo(t.keyCode)||t.keyCode===qo.BACKSPACE||t.keyCode===qo.DELETE||t.keyCode===qo.INSERT){let e=10;if(t.keyCode===qo.C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(e+=10),this.htEditor&&this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}),e)}}}const Cy="checkbox";class yy extends xv{static get EDITOR_TYPE(){return Cy}beginEditing(t,e){if(e&&"mouseup"===e.type){const t=this.TD.querySelector('input[type="checkbox"]');ue(t,"htBadValue")||t.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var by=o(1077);function Sy(t,e,o){return e=Ry(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ry(t){var e=Ey(t,"string");return"symbol"===typeof e?e:String(e)}function Ey(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Ty="date",My="dateEditor";class Hy extends Wv{constructor(){super(...arguments),Sy(this,"defaultDateFormat","DD/MM/YYYY"),Sy(this,"isCellEdited",!1),Sy(this,"parentDestroyed",!1),Sy(this,"$datePicker",null)}static get EDITOR_TYPE(){return Ty}init(){if("function"!==typeof E)throw new Error("You need to include moment.js to your project.");if("function"!==typeof by)throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",(()=>{this.parentDestroyed=!0,this.destroyElements()}))}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),de(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const t=new Fn(this);t.addEventListener(this.datePicker,"mousedown",(t=>{ue(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()})),t.addEventListener(this.TEXTAREA,"keydown",(t=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.code)&&t.preventDefault()}))}destroyElements(){const t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r)}open(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.hot.getShortcutManager(),o=e.getContext("editor");super.open(),this.showDatepicker(t),this.hot.getSettings().ariaTags&&fe(this.TD,[Ft("true")]),o.addShortcut({keys:[["Enter"]],callback:t=>{t.stopPropagation()},group:My})}close(){var t;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout((()=>{this.hot._refreshBorders()})),this.TD&&this.hot.getSettings().ariaTags&&fe(this.TD,[Ft("false")]);const e=this.hot.getShortcutManager(),o=e.getContext("editor");o.removeShortcutsByGroup(My),super.close()}finishEditing(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){const t=this.originalValue;void 0!==t&&this.setValue(t)}super.finishEditing(t,e)}showDatepicker(t){const e=this.TD.getBoundingClientRect(),o=this.cellProperties.dateFormat||this.defaultDateFormat,n=this.hot.view.isMouseDown(),i=!!t&&Zo(t.keyCode);let r;this.datePicker.style.display="block",this.$datePicker=new by(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+e.top+Pe(this.TD)}px`;let s=this.hot.rootWindow.pageXOffset;s=this.hot.isRtl()?e.right-Oe(this.datePicker):e.left,this.datePickerStyle.left=`${s}px`,this.originalValue?(r=this.originalValue,E(r,o,!0).isValid()&&this.$datePicker.setMoment(E(r,o),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),i||n||this.setValue("")):this.cellProperties.defaultDate?(r=this.cellProperties.defaultDate,E(r,o,!0).isValid()&&this.$datePicker.setMoment(E(r,o),!0),i||n||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const t=this.TEXTAREA,e={};this.cellProperties&&this.cellProperties.datePickerConfig&&Co(e,this.cellProperties.datePickerConfig);const o=e.onSelect,n=e.onClose;return e.field=t,e.trigger=t,e.container=this.datePicker,e.bound=!1,e.format=e.format||this.defaultDateFormat,e.reposition=e.reposition||!1,e.isRTL=!1,e.onSelect=t=>{let e=t;isNaN(e.getTime())||(e=E(e).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(e),o&&o()},e.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),n&&n()},e}}const xy="dropdown";class ky extends vy{static get EDITOR_TYPE(){return xy}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}bn.getSingleton().add("beforeValidate",(function(t,e,o){const n=this.getCellMeta(e,this.propToCol(o));n.editor===ky&&void 0===n.strict&&(n.filter=!1,n.strict=!0)}));const Iy="numeric";class Ay extends Wv{static get EDITOR_TYPE(){return Iy}}const Oy="password";class Py extends Wv{static get EDITOR_TYPE(){return Oy}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,we(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Ny="ht_editor_visible",_y="selectEditor",Ly="select";class Dy extends xv{static get EDITOR_TYPE(){return Ly}init(){this.select=this.hot.rootDocument.createElement("SELECT"),de(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(t){this.select.value=t}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";const t=this.hot.getShortcutManager();t.setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",ue(this.select,Ny)&&ge(this.select,Ny),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>this.refreshDimensions())),this.addHook("afterRowResize",(()=>this.refreshDimensions()))}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r);const s=this.cellProperties.selectOptions;let l;l="function"===typeof s?this.prepareOptions(s(this.row,this.col,this.prop)):this.prepareOptions(s),we(this.select),Mo(l,((t,e)=>{const o=this.hot.rootDocument.createElement("OPTION");o.value=e,Ce(o,t),this.select.appendChild(o)}))}prepareOptions(t){let e={};if(Array.isArray(t))for(let o=0,n=t.length;o<n;o++)e[t[o]]=t[o];else"object"===typeof t&&(e=t);return e}refreshValue(){const t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){if(this.state!==Mv.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:t,start:e,width:o,height:n}=this.getEditedCellRect(),i=this.select.style;i.height=`${n}px`,i.width=`${o}px`,i.top=`${t}px`,i[this.hot.isRtl()?"right":"left"]=`${e}px`,i.margin="0px",de(this.select,Ny)}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor"),o={group:_y};!1!==this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const t=this.select.selectedIndex-1;t>=0&&(this.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const t=this.select.selectedIndex+1;t<=this.select.length-1&&(this.select[t].selected=!0)}}],o)}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(_y)}}const Wy="time";class Vy extends Wv{static get EDITOR_TYPE(){return Wy}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r),this.TEXTAREA.dir="ltr"}}function Fy(){Pn(xv),Pn(vy),Pn(yy),Pn(Hy),Pn(ky),Pn(ly),Pn(Ay),Pn(Py),Pn(Dy),Pn(Wv),Pn(Vy)}const jy="html";function By(t,e,o,n,i,r,s){Fv.apply(this,[t,e,o,n,i,r,s]),Ce(e,null===r||void 0===r?"":r,!1)}By.RENDERER_TYPE=jy;const zy="autocomplete";function Uy(t,e,o,n,i,r,s){const{rootDocument:l}=t,a=s.allowHtml?By:Bv,h=l.createElement("DIV"),c=t.getSettings().ariaTags;if(h.className="htAutocompleteArrow",c&&h.setAttribute(...Ot()),h.appendChild(l.createTextNode(String.fromCharCode(9660))),a.apply(this,[t,e,o,n,i,r,s]),e.firstChild||e.appendChild(l.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),de(e,"htAutocomplete"),c&&e.setAttribute(..._t("listbox")),!t.acArrowListener){const i=new Fn(t);t.acArrowListener=function(i){ue(i.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(o,n),e)},i.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",(()=>{i.destroy()}))}}Uy.RENDERER_TYPE=zy;const $y=new WeakMap,Gy=new WeakMap,Yy="htBadValue",Ky="data-row",Xy="data-col",qy="checkboxRenderer",Qy="checkbox";function Jy(t,e,o,n,i,r,s){const{rootDocument:l}=t,a=t.getSettings().ariaTags;Fv.apply(this,[t,e,o,n,i,r,s]),Zy(t);let h=tb(l);const c=s.label;let u=!1;if("undefined"===typeof s.checkedTemplate&&(s.checkedTemplate=!0),"undefined"===typeof s.uncheckedTemplate&&(s.uncheckedTemplate=!1),we(e),r===s.checkedTemplate||z(r).toLocaleLowerCase(s.locale)===z(s.checkedTemplate).toLocaleLowerCase(s.locale)?h.checked=!0:r===s.uncheckedTemplate||z(r).toLocaleLowerCase(s.locale)===z(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?h.checked=!1:G(r)?de(h,"noValue"):(h.style.display="none",de(h,Yy),u=!0),fe(h,[[Ky,o],[Xy,n]]),a&&fe(h,[It(h.checked?t.getTranslatedPhrase(Fg):t.getTranslatedPhrase(jg)),Ut(h.checked),Mt()]),!u&&c){let s="";if(c.value)s="function"===typeof c.value?c.value.call(this,o,n,i,r):c.value;else if(c.property){const e=t.getDataAtRowProp(o,c.property);s=null!==e?e:""}const a=eb(l,s,!0!==c.separated);"before"===c.position?c.separated?(e.appendChild(a),e.appendChild(h)):(a.appendChild(h),h=a):c.position&&"after"!==c.position||(c.separated?(e.appendChild(h),e.appendChild(a)):(a.insertBefore(h,a.firstChild),h=a))}function d(){const e=t.getShortcutManager(),o=e.getContext("grid"),n={group:qy};o.addShortcuts([{keys:[["space"]],callback:()=>(g(),!f())},{keys:[["enter"]],callback:()=>(g(),!f()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!f()),relativeToGroup:iw,position:"before"}],n)}function g(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const o=t.getSelectedRange();if(o)for(let n=0;n<o.length;n++){const{row:i,col:r}=o[n].getTopStartCorner(),{row:s,col:l}=o[n].getBottomEndCorner(),a=[];for(let o=i;o<=s;o+=1)for(let n=r;n<=l;n+=1){const i=t.getCellMeta(o,n);if("checkbox"!==i.type)return;if(!0===i.readOnly)continue;"undefined"===typeof i.checkedTemplate&&(i.checkedTemplate=!0),"undefined"===typeof i.uncheckedTemplate&&(i.uncheckedTemplate=!1);const r=t.getDataAtCell(o,n);!1===e?[i.checkedTemplate,i.checkedTemplate.toString()].includes(r)?a.push([o,n,i.uncheckedTemplate]):[i.uncheckedTemplate,i.uncheckedTemplate.toString(),null,void 0].includes(r)&&a.push([o,n,i.checkedTemplate]):a.push([o,n,i.uncheckedTemplate])}a.length>0&&t.setDataAtCell(a)}}function f(){const e=t.getSelectedRange();if(e){for(let o=0;o<e.length;o++){const n=e[o].getTopStartCorner(),i=e[o].getBottomEndCorner();for(let e=n.row;e<=i.row;e++)for(let o=n.col;o<=i.col;o++){const n=t.getCellMeta(e,o);if("checkbox"!==n.type)return!1;const i=t.getCell(e,o);if(null===i||void 0===i)return!0;{const t=i.querySelectorAll("input[type=checkbox]");if(t.length>0&&!n.readOnly)return!0}}}return!1}}(!c||c&&!c.separated)&&e.appendChild(h),u&&e.appendChild(l.createTextNode("#bad-value#")),$y.has(t)||($y.set(t,!0),d())}function Zy(t){let e=Gy.get(t);if(!e){const{rootElement:o}=t;e=new Fn(t),e.addEventListener(o,"click",(e=>nb(e,t))),e.addEventListener(o,"mouseup",(e=>ob(e,t))),e.addEventListener(o,"change",(e=>ib(e,t))),Gy.set(t,e)}return e}function tb(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function eb(t,e,o){const n=t.createElement("label");return n.className="htCheckboxRendererLabel "+(o?"fullWidth":""),n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}function ob(t,e){const{target:o}=t;rb(o)&&o.hasAttribute(Ky)&&o.hasAttribute(Xy)&&setTimeout(e.listen,10)}function nb(t,e){const{target:o}=t;if(!rb(o))return;if(!o.hasAttribute(Ky)||!o.hasAttribute(Xy))return;const n=parseInt(o.getAttribute(Ky),10),i=parseInt(o.getAttribute(Xy),10),r=e.getCellMeta(n,i);r.readOnly&&t.preventDefault()}function ib(t,e){const{target:o}=t;if(!rb(o))return;if(!o.hasAttribute(Ky)||!o.hasAttribute(Xy))return;const n=parseInt(o.getAttribute(Ky),10),i=parseInt(o.getAttribute(Xy),10),r=e.getCellMeta(n,i);if(!r.readOnly){let o=null;o=t.target.checked?void 0===r.uncheckedTemplate||r.checkedTemplate:void 0!==r.uncheckedTemplate&&r.uncheckedTemplate,e.setDataAtCell(n,i,o)}}function rb(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}bn.getSingleton().add("modifyAutoColumnSizeSeed",(function(t,e,o){const{label:n,type:i,row:r,column:s,prop:l}=e;if(i===Qy){if(n){const{value:e,property:i}=n;let a=o;if(e)a="function"===typeof e?e(r,s,l,o):e;else if(i){const t=this.getDataAtRowProp(r,i);a=null!==t?t:o}t=a}return t}})),Jy.RENDERER_TYPE=Qy;var sb=o(204);const lb="numeric";function ab(t,e,o,n,i,r,s){let l=r;if(Ai(l)){const t=s.numericFormat,o=t&&t.culture||"-",n=t&&t.pattern,i=s.className||"",r=i.length?i.split(" "):[];if("undefined"!==typeof o&&!sb.languages()[o]){const t=o.replace("-",""),e=sb.allLanguages?sb.allLanguages[o]:sb[t];e&&sb.registerLanguage(e)}sb.setLanguage(o),l=sb(l).format(n||"0"),r.indexOf("htLeft")<0&&r.indexOf("htCenter")<0&&r.indexOf("htRight")<0&&r.indexOf("htJustify")<0&&r.push("htRight"),r.indexOf("htNumeric")<0&&r.push("htNumeric"),s.className=r.join(" "),e.dir="ltr"}Bv(t,e,o,n,i,l,s)}ab.RENDERER_TYPE=lb;const hb="password";function cb(t,e,o,n,i,r,s){Bv.apply(this,[t,e,o,n,i,r,s]);const l=s.hashLength||e.innerHTML.length,a=s.hashSymbol||"*";let h="";Pi(l-1,(()=>{h+=a})),Ce(e,h)}cb.RENDERER_TYPE=hb;const ub="time";function db(t,e,o,n,i,r,s){Bv.apply(this,[t,e,o,n,i,r,s]),e.dir="ltr"}function gb(){ur(Uy),ur(Fv),ur(Jy),ur(By),ur(ab),ur(cb),ur(Bv),ur(db)}db.RENDERER_TYPE=ub;const fb="autocomplete";function mb(t,e){let o=t;null!==o&&void 0!==o||(o=""),this.allowEmpty&&""===o?e(!0):this.strict&&this.source?"function"===typeof this.source?this.source(o,pb(o,e)):pb(o,e)(this.source):e(!0)}function pb(t,e){const o=t;return function(t){let n=!1;for(let e=0,i=t.length;e<i;e++)if(o===t[e]){n=!0;break}e(n)}}function wb(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}mb.VALIDATOR_TYPE=fb;const vb="date";function Cb(t,e){const o=An(Ty,this.instance);let n=t,i=!0;null!==n&&void 0!==n||(n="");let r=E(n,this.dateFormat||o.defaultDateFormat,!0).isValid(),s=E(new Date(n)).isValid()||r;if(this.allowEmpty&&""===n&&(s=!0,r=!0),s||(i=!1),!s&&r&&(i=!0),s&&!r)if(!0===this.correctFormat){const t=yb(n,this.dateFormat),e=this.instance.toVisualRow(this.row),o=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,o,t,"dateValidator"),i=!0}else i=!1;e(i)}function yb(t,e){const o=E(wb(t)),n=E(t,e),i=t.search(/[A-z]/g)>-1;let r;return r=o.isValid()&&o.format("x")===n.format("x")||!n.isValid()||i?o:n,r.format(e)}Cb.VALIDATOR_TYPE=vb;const bb="numeric";function Sb(t,e){let o=t;null!==o&&void 0!==o||(o=""),this.allowEmpty&&""===o?e(!0):e(""!==o&&Ai(t))}Sb.VALIDATOR_TYPE=bb;const Rb=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Eb="time";function Tb(t,e){const o=this.timeFormat||"h:mm:ss a";let n=!0,i=t;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const r=/^\d{1,2}$/.test(i);r&&(i+=":00");const s=E(i,Rb,!0).isValid()?E(i):E(i,o);let l=s.isValid(),a=E(i,o,!0).isValid()&&!r;if(this.allowEmpty&&""===i&&(l=!0,a=!0),l||(n=!1),!l&&a&&(n=!0),l&&!a)if(!0===this.correctFormat){const t=s.format(o),e=this.instance.toVisualRow(this.row),i=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,i,t,"timeValidator"),n=!0}else n=!1;e(n)}function Mb(){vr(mb),vr(Cb),vr(Sb),vr(Tb)}Tb.VALIDATOR_TYPE=Eb;const Hb="autocomplete",xb={CELL_TYPE:Hb,editor:vy,renderer:Uy,validator:mb},kb="checkbox",Ib={CELL_TYPE:kb,editor:yy,renderer:Jy},Ab="date";function Ob(t,e,o,n,i,r,s){Uy.apply(this,[t,e,o,n,i,r,s]),t.getSettings().ariaTags&&fe(e,[_t("dialog"),Ft("false")])}Ob.RENDERER_TYPE=Ab;const Pb="date",Nb={CELL_TYPE:Pb,editor:Hy,renderer:Ob,validator:Cb},_b="dropdown",Lb={CELL_TYPE:_b,editor:ky,renderer:Uy,validator:mb},Db="handsontable";function Wb(t,e,o,n,i,r,s){Uy.apply(this,[t,e,o,n,i,r,s]),t.getSettings().ariaTags&&fe(e,[_t("true"),Ft("false")])}Wb.RENDERER_TYPE=Db;const Vb="handsontable",Fb={CELL_TYPE:Vb,editor:ly,renderer:Wb},jb="numeric",Bb={CELL_TYPE:jb,editor:Ay,renderer:ab,validator:Sb,dataType:"number"},zb="password",Ub={CELL_TYPE:zb,editor:Py,renderer:cb,copyable:!1},$b="select";function Gb(t,e,o,n,i,r,s){Bv.apply(this,[t,e,o,n,i,r,s]),t.getSettings().ariaTags&&fe(e,..._t("listbox"))}Gb.RENDERER_TYPE=$b;const Yb="select",Kb={CELL_TYPE:Yb,editor:Dy,renderer:Gb},Xb="time",qb={CELL_TYPE:Xb,editor:Vy,renderer:db,validator:Tb};function Qb(){sp(xb),sp(Ib),sp(Nb),sp(Lb),sp(Fb),sp(Bb),sp(Ub),sp(Kb),sp(Uv),sp(qb)}function Jb(t,e){tS(t,e),e.add(t)}function Zb(t,e,o){tS(t,e),e.set(t,o)}function tS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eS(t,e,o){return e=oS(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function oS(t){var e=nS(t,"string");return"symbol"===typeof e?e:String(e)}function nS(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function iS(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function rS(t,e){var o=sS(t,e,"get");return lS(t,o)}function sS(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function lS(t,e){return e.get?e.get.call(t):e.value}const aS=new Map([["plugin",er],["cell-type",op],["editor",Hn],["renderer",lr],["validator",fr]]),hS="base",cS=[];let uS=null;var dS=new WeakMap,gS=new WeakSet;class fS{static get PLUGIN_KEY(){return hS}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(t){Jb(this,gS),eS(this,"eventManager",new Fn(this)),eS(this,"pluginName",null),eS(this,"pluginsInitializedCallbacks",[]),eS(this,"isPluginsReady",!1),eS(this,"enabled",!1),eS(this,"initialized",!1),Zb(this,dS,{writable:!0,value:{}}),To(this,"hot",t,{writable:!1}),uS=null,this.hot.addHook("afterPluginsInitialized",(()=>this.onAfterPluginsInitialized())),this.hot.addHook("afterUpdateSettings",(t=>this.onUpdateSettings(t))),this.hot.addHook("beforeInit",(()=>this.init()))}init(){this.pluginName=this.hot.getPluginName(this);const t=this.constructor.PLUGIN_DEPS,e=Array.isArray(t)?t:[];if(e.length>0){const t=[];if(e.forEach((e=>{const[o,n]=e.split(":");if(!aS.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);aS.get(o)(n)||t.push(` - ${n} (${o})`)})),t.length>0){const e=[`The ${this.pluginName} plugin requires the following modules:\n`,`${t.join("\n")}\n`].join("");cS.push(e)}}uS||(uS=Zi()),uS.indexOf("UndoRedo")>=0&&uS.splice(uS.indexOf("UndoRedo"),1),uS.indexOf(this.pluginName)>=0&&uS.splice(uS.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}));const o=0===uS.length;if(o){if(cS.length>0){const t=[`${cS.join("\n")}\n`,"You have to import and register them manually."].join("");throw new Error(t)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}addHook(t,e){rS(this,dS)[t]=rS(this,dS)[t]||[];const o=rS(this,dS)[t];this.hot.addHook(t,e),o.push(e),rS(this,dS)[t]=o}removeHooks(t){A(rS(this,dS)[t]||[],(e=>{this.hot.removeHook(t,e)}))}clearHooks(){const t=rS(this,dS);Mo(t,((t,e)=>this.removeHooks(e))),t.length=0}callOnPluginsReady(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}onAfterPluginsInitialized(){A(this.pluginsInitializedCallbacks,(t=>t())),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(t){const e=iS(this,gS,mS).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}updatePlugin(){}destroy(){this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Mo(this,((t,e)=>{"hot"!==e&&(this[e]=null)})),delete this.t,delete this.hot}}function mS(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if("boolean"===typeof e)return e;for(let o=0;o<e.length;o++)if(void 0!==t[e[o]])return!0;return!1}function pS(t,e,o){return e=wS(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function wS(t){var e=vS(t,"string");return"symbol"===typeof e?e:String(e)}function vS(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class CS{constructor(t){pS(this,"hot",null),pS(this,"container",null),pS(this,"injected",!1),pS(this,"rows",[]),pS(this,"columns",[]),pS(this,"samples",null),pS(this,"settings",{useHeaders:!0}),this.hot=t}addRow(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const o={row:t};this.rows.push(o),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(t)),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}addColumnHeadersRow(t){const e=this.hot.getColHeader(0);if(null!==e&&void 0!==e){const e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}addColumn(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const o={col:t};this.columns.push(o),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}getHeights(t){this.injected||this.injectTable(),A(this.rows,(e=>{t(e.row,Pe(e.table)-1)}))}getWidths(t){this.injected||this.injectTable(),A(this.columns,(e=>{const{width:o}=e.table.getBoundingClientRect();t(e.col,Math.ceil(o))}))}setSettings(t){this.settings=t}setSetting(t,e){this.settings||(this.settings={}),this.settings[t]=e}getSettings(){return this.settings}getSetting(t){return this.settings?this.settings[t]:null}createColGroupsCol(t){const e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1,-1)),this.samples.forEach((o=>{A(o.strings,(o=>{e.appendChild(this.createColElement(o.col,t))}))})),e}createRow(t){const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,n),o.appendChild(n)),this.samples.forEach((n=>{A(n.strings,(n=>{const i=n.col,r=this.hot.getCellMeta(t,i);r.col=i,r.row=t;const s=this.hot.getCellRenderer(r),l=e.createElement("td");l.setAttribute("ghost-table",1),s(this.hot,l,t,i,this.hot.colToProp(i),n.value,r),o.appendChild(l)}))})),o}appendColumnHeadersRow(){const{rootDocument:t}=this.hot,e=t.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){const n=t.createElement("th");o.push([-1,n]),e.appendChild(n)}this.samples.forEach((n=>{A(n.strings,(n=>{const i=n.col,r=t.createElement("th");o.push([i,r]),e.appendChild(r)}))})),this.table.tHead.appendChild(e),A(o,(t=>{const[e,o]=t;this.hot.view.appendColHeader(e,o)}))}createCol(t){const{rootDocument:e}=this.hot,o=e.createDocumentFragment();return this.samples.forEach((n=>{A(n.strings,(n=>{const i=n.row,r=this.hot.getCellMeta(i,t);r.col=t,r.row=i;const s=this.hot.getCellRenderer(r),l=e.createElement("td"),a=e.createElement("tr");l.setAttribute("ghost-table",1),s(this.hot,l,i,t,this.hot.colToProp(t),n.value,r),a.appendChild(l),o.appendChild(a)}))})),o}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t,e){const o=this.hot.rootDocument.createElement("col");let n=0;e>=0&&t>=0&&(n=this.hot.getCellMeta(e,t).colspan);let i=this.hot.view._wt.wtTable.getStretchedColumnWidth(t);if(n>1)for(let r=t+1;r<t+n;r++)i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(r);return o.style.width=`${i}px`,o}createTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("table"),i=e.createElement("thead"),r=e.createElement("tbody"),s=e.createElement("colgroup"),l=e.createElement("tr"),a=e.createElement("th");return this.isVertical()&&n.appendChild(s),this.isHorizontal()&&(l.appendChild(a),i.appendChild(l),n.style.tableLayout="auto",n.style.width="auto"),n.appendChild(i),this.isVertical()&&r.appendChild(l),n.appendChild(r),de(n,t),o.appendChild(n),{fragment:o,table:n,tHead:i,tBody:r,colGroup:s,tr:l,th:a}}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("div"),i=`htGhostTable htAutoSize ${t.trim()}`;return de(n,i),o.appendChild(n),{fragment:o,container:n}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}}var yS=CS;function bS(t,e,o){return e=SS(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function SS(t){var e=RS(t,"string");return"symbol"===typeof e?e:String(e)}function RS(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ES{static get SAMPLE_COUNT(){return 3}constructor(t){bS(this,"samples",null),bS(this,"dataFactory",null),bS(this,"customSampleCount",null),bS(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:ES.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,e){return this.generateSamples("row",e,t)}generateColumnSamples(t,e){return this.generateSamples("col",e,t)}generateSamples(t,e,o){const n=new Map,{from:i,to:r}="number"===typeof o?{from:o,to:o}:o;return Pi(i,r,(o=>{const i=this.generateSample(t,e,o);n.set(o,i)})),n}generateSample(t,e,o){if("row"!==t&&"col"!==t)throw new Error("Unsupported sample type");const n=new Map,i="row"===t?"col":"row",r=[];return Pi(e.from,e.to,(e=>{const s="row"===t?this.dataFactory(o,e):this.dataFactory(e,o);if(!1===s)return;const{value:l,bundleSeed:a}=s,h="string"===typeof a&&a.length>0;let c;c=h?a:Eo(l)?`${Object.keys(l).length}`:Array.isArray(l)?`${l.length}`:`${z(l).length}`,n.has(c)||n.set(c,{needed:this.getSampleCount(),strings:[]});const u=n.get(c);if(u.needed){const t=r.indexOf(l)>-1;(!t||this.allowDuplicates||h)&&(u.strings.push({value:l,[i]:e}),r.push(l),u.needed-=1)}})),n}}var TS=ES;function MS(t,e){xS(t,e),e.add(t)}function HS(t,e,o){xS(t,e),e.set(t,o)}function xS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kS(t,e,o){return e=IS(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function IS(t){var e=AS(t,"string");return"symbol"===typeof e?e:String(e)}function AS(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function OS(t,e,o){var n=_S(t,e,"set");return PS(t,n,o),o}function PS(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function NS(t,e){var o=_S(t,e,"get");return LS(t,o)}function _S(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function LS(t,e){return e.get?e.get.call(t):e.value}function DS(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}bn.getSingleton().register("modifyAutoColumnSizeSeed");const WS="autoColumnSize",VS=10,FS="autoColumnSize";var jS=new WeakMap,BS=new WeakSet,zS=new WeakSet,US=new WeakSet,$S=new WeakSet,GS=new WeakSet,YS=new WeakSet;class KS extends fS{static get PLUGIN_KEY(){return WS}static get PLUGIN_PRIORITY(){return VS}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){super(t),MS(this,YS),MS(this,GS),MS(this,$S),MS(this,US),MS(this,zS),MS(this,BS),kS(this,"ghostTable",new yS(this.hot)),kS(this,"samplesGenerator",new TS(((t,e)=>{const o=this.hot.getCellMeta(t,e);let n="";o.spanned||(n=this.hot.getDataAtCell(t,e));let i="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(i=this.hot.runHooks("modifyAutoColumnSizeSeed",i,o,n)),{value:n,bundleSeed:i}}))),kS(this,"firstCalculation",!0),kS(this,"inProgress",!1),kS(this,"measuredColumns",0),kS(this,"columnWidthsMap",new du),HS(this,jS,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(FS,this.columnWidthsMap),this.addHook("beforeColumnResize",((t,e,o)=>DS(this,$S,JS).call(this,t,e,o)))}isEnabled(){return!1!==this.hot.getSettings()[WS]&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[WS];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return DS(t,zS,qS).call(t,...o)})),this.addHook("beforeChangeRender",(t=>DS(this,US,QS).call(this,t))),this.addHook("afterFormulasValuesUpdate",(t=>DS(this,YS,tR).call(this,t))),this.addHook("beforeViewRender",(t=>DS(this,BS,XS).call(this,t))),this.addHook("modifyColWidth",((t,e)=>this.getColumnWidth(e,t))),this.addHook("afterInit",(()=>DS(this,GS,ZS).call(this))),super.enablePlugin()}updatePlugin(){const t=this.findColumnsWhereHeaderWasChanged();t.length&&(this.clearCache(t),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",((t,e,o)=>DS(this,$S,JS).call(this,t,e,o)))}calculateVisibleColumnsWidth(){const t=this.hot.countRows();if(!t)return;const e=this.hot.renderCall,o=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();-1!==o&&-1!==n&&this.calculateColumnsWidth({from:o,to:n},void 0,e)}calculateColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n="number"===typeof t?{from:t,to:t}:t,i="number"===typeof e?{from:e,to:e}:e;Pi(n.from,n.to,(t=>{let e=this.hot.toPhysicalColumn(t);if(null===e&&(e=t),o||null===this.columnWidthsMap.getValueAtIndex(e)&&!this.hot._getColWidthFromSettings(e)){const e=this.samplesGenerator.generateColumnSamples(t,i);A(e,(t=>{let[e,o]=t;return this.ghostTable.addColumn(e,o)}))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((t,e)=>{const o=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(o,e)}))}),!0),this.measuredColumns=n.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=0;const o=this.hot.countCols()-1;let n=null;this.inProgress=!0;const i=()=>{if(!this.hot)return yr(n),void(this.inProgress=!1);this.calculateColumnsWidth({from:e,to:Math.min(e+KS.CALCULATION_STEP,o)},t),e=e+KS.CALCULATION_STEP+1,e<o?n=Cr(i):(yr(n),this.inProgress=!1,this.hot.view.adjustElementsSize())},r=this.getSyncCalculationLimit();this.firstCalculation&&r>=0&&(this.calculateColumnsWidth({from:0,to:r},t),this.firstCalculation=!1,e=r+1),e<o?i():this.inProgress=!1}setSamplingOptions(){const t=this.hot.getSettings()[WS],e=t&&Ao(t,"samplingRatio")?t.samplingRatio:void 0,o=t&&Ao(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const t=this.hot.getSettings()[WS];let e=KS.SYNC_CALCULATION_LIMIT;const o=this.hot.countCols()-1;return Eo(t)&&(e=t.syncLimit,ct(e)?e=_i(o,e):e>>=0),Math.min(e,o)}getColumnWidth(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e;return void 0===n&&(n=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),o&&"number"===typeof n&&(n=Math.max(n,Rh.DEFAULT_WIDTH))),n}getFirstVisibleColumn(){const t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){const e=t.wtTable.getFirstVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){const e=t.wtTable.getFirstRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return-1}getLastVisibleColumn(){const t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){const e=t.wtTable.getLastVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){const e=t.wtTable.getLastRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return-1}findColumnsWhereHeaderWasChanged(){const t=this.hot.getColHeader(),e=x(t,((t,e,o)=>{const n=NS(this,jS).length;return(n-1<o||NS(this,jS)[o]!==e)&&t.push(o),n-1<o?NS(this,jS).push(e):NS(this,jS)[o]=e,t}),[]);return e}clearCache(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution((()=>{A(t,(t=>{this.columnWidthsMap.setValueAtIndex(t,null)}))}),!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!k(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(t=>null===t)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function XS(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function qS(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout((()=>{this.hot&&this.recalculateAllColumnsWidth()}),0)}function QS(t){const e=I(t,(t=>{let[,e]=t;return this.hot.toPhysicalColumn(this.hot.propToCol(e))}));this.clearCache(Array.from(new Set(e)))}function JS(t,e,o){let n=t;return o&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function ZS(){OS(this,jS,this.hot.getColHeader())}function tR(t){const e=k(t,(t=>{var e;return U(null===(e=t.address)||void 0===e?void 0:e.col)})),o=I(e,(t=>t.address.col));this.clearCache(Array.from(new Set(o)))}const eR={horizontal:"horizontal",vertical:"vertical"};function oR(t,e,o){let n,i,r;return e[0]===t[0]&&e[1]<t[1]?(r="left",n=o(e[0],e[1]),i=o(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(r="right",n=o(e[0],t[3]+1),i=o(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(r="up",n=o(e[0],e[1]),i=o(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(r="down",n=o(t[2]+1,e[1]),i=o(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:r,startOfDragCoords:n,endOfDragCoords:i}}function nR(t){const e={};return!0===t?(e.directions=Object.keys(eR),e.autoInsertRow=!0):Eo(t)?(U(t.autoInsertRow)?t.direction===eR.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,U(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(eR)):"string"===typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function iR(t,e){rR(t,e),e.add(t)}function rR(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sR(t,e,o){return e=lR(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function lR(t){var e=aR(t,"string");return"symbol"===typeof e?e:String(e)}function aR(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function hR(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}bn.getSingleton().register("modifyAutofillRange"),bn.getSingleton().register("beforeAutofill"),bn.getSingleton().register("afterAutofill");const cR="autofill",uR=20,dR=["fillHandle"],gR="insert_row_below",fR=200;var mR=new WeakSet,pR=new WeakSet,wR=new WeakSet,vR=new WeakSet,CR=new WeakSet;class yR extends fS{constructor(){super(...arguments),iR(this,CR),iR(this,vR),iR(this,wR),iR(this,pR),iR(this,mR),sR(this,"addingStarted",!1),sR(this,"mouseDownOnCellCorner",!1),sR(this,"mouseDragOutside",!1),sR(this,"handleDraggedCells",0),sR(this,"directions",[]),sR(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return cR}static get PLUGIN_PRIORITY(){return uR}static get SETTING_KEYS(){return[cR,...dR]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(t=>hR(this,pR,SR).call(this,t))),this.addHook("afterOnCellCornerDblClick",(t=>hR(this,mR,bR).call(this,t))),this.addHook("beforeOnCellMouseOver",((t,e)=>hR(this,wR,RR).call(this,e))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const t=this.hot.getSelectedRangeLast(),{row:e,col:o}=t.getTopStartCorner(),{row:n,col:i}=t.getBottomEndCorner(),r=this.hot.runHooks("modifyCopyableRange",[{startRow:e,startCol:o,endRow:n,endCol:i}]),s=[],l=[],a=[];return A(r,(t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===s.indexOf(e)&&s.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===l.indexOf(e)&&l.push(e)})),A(s,(t=>{const e=[];A(l,(o=>{e.push(this.hot.getCopyableData(t,o))})),a.push(e)})),a}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[t,e,o,n]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),r=i.getTopStartCorner(),s=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[r.row,r.col,s.row,s.col],a=this.hot.runHooks("modifyAutofillRange",[Math.min(r.row,t),Math.min(r.col,e),Math.max(s.row,o),Math.max(s.col,n)],l),{directionOfDrag:h,startOfDragCoords:c,endOfDragCoords:u}=oR(l,a,((t,e)=>this.hot._createCellCoords(t,e)));if(c&&c.row>-1&&c.col>-1){const t=this.getSelectionData(),e=i.clone(),o=this.hot._createCellRange(c,c,u),n=this.hot.runHooks("beforeAutofill",t,e,o,h);if(!1===n)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let r=n;const s=n;if(["up","left"].indexOf(h)>-1&&(1!==s.length||0!==s[0].length))if(r=[],"up"===h){const t=u.row-c.row+1,e=t%s.length;for(let o=0;o<t;o++)r.push(s[(o+(s.length-e))%s.length])}else{const t=u.col-c.col+1,e=t%s[0].length;for(let o=0;o<s.length;o++){r.push([]);for(let n=0;n<t;n++)r[o].push(s[o][(n+(s[o].length-e))%s[o].length])}}this.hot.populateFromArray(c.row,c.col,r,u.row,u.col,`${this.pluginName}.fill`,null),this.setSelection(a),this.hot.runHooks("afterAutofill",r,e,o,h),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}getCoordsOfDragAndDropBorders(t){const e=this.hot.getSelectedRangeLast(),o=e.getBottomEndCorner();let n=t;if(this.directions.includes(eR.vertical)&&this.directions.includes(eR.horizontal)){const i=e.getTopStartCorner();(o.col<=t.col||i.col>=t.col)&&(n=this.hot._createCellCoords(o.row,t.col)),(o.row<t.row||i.row>t.row)&&(n=this.hot._createCellCoords(t.row,o.col))}else if(this.directions.includes(eR.vertical))n=this.hot._createCellCoords(t.row,o.col);else{if(!this.directions.includes(eR.horizontal))return;n=this.hot._createCellCoords(o.row,t.col)}return this.reduceSelectionAreaIfNeeded(n)}showBorder(t){const e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout((()=>{this.hot.alter(gR,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1}),fR)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.countRows();t[2]<o-1&&e[2]===o-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(t){const e=this.hot.getData(),o=this.hot.countRows();let n;for(let i=t[2]+1;i<o;i++){for(let n=t[1];n<=t[3];n++){const t=e[i][n];if(t)return-1}const o=e[i][t[1]-1],r=e[i][t[3]+1];(o||r)&&(n=i)}return n}addSelectionFromStartAreaToSpecificRowIndex(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}setSelection(t){this.hot.selectCell(...I(t,(t=>Math.max(t,0))),!1,!1)}selectAdjacent(){const t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(t){const{documentElement:e}=this.hot.rootDocument,o=Se(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+Pe(this.hot.table),n=Se(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+Oe(this.hot.table);return t.clientY>o&&t.clientX<=n}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseup",(()=>hR(this,vR,ER).call(this))),this.eventManager.addEventListener(t,"mousemove",(t=>hR(this,CR,TR).call(this,t)))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const t=nR(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}destroy(){super.destroy()}}function bR(){const t=this.selectAdjacent();t&&this.fillIn()}function SR(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function RR(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function ER(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function TR(t){const e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function MR(t,e){HR(t,e),e.add(t)}function HR(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xR(t,e,o){return e=kR(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function kR(t){var e=IR(t,"string");return"symbol"===typeof e?e:String(e)}function IR(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function AR(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const OR="autoRowSize",PR=40,NR="autoRowSize";var _R=new WeakSet,LR=new WeakSet,DR=new WeakSet,WR=new WeakSet;class VR extends fS{static get PLUGIN_KEY(){return OR}static get PLUGIN_PRIORITY(){return PR}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){super(t),MR(this,WR),MR(this,DR),MR(this,LR),MR(this,_R),xR(this,"headerHeight",null),xR(this,"ghostTable",new yS(this.hot)),xR(this,"samplesGenerator",new TS(((t,e)=>{if(t>=0&&e>=0){const o=this.hot.getCellMeta(t,e);if(o.hidden)return!1}let o;return t>=0?o=this.hot.getDataAtCell(t,e):-1===t&&(o=this.hot.getColHeader(e)),{value:o}}))),xR(this,"firstCalculation",!0),xR(this,"inProgress",!1),xR(this,"measuredRows",0),xR(this,"rowHeightsMap",new du),this.hot.rowIndexMapper.registerMap(NR,this.rowHeightsMap),this.addHook("beforeRowResize",((t,e,o)=>AR(this,LR,jR).call(this,t,e,o)))}isEnabled(){const t=this.hot.getSettings()[OR];return!0===t||Eo(t)}enablePlugin(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AR(t,DR,BR).call(t,...o)})),this.addHook("beforeChangeRender",(t=>AR(this,WR,zR).call(this,t))),this.addHook("beforeColumnResize",(()=>this.recalculateAllRowsHeight())),this.addHook("beforeViewRender",(t=>AR(this,_R,FR).call(this,t))),this.addHook("modifyRowHeight",((t,e)=>this.getRowHeight(e,t))),this.addHook("modifyColumnHeaderHeight",(()=>this.getColumnHeaderHeight())),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",((t,e,o)=>AR(this,LR,jR).call(this,t,e,o)))}calculateRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n="number"===typeof t?{from:t,to:t}:t,i="number"===typeof e?{from:e,to:e}:e;if(null!==this.hot.getColHeader(0)){const t=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(t.get(-1))}Pi(n.from,n.to,(t=>{if(o||null===this.rowHeightsMap.getValueAtIndex(t)){const e=this.samplesGenerator.generateRowSamples(t,i);A(e,(t=>{let[e,o]=t;return this.ghostTable.addRow(e,o)}))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((t,e)=>{t<0?this.headerHeight=e:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(t),e)}))}),!0),this.measuredRows=n.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=0;const o=this.hot.countRows()-1;let n=null;this.inProgress=!0;const i=()=>{if(!this.hot)return yr(n),void(this.inProgress=!1);this.calculateRowsHeight({from:e,to:Math.min(e+VR.CALCULATION_STEP,o)},t),e=e+VR.CALCULATION_STEP+1,e<o?n=Cr(i):(yr(n),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},r=this.getSyncCalculationLimit();this.firstCalculation&&r>=0&&(this.calculateRowsHeight({from:0,to:r},t),this.firstCalculation=!1,e=r+1),e<o?i():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const t=this.hot.getSettings()[OR],e=t&&Ao(t,"samplingRatio")?t.samplingRatio:void 0,o=t&&Ao(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}recalculateAllRowsHeight(){be(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const t=this.hot.getSettings()[OR];let e=VR.SYNC_CALCULATION_LIMIT;const o=this.hot.countRows()-1;return Eo(t)&&(e=t.syncLimit,ct(e)?e=_i(o,e):e>>=0),Math.min(e,o)}getRowHeight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;const o=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t));let n=e;return null!==o&&o>(e||0)&&(n=o),n}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(t){const{from:e,to:o}="number"===typeof t?{from:t,to:t}:t;this.hot.batchExecution((()=>{Pi(Math.min(e,o),Math.max(e,o),(t=>{this.rowHeightsMap.setValueAtIndex(t,null)}))}),!0)}isNeedRecalculate(){return!!k(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(t=>null===t)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function FR(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,o=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(-1!==o&&-1!==n){if(this.calculateRowsHeight({from:o,to:n},void 0,t),e){const t=this.hot.countRows()-1;this.calculateRowsHeight({from:t-e,to:t})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function jR(t,e,o){let n=t;return o&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}function BR(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout((()=>{this.hot&&this.recalculateAllRowsHeight()}))}function zR(t){let e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}const UR=new Map([["indexesSequence",{getListWithInsertedItems:ru,getListWithRemovedItems:su}],["physicallyIndexed",{getListWithInsertedItems:cu,getListWithRemovedItems:uu}]]),$R=t=>{if(!1===UR.has(t))throw new Error(`Alter strategy with ID '${t}' does not exist.`);return UR.get(t)},{getListWithInsertedItems:GR,getListWithRemovedItems:YR}=$R("physicallyIndexed");class KR extends iu{constructor(){super((t=>t))}insert(t,e){const o=au(this.indexedValues,e);this.indexedValues=GR(o,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){const e=YR(this.indexedValues,t);this.indexedValues=lu(e,t),super.remove(t)}}var XR=KR;const{getListWithInsertedItems:qR,getListWithRemovedItems:QR}=$R("physicallyIndexed");class JR extends iu{constructor(){super((t=>t))}insert(t,e){this.indexedValues=qR(this.indexedValues,t,e,((t,e)=>this.getNextValue(e))),super.insert(t,e)}remove(t){this.indexedValues=QR(this.indexedValues,t),super.remove(t)}getNextValue(t){return Math.max(...this.getValues())+1+t}}var ZR=JR;function tE(t,e){eE(t,e),e.add(t)}function eE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oE(t,e,o){return e=nE(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function nE(t){var e=iE(t,"string");return"symbol"===typeof e?e:String(e)}function iE(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function rE(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const sE="bindRowsWithHeaders",lE=210,aE="loose",hE=new Map([["loose",XR],["strict",ZR]]);var cE=new WeakSet;class uE extends fS{constructor(){super(...arguments),tE(this,cE),oE(this,"headerIndexes",null)}static get PLUGIN_KEY(){return sE}static get PLUGIN_PRIORITY(){return lE}isEnabled(){return!!this.hot.getSettings()[sE]}enablePlugin(){if(this.enabled)return;let t=this.hot.getSettings()[sE];"string"!==typeof t&&(t=aE);const e=hE.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new e),this.addHook("modifyRowHeader",(t=>rE(this,cE,dE).call(this,t))),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function dE(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function gE(t,e){mE(t,e),e.add(t)}function fE(t,e,o){mE(t,e),e.set(t,o)}function mE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pE(t,e,o){return e=wE(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function wE(t){var e=vE(t,"string");return"symbol"===typeof e?e:String(e)}function vE(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function CE(t,e){var o=RE(t,e,"get");return yE(t,o)}function yE(t,e){return e.get?e.get.call(t):e.value}function bE(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function SE(t,e,o){var n=RE(t,e,"set");return EE(t,n,o),o}function RE(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function EE(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const TE="collapsibleColumns",ME=290,HE=["nestedHeaders"],xE="collapsibleIndicator",kE=TE,IE=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var AE=new WeakMap,OE=new WeakSet,PE=new WeakSet,NE=new WeakSet,_E=new WeakSet;class LE extends fS{constructor(){super(...arguments),gE(this,_E),gE(this,NE),gE(this,PE),gE(this,OE),pE(this,"nestedHeadersPlugin",null),pE(this,"headerStateManager",null),fE(this,AE,{writable:!0,value:null})}static get PLUGIN_KEY(){return TE}static get PLUGIN_PRIORITY(){return ME}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[TE,...HE]}isEnabled(){return!!this.hot.getSettings()[TE]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();e||hn("You need to configure the Nested Headers plugin in order to use collapsible headers."),SE(this,AE,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(()=>bE(this,NE,VE).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return bE(t,_E,FE).call(t,...o)})),this.addHook("afterGetColHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return bE(t,OE,DE).call(t,...o)})),this.addHook("beforeOnCellMouseDown",((t,e,o)=>bE(this,PE,WE).call(this,t,e,o))),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:t}=this.hot.getSettings();"boolean"===typeof t?this.headerStateManager.mapState((t=>({collapsible:t.origColspan>1}))):Array.isArray(t)&&(this.headerStateManager.mapState((()=>({collapsible:!1}))),this.headerStateManager.mergeStateWith(t))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),SE(this,AE,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var t;const{row:e,col:o}=this.hot.getSelectedRangeLast().highlight,{collapsible:n,isCollapsed:i,columnIndex:r}=null!==(t=this.headerStateManager.getHeaderTreeNodeData(e,o))&&void 0!==t?t:{};n&&(i?this.expandSection({row:e,col:r}):this.collapseSection({row:e,col:r}))},runOnlyIf:()=>{var t;return null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},group:kE})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(kE)}clearButtons(){if(!this.hot.view)return;const t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(t){t&&t.parentNode.removeChild(t)};Pi(0,t-1,(t=>{const r=e.childNodes[t],s=o.childNodes[t],l=n?n.childNodes[t]:null;Pi(0,r.childNodes.length-1,(t=>{let e=r.childNodes[t].querySelector(`.${xE}`);i(e),s&&s.childNodes[t]&&(e=s.childNodes[t].querySelector(`.${xE}`),i(e)),n&&l&&l.childNodes[t]&&(e=l.childNodes[t].querySelector(`.${xE}`),i(e))}))}),!0)}expandSection(t){this.toggleCollapsibleSection([t],"expand")}collapseSection(t){this.toggleCollapsibleSection([t],"collapse")}toggleAllCollapsibleSections(t){const e=this.headerStateManager.mapNodes((e=>{const{collapsible:o,origColspan:n,headerLevel:i,columnIndex:r,isCollapsed:s}=e;if(!0===o&&n>1&&(s&&"expand"===t||!s&&"collapse"===t))return{row:this.headerStateManager.levelToRowCoords(i),col:r}}));this.toggleCollapsibleSection(e,t)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(t,e){if(!IE.has(e))throw new Error(`Unsupported action is passed (${e}).`);if(!Array.isArray(t))return;const o=k(t,(t=>{let{row:e}=t;return e<0}));let n=o.length>0;A(o,(t=>{var o;let{row:i,col:r}=t;const{collapsible:s,isCollapsed:l}=null!==(o=this.headerStateManager.getHeaderSettings(i,r))&&void 0!==o?o:{};if(!s||l&&"collapse"===e||!l&&"expand"===e)return n=!1,!1}));const i=[],r=[];n&&A(o,(t=>{let{row:o,col:n}=t;const{colspanCompensation:s,affectedColumns:l,rollbackModification:a}=this.headerStateManager.triggerNodeModification(e,o,n);s>0&&(r.push(...l),i.push(a))}));const s=this.getCollapsedColumns();let l=[];"collapse"===e?l=D([...s,...r]):"expand"===e&&(l=k(s,(t=>!r.includes(t))));const a=IE.get(e),h=this.hot.runHooks(a.beforeHook,s,l,n);if(!1===h)return void A(i,(t=>{t()}));this.hot.batchExecution((()=>{A(r,(t=>{CE(this,AE).setValueAtIndex(this.hot.toPhysicalColumn(t),a.hideColumn)}))}),!0);const c=this.getCollapsedColumns().length!==s.length;this.hot.runHooks(a.afterHook,s,l,n,c),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return CE(this,AE).getHiddenIndexes()}destroy(){SE(this,AE,null),super.destroy()}}function DE(t,e,o){var n;const{collapsible:i,origColspan:r,isCollapsed:s}=null!==(n=this.headerStateManager.getHeaderSettings(o,t))&&void 0!==n?n:{},l=i&&r>1&&t>=this.hot.getSettings().fixedColumnsStart,a=this.hot.getSettings().ariaTags;let h=e.querySelector(`.${xE}`);var c;(me(e,[Ft("")[0]]),l)?(h||(h=this.hot.rootDocument.createElement("div"),de(h,xE),e.querySelector("div:first-child").appendChild(h)),ge(h,["collapsed","expanded"]),s?(de(h,"collapsed"),ye(h,"+"),a&&fe(e,[Ft(!1),At(this.hot.getTranslatedPhrase(zg))])):(de(h,"expanded"),ye(h,"-"),a&&fe(e,[Ft(!0),At(this.hot.getTranslatedPhrase(Ug))])),a&&fe(h,...Ot())):null===(c=h)||void 0===c||c.remove()}function WE(t,e){ue(t.target,xE)&&(ue(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ue(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),nn(t))}function VE(){this.updatePlugin()}function FE(t,e){e||this.updatePlugin()}function jE(t,e,o){return e=BE(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function BE(t){var e=zE(t,"string");return"symbol"===typeof e?e:String(e)}function zE(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const UE=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],$E=!1,GE=!0,YE=!0;class KE{constructor(t,e){jE(this,"hot",void 0),jE(this,"sortingStates",new wu),jE(this,"sortEmptyCells",$E),jE(this,"indicator",GE),jE(this,"headerAction",YE),jE(this,"compareFunctionFactory",void 0),jE(this,"mapName",void 0),this.hot=t,this.mapName=e,this.hot.columnIndexMapper.registerMap(e,this.sortingStates)}updateAllColumnsProperties(t){Eo(t)&&Mo(t,((t,e)=>{UE.includes(e)&&(this[e]=t)}))}getAllColumnsProperties(){const t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"===typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}getSortOrderOfColumn(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}getIndexOfColumnInSortQueue(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex((e=>{let[o]=e;return o===t}))}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(t){return Eo(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}getSortStates(){if(null===this.sortingStates)return[];const t=this.sortingStates.getEntries();return t.map((t=>{let[e,o]=t;return{column:this.hot.toVisualColumn(e),...o}}))}getColumnSortState(t){const e=this.getSortOrderOfColumn(t);if(U(e))return{column:t,sortOrder:e}}setSortStates(t){this.sortingStates.clear();for(let e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const XE="asc",qE="desc",QE="colHeader";function JE(t){if(!1===Eo(t))return!1;const{column:e,sortOrder:o}=t;return Number.isInteger(e)&&[XE,qE].includes(o)}function ZE(t){if(t.some((t=>!1===JE(t))))return!1;const e=t.map((t=>{let{column:e}=t;return e}));return new Set(e).size===e.length}function tT(t){if(t!==qE)return t===XE?qE:XE}function eT(t){const e=t.querySelector(`.${QE}`);return e}function oT(t,e){if(t<0||!e.parentNode)return!1;const o=e.parentNode.parentNode.childNodes,n=Array.from(o).indexOf(e.parentNode)-o.length;return-1===n}function nT(t,e,o){return-1===t&&e>=0&&!1===sn(o)}const iT="ascending",rT="descending",sT="indicatorDisabled",lT="columnSorting",aT="sortAction",hT=new Map([[XE,iT],[qE,rT]]);function cT(t,e,o,n){const i=[lT];if(n&&i.push(aT),!1===o)return i.push(sT),i;const r=t.getSortOrderOfColumn(e);return U(r)&&i.push(hT.get(r)),i}function uT(){return Array.from(hT.values()).concat(aT,sT,lT)}const dT=0,gT=-1,fT=1;function mT(t,e){const o=xT(e);for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];t.sort(o(...i))}function pT(t,e,o){const n=e.locale;return function(e,i){const{sortEmptyCells:r}=o;return"string"===typeof e&&(e=e.toLocaleLowerCase(n)),"string"===typeof i&&(i=i.toLocaleLowerCase(n)),e===i?dT:G(e)?G(i)?dT:r&&"asc"===t?gT:fT:G(i)?r&&"asc"===t?fT:gT:isNaN(e)&&!isNaN(i)?"asc"===t?fT:gT:!isNaN(e)&&isNaN(i)?"asc"===t?gT:fT:(isNaN(e)||isNaN(i)||(e=parseFloat(e),i=parseFloat(i)),e<i?"asc"===t?gT:fT:e>i?"asc"===t?fT:gT:dT)}}const wT="default";function vT(t,e,o){return function(e,n){const i=parseFloat(e),r=parseFloat(n),{sortEmptyCells:s}=o;if(i===r||isNaN(i)&&isNaN(r))return dT;if(s){if(G(e))return"asc"===t?gT:fT;if(G(n))return"asc"===t?fT:gT}return isNaN(i)?fT:isNaN(r)?gT:i<r?"asc"===t?gT:fT:i>r?"asc"===t?fT:gT:dT}}const CT="numeric";function yT(t,e,o){const n=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:r}=o;return function(s,l){const a=G(s),h=G(l),c=a?i:s,u=h?i:l,d=c===i||c===n,g=u===i||u===n;if(!1===r){if(a&&!1===h)return fT;if(!1===a&&h)return gT}return!1===d&&g?"asc"===t?gT:fT:d&&!1===g?"asc"===t?fT:gT:!1===d&&!1===g?pT(t,e,o)(s,l):c===i&&u===n?"asc"===t?gT:fT:c===n&&u===i?"asc"===t?fT:gT:dT}}const bT="checkbox";function ST(t,e,o){return function(n,i){const{sortEmptyCells:r}=o;if(n===i)return dT;if(G(n))return G(i)?dT:r&&"asc"===t?gT:fT;if(G(i))return r&&"asc"===t?fT:gT;const s=e.dateFormat,l=E(n,s),a=E(i,s);return l.isValid()?a.isValid()?a.isAfter(l)?"asc"===t?gT:fT:a.isBefore(l)?"asc"===t?fT:gT:dT:gT:fT}}const RT="date",{register:ET,getItem:TT,hasItem:MT}=Rn("sorting.compareFunctionFactory"),{register:HT,getItem:xT}=Rn("sorting.mainSortComparator");function kT(t){return MT(t)?TT(t):TT(wT)}function IT(t,e){return function(o,n){const[,...i]=o,[,...r]=n;return function(o){const n=t[o],s=e[o],l=i[o],a=r[o],h=s.columnSorting,c=h.compareFunctionFactory?h.compareFunctionFactory:kT(s.type),u=c(n,s,h)(l,a);return u}(0)}}function AT(t,e){OT(t,e),e.add(t)}function OT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PT(t,e,o){return e=NT(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function NT(t){var e=_T(t,"string");return"symbol"===typeof e?e:String(e)}function _T(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function LT(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}ET(CT,vT),ET(bT,yT),ET(RT,ST),ET(wT,pT);const DT="columnSorting",WT=50,VT="append",FT="replace",jT=DT,BT="columnSortingIndicator";HT(DT,IT),bn.getSingleton().register("beforeColumnSort"),bn.getSingleton().register("afterColumnSort");var zT=new WeakSet,UT=new WeakSet,$T=new WeakSet,GT=new WeakSet;class YT extends fS{constructor(){super(...arguments),AT(this,GT),AT(this,$T),AT(this,UT),AT(this,zT),PT(this,"columnStatesManager",null),PT(this,"columnMetaCache",null),PT(this,"pluginKey",DT),PT(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return DT}static get PLUGIN_PRIORITY(){return WT}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var t=this;this.enabled||(this.columnStatesManager=new KE(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new du((t=>{let e=this.hot.toVisualColumn(t);return null===e&&(e=t),this.getMergedPluginSettings(e)})),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",((t,e)=>LT(this,UT,XT).call(this,t,e))),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LT(t,GT,QT).call(t,...o)})),this.addHook("afterOnCellMouseDown",((t,e)=>this.onAfterOnCellMouseDown(t,e))),this.addHook("afterInit",(()=>LT(this,zT,KT).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LT(t,$T,qT).call(t,...o)})),this.hot.view&&LT(this,zT,KT).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const t=(t,e)=>{const o=eT(e);!1!==oT(t,e)&&null!==o&&this.updateHeaderClasses(o)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetColHeader",t)})),this.hot.batchExecution((()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();-1===t.row&&t.col>=0&&this.sort(this.getColumnNextConfig(t.col))},runOnlyIf:()=>{var t;return null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},group:jT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jT)}sort(t){const e=this.getSortConfig(),o=this.getNormalizedSortConfigs(t),n=this.areValidSortConfigs(o),i=this.hot.runHooks("beforeColumnSort",e,o,n);!1!==i&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new hu),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),n&&(this.columnStatesManager.setSortStates(o),this.sortByPresetSortStates(o),this.saveAllSortSettings(o)),this.hot.runHooks("afterColumnSort",e,n?o:e,n),n&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(t){return U(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}setSortConfig(t){const e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}areValidSortConfigs(t){const e=this.hot.countCols();return ZE(t)&&t.every((t=>{let{column:o}=t;return o<=e&&o>=0}))}saveAllSortSettings(t){const e=this.columnStatesManager.getAllColumnsProperties(),o=t=>{let{column:e,...o}=t;return{column:this.hot.toPhysicalColumn(e),...o}};e.initialConfig=I(t,o),this.hot.runHooks("persistentStateSave","columnSorting",e)}getAllSavedSortSettings(){const t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);const e=t.value,o=t=>{let{column:e,...o}=t;return{column:this.hot.toVisualColumn(e),...o}};return U(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=I(e.initialConfig,o)),e}getColumnNextConfig(t){const e=this.columnStatesManager.getSortOrderOfColumn(t);if(U(e)){const o=tT(e);return U(o)?{column:t,sortOrder:o}:void 0}const o=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<o)return{column:t,sortOrder:tT()}}getNextSortConfig(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:VT;const o=this.columnStatesManager.getIndexOfColumnInSortQueue(t),n=-1!==o,i=this.getSortConfig(),r=this.getColumnNextConfig(t);if(n){if($(r))return[...i.slice(0,o),...i.slice(o+1)];if(e===VT)return[...i.slice(0,o),...i.slice(o+1),r];if(e===FT)return[...i.slice(0,o),r,...i.slice(o+1)]}return U(r)?i.concat(r):i}getPluginColumnConfig(t){if(Eo(t)){const e=t[this.pluginKey];if(Eo(e))return e}return{}}getMergedPluginSettings(t){const e=this.hot.getSettings()[this.pluginKey],o=this.columnStatesManager.getAllColumnsProperties(),n=this.hot.getCellMeta(0,t),i=Object.getPrototypeOf(n);return Array.isArray(i.columns)?Object.assign(o,e,this.getPluginColumnConfig(i.columns[t])):so(i.columns)?Object.assign(o,e,this.getPluginColumnConfig(i.columns(t))):Object.assign(o,e)}getFirstCellSettings(t){const e=this.hot.getCellMeta(0,t),o=Object.create(e);return o[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),o}getNumberOfRowsToSort(t){const e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}sortByPresetSortStates(t){if(0===t.length)return void this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());const e=[],o=this.hot.countRows(),n=e=>I(t,(t=>this.hot.getDataAtCell(e,t.column)));for(let a=0;a<this.getNumberOfRowsToSort(o);a+=1)e.push([this.hot.toPhysicalRow(a)].concat(n(a)));const i=I(e,(t=>t[0]));mT(e,this.pluginKey,I(t,(t=>t.sortOrder)),I(t,(t=>this.getFirstCellSettings(t.column))));for(let a=e.length;a<o;a+=1)e.push([a].concat(n(a)));const r=I(e,(t=>t[0])),s=new Map(I(i,((t,e)=>[t,r[e]]))),l=I(this.hot.rowIndexMapper.getIndexesSequence(),(t=>s.has(t)?s.get(t):t));this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(t){if(Eo(t)){this.columnStatesManager.updateAllColumnsProperties(t);const e=t.initialConfig;(Array.isArray(e)||Eo(e))&&this.sort(e)}else this.hot.render()}updateHeaderClasses(t){if(ge(t,uT(t)),!1!==this.enabled){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];de(t,cT(...o))}}updateSortingIndicator(t,e){const o=this.getFirstCellSettings(t)[this.pluginKey],n=this.hot.getSettings().ariaTags,i=o.indicator,r=this.columnStatesManager.isColumnSorted(t),s=e.querySelector(`.${BT}`);i&&r&&!s&&ro(e,{tagName:"div",className:BT,attributes:n?[Ot()]:[]})}onUpdateSettings(t){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),U(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}wasClickableHeaderClicked(t,e){const o=this.getFirstCellSettings(e)[this.pluginKey],n=o.headerAction;return n&&"SPAN"===t.target.nodeName}onAfterOnCellMouseDown(t,e){!1!==nT(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}destroy(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),super.destroy()}}function KT(){const t=this.getAllSavedSortSettings();if(Eo(t))this.sortBySettings(t);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}function XT(t,e){const o=eT(e);if(!1===oT(t,e)||null===o)return;const n=this.getFirstCellSettings(t)[this.pluginKey],i=this.hot.getSettings().ariaTags,r=n.indicator,s=n.headerAction,l=this.columnStatesManager.getSortOrderOfColumn(t);this.updateHeaderClasses(o,this.columnStatesManager,t,r,s),this.updateSortingIndicator(t,o),i&&fe(e,[jt(l?`${l}ending`:"none"),At(this.hot.getTranslatedPhrase($g))])}function qT(t){!0===t&&this.hot.view&&LT(this,zT,KT).call(this)}function QT(t,e,o,n){!1!==nT(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}function JT(t,e,o){return e=ZT(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ZT(t){var e=tM(t,"string");return"symbol"===typeof e?e:String(e)}function tM(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class eM{constructor(t,e){JT(this,"plugin",void 0),JT(this,"hot",void 0),JT(this,"endpoints",[]),JT(this,"settings",void 0),JT(this,"settingsType","array"),JT(this,"currentEndpoint",null),JT(this,"cellsToSetCache",[]),this.plugin=t,this.hot=this.plugin.hot,this.settings=e}getEndpoint(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(t){return this.parseSettings(t.call(this))}parseSettings(t){const e=[];let o=t;if(o||"function"!==typeof this.settings)return o||(o=this.settings),A(o,(t=>{const o={};this.assignSetting(t,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(t,o,"reversedRowCoords",!1),this.assignSetting(t,o,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,o,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,o,"sourceColumn",t.destinationColumn),this.assignSetting(t,o,"type","sum"),this.assignSetting(t,o,"forceNumeric",!1),this.assignSetting(t,o,"suppressDataTypeErrors",!0),this.assignSetting(t,o,"suppressDataTypeErrors",!0),this.assignSetting(t,o,"customFunction",null),this.assignSetting(t,o,"readOnly",!0),this.assignSetting(t,o,"roundFloat",!1),e.push(o)})),e;this.settingsType="function"}assignSetting(t,e,o,n){if("ranges"!==o||void 0!==t[o]){if("ranges"!==o||0!==t[o].length)if(void 0===t[o]){if(n instanceof Error)throw n;e[o]=n}else"destinationRow"===o&&e.reversedRowCoords?e[o]=this.hot.countRows()-t[o]-1:e[o]=t[o]}else e[o]=n}resetSetupBeforeStructureAlteration(t,e,o){if("function"!==this.settingsType)return;const n=t.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();A(i,(i=>{"row"===n&&i.destinationRow>=e&&("insert_row"===t?i.alterRowOffset=o:"remove_row"===t&&(i.alterRowOffset=-1*o)),"col"===n&&i.destinationColumn>=e&&("insert_col"===t?i.alterColumnOffset=o:"remove_col"===t&&(i.alterColumnOffset=-1*o))})),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(t,e,o,n,i){let r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const t=()=>(this.hot.removeHook("beforeViewRender",t),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",t)}const s=t.indexOf("row")>-1?"row":"col",l=t.indexOf("remove")>-1?-1:1,a=this.getAllEndpoints(),h=0===t.indexOf("move_row"),c=e;A(a,(t=>{"row"===s&&t.destinationRow>=c&&(t.alterRowOffset=l*o),"col"===s&&t.destinationColumn>=c&&(t.alterColumnOffset=l*o)})),this.resetAllEndpoints(a,!h),A(a,h?t=>{this.extendEndpointRanges(t,c,n[0],n.length),this.recreatePhysicalRanges(t),this.clearOffsetInformation(t)}:t=>{this.shiftEndpointCoordinates(t,c)}),r&&this.refreshAllEndpoints()}clearOffsetInformation(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}extendEndpointRanges(t,e,o,n){A(t.ranges,(t=>{t[1]&&(e>=t[0]&&e<=t[1]?o>t[1]?t[1]+=n:o<t[0]&&(t[0]-=n):o>=t[0]&&o<=t[1]&&(t[1]-=n,e<=t[0]&&(t[0]+=1,t[1]+=1)))}))}recreatePhysicalRanges(t){const e=t.ranges,o=[],n=[];A(e,(t=>{const e=[];if(t[1])for(let o=t[0];o<=t[1];o++)e.push(this.hot.toPhysicalRow(o));else e.push(this.hot.toPhysicalRow(t[0]));n.push(e)})),A(n,(t=>{let e=[];A(t,((n,i)=>{0===i?e.push(n):t[i]!==t[i-1]+1&&(e.push(t[i-1]),o.push(e),e=[],e.push(n)),i===t.length-1&&(e.push(n),o.push(e))}))})),t.ranges=o}shiftEndpointCoordinates(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,A(t.ranges,(o=>{A(o,((n,i)=>{n>=e&&(o[i]+=t.alterRowOffset||0)}))}))):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}resetAllEndpoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=t.some((t=>{const e=t.alterRowOffset||0,o=t.alterColumnOffset||0;return t.destinationRow+e>=this.hot.countRows()||t.destinationColumn+o>=this.hot.countCols()}));o||(this.cellsToSetCache=[],A(t,(t=>{this.resetEndpointValue(t,e)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],A(this.getAllEndpoints(),(t=>{this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(t){const e=[];this.cellsToSetCache=[],A(t,((t,o,n)=>{`${t[2]||""}`!==`${t[3]}`&&A(this.getAllEndpoints(),((t,i)=>{this.hot.propToCol(n[o][1])===t.sourceColumn&&-1===e.indexOf(i)&&e.push(i)}))})),A(e,(t=>{this.refreshEndpoint(this.getEndpoint(t))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}resetEndpointValue(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=t.alterRowOffset||0,n=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?o:0)),this.hot.toVisualColumn(t.destinationColumn+(e?n:0)),""])}setEndpointValue(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const i=this.hot.toVisualRow(t.destinationRow);if(null!==i){const o=this.hot.getCellMeta(i,t.destinationColumn);"init"!==e&&o.readOnly===t.readOnly||(o.readOnly=t.readOnly,o.className="columnSummaryResult")}t.roundFloat&&!isNaN(t.result)&&(t.result=t.result.toFixed(t.roundFloat)),o?this.hot.setDataAtCell(n,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([n,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}throwOutOfBoundsWarning(){hn("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}var oM=eM;function nM(t){return null===t||void 0===t||isNaN(t)}function iM(t,e){rM(t,e),e.add(t)}function rM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sM(t,e,o){return e=lM(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function lM(t){var e=aM(t,"string");return"symbol"===typeof e?e:String(e)}function aM(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function hM(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const cM="columnSummary",uM=220;var dM=new WeakSet,gM=new WeakSet,fM=new WeakSet;class mM extends fS{constructor(){super(...arguments),iM(this,fM),iM(this,gM),iM(this,dM),sM(this,"endpoints",null)}static get PLUGIN_KEY(){return cM}static get PLUGIN_PRIORITY(){return uM}isEnabled(){return!!this.hot.getSettings()[cM]}enablePlugin(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[cM],this.endpoints=new oM(this,this.settings),this.addHook("afterInit",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return hM(t,dM,pM).call(t,...o)})),this.addHook("afterChange",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return hM(t,gM,wM).call(t,...o)})),this.addHook("beforeCreateRow",((t,e,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,e,null,o))),this.addHook("beforeCreateCol",((t,e,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,e,null,o))),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupBeforeStructureAlteration("remove_row",...o)})),this.addHook("beforeRemoveCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupBeforeStructureAlteration("remove_col",...o)})),this.addHook("afterCreateRow",((t,e,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,e,null,o))),this.addHook("afterCreateCol",((t,e,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,e,null,o))),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupAfterStructureAlteration("remove_row",...o)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupAfterStructureAlteration("remove_col",...o)})),this.addHook("afterRowMove",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return hM(t,fM,vM).call(t,...o)})),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":t.result=this.calculateMinMax(t,t.type);break;case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t);break;default:break}}calculateSum(t){let e=0;return Mo(t.ranges,(o=>{e+=this.getPartialSum(o,t.sourceColumn)})),e}getPartialSum(t,e){let o=0,n=t[1]||t[0],i=null,r=0;do{if(i=this.getCellValue(n,e),i=nM(i)?null:i,null!==i){const t=(`${i}`.split(".")[1]||[]).length||1;t>r&&(r=t)}o+=i||0,n-=1}while(n>=t[0]);return Math.round(o*10**r)/10**r}calculateMinMax(t,e){let o=null;return Mo(t.ranges,(n=>{const i=this.getPartialMinMax(n,t.sourceColumn,e);if(null===o&&null!==i&&(o=i),null!==i)switch(e){case"min":o=Math.min(o,i);break;case"max":o=Math.max(o,i);break;default:break}})),null===o?"Not enough data":o}getPartialMinMax(t,e,o){let n,i=null,r=t[1]||t[0];do{if(n=this.getCellValue(r,e),n=nM(n)?null:n,null===i)i=n;else if(null!==n)switch(o){case"min":i=Math.min(i,n);break;case"max":i=Math.max(i,n);break;default:break}r-=1}while(r>=t[0]);return i}countEmpty(t,e){let o,n=0,i=t[1]||t[0];do{o=this.getCellValue(i,e),o=nM(o)?null:o,null===o&&(n+=1),i-=1}while(i>=t[0]);return n}countEntries(t){let e=0;const o=t.ranges;return Mo(o,(o=>{const n=void 0===o[1]?1:o[1]-o[0]+1,i=this.countEmpty(o,t.sourceColumn);e+=n,e-=i})),e}calculateAverage(t){const e=this.calculateSum(t),o=this.countEntries(t);return e/o}getCellValue(t,e){const o=this.hot.toVisualRow(t),n=this.hot.toVisualColumn(e);let i=this.hot.getSourceDataAtCell(t,e),r="";if(null!==o&&null!==n&&(r=this.hot.getCellMeta(o,n).className||""),r.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"===typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(B`ColumnSummary plugin: cell at (${t}, ${e}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}}function pM(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}function wM(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}function vM(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function CM(t,e,o){return e=yM(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function yM(t){var e=bM(t,"string");return"symbol"===typeof e?e:String(e)}function bM(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class SM{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(t,e){CM(this,"rootDocument",void 0),CM(this,"isRtl",!1),CM(this,"container",null),CM(this,"editor",void 0),CM(this,"editorStyle",void 0),CM(this,"hidden",!0),this.rootDocument=t,this.isRtl=e,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(t,e){this.editorStyle.left=`${t}px`,this.editorStyle.top=`${e}px`}setSize(t,e){if(t&&e){const o=this.getInputElement();o.style.width=`${t}px`,o.style.height=`${e}px`}}getSize(){return{width:Oe(this.getInputElement()),height:Pe(this.getInputElement())}}resetSize(){const t=this.getInputElement();t.style.width="",t.style.height=""}setReadOnlyState(t){const e=this.getInputElement();e.readOnly=t}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return"block"===this.editorStyle.display}setValue(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const e=t||"";this.getInputElement().value=e}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const t=this.rootDocument.createElement("div"),e=this.rootDocument.createElement("textarea");return t.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),de(this.container,SM.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),de(t,SM.CLASS_EDITOR),de(e,SM.CLASS_INPUT),e.setAttribute("data-hot-input",!0),t.appendChild(e),this.container.appendChild(t),t}getInputElement(){return this.editor.querySelector(`.${SM.CLASS_INPUT}`)}destroy(){const t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,t&&t.removeChild(this.container)}}var RM=SM;function EM(t,e,o){return e=TM(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function TM(t){var e=MM(t,"string");return"symbol"===typeof e?e:String(e)}function MM(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const HM=250,xM=250;class kM{constructor(t){EM(this,"wasLastActionShow",!0),EM(this,"showDebounced",null),EM(this,"hidingTimer",null),this.updateDelay(t)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout((()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")}),xM)}show(t){this.wasLastActionShow=!0,this.showDebounced(t)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:HM;this.showDebounced=ho((t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)}),t)}destroy(){this.clearLocalHooks()}}So(kM,tu);var IM=kM;const AM="---------";function OM(){return{name:AM}}function PM(t){return{key:"commentsAddEdit",name(){var e;const o=null===(e=this.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return null!==o&&void 0!==o&&o.isCell()&&t.getCommentAtCell(o.row,o.col)?this.getTranslatedPhrase(_d):this.getTranslatedPhrase(Nd)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}function NM(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(Ld)},callback(){const e=this.getSelectedRangeLast();e.forAll(((e,o)=>{e>=0&&o>=0&&t.removeCommentAtCell(e,o,!1)})),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}function _M(t,e){if(-1!==t.indexOf(e))return t;const o=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return`${o} ${e}`}function LM(t,e){if(-1!==t.indexOf(e))return t;const o=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return`${o} ${e}`}function DM(t,e){const o={};return A(t,(t=>{t.forAll(((t,n)=>{t>=0&&n>=0&&(o[t]||(o[t]=[]),o[t][n]=e(t,n))}))})),o}function WM(t,e,o,n,i){A(t,(t=>{t.forAll(((t,r)=>{t>=0&&r>=0&&VM(t,r,e,o,n,i)}))}))}function VM(t,e,o,n,i,r){const s=i(t,e);let l=n;s.className&&(l="vertical"===o?_M(s.className,n):LM(s.className,n)),r(t,e,"className",l)}function FM(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function jM(t,e){let o=!1;return Array.isArray(t)&&A(t,(t=>(t.forAll(((t,n)=>{if(t>=0&&n>=0&&e(t,n))return o=!0,!1})),o))),o}function BM(t,e){const o={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:t}=e.defaultView,{top:n,left:i}=t.getBoundingClientRect();o.top=n,o.left=i}return o}function zM(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(Dd),o=jM(this.getSelectedRange(),((e,o)=>t.getCommentMeta(e,o,lH)));return o?FM(e):e},callback(){const e=this.getSelectedRangeLast();e.forAll(((e,o)=>{if(e>=0&&o>=0){const n=!!t.getCommentMeta(e,o,lH);t.updateCommentMeta(e,o,{[lH]:!n})}}))},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}function UM(t,e){GM(t,e),e.add(t)}function $M(t,e,o){GM(t,e),e.set(t,o)}function GM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YM(t,e,o){return e=KM(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function KM(t){var e=XM(t,"string");return"symbol"===typeof e?e:String(e)}function XM(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function qM(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function QM(t,e,o){var n=tH(t,e,"set");return JM(t,n,o),o}function JM(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function ZM(t,e){var o=tH(t,e,"get");return eH(t,o)}function tH(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function eH(t,e){return e.get?e.get.call(t):e.value}const oH="comments",nH=60,iH="comment",rH="value",sH="style",lH="readOnly",aH=oH,hH=`plugin:${oH}`;var cH=new WeakMap,uH=new WeakMap,dH=new WeakMap,gH=new WeakMap,fH=new WeakMap,mH=new WeakMap,pH=new WeakMap,wH=new WeakSet,vH=new WeakSet,CH=new WeakSet,yH=new WeakSet,bH=new WeakSet,SH=new WeakSet,RH=new WeakSet,EH=new WeakSet,TH=new WeakSet,MH=new WeakSet;class HH extends fS{constructor(){super(...arguments),UM(this,MH),UM(this,TH),UM(this,EH),UM(this,RH),UM(this,SH),UM(this,bH),UM(this,yH),UM(this,CH),UM(this,vH),UM(this,wH),YM(this,"range",{}),$M(this,cH,{writable:!0,value:null}),$M(this,uH,{writable:!0,value:null}),$M(this,dH,{writable:!0,value:!1}),$M(this,gH,{writable:!0,value:!1}),$M(this,fH,{writable:!0,value:{}}),$M(this,mH,{writable:!0,value:null}),$M(this,pH,{writable:!0,value:""})}static get PLUGIN_KEY(){return oH}static get PLUGIN_PRIORITY(){return nH}isEnabled(){return!!this.hot.getSettings()[oH]}enablePlugin(){this.enabled||(ZM(this,cH)||QM(this,cH,new RM(this.hot.rootDocument,this.hot.isRtl())),ZM(this,uH)||QM(this,uH,new IM(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(t=>this.addToContextMenu(t))),this.addHook("afterRenderer",((t,e,o,n,i,r)=>qM(this,yH,AH).call(this,t,r))),this.addHook("afterScroll",(()=>qM(this,MH,DH).call(this))),this.addHook("afterBeginEditing",(()=>this.hide())),this.addHook("afterDocumentKeyDown",(t=>qM(this,TH,LH).call(this,t))),ZM(this,uH).addLocalHook("hide",(()=>this.hide())),ZM(this,uH).addLocalHook("show",((t,e)=>this.showAtCell(t,e))),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){ZM(this,uH).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid"),o=t.addContext(hH);e.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const e=this.hot.getSelectedRangeLast();QM(this,gH,!0),this.hot.scrollToFocusedCell((()=>{this.setRange(e),this.show(),this.focusEditor(),t.setActiveContextName(hH),this.hot._registerTimeout((()=>{QM(this,gH,!1)}))}))},stopPropagation:!0,runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&!ZM(this,cH).isVisible()},group:aH}),o.addShortcut({keys:[["Escape"]],callback:()=>{ZM(this,cH).setValue(ZM(this,pH)),this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&ZM(this,cH).isVisible()},group:aH}),o.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&ZM(this,cH).isVisible()},group:aH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(aH)}registerListeners(){const{rootDocument:t}=this.hot,e=this.getEditorInputElement();this.eventManager.addEventListener(t,"mouseover",(t=>qM(this,vH,kH).call(this,t))),this.eventManager.addEventListener(t,"mousedown",(t=>qM(this,wH,xH).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>qM(this,CH,IH).call(this))),this.eventManager.addEventListener(e,"focus",(()=>qM(this,SH,PH).call(this))),this.eventManager.addEventListener(e,"blur",(()=>qM(this,bH,OH).call(this))),this.eventManager.addEventListener(e,"mousedown",(t=>qM(this,RH,NH).call(this,t))),this.eventManager.addEventListener(e,"mouseup",(t=>qM(this,EH,_H).call(this,t)))}setRange(t){this.range=t}clearRange(){this.range={}}targetIsCellWithComment(t){const e=ie(t.target,"TD","TBODY");return!!(e&&ue(e,"htCommentCell")&&ie(e,[this.hot.rootElement]))}targetIsCommentTextArea(t){return this.getEditorInputElement()===t.target}setComment(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const e=ZM(this,cH).getValue();let o="";null!==t&&void 0!==t?o=t:null!==e&&void 0!==e&&(o=e);const n=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(n,i,{[rH]:o}),this.hot.render()}setCommentAtCell(t,e,o){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(o)}removeComment(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,iH),t&&this.hot.render(),this.hide()}removeCommentAtCell(t,e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(o)}getComment(){const t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,rH)}getCommentAtCell(t,e){return this.getCommentMeta(t,e,rH)}show(){var t;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:e,col:o}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||o<0||o>this.hot.countSourceCols()-1)return!1;const n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return ZM(this,uH).cancelHiding(),ZM(this,cH).setValue(null!==(t=n[iH]?n[iH][rH]:null)&&void 0!==t?t:""),ZM(this,cH).show(),this.refreshEditor(!0),!0}showAtCell(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}hide(){ZM(this,cH).hide()}refreshEditor(){var t,e;let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!o&&(!this.range.from||!ZM(this,cH).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{row:r,col:s}=this.range.from;let l=n.getRenderableFromVisualIndex(r),a=i.getRenderableFromVisualIndex(s);const h=null===l;ZM(this,cH).setPosition(0,0),null===l&&(l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1))),null===a&&(a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1)));const c=null===l,u=null===a;l=null!==(t=l)&&void 0!==t?t:0,a=null!==(e=a)&&void 0!==e?e:0;const{rootWindow:d,view:{_wt:g}}=this.hot,{wtTable:f}=g,m=g.getCell({row:l,col:a},!0),p=this.getCommentMeta(r,s,sH);p?ZM(this,cH).setSize(p.width,p.height):ZM(this,cH).resetSize();const w=u?0:f.getStretchedColumnWidth(a),v=h&&!c?Pe(m):0,{left:C,top:y,width:b,height:S}=m.getBoundingClientRect(),{width:R,height:E}=ZM(this,cH).getSize(),{innerWidth:T,innerHeight:M}=this.hot.rootWindow,H=this.hot.rootDocument.documentElement;let x=C+d.scrollX+w,k=y+d.scrollY+v;this.hot.isRtl()&&(x-=R+w),this.hot.isLtr()&&C+b+R>T?x=C+d.scrollX-R-1:this.hot.isRtl()&&x<-(H.scrollWidth-H.clientWidth)&&(x=C+d.scrollX+w+1),y+E>M&&(k-=E-S+1),ZM(this,cH).setPosition(x,k),ZM(this,cH).setReadOnlyState(this.getCommentMeta(r,s,lH))}focusEditor(){ZM(this,cH).focus()}updateCommentMeta(t,e,o){const n=this.hot.getCellMeta(t,e)[iH];let i;n?(i=yo(n),Co(i,o)):i=o,this.hot.setCellMeta(t,e,iH,i)}getCommentMeta(t,e,o){const n=this.hot.getCellMeta(t,e);if(n[iH])return n[iH][o]}addToContextMenu(t){t.items.push({name:AM},PM(this),NM(this),zM(this))}getDisplayDelaySetting(){const t=this.hot.getSettings()[oH];if(Eo(t))return t.displayDelay}getEditorInputElement(){return ZM(this,cH).getInputElement()}destroy(){ZM(this,cH)&&ZM(this,cH).destroy(),ZM(this,uH)&&ZM(this,uH).destroy(),super.destroy()}}function xH(t){if(this.hot.view&&this.hot.view._wt&&!ZM(this,dH)&&!this.targetIsCommentTextArea(t)){const e=ie(t.target,"TD","TBODY");let o=null;e&&(o=this.hot.getCoords(e)),(!e||this.range.from&&o&&(this.range.from.row!==o.row||this.range.from.col!==o.col))&&this.hide()}}function kH(t){const{rootDocument:e}=this.hot;if(!(ZM(this,dH)||ZM(this,cH).isFocused()||ue(t.target,"wtBorder")||ZM(this,mH)===t.target)&&ZM(this,cH))if(QM(this,mH,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const e=this.hot._createCellRange(this.hot.getCoords(t.target));ZM(this,uH).show(e)}else se(t.target,e)&&!this.targetIsCommentTextArea(t)&&ZM(this,uH).hide()}function IH(){QM(this,dH,!1)}function AH(t,e){e[iH]&&e[iH][rH]&&de(t,e.commentedCellClassName)}function OH(){QM(this,pH,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function PH(){QM(this,pH,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(hH)}function NH(t){QM(this,fH,{width:Oe(t.target),height:Pe(t.target)})}function _H(t){const e=Oe(t.target),o=Pe(t.target);e===ZM(this,fH).width+1&&o===ZM(this,fH).height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,{[sH]:{width:e,height:o}})}function LH(t){ZM(this,cH).isVisible()&&nn(t)}function DH(){ZM(this,gH)||this.hide()}o(7754);function WH(t,e,o){return e=VH(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function VH(t){var e=FH(t,"string");return"symbol"===typeof e?e:String(e)}function FH(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class jH{constructor(t){WH(this,"hot",void 0),WH(this,"commands",{}),WH(this,"commonCallback",null),this.hot=t}registerCommand(t,e){this.commands[t]=e}setCommonCallback(t){this.commonCallback=t}execute(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];const i=t.split(":"),r=i[0],s=2===i.length?i[1]:null;let l=this.commands[r];if(!l)throw new Error(`Menu command '${r}' not exists.`);if(s&&l.submenu&&(l=BH(s,l.submenu.items)),!0===l.disabled)return;if("function"===typeof l.disabled&&!0===l.disabled.call(this.hot))return;if(Ao(l,"submenu"))return;const a=[];"function"===typeof l.callback&&a.push(l.callback),"function"===typeof this.commonCallback&&a.push(this.commonCallback),o.unshift(i.join(":")),A(a,(t=>t.apply(this.hot,o)))}}function BH(t,e){let o;return A(e,(e=>{const n=e.key?e.key.split(":"):null;if(Array.isArray(n)&&n[1]===t)return o=e,!1})),o}const zH="alignment";function UH(){return{key:zH,name(){return this.getTranslatedPhrase(Wd)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner()))},submenu:{items:[{key:`${zH}:left`,name(){let t=this.getTranslatedPhrase(Vd);const e=jM(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htLeft"))return!0}));return e&&(t=FM(t)),t},callback(){const t=this.getSelectedRange(),e=DM(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,o,n),WM(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${zH}:center`,name(){let t=this.getTranslatedPhrase(Fd);const e=jM(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htCenter"))return!0}));return e&&(t=FM(t)),t},callback(){const t=this.getSelectedRange(),e=DM(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,o,n),WM(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${zH}:right`,name(){let t=this.getTranslatedPhrase(jd);const e=jM(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htRight"))return!0}));return e&&(t=FM(t)),t},callback(){const t=this.getSelectedRange(),e=DM(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,o,n),WM(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${zH}:justify`,name(){let t=this.getTranslatedPhrase(Bd);const e=jM(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htJustify"))return!0}));return e&&(t=FM(t)),t},callback(){const t=this.getSelectedRange(),e=DM(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,o,n),WM(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{name:AM},{key:`${zH}:top`,name(){let t=this.getTranslatedPhrase(zd);const e=jM(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htTop"))return!0}));return e&&(t=FM(t)),t},callback(){const t=this.getSelectedRange(),e=DM(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,o,n),WM(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${zH}:middle`,name(){let t=this.getTranslatedPhrase(Ud);const e=jM(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htMiddle"))return!0}));return e&&(t=FM(t)),t},callback(){const t=this.getSelectedRange(),e=DM(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,o,n),WM(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${zH}:bottom`,name(){let t=this.getTranslatedPhrase($d);const e=jM(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htBottom"))return!0}));return e&&(t=FM(t)),t},callback(){const t=this.getSelectedRange(),e=DM(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,o,n),WM(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1}]}}}const $H="clear_column";function GH(){return{key:$H,name(){return this.getTranslatedPhrase(Ed)},callback(t,e){const o=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,o,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByColumnHeader())}}}const YH="col_left";function KH(){return{key:YH,name(){return this.getTranslatedPhrase(wd)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.col<0)return!0;if(this.selection.isSelectedByCorner()){const t=this.countCols();return 0===t}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const XH="col_right";function qH(){return{key:XH,name(){return this.getTranslatedPhrase(vd)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden(){return!this.getSettings().allowInsertColumn}}}const QH="make_read_only";function JH(){return{key:QH,name(){let t=this.getTranslatedPhrase(Rd);const e=jM(this.getSelectedRange(),((t,e)=>this.getCellMeta(t,e).readOnly));return e&&(t=FM(t)),t},callback(){const t=this.getSelectedRange(),e=jM(t,((t,e)=>this.getCellMeta(t,e).readOnly));A(t,(t=>{t.forAll(((t,o)=>{t>=0&&o>=0&&this.setCellMeta(t,o,"readOnly",!e)}))})),this.render()},disabled(){const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||(!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))))}}}const ZH="redo";function tx(){return{key:ZH,name(){return this.getTranslatedPhrase(Sd)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const ex="remove_col";function ox(){return{key:ex,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,o,,n]=t[0];o-n!==0&&(e=1)}return this.getTranslatedPhrase(yd,e)},callback(){this.alter("remove_col",Vm(this.getSelected()),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}}const nx="remove_row";function ix(){return{key:nx,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[o,,n]=t[0];o-n!==0&&(e=1)}return this.getTranslatedPhrase(Cd,e)},callback(){this.alter("remove_row",Fm(this.getSelected()),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}}const rx="row_above";function sx(){return{key:rx,name(){return this.getTranslatedPhrase(md)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.row<0)return!0;if(this.selection.isSelectedByCorner()){const t=this.countRows();return 0===t}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const lx="row_below";function ax(){return{key:lx,name(){return this.getTranslatedPhrase(pd)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.row<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows))},hidden(){return!this.getSettings().allowInsertRow}}}const hx="no_items";function cx(){return{key:hx,name(){return this.getTranslatedPhrase(fd)},disabled:!0,isCommand:!1}}const ux="undo";function dx(){return{key:ux,name(){return this.getTranslatedPhrase(bd)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const gx=[rx,lx,YH,XH,$H,nx,ex,ux,ZH,QH,zH,AM,hx],fx={[AM]:OM,[hx]:cx,[rx]:sx,[lx]:ax,[YH]:KH,[XH]:qH,[$H]:GH,[nx]:ix,[ex]:ox,[ux]:dx,[ZH]:tx,[QH]:JH,[zH]:UH};function mx(){const t={};return Mo(fx,((e,o)=>{t[o]=e()})),t}function px(t,e,o){return e=wx(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function wx(t){var e=vx(t,"string");return"symbol"===typeof e?e:String(e)}function vx(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Cx{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;px(this,"hot",void 0),px(this,"predefinedItems",mx()),px(this,"defaultOrderPattern",void 0),this.hot=t,this.defaultOrderPattern=e}setPredefinedItems(t){const e={};this.defaultOrderPattern.length=0,Mo(t,((t,o)=>{let n="";t.name===AM?(e[AM]=t,n=AM):isNaN(parseInt(o,10))?(t.key=void 0===t.key?o:t.key,e[o]=t,n=t.key):(e[t.key]=t,n=t.key),this.defaultOrderPattern.push(n)})),this.predefinedItems=e}getItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return yx(t,this.defaultOrderPattern,this.predefinedItems)}}function yx(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Eo(i)?Mo(i,((t,e)=>{let i=o["string"===typeof t?t:e];i||(i=t),Eo(t)?vo(i,t):"string"===typeof i&&(i={name:i}),void 0===i.key&&(i.key=e),n.push(i)})):A(i,((t,e)=>{let i=o[t];!i&&gx.indexOf(t)>=0||(i||(i={name:t,key:`${e}`}),Eo(t)&&vo(i,t),void 0===i.key&&(i.key=e),n.push(i))})),n}function bx(t,e,o){return e=Sx(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Sx(t){var e=Rx(t,"string");return"symbol"===typeof e?e:String(e)}function Rx(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ex{constructor(t,e){bx(this,"top",void 0),bx(this,"topRelative",void 0),bx(this,"left",void 0),bx(this,"leftRelative",void 0),bx(this,"scrollTop",void 0),bx(this,"scrollLeft",void 0),bx(this,"cellHeight",void 0),bx(this,"cellWidth",void 0);const o=e.scrollY,n=e.scrollX;let i,r,s,l,a,h;this.rootWindow=e,this.type=this.getSourceType(t),"literal"===this.type?(i=parseInt(t.top,10),s=parseInt(t.left,10),a=t.height||0,h=t.width||0,r=i,l=s,i+=o,s+=n):"event"===this.type&&(i=parseInt(t.pageY,10),s=parseInt(t.pageX,10),a=t.target.clientHeight,h=t.target.clientWidth,r=i-o,l=s-n),this.top=i,this.topRelative=r,this.left=s,this.leftRelative=l,this.scrollTop=o,this.scrollLeft=n,this.cellHeight=a,this.cellWidth=h}getSourceType(t){let e="literal";return t instanceof Event&&(e="event"),e}fitsAbove(t){return this.topRelative>=t.offsetHeight}fitsBelow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}fitsOnRight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}fitsOnLeft(t){return this.leftRelative>=t.offsetWidth}}function Tx(t,e,o){Mx(t,e),e.set(t,o)}function Mx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hx(t,e){var o=Ix(t,e,"get");return xx(t,o)}function xx(t,e){return e.get?e.get.call(t):e.value}function kx(t,e,o){var n=Ix(t,e,"set");return Ax(t,n,o),o}function Ix(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Ax(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var Ox=new WeakMap,Px=new WeakMap,Nx=new WeakMap,_x=new WeakMap,Lx=new WeakMap;class Dx{constructor(t){Tx(this,Ox,{writable:!0,value:void 0}),Tx(this,Px,{writable:!0,value:void 0}),Tx(this,Nx,{writable:!0,value:void 0}),Tx(this,_x,{writable:!0,value:!1}),Tx(this,Lx,{writable:!0,value:{above:0,below:0,left:0,right:0}}),kx(this,_x,t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Hx(this,Lx)[t]=e,this}setElement(t){return kx(this,Ox,t),this}setParentElement(t){return kx(this,Px,t),this}updatePosition(t){kx(this,Nx,new Ex(t,Hx(this,Ox).ownerDocument.defaultView)),Hx(this,_x)?(Hx(this,Nx).fitsBelow(Hx(this,Ox))?this.setPositionBelowCursor():Hx(this,Nx).fitsAbove(Hx(this,Ox))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===Hx(this,Ox).dir?Hx(this,Nx).fitsOnLeft(Hx(this,Ox))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Hx(this,Nx).fitsOnRight(Hx(this,Ox))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let t=Hx(this,Lx).above+Hx(this,Nx).top-Hx(this,Ox).offsetHeight;Hx(this,Px)&&(t=Hx(this,Nx).top+Hx(this,Nx).cellHeight-Hx(this,Ox).offsetHeight+3),Hx(this,Ox).style.top=`${t}px`}setPositionBelowCursor(){let t=Hx(this,Lx).below+Hx(this,Nx).top+1;Hx(this,Px)&&(t=Hx(this,Nx).top-1),Hx(this,Ox).style.top=`${t}px`}setPositionOnRightOfCursor(){let t=Hx(this,Nx).left;if(Hx(this,Px)){const{right:e}=Hx(this,Px).getBoundingClientRect();t+=Hx(this,Nx).cellWidth+e-(Hx(this,Nx).left+Hx(this,Nx).cellWidth)}else t+=Hx(this,Lx).right;Hx(this,Ox).style.left=`${t}px`}setPositionOnLeftOfCursor(){let t=Hx(this,Lx).left+Hx(this,Nx).left-Hx(this,Ox).offsetWidth;if(Hx(this,Px)){const{left:e}=Hx(this,Px).getBoundingClientRect();t-=Hx(this,Nx).left-e}Hx(this,Ox).style.left=`${t}px`}}function Wx(t){let{initialPage:e=-1,size:o=(()=>0),onItemSelect:n=(()=>{}),onClear:i=(()=>{})}=t;const r=new Set;let s=Li(e,-1,f()-1);function l(t,e){const o=f()-1;if(t<0&&(t=o),t>o&&(t=0),r.has(t))return-1;r.add(t);const i=n(t,!1);return!1===i&&(t=l(1===e?++t:--t,e)),t}function a(t){t>-1&&t<f()&&!1!==n(t,!0)&&(s=t)}function h(){return s}function c(){f()>0&&(r.clear(),s=l(0,1))}function u(){f()>0&&(r.clear(),s=l(f()-1,-1))}function d(){f()>0&&(r.clear(),s=l(++s,1))}function g(){f()>0&&(r.clear(),s=l(--s,-1))}function f(){return Math.max(o(),0)}function m(){r.clear(),s=e,i()}return{setCurrentPage:a,getCurrentPage:h,toFirstItem:c,toLastItem:u,toNextItem:d,toPreviousItem:g,getSize:f,clear:m}}function Vx(t){return I(t,(t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()})))}function Fx(t){return Ao(t,"submenu")}function jx(t){return new RegExp(AM,"i").test(t.name)}function Bx(t,e){return!0===t.disabled||"function"===typeof t.disabled&&!0===t.disabled.call(e)}function zx(t){return Ao(t,"disableSelection")}function Ux(t){return ue(t,"htSeparator")}function $x(t){return ue(t,"htSubmenu")}function Gx(t){return ue(t,"htDisabled")}function Yx(t){return ue(t,"htSelectionDisabled")}function Kx(t,e){return!t.hidden||!("function"===typeof t.hidden&&t.hidden.call(e))}function Xx(t,e){const o=t.slice(0);for(let n=0;n<o.length;){if(o[n].name!==e)break;o.shift()}return o}function qx(t,e){let o=t.slice(0);return o.reverse(),o=Xx(o,e),o.reverse(),o}function Qx(t){const e=[];return A(t,((t,o)=>{o>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)})),e}function Jx(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:AM,o=t.slice(0);return o=Xx(o,e),o=qx(o,e),o=Qx(o),o}function Zx(t){return Wx({size:()=>t.countRows(),onItemSelect(e,o){const n=t.getCell(e,0);if(!n||Ux(n)||Gx(n)||Yx(n))return!1;t.selectCell(e,0,...o?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function tk(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const o=t.openSubMenu(e[0]);o&&o.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{const e=t.hotMenu.getSelectedLast();e&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const o=t.hotMenu.getSelectedLast();o&&(t.hotMenu.getSourceDataAtRow(o[0]).submenu?t.openSubMenu(o[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{const e=t.hotMenu.getSelectedLast();e?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{const e=t.hotMenu.getSelectedLast();e?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const ek="menu",ok=ek;function nk(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=[];function n(t,e){l(e).addShortcuts(t,{group:ek})}function i(t,e){const i=l(e);t.forEach((t=>{let{keys:e}=t;e.forEach((t=>i.removeShortcutsByKeys(t)))})),o.push({shortcuts:t,contextName:e}),n(t,e)}function r(){return[...o]}function s(t){return t?`${ok}:${t}`:ok}function l(e){var o;const n=t.hotMenu.getShortcutManager(),i=s(e);return null!==(o=n.getContext(i))&&void 0!==o?o:n.addContext(i)}function a(e){t.hotMenu.getShortcutManager().setActiveContextName(s(e))}return n(tk(t)),e.forEach((t=>{let{shortcuts:e,contextName:o}=t;i(e,o)})),{addCustomShortcuts:i,getCustomShortcuts:r,getContext:l,listen:a}}const ik="submenuIndicator";function rk(t){return(e,o,n,i,r,s)=>{if(o.hasAttribute("ghost-table"))return;const l=e.getSourceDataAtRow(n),a=t.rootDocument.createElement("div"),h="function"===typeof s?s.call(t):s;if(we(o),de(a,"htItemWrapper"),t.getSettings().ariaTags){const e=!Bx(l,t)&&!zx(l)&&!jx(l);fe(o,[St(),It(h),...e?[ft(-1)]:[],...Bx(l,t)?[Pt()]:[],...Fx(l)?[Ft(!1)]:[]])}if(Fx(l)){const e=o.querySelector(".submenuIndicator");e||ro(o,{tagName:"div",attributes:t.getSettings().ariaTags?[Ot()]:[],className:ik})}o.className="",o.appendChild(a),jx(l)?de(o,"htSeparator"):"function"===typeof l.renderer?(de(o,"htCustomMenuRenderer"),o.appendChild(l.renderer(e,a,n,i,r,h))):Ce(a,h),Bx(l,t)?de(o,"htDisabled"):zx(l)?de(o,"htSelectionDisabled"):Fx(l)&&de(o,"htSubmenu")}}function sk(t,e,o){lk(t,e),e.set(t,o)}function lk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ak(t,e,o){return e=hk(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function hk(t){var e=ck(t,"string");return"symbol"===typeof e?e:String(e)}function ck(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function uk(t,e,o){var n=fk(t,e,"set");return dk(t,n,o),o}function dk(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function gk(t,e){var o=fk(t,e,"get");return mk(t,o)}function fk(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function mk(t,e){return e.get?e.get.call(t):e.value}const pk=215;var wk=new WeakMap,vk=new WeakMap;class Ck{constructor(t,e){var o=this;ak(this,"hot",void 0),ak(this,"options",void 0),ak(this,"eventManager",new Fn(this)),ak(this,"container",void 0),ak(this,"positioner",void 0),ak(this,"hotMenu",null),ak(this,"hotSubMenus",{}),ak(this,"parentMenu",void 0),ak(this,"menuItems",null),ak(this,"origOutsideClickDeselects",null),sk(this,wk,{writable:!0,value:void 0}),sk(this,vk,{writable:!0,value:void 0}),this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:pk,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Dx(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.parentMenu.runLocalHooks("afterSelectionChange",...e)}))}registerEvents(){let t=this.hot.rootWindow;while(t)this.eventManager.addEventListener(t.document,"mousedown",(t=>this.onDocumentMouseDown(t))),this.eventManager.addEventListener(t.document,"contextmenu",(t=>this.onDocumentContextMenu(t))),t=oe(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return gk(this,wk)}getKeyboardShortcutsCtrl(){return gk(this,vk)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=ho((t=>this.openSubMenu(t)),300),e=this.options.minWidth||pk;let o=!1,n=k(this.menuItems,(t=>(t.key===hx&&(o=!0),Kx(t,this.hot))));if(n.length<1&&!o)n.push(mx()[hx]);else if(0===n.length)return;n=Jx(n,AM);let i=!1;const r={data:n,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(t){return U(t)&&t<e?e:t},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:rk(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(t,e)=>{gk(this,wk).setCurrentPage(e.row)},afterOnCellMouseOver:(e,o)=>{this.isAllSubMenusClosed()?t(o.row):this.openSubMenu(o.row)},rowHeights:t=>n[t].name===AM?1:23,afterOnCellContextMenu:t=>{t.preventDefault(),Yo()&&i&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(t,e,o,n,i)=>{this.hotMenu.view.isMouseDown()&&(i.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:t=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(t))},afterOnCellMouseUp:t=>{Yo()&&sn(t)||!i||!this.hasSelectedItem()||(Uo()||Go()?this.hot._registerTimeout((()=>this.close(!0)),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,r),this.hotMenu.addHook("afterInit",(()=>this.onAfterInit())),this.hotMenu.init(),uk(this,wk,Zx(this.hotMenu)),uk(this,vk,nk(this)),gk(this,vk).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",(()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this))),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(t&&this.isSubMenu())this.parentMenu.close();else if(gk(this,wk).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const e=this.parentMenu.hotMenu.getCell(t[0],0);fe(e,[Ft(!1)])}}this.parentMenu.hotMenu.listen()}}openSubMenu(t){if(!this.hotMenu)return!1;const e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!$x(e))return!1;const o=this.hotMenu.getSourceDataAtRow(t),n=new Ck(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return n.setMenuItems(o.submenu.items),n.open(),n.setPosition(e.getBoundingClientRect()),this.hotSubMenus[o.key]=n,this.hot.getSettings().ariaTags&&fe(e,[Ft(!0)]),n}closeSubMenu(t){const e=this.hotMenu.getSourceDataAtRow(t),o=this.hotSubMenus[e.key];if(o){o.destroy(),delete this.hotSubMenus[e.key];const n=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&fe(n,[Ft(!1)])}}closeAllSubMenus(){A(this.hotMenu.getData(),((t,e)=>this.closeSubMenu(e)))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;const e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),this.isCommandPassive(e))return;const o=this.hot.getSelectedRange(),n=o?Vx(o):[];this.runLocalHooks("executeCommand",e.key,n,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,n,t)}isCommandPassive(t){return!1===t.isCommand||jx(t)||Bx(t,this.hot)||Fx(t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(t,e)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.options.container.ownerDocument;let o,n=t;return n&&(so(n)&&(n=n.call(this.hot),n=null===n||$(n)?"":n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,o=e.querySelector(`.${this.options.className}.${n}`)),o||(o=e.createElement("div"),de(o,`htMenu ${this.options.className}`),n&&de(o,n),this.options.container.appendChild(o)),o}onAfterInit(){const{wtTable:t}=this.hotMenu.view._wt,e=this.hotMenu.getSettings().data,o=t.hider.style,n=t.holder.style,i=parseInt(o.width,10),r=x(e,((t,e)=>t+(e.name===AM?1:26)),0);n.width=`${i+3}px`,n.height=`${r+3}px`,o.height=n.height,this.hot.getSettings().ariaTags&&fe(this.hotMenu.rootElement,[bt(),ft(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!se(t.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||se(t.target,".htMenu")||this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&ue(t.target,"htCore")&&se(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}function yk(t,e){bk(t,e),e.add(t)}function bk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sk(t,e,o){return e=Rk(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Rk(t){var e=Ek(t,"string");return"symbol"===typeof e?e:String(e)}function Ek(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Tk(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}So(Ck,tu);const Mk="contextMenu",Hk=70,xk=Mk;bn.getSingleton().register("afterContextMenuDefaultOptions"),bn.getSingleton().register("beforeContextMenuShow"),bn.getSingleton().register("afterContextMenuShow"),bn.getSingleton().register("afterContextMenuHide"),bn.getSingleton().register("afterContextMenuExecute");var kk=new WeakSet,Ik=new WeakSet,Ak=new WeakSet,Ok=new WeakSet;class Pk extends fS{constructor(){super(...arguments),yk(this,Ok),yk(this,Ak),yk(this,Ik),yk(this,kk),Sk(this,"commandExecutor",new jH(this.hot)),Sk(this,"itemsFactory",null),Sk(this,"menu",null)}static get PLUGIN_KEY(){return Mk}static get PLUGIN_PRIORITY(){return Hk}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[rx,lx,AM,YH,XH,AM,nx,ex,AM,ux,ZH,AM,QH,AM,zH]}isEnabled(){return!!this.hot.getSettings()[Mk]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[Mk];"function"===typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new Ck(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(()=>Tk(this,Ik,_k).call(this))),this.menu.addLocalHook("afterOpen",(()=>Tk(this,Ak,Lk).call(this))),this.menu.addLocalHook("afterClose",(()=>Tk(this,Ok,Dk).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.executeCommand.call(t,...o)})),this.addHook("afterOnCellContextMenu",(t=>Tk(this,kk,Nk).call(this,t))),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","\\"],["Shift","F10"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const e=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),o=BM(this.menu.container,this.hot.rootDocument);this.open({left:e.left+o.left,top:e.top+o.top-1+e.height},{left:e.width,above:-e.height})},runOnlyIf:()=>this.hot.getSelectedRangeLast()&&!this.menu.isOpened(),group:xk})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xk)}open(t){var e;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.prepareMenuItems(),this.menu.open(),Mo(o,((t,e)=>{this.menu.setOffset(e,t)})),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close(),this.itemsFactory=null}executeCommand(t){null===this.itemsFactory&&this.prepareMenuItems();for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];this.commandExecutor.execute(t,...o)}prepareMenuItems(){this.itemsFactory=new Cx(this.hot,Pk.DEFAULT_ITEMS);const t=this.hot.getSettings()[Mk],e={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",e),this.itemsFactory.setPredefinedItems(e.items);const o=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),A(o,(t=>this.commandExecutor.registerCommand(t.key,t)))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Nk(t){const e=this.hot.getSettings(),o=e.rowHeaders,n=e.colHeaders;function i(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}const r=t.target;if(this.close(),ue(r,"handsontableInput"))return;if(t.preventDefault(),t.stopPropagation(),!o&&!n&&!i(r)&&(!ue(r,"current")||!ue(r,"wtBorder")))return;const s=BM(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function _k(){this.hot.runHooks("beforeContextMenuShow",this)}function Lk(){this.hot.runHooks("afterContextMenuShow",this)}function Dk(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}function Wk(t){return{key:"copy",name(){return this.getTranslatedPhrase(Td)},callback(){t.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function Vk(t){return{key:"copy_column_headers_only",name(){const t=this.getSelectedRangeLast(),e=t?Li(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(xd,e)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function Fk(t){return{key:"copy_with_column_group_headers",name(){const t=this.getSelectedRangeLast(),e=t?Li(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Hd,e)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function jk(t){return{key:"copy_with_column_headers",name(){const t=this.getSelectedRangeLast(),e=t?Li(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Md,e)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function Bk(t){return{key:"cut",name(){return this.getTranslatedPhrase(kd)},callback(){t.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}Pk.SEPARATOR={name:AM};class zk{constructor(){this.data={}}setData(t,e){this.data[t]=e}getData(t){return this.data[t]||void 0}}class Uk{constructor(){this.clipboardData=new zk}}function $k(t,e){Yk(t,e),e.add(t)}function Gk(t,e,o){Yk(t,e),e.set(t,o)}function Yk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kk(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function Xk(t,e){var o=Jk(t,e,"get");return qk(t,o)}function qk(t,e){return e.get?e.get.call(t):e.value}function Qk(t,e,o){var n=Jk(t,e,"set");return Zk(t,n,o),o}function Jk(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Zk(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var tI=new WeakMap,eI=new WeakMap,oI=new WeakMap,nI=new WeakMap,iI=new WeakMap,rI=new WeakMap,sI=new WeakSet,lI=new WeakSet;class aI{constructor(t){let{countRows:e,countColumns:o,rowsLimit:n,columnsLimit:i,countColumnHeaders:r}=t;$k(this,lI),$k(this,sI),Gk(this,tI,{writable:!0,value:void 0}),Gk(this,eI,{writable:!0,value:void 0}),Gk(this,oI,{writable:!0,value:void 0}),Gk(this,nI,{writable:!0,value:void 0}),Gk(this,iI,{writable:!0,value:void 0}),Gk(this,rI,{writable:!0,value:void 0}),Qk(this,eI,e),Qk(this,oI,o),Qk(this,nI,n),Qk(this,iI,i),Qk(this,rI,r)}setSelectedRange(t){Qk(this,tI,t)}getCellsRange(){if(0===Xk(this,eI).call(this)||0===Xk(this,oI).call(this))return null;const{row:t,col:e}=Xk(this,tI).getTopStartCorner(),{row:o,col:n}=Xk(this,tI).getBottomEndCorner(),i=Kk(this,lI,cI).call(this,t,o),r=Kk(this,sI,hI).call(this,e,n),s=o!==i||n!==r;return{isRangeTrimmed:s,startRow:t,startCol:e,endRow:i,endCol:r}}getMostBottomColumnHeadersRange(){if(0===Xk(this,oI).call(this)||0===Xk(this,rI).call(this))return null;const{col:t}=Xk(this,tI).getTopStartCorner(),{col:e}=Xk(this,tI).getBottomEndCorner(),o=Kk(this,sI,hI).call(this,t,e),n=e!==o;return{isRangeTrimmed:n,startRow:-1,startCol:t,endRow:-1,endCol:o}}getAllColumnHeadersRange(){if(0===Xk(this,oI).call(this)||0===Xk(this,rI).call(this))return null;const{col:t}=Xk(this,tI).getTopStartCorner(),{col:e}=Xk(this,tI).getBottomEndCorner(),o=Kk(this,sI,hI).call(this,t,e),n=e!==o;return{isRangeTrimmed:n,startRow:-Xk(this,rI).call(this),startCol:t,endRow:-1,endCol:o}}}function hI(t,e){return Math.min(e,Math.max(t+Xk(this,iI).call(this)-1,t))}function cI(t,e){return Math.min(e,Math.max(t+Xk(this,nI).call(this)-1,t))}function uI(t){const e=[],o=[];return A(t,(t=>{const n=Math.min(t.startRow,t.endRow),i=Math.max(t.startRow,t.endRow);Pi(n,i,(t=>{-1===e.indexOf(t)&&e.push(t)}));const r=Math.min(t.startCol,t.endCol),s=Math.max(t.startCol,t.endCol);Pi(r,s,(t=>{-1===o.indexOf(t)&&o.push(t)}))})),{rows:e,columns:o}}function dI(t,e){fI(t,e),e.add(t)}function gI(t,e,o){fI(t,e),e.set(t,o)}function fI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mI(t,e,o){return e=pI(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function pI(t){var e=wI(t,"string");return"symbol"===typeof e?e:String(e)}function wI(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function vI(t,e){var o=SI(t,e,"get");return CI(t,o)}function CI(t,e){return e.get?e.get.call(t):e.value}function yI(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function bI(t,e,o){var n=SI(t,e,"set");return RI(t,n,o),o}function SI(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function RI(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}bn.getSingleton().register("afterCopyLimit"),bn.getSingleton().register("modifyCopyableRange"),bn.getSingleton().register("beforeCut"),bn.getSingleton().register("afterCut"),bn.getSingleton().register("beforePaste"),bn.getSingleton().register("afterPaste"),bn.getSingleton().register("beforeCopy"),bn.getSingleton().register("afterCopy");const EI="copyPaste",TI=80,MI=["fragmentSelection"],HI=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var xI=new WeakMap,kI=new WeakMap,II=new WeakMap,AI=new WeakMap,OI=new WeakMap,PI=new WeakMap,NI=new WeakMap,_I=new WeakSet,LI=new WeakSet,DI=new WeakSet,WI=new WeakSet,VI=new WeakSet,FI=new WeakSet,jI=new WeakSet,BI=new WeakSet,zI=new WeakSet;class UI extends fS{constructor(){super(...arguments),dI(this,zI),dI(this,BI),dI(this,jI),dI(this,FI),dI(this,VI),dI(this,WI),dI(this,DI),dI(this,LI),dI(this,_I),mI(this,"columnsLimit",1/0),mI(this,"rowsLimit",1/0),mI(this,"pasteMode","overwrite"),mI(this,"uiContainer",this.hot.rootDocument.body),gI(this,xI,{writable:!0,value:!1}),gI(this,kI,{writable:!0,value:!1}),gI(this,II,{writable:!0,value:!1}),gI(this,AI,{writable:!0,value:"cells-only"}),gI(this,OI,{writable:!0,value:!1}),gI(this,PI,{writable:!0,value:!1}),gI(this,NI,{writable:!0,value:new aI({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),mI(this,"copyableRanges",[])}static get PLUGIN_KEY(){return EI}static get SETTING_KEYS(){return[EI,...MI]}static get PLUGIN_PRIORITY(){return TI}isEnabled(){return!!this.hot.getSettings()[EI]}enablePlugin(){var t=this;if(this.enabled)return;const{[EI]:e}=this.hot.getSettings();var o,n;"object"===typeof e&&(this.pasteMode=null!==(o=e.pasteMode)&&void 0!==o?o:this.pasteMode,this.rowsLimit=isNaN(e.rowsLimit)?this.rowsLimit:e.rowsLimit,this.columnsLimit=isNaN(e.columnsLimit)?this.columnsLimit:e.columnsLimit,bI(this,xI,!!e.copyColumnHeaders),bI(this,kI,!!e.copyColumnGroupHeaders),bI(this,II,!!e.copyColumnHeadersOnly),this.uiContainer=null!==(n=e.uiContainer)&&void 0!==n?n:this.uiContainer);this.addHook("afterContextMenuDefaultOptions",(t=>yI(this,VI,XI).call(this,t))),this.addHook("afterSelectionEnd",(()=>yI(this,FI,qI).call(this))),this.eventManager.addEventListener(this.hot.rootDocument,"copy",(function(){return t.onCopy(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"cut",(function(){return t.onCut(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"paste",(function(){return t.onPaste(...arguments)})),jo()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return yI(t,jI,QI).call(t,...o)})),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return yI(t,BI,JI).call(t,...o)})),this.addHook("afterSelection",(()=>yI(this,zI,ZI).call(this)))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";bI(this,AI,t),bI(this,OI,!0),yI(this,_I,$I).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){bI(this,PI,!0),yI(this,_I,$I).call(this,"cut")}getRangedCopyableData(t){return qp(this.getRangedData(t))}getRangedData(t){const e=[],{rows:o,columns:n}=uI(t);return A(o,(t=>{const o=[];A(n,(e=>{t<0?o.push(this.hot.getColHeader(e,t)):o.push(this.hot.getCopyableData(t,e))})),e.push(o)})),e}paste(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t&&!e)return;const o=new Uk;t&&o.clipboardData.setData("text/plain",t),e&&o.clipboardData.setData("text/html",e),this.onPaste(o)}setCopyableText(){const t=this.hot.getSelectedRangeLast();if(!t)return;if(t.isSingleHeader())return void(this.copyableRanges=[]);vI(this,NI).setSelectedRange(t);const e=new Map([["headers",null],["cells",null]]);"column-headers-only"===vI(this,AI)?e.set("headers",vI(this,NI).getMostBottomColumnHeadersRange()):("with-column-headers"===vI(this,AI)?e.set("headers",vI(this,NI).getMostBottomColumnHeadersRange()):"with-column-group-headers"===vI(this,AI)&&e.set("headers",vI(this,NI).getAllColumnHeadersRange()),e.set("cells",vI(this,NI).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter((t=>null!==t)).map((t=>{let{startRow:e,startCol:o,endRow:n,endCol:i}=t;return{startRow:e,startCol:o,endRow:n,endCol:i}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const o=e.get("cells");if(null!==o&&o.isRangeTrimmed){const{startRow:t,startCol:e,endRow:n,endCol:i}=o;this.hot.runHooks("afterCopyLimit",n-t+1,i-e+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}populateValues(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!t.length)return;const o=t.length,n=t[0].length,i=[],{row:r,col:s}=e.getTopStartCorner(),{row:l,col:a}=e.getBottomEndCorner();let h=r,c=s,u=r,d=s;while(i.length<o||h<=l){const{skipRowOnPaste:e,visualRow:l}=this.hot.getCellMeta(h,s);if(h=l+1,!0===e)continue;u=l,c=s;const g=[],f=i.length%o;while(g.length<n||c<=a){const{skipColumnOnPaste:e,visualCol:o}=this.hot.getCellMeta(r,c);if(c=o+1,!0===e)continue;d=o;const i=g.length%n;g.push(t[f][i])}i.push(g)}return this.hot.populateFromArray(r,s,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[r,s,u,d]}onCopy(t){if(!this.hot.isListening()&&!vI(this,OI)||this.isEditorOpened())return;this.setCopyableText(),bI(this,OI,!1);const e=this.getRangedData(this.copyableRanges),o=yI(this,LI,GI).call(this,this.copyableRanges),n=!!this.hot.runHooks("beforeCopy",e,this.copyableRanges,o);if(n){const n=qp(e);if(t&&t.clipboardData){const o=ki(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[HI,o].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.runHooks("afterCopy",e,this.copyableRanges,o)}bI(this,AI,"cells-only"),t.preventDefault()}onCut(t){if(!this.hot.isListening()&&!vI(this,PI)||this.isEditorOpened())return;this.setCopyableText(),bI(this,PI,!1);const e=this.getRangedData(this.copyableRanges),o=!!this.hot.runHooks("beforeCut",e,this.copyableRanges);if(o){const o=qp(e);if(t&&t.clipboardData){const n=ki(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",o),t.clipboardData.setData("text/html",[HI,n].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",e,this.copyableRanges)}t.preventDefault()}onPaste(t){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;let e;if(t&&t.preventDefault&&t.preventDefault(),t&&"undefined"!==typeof t.clipboardData){const o=gt(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(o&&/(<table)|(<TABLE)/g.test(o)){const t=Ii(o,this.hot.rootDocument);e=t.data}else e=t.clipboardData.getData("text/plain")}else"undefined"===typeof ClipboardEvent&&"undefined"!==typeof this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"===typeof e&&(e=Xp(e)),void 0===e||e&&0===e.length)return;if(!1===this.hot.runHooks("beforePaste",e,this.copyableRanges))return;const[o,n,i,r]=this.populateValues(e);this.hot.selectCell(o,n,Math.min(this.hot.countRows()-1,i),Math.min(this.hot.countCols()-1,r)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}destroy(){super.destroy()}}function $I(t){if(jo()){const e=this.hot.getSelectedRangeLast();if(e){const{row:o,col:n}=e.highlight,i=this.hot.getCell(o,n,!0);i&&io(i,(()=>{this.hot.rootDocument.execCommand(t)}))}}else this.hot.rootDocument.execCommand(t)}function GI(t){const{rows:e}=uI(t);let o=0;for(let n=0;n<e.length;n++){if(e[n]>=0)break;o+=1}return{columnHeadersCount:o}}function YI(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:o}=t.highlight,n=this.hot.getCell(e,o,!0);n&&oo(n)}}}function KI(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:o}=t.highlight,n=this.hot.getCell(e,o,!0);null!==n&&void 0!==n&&n.hasAttribute("contenteditable")&&no(n)}}}function XI(t){t.items.push({name:"---------"},Wk(this)),vI(this,xI)&&t.items.push(jk(this)),vI(this,kI)&&t.items.push(Fk(this)),vI(this,II)&&t.items.push(Vk(this)),t.items.push(Bk(this))}function qI(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function QI(){yI(this,WI,KI).call(this)}function JI(){yI(this,DI,YI).call(this)}function ZI(){yI(this,WI,KI).call(this)}function tA(t,e){return`border_row${t}col${e}`}function eA(){return{width:1,color:"#000"}}function oA(){return{hide:!0}}function nA(){return{width:1,color:"#000",cornerVisible:!1}}function iA(t){var e,o;(U(t.start)||U(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left);(U(t.end)||U(t.right))&&(t.end=null!==(o=t.end)&&void 0!==o?o:t.right);return delete t.left,delete t.right,t}function rA(t){return U(t.start)&&(t.left=t.start),U(t.end)&&(t.right=t.end),t}function sA(t,e){return{id:tA(t,e),border:nA(),row:t,col:e,top:oA(),bottom:oA(),start:oA(),end:oA()}}function lA(t,e){return Ao(e,"border")&&e.border&&(t.border=e.border),Ao(e,"top")&&U(e.top)&&(e.top?(Eo(e.top)||(e.top=eA()),t.top=e.top):(e.top=oA(),t.top=e.top)),Ao(e,"bottom")&&U(e.bottom)&&(e.bottom?(Eo(e.bottom)||(e.bottom=eA()),t.bottom=e.bottom):(e.bottom=oA(),t.bottom=e.bottom)),Ao(e,"start")&&U(e.start)&&(e.start?(Eo(e.start)||(e.start=eA()),t.start=e.start):(e.start=oA(),t.start=e.start)),Ao(e,"end")&&U(e.end)&&(e.end?(Eo(e.end)||(e.end=eA()),t.end=e.end):(e.end=oA(),t.end=e.end)),t}function aA(t,e){let o=!1;return A(t.getSelectedRange(),(n=>{n.forAll(((n,i)=>{if(n<0||i<0)return;const r=t.getCellMeta(n,i).borders;if(r){if(!e)return o=!0,!1;if(!Ao(r[e],"hide")||!1===r[e].hide)return o=!0,!1}}))})),o}function hA(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function cA(t){return t.some((t=>U(t.left)||U(t.right)))}function uA(t){return t.some((t=>U(t.start)||U(t.end)))}const dA=new Map([["left","start"],["right","end"]]);function gA(t){var e;return null!==(e=dA.get(t))&&void 0!==e?e:t}function fA(t){return{key:"borders:top",name(){let t=this.getTranslatedPhrase(Yd);const e=aA(this,"top");return e&&(t=hA(t)),t},callback(e,o){const n=aA(this,"top");t.prepareBorder(o,"top",n)}}}function mA(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(Kd);const o=aA(this,e);return o&&(t=hA(t)),t},callback(o,n){const i=aA(this,e);t.prepareBorder(n,e,i)}}}function pA(t){return{key:"borders:bottom",name(){let t=this.getTranslatedPhrase(Xd);const e=aA(this,"bottom");return e&&(t=hA(t)),t},callback(e,o){const n=aA(this,"bottom");t.prepareBorder(o,"bottom",n)}}}function wA(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(qd);const o=aA(this,e);return o&&(t=hA(t)),t},callback(o,n){const i=aA(this,e);t.prepareBorder(n,e,i)}}}function vA(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Qd)},callback(e,o){t.prepareBorder(o,"noBorders")},disabled(){return!aA(this)}}}function CA(t,e){yA(t,e),e.add(t)}function yA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bA(t,e,o){return e=SA(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function SA(t){var e=RA(t,"string");return"symbol"===typeof e?e:String(e)}function RA(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function EA(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const TA="customBorders",MA=90;var HA=new WeakSet,xA=new WeakSet;class kA extends fS{constructor(){super(...arguments),CA(this,xA),CA(this,HA),bA(this,"savedBorders",[])}static get PLUGIN_KEY(){return TA}static get PLUGIN_PRIORITY(){return MA}isEnabled(){return!!this.hot.getSettings()[TA]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>EA(this,HA,IA).call(this,t))),this.addHook("init",(()=>EA(this,xA,AA).call(this))),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(t,e){let o=["top","bottom","start","end"],n=null;e&&(this.checkSettingsCohesion([e]),o=Object.keys(e),n=iA(e));const i=Dm(t),r=Wm(i);A(t,(t=>{r(t).forAll(((t,e)=>{A(o,(o=>{this.prepareBorderFromCustomAdded(t,e,n,gA(o))}))}))})),this.hot.view.render()}getBorders(t){if(!Array.isArray(t))return this.savedBorders;const e=Dm(t),o=Wm(e),n=[];return A(t,(t=>{o(t).forAll(((t,e)=>{A(this.savedBorders,(o=>{o.row===t&&o.col===e&&n.push(rA(o))}))}))})),n}clearBorders(t){t?this.setBorders(t):(A(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")})),this.savedBorders.length=0)}insertBorderIntoSettings(t,e){const o=this.checkSavedBorders(t);o||this.savedBorders.push(t);const n=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col)),i=this.checkCustomSelections(t,n,e);i||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:n})}prepareBorderFromCustomAdded(t,e,o,n){const i=this.hot.countRows(),r=this.hot.countCols();if(t>=i||e>=r)return;let s=sA(t,e);o&&(s=lA(s,o),A(this.hot.selection.highlight.customSelections,(t=>{if(s.id===t.settings.id)return Object.assign(t.settings,o),s.id=t.settings.id,s.top=t.settings.top,s.bottom=t.settings.bottom,s.start=t.settings.start,s.end=t.settings.end,!1}))),this.hot.setCellMeta(t,e,"borders",rA(s)),this.insertBorderIntoSettings(s,n)}prepareBorderFromCustomAddedRange(t,e){const o=Math.min(t.to.row,this.hot.countRows()-1),n=Math.min(t.to.col,this.hot.countCols()-1);Pi(t.from.row,o,(o=>{Pi(t.from.col,n,(n=>{const i=sA(o,n);let r=0;o===t.from.row&&Ao(e,"top")&&(r+=1,i.top=e.top),o===t.to.row&&Ao(e,"bottom")&&(r+=1,i.bottom=e.bottom),n===t.from.col&&Ao(e,"start")&&(r+=1,i.start=e.start),n===t.to.col&&Ao(e,"end")&&(r+=1,i.end=e.end),r>0&&(this.hot.setCellMeta(o,n,"borders",rA(i)),this.insertBorderIntoSettings(i))}))}))}removeAllBorders(t,e){const o=tA(t,e);this.spliceBorder(o),this.clearBordersFromSelectionSettings(o),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}setBorder(t,e,o,n){let i=this.hot.getCellMeta(t,e).borders;if(i=i&&void 0!==i.border?iA(i):sA(t,e),n){i[o]=oA();const r=this.countHide(i);if(4===r)this.removeAllBorders(t,e);else{const r=this.checkCustomSelectionsFromContextMenu(i,o,n);r||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",rA(i))}}else{i[o]=eA();const r=this.checkCustomSelectionsFromContextMenu(i,o,n);r||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",rA(i))}}prepareBorder(t,e,o){A(t,(t=>{let{start:n,end:i}=t;if(n.row===i.row&&n.col===i.col)"noBorders"===e?this.removeAllBorders(n.row,n.col):this.setBorder(n.row,n.col,e,o);else switch(e){case"noBorders":Pi(n.col,i.col,(t=>{Pi(n.row,i.row,(e=>{this.removeAllBorders(e,t)}))}));break;case"top":Pi(n.col,i.col,(t=>{this.setBorder(n.row,t,e,o)}));break;case"bottom":Pi(n.col,i.col,(t=>{this.setBorder(i.row,t,e,o)}));break;case"start":Pi(n.row,i.row,(t=>{this.setBorder(t,n.col,e,o)}));break;case"end":Pi(n.row,i.row,(t=>{this.setBorder(t,i.col,e,o)}));break;default:break}}))}createCustomBorders(t){A(t,(t=>{const e=iA(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,e):this.prepareBorderFromCustomAdded(t.row,t.col,e)}))}countHide(t){const{top:e,bottom:o,start:n,end:i}=t,r=[e,o,n,i];return x(r,((t,e)=>{let o=t;return e&&e.hide&&(o+=1),o}),0)}clearBordersFromSelectionSettings(t){const e=I(this.hot.selection.highlight.customSelections,(t=>t.settings.id)).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}clearNullCellRange(){A(this.hot.selection.highlight.customSelections,((t,e)=>{if(null===t.cellRange)return this.hot.selection.highlight.customSelections[e].destroy(),this.hot.selection.highlight.customSelections.splice(e,1),!1}))}hideBorders(){A(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange()}))}spliceBorder(t){const e=I(this.savedBorders,(t=>t.id)).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}checkSavedBorders(t){let e=!1;const o=this.countHide(t);return 4===o?(this.spliceBorder(t.id),e=!0):A(this.savedBorders,((o,n)=>{if(t.id===o.id)return this.savedBorders[n]=t,e=!0,!1})),e}checkCustomSelectionsFromContextMenu(t,e,o){let n=!1;return A(this.hot.selection.highlight.customSelections,(i=>{if(t.id===i.settings.id){const t=this.hot.view._wt.selectionManager.getBorderInstances(i);return A(t,(t=>{t.toggleHiddenClass(e,o)})),n=!0,!1}})),n}checkCustomSelections(t,e,o){const n=this.countHide(t);let i=!1;return 4===n?(this.removeAllBorders(t.row,t.col),i=!0):A(this.hot.selection.highlight.customSelections,(n=>{if(t.id===n.settings.id){if(n.visualCellRange=e,n.commit(),o){const e=this.hot.view._wt.selectionManager.getBorderInstances(n);A(e,(e=>{e.changeBorderStyle(o,t)}))}return i=!0,!1}})),i}changeBorderSettings(){const t=this.hot.getSettings()[TA];if(Array.isArray(t)){const e=yo(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(t){const e=cA(t),o=uA(t);if(e&&o)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function IA(t){this.hot.getSettings()[TA]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Gd)},disabled(){const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||this.selection.isSelectedByCorner())},submenu:{items:[fA(this),mA(this),pA(this),wA(this),vA(this)]}})}function AA(){this.changeBorderSettings()}function OA(t,e){PA(t,e),e.add(t)}function PA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NA(t,e,o){return e=_A(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function _A(t){var e=LA(t,"string");return"symbol"===typeof e?e:String(e)}function LA(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function DA(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const WA="dragToScroll",VA=100;var FA=new WeakSet;class jA extends fS{constructor(){super(...arguments),OA(this,FA),NA(this,"boundaries",null),NA(this,"callback",null),NA(this,"listening",!1)}static get PLUGIN_KEY(){return WA}static get PLUGIN_PRIORITY(){return VA}isEnabled(){return!!this.hot.getSettings()[WA]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",(t=>DA(this,FA,BA).call(this,t))),this.addHook("afterOnCellCornerMouseDown",(t=>DA(this,FA,BA).call(this,t))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(t){this.boundaries=t}setCallback(t){this.callback=t}check(t,e){let o=0,n=0;e<this.boundaries.top?n=e-this.boundaries.top:e>this.boundaries.bottom&&(n=e-this.boundaries.bottom),t<this.boundaries.left?o=t-this.boundaries.left:t>this.boundaries.right&&(o=t-this.boundaries.right),this.callback(o,n)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:t}=this.hot;let e=t;while(e)this.eventManager.addEventListener(e.document,"contextmenu",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mouseup",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mousemove",(t=>this.onMouseMove(t))),e=oe(e)}unregisterEvents(){this.eventManager.clear()}onMouseMove(t){this.isListening()&&this.check(t.clientX,t.clientY)}destroy(){super.destroy()}}function BA(t){if(sn(t))return;const e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback(((t,o)=>{t<0?e.scrollLeft-=50:t>0&&(e.scrollLeft+=50),o<0?e.scrollTop-=20:o>0&&(e.scrollTop+=20)})),this.listen())}function zA(t,e){UA(t,e),e.add(t)}function UA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $A(t,e,o){return e=GA(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function GA(t){var e=YA(t,"string");return"symbol"===typeof e?e:String(e)}function YA(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function KA(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}bn.getSingleton().register("afterDropdownMenuDefaultOptions"),bn.getSingleton().register("beforeDropdownMenuShow"),bn.getSingleton().register("afterDropdownMenuShow"),bn.getSingleton().register("afterDropdownMenuHide"),bn.getSingleton().register("afterDropdownMenuExecute");const XA="dropdownMenu",qA=230,QA="changeType",JA=XA;var ZA=new WeakSet,tO=new WeakSet,eO=new WeakSet,oO=new WeakSet,nO=new WeakSet,iO=new WeakSet,rO=new WeakSet;class sO extends fS{static get PLUGIN_KEY(){return XA}static get PLUGIN_PRIORITY(){return qA}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[YH,XH,AM,ex,AM,$H,AM,QH,AM,zH]}constructor(t){super(t),zA(this,rO),zA(this,iO),zA(this,nO),zA(this,oO),zA(this,eO),zA(this,tO),zA(this,ZA),$A(this,"commandExecutor",new jH(this.hot)),$A(this,"itemsFactory",null),$A(this,"menu",null),this.hot.addHook("afterGetColHeader",((t,e)=>KA(this,eO,hO).call(this,t,e)))}isEnabled(){return this.hot.getSettings()[XA]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new Cx(this.hot,sO.DEFAULT_ITEMS);const e=this.hot.getSettings()[XA],o={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"===typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady((()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",o),this.itemsFactory.setPredefinedItems(o.items);const n=this.itemsFactory.getItems(e);this.menu&&this.menu.destroy(),this.menu=new Ck(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",n),this.menu.setMenuItems(n),this.menu.addLocalHook("beforeOpen",(()=>KA(this,oO,cO).call(this))),this.menu.addLocalHook("afterOpen",(()=>KA(this,nO,uO).call(this))),this.menu.addLocalHook("afterSubmenuOpen",(t=>KA(this,iO,dO).call(this,t))),this.menu.addLocalHook("afterClose",(()=>KA(this,rO,gO).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.executeCommand.call(t,...o)})),A(n,(t=>this.commandExecutor.registerCommand(t.key,t)))}))}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("grid"),e=()=>{const{highlight:t}=this.hot.getSelectedRangeLast();if((t.isHeader()&&-1===t.row||t.isCell())&&t.col>=0){this.hot.selectColumns(t.col,t.col,-1);const{from:e}=this.hot.getSelectedRangeLast(),o=BM(this.menu.container,this.hot.rootDocument),n=this.hot.getCell(-1,e.col,!0),i=n.getBoundingClientRect();this.open({left:i.left+o.left,top:i.top+n.offsetHeight+o.top},{left:i.width})}};t.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader())&&!this.menu.isOpened()},captureCtrl:!0,group:JA},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&!this.menu.isOpened()},group:JA}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(JA)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",(t=>KA(this,tO,aO).call(this,t)))}open(t){var e;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.menu.open(),Mo(o,((t,e)=>{this.menu.setOffset(e,t)})),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close()}executeCommand(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];this.commandExecutor.execute(t,...o)}setListening(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function lO(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function aO(t){if(t.stopPropagation(),ue(t.target,QA)){const e=BM(this.menu.container,this.hot.rootDocument),o=t.target.getBoundingClientRect();this.open({left:o.left+e.left,top:o.top+t.target.offsetHeight+3+e.top},{left:o.width})}}function hO(t,e){const o=e.parentNode;if(!o)return;const n=o.parentNode.childNodes,i=Array.prototype.indexOf.call(n,o);if(t<0||i!==n.length-1)return;const r=e.querySelector(`.${QA}`);if(this.enabled&&r)return;if(!this.enabled)return void(r&&r.parentNode.removeChild(r));const s=this.hot.rootDocument.createElement("button");s.className=QA,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(fe(s,[It(this.hot.getTranslatedPhrase(Yg))]),fe(e,[_t("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function cO(){this.hot.runHooks("beforeDropdownMenuShow",this)}function uO(){this.hot.runHooks("afterDropdownMenuShow",this),KA(this,ZA,lO).call(this,this.menu)}function dO(t){KA(this,ZA,lO).call(this,t)}function gO(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function fO(t,e,o){return e=mO(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function mO(t){var e=pO(t,"string");return"symbol"===typeof e?e:String(e)}function pO(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}sO.SEPARATOR={name:AM};class wO{constructor(t){fO(this,"hot",void 0),fO(this,"options",{}),this.hot=t}setOptions(t){this.options=t}getData(){const{startRow:t,startCol:e,endRow:o,endCol:n}=this._getDataRange(),i=this.options,r=[];return Pi(t,o,(t=>{const o=[];!i.exportHiddenRows&&this._isHiddenRow(t)||(Pi(e,n,(e=>{!i.exportHiddenColumns&&this._isHiddenColumn(e)||o.push(this.hot.getDataAtCell(t,e))})),r.push(o))})),r}getRowHeaders(){const t=[];if(this.options.rowHeaders){const{startRow:e,endRow:o}=this._getDataRange(),n=this.hot.getRowHeader();Pi(e,o,(e=>{!this.options.exportHiddenRows&&this._isHiddenRow(e)||t.push(n[e])}))}return t}getColumnHeaders(){const t=[];if(this.options.columnHeaders){const{startCol:e,endCol:o}=this._getDataRange(),n=this.hot.getColHeader();Pi(e,o,(e=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(e)||t.push(n[e])}))}return t}_getDataRange(){const t=this.hot.countCols()-1,e=this.hot.countRows()-1;let[o=0,n=0,i=e,r=t]=this.options.range;return o=Math.max(o,0),n=Math.max(n,0),i=Math.min(i,e),r=Math.min(r,t),{startRow:o,startCol:n,endRow:i,endCol:r}}_isHiddenRow(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}_isHiddenColumn(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}}var vO=wO;function CO(t,e,o){return e=yO(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function yO(t){var e=bO(t,"string");return"symbol"===typeof e?e:String(e)}function bO(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class SO{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(t,e){CO(this,"dataProvider",void 0),CO(this,"options",void 0),this.dataProvider=t,this.options=this._mergeOptions(e),this.dataProvider.setOptions(this.options)}_mergeOptions(t){let e=bo(this.constructor.DEFAULT_OPTIONS);const o=new Date;return e=vo(bo(SO.DEFAULT_OPTIONS),e),e=vo(e,t),e.filename=ut(e.filename,{YYYY:o.getFullYear(),MM:`${o.getMonth()+1}`.padStart(2,"0"),DD:`${o.getDate()}`.padStart(2,"0")}),e}}var RO=SO;const EO=String.fromCharCode(13),TO=String.fromCharCode(34),MO=String.fromCharCode(10);class HO extends RO{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const t=this.options,e=this.dataProvider.getData();let o=this.dataProvider.getColumnHeaders();const n=o.length>0,i=this.dataProvider.getRowHeaders(),r=i.length>0;let s=t.bom?String.fromCharCode(65279):"";return n&&(o=I(o,(t=>this._escapeCell(t,!0))),r&&(s+=t.columnDelimiter),s+=o.join(t.columnDelimiter),s+=t.rowDelimiter),A(e,((e,o)=>{o>0&&(s+=t.rowDelimiter),r&&(s+=this._escapeCell(i[o])+t.columnDelimiter),s+=e.map((t=>this._escapeCell(t))).join(t.columnDelimiter)})),s}_escapeCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=z(t);return""!==o&&(e||o.indexOf(EO)>=0||o.indexOf(TO)>=0||o.indexOf(MO)>=0||o.indexOf(this.options.columnDelimiter)>=0)&&(o=o.replace(new RegExp('"',"g"),'""'),o=`"${o}"`),o}}var xO=HO;const kO="csv",IO={[kO]:xO};function AO(t,e,o){return"function"===typeof IO[t]?new IO[t](e,o):null}const OO="exportFile",PO=240;class NO extends fS{static get PLUGIN_KEY(){return OO}static get PLUGIN_PRIORITY(){return PO}isEnabled(){return!0}exportAsString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}exportAsBlob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}downloadFile(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:o,rootWindow:n}=this.hot,i=this._createTypeFormatter(t,e),r=this._createBlob(i),s=n.URL||n.webkitURL,l=o.createElement("a"),a=`${i.options.filename}.${i.options.fileExtension}`;if(void 0!==l.download){const t=s.createObjectURL(r);l.style.display="none",l.setAttribute("href",t),l.setAttribute("download",a),o.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),o.body.removeChild(l),setTimeout((()=>{s.revokeObjectURL(t)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(r,a)}_createTypeFormatter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!IO[t])throw new Error(`Export format type "${t}" is not supported.`);return AO(t,new vO(this.hot),e)}_createBlob(t){let e=null;return"undefined"!==typeof Blob&&(e=new Blob([t.export()],{type:`${t.options.mimeType};charset=${t.options.encoding}`})),e}}function _O(t,e,o){return e=LO(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function LO(t){var e=DO(t,"string");return"symbol"===typeof e?e:String(e)}function DO(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class WO{constructor(t,e){let{id:o,stateless:n=!0}=e;_O(this,"hot",void 0),_O(this,"id",void 0),_O(this,"elements",[]),_O(this,"hidden",!1),_O(this,"stateId",""),_O(this,"state",void 0),this.hot=t,this.id=o,this.stateId=`Filters.component.${this.id}`,this.state=n?null:this.hot.columnIndexMapper.registerMap(this.stateId,new wu)}getElements(){return this.elements}reset(){A(this.elements,(t=>t.reset()))}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(t){this.state&&this.setState(this.state.getValueAtIndex(t))}setState(){throw new Error("The state setting logic is not implemented")}saveState(t){this.state&&this.state.setValueAtIndex(t,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),A(this.elements,(t=>t.destroy())),this.state=null,this.elements=null,this.hot=null}}So(WO,tu);const VO={};function FO(t,e){if(!VO[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:o,descriptor:n}=VO[t];let i=e;return n.inputValuesDecorator&&(i=n.inputValuesDecorator(i)),function(t){return o.apply(t.meta.instance,[].concat([t],[i]))}}function jO(t){if(!VO[t])throw Error(`Filter condition "${t}" does not exist.`);return VO[t].descriptor}function BO(t,e,o){o.key=t,VO[t]={condition:e,descriptor:o}}const zO="none";function UO(){return!0}BO(zO,UO,{name:sg,inputsCount:0,showOperators:!1});const $O="empty";function GO(t){return G(t.value)}BO($O,GO,{name:lg,inputsCount:0,showOperators:!0});const YO="not_empty";function KO(t,e){return!FO($O,e)(t)}BO(YO,KO,{name:ag,inputsCount:0,showOperators:!0});const XO="eq";function qO(t,e){let[o]=e;return z(t.value).toLocaleLowerCase(t.meta.locale)===z(o)}BO(XO,qO,{name:hg,inputsCount:1,showOperators:!0});const QO="neq";function JO(t,e){return!FO(XO,e)(t)}BO(QO,JO,{name:cg,inputsCount:1,showOperators:!0});const ZO="gt";function tP(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>n}BO(ZO,tP,{name:pg,inputsCount:1,showOperators:!0});const eP="gte";function oP(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>=n}BO(eP,oP,{name:wg,inputsCount:1,showOperators:!0});const nP="lt";function iP(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<n}BO(nP,iP,{name:vg,inputsCount:1,showOperators:!0});const rP="lte";function sP(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<=n}BO(rP,sP,{name:Cg,inputsCount:1,showOperators:!0});const lP="date_after";function aP(t,e){let[o]=e;const n=E(t.value,t.meta.dateFormat),i=E(o,t.meta.dateFormat);return!(!n.isValid()||!i.isValid())&&n.diff(i)>=0}BO(lP,aP,{name:Sg,inputsCount:1,showOperators:!0});const hP="date_before";function cP(t,e){let[o]=e;const n=E(t.value,t.meta.dateFormat),i=E(o,t.meta.dateFormat);return!(!n.isValid()||!i.isValid())&&n.diff(i)<=0}BO(hP,cP,{name:Rg,inputsCount:1,showOperators:!0});const uP="between";function dP(t,e){let[o,n]=e,i=o,r=n;if("numeric"===t.meta.type){const t=parseFloat(i,10),e=parseFloat(r,10);i=Math.min(t,e),r=Math.max(t,e)}else if("date"===t.meta.type){const e=FO(hP,[r]),o=FO(lP,[i]);return e(t)&&o(t)}return t.value>=i&&t.value<=r}BO(uP,dP,{name:yg,inputsCount:2,showOperators:!0});const gP="not_between";function fP(t,e){return!FO(uP,e)(t)}BO(gP,fP,{name:bg,inputsCount:2,showOperators:!0});const mP="begins_with";function pP(t,e){let[o]=e;return z(t.value).toLocaleLowerCase(t.meta.locale).startsWith(z(o))}BO(mP,pP,{name:ug,inputsCount:1,showOperators:!0});const wP="ends_with";function vP(t,e){let[o]=e;return z(t.value).toLocaleLowerCase(t.meta.locale).endsWith(z(o))}BO(wP,vP,{name:dg,inputsCount:1,showOperators:!0});const CP="contains";function yP(t,e){let[o]=e;return z(t.value).toLocaleLowerCase(t.meta.locale).indexOf(z(o))>=0}BO(CP,yP,{name:gg,inputsCount:1,showOperators:!0});const bP="not_contains";function SP(t,e){return!FO(CP,e)(t)}BO(bP,SP,{name:fg,inputsCount:1,showOperators:!0});const RP="date_tomorrow";function EP(t){const e=E(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(E().subtract(-1,"days").startOf("day"),"d")}BO(RP,EP,{name:Tg,inputsCount:0});const TP="date_today";function MP(t){const e=E(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(E().startOf("day"),"d")}BO(TP,MP,{name:Eg,inputsCount:0});const HP="date_yesterday";function xP(t){const e=E(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(E().subtract(1,"days").startOf("day"),"d")}BO(HP,xP,{name:Mg,inputsCount:0});const kP="numeric",IP="text",AP="date",OP={[kP]:[zO,AM,$O,YO,AM,XO,QO,AM,ZO,eP,nP,rP,uP,gP],[IP]:[zO,AM,$O,YO,AM,XO,QO,AM,mP,wP,AM,CP,bP],[AP]:[zO,AM,$O,YO,AM,XO,QO,AM,hP,lP,uP,AM,RP,TP,HP]};function PP(t){const e=[];let o=t;return OP[o]||(o=IP),A(OP[o],(t=>{let o;o=t===AM?{name:AM}:bo(jO(t)),e.push(o)})),e}function NP(t,e,o){return e=_P(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function _P(t){var e=LP(t,"string");return"symbol"===typeof e?e:String(e)}function LP(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const DP="built",WP="building",VP=["click","input","keydown","keypress","keyup","focus","blur","change"];class FP{static get DEFAULTS(){return bo({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,e){NP(this,"hot",void 0),NP(this,"eventManager",new Fn(this)),NP(this,"options",void 0),NP(this,"_element",void 0),NP(this,"buildState",void 0),this.hot=t,this.options=vo(FP.DEFAULTS,e),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===WP?this._element:this.buildState===DP?(this.update(),this._element):(this.buildState=WP,this.build(),this.buildState=DP,this._element)}isBuilt(){return this.buildState===DP}translateIfPossible(t){return"string"===typeof t&&t.startsWith(ig)?this.hot.getTranslatedPhrase(t):t}build(){const t=(t,e)=>{this.eventManager.addEventListener(t,e,(t=>this.runLocalHooks(e,t,this)))};if(this.buildState||(this.buildState=WP),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&de(this._element,this.options.className),this.options.children.length)A(this.options.children,(t=>this._element.appendChild(t.element)));else if(this.options.wrapIt){const e=this.hot.rootDocument.createElement(this.options.tagName);e.setAttribute("data-hot-input",!0),Mo(this.options,((t,o)=>{void 0!==e[o]&&"className"!==o&&"tagName"!==o&&"children"!==o&&(e[o]=this.translateIfPossible(t))})),this._element.appendChild(e),A(VP,(o=>t(e,o)))}else A(VP,(e=>t(this._element,e)))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function jP(t,e){zP(t,e),e.add(t)}function BP(t,e,o){zP(t,e),e.set(t,o)}function zP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UP(t,e){var o=YP(t,e,"get");return $P(t,o)}function $P(t,e){return e.get?e.get.call(t):e.value}function GP(t,e,o){var n=YP(t,e,"set");return KP(t,n,o),o}function YP(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function KP(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function XP(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}So(FP,tu);var qP=new WeakMap,QP=new WeakSet;class JP extends FP{static get DEFAULTS(){return bo({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,e){super(t,vo(JP.DEFAULTS,e)),jP(this,QP),BP(this,qP,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",(t=>XP(this,QP,ZP).call(this,t)))}build(){super.build(),GP(this,qP,this._element.firstChild),de(this._element,"htUIInput"),this.update()}update(){this.isBuilt()&&(UP(this,qP).type=this.options.type,UP(this,qP).placeholder=this.translateIfPossible(this.options.placeholder),UP(this,qP).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&UP(this,qP).focus()}}function ZP(t){this.options.value=t.target.value}function tN(t,e){oN(t,e),e.add(t)}function eN(t,e,o){oN(t,e),e.set(t,o)}function oN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nN(t,e,o){var n=lN(t,e,"set");return iN(t,n,o),o}function iN(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function rN(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function sN(t,e){var o=lN(t,e,"get");return aN(t,o)}function lN(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function aN(t,e){return e.get?e.get.call(t):e.value}var hN=new WeakMap,cN=new WeakMap,uN=new WeakMap,dN=new WeakMap,gN=new WeakMap,fN=new WeakSet,mN=new WeakSet,pN=new WeakSet;class wN extends FP{static get DEFAULTS(){return bo({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,e){super(t,vo(wN.DEFAULTS,e)),tN(this,pN),tN(this,mN),tN(this,fN),eN(this,hN,{writable:!0,value:null}),eN(this,cN,{writable:!0,value:[]}),eN(this,uN,{writable:!0,value:void 0}),eN(this,dN,{writable:!0,value:void 0}),eN(this,gN,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return sN(this,hN)}registerHooks(){this.addLocalHook("click",(()=>rN(this,pN,yN).call(this)))}setItems(t){nN(this,cN,this.translateNames(t)),sN(this,hN)&&sN(this,hN).setMenuItems(sN(this,cN))}translateNames(t){return A(t,(t=>{t.name=this.translateIfPossible(t.name)})),t}build(){super.build(),nN(this,hN,new Ck(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),sN(this,hN).setMenuItems(sN(this,cN));const t=new FP(this.hot,{className:"htUISelectCaption"}),e=new FP(this.hot,{className:"htUISelectDropdown"});nN(this,uN,t),nN(this,dN,t.element),nN(this,gN,e),this.hot.getSettings().ariaTags&&(fe(e.element,[Ot()]),fe(this._element,[Et()])),A([t,e],(t=>this._element.appendChild(t.element))),sN(this,hN).addLocalHook("select",(t=>rN(this,fN,vN).call(this,t))),sN(this,hN).addLocalHook("afterClose",(()=>rN(this,mN,CN).call(this))),this.update()}update(){if(!this.isBuilt())return;let t;t=this.options.value?this.options.value.name:sN(this,hN).hot.getTranslatedPhrase(sg),sN(this,dN).textContent=t,super.update()}openOptions(){const t=this.element.getBoundingClientRect();sN(this,hN)&&(sN(this,hN).open(),sN(this,hN).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),sN(this,hN).getNavigator().toFirstItem(),sN(this,hN).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){sN(this,hN)&&sN(this,hN).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){sN(this,hN)&&(sN(this,hN).destroy(),nN(this,hN,null)),sN(this,uN)&&sN(this,uN).destroy(),sN(this,gN)&&sN(this,gN).destroy(),super.destroy()}}function vN(t){t.name!==AM&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function CN(){this.runLocalHooks("afterClose")}function yN(){this.openOptions()}function bN(t,e){SN(t,e),e.add(t)}function SN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RN(t,e,o){return e=EN(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function EN(t){var e=TN(t,"string");return"symbol"===typeof e?e:String(e)}function TN(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function MN(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}var HN=new WeakSet,xN=new WeakSet;class kN extends WO{constructor(t,e){super(t,{id:e.id,stateless:!1}),bN(this,xN),bN(this,HN),RN(this,"name",""),RN(this,"addSeparator",!1),this.name=e.name,this.addSeparator=e.addSeparator,this.elements.push(new wN(this.hot,{menuContainer:e.menuContainer})),this.elements.push(new JP(this.hot,{placeholder:Dg})),this.elements.push(new JP(this.hot,{placeholder:Wg})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",(t=>MN(this,HN,IN).call(this,t))).addLocalHook("afterClose",(()=>this.runLocalHooks("afterClose"))).addLocalHook("tabKeydown",(t=>this.runLocalHooks("selectTabKeydown",t))),A(this.getInputElements(),(t=>{t.addLocalHook("keydown",(t=>MN(this,xN,AN).call(this,t)))}))}setState(t){if(this.reset(),!t)return;const e=bo(t.command);e.name.startsWith(rg)&&(e.name=this.hot.getTranslatedPhrase(e.name)),this.getSelectElement().setValue(e),A(t.args,((t,o)=>{if(o>e.inputsCount-1)return!1;const n=this.getInputElement(o);n.setValue(t),n[e.inputsCount>o?"show":"hide"](),o||this.hot._registerTimeout((()=>n.focus()),10)}))}getState(){const t=this.getSelectElement().getValue()||jO(zO),e=[];return A(this.getInputElements(),((o,n)=>{t.inputsCount>n&&e.push(o.getValue())})),{command:t,args:e}}updateState(t,e){const o=jO(t?t.name:zO);this.state.setValueAtIndex(e,{command:o,args:t?t.args:[]}),t||A(this.getInputElements(),(t=>t.setValue(null)))}getSelectElement(){return this.elements.filter((t=>t instanceof wN))[0]}getInputElement(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}getInputElements(){return this.elements.filter((t=>t instanceof JP))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,o,n,i,r)=>{de(e.parentNode,"htFiltersMenuCondition"),this.addSeparator&&de(e.parentNode,"border");const s=this.hot.rootDocument.createElement("div");return de(s,"htFiltersMenuLabel"),s.textContent=r,e.appendChild(s),A(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getPlugin("filters").getSelectedColumn();let e=[jO(zO)];if(null!==t){const{visualIndex:o}=t;e=PP(this.hot.getDataType(0,o,this.hot.countRows(),o))}A(this.getInputElements(),(t=>t.hide())),this.getSelectElement().setItems(e),super.reset(),this.getSelectElement().setValue(e[0])}}function IN(t){A(this.getInputElements(),((e,o)=>{e[t.inputsCount>o?"show":"hide"](),0===o&&this.hot._registerTimeout((()=>e.focus()),10)})),this.runLocalHooks("change",t)}function AN(t){on(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),nn(t))}const ON={};function PN(t){if(!ON[t])throw Error(`Operation with id "${t}" does not exist.`);const e=ON[t].func;return function(t,o){return e(t,o)}}function NN(t){return ON[t].name}function _N(t,e,o){ON[t]={name:e,func:o}}const LN="conjunction",DN=kg;function WN(t,e){return t.every((t=>t.func(e)))}_N(LN,DN,WN);const VN="disjunction",FN=Ig;function jN(t,e){return t.some((t=>t.func(e)))}_N(VN,FN,jN);const BN="disjunctionWithExtraCondition",zN=Ig;function UN(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some((t=>t.func(e)))&&t[t.length-1].func(e)}function $N(t,e,o){GN(t,e),e.set(t,o)}function GN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YN(t,e){var o=qN(t,e,"get");return KN(t,o)}function KN(t,e){return e.get?e.get.call(t):e.value}function XN(t,e,o){var n=qN(t,e,"set");return QN(t,n,o),o}function qN(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function QN(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}_N(BN,zN,UN);var JN=new WeakMap,ZN=new WeakMap;class t_ extends FP{static get DEFAULTS(){return bo({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,e){super(t,vo(t_.DEFAULTS,e)),$N(this,JN,{writable:!0,value:void 0}),$N(this,ZN,{writable:!0,value:void 0})}build(){super.build();const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),XN(this,ZN,t),XN(this,JN,this._element.firstChild),YN(this,JN).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(YN(this,ZN).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return YN(this,JN).checked}setChecked(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(YN(this,JN).checked=t)}focus(){this.isBuilt()&&YN(this,JN).focus()}}function e_(t,e){o_(t,e),e.add(t)}function o_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function n_(t,e,o){return e=i_(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function i_(t){var e=r_(t,"string");return"symbol"===typeof e?e:String(e)}function r_(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function s_(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const l_=0;var a_=new WeakSet;class h_ extends WO{constructor(t,e){super(t,{id:e.id,stateless:!1}),e_(this,a_),n_(this,"name",""),this.name=e.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(de(e.parentNode,"htFiltersMenuOperators"),A(this.elements,(t=>e.appendChild(t.element))),e)}}buildOperatorsElement(){const t=[LN,VN];A(t,(e=>{const o=new t_(this.hot,{name:"operator",label:{htmlFor:e,textContent:NN(e)},value:e,checked:e===t[l_],id:e});o.addLocalHook("change",(t=>s_(this,a_,c_).call(this,t))),this.elements.push(o)}))}setChecked(t){if(this.elements.length<t)throw Error(B`Radio button with index ${t} doesn't exist.`);A(this.elements,((e,o)=>{e.setChecked(o===t)}))}getActiveOperationId(){const t=this.elements.find((t=>t instanceof t_&&t.isChecked()));return t?t.getValue():LN}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&A(this.elements,(e=>{e.setChecked(e.getValue()===t)}))}updateState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:LN,e=arguments.length>1?arguments[1]:void 0,o=t;o===BN&&(o=VN),this.state.setValueAtIndex(e,o)}reset(){this.setChecked(l_)}}function c_(t){this.setState(t.target.value)}Rr();function u_(t,e){let o=t;return""===o&&(o=`(${e})`),o}const d_=new Set([1]).has(1),g_=d_&&"function"===typeof Array.from;function f_(t){let e=t;return d_&&(e=new Set(e)),function(t){let o;return o=d_?e.has(t):!!~e.indexOf(t),o}}function m_(t){return null===t||void 0===t?"":t}function p_(t){let e=t;return e=g_?Array.from(new Set(e)):D(e),e=e.sort(((t,e)=>"number"===typeof t&&"number"===typeof e?t-e:t===e?0:t>e?1:-1)),e}function w_(t,e,o,n){const i=[],r=t===e;let s;return r||(s=f_(e)),A(t,(t=>{let e=!1;(r||s(t))&&(e=!0);const l={checked:e,value:t,visualValue:u_(t,o)};n&&n(l),i.push(l)})),i}function v_(t,e,o){C_(t,e),e.set(t,o)}function C_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y_(t,e){var o=R_(t,e,"get");return b_(t,o)}function b_(t,e){return e.get?e.get.call(t):e.value}function S_(t,e,o){var n=R_(t,e,"set");return E_(t,n,o),o}function R_(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function E_(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var T_=new WeakMap;class M_ extends FP{static get DEFAULTS(){return bo({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,e){super(t,vo(M_.DEFAULTS,e)),v_(this,T_,{writable:!0,value:void 0})}build(){super.build(),S_(this,T_,this._element.firstChild)}update(){this.isBuilt()&&(y_(this,T_).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&y_(this,T_).focus()}activate(){y_(this,T_).click()}}function H_(t,e){k_(t,e),e.add(t)}function x_(t,e,o){k_(t,e),e.set(t,o)}function k_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function I_(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function A_(t,e){var o=N_(t,e,"get");return O_(t,o)}function O_(t,e){return e.get?e.get.call(t):e.value}function P_(t,e,o){var n=N_(t,e,"set");return __(t,n,o),o}function N_(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function __(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const L_="multipleSelect.itemBox";var D_=new WeakMap,W_=new WeakMap,V_=new WeakMap,F_=new WeakMap,j_=new WeakMap,B_=new WeakMap,z_=new WeakSet,U_=new WeakSet,$_=new WeakSet,G_=new WeakSet;class Y_ extends FP{static get DEFAULTS(){return bo({className:"htUIMultipleSelect",value:[]})}constructor(t,e){super(t,vo(Y_.DEFAULTS,e)),H_(this,G_),H_(this,$_),H_(this,U_),H_(this,z_),x_(this,D_,{writable:!0,value:[]}),x_(this,W_,{writable:!0,value:void 0}),x_(this,V_,{writable:!0,value:void 0}),x_(this,F_,{writable:!0,value:void 0}),x_(this,j_,{writable:!0,value:void 0}),x_(this,B_,{writable:!0,value:void 0}),P_(this,F_,new JP(this.hot,{placeholder:Lg,className:"htUIMultipleSelectSearch"})),P_(this,j_,new M_(this.hot,{textContent:Og,className:"htUISelectAll"})),P_(this,B_,new M_(this.hot,{textContent:Pg,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return A_(this,W_)}registerHooks(){A_(this,F_).addLocalHook("keydown",(t=>I_(this,U_,X_).call(this,t))),A_(this,F_).addLocalHook("input",(t=>I_(this,z_,K_).call(this,t))),A_(this,j_).addLocalHook("click",(t=>I_(this,$_,q_).call(this,t))),A_(this,B_).addLocalHook("click",(t=>I_(this,G_,Q_).call(this,t)))}setItems(t){P_(this,D_,t),A_(this,W_)&&A_(this,W_).loadData(A_(this,D_))}setLocale(t){P_(this,V_,t)}getLocale(){return A_(this,V_)}getItems(){return[...A_(this,D_)]}getValue(){return Z_(A_(this,D_))}getSearchInputElement(){return A_(this,F_)}getSelectAllElement(){return A_(this,j_)}getClearAllElement(){return A_(this,B_)}isSelectedAllValues(){return A_(this,D_).length===this.getValue().length}build(){super.build();const{rootDocument:t}=this.hot,e=t.createElement("div"),o=new FP(this.hot,{className:"htUISelectionControls",children:[A_(this,j_),A_(this,B_)]});this._element.appendChild(A_(this,F_).element),this._element.appendChild(o.element),this._element.appendChild(e);const n=e=>{if(!this._element)return;A_(this,W_)&&A_(this,W_).destroy(),de(e,"htUIMultipleSelectHot"),P_(this,W_,new this.hot.constructor(e,{data:A_(this,D_),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(t,e,o,n,i,r)=>{t.title=r.instance.getDataAtRowProp(e,r.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{A_(this,W_).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>A_(this,W_).container.scrollWidth-$e(t),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),A_(this,W_).init();const o=A_(this,W_).getShortcutManager(),n=o.getContext("grid");n.removeShortcutsByKeys(["Tab"]),n.removeShortcutsByKeys(["Shift","Tab"]),n.addShortcut({keys:[["Escape"]],callback:t=>{this.runLocalHooks("keydown",t,this)},group:L_}),n.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:t=>{A_(this,W_).deselectCell(),this.runLocalHooks("keydown",t,this),this.runLocalHooks("listTabKeydown",t,this)},group:L_})};n(e),this.hot._registerTimeout((()=>n(e)),100)}focus(){this.isBuilt()&&A_(this,W_).listen()}reset(){A_(this,F_).reset(),A_(this,j_).reset(),A_(this,B_).reset()}update(){this.isBuilt()&&(A_(this,W_).loadData(J_(A_(this,D_),this.options.value)),super.update())}destroy(){A_(this,W_)&&A_(this,W_).destroy(),A_(this,F_).destroy(),A_(this,B_).destroy(),A_(this,j_).destroy(),P_(this,F_,null),P_(this,B_,null),P_(this,j_,null),P_(this,W_,null),P_(this,D_,null),super.destroy()}}function K_(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let o;o=""===e?[...A_(this,D_)]:k(A_(this,D_),(t=>`${t.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0)),A_(this,W_).loadData(o)}function X_(t){this.runLocalHooks("keydown",t,this);const e=uo(on,t.keyCode);e("ARROW_DOWN")&&(t.preventDefault(),nn(t),A_(this,W_).listen(),A_(this,W_).selectCell(0,0))}function q_(t){const e=[];t.preventDefault(),A(A_(this,W_).getSourceData(),((t,o)=>{t.checked=!0,e.push(zc(t,o)[0])})),A_(this,W_).setSourceDataAtCell(e)}function Q_(t){const e=[];t.preventDefault(),A(A_(this,W_).getSourceData(),((t,o)=>{t.checked=!1,e.push(zc(t,o)[0])})),A_(this,W_).setSourceDataAtCell(e)}function J_(t,e){const o=f_(e);return I(t,(t=>(t.checked=o(t.value),t)))}function Z_(t){const e=[];return A(t,(t=>{t.checked&&e.push(t.value)})),e}const tL="by_value";function eL(t,e){let[o]=e;return o(t.value)}function oL(t,e){nL(t,e),e.add(t)}function nL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iL(t,e,o){return e=rL(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function rL(t){var e=sL(t,"string");return"symbol"===typeof e?e:String(e)}function sL(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function lL(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}BO(tL,eL,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[f_(e)]},showOperators:!1});var aL,hL=new WeakSet;class cL extends WO{constructor(t,e){super(t,{id:e.id,stateless:!1}),oL(this,hL),iL(this,"name",""),this.name=e.name,this.elements.push(new Y_(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",(t=>lL(this,hL,uL).call(this,t))).addLocalHook("listTabKeydown",(t=>this.runLocalHooks("listTabKeydown",t)))}getElements(){const t=this.getMultipleSelectElement();return[t.getSearchInputElement(),t.getSelectAllElement(),t.getClearAllElement(),this.getMultipleSelectElement()]}setState(t){if(this.reset(),t&&t.command.key===tL){const e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}getState(){const t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?zO:tL},args:[t.getValue()],itemsSnapshot:e}}updateState(t){const e=(e,o,n,i,r)=>{const[s]=k(o,(t=>t.name===tL)),l={},a=this.hot.getTranslatedPhrase(Ag);if(s){const o=p_(I(i(e,r),(t=>t.value)));n&&(s.args[0]=n);const h=[],c=w_(o,s.args[0],a,(t=>{t.checked&&h.push(t.value)})),u=t.editedConditionStack.column;l.locale=this.hot.getCellMeta(0,u).locale,l.args=[h],l.command=jO(tL),l.itemsSnapshot=c}else l.args=[],l.command=jO(zO);this.state.setValueAtIndex(e,l)};e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter((t=>t instanceof Y_))[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,o,n,i,r)=>{de(e.parentNode,"htFiltersMenuValue");const s=this.hot.rootDocument.createElement("div");return de(s,"htFiltersMenuLabel"),s.textContent=r,e.appendChild(s),A(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getTranslatedPhrase(Ag),e=p_(this._getColumnVisibleValues()),o=w_(e,e,t);this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(e);const n=this.hot.getPlugin("filters").getSelectedColumn();null!==n&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,n.visualIndex).locale)}_getColumnVisibleValues(){const t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:I(this.hot.getDataAtCol(t.visualIndex),(t=>m_(t)))}}function uL(t){on(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),nn(t))}function dL(t,e){gL(t,e),e.add(t)}function gL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fL(t,e,o){return e=mL(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function mL(t){var e=pL(t,"string");return"symbol"===typeof e?e:String(e)}function pL(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function wL(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}var vL=new WeakSet;class CL extends WO{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,e){super(t,{id:e.id,stateless:!0}),dL(this,vL),fL(this,"name",""),this.name=e.name,this.elements.push(new JP(this.hot,{type:"button",value:Ng,className:"htUIButton htUIButtonOK",identifier:CL.BUTTON_OK})),this.elements.push(new JP(this.hot,{type:"button",value:_g,className:"htUIButton htUIButtonCancel",identifier:CL.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){A(this.elements,(t=>{t.addLocalHook("click",((t,e)=>wL(this,vL,yL).call(this,t,e)))}))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(de(e.parentNode,"htFiltersMenuActionBar"),A(this.elements,(t=>e.appendChild(t.element))),e)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function yL(t,e){e.options.identifier===aL.BUTTON_OK?this.accept():this.cancel()}function bL(t,e,o){return e=SL(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function SL(t){var e=RL(t,"string");return"symbol"===typeof e?e:String(e)}function RL(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}aL=CL;const EL="ConditionCollection.filteringStates";class TL{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];bL(this,"hot",void 0),bL(this,"isMapRegistrable",void 0),bL(this,"filteringStates",new wu),this.hot=t,this.isMapRegistrable=e,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(EL,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(t,e){var o;const n=this.filteringStates.getValueAtIndex(e),i=null!==(o=null===n||void 0===n?void 0:n.conditions)&&void 0!==o?o:[],r=null===n||void 0===n?void 0:n.operation;return this.isMatchInConditions(i,t,r)}isMatchInConditions(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:LN;return!t.length||PN(o)(t,e)}addCondition(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:LN,n=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,t).locale,r=I(e.args,(t=>"string"===typeof t?t.toLocaleLowerCase(i):t)),s=e.name||e.command.key;this.runLocalHooks("beforeAdd",t);const l=this.getOperation(t);if(l){if(l!==o)throw Error(B`The column of index ${t} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if($(ON[o]))throw new Error(B`Unexpected operation named \`${o}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const a=this.getConditions(t);0===a.length?this.filteringStates.setValueAtIndex(t,{operation:o,conditions:[{name:s,args:r,func:FO(s,r)}]},n):a.push({name:s,args:r,func:FO(s,r)}),this.runLocalHooks("afterAdd",t)}getConditions(t){var e,o;return null!==(e=null===(o=this.filteringStates.getValueAtIndex(t))||void 0===o?void 0:o.conditions)&&void 0!==e?e:[]}getOperation(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map((t=>{let[e]=t;return e}))}getColumnStackPosition(t){return this.getFilteredColumns().indexOf(t)}exportAllConditions(){return x(this.filteringStates.getEntries(),((t,e)=>{let[o,{operation:n,conditions:i}]=e;return t.push({column:o,operation:n,conditions:I(i,(t=>{let{name:e,args:o}=t;return{name:e,args:o}}))}),t}),[])}importAllConditions(t){this.clean(),A(t,(t=>{A(t.conditions,(e=>this.addCondition(t.column,e)))}))}removeConditions(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(t,e){const o=this.getConditions(t);return e?o.some((t=>t.name===e)):o.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(EL),this.filteringStates=null,this.clearLocalHooks()}}So(TL,tu);var ML=TL;function HL(t,e,o){return e=xL(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function xL(t){var e=kL(t,"string");return"symbol"===typeof e?e:String(e)}function kL(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class IL{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];HL(this,"conditionCollection",void 0),HL(this,"columnDataFactory",void 0),this.conditionCollection=t,this.columnDataFactory=e}filter(){let t=[];return A(this.conditionCollection.getFilteredColumns(),((e,o)=>{let n=this.columnDataFactory(e);o&&(n=this._getIntersectData(n,t)),t=this.filterByColumn(e,n)})),t}filterByColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=[];return A(e,(e=>{void 0!==e&&this.conditionCollection.isMatch(e,t)&&o.push(e)})),o}_getIntersectData(t,e){const o=[];return A(e,(e=>{const n=e.meta.visualRow;void 0!==t[n]&&(o[n]=t[n])})),o}}var AL=IL;function OL(t,e){PL(t,e),e.add(t)}function PL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NL(t,e,o){return e=_L(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function _L(t){var e=LL(t,"string");return"symbol"===typeof e?e:String(e)}function LL(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function DL(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}var WL=new WeakSet,VL=new WeakSet,FL=new WeakSet;class jL{constructor(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];OL(this,FL),OL(this,VL),OL(this,WL),NL(this,"hot",void 0),NL(this,"conditionCollection",void 0),NL(this,"columnDataFactory",void 0),NL(this,"changes",[]),NL(this,"grouping",!1),NL(this,"latestEditedColumnPosition",-1),NL(this,"latestOrderStack",[]),this.hot=t,this.conditionCollection=e,this.columnDataFactory=o,this.conditionCollection.addLocalHook("beforeRemove",(t=>DL(this,WL,BL).call(this,t))),this.conditionCollection.addLocalHook("afterRemove",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("afterAdd",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("beforeClean",(()=>DL(this,VL,zL).call(this))),this.conditionCollection.addLocalHook("afterClean",(()=>DL(this,FL,UL).call(this)))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,A(this.changes,(t=>{this.updateStatesAtColumn(t)})),this.changes.length=0}updateStatesAtColumn(t,e){var o=this;if(this.grouping)return void(-1===this.changes.indexOf(t)&&this.changes.push(t));const n=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(t);-1===i&&(i=this.latestEditedColumnPosition);const r=n.slice(0,i),s=n.slice(i);s.length&&s[0].column===t&&s.shift();const l=go((function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=new ML(o.hot,!1),r=[].concat(t,n);i.importAllConditions(r);const s=o.columnDataFactory(e);let l;l=i.isEmpty()?s:new AL(i,(t=>o.columnDataFactory(t))).filter(),l=I(l,(t=>t.meta.visualRow));const a=f_(l);return i.destroy(),k(s,(t=>a(t.meta.visualRow)))}))(r),a=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:a},dependentConditionStacks:s,filteredRowsFactory:l,conditionArgsChange:e})}destroy(){this.clearLocalHooks(),Mo(this,((t,e)=>{this[e]=null}))}}function BL(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function zL(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function UL(){A(this.latestOrderStack,(t=>{this.updateStatesAtColumn(t)}))}So(jL,tu);var $L=jL;function GL(t){const e=Wx({initialPage:0,size:()=>t.length,onItemSelect:(e,o)=>{const n=t[e];return n instanceof Y_?o:!(n.element&&!be(n.element))&&void n.focus()}});return e}const YL="filters";function KL(t,e){const o=GL(e),n=n=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(YL),o.setCurrentPage(e.indexOf(n))};function i(n){const i=t.getKeyboardShortcutsCtrl(),r=n.getKeyboardShortcutsCtrl();o.clear(),r.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:i.getContext(YL),callback:()=>{n.isSubMenu()&&n.close(),i.listen(YL)}}]),n.isSubMenu()||i.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{t.getNavigator().clear(),e.shiftKey?o.toPreviousItem():o.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:t=>{const n=e[o.getCurrentPage()];n instanceof wN&&(n.openOptions(),t.preventDefault()),n instanceof M_&&(n.activate(),t.preventDefault()),n instanceof FP||t.preventDefault()}}],YL)}function r(){t.focus(),t.getKeyboardShortcutsCtrl().listen(YL)}return e.forEach((t=>{t instanceof FP&&(t.addLocalHook("click",n(t)),t.addLocalHook("focus",n(t)),t.addLocalHook("afterClose",n(t)))})),t.addLocalHook("afterSelectionChange",(t=>{t.key.startsWith("filter_")||o.clear()})),t.addLocalHook("afterSubmenuOpen",i),t.addLocalHook("afterOpen",i),{...o,listen:r}}function XL(t,e){QL(t,e),e.add(t)}function qL(t,e,o){QL(t,e),e.set(t,o)}function QL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JL(t,e,o){return e=ZL(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function ZL(t){var e=tD(t,"string");return"symbol"===typeof e?e:String(e)}function tD(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function eD(t,e,o){var n=iD(t,e,"set");return oD(t,n,o),o}function oD(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function nD(t,e){var o=iD(t,e,"get");return rD(t,o)}function iD(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function rD(t,e){return e.get?e.get.call(t):e.value}function sD(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const lD="filters",aD=250,hD=lD;var cD=new WeakMap,uD=new WeakSet,dD=new WeakSet,gD=new WeakSet,fD=new WeakSet,mD=new WeakSet,pD=new WeakSet,wD=new WeakSet,vD=new WeakSet,CD=new WeakSet;class yD extends fS{static get PLUGIN_KEY(){return lD}static get PLUGIN_PRIORITY(){return aD}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(t){super(t),XL(this,CD),XL(this,vD),XL(this,wD),XL(this,pD),XL(this,mD),XL(this,fD),XL(this,gD),XL(this,dD),XL(this,uD),JL(this,"dropdownMenuPlugin",null),JL(this,"conditionCollection",null),JL(this,"conditionUpdateObserver",null),JL(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),JL(this,"filtersRowsMap",null),qL(this,cD,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",((t,e)=>sD(this,vD,xD).call(this,t,e)))}isEnabled(){return!!this.hot.getSettings()[lD]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new vu),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,e=t&&t.uiContainer||this.hot.rootDocument.body,o=t=>(t.addLocalHook("accept",(()=>sD(this,mD,TD).call(this,"accept"))),t.addLocalHook("cancel",(()=>sD(this,mD,TD).call(this,"cancel"))),t.addLocalHook("change",(e=>sD(this,pD,MD).call(this,t,e))),t),n=()=>`${this.hot.getTranslatedPhrase(Hg)}:`,i=()=>`${this.hot.getTranslatedPhrase(xg)}:`;if(!this.components.get("filter_by_condition")){const t=new kN(this.hot,{id:"filter_by_condition",name:n,addSeparator:!1,menuContainer:e});t.addLocalHook("afterClose",(()=>sD(this,wD,HD).call(this))),this.components.set("filter_by_condition",o(t))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new h_(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const t=new kN(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:e});t.addLocalHook("afterClose",(()=>sD(this,wD,HD).call(this))),this.components.set("filter_by_condition2",o(t))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",o(new cL(this.hot,{id:"filter_by_value",name:i}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",o(new CL(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new ML(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new $L(this.hot,this.conditionCollection,(t=>this.getDataMapAtColumn(t))),this.conditionUpdateObserver.addLocalHook("update",(t=>sD(this,CD,kD).call(this,t)))),this.components.forEach((t=>t.show())),this.addHook("afterDropdownMenuDefaultOptions",(t=>sD(this,fD,ED).call(this,t))),this.addHook("afterDropdownMenuShow",(()=>sD(this,dD,SD).call(this))),this.addHook("afterDropdownMenuHide",(()=>sD(this,gD,RD).call(this))),this.addHook("afterChange",(t=>sD(this,uD,bD).call(this,t))),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!nD(this,cD)&&this.dropdownMenuPlugin.enabled){const t=this.dropdownMenuPlugin.menu,e=[{focus:()=>t.focus()},...Array.from(this.components).map((t=>{let[,e]=t;return e.getElements()})).flat()];eD(this,cD,KL(t,e));const o=t=>{nD(this,cD).listen(),t.preventDefault(),on(t.keyCode,"TAB")&&(t.shiftKey?nD(this,cD).toPreviousItem():nD(this,cD).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",o),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",o)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){var t;this.enabled&&(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(((t,e)=>{t.destroy(),this.components.set(e,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const t=this.hot.getSelected();this.clearConditions(),this.filter(),t&&this.hot.selectCells(t)},group:hD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hD)}addCondition(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:LN;const i=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(i,{command:{key:e},args:o},n)}removeConditions(t){const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}clearConditions(t){if(void 0===t)this.conditionCollection.clean();else{const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}filter(){const{navigableHeaders:t}=this.hot.getSettings(),e=this._createDataFilter(),o=!this.conditionCollection.isEmpty();let n=[];const i=this.conditionCollection.exportAllConditions(),r=this.hot.runHooks("beforeFilter",i);if(!1!==r)if(o){const o=[];this.hot.batchExecution((()=>{this.filtersRowsMap.clear(),n=I(e.filter(),(t=>t.meta.visualRow));const t=f_(n);Pi(this.hot.countSourceRows()-1,(e=>{t(e)||o.push(e)})),A(o,(t=>{this.filtersRowsMap.setValueAtIndex(t,!0)}))}),!0),t||n.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",i),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(t?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}getDataMapAtColumn(t){const e=this.hot.toVisualColumn(t),o=[];return A(this.hot.getSourceDataAtCol(e),((t,n)=>{var i;const{row:r,col:s,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:u,locale:d}=this.hot.getCellMeta(n,e),g=null!==(i=this.hot.getDataAtCell(this.hot.toVisualRow(n),e))&&void 0!==i?i:t;o.push({meta:{row:r,col:s,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:u,locale:d},value:m_(g)})})),o}updateValueComponentCondition(t){const e=this.hot.getDataAtCol(t),o=p_(e);this.conditionUpdateObserver.updateStatesAtColumn(t,o)}restoreComponents(t){var e;const o=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach((t=>{t.isHidden()||t.restoreState(o)})),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(t,e,o,n){let i=t;return i===VN&&e.command.key!==zO&&o.command.key!==zO&&n.command.key!==zO?i=BN:n.command.key!==zO&&(e.command.key!==zO&&o.command.key!==zO||(i=LN)),i}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const t=this.components.get("filter_by_condition"),{command:e}=t.getState(),o=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...o):this.hideComponents(...o)}_createDataFilter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new AL(t,(t=>this.getDataMapAtColumn(t)))}getIndexesOfComponents(){const t=[];if(!this.dropdownMenuPlugin)return t;const e=this.dropdownMenuPlugin.menu;for(var o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return A(n,(o=>{A(e.menuItems,((e,n)=>{e.key===o.getMenuItemDescriptor().key&&t.push(n)}))})),t}changeComponentsVisibility(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const e=this.dropdownMenuPlugin.menu,o=e.hotMenu,n=o.getPlugin("hiddenRows");for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];const l=this.getIndexesOfComponents(...r);t?n.showRows(l):n.hideRows(l),o.render()}hideComponents(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.changeComponentsVisibility(!1,...e)}showComponents(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.changeComponentsVisibility(!0,...e)}destroy(){this.enabled&&(this.components.forEach(((t,e)=>{null!==t&&(t.destroy(),this.components.set(e,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function bD(t){t&&A(t,(t=>{const[,e]=t,o=this.hot.propToCol(e);this.conditionCollection.hasConditions(o)&&this.updateValueComponentCondition(o)}))}function SD(){this.restoreComponents(Array.from(this.components.values()))}function RD(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function ED(t){t.items.push({name:AM}),this.components.forEach((e=>{t.items.push(e.getMenuItemDescriptor())}))}function TD(t){var e;if("accept"===t){const t=this.getSelectedColumn();var o;if(null===t)return void(null===(o=this.dropdownMenuPlugin)||void 0===o||o.close());const{physicalIndex:e}=t,n=this.components.get("filter_by_condition").getState(),i=this.components.get("filter_by_condition2").getState(),r=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),n,i,r);this.conditionUpdateObserver.groupChanges();let l=this.conditionCollection.getColumnStackPosition(e);-1===l&&(l=void 0),this.conditionCollection.removeConditions(e),n.command.key!==zO&&(this.conditionCollection.addCondition(e,n,s,l),i.command.key!==zO&&this.conditionCollection.addCondition(e,i,s,l)),r.command.key!==zO&&this.conditionCollection.addCondition(e,r,s,l),this.conditionUpdateObserver.flush(),this.components.forEach((t=>t.saveState(e))),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}function MD(t,e){this.updateDependentComponentsVisibility(),t.constructor!==kN||e.inputsCount||this.setListeningDropdownMenu()}function HD(){this.setListeningDropdownMenu()}function xD(t,e){const o=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(o)?de(e,"htFiltersActive"):ge(e,"htFiltersActive")}function kD(t){var e;if(null===(e=this.dropdownMenuPlugin)||void 0===e||!e.enabled)return;const{editedConditionStack:{conditions:o,column:n}}=t,i=o.filter((t=>t.name===tL)),r=o.filter((t=>t.name!==tL));if(i.length>=2||r.length>=3)hn(B`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const e=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(r[0],n),this.components.get("filter_by_condition2").updateState(r[1],n),this.components.get("filter_operators").updateState(e,n),this.components.get("filter_by_value").updateState(t)}}const ID="internal-use-in-handsontable",AD={licenseKey:ID,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function OD(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[GW])||void 0===e||null===(e=e.language)||void 0===e?void 0:e.langCode}}function PD(t){return Object.keys(t).reduce(((e,o)=>("hyperformula"!==o&&(e[o]=t[o]),e)),{})}function ND(t){var e;const o=t[GW],n=PD(null!==o&&void 0!==o&&null!==(e=o.engine)&&void 0!==e&&e.hyperformula?o.engine:{}),i=OD(t);return{...AD,...n,...i}}function _D(t){var e;const o=t[GW],n=PD(null!==o&&void 0!==o&&null!==(e=o.engine)&&void 0!==e&&e.hyperformula?o.engine:{}),i=OD(t);return{...n,...i}}function LD(t,e){return Object.keys(e).some((o=>void 0!==e[o]&&e[o]!==t[o]))}function DD(){const t="engine_relationship",e=Rn(GW);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function WD(){const t="shared_engine_usage",e=Rn(GW);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function VD(t){const e=t.getSettings(),o=e[GW],n=null===o||void 0===o?void 0:o.engine;if(!0===o)return null;if($(n))return null;var i;if("function"===typeof n.hyperformula||"function"===typeof n)return FD(null!==(i=n.hyperformula)&&void 0!==i?i:n,e,t);if("object"===typeof n&&$(n.hyperformula)){const e=DD(),o=WD().get(n);return e.has(n)||e.set(n,[]),e.get(n).push(t),o&&o.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:ID}),n.getConfig().leapYear1900===AD.leapYear1900&&!1!==Ro(n.getConfig().nullDate,AD.nullDate)||hn(B`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function FD(t,e,o){const n=e[GW],i=ND(e),r=DD(),s=WD();zD(t,n.functions),UD(t,n.language);const l=t.buildEmpty(i);return r.set(l,[o]),s.set(l,[o.guid]),$D(l,n.namedExpressions),l.on("sheetAdded",(()=>{l.rebuildAndRecalculate()})),l.on("sheetRemoved",(()=>{l.rebuildAndRecalculate()})),l}function jD(t){var e;const o=DD(),n=0===o.size?[]:Array.from(null!==(e=o.get(t))&&void 0!==e?e:[]);return new Map(n.map((t=>[t.getPlugin("formulas").sheetId,t])))}function BD(t,e){if(t){const o=DD(),n=o.get(t),i=WD(),r=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),0===n.length&&o.delete(t)),r&&r.includes(e.guid)&&(r.splice(r.indexOf(e.guid),1),0===r.length&&(i.delete(t),t.destroy()))}}function zD(t,e){e&&e.forEach((e=>{const{name:o,plugin:n,translations:i}=e;try{t.registerFunction(o,n,i)}catch(r){hn(r.message)}}))}function UD(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(o){hn(o.message)}}}function $D(t,e){e&&(t.suspendEvaluation(),e.forEach((e=>{const{name:o,expression:n,scope:i,options:r}=e;try{t.addNamedExpression(o,n,i,r)}catch(s){hn(s.message)}})),t.resumeEvaluation())}function GD(t,e){return!$(e)&&t.doesSheetExist(e)||(e=t.addSheet(e)),e}const YD="DD/MM/YYYY";function KD(t){return"string"===typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function XD(t){return KD(t)?t.substr(1):t}function qD(t){return"string"===typeof t&&t.startsWith("=")}function QD(t,e){return"string"===typeof t&&"date"===e}function JD(t,e){return E(t,e,!0).isValid()}function ZD(t,e){return E(t,e,!0).format(YD)}function tW(t,e){return E(t,YD,!0).format(e)}function eW(t,e){const o=-1,n=new Date(Date.UTC(0,0,t+o));return E(n).format(e)}function oW(t,e,o){nW(t,e),e.set(t,o)}function nW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iW(t,e){var o=lW(t,e,"get");return rW(t,o)}function rW(t,e){return e.get?e.get.call(t):e.value}function sW(t,e,o){var n=lW(t,e,"set");return aW(t,n,o),o}function lW(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function aW(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var hW=new WeakMap,cW=new WeakMap,uW=new WeakMap,dW=new WeakMap,gW=new WeakMap,fW=new WeakMap,mW=new WeakMap;class pW{constructor(t,e,o){oW(this,hW,{writable:!0,value:void 0}),oW(this,cW,{writable:!0,value:void 0}),oW(this,uW,{writable:!0,value:void 0}),oW(this,dW,{writable:!0,value:[]}),oW(this,gW,{writable:!0,value:[]}),oW(this,fW,{writable:!0,value:void 0}),oW(this,mW,{writable:!0,value:[]}),sW(this,hW,t),sW(this,cW,e),sW(this,uW,o)}setRemovedHfIndexes(t){return sW(this,mW,t.map((t=>{const e=iW(this,cW).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(e)}))),iW(this,mW)}getRemovedHfIndexes(){return iW(this,mW)}getHfIndexFromVisualIndex(t){const e=iW(this,cW).getIndexesSequence(),o=iW(this,cW).getNotTrimmedIndexes();return e.indexOf(o[t])}syncMoves(t){const e=1,o=`move${lt(iW(this,hW))}s`;iW(this,uW).getEngine().batch((()=>{t.forEach((t=>{const n=t.from!==t.to,i=t.from+1!==t.to;n&&i&&iW(this,uW).getEngine()[o](iW(this,uW).getSheetId(),t.from,e,t.to)}))}))}storeMovesInformation(t,e,o){!1!==o&&(sW(this,gW,t.map((t=>this.getHfIndexFromVisualIndex(t)))),sW(this,fW,this.getHfIndexFromVisualIndex(e)))}getMoveLine(t,e){const o=iW(this,cW).getNumberOfIndexes(),n=Array.from(Array(o).keys()).filter((e=>!1===t.includes(e)));var i;return 0===e?null!==(i=n[e])&&void 0!==i?i:0:n[e-1]+1}getInitiallyCalculatedMoves(t,e){let o=this.getMoveLine(t,e);const n=[];return t.forEach((t=>{const e={from:t,to:o};n.forEach((t=>{const o=t.from>t.to,n=t.to<=e.from,i=t.from>e.from;i&&n&&o&&(e.from+=1)})),e.from>=o&&(o+=1),n.push(e)})),n}adjustedCalculatedMoves(t){return t.forEach(((e,o)=>{const n=t.slice(o+1);n.forEach((t=>{const o=t.from<t.to;t.from>e.from&&o&&(t.from-=1)}))})),t}calculateAndSyncMoves(t,e){if(iW(this,uW).isPerformingUndoRedo())return;if(!1===t||!1===e)return;const o=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(iW(this,gW),iW(this,fW)));null===iW(this,uW).getSheetId()?iW(this,uW).getPostponeAction((()=>this.syncMoves(o))):this.syncMoves(o)}getIndexesChangeSyncMethod(){const t=`set${lt(iW(this,hW))}Order`;return e=>{if(iW(this,uW).isPerformingUndoRedo())return;const o=iW(this,cW).getIndexesSequence();if("update"===e){const e=iW(this,dW).map((t=>o.indexOf(t))),n=iW(this,uW).getEngine().getSheetDimensions(iW(this,uW).getSheetId());let i;i="row"===iW(this,hW)?n.height:n.width;const r=e.length;for(let t=r;t<i;t+=1)e.push(t);iW(this,uW).getEngine()[t](iW(this,uW).getSheetId(),e)}sW(this,dW,o)}}init(){sW(this,dW,iW(this,cW).getIndexesSequence())}}var wW=pW;function vW(t,e,o){CW(t,e),e.set(t,o)}function CW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yW(t,e){var o=RW(t,e,"get");return bW(t,o)}function bW(t,e){return e.get?e.get.call(t):e.value}function SW(t,e,o){var n=RW(t,e,"set");return EW(t,n,o),o}function RW(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function EW(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var TW=new WeakMap,MW=new WeakMap,HW=new WeakMap,xW=new WeakMap,kW=new WeakMap,IW=new WeakMap,AW=new WeakMap;class OW{constructor(t,e,o){vW(this,TW,{writable:!0,value:void 0}),vW(this,MW,{writable:!0,value:void 0}),vW(this,HW,{writable:!0,value:void 0}),vW(this,xW,{writable:!0,value:!1}),vW(this,kW,{writable:!0,value:!1}),vW(this,IW,{writable:!0,value:null}),vW(this,AW,{writable:!0,value:null}),SW(this,TW,new wW("row",t,this)),SW(this,MW,new wW("column",e,this)),SW(this,HW,o)}getForAxis(t){return yW(this,"row"===t?TW:MW)}setPerformUndo(t){SW(this,xW,t)}setPerformRedo(t){SW(this,kW,t)}isPerformingUndoRedo(){return yW(this,xW)||yW(this,kW)}getSheetId(){return yW(this,AW)}getEngine(){return yW(this,IW)}getPostponeAction(){return yW(this,HW)}setupSyncEndpoint(t,e){SW(this,IW,t),SW(this,AW,e),yW(this,TW).init(),yW(this,MW).init()}}var PW=OW;function NW(t,e){VW(t,e),e.add(t)}function _W(t,e,o){return e=LW(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function LW(t){var e=DW(t,"string");return"symbol"===typeof e?e:String(e)}function DW(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function WW(t,e,o){VW(t,e),e.set(t,o)}function VW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FW(t,e,o){var n=zW(t,e,"set");return jW(t,n,o),o}function jW(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function BW(t,e){var o=zW(t,e,"get");return UW(t,o)}function zW(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function UW(t,e){return e.get?e.get.call(t):e.value}function $W(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const GW="formulas",YW=["maxRows","maxColumns","language"],KW=260;bn.getSingleton().register("afterNamedExpressionAdded"),bn.getSingleton().register("afterNamedExpressionRemoved"),bn.getSingleton().register("afterSheetAdded"),bn.getSingleton().register("afterSheetRemoved"),bn.getSingleton().register("afterSheetRenamed"),bn.getSingleton().register("afterFormulasValuesUpdate");const XW=t=>"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t;var qW=new WeakMap,QW=new WeakMap,JW=new WeakMap,ZW=new WeakSet,tV=new WeakSet,eV=new WeakSet,oV=new WeakSet,nV=new WeakSet,iV=new WeakSet,rV=new WeakSet,sV=new WeakSet,lV=new WeakSet,aV=new WeakSet,hV=new WeakSet,cV=new WeakSet,uV=new WeakSet,dV=new WeakSet,gV=new WeakSet,fV=new WeakSet,mV=new WeakSet,pV=new WeakSet,wV=new WeakSet,vV=new WeakSet,CV=new WeakSet,yV=new WeakSet,bV=new WeakSet,SV=new WeakSet;class RV extends fS{constructor(){var t;super(...arguments),t=this,NW(this,SV),NW(this,bV),NW(this,yV),NW(this,CV),NW(this,vV),NW(this,wV),NW(this,pV),NW(this,mV),NW(this,fV),NW(this,gV),NW(this,dV),NW(this,uV),NW(this,cV),NW(this,hV),NW(this,aV),NW(this,lV),NW(this,sV),NW(this,rV),NW(this,iV),NW(this,nV),NW(this,oV),NW(this,eV),NW(this,tV),NW(this,ZW),WW(this,qW,{writable:!0,value:!1}),WW(this,QW,{writable:!0,value:!1}),WW(this,JW,{writable:!0,value:[["valuesUpdated",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return $W(t,wV,BV).call(t,...o)}],["namedExpressionAdded",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return $W(t,vV,zV).call(t,...o)}],["namedExpressionRemoved",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return $W(t,CV,UV).call(t,...o)}],["sheetAdded",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return $W(t,yV,$V).call(t,...o)}],["sheetRenamed",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return $W(t,bV,GV).call(t,...o)}],["sheetRemoved",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return $W(t,SV,YV).call(t,...o)}]]}),_W(this,"staticRegister",Rn("formulas")),_W(this,"engine",null),_W(this,"sheetName",null),_W(this,"indexSyncer",null),_W(this,"rowAxisSyncer",null),_W(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return GW}static get PLUGIN_PRIORITY(){return KW}static get SETTING_KEYS(){return[GW,...YW]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[GW]}enablePlugin(){var t,e=this;if(!this.enabled)if(this.engine=null!==(t=VD(this.hot))&&void 0!==t?t:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const t=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==t&&(this.sheetName=t)}this.addHook("beforeLoadData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,eV,MV).call(e,...o)})),this.addHook("afterLoadData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,nV,xV).call(e,...o)})),this.addHook("beforeUpdateData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,eV,MV).call(e,...o)})),this.addHook("afterUpdateData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,nV,xV).call(e,...o)})),this.addHook("modifyData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,iV,kV).call(e,...o)})),this.addHook("modifySourceData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,rV,IV).call(e,...o)})),this.addHook("beforeValidate",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,ZW,EV).call(e,...o)})),this.addHook("afterSetSourceDataAtCell",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,lV,OV).call(e,...o)})),this.addHook("afterSetDataAtCell",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,sV,AV).call(e,...o)})),this.addHook("afterSetDataAtRowProp",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,sV,AV).call(e,...o)})),this.addHook("beforeCreateRow",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,aV,PV).call(e,...o)})),this.addHook("beforeCreateCol",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,hV,NV).call(e,...o)})),this.addHook("afterCreateRow",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,dV,DV).call(e,...o)})),this.addHook("afterCreateCol",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,gV,WV).call(e,...o)})),this.addHook("beforeRemoveRow",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,cV,_V).call(e,...o)})),this.addHook("beforeRemoveCol",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,uV,LV).call(e,...o)})),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,fV,VV).call(e,...o)})),this.addHook("afterRemoveCol",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,mV,FV).call(e,...o)})),this.indexSyncer=new PW(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(t=>{this.hot.addHookOnce("init",(()=>{t()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",((t,e,o,n)=>{this.rowAxisSyncer.storeMovesInformation(t,e,n)})),this.hot.addHook("beforeColumnMove",((t,e,o,n)=>{this.columnAxisSyncer.storeMovesInformation(t,e,n)})),this.hot.addHook("afterRowMove",((t,e,o,n,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(n,i)})),this.hot.addHook("afterColumnMove",((t,e,o,n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(n,i)})),this.hot.addHook("beforeColumnFreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart,e)})),this.hot.addHook("afterColumnFreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.hot.addHook("beforeColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart-1,e)})),this.hot.addHook("afterColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.addHook("afterCellMetaReset",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,oV,HV).call(e,...o)})),this.addHook("beforeUndo",(()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()})),this.addHook("beforeRedo",(()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,pV,jV).call(e,...o)})),this.addHook("beforeAutofill",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return $W(e,tV,TV).call(e,...o)})),BW(this,JW).forEach((t=>{let[e,o]=t;return this.engine.on(e,o)})),super.enablePlugin()}else hn("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){BW(this,JW).forEach((t=>{let[e,o]=t;return this.engine.off(e,o)})),BD(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(t){const e=_D(this.hot.getSettings());LD(this.engine.getConfig(),e)&&this.engine.updateConfig(e);const o=this.hot.getSettings()[GW];if(U(o)&&U(o.sheetName)&&o.sheetName!==this.sheetName&&this.switchSheet(o.sheetName),!t.data&&null===this.sheetName){const t=this.hot.getSettings()[GW].sheetName;t&&this.engine.doesSheetExist(t)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!==t&&void 0!==t?t:void 0,this.hot.getSourceDataArray())}super.updatePlugin(t)}destroy(){BW(this,JW).forEach((t=>{var e;let[o,n]=t;return null===(e=this.engine)||void 0===e?void 0:e.off(o,n)})),FW(this,JW,null),BD(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(t,e){if(U(e)&&!$c(e))return hn("The provided data should be an array of arrays."),!1;if(void 0!==t&&null!==t&&this.engine.doesSheetExist(t))return hn("Sheet with the provided name already exists."),!1;try{const o=this.engine.addSheet(null!==t&&void 0!==t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(o),e),o}catch(o){return hn(o.message),!1}}switchSheet(t){if(!this.engine.doesSheetExist(t))return void cn(`The sheet named \`${t}\` does not exist, switch aborted.`);this.sheetName=t;const e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,`${lt(GW)}.switchSheet`)}getCellType(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const n=this.hot.toPhysicalRow(t),i=this.hot.toPhysicalColumn(e);return null!==n&&null!==i?this.engine.getCellType({sheet:o,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)}):"EMPTY"}isFormulaCellType(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:o,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)})}renderDependentSheets(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=new Set;t.forEach((t=>{var e;const n=null===t||void 0===t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0!==n&&(o.has(n)||o.add(n))})),jD(this.engine).forEach(((t,n)=>{var i;(e||n!==this.sheetId)&&o.has(n)&&(t.render(),null===(i=t.view)||void 0===i||i.adjustElementsSize())}))}validateDependentCells(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=t=>{var e;const{row:o,col:n,sheet:i}=null!==(e=null===t||void 0===t?void 0:t.address)&&void 0!==e?e:{};return U(i)?`${i}:${o}x${n}`:""},n=new Set(e.map((t=>o(t))));t.forEach((t=>{var e,i;const{row:r,col:s}=null!==(e=t.address)&&void 0!==e?e:{};if(!1===U(r)||!1===U(s)||r>=this.hot.countRows()||s>=this.hot.countCols())return;const l=null===t||void 0===t||null===(i=t.address)||void 0===i?void 0:i.sheet,a=o(t);if(void 0!==l&&!n.has(a)){const t=jD(this.engine).get(l);if(!t)return;t.validateCell(t.getDataAtCell(r,s),t.getCellMeta(r,s),(()=>{}))}}))}syncChangeWithEngine(t,e,o){const n={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(n))return void hn(`Not possible to set cell data at ${JSON.stringify(n)}`);const i=this.hot.getCellMeta(t,e);return QD(o,i.type)&&(JD(o,i.dateFormat)?o=ZD(o,i.dateFormat):!1===qD(o)&&(o=`'${o}`)),this.engine.setCellContents(n,o)}}function EV(t,e,o){const n=this.hot.propToCol(o);if(this.isFormulaCellType(e,n)){const t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},o=this.hot.getCellMeta(e,n);let i=this.engine.getCellValue(t);return"date"===o.type&&Ai(i)&&(i=eW(i,o.dateFormat)),"object"===typeof i&&null!==i?i.value:i}return t}function TV(t,e,o){const{row:n,col:i}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),{row:l,col:a}=o.getTopStartCorner(),{row:h,col:c}=o.getBottomEndCorner(),u={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(d))return!1;const g=this.engine.getFillRangeData(u,d),{row:f,col:m}=u.start,{row:p,col:w}=u.end,v=p-f+1,C=w-m+1;for(let y=0;y<g.length;y+=1)for(let t=0;t<g[y].length;t+=1){const e=g[y][t],o=y%v,n=t%C,i=this.hot.getCellMeta(o,n);QD(e,i.type)&&(e.startsWith("'")?g[y][t]=e.slice(1):!1===this.isFormulaCellType(o,n,this.sheetId)&&(g[y][t]=tW(e,i.dateFormat)))}return g}function MV(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";o.includes(lt(GW))||FW(this,QW,$(this.hot.getSettings().data))}function HV(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach(((o,n)=>{o.forEach(((o,i)=>{const r=this.hot.getCellMeta(n,i),s=r.dateFormat;QD(o,r.type)&&(e=!0,JD(o,s)?t[n][i]=ZD(o,s):!1===this.isFormulaCellType(n,i)&&(t[n][i]=`'${o}`))}))})),!0===e&&(FW(this,qW,!0),this.engine.setSheetContent(this.sheetId,t),FW(this,qW,!1))}function xV(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!o.includes(lt(GW)))if(this.sheetName=GD(this.engine,this.hot.getSettings()[GW].sheetName),BW(this,QW))this.switchSheet(this.sheetName);else{const t=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,t)){FW(this,qW,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),FW(this,qW,!1)}}}function kV(t,e,o,n){if("get"!==n||BW(this,qW)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(null===i||null===e)return;const r=this.isFormulaCellType(i,e);if(!r){const t=this.getCellType(i,e);if("ARRAY"!==t)return void(KD(o.value)&&(o.value=XD(o.value)))}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let l=this.engine.getCellValue(s);const a=this.hot.getCellMeta(i,e);"date"===a.type&&Ai(l)&&(l=eW(l,a.dateFormat));const h="object"===typeof l&&null!==l?l.value:l;o.value=h}function IV(t,e,o,n){if("get"!==n||BW(this,qW)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),r=this.hot.propToCol(e);if(null===i||null===r)return;const s=this.isFormulaCellType(i,r);if(!s){const t=this.getCellType(i,r);if("ARRAY"!==t)return}const l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===l.width&&0===l.height)return;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};o.value=this.engine.getCellSerialized(a)}function AV(t,e){if(XW(e))return;const o=[],n=[],i=this.engine.batch((()=>{t.forEach((t=>{let[e,i,,r]=t;const s=this.hot.propToCol(i),l=this.hot.toPhysicalRow(e),a=this.hot.toPhysicalColumn(s),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};null!==l&&null!==a?this.syncChangeWithEngine(e,s,r):o.push([e,s,r]),n.push({address:h})}))}));o.length&&this.hot.addHookOnce("afterChange",(()=>{const t=this.engine.batch((()=>{o.forEach((t=>{let[e,o,n]=t;this.syncChangeWithEngine(e,o,n)}))}));this.renderDependentSheets(t,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,n)}function OV(t,e){if(XW(e))return;const o=[],n=[];t.forEach((t=>{let[e,i,,r]=t;const s=this.hot.propToCol(i);if(!Ai(s))return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(l)?(n.push({address:l}),o.push(...this.engine.setCellContents(l,r))):hn(`Not possible to set source cell data at ${JSON.stringify(l)}`)})),this.renderDependentSheets(o),this.validateDependentCells(o,n)}function PV(t,e){let o=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(o=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[o,e]))return!1}function NV(t,e){let o=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(o=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[o,e]))return!1}function _V(t,e,o){const n=this.rowAxisSyncer.setRemovedHfIndexes(o),i=n.every((t=>this.engine.isItPossibleToRemoveRows(this.sheetId,[t,1])));return!1!==i&&void 0}function LV(t,e,o){const n=this.columnAxisSyncer.setRemovedHfIndexes(o),i=n.every((t=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[t,1])));return!1!==i&&void 0}function DV(t,e,o){if(XW(o))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function WV(t,e,o){if(XW(o))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function VV(t,e,o,n){if(XW(n))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),r=this.engine.batch((()=>{i.forEach((t=>{this.engine.removeRows(this.sheetId,[t,1])}))}));this.renderDependentSheets(r)}function FV(t,e,o,n){if(XW(n))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),r=this.engine.batch((()=>{i.forEach((t=>{this.engine.removeColumns(this.sheetId,[t,1])}))}));this.renderDependentSheets(r)}function jV(t,e,o){var n;FW(this,qW,!0);const i=this.hot.getSourceDataArray(o,0,o+((null===(n=e.__children)||void 0===n?void 0:n.length)||0),this.hot.countSourceCols());FW(this,qW,!1),i.forEach(((t,e)=>{t.forEach(((t,n)=>{this.engine.setCellContents({col:n,row:o+e,sheet:this.sheetId},[[t]])}))}))}function BV(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function zV(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function UV(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function $V(t){this.hot.runHooks("afterSheetAdded",t)}function GV(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function YV(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function KV(t){return{key:"hidden_columns_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[,o,,n]=t;o-n!==0&&(e=1)}return this.getTranslatedPhrase(tg,e)},callback(){const{from:e,to:o}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,o.col),0),i=Math.max(e.col,o.col),r=[];for(let t=n;t<=i;t+=1)r.push(t);t.hideColumns(r);const s=r[r.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function XV(t){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(eg,t)},callback(){var o,n;if(0===e.length)return;let i=e[0],r=e[e.length-1];i=null!==(o=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==o?o:0,r=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==n?n:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0);const s=r-i+1===this.countCols();s||this.selectColumns(i,r)},disabled:!1,hidden(){const o=I(t.getHiddenColumns(),(t=>this.toPhysicalColumn(t)));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||o.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().col,r=n.getBottomEndCorner().col,s=this.columnIndexMapper,l=s.getRenderableFromVisualIndex(i),a=s.getRenderableFromVisualIndex(r),h=s.getNotTrimmedIndexes(),c=[];if(i!==r){const t=r-i+1,e=a-l+1;if(t>e){const t=h.slice(i,r+1);c.push(...t.filter((t=>o.includes(t))))}}else if(0===l&&l<i)c.push(...h.slice(0,i));else if(null===l)c.push(...h.slice(0,this.countCols()));else{const t=this.countCols()-1,e=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1));a===e&&t>r&&c.push(...h.slice(r+1))}return A(c,(t=>{e.push(this.toVisualColumn(t))})),0===e.length}}}function qV(t,e){JV(t,e),e.add(t)}function QV(t,e,o){JV(t,e),e.set(t,o)}function JV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZV(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function tF(t,e){var o=nF(t,e,"get");return eF(t,o)}function eF(t,e){return e.get?e.get.call(t):e.value}function oF(t,e,o){var n=nF(t,e,"set");return iF(t,n,o),o}function nF(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function iF(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}bn.getSingleton().register("beforeHideColumns"),bn.getSingleton().register("afterHideColumns"),bn.getSingleton().register("beforeUnhideColumns"),bn.getSingleton().register("afterUnhideColumns");const rF="hiddenColumns",sF=310,lF="beforeHiddenColumnIndicator",aF="afterHiddenColumnIndicator";var hF=new WeakMap,cF=new WeakMap,uF=new WeakSet,dF=new WeakSet,gF=new WeakSet,fF=new WeakSet,mF=new WeakSet,pF=new WeakSet,wF=new WeakSet;class vF extends fS{constructor(){super(...arguments),qV(this,wF),qV(this,pF),qV(this,mF),qV(this,fF),qV(this,gF),qV(this,dF),qV(this,uF),QV(this,hF,{writable:!0,value:{}}),QV(this,cF,{writable:!0,value:null})}static get PLUGIN_KEY(){return rF}static get PLUGIN_PRIORITY(){return sF}isEnabled(){return!!this.hot.getSettings()[rF]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[rF];Eo(e)&&(oF(this,hF,e),$(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),oF(this,cF,new gu),tF(this,cF).addLocalHook("init",(()=>ZV(this,wF,TF).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,tF(this,cF)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return ZV(t,pF,EF).call(t,...o)})),this.addHook("afterGetCellMeta",((t,e,o)=>ZV(this,gF,bF).call(this,t,e,o))),this.addHook("modifyColWidth",((t,e)=>ZV(this,dF,yF).call(this,t,e))),this.addHook("afterGetColHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return ZV(t,mF,RF).call(t,...o)})),this.addHook("modifyCopyableRange",(t=>ZV(this,fF,SF).call(this,t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const t=(t,e)=>{ZV(this,uF,CF).call(this,e)};this.hot.columnIndexMapper.unregisterMap(this.pluginName),oF(this,hF,{}),this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetColHeader",t)})),super.disablePlugin(),this.resetCellsMeta()}showColumns(t){const e=this.getHiddenColumns(),o=this.isValidConfig(t);let n=e;const i=tF(this,cF).getValues().slice(),r=t.length>0;if(o&&r){const e=t.map((t=>this.hot.toPhysicalColumn(t)));A(e,(t=>{i[t]=!1})),n=x(i,((t,e,o)=>(e&&t.push(this.hot.toVisualColumn(o)),t)),[])}const s=this.hot.runHooks("beforeUnhideColumns",e,n,o&&r);!1!==s&&(o&&r&&tF(this,cF).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",e,n,o&&r,o&&n.length<e.length))}showColumn(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.showColumns(e)}hideColumns(t){const e=this.getHiddenColumns(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t))));const i=this.hot.runHooks("beforeHideColumns",e,n,o);!1!==i&&(o&&this.hot.batchExecution((()=>{A(t,(t=>{tF(this,cF).setValueAtIndex(this.hot.toPhysicalColumn(t),!0)}))}),!0),this.hot.runHooks("afterHideColumns",e,n,o,o&&n.length>e.length))}hideColumn(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.hideColumns(e)}getHiddenColumns(){return I(tF(this,cF).getHiddenIndexes(),(t=>this.hot.toVisualColumn(t)))}isHidden(t){return tF(this,cF).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}isValidConfig(t){const e=this.hot.countCols();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){A(this.hot.getCellsMeta(),(t=>{t&&(t.skipColumnOnPaste=!1)}))}destroy(){oF(this,hF,null),oF(this,cF,null),super.destroy()}}function CF(t){Array.from(t.querySelectorAll(`.${aF}, .${lF}`)).forEach((t=>{t.remove()}))}function yF(t,e){return this.isHidden(e)?0:tF(this,hF).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"===typeof t&&this.hot.hasColHeaders()?t+15:void 0}function bF(t,e,o){if(!1===tF(this,hF).copyPasteEnabled&&this.isHidden(e)&&(o.skipColumnOnPaste=!0),this.isHidden(e-1))o.className=o.className||"",-1===o.className.indexOf("afterHiddenColumn")&&(o.className+=" afterHiddenColumn");else if(o.className){const t=o.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenColumn");e>-1&&t.splice(e,1),o.className=t.join(" ")}}}function SF(t){if(tF(this,hF).copyPasteEnabled)return t;const e=[],o=(t,o,n,i)=>{e.push({startRow:t,endRow:o,startCol:n,endCol:i})};return A(t,(t=>{let e=!0,n=0;Pi(t.startCol,t.endCol,(i=>{this.isHidden(i)?(e||o(t.startRow,t.endRow,n,i-1),e=!0):(e&&(n=i),i===t.endCol&&o(t.startRow,t.endRow,n,i),e=!1)}))})),e}function RF(t,e){const o=this.hot.getSettings().ariaTags,n=e.querySelector(".beforeHiddenColumnIndicator"),i=e.querySelector(".afterHiddenColumnIndicator");if(!tF(this,hF).indicators||t<0)return null===n||void 0===n||n.remove(),void(null===i||void 0===i||i.remove());const r=[];if(t>=1&&this.isHidden(t-1)){if(!i){const t=o?[It(this.hot.getTranslatedPhrase(Xg))]:[];ro(e,{tagName:"div",attributes:t,className:aF})}r.push("afterHiddenColumn")}if(t<this.hot.countCols()-1&&this.isHidden(t+1)){if(!n){const t=o?[It(this.hot.getTranslatedPhrase(Kg))]:[];ro(e,{tagName:"div",attributes:t,className:lF})}r.push("beforeHiddenColumn")}de(e,r)}function EF(t){t.items.push({name:AM},KV(this),XV(this))}function TF(){Array.isArray(tF(this,hF).columns)&&this.hideColumns(tF(this,hF).columns)}function MF(t){return{key:"hidden_rows_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[o,,n]=t;o-n!==0&&(e=1)}return this.getTranslatedPhrase(og,e)},callback(){const{from:e,to:o}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,o.row),0),i=Math.max(e.row,o.row),r=[];for(let t=n;t<=i;t+=1)r.push(t);t.hideRows(r);const s=r[r.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function HF(t){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(ng,t)},callback(){var o,n;if(0===e.length)return;let i=e[0],r=e[e.length-1];i=null!==(o=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==o?o:0,r=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==n?n:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0);const s=r-i+1===this.countRows();s||this.selectRows(i,r)},disabled:!1,hidden(){const o=I(t.getHiddenRows(),(t=>this.toPhysicalRow(t)));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||o.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().row,r=n.getBottomEndCorner().row,s=this.rowIndexMapper,l=s.getRenderableFromVisualIndex(i),a=s.getRenderableFromVisualIndex(r),h=s.getNotTrimmedIndexes(),c=[];if(i!==r){const t=r-i+1,e=a-l+1;if(t>e){const t=h.slice(i,r+1);c.push(...t.filter((t=>o.includes(t))))}}else if(0===l&&l<i)c.push(...h.slice(0,i));else if(null===l)c.push(...h.slice(0,this.countRows()));else{const t=this.countRows()-1,e=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1));a===e&&t>r&&c.push(...h.slice(r+1))}return A(c,(t=>{e.push(this.toVisualRow(t))})),0===e.length}}}function xF(t,e){IF(t,e),e.add(t)}function kF(t,e,o){IF(t,e),e.set(t,o)}function IF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AF(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function OF(t,e){var o=_F(t,e,"get");return PF(t,o)}function PF(t,e){return e.get?e.get.call(t):e.value}function NF(t,e,o){var n=_F(t,e,"set");return LF(t,n,o),o}function _F(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function LF(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}bn.getSingleton().register("beforeHideRows"),bn.getSingleton().register("afterHideRows"),bn.getSingleton().register("beforeUnhideRows"),bn.getSingleton().register("afterUnhideRows");const DF="hiddenRows",WF=320,VF="afterHiddenRowIndicator",FF="beforeHiddenRowIndicator";var jF=new WeakMap,BF=new WeakMap,zF=new WeakSet,UF=new WeakSet,$F=new WeakSet,GF=new WeakSet,YF=new WeakSet,KF=new WeakSet,XF=new WeakSet;class qF extends fS{constructor(){super(...arguments),xF(this,XF),xF(this,KF),xF(this,YF),xF(this,GF),xF(this,$F),xF(this,UF),xF(this,zF),kF(this,jF,{writable:!0,value:{}}),kF(this,BF,{writable:!0,value:null})}static get PLUGIN_KEY(){return DF}static get PLUGIN_PRIORITY(){return WF}isEnabled(){return!!this.hot.getSettings()[DF]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[DF];Eo(e)&&(NF(this,jF,e),$(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),NF(this,BF,new gu),OF(this,BF).addLocalHook("init",(()=>AF(this,XF,nj).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,OF(this,BF)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AF(t,KF,oj).call(t,...o)})),this.addHook("afterGetCellMeta",((t,e,o)=>AF(this,$F,ZF).call(this,t,e,o))),this.addHook("modifyRowHeight",((t,e)=>AF(this,UF,JF).call(this,t,e))),this.addHook("afterGetRowHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return AF(t,YF,ej).call(t,...o)})),this.addHook("modifyCopyableRange",(t=>AF(this,GF,tj).call(this,t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const t=(t,e)=>{AF(this,zF,QF).call(this,e)};this.hot.rowIndexMapper.unregisterMap(this.pluginName),NF(this,jF,{}),this.hot.addHook("afterGetRowHeader",t),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetRowHeader",t)})),super.disablePlugin(),this.resetCellsMeta()}showRows(t){const e=this.getHiddenRows(),o=this.isValidConfig(t);let n=e;const i=OF(this,BF).getValues().slice(),r=t.length>0;if(o&&r){const e=t.map((t=>this.hot.toPhysicalRow(t)));A(e,(t=>{i[t]=!1})),n=x(i,((t,e,o)=>(e&&t.push(this.hot.toVisualRow(o)),t)),[])}const s=this.hot.runHooks("beforeUnhideRows",e,n,o&&r);!1!==s&&(o&&r&&OF(this,BF).setValues(i),this.hot.runHooks("afterUnhideRows",e,n,o&&r,o&&n.length<e.length))}showRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.showRows(e)}hideRows(t){const e=this.getHiddenRows(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t))));const i=this.hot.runHooks("beforeHideRows",e,n,o);!1!==i&&(o&&this.hot.batchExecution((()=>{A(t,(t=>{OF(this,BF).setValueAtIndex(this.hot.toPhysicalRow(t),!0)}))}),!0),this.hot.runHooks("afterHideRows",e,n,o,o&&n.length>e.length))}hideRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.hideRows(e)}getHiddenRows(){return I(OF(this,BF).getHiddenIndexes(),(t=>this.hot.toVisualRow(t)))}isHidden(t){return OF(this,BF).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}isValidConfig(t){const e=this.hot.countRows();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){A(this.hot.getCellsMeta(),(t=>{t&&(t.skipRowOnPaste=!1)}))}destroy(){NF(this,jF,null),NF(this,BF,null),super.destroy()}}function QF(t){Array.from(t.querySelectorAll(`.${VF}, .${FF}`)).forEach((t=>{t.remove()}))}function JF(t,e){return this.isHidden(e)?0:t}function ZF(t,e,o){if(!1===OF(this,jF).copyPasteEnabled&&this.isHidden(t)&&(o.skipRowOnPaste=!0),this.isHidden(t-1))o.className=o.className||"",-1===o.className.indexOf("afterHiddenRow")&&(o.className+=" afterHiddenRow");else if(o.className){const t=o.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenRow");e>-1&&t.splice(e,1),o.className=t.join(" ")}}}function tj(t){if(OF(this,jF).copyPasteEnabled)return t;const e=[],o=(t,o,n,i)=>{e.push({startRow:t,endRow:o,startCol:n,endCol:i})};return A(t,(t=>{let e=!0,n=0;Pi(t.startRow,t.endRow,(i=>{this.isHidden(i)?(e||o(n,i-1,t.startCol,t.endCol),e=!0):(e&&(n=i),i===t.endRow&&o(n,i,t.startCol,t.endCol),e=!1)}))})),e}function ej(t,e){const o=this.hot.getSettings().ariaTags,n=e.querySelector(".beforeHiddenRowIndicator"),i=e.querySelector(".afterHiddenRowIndicator");if(!OF(this,jF).indicators||t<0)return null===n||void 0===n||n.remove(),void(null===i||void 0===i||i.remove());const r=[];if(t>=1&&this.isHidden(t-1)){if(!i){const t=o?[It(this.hot.getTranslatedPhrase(tf))]:[];ro(e,{tagName:"div",attributes:t,className:VF})}r.push("afterHiddenRow")}if(t<this.hot.countRows()-1&&this.isHidden(t+1)){if(!n){const t=o?[It(this.hot.getTranslatedPhrase(Zg))]:[];ro(e,{tagName:"div",attributes:t,className:FF})}r.push("beforeHiddenRow")}de(e,r)}function oj(t){t.items.push({name:AM},MF(this),HF(this))}function nj(){Array.isArray(OF(this,jF).rows)&&this.hideRows(OF(this,jF).rows)}function ij(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(Id)},callback(e,o){const[{start:{col:n}}]=o;t.freezeColumn(n),this.render(),this.view.adjustElementsSize(!0)},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}}function rj(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Ad)},callback(e,o){const[{start:{col:n}}]=o;t.unfreezeColumn(n),this.render(),this.view.adjustElementsSize(!0)},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}}function sj(t,e){aj(t,e),e.add(t)}function lj(t,e,o){aj(t,e),e.set(t,o)}function aj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hj(t,e){var o=dj(t,e,"get");return cj(t,o)}function cj(t,e){return e.get?e.get.call(t):e.value}function uj(t,e,o){var n=dj(t,e,"set");return gj(t,n,o),o}function dj(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function gj(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function fj(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}bn.getSingleton().register("beforeColumnFreeze"),bn.getSingleton().register("afterColumnFreeze"),bn.getSingleton().register("beforeColumnUnfreeze"),bn.getSingleton().register("afterColumnUnfreeze");const mj="manualColumnFreeze",pj=110;var wj=new WeakMap,vj=new WeakSet,Cj=new WeakSet;class yj extends fS{constructor(){super(...arguments),sj(this,Cj),sj(this,vj),lj(this,wj,{writable:!0,value:!1})}static get PLUGIN_KEY(){return mj}static get PLUGIN_PRIORITY(){return pj}isEnabled(){return!!this.hot.getSettings()[mj]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>fj(this,vj,bj).call(this,t))),this.addHook("beforeColumnMove",((t,e)=>fj(this,Cj,Sj).call(this,t,e))),super.enablePlugin())}disablePlugin(){uj(this,wj,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(t){const e=this.hot.getSettings(),o=e.fixedColumnsStart<this.hot.countCols()&&t>e.fixedColumnsStart-1;hj(this,wj)||uj(this,wj,!0);const n=this.hot.runHooks("beforeColumnFreeze",t,o);!1!==n&&(o&&(this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart),e._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,o))}unfreezeColumn(t){const e=this.hot.getSettings(),o=e.fixedColumnsStart>0&&t<=e.fixedColumnsStart-1;hj(this,wj)||uj(this,wj,!0);const n=this.hot.runHooks("beforeColumnUnfreeze",t,o);!1!==n&&(o&&(e._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,o))}}function bj(t){t.items.push({name:"---------"},ij(this),rj(this))}function Sj(t,e){if(hj(this,wj)){const o=this.hot.getSettings().fixedColumnsStart;if(e<o)return!1;if(t.some((t=>t<o)))return!1}}function Rj(t,e,o){return e=Ej(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ej(t){var e=Tj(t,"string");return"symbol"===typeof e?e:String(e)}function Tj(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Mj=0,Hj=1,xj=2,kj="px";class Ij{constructor(t){Rj(this,"hot",void 0),Rj(this,"_element",null),Rj(this,"state",Mj),Rj(this,"inlineProperty",void 0),this.hot=t,this.inlineProperty=t.isRtl()?"right":"left"}appendTo(t){t.appendChild(this._element),this.state=xj}build(){this.state===Mj&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Hj)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Mj}isAppended(){return this.state===xj}isBuilt(){return this.state>=Hj}setPosition(t,e){Ai(t)&&(this._element.style.top=t+kj),Ai(e)&&(this._element.style[this.inlineProperty]=e+kj)}getPosition(){const t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}setSize(t,e){Ai(t)&&(this._element.style.width=t+kj),Ai(e)&&(this._element.style.height=e+kj)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){Ai(t)&&(this._element.style.marginTop=t+kj),Ai(e)&&(this._element.style[`margin${lt(this.inlineProperty)}`]=e+kj)}getOffset(){const t=this._element.style,e=`margin${lt(this.inlineProperty)}`;return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[e]?parseInt(t[e],10):0}}}var Aj=Ij;const Oj="ht__manualColumnMove--backlight";class Pj extends Aj{build(){super.build(),de(this._element,Oj)}}var Nj=Pj;const _j="ht__manualColumnMove--guideline";class Lj extends Aj{build(){super.build(),de(this._element,_j)}}var Dj=Lj;function Wj(t,e){Fj(t,e),e.add(t)}function Vj(t,e,o){Fj(t,e),e.set(t,o)}function Fj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jj(t,e,o){return e=Bj(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Bj(t){var e=zj(t,"string");return"symbol"===typeof e?e:String(e)}function zj(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Uj(t,e,o){var n=Yj(t,e,"set");return $j(t,n,o),o}function $j(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function Gj(t,e){var o=Yj(t,e,"get");return Kj(t,o)}function Yj(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Kj(t,e){return e.get?e.get.call(t):e.value}function Xj(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}bn.getSingleton().register("beforeColumnMove"),bn.getSingleton().register("afterColumnMove");const qj="manualColumnMove",Qj=120,Jj="ht__manualColumnMove",Zj="show-ui",tB="on-moving--columns",eB="after-selection--columns";var oB=new WeakMap,nB=new WeakMap,iB=new WeakMap,rB=new WeakMap,sB=new WeakMap,lB=new WeakMap,aB=new WeakMap,hB=new WeakMap,cB=new WeakMap,uB=new WeakSet,dB=new WeakSet,gB=new WeakSet,fB=new WeakSet,mB=new WeakSet,pB=new WeakSet;class wB extends fS{constructor(){super(...arguments),Wj(this,pB),Wj(this,mB),Wj(this,fB),Wj(this,gB),Wj(this,dB),Wj(this,uB),jj(this,"backlight",new Nj(this.hot)),jj(this,"guideline",new Dj(this.hot)),Vj(this,oB,{writable:!0,value:[]}),Vj(this,nB,{writable:!0,value:0}),Vj(this,iB,{writable:!0,value:!1}),Vj(this,rB,{writable:!0,value:{}}),Vj(this,sB,{writable:!0,value:void 0}),Vj(this,lB,{writable:!0,value:void 0}),Vj(this,aB,{writable:!0,value:void 0}),Vj(this,hB,{writable:!0,value:void 0}),Vj(this,cB,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return qj}static get PLUGIN_PRIORITY(){return Qj}isEnabled(){return!!this.hot.getSettings()[qj]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Xj(t,uB,vB).call(t,...o)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Xj(t,gB,yB).call(t,...o)})),this.addHook("afterScrollVertically",(()=>Xj(this,mB,SB).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Xj(t,pB,RB).call(t,...o)})),this.buildPluginUI(),this.registerEvents(),de(this.hot.rootElement,Jj),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ge(this.hot.rootElement,Jj),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(t,e){return this.moveColumns([t],e)}moveColumns(t,e){const o=Gj(this,sB),n=this.isMovePossible(t,e),i=this.hot.runHooks("beforeColumnMove",t,e,o,n);if(Uj(this,sB,void 0),!1===i)return;n&&this.hot.columnIndexMapper.moveIndexes(t,e);const r=n&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,o,n,r),r}dragColumn(t,e){return this.dragColumns([t],e)}dragColumns(t,e){const o=this.countFinalIndex(t,e);return Uj(this,sB,e),this.moveColumns(t,o)}isMovePossible(t,e){const o=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),n=t.length+e>o,i=e<0,r=t.some((t=>t<0)),s=t.some((t=>t>=o));return!(n||i||r||s)}isColumnOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}countFinalIndex(t,e){const o=x(t,((t,o)=>(o<e&&(t+=1),t)),0);return e-o}getColumnsWidth(t,e){const o=this.hot.columnIndexMapper;let n=0;for(let i=t;i<=e;i+=1){const t=o.getRenderableFromVisualIndex(i);i<0?n+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==t&&(n+=this.hot.view._wt.wtTable.getStretchedColumnWidth(t)||0)}return n}moveBySettingsOrLoad(){const t=this.hot.getSettings()[qj];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(t){return t<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}prepareColumnsToMoving(t,e){const o=[];return Pi(t,e,(t=>{o.push(t)})),o}refreshPositions(){const t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Gj(this,lB))&&t>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1)});const e=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtOverlays.scrollableElement,n="number"===typeof o.scrollX?o.scrollX:o.scrollLeft;let i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Gj(this,lB)-1);const r=e.hider.offsetWidth,s=e.TBODY.offsetLeft,l=this.backlight.getOffset().start,a=this.backlight.getSize().width;let h=0,c=0;if(this.hot.isRtl()){const t=this.hot.rootWindow,e=Oe(this.hot.rootElement),i=t.innerWidth-Gj(this,aB)-e;c=t.innerWidth-Gj(this,rB).eventPageX-i-(void 0===o.scrollX?n:0)}else c=Gj(this,rB).eventPageX-(Gj(this,aB)-(void 0===o.scrollX?n:0));if(Gj(this,hB)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Gj(this,lB))&&(i+=n),i+=h,Gj(this,lB)<0)Gj(this,cB)>0?Gj(this,rB).col=0:Gj(this,rB).col=t>0?t-1:t;else if(Gj(this,rB).TD.offsetWidth/2+i<=c){const t=Gj(this,lB)>=Gj(this,nB)?Gj(this,nB)-1:Gj(this,lB);Gj(this,rB).col=t+1,i+=Gj(this,rB).TD.offsetWidth}else Gj(this,rB).col=Gj(this,lB);let u=c,d=i;c+a+l>=r?u=r-a-l:c+l<s+h&&(u=s+h+Math.abs(l)),i>=r-1?d=r-1:0===d?d=1:void 0!==o.scrollX&&Gj(this,lB)<Gj(this,cB)&&(d-=Gj(this,aB)<=o.scrollX?Gj(this,aB):0),this.backlight.setPosition(null,u),this.guideline.setPosition(null,d)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>Xj(this,dB,CB).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>Xj(this,fB,bB).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){this.backlight.build(),this.guideline.build()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}function vB(t,e,o,n){const i=this.hot.view._wt.wtTable,r=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),l=ue(t.target,"sortAction");if(!s||!r||Gj(this,iB)||0!==t.button||l)return Uj(this,iB,!1),Gj(this,oB).length=0,void ge(this.hot.rootElement,[tB,Zj]);const a=this.guideline.isBuilt()&&!this.guideline.isAppended(),h=this.backlight.isBuilt()&&!this.backlight.isAppended();a&&h&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:c,to:u}=s,d=Math.min(c.col,u.col),g=Math.max(c.col,u.col);if(e.row<0&&e.col>=d&&e.col<=g){n.column=!0,Uj(this,iB,!0);const r=o.firstChild?an(t,o.firstChild).x:t.offsetX;Gj(this,rB).eventPageX=t.pageX,Uj(this,lB,e.col),Gj(this,rB).TD=o,Gj(this,rB).col=e.col,Uj(this,oB,this.prepareColumnsToMoving(d,g)),Uj(this,hB,!!this.hot.getSettings().rowHeaders),Uj(this,nB,this.hot.countCols()),Uj(this,cB,this.hot.getSettings().fixedColumnsStart),Uj(this,aB,Se(this.hot.rootElement).left);const s=Gj(this,hB)?-1:0,l=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,a=e.col<Gj(this,cB),h=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),c=Math.abs(r-(this.hot.isRtl()?o.offsetWidth:0)),u=this.getColumnsWidth(d,e.col-1)+c,f=this.getColumnsWidth(s,d-1)+(a?h:0)+u;this.backlight.setPosition(l,f),this.backlight.setSize(this.getColumnsWidth(d,g),i.hider.offsetHeight-l),this.backlight.setOffset(null,-u),de(this.hot.rootElement,tB)}else ge(this.hot.rootElement,eB),Uj(this,iB,!1),Gj(this,oB).length=0}function CB(t){Gj(this,iB)&&(Gj(this,rB).eventPageX=t.pageX,this.refreshPositions())}function yB(t,e,o,n){const i=this.hot.getSelectedRangeLast();i&&Gj(this,iB)&&(Gj(this,oB).indexOf(e.col)>-1?ge(this.hot.rootElement,Zj):de(this.hot.rootElement,Zj),n.row=!0,n.column=!0,n.cell=!0,Uj(this,lB,e.col),Gj(this,rB).TD=o)}function bB(){const t=Gj(this,rB).col,e=Gj(this,oB).length;if(Uj(this,lB,void 0),Uj(this,iB,!1),ge(this.hot.rootElement,[tB,Zj,eB]),this.hot.selection.isSelectedByColumnHeader()&&de(this.hot.rootElement,eB),e<1||void 0===t)return;const o=Gj(this,oB)[0],n=this.hot.toPhysicalColumn(o),i=this.dragColumns(Gj(this,oB),t);if(Gj(this,oB).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const t=this.hot.toVisualColumn(n),o=t+e-1;this.hot.selectColumns(t,o)}}function SB(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,o=t.holder.scrollTop,n=e+o;this.backlight.setPosition(n),this.backlight.setSize(null,t.hider.offsetHeight-n)}function RB(){this.moveBySettingsOrLoad()}function EB(t,e){MB(t,e),e.add(t)}function TB(t,e,o){MB(t,e),e.set(t,o)}function MB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HB(t,e,o){return e=xB(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function xB(t){var e=kB(t,"string");return"symbol"===typeof e?e:String(e)}function kB(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function IB(t,e){var o=PB(t,e,"get");return AB(t,o)}function AB(t,e){return e.get?e.get.call(t):e.value}function OB(t,e,o){var n=PB(t,e,"set");return NB(t,n,o),o}function PB(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function NB(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function _B(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const LB="manualColumnResize",DB=130,WB="manualColumnWidths";var VB=new WeakMap,FB=new WeakSet,jB=new WeakSet,BB=new WeakSet,zB=new WeakSet,UB=new WeakSet,$B=new WeakSet,GB=new WeakSet,YB=new WeakSet,KB=new WeakSet;class XB extends fS{static get PLUGIN_KEY(){return LB}static get PLUGIN_PRIORITY(){return DB}constructor(t){super(t),EB(this,KB),EB(this,YB),EB(this,GB),EB(this,$B),EB(this,UB),EB(this,zB),EB(this,BB),EB(this,jB),EB(this,FB),HB(this,"currentTH",null),HB(this,"currentCol",null),HB(this,"selectedCols",[]),HB(this,"currentWidth",null),HB(this,"newSize",null),HB(this,"startY",null),HB(this,"startWidth",null),HB(this,"startOffset",null),HB(this,"handle",this.hot.rootDocument.createElement("DIV")),HB(this,"guide",this.hot.rootDocument.createElement("DIV")),HB(this,"pressed",null),HB(this,"isTriggeredByRMB",!1),HB(this,"dblclick",0),HB(this,"autoresizeTimeout",null),HB(this,"columnWidthsMap",void 0),TB(this,VB,{writable:!0,value:void 0}),de(this.handle,"manualColumnResizer"),de(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[LB]}enablePlugin(){this.enabled||(this.columnWidthsMap=new du,this.columnWidthsMap.addLocalHook("init",(()=>_B(this,FB,qB).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",((t,e)=>_B(this,GB,oz).call(this,t,e))),this.addHook("beforeStretchingColumnWidth",((t,e)=>_B(this,YB,nz).call(this,t,e))),this.addHook("beforeColumnResize",((t,e,o)=>_B(this,KB,iz).call(this,t,e,o))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){OB(this,VB,this.columnWidthsMap.getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",WB,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const t={};return this.hot.runHooks("persistentStateLoad",WB,t),t.value}setManualSize(t,e){const o=Math.max(e,20),n=this.hot.toPhysicalColumn(t);return this.columnWidthsMap.setValueAtIndex(n,o),o}clearManualSize(t){const e=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(e,null)}setupHandlePosition(t){if(!t.parentNode)return;this.currentTH=t;const{_wt:e}=this.hot.view,o=e.wtTable.getCoords(this.currentTH),n=o.col;if(n<0)return;const i=Pe(this.currentTH),r=this.currentTH.getBoundingClientRect(),s=n<e.getSetting("fixedColumnsStart");let l;s&&(l=e.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),l||(l=e.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),this.selectedCols=[];const a=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&a){const t=this.hot.getSelectedRange();A(t,(t=>{const e=t.getTopStartCorner().col,o=t.getBottomEndCorner().col;Pi(e,o,(t=>{this.selectedCols.includes(t)||this.selectedCols.push(t)}))}))}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=l.start-6,this.startWidth=parseInt(r.width,10),this.handle.style.top=`${l.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${i}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const t=parseInt(Pe(this.handle),10),e=parseInt(this.handle.style.top,10)+t,o=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);de(this.handle,"active"),de(this.guide,"active"),this.guide.style.top=`${e}px`,this.refreshGuidePosition(),this.guide.style.height=o-t+"px",this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){ge(this.handle,"active"),ge(this.guide,"active")}checkIfColumnHeader(t){return!!ie(t,["THEAD"],this.hot.rootElement)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{const n=this.hot.runHooks("beforeColumnResize",this.newSize,e,!0);void 0!==n&&(this.newSize=n),"all"===this.hot.getSettings().stretchH?this.clearManualSize(e):this.setManualSize(e,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,e,!0),o&&t()};if(this.dblclick>=2){const o=this.selectedCols.length;o>1?(A(this.selectedCols,(t=>{e(t)})),t()):A(this.selectedCols,(t=>{e(t,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}bindEvents(){const{rootWindow:t,rootElement:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",(t=>_B(this,jB,QB).call(this,t))),this.eventManager.addEventListener(e,"mousedown",(t=>_B(this,BB,JB).call(this,t))),this.eventManager.addEventListener(t,"mousemove",(t=>_B(this,zB,ZB).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>_B(this,UB,tz).call(this))),this.eventManager.addEventListener(this.handle,"contextmenu",(()=>_B(this,$B,ez).call(this)))}destroy(){super.destroy()}}function qB(){const t=this.hot.getSettings()[LB],e=this.loadManualColumnWidths();"undefined"!==typeof e?this.hot.batchExecution((()=>{e.forEach(((t,e)=>{this.columnWidthsMap.setValueAtIndex(e,t)}))}),!0):Array.isArray(t)?(this.hot.batchExecution((()=>{t.forEach(((t,e)=>{this.columnWidthsMap.setValueAtIndex(e,t)}))}),!0),OB(this,VB,t)):!0===t&&Array.isArray(IB(this,VB))&&this.hot.batchExecution((()=>{IB(this,VB).forEach(((t,e)=>{this.columnWidthsMap.setValueAtIndex(e,t)}))}),!0)}function QB(t){if(!to(t.target)&&!0!==this.isTriggeredByRMB&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const o=e.getAttribute("colspan");!e||null!==o&&"1"!==o||this.pressed||this.setupHandlePosition(e)}}function JB(t){ue(t.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((()=>this.afterMouseDownTimeout()),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=t.pageX,this.newSize=this.startWidth)}function ZB(t){if(this.pressed){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+e,A(this.selectedCols,(t=>{this.newSize=this.setManualSize(t,this.currentWidth)})),this.refreshHandlePosition(),this.refreshGuidePosition()}}function tz(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{this.hot.runHooks("beforeColumnResize",this.newSize,e,!1),o&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,e,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){const o=this.selectedCols.length;o>1?(A(this.selectedCols,(t=>{e(t)})),t()):A(this.selectedCols,(t=>{e(t,!0)}))}this.setupHandlePosition(this.currentTH)}}function ez(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate((()=>{this.isTriggeredByRMB=!1}))}function oz(t,e){let o=t;if(this.enabled){const t=this.hot.toPhysicalColumn(e),n=this.columnWidthsMap.getValueAtIndex(t);this.hot.getSettings()[LB]&&n&&(o=n)}return o}function nz(t,e){let o=this.columnWidthsMap.getValueAtIndex(e);return null===o&&(o=t),o}function iz(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function rz(t,e,o){return e=sz(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function sz(t){var e=lz(t,"string");return"symbol"===typeof e?e:String(e)}function lz(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const az=0,hz=1,cz=2,uz="px";class dz{constructor(t){rz(this,"hot",void 0),rz(this,"_element",null),rz(this,"state",az),this.hot=t}appendTo(t){t.appendChild(this._element),this.state=cz}build(){this.state===az&&(this._element=this.hot.rootDocument.createElement("div"),this.state=hz)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=az}isAppended(){return this.state===cz}isBuilt(){return this.state>=hz}setPosition(t,e){void 0!==t&&(this._element.style.top=t+uz),void 0!==e&&(this._element.style.left=e+uz)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(t,e){t&&(this._element.style.width=t+uz),e&&(this._element.style.height=e+uz)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){t&&(this._element.style.marginTop=t+uz),e&&(this._element.style.marginLeft=e+uz)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}var gz=dz;const fz="ht__manualRowMove--backlight";class mz extends gz{build(){super.build(),de(this._element,fz)}}var pz=mz;const wz="ht__manualRowMove--guideline";class vz extends gz{build(){super.build(),de(this._element,wz)}}var Cz=vz;function yz(t,e){Sz(t,e),e.add(t)}function bz(t,e,o){Sz(t,e),e.set(t,o)}function Sz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rz(t,e,o){return e=Ez(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ez(t){var e=Tz(t,"string");return"symbol"===typeof e?e:String(e)}function Tz(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Mz(t,e,o){var n=kz(t,e,"set");return Hz(t,n,o),o}function Hz(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function xz(t,e){var o=kz(t,e,"get");return Iz(t,o)}function kz(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Iz(t,e){return e.get?e.get.call(t):e.value}function Az(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}bn.getSingleton().register("beforeRowMove"),bn.getSingleton().register("afterRowMove");const Oz="manualRowMove",Pz=140,Nz="ht__manualRowMove",_z="show-ui",Lz="on-moving--rows",Dz="after-selection--rows";var Wz=new WeakMap,Vz=new WeakMap,Fz=new WeakMap,jz=new WeakMap,Bz=new WeakSet,zz=new WeakSet,Uz=new WeakSet,$z=new WeakSet,Gz=new WeakSet,Yz=new WeakSet;class Kz extends fS{constructor(){super(...arguments),yz(this,Yz),yz(this,Gz),yz(this,$z),yz(this,Uz),yz(this,zz),yz(this,Bz),Rz(this,"backlight",new pz(this.hot)),Rz(this,"guideline",new Cz(this.hot)),bz(this,Wz,{writable:!0,value:[]}),bz(this,Vz,{writable:!0,value:void 0}),bz(this,Fz,{writable:!0,value:{}}),bz(this,jz,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Oz}static get PLUGIN_PRIORITY(){return Pz}isEnabled(){return!!this.hot.getSettings()[Oz]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Az(t,Bz,Xz).call(t,...o)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Az(t,Uz,Qz).call(t,...o)})),this.addHook("afterScrollHorizontally",(()=>Az(this,Gz,Zz).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Az(t,Yz,tU).call(t,...o)})),this.buildPluginUI(),this.registerEvents(),de(this.hot.rootElement,Nz),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ge(this.hot.rootElement,Nz),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(t,e){return this.moveRows([t],e)}moveRows(t,e){const o=xz(this,jz),n=this.isMovePossible(t,e),i=this.hot.runHooks("beforeRowMove",t,e,o,n);if(Mz(this,jz,void 0),!1===i)return;n&&this.hot.rowIndexMapper.moveIndexes(t,e);const r=n&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,o,n,r),r}dragRow(t,e){return this.dragRows([t],e)}dragRows(t,e){const o=this.countFinalIndex(t,e);return Mz(this,jz,e),this.moveRows(t,o)}isMovePossible(t,e){const o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),n=t.length+e>o,i=e<0,r=t.some((t=>t<0)),s=t.some((t=>t>=o));return!(n||i||r||s)}isRowOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}countFinalIndex(t,e){const o=x(t,((t,o)=>(o<e&&(t+=1),t)),0);return e-o}getRowsHeight(t,e){const o=this.hot.rowIndexMapper;let n=0;for(let i=t;i<=e;i++){const t=o.getRenderableFromVisualIndex(i);null!==t&&(n+=this.hot.view._wt.wtTable.getRowHeight(t)||23)}return n}moveBySettingsOrLoad(){const t=this.hot.getSettings()[Oz];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(t){return t<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}prepareRowsToMoving(){const t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;const{from:o,to:n}=t,i=Math.min(o.row,n.row),r=Math.max(o.row,n.row);return Pi(i,r,(t=>{e.push(t)})),e}refreshPositions(){const t=xz(this,Fz).coords,e=this.hot.view.getFirstFullyVisibleRow(),o=this.hot.view.getLastFullyVisibleRow(),n=this.hot.countRows();this.isFixedRowTop(t.row)&&e>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(e-1,-1)),this.isFixedRowBottom(t.row)&&o<n&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o+1,1),void 0,!0);const i=this.hot.view._wt.wtTable,r=xz(this,Fz).TD,s=this.hot.rootElement,l=Se(s),a=xe(s),h=i.holder.scrollTop,c=this.hot.rootWindow!==a?a.scrollTop:0,u=l.top-c,d=xz(this,Fz).eventPageY-u+h,g=i.hider.offsetHeight,f=i.TBODY.offsetTop,m=this.backlight.getOffset().top,p=this.backlight.getSize().height,w=r.offsetHeight/2,v=r.offsetHeight;let C=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1);const y=d>=C+w;this.isFixedRowTop(t.row)&&(C+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),t.row<0?xz(this,Fz).row=e>0?e-1:e:y?(xz(this,Fz).row=t.row+1,C+=0===t.row?v-1:v):xz(this,Fz).row=t.row;let b=d,S=C;d+p+m>=g?b=g-p-m:d+m<f&&(b=f+Math.abs(m)),C>=g-1&&(S=g-1),this.backlight.setPosition(b),this.guideline.setPosition(S)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>Az(this,zz,qz).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>Az(this,$z,Jz).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){this.backlight.build(),this.guideline.build()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}function Xz(t,e,o,n){const{wtTable:i,wtViewport:r}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast();if(!l||!s||xz(this,Vz)||0!==t.button)return Mz(this,Vz,!1),xz(this,Wz).length=0,void ge(this.hot.rootElement,[Lz,_z]);const a=this.guideline.isBuilt()&&!this.guideline.isAppended(),h=this.backlight.isBuilt()&&!this.backlight.isAppended();a&&h&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:c,to:u}=l,d=Math.min(c.row,u.row),g=Math.max(c.row,u.row);if(e.col<0&&e.row>=d&&e.row<=g){n.row=!0,Mz(this,Vz,!0),xz(this,Fz).eventPageY=t.pageY,xz(this,Fz).coords=e,xz(this,Fz).TD=o,Mz(this,Wz,this.prepareRowsToMoving());const s=i.holder.scrollLeft+r.getRowHeaderWidth(),l=this.getRowsHeight(d,e.row-1)+t.offsetY;this.backlight.setPosition(null,s),this.backlight.setSize(i.hider.offsetWidth-s,this.getRowsHeight(d,g)),this.backlight.setOffset(-l,null),de(this.hot.rootElement,Lz),this.refreshPositions()}else ge(this.hot.rootElement,Dz),Mz(this,Vz,!1),xz(this,Wz).length=0}function qz(t){xz(this,Vz)&&(xz(this,Fz).eventPageY=t.pageY,this.refreshPositions())}function Qz(t,e,o,n){const i=this.hot.getSelectedRangeLast();i&&xz(this,Vz)&&(xz(this,Wz).indexOf(e.row)>-1?ge(this.hot.rootElement,_z):de(this.hot.rootElement,_z),n.row=!0,n.column=!0,n.cell=!0,xz(this,Fz).coords=e,xz(this,Fz).TD=o)}function Jz(){const t=xz(this,Fz).row,e=xz(this,Wz).length;if(Mz(this,Vz,!1),ge(this.hot.rootElement,[Lz,_z,Dz]),this.hot.selection.isSelectedByRowHeader()&&de(this.hot.rootElement,Dz),e<1||void 0===t)return;const o=xz(this,Wz)[0],n=this.hot.toPhysicalRow(o),i=this.dragRows(xz(this,Wz),t);if(xz(this,Wz).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const t=this.hot.toVisualRow(n),o=t+e-1;this.hot.selectRows(t,o)}}function Zz(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),o=t.holder.scrollLeft,n=e+o;this.backlight.setPosition(null,n),this.backlight.setSize(t.hider.offsetWidth-n)}function tU(){this.moveBySettingsOrLoad()}function eU(t,e){nU(t,e),e.add(t)}function oU(t,e,o){nU(t,e),e.set(t,o)}function nU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iU(t,e,o){return e=rU(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function rU(t){var e=sU(t,"string");return"symbol"===typeof e?e:String(e)}function sU(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function lU(t,e){var o=cU(t,e,"get");return aU(t,o)}function aU(t,e){return e.get?e.get.call(t):e.value}function hU(t,e,o){var n=cU(t,e,"set");return uU(t,n,o),o}function cU(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function uU(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function dU(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const gU="manualRowResize",fU=30,mU="manualRowHeights";var pU=new WeakMap,wU=new WeakSet,vU=new WeakSet,CU=new WeakSet,yU=new WeakSet,bU=new WeakSet,SU=new WeakSet,RU=new WeakSet;class EU extends fS{static get PLUGIN_KEY(){return gU}static get PLUGIN_PRIORITY(){return fU}constructor(t){super(t),eU(this,RU),eU(this,SU),eU(this,bU),eU(this,yU),eU(this,CU),eU(this,vU),eU(this,wU),iU(this,"currentTH",null),iU(this,"currentRow",null),iU(this,"selectedRows",[]),iU(this,"currentHeight",null),iU(this,"newSize",null),iU(this,"startY",null),iU(this,"startHeight",null),iU(this,"startOffset",null),iU(this,"handle",this.hot.rootDocument.createElement("DIV")),iU(this,"guide",this.hot.rootDocument.createElement("DIV")),iU(this,"pressed",!1),iU(this,"isTriggeredByRMB",!1),iU(this,"dblclick",0),iU(this,"autoresizeTimeout",null),iU(this,"rowHeightsMap",void 0),oU(this,pU,{writable:!0,value:void 0}),de(this.handle,"manualRowResizer"),de(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[gU]}enablePlugin(){this.enabled||(this.rowHeightsMap=new du,this.rowHeightsMap.addLocalHook("init",(()=>dU(this,RU,AU).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",((t,e)=>dU(this,SU,IU).call(this,t,e))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){hU(this,pU,this.rowHeightsMap.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",mU,this.rowHeightsMap.getValues())}loadManualRowHeights(){const t={};return this.hot.runHooks("persistentStateLoad",mU,t),t.value}setManualSize(t,e){const o=this.hot.toPhysicalRow(t),n=Math.max(e,hh.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(o,n),n}setupHandlePosition(t){this.currentTH=t;const{view:e}=this.hot,{_wt:o}=e,n=o.wtTable.getCoords(this.currentTH),i=n.row;if(i<0)return;const r=Oe(this.currentTH),s=this.currentTH.getBoundingClientRect(),l=i<o.getSetting("fixedRowsTop"),a=i>=e.countNotHiddenRowIndexes(0,1)-o.getSetting("fixedRowsBottom");let h;l?h=o.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col):a&&(h=o.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col)),h||(h=o.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.selectedRows=[];const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&c){const t=this.hot.getSelectedRange();A(t,(t=>{const e=t.getTopStartCorner().row,o=t.getBottomStartCorner().row;Pi(e,o,(t=>{this.selectedRows.includes(t)||this.selectedRows.push(t)}))}))}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=h.top-6,this.startHeight=parseInt(s.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${h.start}px`,this.handle.style.width=`${r}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const t=parseInt(Oe(this.handle),10),e=parseInt(this.handle.style[this.inlineDir],10)+t,o=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);de(this.handle,"active"),de(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${e}px`,this.guide.style.width=o-t+"px",this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){ge(this.handle,"active"),ge(this.guide,"active")}checkIfRowHeader(t){var e;const o=ie(t,["TH"],this.hot.rootElement);return o&&"TBODY"===(null===(e=t.parentNode)||void 0===e||null===(e=e.parentNode)||void 0===e?void 0:e.tagName)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}getActualRowHeight(t){const e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&this.newSize<e?e:this.newSize}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{const n=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!0);void 0!==n&&(this.newSize=n),this.setManualSize(e,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!0),o&&t()};if(this.dblclick>=2){const o=this.selectedRows.length;o>1?(A(this.selectedRows,(t=>{e(t)})),t()):A(this.selectedRows,(t=>{e(t,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}bindEvents(){const{rootElement:t,rootWindow:e}=this.hot;this.eventManager.addEventListener(t,"mouseover",(t=>dU(this,wU,TU).call(this,t))),this.eventManager.addEventListener(t,"mousedown",(t=>dU(this,vU,MU).call(this,t))),this.eventManager.addEventListener(e,"mousemove",(t=>dU(this,CU,HU).call(this,t))),this.eventManager.addEventListener(e,"mouseup",(()=>dU(this,yU,xU).call(this))),this.eventManager.addEventListener(this.handle,"contextmenu",(()=>dU(this,bU,kU).call(this)))}destroy(){super.destroy()}}function TU(t){if(!to(t.target)&&!0!==this.isTriggeredByRMB&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(this.pressed||this.setupHandlePosition(e))}}function MU(t){ue(t.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((()=>this.afterMouseDownTimeout()),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=t.pageY,this.newSize=this.startHeight)}function HU(t){this.pressed&&(this.currentHeight=this.startHeight+(t.pageY-this.startY),A(this.selectedRows,(t=>{this.newSize=this.setManualSize(t,this.currentHeight)})),this.refreshHandlePosition(),this.refreshGuidePosition())}function xU(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!1),o&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){const o=this.selectedRows.length;o>1?(A(this.selectedRows,(t=>{e(t)})),t()):A(this.selectedRows,(t=>{e(t,!0)}))}this.setupHandlePosition(this.currentTH)}}function kU(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate((()=>{this.isTriggeredByRMB=!1}))}function IU(t,e){let o=t;if(this.enabled){const t=this.hot.toPhysicalRow(e),n=this.rowHeightsMap.getValueAtIndex(t);this.hot.getSettings()[gU]&&n&&(o=n)}return o}function AU(){const t=this.hot.getSettings()[gU],e=this.loadManualRowHeights();this.hot.batchExecution((()=>{"undefined"!==typeof e?e.forEach(((t,e)=>{this.rowHeightsMap.setValueAtIndex(e,t)})):Array.isArray(t)?(t.forEach(((t,e)=>{this.rowHeightsMap.setValueAtIndex(e,t)})),hU(this,pU,t)):!0===t&&Array.isArray(lU(this,pU))&&lU(this,pU).forEach(((t,e)=>{this.rowHeightsMap.setValueAtIndex(e,t)}))}),!0)}function OU(t,e,o){return e=PU(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function PU(t){var e=NU(t,"string");return"symbol"===typeof e?e:String(e)}function NU(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class _U{constructor(t,e,o,n,i,r){OU(this,"row",void 0),OU(this,"col",void 0),OU(this,"rowspan",void 0),OU(this,"colspan",void 0),OU(this,"removed",!1),OU(this,"cellCoordsFactory",void 0),OU(this,"cellRangeFactory",void 0),this.row=t,this.col=e,this.rowspan=o,this.colspan=n,this.cellCoordsFactory=i,this.cellRangeFactory=r}static NEGATIVE_VALUES_WARNING(t){return B`The merged cell declared with {row: ${t.row}, col: ${t.col},\x20
      rowspan: ${t.rowspan}, colspan: ${t.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(t){return B`The merged cell declared at [${t.row}, ${t.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(t){return B`The merged cell declared at [${t.row}, ${t.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(t){return B`The merged cell declared at [${t.row}, ${t.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}static isSingleCell(t){return 1===t.colspan&&1===t.rowspan}static containsZeroSpan(t){return 0===t.colspan||0===t.rowspan}static isOutOfBounds(t,e,o){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=o||t.col+t.colspan-1>=o}normalize(t){const e=t.countRows(),o=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}includes(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}includesHorizontally(t){return this.col<=t&&this.col+this.colspan-1>=t}includesVertically(t){return this.row<=t&&this.row+this.rowspan-1>=t}shift(t,e){const o=t[0]||t[1],n=e+Math.abs(t[0]||t[1])-1,i=t[0]?"colspan":"rowspan",r=t[0]?"col":"row",s=Math.min(e,n),l=Math.max(e,n),a=this[r],h=this[r]+this[i]-1;if(a>=e&&(this[r]+=o),o>0)e<=h&&e>a&&(this[i]+=o);else if(o<0){if(s<=a&&l>=h)return this.removed=!0,!1;if(a>=s&&a<=l){const t=l-a+1,e=Math.abs(o)-t;this[r]-=e+o,this[i]-=t}else if(a<=s&&h>=l)this[i]+=o;else if(a<=s&&h>=s&&h<l){const t=h-s+1;this[i]-=t}}return!0}isFarther(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}var LU=_U;function DU(t,e,o,n){e?e.row===o&&e.col===n?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function WU(t,e,o){return e=VU(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function VU(t){var e=FU(t,"string");return"symbol"===typeof e?e:String(e)}function FU(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class jU{constructor(t){WU(this,"plugin",void 0),WU(this,"mergedCells",[]),WU(this,"hot",void 0),this.plugin=t,this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){return B`The merged cell declared at [${t.row}, ${t.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(t,e){const o=this.mergedCells;let n=!1;return A(o,(o=>!(o.row<=t&&o.row+o.rowspan-1>=t&&o.col<=e&&o.col+o.colspan-1>=e)||(n=o,!1))),n}getByRange(t){const e=this.mergedCells;let o=!1;return A(e,(e=>!(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col)||(o=e,o))),o}getWithinRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.mergedCells,n=[];let i=t;if(!i.includesRange){const t=this.hot._createCellCoords(i.from.row,i.from.col),e=this.hot._createCellCoords(i.to.row,i.to.col);i=this.hot._createCellRange(t,t,e)}return A(o,(t=>{const o=this.hot._createCellCoords(t.row,t.col),r=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),s=this.hot._createCellRange(o,o,r);e?i.overlaps(s)&&n.push(t):i.includesRange(s)&&n.push(t)})),!!n.length&&n}add(t){const e=this.mergedCells,o=t.row,n=t.col,i=t.rowspan,r=t.colspan,s=new LU(o,n,i,r,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(o,n),a=this.isOverlapping(s);return l||a?(hn(jU.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),e.push(s),s)}remove(t,e){const o=this.mergedCells,n=this.get(t,e),i=n?this.mergedCells.indexOf(n):-1;return!(!n||-1===i)&&(o.splice(i,1),n)}clear(){const t=this.mergedCells,e=[],o=[];A(t,(t=>{const o=this.hot.getCell(t.row,t.col);o&&e.push([o,this.get(t.row,t.col),t.row,t.col])})),this.mergedCells.length=0,A(e,((t,n)=>{Pi(0,t.rowspan-1,(e=>{Pi(0,t.colspan-1,(n=>{if(0!==n||0!==e){const i=this.hot.getCell(t.row+e,t.col+n);i&&o.push([i,null,null,null])}}))})),e[n][1]=null})),A(e,(t=>{DU(...t)})),A(o,(t=>{DU(...t)}))}isOverlapping(t){const e=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1));let o=!1;return A(this.mergedCells,(t=>{const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1));return!n.overlaps(e)||(o=!0,!1)})),o}isFirstRenderableMergedCell(t,e){const o=this.get(t,e);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===e}getFirstRenderableCoords(t,e){const o=this.get(t,e);if(!o||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);const n=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(n,i)}shiftCollections(t,e,o){const n=[0,0];switch(t){case"right":n[0]+=o;break;case"left":n[0]-=o;break;case"down":n[1]+=o;break;case"up":n[1]-=o;break;default:}A(this.mergedCells,(t=>{t.shift(n,e)})),Ni(this.mergedCells.length-1,0,(t=>{const e=this.mergedCells[t];e&&e.removed&&this.mergedCells.splice(this.mergedCells.indexOf(e),1)}))}}var BU=jU;function zU(t,e,o){return e=UU(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function UU(t){var e=$U(t,"string");return"symbol"===typeof e?e:String(e)}function $U(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class GU{constructor(t){zU(this,"plugin",void 0),zU(this,"mergedCellsCollection",void 0),zU(this,"currentFillData",null),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(t){if(t[0]===t[2]&&t[1]===t[3]){const e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}getDirection(t,e){let o=null;return o=e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left",o}snapDragArea(t,e,o,n){const i=e.slice(0),r=this.getAutofillSize(t,e,o),[s,l,a,h]=t,c=["up","down"].indexOf(o)>-1,u=c?a-s+1:h-l+1,d=Math.floor(r/u)*u,g=r-d,f=this.getFarthestCollection(t,e,o,n);if(f)if("down"===o){const t=f.row+f.rowspan-s-g,e=i[2]+t;e>=this.plugin.hot.countRows()?i[2]-=g:i[2]+=g?t:0}else if("right"===o){const t=f.col+f.colspan-l-g,e=i[3]+t;e>=this.plugin.hot.countCols()?i[3]-=g:i[3]+=g?t:0}else if("up"===o){const t=a-g-f.row+1,e=i[0]+t;e<0?i[0]+=g:i[0]-=g?t:0}else if("left"===o){const t=h-g-f.col+1,e=i[1]+t;e<0?i[1]+=g:i[1]-=g?t:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:o,foundMergedCells:n,fillSize:r,dragArea:i,cycleLength:u}),i}updateCurrentFillCache(t){this.currentFillData||(this.currentFillData={}),vo(this.currentFillData,t)}getAutofillSize(t,e,o){const[n,i,r,s]=t,[l,a,h,c]=e;switch(o){case"up":return n-l;case"down":return h-r;case"left":return i-a;case"right":return c-s;default:return null}}getDragArea(t,e,o){const[n,i,r,s]=t,[l,a,h,c]=e;switch(o){case"up":return[l,a,n-1,s];case"down":return[r+1,i,h,s];case"left":return[l,a,r,i-1];case"right":return[n,s+1,h,c];default:return null}}getFarthestCollection(t,e,o,n){const[i,r,s,l]=t,a=["up","down"].indexOf(o)>-1,h=a?s:l,c=a?i:r,u=this.getAutofillSize(t,e,o),d=a?s-i+1:l-r+1,g=Math.floor(u/d)*d,f=u-g;let m=null,p=null,w=null;switch(o){case"up":m="includesVertically",w=h-f+1;break;case"left":m="includesHorizontally",w=h-f+1;break;case"down":m="includesVertically",w=c+f-1;break;case"right":m="includesHorizontally",w=c+f-1;break;default:}return A(n,(t=>{t[m](w)&&t.isFarther(p,o)&&(p=t)})),p}recreateAfterDataPopulation(t){if(!this.currentFillData)return;const e=this.getRangeFromChanges(t),o=this.currentFillData.foundMergedCells,n=this.currentFillData.dragDirection,i=(t,o)=>{switch(n){case"up":return t.row-o>=e.from.row;case"down":return t.row+t.rowspan-1+o<=e.to.row;case"left":return t.col-o>=e.from.column;case"right":return t.col+t.colspan-1+o<=e.to.column;default:return null}};let r=0,s=null,l=1;do{for(let t=0;t<o.length;t+=1){if(s=o[t],r=l*this.currentFillData.cycleLength,i(s,r))switch(n){case"up":this.plugin.mergedCellsCollection.add({row:s.row-r,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+r,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-r,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+r,colspan:s.colspan});break;default:}t===o.length-1&&(l+=1)}}while(i(s,r));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(t){const e={min:null,max:null},o={min:null,max:null};return A(t,(t=>{const n=t[0],i=this.plugin.hot.propToCol(t[1]);(null===e.min||n<e.min)&&(e.min=n),(null===e.max||n>e.max)&&(e.max=n),(null===o.min||i<o.min)&&(o.min=i),(null===o.max||i>o.max)&&(o.max=i)})),{from:{row:e.min,column:o.min},to:{row:e.max,column:o.max}}}dragAreaOverlapsCollections(t,e,o){const n=this.getDragArea(t,e,o),[i,r,s,l]=n,a=this.plugin.hot._createCellCoords(i,r),h=this.plugin.hot._createCellCoords(s,l),c=this.plugin.hot._createCellRange(a,a,h);return!!this.mergedCellsCollection.getWithinRange(c,!0)}}var YU=GU;function KU(t,e,o){return e=XU(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function XU(t){var e=qU(t,"string");return"symbol"===typeof e?e:String(e)}function qU(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class QU{constructor(t){KU(this,"plugin",void 0),KU(this,"hot",void 0),KU(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=t,this.hot=t.hot}snapDelta(t,e,o){const n=e.to,i=n.row+t.row,r=n.col+t.col;t.row?this.jumpOverMergedCell(t,o,i):t.col&&this.jumpOverMergedCell(t,o,r)}jumpOverMergedCell(t,e,o){let n=t.row||t.col,i=null,r=null,s=null;t.row?(i=e.includesVertically(o),r=e.row,s=e.getLastRow()):t.col&&(i=e.includesHorizontally(o),r=e.col,s=e.getLastColumn()),0!==n&&(n>0?i&&o!==r&&(n+=s-o+1):i&&o!==s&&(n-=o-r+1),t.row?t.row=n:t.col&&(t.col=n))}getUpdatedSelectionRange(t,e){return this.hot._createCellRange(t.highlight,t.from,this.hot._createCellCoords(t.to.row+e.row,t.to.col+e.col))}getSelectedMergedCellClassName(t,e,o,n){const i=Math.min(o[0],o[2]),r=Math.min(o[1],o[3]),s=Math.max(o[0],o[2]),l=Math.max(o[1],o[3]);if(void 0===n)return;const a=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e);if(!a)return;const h=this.plugin.mergedCellsCollection.get(t,e);if(!h)return;const c=h.getLastRow(),u=h.getLastColumn(),d=i<=h.row&&r<=h.col&&s>=c&&l>=u;return d?`${this.fullySelectedMergedCellClassName}-${n}`:this.plugin.selectionCalculations.isMergeCellFullySelected(h,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(t,e){const o=[];if(!e||!t)return!1;for(let n=0;n<t.rowspan;n+=1)for(let e=0;e<t.colspan;e+=1)o.push(this.hot._createCellCoords(t.row+n,t.col+e));for(let n=0;n<o.length;n+=1){const t=[];for(let i=0;i<e.length;i+=1)t[i]=e[i].includes(o[n]);if(!t.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const t=[];for(let e=0;e<=7;e+=1)t.push(`${this.fullySelectedMergedCellClassName}-${e}`);return t.push(`${this.fullySelectedMergedCellClassName}-multiple`),t}}var JU=QU;function ZU(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const o=t.mergedCellsCollection.get(e[0],e[1]);if(o.row===e[0]&&o.col===e[1]&&o.row+o.rowspan-1===e[2]&&o.col+o.colspan-1===e[3])return this.getTranslatedPhrase(Pd)}return this.getTranslatedPhrase(Od)},callback(){t.toggleMergeOnSelection()},disabled(){const t=this.getSelectedLast();if(!t)return!0;const e=LU.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1});return e||this.selection.isSelectedByCorner()},hidden:!1}}function t$(t,e){o$(t,e),e.add(t)}function e$(t,e,o){o$(t,e),e.set(t,o)}function o$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function n$(t,e,o){return e=i$(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function i$(t){var e=r$(t,"string");return"symbol"===typeof e?e:String(e)}function r$(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function s$(t,e,o){var n=h$(t,e,"set");return l$(t,n,o),o}function l$(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function a$(t,e){var o=h$(t,e,"get");return c$(t,o)}function h$(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function c$(t,e){return e.get?e.get.call(t):e.value}function u$(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}bn.getSingleton().register("beforeMergeCells"),bn.getSingleton().register("afterMergeCells"),bn.getSingleton().register("beforeUnmergeCells"),bn.getSingleton().register("afterUnmergeCells");const d$="mergeCells",g$=150,f$=d$;var m$=new WeakMap,p$=new WeakSet,w$=new WeakSet,v$=new WeakSet,C$=new WeakSet,y$=new WeakSet,b$=new WeakSet,S$=new WeakSet,R$=new WeakSet,E$=new WeakSet,T$=new WeakSet,M$=new WeakSet,H$=new WeakSet,x$=new WeakSet,k$=new WeakSet,I$=new WeakSet,A$=new WeakSet,O$=new WeakSet,P$=new WeakSet,N$=new WeakSet,_$=new WeakSet,L$=new WeakSet,D$=new WeakSet;class W$ extends fS{constructor(){super(...arguments),t$(this,D$),t$(this,L$),t$(this,_$),t$(this,N$),t$(this,P$),t$(this,O$),t$(this,A$),t$(this,I$),t$(this,k$),t$(this,x$),t$(this,H$),t$(this,M$),t$(this,T$),t$(this,E$),t$(this,R$),t$(this,S$),t$(this,b$),t$(this,y$),t$(this,C$),t$(this,v$),t$(this,w$),t$(this,p$),n$(this,"mergedCellsCollection",null),n$(this,"autofillCalculations",null),n$(this,"selectionCalculations",null),e$(this,m$,{writable:!0,value:null})}static get PLUGIN_KEY(){return d$}static get PLUGIN_PRIORITY(){return g$}isEnabled(){return!!this.hot.getSettings()[d$]}enablePlugin(){var t=this;this.enabled||(this.mergedCellsCollection=new BU(this),this.autofillCalculations=new YU(this),this.selectionCalculations=new JU(this),this.addHook("afterInit",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,p$,V$).call(t,...o)})),this.addHook("modifyTransformStart",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,v$,j$).call(t,...o)})),this.addHook("afterModifyTransformStart",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,_$,iG).call(t,...o)})),this.addHook("modifyTransformEnd",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,C$,B$).call(t,...o)})),this.addHook("modifyGetCellCoords",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,y$,z$).call(t,...o)})),this.addHook("beforeSetRangeStart",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,R$,G$).call(t,...o)})),this.addHook("beforeSetRangeStartOnly",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,R$,G$).call(t,...o)})),this.addHook("beforeSetRangeEnd",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,E$,Y$).call(t,...o)})),this.addHook("afterIsMultipleSelection",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,w$,F$).call(t,...o)})),this.addHook("afterRenderer",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,S$,$$).call(t,...o)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,b$,U$).call(t,...o)})),this.addHook("afterGetCellMeta",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,T$,K$).call(t,...o)})),this.addHook("afterViewportRowCalculatorOverride",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,M$,X$).call(t,...o)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,H$,q$).call(t,...o)})),this.addHook("modifyAutofillRange",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,x$,Q$).call(t,...o)})),this.addHook("afterCreateCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,k$,J$).call(t,...o)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,I$,Z$).call(t,...o)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,A$,tG).call(t,...o)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,O$,eG).call(t,...o)})),this.addHook("afterChange",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,P$,oG).call(t,...o)})),this.addHook("beforeDrawBorders",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,N$,nG).call(t,...o)})),this.addHook("afterDrawSelection",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,L$,rG).call(t,...o)})),this.addHook("beforeRemoveCellClassNames",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return u$(t,D$,sG).call(t,...o)})),this.addHook("beforeUndoStackChange",((t,e)=>{if("MergeCells"===e)return!1})),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const t=this.hot.getSettings()[d$];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),super.updatePlugin()}ifChromeForceRepaint(){if(!Do())return;const t=[];let e=[];this.mergedCellsCollection.mergedCells.forEach((t=>{const{row:o,rowspan:n}=t;for(let i=o+1;i<o+n;i++)e.push(i)})),e=[...new Set(e)],e.forEach((e=>{const o=this.hot.rowIndexMapper.getRenderableFromVisualIndex(e);this.hot.view._wt.wtOverlays.getOverlays(!0).map((t=>"master"===(null===t||void 0===t?void 0:t.name)?t:t.clone.wtTable)).forEach((e=>{const n=e.getRow(o);n&&(n.style.background=ke(n,"backgroundColor").replace(")",", 0.99)"),t.push(n))}))})),this.hot._registerTimeout((()=>{t.forEach((t=>{t.style.background=ke(t,"backgroundColor").replace(", 0.99)",")")}))}),1)}validateSetting(t){let e=!0;return!!t&&(LU.containsNegativeValues(t)?(hn(LU.NEGATIVE_VALUES_WARNING(t)),e=!1):LU.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(hn(LU.IS_OUT_OF_BOUNDS_WARNING(t)),e=!1):LU.isSingleCell(t)?(hn(LU.IS_SINGLE_CELL(t)),e=!1):LU.containsZeroSpan(t)&&(hn(LU.ZERO_SPAN_WARNING(t)),e=!1),e)}generateFromSettings(t){if(Array.isArray(t)){const e=[];if(A(t,(t=>{if(!this.validateSetting(t))return;const o=this.hot._createCellCoords(t.row,t.col),n=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),i=this.hot._createCellRange(o,o,n);this.mergeRange(i,!0,!0),Pi(t.row,t.row+t.rowspan-1,(o=>{Pi(t.col,t.col+t.colspan-1,(n=>{!1===(o===t.row&&n===t.col)&&e.push([o,n,null])}))}))})),0===e.length)return;this.hot.setDataAtCell(e)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!e||this.validateSetting(t)}toggleMergeOnSelection(){const t=this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:e,to:o}=t;this.toggleMerge(t),this.hot.selectCell(e.row,e.col,o.row,o.col,!1)}mergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:e,to:o}=t;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,o.row,o.col,!1)}unmergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;const{from:e,to:o}=t;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,o.row,o.col,!1)}mergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=t.getTopStartCorner(),i=t.getBottomEndCorner(),r={row:n.row,col:n.col,rowspan:i.row-n.row+1,colspan:i.col-n.col+1},s=[];let l=null;if(!this.canMergeRange(r,e))return!1;this.hot.runHooks("beforeMergeCells",t,e),Pi(0,r.rowspan-1,(t=>{Pi(0,r.colspan-1,(e=>{let o=null;s[t]||(s[t]=[]),0===t&&0===e?o=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r.row),this.hot.toPhysicalColumn(r.col)):this.hot.setCellMeta(r.row+t,r.col+e,"hidden",!0),s[t][e]=o}))})),this.hot.setCellMeta(r.row,r.col,"spanned",!0);const a=this.mergedCellsCollection.add(r);return!a||(o?l=[r.row,r.col,s]:this.hot.populateFromArray(r.row,r.col,s,void 0,void 0,this.pluginName),e||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,r,e),l)}unmergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.mergedCellsCollection.getWithinRange(t);o&&(this.hot.runHooks("beforeUnmergeCells",t,e),A(o,(t=>{this.mergedCellsCollection.remove(t.row,t.col),Pi(0,t.rowspan-1,(e=>{Pi(0,t.colspan-1,(o=>{this.hot.removeCellMeta(t.row+e,t.col+o,"hidden"),this.hot.removeCellMeta(t.row+e,t.col+o,"copyable")}))})),this.hot.removeCellMeta(t.row,t.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",t,e),this.hot.render())}toggleMerge(t){const e=this.mergedCellsCollection.get(t.from.row,t.from.col),o=e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col;o?this.unmergeRange(t):this.mergeSelection(t)}merge(t,e,o,n){const i=this.hot._createCellCoords(t,e),r=this.hot._createCellCoords(o,n);this.mergeRange(this.hot._createCellRange(i,i,r))}unmerge(t,e,o,n){const i=this.hot._createCellCoords(t,e),r=this.hot._createCellCoords(o,n);this.unmergeRange(this.hot._createCellRange(i,i,r))}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid");e.addShortcut({keys:[["Control","m"]],callback:()=>{const t=this.hot.getSelectedRangeLast();t&&!t.isSingleHeader()&&(this.toggleMerge(t),this.hot.render())},runOnlyIf:t=>!t.altKey,group:f$})}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(f$)}modifyViewportRowStart(t,e){const o=this.hot.rowIndexMapper,n=o.getVisualFromRenderableIndex(t.startRow);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(n,i);if(Eo(r)){const n=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r.row,1));if(n<t.startRow)return t.startRow=n,void this.modifyViewportRowStart(t,e)}}}modifyViewportRowEnd(t,e){const o=this.hot.rowIndexMapper,n=o.getVisualFromRenderableIndex(t.endRow);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(n,i);if(Eo(r)){const n=r.row+r.rowspan-1,i=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1));if(i>t.endRow)return t.endRow=i,void this.modifyViewportRowEnd(t,e)}}}modifyViewportColumnStart(t,e){const o=this.hot.columnIndexMapper,n=o.getVisualFromRenderableIndex(t.startColumn);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(i,n);if(Eo(r)){const n=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r.col,1));if(n<t.startColumn)return t.startColumn=n,void this.modifyViewportColumnStart(t,e)}}}modifyViewportColumnEnd(t,e){const o=this.hot.columnIndexMapper,n=o.getVisualFromRenderableIndex(t.endColumn);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(i,n);if(Eo(r)){const n=r.col+r.colspan-1,i=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1));if(i>t.endColumn)return t.endColumn=i,void this.modifyViewportColumnEnd(t,e)}}}translateMergedCellToRenderable(t,e,o,n){const{rowIndexMapper:i,columnIndexMapper:r}=this.hot;let s,l;s=0===e?i.getNearestNotHiddenIndex(t,1):i.getNearestNotHiddenIndex(t+e-1,-1),l=0===n?r.getNearestNotHiddenIndex(o,1):r.getNearestNotHiddenIndex(o+n-1,-1);const a=t>=0?i.getRenderableFromVisualIndex(s):t,h=o>=0?r.getRenderableFromVisualIndex(l):o;return[a,h]}}function V$(){this.generateFromSettings(this.hot.getSettings()[d$]),this.hot.render()}function F$(t){if(t){const t=this.mergedCellsCollection.mergedCells,e=this.hot.getSelectedRangeLast();for(let o=0;o<t.length;o+=1)if(e.from.row===t[o].row&&e.from.col===t[o].col&&e.to.row===t[o].row+t[o].rowspan-1&&e.to.col===t[o].col+t[o].colspan-1)return!1}return t}function j$(t){const e=this.hot.getSelectedRangeLast();let o={row:t.row,col:t.col},n=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),r=this.mergedCellsCollection.get(i.row,i.col);if(a$(this,m$)||s$(this,m$,this.hot._createCellCoords(null,null)),r){const e=this.hot._createCellCoords(r.row,r.col),n=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(e,e,n);s.includes(a$(this,m$))||s$(this,m$,this.hot._createCellCoords(null,null)),o.row=a$(this,m$).row?a$(this,m$).row-i.row:o.row,o.col=a$(this,m$).col?a$(this,m$).col-i.col:o.col,t.row>0?o.row=r.row+r.rowspan-1-i.row+t.row:t.row<0&&(o.row=i.row-r.row+t.row),t.col>0?o.col=r.col+r.colspan-1-i.col+t.col:t.col<0&&(o.col=i.col-r.col+t.col)}n=this.hot._createCellCoords(e.highlight.row+o.row,e.highlight.col+o.col);const s=this.mergedCellsCollection.get(n.row,n.col);if(s){const t=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);s$(this,m$,n),o={row:t.row-i.row,col:t.col-i.col}}0!==o.row&&(t.row=o.row),0!==o.col&&(t.col=o.col)}function B$(t){const e=this.hot.getSelectedRangeLast(),o=bo(t),n=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=bo(o);const r=this.mergedCellsCollection.getWithinRange(n,!0);do{i=bo(o),this.selectionCalculations.getUpdatedSelectionRange(e,o),A(r,(t=>{this.selectionCalculations.snapDelta(o,e,t)}))}while(o.row!==i.row||o.col!==i.col);t.row=o.row,t.col=o.col}function z$(t,e){if(t<0||e<0)return;const o=this.mergedCellsCollection.get(t,e);if(!o)return;const{row:n,col:i,colspan:r,rowspan:s}=o;return[n,i,n+s-1,i+r-1]}function U$(t){t.items.push({name:"---------"},ZU(this))}function $$(t,e,o){const n=this.mergedCellsCollection.get(e,o),i=Eo(n)?bo(n):void 0;if(Eo(i)){const{rowIndexMapper:t,columnIndexMapper:n}=this.hot,{row:r,col:s,colspan:l,rowspan:a}=i,[h,c]=this.translateMergedCellToRenderable(r,a,s,l),u=t.getRenderableFromVisualIndex(e),d=n.getRenderableFromVisualIndex(o),g=h-u+1,f=c-d+1;i.row=t.getNearestNotHiddenIndex(i.row,1),i.col=n.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,g),i.colspan=Math.min(i.colspan,f)}DU(t,i,e,o)}function G$(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function Y$(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let o=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{o=!1;for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1){const i=this.mergedCellsCollection.mergedCells[n],r=i.getRange();e.expandByRange(r)&&(t.row=e.to.row,t.col=e.to.col,o=!0)}}while(o)}function K$(t,e,o){const n=this.mergedCellsCollection.get(t,e);n&&(n.row!==t||n.col!==e?o.copyable=!1:(o.rowspan=n.rowspan,o.colspan=n.colspan))}function X$(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function q$(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Q$(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const o=this.autofillCalculations.getDirection(e,t);let n=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,n,o))return n=e,n;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i?(n=this.autofillCalculations.snapDragArea(e,n,o,i),n):n}function J$(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Z$(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function tG(t,e,o){"auto"!==o&&this.mergedCellsCollection.shiftCollections("down",t,e)}function eG(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function oG(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}function nG(t,e){if(e&&"area"===e){const e=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getWithinRange(e);A(o,(o=>{e.getBottomEndCorner().row===o.getLastRow()&&e.getBottomEndCorner().col===o.getLastColumn()&&(t[2]=o.row,t[3]=o.col)}))}}function iG(t,e,o){if(!this.enabled)return;const n=this.mergedCellsCollection.get(t.row,t.col);if(!n)return;const i=e>0,r=e<0,s=o<0,l=o>0,a=n.row+n.rowspan-1===this.hot.countRows()-1,h=0===n.row,c=n.col+n.colspan-1===this.hot.countCols()-1,u=0===n.col;(i&&a||r&&h||l&&c||s&&u)&&(t.row=n.row,t.col=n.col)}function rG(t,e,o,n){if(o)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,o,n)}function sG(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function lG(t,e){return function(o,n){const[,...i]=o,[,...r]=n;return function o(n){const s=t[n],l=e[n],a=i[n],h=r[n],c=l.multiColumnSorting,u=c.compareFunctionFactory?c.compareFunctionFactory:kT(l.type),d=u(s,l,c)(a,h);if(d===dT){const t=n+1;if("undefined"!==typeof e[t])return o(t)}return d}(0)}}function aG(){hn(B`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const hG="sort";function cG(t,e,o){const n=[];return!1===o||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push(`${hG}-${t.getIndexOfColumnInSortQueue(e)+1}`),n}function uG(t){const e=t.className.split(" "),o=new RegExp(`^${hG}-[0-9]{1,2}$`);return e.filter((t=>o.test(t)))}function dG(t,e,o){return e=gG(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function gG(t){var e=fG(t,"string");return"symbol"===typeof e?e:String(e)}function fG(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const mG="multiColumnSorting",pG=170,wG="columnSorting",vG=mG;HT(mG,lG);class CG extends YT{constructor(){super(...arguments),dG(this,"pluginKey",mG)}static get PLUGIN_KEY(){return mG}static get PLUGIN_PRIORITY(){return pG}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[wG]&&aG(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();-1===t.row&&t.col>=0&&this.sort(this.getNextSortConfig(t.col,VT))},runOnlyIf:()=>{var t;return null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},group:vG})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(vG)}sort(t){super.sort(t)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(t){return super.getSortConfig(t)}setSortConfig(t){super.setSortConfig(t)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}updateHeaderClasses(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];super.updateHeaderClasses(t,...o),ge(t,uG(t)),!1!==this.enabled&&de(t,cG(...o))}updateSortingIndicator(t,e){super.updateSortingIndicator(t,e);const o=e.querySelector(".columnSortingIndicator");if(!o||!this.hot.getSettings().ariaTags||!this.columnStatesManager.isColumnSorted(t)||this.columnStatesManager.getNumberOfSortedColumns()<=1)return;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(t)+1,i=It(`${this.hot.getTranslatedPhrase(Gg)} ${n}.`);me(o,Ot()[0]),fe(o,...i)}onUpdateSettings(t){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[wG]&&aG(),super.onUpdateSettings(t)}onAfterOnCellMouseDown(t,e){!1!==nT(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,VT))):this.sort(this.getColumnNextConfig(e.col)))}}function yG(t,e,o){return e=bG(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function bG(t){var e=SG(t,"string");return"symbol"===typeof e?e:String(e)}function SG(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const RG="multipleSelectionHandles",EG=160;class TG extends fS{constructor(){super(...arguments),yG(this,"dragged",[]),yG(this,"lastSetCell",null)}static get PLUGIN_KEY(){return RG}static get PLUGIN_PRIORITY(){return EG}isEnabled(){return Uo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const t=this,{rootElement:e}=this.hot;function o(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;const o=t.dragged.indexOf(e);if(-1===o)return!1;0===o?t.dragged=t.dragged.slice(0,1):1===o&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(e,"touchstart",(e=>{let o;return ue(e.target,"topSelectionHandle-HitArea")?(o=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},e.preventDefault(),!1):ue(e.target,"bottomSelectionHandle-HitArea")?(o=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(e,"touchend",(e=>ue(e.target,"topSelectionHandle-HitArea")?(o.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):ue(e.target,"bottomSelectionHandle-HitArea")?(o.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0)),this.eventManager.addEventListener(e,"touchmove",(e=>{const{rootDocument:o}=this.hot;let n,i,r,s,l,a;if(0===t.dragged.length)return;const h=o.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);h&&h!==t.lastSetCell&&("TD"!==h.nodeName&&"TH"!==h.nodeName||(n=t.hot.getCoords(h),-1===n.col&&(n.col=0),i=t.hot.getSelectedRangeLast(),r=i.getWidth(),s=i.getHeight(),l=i.getDirection(),1===r&&1===s&&t.hot.selection.setRangeEnd(n),a=t.getCurrentRangeCoords(i,n,t.touchStartRange.direction,l,t.dragged[0]),null!==a.start&&t.hot.selection.setRangeStart(a.start),t.hot.selection.setRangeEnd(a.end),t.lastSetCell=h),e.preventDefault())}))}getCurrentRangeCoords(t,e,o,n,i){const r=t.getTopStartCorner(),s=t.getBottomEndCorner(),l=t.getBottomStartCorner(),a=t.getTopEndCorner();let h={start:null,end:null};switch(o){case"NE-SW":switch(n){case"NE-SW":case"NW-SE":h="top"===i?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,r.col)};break;case"SE-NW":"bottom"===i&&(h={start:this.hot._createCellCoords(s.row,e.col),end:this.hot._createCellCoords(e.row,r.col)});break;default:break}break;case"NW-SE":switch(n){case"NE-SW":"top"===i?h={start:e,end:l}:h.end=e;break;case"NW-SE":"top"===i?h={start:e,end:s}:h.end=e;break;case"SE-NW":"top"===i?h={start:e,end:r}:h.end=e;break;case"SW-NE":"top"===i?h={start:e,end:a}:h.end=e;break;default:break}break;case"SW-NE":switch(n){case"NW-SE":h="bottom"===i?{start:this.hot._createCellCoords(e.row,r.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(r.row,e.col),end:this.hot._createCellCoords(e.row,s.col)};break;case"SW-NE":h="top"===i?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,s.col)}:{start:this.hot._createCellCoords(e.row,r.col),end:this.hot._createCellCoords(r.row,e.col)};break;case"SE-NW":"bottom"===i?h={start:this.hot._createCellCoords(e.row,a.col),end:this.hot._createCellCoords(r.row,e.col)}:"top"===i&&(h={start:l,end:e});break;default:break}break;case"SE-NW":switch(n){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(h.end=e);break;case"SE-NW":"top"===i?h.end=e:h={start:e,end:r};break;default:break}break;default:break}return h}isDragged(){return this.dragged.length>0}}function MG(){let{label:t="",colspan:e=1,origColspan:o=1,collapsible:n=!1,crossHiddenColumns:i=[],isCollapsed:r=!1,isHidden:s=!1,isRoot:l=!1,isPlaceholder:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:t,colspan:e,origColspan:o,collapsible:n,isCollapsed:r,crossHiddenColumns:i,isHidden:s,isRoot:l,isPlaceholder:a}}function HG(){return{label:"",isPlaceholder:!0}}function xG(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const o=[];if(0===e)return o;A(t,(t=>{const n=[];let i=0;o.push(n),A(t,(t=>{const o=MG();if(Eo(t)){const{label:e,colspan:n}=t;o.label=z(e),"number"===typeof n&&n>1&&(o.colspan=n,o.origColspan=n)}else o.label=z(t);i+=o.origColspan;let r=!1;if(i>=e&&(o.colspan=o.origColspan-(i-e),o.origColspan=o.colspan,r=!0),n.push(o),o.colspan>1)for(let e=0;e<o.colspan-1;e++)n.push(HG());return!r}))}));const n=Math.max(...I(o,(t=>t.length)));return A(o,(t=>{if(t.length<n){const e=I(new Array(n-t.length),(()=>MG()));t.splice(t.length,0,...e)}})),o}function kG(t,e,o){IG(t,e),e.set(t,o)}function IG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AG(t,e){var o=NG(t,e,"get");return OG(t,o)}function OG(t,e){return e.get?e.get.call(t):e.value}function PG(t,e,o){var n=NG(t,e,"set");return _G(t,n,o),o}function NG(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function _G(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const LG=["label","collapsible"];var DG=new WeakMap,WG=new WeakMap,VG=new WeakMap;class FG{constructor(){kG(this,DG,{writable:!0,value:[]}),kG(this,WG,{writable:!0,value:0}),kG(this,VG,{writable:!0,value:1/0})}setColumnsLimit(t){PG(this,VG,t)}setData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];PG(this,DG,xG(t,AG(this,VG))),PG(this,WG,AG(this,DG).length)}getData(){return AG(this,DG)}mergeWith(t){A(t,(t=>{let{row:e,col:o,...n}=t;const i=this.getHeaderSettings(e,o);null!==i&&vo(i,n,LG)}))}map(t){A(AG(this,DG),(e=>{A(e,(e=>{const o=t({...e});Eo(o)&&vo(e,o,LG)}))}))}getHeaderSettings(t,e){var o;if(t>=AG(this,WG)||t<0)return null;const n=AG(this,DG)[t];return e>=n.length?null:null!==(o=n[e])&&void 0!==o?o:null}getHeadersSettings(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const n=[];if(t>=AG(this,WG)||t<0)return n;const i=AG(this,DG)[t];let r=0;for(let s=e;s<i.length;s++){const t=i[s];if(t.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(r+=t.colspan,n.push(t),t.colspan>1&&(s+=t.colspan-1),r===o)break;if(r>o)throw new Error("The last column settings cannot overlap the other header layers")}return n}getLayersCount(){return AG(this,WG)}getColumnsCount(){return AG(this,WG)>0?AG(this,DG)[0].length:0}clear(){PG(this,DG,[]),PG(this,WG,0)}}function jG(t,e,o){return e=BG(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function BG(t){var e=zG(t,"string");return"symbol"===typeof e?e:String(e)}function zG(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const UG="DF-pre-order";function $G(t,e){let o=t.call(e,this);for(let n=0;n<this.childs.length;n++){if(!1===o)return!1;o=$G.call(this.childs[n],t,e)}return o}const GG="DF-post-order";function YG(t,e){for(let o=0;o<this.childs.length;o++){const n=YG.call(this.childs[o],t,e);if(!1===n)return!1}return t.call(e,this)}const KG="BF";function XG(t,e){const o=[this];function n(){if(0===o.length)return;const i=o.shift();o.push(...i.childs),!1!==t.call(e,i)&&n()}n()}const qG=KG,QG=new Map([[UG,$G],[GG,YG],[KG,XG]]);class JG{constructor(t){jG(this,"data",{}),jG(this,"parent",null),jG(this,"childs",[]),this.data=t}addChild(t){t.parent=this,this.childs.push(t)}cloneTree(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const e=new JG({...t.data});for(let o=0;o<t.childs.length;o++)e.addChild(this.cloneTree(t.childs[o]));return e}replaceTreeWith(t){this.data={...t.data},this.childs=[];for(let e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}walkDown(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qG;if(!QG.has(e))throw new Error(`Traversal strategy "${e}" does not exist`);QG.get(e).call(this,t,this)}walkUp(t){const e=this,o=n=>{const i=t.call(e,n);!1!==i&&null!==n.parent&&o(n.parent)};o(this)}}function ZG(t,e,o){tY(t,e),e.set(t,o)}function tY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eY(t,e){var o=iY(t,e,"get");return oY(t,o)}function oY(t,e){return e.get?e.get.call(t):e.value}function nY(t,e,o){var n=iY(t,e,"set");return rY(t,n,o),o}function iY(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function rY(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var sY=new WeakMap,lY=new WeakMap,aY=new WeakMap;class hY{constructor(t){ZG(this,sY,{writable:!0,value:new Map}),ZG(this,lY,{writable:!0,value:new Map}),ZG(this,aY,{writable:!0,value:null}),nY(this,aY,t)}getRoots(){return Array.from(eY(this,sY).values())}getRootByColumn(t){let e;return eY(this,lY).has(t)&&(e=eY(this,sY).get(eY(this,lY).get(t))),e}getNode(t,e){const o=this.getRootByColumn(e);if(!o)return;const n=e-eY(this,lY).get(e);let i,r=0;return o.walkDown((o=>{const{data:{origColspan:s,headerLevel:l}}=o;if(t===l){if(n>=r&&n<=r+s-1)return i=o,i.data.isRoot=e===i.data.columnIndex,!1;r+=s}})),i}rebuildTreeIndex(){let t=0;eY(this,lY).clear(),A(eY(this,sY),(e=>{let[,{data:{colspan:o}}]=e;for(let n=t;n<t+o;n++)eY(this,lY).set(n,t);t+=o}))}buildTree(){this.clear();const t=eY(this,aY).getColumnsCount();let e=0;while(e<t){const t=eY(this,aY).getHeaderSettings(0,e),o=new JG;eY(this,sY).set(e,o),this.buildLeaves(o,e,0,t.origColspan),e+=t.origColspan}this.rebuildTreeIndex()}buildLeaves(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=eY(this,aY).getHeadersSettings(o,e,n);o+=1,A(i,(n=>{const i={...n,headerLevel:o-1,columnIndex:e};let r;1===o?(t.data=i,r=t):(r=new JG(i),t.addChild(r)),o<eY(this,aY).getLayersCount()&&this.buildLeaves(r,e,o,n.origColspan),e+=n.origColspan}))}clear(){eY(this,sY).clear(),eY(this,lY).clear()}}function cY(t,e){t.walkDown((t=>{let{data:o,childs:n}=t;if(!o.isHidden&&(e(o.columnIndex),0===n.length))for(let i=1;i<o.colspan;i++)e(o.columnIndex+i)}))}function uY(t,e){let{childs:o}=t;if(0!==o.length)return o[0].data[e]}function dY(t){return uY(t,"origColspan")===t.data.origColspan}function gY(t){const{data:e,childs:o}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};const n=dY(t);if(n)return gY(o[0]);e.isCollapsed=!1;const i=o.slice(1),r=new Set;let s=0;if(i.length>0)A(i,(t=>{t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;const e=t.data;s+=e.colspan,cY(t,(t=>{r.add(t)}))}));else{const{colspan:t,origColspan:o,columnIndex:n}=e;s=o-t;for(let e=1;e<o;e++)r.add(n+e)}return t.walkUp((t=>{const{data:e}=t;e.colspan+=s,e.colspan>=e.origColspan?(e.colspan=e.origColspan,e.isCollapsed=!1):dY(t)&&(e.isCollapsed=uY(t,"isCollapsed"))})),{rollbackModification:()=>fY(t),affectedColumns:Array.from(r),colspanCompensation:s}}function fY(t){var e;const{data:o,childs:n}=t;if(o.isCollapsed||o.isHidden||o.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};const i=dY(t);if(i)return fY(n[0]);o.isCollapsed=!0;const r=n.slice(1),s=new Set;if(r.length>0)A(r,(t=>{cY(t,(t=>{s.add(t)})),t.data.clonedTree=t.cloneTree(),t.walkDown((t=>{let{data:e}=t;e.isHidden=!0}))}));else{const{origColspan:t,columnIndex:e}=o;for(let o=1;o<t;o++){const t=e+o;s.add(t)}}const l=o.colspan-(null!==(e=uY(t,"colspan"))&&void 0!==e?e:1);return t.walkUp((t=>{const{data:e}=t;e.colspan-=l,e.colspan<=1?(e.colspan=1,e.isCollapsed=!0):dY(t)&&(e.isCollapsed=uY(t,"isCollapsed"))})),{rollbackModification:()=>gY(t),affectedColumns:Array.from(s),colspanCompensation:l}}function mY(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(B`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:o}=t.data;if(o.includes(e))return;let n=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return n=!0,!1})),n||t.walkUp((t=>{const{data:o}=t;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0}))}function pY(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(B`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:o}=t.data;if(!o.includes(e))return;let n=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return n=!0,!1})),n||t.walkUp((t=>{const{data:o}=t;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1}))}const wY=new Map([["collapse",fY],["expand",gY],["hide-column",mY],["show-column",pY]]);function vY(t,e,o){if(!wY.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return wY.get(t)(e,o)}function CY(t){const e=[];return A(t,(t=>{t.walkDown((t=>{const o=t.data,{origColspan:n,columnIndex:i,headerLevel:r,crossHiddenColumns:s}=o,l=bY(e,r);let a=!1;for(let e=i;e<i+n;e++){const t=s.includes(e);if(t||a)l.push(HG(o));else{const t=yY(o);t.isRoot=!0,l.push(t),a=!0}}}))})),e}function yY(t){const{crossHiddenColumns:e,...o}=MG(t);return o}function bY(t,e){let o;return Array.isArray(t[e])?o=t[e]:(o=[],t[e]=o),o}function SY(t,e,o){RY(t,e),e.set(t,o)}function RY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EY(t,e,o){var n=HY(t,e,"set");return TY(t,n,o),o}function TY(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function MY(t,e){var o=HY(t,e,"get");return xY(t,o)}function HY(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function xY(t,e){return e.get?e.get.call(t):e.value}var kY=new WeakMap,IY=new WeakMap,AY=new WeakMap;class OY{constructor(){SY(this,kY,{writable:!0,value:new FG}),SY(this,IY,{writable:!0,value:new hY(MY(this,kY))}),SY(this,AY,{writable:!0,value:[[]]})}setState(t){MY(this,kY).setData(t);let e=!1;try{MY(this,IY).buildTree()}catch(o){MY(this,IY).clear(),MY(this,kY).clear(),e=!0}return EY(this,AY,CY(MY(this,IY).getRoots())),e}setColumnsLimit(t){MY(this,kY).setColumnsLimit(t)}mergeStateWith(t){const e=I(t,(t=>{let{row:e,...o}=t;return{row:e<0?this.rowCoordsToLevel(e):e,...o}}));MY(this,kY).mergeWith(e),MY(this,IY).buildTree(),EY(this,AY,CY(MY(this,IY).getRoots()))}mapState(t){MY(this,kY).map(t),MY(this,IY).buildTree(),EY(this,AY,CY(MY(this,IY).getRoots()))}mapNodes(t){return x(MY(this,IY).getRoots(),((e,o)=>(o.walkDown((o=>{const n=t(o.data);void 0!==n&&e.push(n)})),e)),[])}triggerNodeModification(t,e,o){e<0&&(e=this.rowCoordsToLevel(e));const n=MY(this,IY).getNode(e,o);let i;return n&&(i=vY(t,n,o),EY(this,AY,CY(MY(this,IY).getRoots()))),i}triggerColumnModification(t,e){return this.triggerNodeModification(t,-1,e)}rowCoordsToLevel(t){if(t>=0)return null;const e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}levelToRowCoords(t){if(t<0)return null;const e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}getHeaderSettings(t,e){var o,n;return t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount()?null:null!==(o=null===(n=MY(this,AY)[t])||void 0===n?void 0:n[e])&&void 0!==o?o:null}getHeaderTreeNodeData(t,e){const o=this.getHeaderTreeNode(t,e);return o?{...o.data}:null}getHeaderTreeNode(t,e){if(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())return null;const o=MY(this,IY).getNode(t,e);return o||null}findTopMostEntireHeaderLevel(t){var e;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;const n=o-t+1;let i=!1,r=null;for(let s=t;s<=o;s++){const e=MY(this,IY).getRootByColumn(s);if(!e)break;i=!0,e.walkDown((e=>{const{columnIndex:i,headerLevel:s,origColspan:l,isHidden:a}=e.data;a||l<=n&&i>=t&&i+l-1<=o&&(null===r||s<r)&&(r=s)}),UG)}return i&&null===r?-1:this.levelToRowCoords(null!==(e=r)&&void 0!==e?e:0)}findLeftMostColumnIndex(t,e){var o;const{isRoot:n}=null!==(o=this.getHeaderSettings(t,e))&&void 0!==o?o:{isRoot:!0};if(n)return e;let i=e-1;while(i>=0){var r;const{isRoot:e}=null!==(r=this.getHeaderSettings(t,i))&&void 0!==r?r:{isRoot:!0};if(e)break;i-=1}return i}findRightMostColumnIndex(t,e){var o;const{isRoot:n,origColspan:i}=null!==(o=this.getHeaderSettings(t,e))&&void 0!==o?o:{isRoot:!0,origColspan:1};if(n)return e+i-1;let r=e+1;while(r<this.getColumnsCount()){var s;const{isRoot:e}=null!==(s=this.getHeaderSettings(t,r))&&void 0!==s?s:{isRoot:!0};if(e)break;r+=1}return r-1}getLayersCount(){return MY(this,kY).getLayersCount()}getColumnsCount(){return MY(this,kY).getColumnsCount()}clear(){EY(this,AY,[]),MY(this,kY).clear(),MY(this,IY).clear()}}function PY(t,e,o){return e=NY(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function NY(t){var e=_Y(t,"string");return"symbol"===typeof e?e:String(e)}function _Y(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class LY{constructor(t,e){PY(this,"hot",void 0),PY(this,"nestedHeaderSettingsGetter",void 0),PY(this,"layersCount",0),PY(this,"container",void 0),PY(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=e,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(t){return this.layersCount=t,this}getWidth(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length;this.widthsMap.clear();for(let o=0;o<e;o++){const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),n=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(n,t[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(t){const{rootDocument:e,columnIndexMapper:o}=this.hot,n=e.createDocumentFragment(),i=e.createElement("table"),r=!!this.hot.getSettings().dropdownMenu,s=o.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const t=e.createElement("tr");for(let n=0;n<s;n++){let i=o.getVisualFromRenderableIndex(n);null===i&&(i=n);const s=e.createElement("th"),a=this.nestedHeaderSettingsGetter(l,i);if(a&&(!a.isPlaceholder||a.isHidden)){let e=a.label;r&&(e+='<button class="changeType"></button>'),Ce(s,e),s.colSpan=a.colspan,t.appendChild(s)}}i.appendChild(t)}n.appendChild(i),t.appendChild(n)}clear(){this.widthsMap.clear(),this.container=null}}var DY=LY;function WY(t,e){zY(t,e),e.add(t)}function VY(t,e,o){return e=FY(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function FY(t){var e=jY(t,"string");return"symbol"===typeof e?e:String(e)}function jY(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function BY(t,e,o){zY(t,e),e.set(t,o)}function zY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UY(t,e,o){var n=YY(t,e,"set");return $Y(t,n,o),o}function $Y(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function GY(t,e){var o=YY(t,e,"get");return KY(t,o)}function YY(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function KY(t,e){return e.get?e.get.call(t):e.value}function XY(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const qY="nestedHeaders",QY=280;var JY=new WeakMap,ZY=new WeakMap,tK=new WeakMap,eK=new WeakMap,oK=new WeakSet,nK=new WeakSet,iK=new WeakSet,rK=new WeakSet,sK=new WeakSet,lK=new WeakSet,aK=new WeakSet,hK=new WeakSet,cK=new WeakSet,uK=new WeakSet,dK=new WeakSet,gK=new WeakSet,fK=new WeakSet,mK=new WeakSet,pK=new WeakSet,wK=new WeakSet,vK=new WeakSet,CK=new WeakSet;class yK extends fS{constructor(){super(...arguments),WY(this,CK),WY(this,vK),WY(this,wK),WY(this,pK),WY(this,mK),WY(this,fK),WY(this,gK),WY(this,dK),WY(this,uK),WY(this,cK),WY(this,hK),WY(this,aK),WY(this,lK),WY(this,sK),WY(this,rK),WY(this,iK),WY(this,nK),WY(this,oK),BY(this,JY,{writable:!0,value:new OY}),BY(this,ZY,{writable:!0,value:null}),BY(this,tK,{writable:!0,value:null}),BY(this,eK,{writable:!0,value:!1}),VY(this,"ghostTable",new DY(this.hot,((t,e)=>this.getHeaderSettings(t,e)))),VY(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return qY}static get PLUGIN_PRIORITY(){return QY}isEnabled(){return!!this.hot.getSettings()[qY]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();Array.isArray(e)&&Array.isArray(e[0])||hn(B`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",(()=>XY(this,vK,DK).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,CK,WK).call(t,...o)})),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,sK,TK).call(t,...o)})),this.addHook("afterOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,lK,MK).call(t,...o)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,aK,HK).call(t,...o)})),this.addHook("beforeOnCellMouseUp",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,hK,xK).call(t,...o)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,cK,kK).call(t,...o)})),this.addHook("modifyTransformStart",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,uK,IK).call(t,...o)})),this.addHook("afterSelection",(()=>XY(this,oK,bK).call(this))),this.addHook("beforeViewportScrollHorizontally",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,nK,SK).call(t,...o)})),this.addHook("afterGetColumnHeaderRenderers",(t=>XY(this,gK,OK).call(this,t))),this.addHook("modifyColWidth",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,mK,NK).call(t,...o)})),this.addHook("modifyColumnHeaderValue",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,pK,_K).call(t,...o)})),this.addHook("beforeHighlightingColumnHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,iK,RK).call(t,...o)})),this.addHook("beforeCopy",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,rK,EK).call(t,...o)})),this.addHook("beforeSelectColumns",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,dK,AK).call(t,...o)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,fK,PK).call(t,...o)})),this.addHook("modifyFocusedElement",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return XY(t,wK,LK).call(t,...o)})),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",(()=>XY(this,oK,bK).call(this))),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",(()=>XY(this,oK,bK).call(this))),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:t}=this.hot.getSettings();GY(this,JY).setColumnsLimit(this.hot.countCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=GY(this,JY).setState(t)),this.detectedOverlappedHeaders&&hn(B`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(((t,e)=>{const o=!0===t?"hide-column":"show-column";GY(this,JY).triggerColumnModification(o,e)})),!GY(this,ZY)&&this.enabled&&UY(this,ZY,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((t=>{t.forEach((t=>{let{op:e,index:o,newValue:n}=t;if("replace"===e){const t=!0===n?"hide-column":"show-column";GY(this,JY).triggerColumnModification(t,o)}})),this.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),GY(this,JY).clear(),GY(this,ZY).unsubscribe(),UY(this,ZY,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return GY(this,JY)}getLayersCount(){return GY(this,JY).getLayersCount()}getHeaderSettings(t,e){return GY(this,JY).getHeaderSettings(t,e)}clearColspans(){if(!this.hot.view)return;const{_wt:t}=this.hot.view,e=t.getSetting("columnHeaders").length,o=t.wtTable.THEAD,n=t.wtOverlays.topOverlay.clone.wtTable.THEAD,i=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let r=0;r<e;r++){const t=o.childNodes[r];if(!t)break;const e=n.childNodes[r],s=i?i.childNodes[r]:null;for(let o=0,n=t.childNodes.length;o<n;o++)t.childNodes[o].removeAttribute("colspan"),ge(t.childNodes[o],"hiddenHeader"),e&&e.childNodes[o]&&(e.childNodes[o].removeAttribute("colspan"),ge(e.childNodes[o],"hiddenHeader")),i&&s&&s.childNodes[o]&&(s.childNodes[o].removeAttribute("colspan"),ge(s.childNodes[o],"hiddenHeader"))}}headerRendererFactory(t){var e=this;const o=this.hot.view._wt.getSetting("fixedColumnsStart");return(n,i)=>{var r;const{columnIndexMapper:s,view:l}=this.hot;let a=s.getVisualFromRenderableIndex(n);null===a&&(a=n),i.removeAttribute("colspan"),ge(i,"hiddenHeader");const{colspan:h,isHidden:c,isPlaceholder:u}=null!==(r=GY(this,JY).getHeaderSettings(t,a))&&void 0!==r?r:{label:""};if(u||c)de(i,"hiddenHeader");else if(h>1){var d,g;const{wtOverlays:t}=l._wt,e=null===(d=t.topInlineStartCornerOverlay)||void 0===d?void 0:d.clone.wtTable.THEAD.contains(i),r=null===(g=t.inlineStartOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(i),s=e||r?Math.min(h,o-n):h;s>1&&i.setAttribute("colspan",s)}this.hot.view.appendColHeader(a,i,(function(){return e.getColumnHeaderValue(...arguments)}),t)}}getColumnHeaderValue(t,e){var o;const{isHidden:n,isPlaceholder:i}=null!==(o=GY(this,JY).getHeaderSettings(e,t))&&void 0!==o?o:{};return i||n?"":this.hot.getColHeader(t,e)}destroy(){UY(this,JY,null),null!==GY(this,ZY)&&(GY(this,ZY).unsubscribe(),UY(this,ZY,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(t){if(!(t.row>=0||t.col<0))return GY(this,JY).getHeaderTreeNodeData(t.row,t.col)}}function bK(){var t;const e=null===(t=this.hot)||void 0===t?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:o}=e,n=o.isHeader()&&o.col>=0;if(n){const t=GY(this,JY).findLeftMostColumnIndex(o.row,o.col),e=this.hot.selection.highlight.getFocus();e.visualCellRange.highlight.col=t,e.visualCellRange.from.col=t,e.visualCellRange.to.col=t,e.commit()}}function SK(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:o}=e,n=o.isHeader()&&o.col>=0;if(!n)return t;const i=this.hot.view.getFirstFullyVisibleColumn(),r=this.hot.view.getLastFullyVisibleColumn(),s=GY(this,JY).findLeftMostColumnIndex(o.row,o.col),l=GY(this,JY).findRightMostColumnIndex(o.row,o.col);return s<i&&l>r?t:s<i?s:l}function RK(t,e,o){const n=GY(this,JY).getHeaderTreeNodeData(e,t);if(!n)return t;const{columnCursor:i,selectionType:r,selectionWidth:s}=o,{isRoot:l,colspan:a}=GY(this,JY).getHeaderSettings(e,t);if(r===Cf){if(!l)return n.columnIndex}else if(r===vf&&(a>s-i||!l))return null;return t}function EK(t,e,o){let{columnHeadersCount:n}=o;if(0!==n)for(let r=0;r<e.length;r++){const{startRow:o,startCol:n,endRow:s,endCol:l}=e[r],a=s-o+1,h=n-l+1;if(o>=0||1===h)break;for(let e=n;e<=l;e++)for(let r=o;r<=s;r++){var i;const o=a+r,s=e-n;if(0===s)continue;const l=null===(i=GY(this,JY).getHeaderTreeNodeData(r,e))||void 0===i?void 0:i.isRoot;!1===l&&(t[o][s]="")}}}function TK(t,e,o,n){const i=this._getHeaderTreeNodeDataByCoords(e);i&&(n.column=!0)}function MK(t,e){const o=this._getHeaderTreeNodeDataByCoords(e);if(!o)return;UY(this,tK,e.clone()),UY(this,eK,!0);const{selection:n}=this.hot,i=n.isSelected()?n.getSelectedRange().current():null,r=[],{columnIndex:s,origColspan:l}=o,a=!n.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?r.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?r.push(i.getTopStartCorner().col,s+l-1,e.row):r.push(s,s+l-1,e.row):(ln(t)||sn(t)&&a)&&r.push(s,s+l-1,e.row),n.selectColumns(...r)}function HK(t,e,o,n){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:r,origColspan:s}=i,l=this.hot.getSelectedRangeLast(),a=l.getTopStartCorner(),h=l.getBottomEndCorner(),{from:c}=l;n.column=!0,n.cell=!0;const u=[],d=Li(e.row,-1/0,-1);e.col<c.col?u.push(h.col,r,d):e.col>c.col?u.push(a.col,r+s-1,d):u.push(r,r+s-1,d),this.hot.selection.selectColumns(...u)}function xK(){UY(this,eK,!1)}function kK(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!GY(this,eK)||!t)return;const e=this.hot.getSelectedRangeLast(),o=e.getTopStartCorner().col,n=e.getBottomEndCorner().col,{columnIndex:i,origColspan:r}=GY(this,JY).getHeaderTreeNodeData(GY(this,tK).row,GY(this,tK).col);if(e.setHighlight(GY(this,tK)),r>e.getWidth()||i<o||i+r-1>n){const t=GY(this,JY).findTopMostEntireHeaderLevel(Li(o,i,i+r-1),Li(n,i,i+r-1));e.highlight.row=t,e.highlight.col=e.from.col}}function IK(t){const{highlight:e}=this.hot.getSelectedRangeLast(),o=this.hot._createCellCoords(e.row+t.row,e.col+t.col),n=o.isHeader()&&o.col>=0;if(!n)return;const i=GY(this,JY).findLeftMostColumnIndex(o.row,o.col),r=GY(this,JY).findRightMostColumnIndex(o.row,o.col);if(t.col<0){const o=e.col>=i&&e.col<=r?i-1:r,n=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);t.col=null===n?-this.hot.view.countRenderableColumnsInRange(0,e.col):-Math.max(this.hot.view.countRenderableColumnsInRange(n,e.col)-1,1)}else if(t.col>0){const o=e.col>=i&&e.col<=r?r+1:i,n=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);t.col=null===n?this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(e.col,n)-1,1)}}function AK(t,e){const o=t.row,n=this._getHeaderTreeNodeDataByCoords({row:o,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:o,col:e.col});e.col<t.col?(n&&(t.col=n.columnIndex+n.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(n&&(t.col=n.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function OK(t){t.length=0;for(let e=0;e<GY(this,JY).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function PK(t){const e=GY(this,JY).getLayersCount();let o=t.startColumn,n=!!e;for(let i=0;i<e;i++){const e=GY(this,JY).findLeftMostColumnIndex(i,t.startColumn),r=this.hot.columnIndexMapper.getRenderableFromVisualIndex(e);if(e>=0&&(n=!1),Ai(r)&&r<t.startColumn){o=r;break}}t.startColumn=n?GY(this,JY).getHeaderTreeNodeData(0,o).columnIndex:o}function NK(t,e){const o=this.ghostTable.getWidth(e);return t>o?t:o}function _K(t,e,o){var n;const{label:i}=null!==(n=GY(this,JY).getHeaderTreeNodeData(o,e))&&void 0!==n?n:{label:""};return i}function LK(t,e){if(t<0)return this.hot.getCell(t,GY(this,JY).findLeftMostColumnIndex(t,e),!0)}function DK(){this.updatePlugin()}function WK(t,e){e||this.updatePlugin()}function VK(t,e,o){return e=FK(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function FK(t){var e=jK(t,"string");return"symbol"===typeof e?e:String(e)}function jK(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class BK{constructor(t,e){VK(this,"hot",void 0),VK(this,"data",null),VK(this,"plugin",void 0),VK(this,"parentReference",new WeakMap),VK(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=e,this.plugin=t}setData(t){this.data=t}getData(){return this.data}getRawSourceData(){let t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}updateWithData(t){this.setData(t),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Pi(0,this.data.length-1,(t=>{this.cacheNode(this.data[t],0,null)}))}cacheNode(t,e,o){this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:o,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&A(t.__children,(o=>{this.cacheNode(o,e+1,t)}))}getDataObject(t){return null===t||void 0===t?null:this.cache.rows[t]}readTreeNodes(t,e,o,n){let i=!1,r=e;if(isNaN(r)&&r.end)return r;let s=t;return s||(s={__children:this.data},i=!0,r-=1),null!==o&&void 0!==o&&r===o?{result:s,end:!0}:null!==n&&void 0!==n&&s===n?{result:r,end:!0}:(r+=1,s.__children&&A(s.__children,(t=>{if(this.parentReference.set(t,i?null:s),r=this.readTreeNodes(t,r,o,n),isNaN(r)&&r.end)return!1})),r)}mockParent(){const t=this.mockNode();return t.__children=this.data,t}mockNode(){const t={};return Mo(this.data[0],((e,o)=>{t[o]=null})),t}getRowIndex(t){return null===t||void 0===t?null:this.cache.nodeInfo.get(t).row}getRowIndexWithinParent(t){let e=null;e=isNaN(t)?t:this.getDataObject(t);const o=this.getRowParent(t);return null===o||void 0===o?this.data.indexOf(e):o.__children.indexOf(e)}countAllRows(){const t={__children:this.data};return this.countChildren(t)}countChildren(t){let e=0,o=t;return isNaN(o)||(o=this.getDataObject(o)),o&&o.__children?(A(o.__children,(t=>{e+=1,t.__children&&(e+=this.countChildren(t))})),e):0}getRowParent(t){let e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}getRowObjectParent(t){return t&&"object"===typeof t?this.cache.nodeInfo.get(t).parent:null}getRowLevel(t){let e=null;return e=isNaN(t)?t:this.getDataObject(t),e?this.getRowObjectLevel(e):null}getRowObjectLevel(t){return null===t||void 0===t?null:this.cache.nodeInfo.get(t).level}hasChildren(t){let e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}isChild(t){return null!==this.getRowParent(t)}getChild(t,e){var o;return(null===(o=t.__children)||void 0===o?void 0:o[e])||null}isRowHighestLevel(t){return!this.isChild(t)}isParent(t){var e;let o=t;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&0!==(null===(e=o.__children)||void 0===e?void 0:e.length)}addChild(t,e){let o=e;this.hot.runHooks("beforeAddChild",t,o);let n=null;t&&(n=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(t)+1,1);let i=t;t||(i=this.mockParent()),i.__children||(i.__children=[]),o||(o=this.mockNode()),i.__children.push(o),this.rewriteCache();const r=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(r,1),this.hot.runHooks("afterCreateRow",r,1),this.hot.runHooks("afterAddChild",t,o)}addChildAtIndex(t,e,o){let n,i=o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",t,i,e),t){const o=this.getRowIndex(t),r=o+e+1;this.hot.runHooks("beforeCreateRow",r,1),t.__children.splice(e,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(r,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",r,1),n=r}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),n=this.getRowIndex(this.data[e]);i=this.getDataObject(n),this.hot.runHooks("afterAddChild",t,i,e)}addSibling(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const o=this.translateTrimmedRow(t),n=this.getRowParent(o),i=this.getRowIndexWithinParent(o);switch(e){case"below":this.addChildAtIndex(n,i+1,null);break;case"above":this.addChildAtIndex(n,i,null);break;default:break}}detachFromParent(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=null;const n=[];Array.isArray(t)?(Pi(t[0],t[2],(t=>{const e=this.translateTrimmedRow(t);n.push(this.getDataObject(e))})),Pi(0,n.length-2,(t=>{this.detachFromParent(n[t],!1)})),o=n[n.length-1]):o=t;const i=this.getRowIndex(o),r=this.countChildren(o),s=this.getRowIndexWithinParent(o),l=this.getRowParent(o),a=this.getRowParent(l),h=this.getRowIndex(a);let c=null;if(this.hot.runHooks("beforeDetachChild",l,o),null!==s&&void 0!==s){const t=Array.from(new Array(i+r+1).keys()).splice(-1*(r+1));if(this.hot.runHooks("beforeRemoveRow",i,r+1,t,this.plugin.pluginName),l.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,r+1,t,this.plugin.pluginName),a){c=h+this.countChildren(a);const t=this.getChild(a,this.countChildren(a)-1),e=this.getRowIndex(t);this.hot.runHooks("beforeCreateRow",e+1,r+1,this.plugin.pluginName),a.__children.push(o)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,r+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,r+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,o,this.getRowIndex(o)),e&&this.hot.render()}filterData(t,e,o){const n=[];A(o,(t=>{n.push(this.getDataObject(t))})),A(n,(t=>{const e=this.getRowIndexWithinParent(t),o=this.getRowParent(t);null===o?this.data.splice(e,1):o.__children.splice(e,1)})),this.rewriteCache()}spliceData(t,e,o){const n=this.getDataObject(t-1);let i=null,r=t;n&&n.__children&&0===n.__children.length?(i=n,r=0):t<this.countAllRows()&&(i=this.getRowParent(t),r=this.getRowIndexWithinParent(t)),i?o?i.__children.splice(r,e,...o):i.__children.splice(r,e):o?this.data.splice(r,e,...o):this.data.splice(r,e),this.rewriteCache()}syncRowWithRawSource(t){let e=t,o=null;do{o=this.getRowParent(o),null!==o&&(e=o)}while(null!==o);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(t,e,o,n){const i=e===this.hot.countRows(),r=this.getRowParent(t),s=this.getRowIndexWithinParent(t),l=r.__children.slice(s,s+1),a=t>e;let h=i?this.getRowParent(e-1):this.getRowParent(e);null!==h&&void 0!==h||(h=this.getRowParent(e-1)),null!==h&&void 0!==h||(h=this.getDataObject(e-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(e),h.__children=[]);const c=i||o||n?h.__children.length:this.getRowIndexWithinParent(e),u=r===h;h.__children.splice(c,0,l[0]),r.__children.splice(s+(a&&u?1:0),1),this.syncRowWithRawSource(r),u||this.syncRowWithRawSource(h)}translateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}untranslateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}}var zK=BK;function UK(t,e,o){return e=$K(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function $K(t){var e=GK(t,"string");return"symbol"===typeof e?e:String(e)}function GK(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class YK{constructor(t,e){UK(this,"hot",void 0),UK(this,"plugin",void 0),this.hot=e,this.plugin=t}}var KK=YK;class XK extends KK{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(t,e){super(t,e),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(t,e){const o=this.hot.toPhysicalRow(t),n=this.dataManager.getRowLevel(o),i=this.dataManager.getDataObject(o),r=e.getElementsByTagName("DIV")[0],s=r.querySelector("span.rowHeader"),l=r.querySelectorAll('[class^="ht_nesting"]'),a=this.hot.getSettings().ariaTags;if(A(l,(t=>{t&&r.removeChild(t)})),de(e,XK.CSS_CLASSES.indicatorContainer),n){const{rootDocument:t}=this.hot,e=s.cloneNode(!0);r.innerHTML="",Pi(0,n-1,(()=>{const e=t.createElement("SPAN");de(e,XK.CSS_CLASSES.emptyIndicator),r.appendChild(e)})),r.appendChild(e)}if(this.dataManager.hasChildren(i)){const t=this.hot.rootDocument.createElement("DIV");a&&fe(t,[Ot()]),de(e,XK.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(o)?(de(t,`${XK.CSS_CLASSES.button} ${XK.CSS_CLASSES.expandButton}`),a&&fe(e,[Ft(!1),At(this.hot.getTranslatedPhrase(Qg))])):(de(t,`${XK.CSS_CLASSES.button} ${XK.CSS_CLASSES.collapseButton}`),a&&fe(e,[Ft(!0),At(this.hot.getTranslatedPhrase(Jg))])),r.appendChild(t)}}updateRowHeaderWidth(t){let e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}var qK=XK;class QK extends KK{constructor(t,e){var o;super(t,e),o=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,t)},shiftStash:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==e&&void 0!==e||(e=1/0),A(o.lastCollapsedRows,((i,r)=>{i>=t&&i<e&&(o.lastCollapsedRows[r]=i+n)}))},applyStash:function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o.collapseMultipleChildren(o.lastCollapsedRows,t),o.lastCollapsedRows=void 0},trimStash:(t,e)=>{Pi(t,t+e-1,(t=>{const e=this.lastCollapsedRows.indexOf(t);e>-1&&this.lastCollapsedRows.splice(e,1)}))}}}collapseChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];let i=null,r=null,s=null;return isNaN(t)?(i=t,r=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(t),r=t),this.dataManager.hasChildren(i)&&A(i.__children,(t=>{n.push(this.dataManager.getRowIndex(t))})),s=this.collapseRows(n,!0,!1),o&&this.trimRows(s),e&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(r)&&this.collapsedRows.push(r),s}collapseMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];A(t,(t=>{n.push(...this.collapseChildren(t,!1,!1))})),o&&this.trimRows(n),e&&this.renderAndAdjust()}collapseRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([t],e)}collapseRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[];return A(t,(t=>{n.push(t),e&&this.collapseChildRows(t,n)})),o&&this.trimRows(n),n}collapseChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){const o=this.dataManager.getDataObject(t);A(o.__children,(t=>{const o=this.dataManager.getRowIndex(t);e.push(o),this.collapseChildRows(o,e)}))}o&&this.trimRows(e)}expandRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([t],e)}expandRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[];return A(t,(t=>{n.push(t),e&&this.expandChildRows(t,n)})),o&&this.untrimRows(n),n}expandChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){const o=this.dataManager.getDataObject(t);A(o.__children,(t=>{if(!this.isAnyParentCollapsed(t)){const o=this.dataManager.getRowIndex(t);e.push(o),this.expandChildRows(o,e)}}))}o&&this.untrimRows(e)}expandChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];let i=null,r=null,s=null;return isNaN(t)?(i=t,r=this.dataManager.getRowIndex(t)):(i=this.dataManager.getDataObject(t),r=t),this.collapsedRows.splice(this.collapsedRows.indexOf(r),1),this.dataManager.hasChildren(i)&&A(i.__children,(t=>{const e=this.dataManager.getRowIndex(t);n.push(e)})),s=this.expandRows(n,!0,!1),o&&this.untrimRows(s),e&&this.renderAndAdjust(),s}expandMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];A(t,(t=>{n.push(...this.expandChildren(t,!1,!1))})),o&&this.untrimRows(n),e&&this.renderAndAdjust()}collapseAll(){const t=this.dataManager.getData(),e=[];A(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.collapseMultipleChildren(e),this.renderAndAdjust()}expandAll(){const t=this.dataManager.getData(),e=[];A(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.expandMultipleChildren(e),this.renderAndAdjust()}trimRows(t){this.hot.batchExecution((()=>{A(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)}))}),!0)}untrimRows(t){this.hot.batchExecution((()=>{A(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)}))}),!0)}areChildrenCollapsed(t){let e=isNaN(t)?t:this.dataManager.getDataObject(t),o=!0;return null===e&&(e={__children:this.dataManager.data}),this.dataManager.hasChildren(e)&&A(e.__children,(t=>{const e=this.dataManager.getRowIndex(t);if(!this.plugin.collapsedRowsMap.getValueAtIndex(e))return o=!1,!1})),o}isAnyParentCollapsed(t){let e=t;while(null!==e){e=this.dataManager.getRowParent(e);const t=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(t)>-1)return!0}return!1}toggleState(t,e){if(e.col>=0)return;const o=this.translateTrimmedRow(e.row);ue(t.target,qK.CSS_CLASSES.button)&&(this.areChildrenCollapsed(o)?this.expandChildren(o):this.collapseChildren(o),nn(t))}translateTrimmedRow(t){return this.hot.toPhysicalRow(t)}untranslateTrimmedRow(t){return this.hot.toVisualRow(t)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}var JK=QK;function ZK(t,e,o){tX(t,e),e.set(t,o)}function tX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eX(t,e,o){return e=oX(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function oX(t){var e=nX(t,"string");return"symbol"===typeof e?e:String(e)}function nX(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function iX(t,e){var o=rX(t,e,"get");return sX(t,o)}function rX(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function sX(t,e){return e.get?e.get.call(t):e.value}var lX=new WeakMap;class aX extends KK{constructor(){super(...arguments),eX(this,"dataManager",this.plugin.dataManager),ZK(this,lX,{writable:!0,value:{row_above:(t,e)=>{const o=e[e.length-1];this.dataManager.addSibling(o.start.row,"above")},row_below:(t,e)=>{const o=e[e.length-1];this.dataManager.addSibling(o.start.row,"below")}}})}appendOptions(t){const e=[{key:"add_child",name(){return this.getTranslatedPhrase(Jd)},callback:()=>{const t=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),e=this.dataManager.getDataObject(t);this.dataManager.addChild(e)},disabled:()=>{const t=this.hot.getSelectedLast();return!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Zd)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const t=this.hot.getSelectedLast(),e=this.dataManager.translateTrimmedRow(t[0]),o=this.dataManager.getRowParent(e);return!o||!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Pi(0,t.items.length-1,(o=>{if(0===o)return A(e,((e,n)=>{t.items.splice(o+n,0,e)})),!1})),this.modifyRowInsertingOptions(t)}modifyRowInsertingOptions(t){return Pi(0,t.items.length-1,(e=>{const o=iX(this,lX)[t.items[e].key];null!==o&&void 0!==o&&(t.items[e].callback=o)})),t}}var hX=aX;function cX(t,e,o){return e=uX(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function uX(t){var e=dX(t,"string");return"symbol"===typeof e?e:String(e)}function dX(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class gX{constructor(t){cX(this,"plugin",void 0),cX(this,"hot",void 0),cX(this,"dataManager",void 0),cX(this,"collapsingUI",void 0),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}onBeforeRowMove(t,e,o,n){const i=this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:o,movePossible:n});if(i)return!1;this.movedToCollapsed=!1;const r=o===this.hot.countRows(),s=r?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o);let l=!0;const a=t.map((t=>{if(!l)return!1;const e=this.dataManager.translateTrimmedRow(t);return l=this.shouldAllowMoving(e,s),e})),h=-1===a.indexOf(s);if(!l||!h)return!1;const c=this.getBaseParent(a),u=this.getTargetParent(r,s),d=c===u;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(u),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(a,s,d),this.moveRows(a,s,u),this.dataManager.rewriteCache(),this.moveCellsMeta(a,s),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,o,n,n&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,o),!1}displayAPICompatibilityWarning(t){const{rows:e,finalIndex:o,dropIndex:n,movePossible:i}=t;let r=!1;return $(n)&&(hn(B`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",e,o,n,i,!1),r=!0),r}shouldAllowMoving(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}getBaseParent(t){return this.dataManager.getRowParent(t[0])}getTargetParent(t,e){let o=this.dataManager.getRowParent(t?e-1:e);return null!==o&&void 0!==o||(o=this.dataManager.getRowParent(e-1)),o}shiftCollapsibleParentsLocations(t,e,o){o||(Math.max(...t)<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}moveRows(t,e,o){const n=e===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender((()=>{t.forEach((t=>{this.dataManager.moveRow(t,e,this.movedToCollapsed,n)}))}))}moveCellsMeta(t,e){const o=[],n=Math.max(...t)<e;t.forEach((t=>{o.push(this.hot.getCellMetaAtRow(t))})),this.hot.spliceCellsMeta(t[0],t.length),this.hot.spliceCellsMeta(e-(n?o.length:0),0,...o)}selectCells(t,e){const o=t.length;let n=0,i=0,r=null,s=null;if(this.movedToCollapsed){let r=null;r=t[o-1]<e?this.dataManager.translateTrimmedRow(e-o):this.dataManager.translateTrimmedRow(e);const s=this.dataManager.getRowParent(null===r?this.hot.countSourceRows()-1:r-1),l=this.dataManager.getRowIndex(s);n=this.dataManager.untranslateTrimmedRow(l),i=n}else t[o-1]<e?(i=e-1,n=i-o+1):(n=e,i=n+o-1);r=this.hot.selection,s=this.hot.countCols()-1,r.setRangeStart(this.hot._createCellCoords(n,0)),r.setRangeEnd(this.hot._createCellCoords(i,s),!0)}isRowOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}}function fX(t,e){pX(t,e),e.add(t)}function mX(t,e,o){pX(t,e),e.set(t,o)}function pX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wX(t,e,o){return e=vX(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function vX(t){var e=CX(t,"string");return"symbol"===typeof e?e:String(e)}function CX(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function yX(t,e){var o=RX(t,e,"get");return bX(t,o)}function bX(t,e){return e.get?e.get.call(t):e.value}function SX(t,e,o){var n=RX(t,e,"set");return EX(t,n,o),o}function RX(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function EX(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function TX(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const MX="nestedRows",HX=300,xX=MX,kX="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var IX=new WeakMap,AX=new WeakMap,OX=new WeakSet,PX=new WeakSet,NX=new WeakSet,_X=new WeakSet,LX=new WeakSet,DX=new WeakSet,WX=new WeakSet,VX=new WeakSet,FX=new WeakSet,jX=new WeakSet,BX=new WeakSet,zX=new WeakSet,UX=new WeakSet,$X=new WeakSet,GX=new WeakSet,YX=new WeakSet;class KX extends fS{constructor(){super(...arguments),fX(this,YX),fX(this,GX),fX(this,$X),fX(this,UX),fX(this,zX),fX(this,BX),fX(this,jX),fX(this,FX),fX(this,VX),fX(this,WX),fX(this,DX),fX(this,LX),fX(this,_X),fX(this,NX),fX(this,PX),fX(this,OX),wX(this,"dataManager",null),wX(this,"headersUI",null),wX(this,"collapsedRowsMap",null),mX(this,IX,{writable:!0,value:!1}),mX(this,AX,{writable:!0,value:!1})}static get PLUGIN_KEY(){return MX}static get PLUGIN_PRIORITY(){return HX}isEnabled(){return!!this.hot.getSettings()[MX]}enablePlugin(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new vu),this.dataManager=new zK(this,this.hot),this.collapsingUI=new JK(this,this.hot),this.headersUI=new qK(this,this.hot),this.contextMenuUI=new hX(this,this.hot),this.rowMoveController=new gX(this),this.addHook("afterInit",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,$X,aq).call(t,...o)})),this.addHook("beforeViewRender",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,GX,hq).call(t,...o)})),this.addHook("modifyRowData",(function(){return t.onModifyRowData(...arguments)})),this.addHook("modifySourceLength",(function(){return t.onModifySourceLength(...arguments)})),this.addHook("beforeDataSplice",(function(){return t.onBeforeDataSplice(...arguments)})),this.addHook("filterData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,NX,QX).call(t,...o)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,_X,JX).call(t,...o)})),this.addHook("afterGetRowHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,LX,ZX).call(t,...o)})),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,PX,qX).call(t,...o)})),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,VX,oq).call(t,...o)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,WX,eq).call(t,...o)})),this.addHook("beforeAddChild",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,FX,nq).call(t,...o)})),this.addHook("afterAddChild",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,jX,iq).call(t,...o)})),this.addHook("beforeDetachChild",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,BX,rq).call(t,...o)})),this.addHook("afterDetachChild",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,zX,sq).call(t,...o)})),this.addHook("modifyRowHeaderWidth",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,DX,tq).call(t,...o)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,UX,lq).call(t,...o)})),this.addHook("beforeRowMove",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TX(t,OX,XX).call(t,...o)})),this.addHook("beforeLoadData",(t=>TX(this,YX,cq).call(this,t))),this.addHook("beforeUpdateData",(t=>TX(this,YX,cq).call(this,t))),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();if(-1===t.col&&t.row>=0){const e=this.collapsingUI.translateTrimmedRow(t.row);this.collapsingUI.areChildrenCollapsed(e)?this.collapsingUI.expandChildren(e):this.collapsingUI.collapseChildren(e)}},runOnlyIf:()=>{var t;return null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},group:xX})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xX)}disableCoreAPIModifiers(){SX(this,AX,!0)}enableCoreAPIModifiers(){SX(this,AX,!1)}onModifyRowData(t){if(!yX(this,AX))return this.dataManager.getDataObject(t)}onModifySourceLength(){if(!yX(this,AX))return this.dataManager.countAllRows()}onBeforeDataSplice(t,e,o){return!(!yX(this,AX)&&!this.dataManager.isRowHighestLevel(t))||(this.dataManager.spliceData(t,e,o),!1)}destroy(){super.destroy()}}function XX(t,e,o,n){return this.rowMoveController.onBeforeRowMove(t,e,o,n)}function qX(t,e,o){this.collapsingUI.toggleState(t,e,o)}function QX(t,e,o){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(o[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(o[0],null,-1*e),this.dataManager.filterData(t,e,o),SX(this,IX,!0),this.dataManager.getData().slice()}function JX(t){return this.contextMenuUI.appendOptions(t)}function ZX(t,e){this.headersUI.appendLevelIndicators(t,e)}function tq(t){return this.headersUI.rowHeaderWidthCache||t}function eq(t,e,o,n){n!==this.pluginName&&this.hot._registerTimeout((()=>{SX(this,IX,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()}),0)}function oq(t,e,o){const n=Array.from(o.reduce(((t,e)=>{if(this.dataManager.isParent(e)){const o=this.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(o)&&o.forEach((e=>t.add(this.dataManager.getRowIndex(e)))),t}return t.add(e)}),new Set));o.length=0,o.push(...n)}function nq(){this.collapsingUI.collapsedRowsStash.stash()}function iq(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function rq(){this.collapsingUI.collapsedRowsStash.stash()}function sq(t,e,o){this.collapsingUI.collapsedRowsStash.shiftStash(o,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function lq(){this.dataManager.rewriteCache()}function aq(){this.headersUI.updateRowHeaderWidth()}function hq(t,e){yX(this,IX)&&(e.skipRender=!0)}function cq(t){if(!Gc(t))return cn(kX),this.hot.getSettings()[MX]=!1,void this.disablePlugin();this.dataManager.setData(t),this.dataManager.rewriteCache()}function uq(t,e,o){return e=dq(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function dq(t){var e=gq(t,"string");return"symbol"===typeof e?e:String(e)}function gq(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class fq{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;uq(this,"rootWindow",void 0),uq(this,"prefix",void 0),uq(this,"savedKeys",[]),this.rootWindow=e,this.prefix=t,this.loadSavedKeys()}saveValue(t,e){this.rootWindow.localStorage.setItem(`${this.prefix}_${t}`,JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}loadValue(t,e){const o="undefined"===typeof t?e:t,n=this.rootWindow.localStorage.getItem(`${this.prefix}_${o}`);return null===n?void 0:JSON.parse(n)}reset(t){this.rootWindow.localStorage.removeItem(`${this.prefix}_${t}`)}resetAll(){A(this.savedKeys,((t,e)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[e]}`)})),this.clearSavedKeys()}loadSavedKeys(){const t=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),e="string"===typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}var mq=fq;function pq(t,e,o){return e=wq(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function wq(t){var e=vq(t,"string");return"symbol"===typeof e?e:String(e)}function vq(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}bn.getSingleton().register("persistentStateSave"),bn.getSingleton().register("persistentStateLoad"),bn.getSingleton().register("persistentStateReset");const Cq="persistentState",yq=0;class bq extends fS{constructor(){super(...arguments),pq(this,"storage",void 0)}static get PLUGIN_KEY(){return Cq}static get PLUGIN_PRIORITY(){return yq}isEnabled(){return!!this.hot.getSettings()[Cq]}enablePlugin(){this.enabled||(this.storage||(this.storage=new mq(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",((t,e)=>this.saveValue(t,e))),this.addHook("persistentStateLoad",((t,e)=>this.loadValue(t,e))),this.addHook("persistentStateReset",(()=>this.resetValue())),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(t,e){e.value=this.storage.loadValue(t)}saveValue(t,e){this.storage.saveValue(t,e)}resetValue(t){"undefined"===typeof t?this.storage.resetAll():this.storage.reset(t)}destroy(){super.destroy()}}function Sq(t,e){Rq(t,e),e.add(t)}function Rq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eq(t,e,o){return e=Tq(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Tq(t){var e=Mq(t,"string");return"symbol"===typeof e?e:String(e)}function Mq(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Hq(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const xq="search",kq=190,Iq="htSearchResult",Aq=function(t,e,o,n,i){t.getCellMeta(e,o).isSearchResult=i},Oq=function(t,e,o){return!($(t)||null===t||!t.toLocaleLowerCase||0===t.length)&&(!$(e)&&null!==e&&-1!==e.toString().toLocaleLowerCase(o.locale).indexOf(t.toLocaleLowerCase(o.locale)))};var Pq=new WeakSet;class Nq extends fS{constructor(){super(...arguments),Sq(this,Pq),Eq(this,"callback",Aq),Eq(this,"queryMethod",Oq),Eq(this,"searchResultClass",Iq)}static get PLUGIN_KEY(){return xq}static get PLUGIN_PRIORITY(){return kq}isEnabled(){return this.hot.getSettings()[xq]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[xq];this.updatePluginSettings(e),this.addHook("beforeRenderer",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Hq(t,Pq,_q).call(t,...o)})),super.enablePlugin()}disablePlugin(){var t=this;const e=function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Hq(t,Pq,_q).call(t,...o)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("beforeRenderer",e)})),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const n=this.hot.countRows(),i=this.hot.countCols(),r=[],s=this.hot;return Pi(0,n-1,(n=>{Pi(0,i-1,(i=>{const l=this.hot.getDataAtCell(n,i),a=this.hot.getCellMeta(n,i),h=a.search.callback||e,c=a.search.queryMethod||o,u=c(t,l,a);if(u){const t={row:n,col:i,data:l};r.push(t)}h&&h(s,n,i,l,u)}))})),r}getCallback(){return this.callback}setCallback(t){this.callback=t}getQueryMethod(){return this.queryMethod}setQueryMethod(t){this.queryMethod=t}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(t){this.searchResultClass=t}updatePluginSettings(t){Eo(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}destroy(){super.destroy()}}function _q(t,e,o,n,i,r){const s=r.className||[];let l=[];"string"===typeof s?l=s.split(" "):l.push(...s),this.isEnabled()&&r.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),r.className=l.join(" ")}function Lq(t,e){Dq(t,e),e.add(t)}function Dq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wq(t,e,o){return e=Vq(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Vq(t){var e=Fq(t,"string");return"symbol"===typeof e?e:String(e)}function Fq(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function jq(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const Bq="touchScroll",zq=200;var Uq=new WeakSet,$q=new WeakSet,Gq=new WeakSet;class Yq extends fS{constructor(){super(...arguments),Lq(this,Gq),Lq(this,$q),Lq(this,Uq),Wq(this,"scrollbars",[]),Wq(this,"clones",[]),Wq(this,"lockedCollection",!1),Wq(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Bq}static get PLUGIN_PRIORITY(){return zq}static get SETTING_KEYS(){return!0}isEnabled(){return br()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",(()=>jq(this,Uq,Kq).call(this))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",(()=>jq(this,$q,Xq).call(this))),this.addHook("afterMomentumScroll",(()=>jq(this,Gq,qq).call(this)))}}function Kq(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:o,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(o),n&&this.scrollbars.push(n),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Xq(){this.freezeOverlays=!0,A(this.clones,(t=>{de(t,"hide-tween")}))}function qq(){this.freezeOverlays=!1,A(this.clones,(t=>{ge(t,"hide-tween"),de(t,"show-tween")})),this.hot._registerTimeout((()=>{A(this.clones,(t=>{ge(t,"show-tween")}))}),400),A(this.scrollbars,(t=>{t.refresh(),t.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Qq(t,e){Jq(t,e),e.add(t)}function Jq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zq(t,e,o){return e=tQ(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function tQ(t){var e=eQ(t,"string");return"symbol"===typeof e?e:String(e)}function eQ(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function oQ(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const nQ="trimRows",iQ=330;var rQ=new WeakSet;class sQ extends fS{constructor(){super(...arguments),Qq(this,rQ),Zq(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return nQ}static get PLUGIN_PRIORITY(){return iQ}isEnabled(){return!!this.hot.getSettings()[nQ]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new vu),this.trimmedRowsMap.addLocalHook("init",(()=>oQ(this,rQ,lQ).call(this))),super.enablePlugin())}updatePlugin(){const t=this.hot.getSettings()[nQ];Array.isArray(t)&&this.hot.batchExecution((()=>{this.trimmedRowsMap.clear(),A(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(t){const e=this.getTrimmedRows(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t))));const i=this.hot.runHooks("beforeTrimRow",e,n,o);!1!==i&&(o&&this.hot.batchExecution((()=>{A(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),this.hot.runHooks("afterTrimRow",e,n,o,o&&n.length>e.length))}trimRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.trimRows(e)}untrimRows(t){const e=this.getTrimmedRows(),o=this.isValidConfig(t);let n=e;const i=this.trimmedRowsMap.getValues().slice(),r=t.length>0;o&&r&&(A(t,(t=>{i[t]=!1})),n=x(i,((t,e,o)=>(e&&t.push(o),t)),[]));const s=this.hot.runHooks("beforeUntrimRow",e,n,o&&r);!1!==s&&(o&&r&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",e,n,o&&r,o&&n.length<e.length))}untrimRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.untrimRows(e)}isTrimmed(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(t){const e=this.hot.countSourceRows();return t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}destroy(){super.destroy()}}function lQ(){const t=this.hot.getSettings()[nQ];Array.isArray(t)&&this.hot.batchExecution((()=>{A(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0)}const aQ="undoRedo",hQ="undoRedo";function cQ(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",(function(o,n){const i=o&&o.length;if(!i)return;const r=o.find((t=>{const[,,e,o]=t;return e!==o}));if(!r)return;const s=()=>{const e=o.reduce(((t,e)=>(t.push([...e]),t)),[]);A(e,(e=>{e[1]=t.propToCol(e[1])}));const n=i>1?this.getSelected():[[e[0][0],e[0][1]]];return new cQ.ChangeAction(e,n)};e.done(s,n)})),t.addHook("afterCreateRow",((t,o,n)=>{e.done((()=>new cQ.CreateRowAction(t,o)),n)})),t.addHook("beforeRemoveRow",((o,n,i,r)=>{const s=()=>{const i=t.toPhysicalRow(o),r=yo(e.instance.getSourceData(i,0,i+n-1,e.instance.countSourceCols()-1));return new cQ.RemoveRowAction(i,r,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(s,r)})),t.addHook("afterCreateCol",((t,o,n)=>{e.done((()=>new cQ.CreateColumnAction(t,o)),n)})),t.addHook("beforeRemoveCol",((o,n,i,r)=>{const s=()=>{const i=e.instance.getSourceDataArray(),r=(e.instance.countCols()+o)%e.instance.countCols(),s=[],l=[],a=[];Pi(i.length-1,(e=>{const o=[],l=i[e];Pi(r,r+(n-1),(e=>{o.push(l[t.toPhysicalColumn(e)])})),s.push(o)})),Pi(n-1,(e=>{a.push(t.toPhysicalColumn(r+e))})),Array.isArray(t.getSettings().colHeaders)&&Pi(n-1,(e=>{l.push(t.getSettings().colHeaders[t.toPhysicalColumn(r+e)]||null)}));const h=t.columnIndexMapper.getIndexesSequence(),c=t.rowIndexMapper.getIndexesSequence();return new cQ.RemoveColumnAction(r,a,s,l,h,c,t.getSettings().fixedColumnsStart)};e.done(s,r)})),t.addHook("beforeCellAlignment",((t,o,n,i)=>{e.done((()=>new cQ.CellAlignmentAction(t,o,n,i)))})),t.addHook("beforeFilter",(t=>{e.done((()=>new cQ.FiltersAction(t)))})),t.addHook("beforeRowMove",((t,o)=>{!1!==t&&e.done((()=>new cQ.RowMoveAction(t,o)))})),t.addHook("beforeMergeCells",((o,n)=>{n||e.done((()=>new cQ.MergeCellsAction(t,o)))})),t.addHook("afterUnmergeCells",((o,n)=>{n||e.done((()=>new cQ.UnmergeCellsAction(t,o)))})),t.addHook("afterInit",(()=>{e.init()}))}cQ.prototype.done=function(t,e){if(this.ignoreNewActions)return;const o="UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;if(o)return;const n=this.doneActions.slice(),i=this.instance.runHooks("beforeUndoStackChange",n,e);if(!1===i)return;const r=t(),s=this.undoneActions.slice();this.doneActions.push(r),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())},cQ.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const o=yo(e),n=this.instance.runHooks("beforeUndo",o);if(!1===n)return;this.ignoreNewActions=!0;const i=this,r=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",r),e.undo(this.instance,(()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)})),this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice()),this.instance.runHooks("afterUndo",o)}},cQ.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const o=yo(e),n=this.instance.runHooks("beforeRedo",o);if(!1===n)return;this.ignoreNewActions=!0;const i=this,r=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",r),e.redo(this.instance,(()=>{i.ignoreNewActions=!1,i.doneActions.push(e)})),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("afterRedo",o)}},cQ.prototype.isUndoAvailable=function(){return this.doneActions.length>0},cQ.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},cQ.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},cQ.prototype.isEnabled=function(){return this.enabled},cQ.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,fQ(t),this.registerShortcuts(),t.addHook("afterChange",gQ)},cQ.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,mQ(t),this.unregisterShortcuts(),t.removeHook("afterChange",gQ)},cQ.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},cQ.Action=function(){},cQ.Action.prototype.undo=function(){},cQ.Action.prototype.redo=function(){},cQ.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},wo(cQ.ChangeAction,cQ.Action),cQ.ChangeAction.prototype.undo=function(t,e){const o=yo(this.changes),n=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let r=0,s=o.length;r<s;r++)o[r].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(o,null,null,"UndoRedo.undo");for(let r=0,s=o.length;r<s;r++){const[e,s]=o[r];t.getSettings().minSpareRows&&e+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(e+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&s+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(s+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)},cQ.ChangeAction.prototype.redo=function(t,e){const o=yo(this.changes);for(let n=0,i=o.length;n<i;n++)o[n].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(o,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},cQ.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},wo(cQ.CreateRowAction,cQ.Action),cQ.CreateRowAction.prototype.undo=function(t,e){const o=t.countRows(),n=t.getSettings().minSpareRows;this.index>=o&&this.index-n<o&&(this.index-=n),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},cQ.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},cQ.RemoveRowAction=function(t,e,o,n,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=o,this.fixedRowsTop=n,this.rowIndexesSequence=i},wo(cQ.RemoveRowAction,cQ.Action),cQ.RemoveRowAction.prototype.undo=function(t,e){const o=t.getSettings(),n=[];o.fixedRowsBottom=this.fixedRowsBottom,o.fixedRowsTop=this.fixedRowsTop,this.data.forEach(((t,e)=>{Object.keys(t).forEach((o=>{const i=parseInt(o,10);n.push([this.index+e,isNaN(i)?o:i,t[o]])}))})),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(n,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},cQ.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},cQ.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},wo(cQ.CreateColumnAction,cQ.Action),cQ.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},cQ.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},cQ.RemoveColumnAction=function(t,e,o,n,i,r,s){this.index=t,this.indexes=e,this.data=o,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=r.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s},wo(cQ.RemoveColumnAction,cQ.Action),cQ.RemoveColumnAction.prototype.undo=function(t,e){const o=t.getSettings();o.fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),i=(t,e,o)=>o[this.indexes.indexOf(n[e])],r=this.data.length,s=[];for(let h=0;h<r;h++)s.push(I(this.data[h],i));const l=I(this.headers,i),a=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),A(t.getSourceDataArray(),((t,e)=>{A(n,((o,n)=>{t[o]=s[e][n],a.push([e,o,t[o]])}))})),t.setSourceDataAtCell(a,void 0,void 0,"UndoRedo.undo"),"undefined"!==typeof this.headers&&A(l,((e,o)=>{t.getSettings().colHeaders[n[o]]=e})),t.batchExecution((()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)}),!0),t.addHookOnce("afterViewRender",e),t.render()},cQ.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},cQ.CellAlignmentAction=function(t,e,o,n){this.stateBefore=t,this.range=e,this.type=o,this.alignment=n},cQ.CellAlignmentAction.prototype.undo=function(t,e){A(this.range,(e=>{e.forAll(((e,o)=>{e>=0&&o>=0&&t.setCellMeta(e,o,"className",this.stateBefore[e][o]||" htLeft")}))})),t.addHookOnce("afterViewRender",e),t.render()},cQ.CellAlignmentAction.prototype.redo=function(t,e){WM(this.range,this.type,this.alignment,((e,o)=>t.getCellMeta(e,o)),((e,o,n,i)=>t.setCellMeta(e,o,n,i))),t.addHookOnce("afterViewRender",e),t.render()},cQ.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},wo(cQ.FiltersAction,cQ.Action),cQ.FiltersAction.prototype.undo=function(t,e){const o=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),o.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),o.filter()},cQ.FiltersAction.prototype.redo=function(t,e){const o=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),o.conditionCollection.importAllConditions(this.conditionsStack),o.filter()};class uQ extends cQ.Action{constructor(t,e){super(),this.cellRange=e;const o=this.cellRange.getTopStartCorner(),n=this.cellRange.getBottomEndCorner();this.rangeData=t.getData(o.row,o.col,n.row,n.col)}undo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.unmergeRange(this.cellRange,!0);const n=this.cellRange.getTopStartCorner();t.populateFromArray(n.row,n.col,this.rangeData,void 0,void 0,"MergeCells")}redo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.mergeRange(this.cellRange)}}cQ.MergeCellsAction=uQ;class dQ extends cQ.Action{constructor(t,e){super(),this.cellRange=e}undo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.mergeRange(this.cellRange,!0)}redo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.unmergeRange(this.cellRange,!0),t.render()}}function gQ(t,e){const o=this;if("loadData"===e)return o.undoRedo.clear()}function fQ(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function mQ(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}cQ.UnmergeCellsAction=dQ,cQ.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"},wo(cQ.RowMoveAction,cQ.Action),cQ.RowMoveAction.prototype.undo=function(t,e){const o=t.getPlugin("manualRowMove"),n=[].concat(this.rows),i=n.filter((t=>t>this.finalIndex)),r=n.filter((t=>t<=this.finalIndex)),s=i.sort(((t,e)=>e-t)).concat(r.sort(((t,e)=>t-e)));t.addHookOnce("afterViewRender",e);for(let l=0;l<s.length;l+=1){const e=t.toVisualRow(s[l]);o.moveRow(e,s[l])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},cQ.RowMoveAction.prototype.redo=function(t,e){const o=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),o.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},cQ.prototype.init=function(){const t=this.instance.getSettings().undo,e="undefined"===typeof t||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},cQ.prototype.registerShortcuts=function(){const t=this.instance.getShortcutManager(),e=t.getContext("grid"),o=t=>!t.altKey,n={runOnlyIf:o,group:aQ};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],n)},cQ.prototype.unregisterShortcuts=function(){const t=this.instance.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(aQ)};const pQ=bn.getSingleton();pQ.add("afterUpdateSettings",(function(){var t;null===(t=this.getPlugin("undoRedo"))||void 0===t||t.init()})),pQ.register("beforeUndo"),pQ.register("afterUndo"),pQ.register("beforeRedo"),pQ.register("afterRedo"),cQ.PLUGIN_KEY=hQ,cQ.SETTING_KEYS=!0;var wQ,vQ,CQ,yQ,bQ,SQ=cQ;function RQ(){or(KS),or(yR),or(VR),or(uE),or(LE),or(YT),or(mM),or(HH),or(Pk),or(UI),or(kA),or(jA),or(sO),or(NO),or(yD),or(RV),or(vF),or(qF),or(yj),or(wB),or(XB),or(Kz),or(EU),or(W$),or(CG),or(TG),or(yK),or(KX),or(bq),or(Nq),or(Yq),or(sQ),or(SQ)}function EQ(){Fy(),gb(),Mb(),Qb(),RQ()}function TQ(t){const e="undefined"!==typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){const o=this.first();let n,i=o.data("handsontable");if("string"!==typeof e){const n=e||{};return i?i.updateSettings(n):(i=new t.Core(o[0],n),o.data("handsontable",i),i.init()),o}if(i){if("undefined"===typeof i[e])throw new Error(`Handsontable do not provide action: ${e}`);for(var r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];n=i[e].call(i,...s),"destroy"===e&&o.removeData()}return n})}EQ(),TQ(Gv),Gv.__GhostTable=yS,Gv._getListenersCounter=jn,Gv._getRegisteredMapsCounter=Mu,Gv.EventManager=Fn;const MQ=[n,h,m,w,f,l,i,g,a,r,c,d],HQ=[s,u];Gv.helper={},Gv.dom={},A(MQ,(t=>{A(Object.getOwnPropertyNames(t),(e=>{"_"!==e.charAt(0)&&(Gv.helper[e]=t[e])}))})),A(HQ,(t=>{A(Object.getOwnPropertyNames(t),(e=>{"_"!==e.charAt(0)&&(Gv.dom[e]=t[e])}))})),Gv.cellTypes=null!==(wQ=Gv.cellTypes)&&void 0!==wQ?wQ:{},A(np(),(t=>{Gv.cellTypes[t]=rp(t)})),Gv.cellTypes.registerCellType=sp,Gv.cellTypes.getCellType=rp,Gv.editors=null!==(vQ=Gv.editors)&&void 0!==vQ?vQ:{},A(xn(),(t=>{Gv.editors[`${lt(t)}Editor`]=On(t)})),Gv.editors.registerEditor=Pn,Gv.editors.getEditor=On,Gv.renderers=null!==(CQ=Gv.renderers)&&void 0!==CQ?CQ:{},A(ar(),(t=>{const e=cr(t);"base"===t&&(Gv.renderers.cellDecorator=e),Gv.renderers[`${lt(t)}Renderer`]=e})),Gv.renderers.registerRenderer=ur,Gv.renderers.getRenderer=cr,Gv.validators=null!==(yQ=Gv.validators)&&void 0!==yQ?yQ:{},A(mr(),(t=>{Gv.validators[`${lt(t)}Validator`]=wr(t)})),Gv.validators.registerValidator=vr,Gv.validators.getValidator=wr,Gv.plugins=null!==(bQ=Gv.plugins)&&void 0!==bQ?bQ:{},A(Zi(),(t=>{Gv.plugins[t]=tr(t)})),Gv.plugins[`${lt(fS.PLUGIN_KEY)}Plugin`]=fS,Gv.plugins.registerPlugin=or,Gv.plugins.getPlugin=tr;var xQ=Gv,kQ=function(t,e){var o=e.className;void 0!==o&&xQ.dom.addClass(t,o)},IQ=function(t,e,o,n,i,r,s){var l=document.createElement("div");l.style.width="".concat(10*r,"px"),kQ(e,s),xQ.dom.addClass(l,"progressBar"),xQ.dom.empty(e),e.appendChild(l)},AQ=function(t,e,o,n,i,r,s){xQ.renderers.TextRenderer.apply(this,[t,e,o,n,i,"".repeat(r),s])},OQ=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]),PQ=function(t,e,o,n,i,r){if(0===o){var s=t.parentElement;null!==s&&(r.instance.getDataAtRowProp(e,"0")?xQ.dom.addClass(s,oy):xQ.dom.removeClass(s,oy),e%2===0?xQ.dom.addClass(s,ny):xQ.dom.removeClass(s,ny))}},NQ=function(t,e){var o=document.createElement("input");o.type="checkbox",t>=0&&this.getDataAtRowProp(t,"0")&&(o.checked=!0),xQ.dom.empty(e),e.appendChild(o)};function _Q(t,e){if(!(t<0)){var o=this.isRtl()?"htRight":"htLeft";e.firstChild&&(OQ.has(t.toString())?(xQ.dom.removeClass(e.firstChild,o),xQ.dom.addClass(e.firstChild,OQ.get(t.toString()))):xQ.dom.addClass(e.firstChild,o))}}var LQ=function(t,e){var o=t.target;-1===e.col&&t.target&&"INPUT"===o.nodeName&&(t.preventDefault(),this.setDataAtRowProp(e.row,"0",!o.checked))},DQ={name:"DataGrid",data:function(){return{hotSettings:{height:450,dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterOnCellMouseDown:LQ,afterGetColHeader:_Q,afterGetRowHeader:NQ,beforeRenderer:PQ,colWidths:[140,192,100,90,90,110,97,100,126],colHeaders:["Company name","Name","Sell date","In stock","Qty","Progress","Rating","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:8,renderer:IQ,readOnly:!0,className:"htMiddle"},{data:9,renderer:AQ,readOnly:!0,className:"star htCenter"},{data:5,type:"text"},{data:2,type:"text"}],licenseKey:"non-commercial-and-evaluation"},data:iy()}},components:{HotTable:NC}},WQ=DQ,VQ=o(9917),FQ=(0,VQ.Z)(WQ,b,S,!1,null,null,null),jQ=FQ.exports,BQ={name:"App",components:{DataGrid:jQ}},zQ=BQ,UQ=(0,VQ.Z)(zQ,C,y,!1,null,null,null),$Q=UQ.exports;console.log("Handsontable: v".concat(xQ.version," (").concat(xQ.buildDate,") Wrapper: v").concat(NC.version," Vue: v").concat(v.ZP.version)),v.ZP.config.silent=!0,new v.ZP({render:function(t){return t($Q)}}).$mount("#app")},5131:function(t,e,o){var n={"./af":4466,"./af.js":4466,"./ar":9252,"./ar-dz":6520,"./ar-dz.js":6520,"./ar-kw":2358,"./ar-kw.js":2358,"./ar-ly":3229,"./ar-ly.js":3229,"./ar-ma":1707,"./ar-ma.js":1707,"./ar-sa":3237,"./ar-sa.js":3237,"./ar-tn":8206,"./ar-tn.js":8206,"./ar.js":9252,"./az":9665,"./az.js":9665,"./be":2888,"./be.js":2888,"./bg":5945,"./bg.js":5945,"./bm":6375,"./bm.js":6375,"./bn":758,"./bn-bd":533,"./bn-bd.js":533,"./bn.js":758,"./bo":5502,"./bo.js":5502,"./br":70,"./br.js":70,"./bs":295,"./bs.js":295,"./ca":6647,"./ca.js":6647,"./cs":4343,"./cs.js":4343,"./cv":9886,"./cv.js":9886,"./cy":2985,"./cy.js":2985,"./da":139,"./da.js":139,"./de":472,"./de-at":994,"./de-at.js":994,"./de-ch":4824,"./de-ch.js":4824,"./de.js":472,"./dv":9271,"./dv.js":9271,"./el":5195,"./el.js":5195,"./en-au":8847,"./en-au.js":8847,"./en-ca":1348,"./en-ca.js":1348,"./en-gb":9053,"./en-gb.js":9053,"./en-ie":1853,"./en-ie.js":1853,"./en-il":4135,"./en-il.js":4135,"./en-in":7122,"./en-in.js":7122,"./en-nz":3011,"./en-nz.js":3011,"./en-sg":6714,"./en-sg.js":6714,"./eo":197,"./eo.js":197,"./es":4293,"./es-do":8029,"./es-do.js":8029,"./es-mx":1154,"./es-mx.js":1154,"./es-us":8357,"./es-us.js":8357,"./es.js":4293,"./et":6720,"./et.js":6720,"./eu":5808,"./eu.js":5808,"./fa":4924,"./fa.js":4924,"./fi":5949,"./fi.js":5949,"./fil":6108,"./fil.js":6108,"./fo":2687,"./fo.js":2687,"./fr":6724,"./fr-ca":9466,"./fr-ca.js":9466,"./fr-ch":867,"./fr-ch.js":867,"./fr.js":6724,"./fy":9550,"./fy.js":9550,"./ga":4735,"./ga.js":4735,"./gd":9878,"./gd.js":9878,"./gl":9787,"./gl.js":9787,"./gom-deva":6492,"./gom-deva.js":6492,"./gom-latn":5339,"./gom-latn.js":5339,"./gu":836,"./gu.js":836,"./he":9315,"./he.js":9315,"./hi":3724,"./hi.js":3724,"./hr":3730,"./hr.js":3730,"./hu":7657,"./hu.js":7657,"./hy-am":1918,"./hy-am.js":1918,"./id":2215,"./id.js":2215,"./is":4095,"./is.js":4095,"./it":2446,"./it-ch":1947,"./it-ch.js":1947,"./it.js":2446,"./ja":9545,"./ja.js":9545,"./jv":1437,"./jv.js":1437,"./ka":1330,"./ka.js":1330,"./kk":8900,"./kk.js":8900,"./km":5620,"./km.js":5620,"./kn":7081,"./kn.js":7081,"./ko":8130,"./ko.js":8130,"./ku":5295,"./ku.js":5295,"./ky":8578,"./ky.js":8578,"./lb":8773,"./lb.js":8773,"./lo":6366,"./lo.js":6366,"./lt":2532,"./lt.js":2532,"./lv":3902,"./lv.js":3902,"./me":3636,"./me.js":3636,"./mi":4059,"./mi.js":4059,"./mk":6005,"./mk.js":6005,"./ml":2982,"./ml.js":2982,"./mn":5543,"./mn.js":5543,"./mr":4898,"./mr.js":4898,"./ms":4145,"./ms-my":8766,"./ms-my.js":8766,"./ms.js":4145,"./mt":4780,"./mt.js":4780,"./my":3445,"./my.js":3445,"./nb":4372,"./nb.js":4372,"./ne":2862,"./ne.js":2862,"./nl":2254,"./nl-be":3293,"./nl-be.js":3293,"./nl.js":2254,"./nn":6986,"./nn.js":6986,"./oc-lnc":6623,"./oc-lnc.js":6623,"./pa-in":3802,"./pa-in.js":3802,"./pl":2560,"./pl.js":2560,"./pt":6467,"./pt-br":3595,"./pt-br.js":3595,"./pt.js":6467,"./ro":5092,"./ro.js":5092,"./ru":2238,"./ru.js":2238,"./sd":5555,"./sd.js":5555,"./se":7291,"./se.js":7291,"./si":3013,"./si.js":3013,"./sk":7005,"./sk.js":7005,"./sl":284,"./sl.js":284,"./sq":7274,"./sq.js":7274,"./sr":1344,"./sr-cyrl":1521,"./sr-cyrl.js":1521,"./sr.js":1344,"./ss":9573,"./ss.js":9573,"./sv":8865,"./sv.js":8865,"./sw":1769,"./sw.js":1769,"./ta":1108,"./ta.js":1108,"./te":2002,"./te.js":2002,"./tet":3164,"./tet.js":3164,"./tg":6599,"./tg.js":6599,"./th":1806,"./th.js":1806,"./tk":2315,"./tk.js":2315,"./tl-ph":3296,"./tl-ph.js":3296,"./tlh":3102,"./tlh.js":3102,"./tr":5886,"./tr.js":5886,"./tzl":6963,"./tzl.js":6963,"./tzm":1203,"./tzm-latn":4676,"./tzm-latn.js":4676,"./tzm.js":1203,"./ug-cn":1444,"./ug-cn.js":1444,"./uk":2676,"./uk.js":2676,"./ur":5026,"./ur.js":5026,"./uz":9895,"./uz-latn":1873,"./uz-latn.js":1873,"./uz.js":9895,"./vi":5646,"./vi.js":5646,"./x-pseudo":7377,"./x-pseudo.js":7377,"./yo":9632,"./yo.js":9632,"./zh-cn":5665,"./zh-cn.js":5665,"./zh-hk":627,"./zh-hk.js":627,"./zh-mo":7922,"./zh-mo.js":7922,"./zh-tw":8973,"./zh-tw.js":8973};function i(t){var e=r(t);return o(e)}function r(t){if(!o.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}i.keys=function(){return Object.keys(n)},i.resolve=r,t.exports=i,i.id=5131}},e={};function o(n){var i=e[n];if(void 0!==i)return i.exports;var r=e[n]={id:n,loaded:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.loaded=!0,r.exports}o.m=t,function(){var t=[];o.O=function(e,n,i,r){if(!n){var s=1/0;for(c=0;c<t.length;c++){n=t[c][0],i=t[c][1],r=t[c][2];for(var l=!0,a=0;a<n.length;a++)(!1&r||s>=r)&&Object.keys(o.O).every((function(t){return o.O[t](n[a])}))?n.splice(a--,1):(l=!1,r<s&&(s=r));if(l){t.splice(c--,1);var h=i();void 0!==h&&(e=h)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[n,i,r]}}(),function(){o.d=function(t,e){for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){o.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,n){var i,r,s=n[0],l=n[1],a=n[2],h=0;if(s.some((function(e){return 0!==t[e]}))){for(i in l)o.o(l,i)&&(o.m[i]=l[i]);if(a)var c=a(o)}for(e&&e(n);h<s.length;h++)r=s[h],o.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return o.O(c)},n=self["webpackChunkvue_template"]=self["webpackChunkvue_template"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(4877)}));n=o.O(n)})();
//# sourceMappingURL=app.7031a55b.js.map