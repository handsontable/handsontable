(function(e){function t(t){for(var r,a,l=t[0],s=t[1],u=t[2],f=0,h=[];f<l.length;f++)a=l[f],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&h.push(o[a][0]),o[a]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);c&&c(t);while(h.length)h.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,l=1;l<n.length;l++){var s=n[l];0!==o[s]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={app:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var c=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"2e51":function(e,t,n){},"75e0":function(e,t,n){"use strict";n("2e51")},"9f0c":function(e,t,n){var r={"./af":"f818","./af.js":"f818","./ar":"b5ba","./ar-dz":"9d08","./ar-dz.js":"9d08","./ar-kw":"fd3d","./ar-kw.js":"fd3d","./ar-ly":"0df6","./ar-ly.js":"0df6","./ar-ma":"f5f8","./ar-ma.js":"f5f8","./ar-sa":"86cd","./ar-sa.js":"86cd","./ar-tn":"5830","./ar-tn.js":"5830","./ar.js":"b5ba","./az":"9fdf","./az.js":"9fdf","./be":"4d36","./be.js":"4d36","./bg":"e883","./bg.js":"e883","./bm":"4298","./bm.js":"4298","./bn":"2b2e","./bn-bd":"b971","./bn-bd.js":"b971","./bn.js":"2b2e","./bo":"a8fe","./bo.js":"a8fe","./br":"ab02","./br.js":"ab02","./bs":"cac3","./bs.js":"cac3","./ca":"727c","./ca.js":"727c","./cs":"db15","./cs.js":"db15","./cv":"2866","./cv.js":"2866","./cy":"e2e0","./cy.js":"e2e0","./da":"d190","./da.js":"d190","./de":"5731","./de-at":"6776","./de-at.js":"6776","./de-ch":"6bd9","./de-ch.js":"6bd9","./de.js":"5731","./dv":"7827","./dv.js":"7827","./el":"3350","./el.js":"3350","./en-au":"e68e","./en-au.js":"e68e","./en-ca":"b4a9","./en-ca.js":"b4a9","./en-gb":"2e0f","./en-gb.js":"2e0f","./en-ie":"2007","./en-ie.js":"2007","./en-il":"30dc","./en-il.js":"30dc","./en-in":"5259","./en-in.js":"5259","./en-nz":"fa4c","./en-nz.js":"fa4c","./en-sg":"590d","./en-sg.js":"590d","./eo":"fb0d","./eo.js":"fb0d","./es":"bd0c","./es-do":"fe85","./es-do.js":"fe85","./es-mx":"3f53","./es-mx.js":"3f53","./es-us":"c1c2","./es-us.js":"c1c2","./es.js":"bd0c","./et":"8e51","./et.js":"8e51","./eu":"8047","./eu.js":"8047","./fa":"ace3","./fa.js":"ace3","./fi":"3512","./fi.js":"3512","./fil":"9519","./fil.js":"9519","./fo":"296d","./fo.js":"296d","./fr":"62ae","./fr-ca":"f520","./fr-ca.js":"f520","./fr-ch":"a9d9","./fr-ch.js":"a9d9","./fr.js":"62ae","./fy":"bb83","./fy.js":"bb83","./ga":"faac","./ga.js":"faac","./gd":"4f30","./gd.js":"4f30","./gl":"1f7c","./gl.js":"1f7c","./gom-deva":"835f","./gom-deva.js":"835f","./gom-latn":"daa2","./gom-latn.js":"daa2","./gu":"59f1","./gu.js":"59f1","./he":"b952","./he.js":"b952","./hi":"3630","./hi.js":"3630","./hr":"d705","./hr.js":"d705","./hu":"10c9","./hu.js":"10c9","./hy-am":"4b6a","./hy-am.js":"4b6a","./id":"74fa","./id.js":"74fa","./is":"c329","./is.js":"c329","./it":"ee47","./it-ch":"baae","./it-ch.js":"baae","./it.js":"ee47","./ja":"6b6c","./ja.js":"6b6c","./jv":"ce38","./jv.js":"ce38","./ka":"7ad5","./ka.js":"7ad5","./kk":"1868","./kk.js":"1868","./km":"af4b","./km.js":"af4b","./kn":"6933","./kn.js":"6933","./ko":"3b09","./ko.js":"3b09","./ku":"d7a2","./ku.js":"d7a2","./ky":"44da","./ky.js":"44da","./lb":"3aac","./lb.js":"3aac","./lo":"4d72","./lo.js":"4d72","./lt":"5337","./lt.js":"5337","./lv":"9a31","./lv.js":"9a31","./me":"c9ef","./me.js":"c9ef","./mi":"e590","./mi.js":"e590","./mk":"0492","./mk.js":"0492","./ml":"62fe","./ml.js":"62fe","./mn":"5f6e","./mn.js":"5f6e","./mr":"aa17","./mr.js":"aa17","./ms":"61d0","./ms-my":"8aef","./ms-my.js":"8aef","./ms.js":"61d0","./mt":"695b","./mt.js":"695b","./my":"e0ea","./my.js":"e0ea","./nb":"41e0","./nb.js":"41e0","./ne":"d02b","./ne.js":"d02b","./nl":"69b6","./nl-be":"0728","./nl-be.js":"0728","./nl.js":"69b6","./nn":"fc22","./nn.js":"fc22","./oc-lnc":"8d44","./oc-lnc.js":"8d44","./pa-in":"fa72","./pa-in.js":"fa72","./pl":"8021","./pl.js":"8021","./pt":"cf2a","./pt-br":"97ff","./pt-br.js":"97ff","./pt.js":"cf2a","./ro":"3b5b","./ro.js":"3b5b","./ru":"6883","./ru.js":"6883","./sd":"e8a1","./sd.js":"e8a1","./se":"7db1","./se.js":"7db1","./si":"1386","./si.js":"1386","./sk":"d645","./sk.js":"d645","./sl":"e61f","./sl.js":"e61f","./sq":"ee34","./sq.js":"ee34","./sr":"ea94","./sr-cyrl":"1ab0","./sr-cyrl.js":"1ab0","./sr.js":"ea94","./ss":"e78a","./ss.js":"e78a","./sv":"010c","./sv.js":"010c","./sw":"1450","./sw.js":"1450","./ta":"aa14","./ta.js":"aa14","./te":"beb6","./te.js":"beb6","./tet":"27da","./tet.js":"27da","./tg":"4bde","./tg.js":"4bde","./th":"2dd6","./th.js":"2dd6","./tk":"478a","./tk.js":"478a","./tl-ph":"a36c","./tl-ph.js":"a36c","./tlh":"86c9","./tlh.js":"86c9","./tr":"6755","./tr.js":"6755","./tzl":"5cfd","./tzl.js":"5cfd","./tzm":"4812","./tzm-latn":"6636","./tzm-latn.js":"6636","./tzm.js":"4812","./ug-cn":"ab75","./ug-cn.js":"ab75","./uk":"9f61","./uk.js":"9f61","./ur":"adf5","./ur.js":"adf5","./uz":"fb6d","./uz-latn":"9d50","./uz-latn.js":"9d50","./uz.js":"fb6d","./vi":"99a5","./vi.js":"99a5","./x-pseudo":"c3cf","./x-pseudo.js":"c3cf","./yo":"3ed5","./yo.js":"3ed5","./zh-cn":"eb15","./zh-cn.js":"eb15","./zh-hk":"b7e2","./zh-hk.js":"b7e2","./zh-mo":"b829","./zh-mo.js":"b829","./zh-tw":"1abb","./zh-tw.js":"1abb"};function o(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id="9f0c"},cbfe:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"requestAnimationFrame",(function(){return T})),n.d(r,"isClassListSupported",(function(){return P})),n.d(r,"isTextContentSupported",(function(){return M})),n.d(r,"isGetComputedStyleSupported",(function(){return A})),n.d(r,"cancelAnimationFrame",(function(){return I})),n.d(r,"isTouchSupported",(function(){return j})),n.d(r,"hasCaptionProblem",(function(){return _})),n.d(r,"getComparisonFunction",(function(){return H})),n.d(r,"isPassiveEventSupported",(function(){return D}));var o={};n.r(o),n.d(o,"to2dArray",(function(){return N})),n.d(o,"extendArray",(function(){return L})),n.d(o,"pivot",(function(){return B})),n.d(o,"arrayReduce",(function(){return V})),n.d(o,"arrayFilter",(function(){return F})),n.d(o,"arrayMap",(function(){return W})),n.d(o,"arrayEach",(function(){return U})),n.d(o,"arraySum",(function(){return z})),n.d(o,"arrayMax",(function(){return G})),n.d(o,"arrayMin",(function(){return Y})),n.d(o,"arrayAvg",(function(){return K})),n.d(o,"arrayFlatten",(function(){return X})),n.d(o,"arrayUnique",(function(){return $})),n.d(o,"getDifferenceOfArrays",(function(){return q})),n.d(o,"getIntersectionOfArrays",(function(){return Q})),n.d(o,"getUnionOfArrays",(function(){return J})),n.d(o,"stringToArray",(function(){return Z}));var i={};n.r(i),n.d(i,"duckSchema",(function(){return ne})),n.d(i,"inherit",(function(){return re})),n.d(i,"extend",(function(){return oe})),n.d(i,"deepExtend",(function(){return ie})),n.d(i,"deepClone",(function(){return ae})),n.d(i,"clone",(function(){return le})),n.d(i,"mixin",(function(){return se})),n.d(i,"isObjectEqual",(function(){return ue})),n.d(i,"isObject",(function(){return ce})),n.d(i,"defineGetter",(function(){return fe})),n.d(i,"objectEach",(function(){return he})),n.d(i,"getProperty",(function(){return de})),n.d(i,"setProperty",(function(){return pe})),n.d(i,"deepObjectSize",(function(){return ye})),n.d(i,"createObjectPropListener",(function(){return ve})),n.d(i,"hasOwnProperty",(function(){return ge}));var a={};n.r(a),n.d(a,"setBrowserMeta",(function(){return Ce})),n.d(a,"setPlatformMeta",(function(){return Se})),n.d(a,"isChrome",(function(){return Oe})),n.d(a,"isChromeWebKit",(function(){return ke})),n.d(a,"isFirefox",(function(){return Re})),n.d(a,"isFirefoxWebKit",(function(){return Ee})),n.d(a,"isSafari",(function(){return Te})),n.d(a,"isEdge",(function(){return Pe})),n.d(a,"isEdgeWebKit",(function(){return Me})),n.d(a,"isIE",(function(){return Ae})),n.d(a,"isIE9",(function(){return Ie})),n.d(a,"isMSBrowser",(function(){return je})),n.d(a,"isMobileBrowser",(function(){return xe})),n.d(a,"isIOS",(function(){return _e})),n.d(a,"isIpadOS",(function(){return He})),n.d(a,"isWindowsOS",(function(){return De})),n.d(a,"isMacOS",(function(){return Ne})),n.d(a,"isLinuxOS",(function(){return Le}));var l={};n.r(l),n.d(l,"stringify",(function(){return qe})),n.d(l,"isDefined",(function(){return Qe})),n.d(l,"isUndefined",(function(){return Je})),n.d(l,"isEmpty",(function(){return Ze})),n.d(l,"isRegExp",(function(){return et})),n.d(l,"_injectProductInfo",(function(){return yt}));var s={};n.r(s),n.d(s,"toUpperCaseFirst",(function(){return gt})),n.d(s,"equalsIgnoreCase",(function(){return mt})),n.d(s,"randomString",(function(){return bt})),n.d(s,"isPercentValue",(function(){return wt})),n.d(s,"substitute",(function(){return Ct})),n.d(s,"stripTags",(function(){return St})),n.d(s,"sanitize",(function(){return Ot}));var u={};n.r(u),n.d(u,"getParent",(function(){return At})),n.d(u,"getFrameElement",(function(){return It})),n.d(u,"getParentWindow",(function(){return jt})),n.d(u,"hasAccessToParentWindow",(function(){return xt})),n.d(u,"closest",(function(){return _t})),n.d(u,"closestDown",(function(){return Ht})),n.d(u,"isChildOf",(function(){return Dt})),n.d(u,"index",(function(){return Nt})),n.d(u,"overlayContainsElement",(function(){return Lt})),n.d(u,"hasClass",(function(){return Wt})),n.d(u,"addClass",(function(){return Ut})),n.d(u,"removeClass",(function(){return zt})),n.d(u,"removeTextNodes",(function(){return Gt})),n.d(u,"empty",(function(){return Yt})),n.d(u,"HTML_CHARACTERS",(function(){return Xt})),n.d(u,"fastInnerHTML",(function(){return $t})),n.d(u,"fastInnerText",(function(){return qt})),n.d(u,"isVisible",(function(){return Qt})),n.d(u,"offset",(function(){return Jt})),n.d(u,"getWindowScrollTop",(function(){return Zt})),n.d(u,"getWindowScrollLeft",(function(){return en})),n.d(u,"getScrollTop",(function(){return tn})),n.d(u,"getScrollLeft",(function(){return nn})),n.d(u,"getScrollableElement",(function(){return rn})),n.d(u,"getTrimmingContainer",(function(){return on})),n.d(u,"getStyle",(function(){return an})),n.d(u,"matchesCSSRules",(function(){return ln})),n.d(u,"getComputedStyle",(function(){return sn})),n.d(u,"outerWidth",(function(){return un})),n.d(u,"outerHeight",(function(){return cn})),n.d(u,"innerHeight",(function(){return fn})),n.d(u,"innerWidth",(function(){return hn})),n.d(u,"addEvent",(function(){return dn})),n.d(u,"removeEvent",(function(){return pn})),n.d(u,"getCaretPosition",(function(){return yn})),n.d(u,"getSelectionEndPosition",(function(){return vn})),n.d(u,"getSelectionText",(function(){return gn})),n.d(u,"clearTextSelection",(function(){return mn})),n.d(u,"setCaretPosition",(function(){return bn})),n.d(u,"getScrollbarWidth",(function(){return Cn})),n.d(u,"hasVerticalScrollbar",(function(){return Sn})),n.d(u,"hasHorizontalScrollbar",(function(){return On})),n.d(u,"setOverlayPosition",(function(){return kn})),n.d(u,"getCssTransform",(function(){return Rn})),n.d(u,"resetCssTransform",(function(){return En})),n.d(u,"isInput",(function(){return Tn})),n.d(u,"isOutsideInput",(function(){return Pn})),n.d(u,"selectElementIfAllowed",(function(){return Mn})),n.d(u,"isDetached",(function(){return An})),n.d(u,"observeVisibilityChangeOnce",(function(){return In}));var c={};n.r(c),n.d(c,"isFunction",(function(){return jn})),n.d(c,"throttle",(function(){return xn})),n.d(c,"throttleAfterHits",(function(){return _n})),n.d(c,"debounce",(function(){return Hn})),n.d(c,"pipe",(function(){return Dn})),n.d(c,"partial",(function(){return Nn})),n.d(c,"curry",(function(){return Ln})),n.d(c,"curryRight",(function(){return Bn})),n.d(c,"fastCall",(function(){return Vn}));var f={};n.r(f),n.d(f,"KEY_CODES",(function(){return zn})),n.d(f,"isPrintableChar",(function(){return Yn})),n.d(f,"isFunctionKey",(function(){return Kn})),n.d(f,"isCtrlKey",(function(){return Xn})),n.d(f,"isCtrlMetaKey",(function(){return $n})),n.d(f,"isKey",(function(){return qn}));var h={};n.r(h),n.d(h,"stopImmediatePropagation",(function(){return Qn})),n.d(h,"isImmediatePropagationStopped",(function(){return Jn})),n.d(h,"isRightClick",(function(){return Zn})),n.d(h,"isLeftClick",(function(){return er}));var d={};n.r(d),n.d(d,"instanceToHTML",(function(){return so})),n.d(d,"_dataToHTML",(function(){return uo})),n.d(d,"htmlToGridSettings",(function(){return co}));var p={};n.r(p),n.d(p,"isNumeric",(function(){return bo})),n.d(p,"isNumericLike",(function(){return wo})),n.d(p,"rangeEach",(function(){return Co})),n.d(p,"rangeEachReverse",(function(){return So})),n.d(p,"valueAccordingPercent",(function(){return Oo}));var y={};n.r(y),n.d(y,"spreadsheetColumnLabel",(function(){return yp})),n.d(y,"spreadsheetColumnIndex",(function(){return vp})),n.d(y,"createSpreadsheetData",(function(){return gp})),n.d(y,"createSpreadsheetObjectData",(function(){return mp})),n.d(y,"createEmptySpreadsheetData",(function(){return bp})),n.d(y,"dataRowToChangesArray",(function(){return wp})),n.d(y,"countFirstRowKeys",(function(){return Cp})),n.d(y,"isArrayOfArrays",(function(){return Sp})),n.d(y,"isArrayOfObjects",(function(){return Op}));var v={};n.r(v),n.d(v,"CONTEXT_MENU_ITEMS_NAMESPACE",(function(){return Bg})),n.d(v,"CONTEXTMENU_ITEMS_NO_ITEMS",(function(){return Fg})),n.d(v,"CONTEXTMENU_ITEMS_ROW_ABOVE",(function(){return Wg})),n.d(v,"CONTEXTMENU_ITEMS_ROW_BELOW",(function(){return Ug})),n.d(v,"CONTEXTMENU_ITEMS_INSERT_LEFT",(function(){return zg})),n.d(v,"CONTEXTMENU_ITEMS_INSERT_RIGHT",(function(){return Gg})),n.d(v,"CONTEXTMENU_ITEMS_REMOVE_ROW",(function(){return Yg})),n.d(v,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",(function(){return Kg})),n.d(v,"CONTEXTMENU_ITEMS_UNDO",(function(){return Xg})),n.d(v,"CONTEXTMENU_ITEMS_REDO",(function(){return $g})),n.d(v,"CONTEXTMENU_ITEMS_READ_ONLY",(function(){return qg})),n.d(v,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",(function(){return Qg})),n.d(v,"CONTEXTMENU_ITEMS_COPY",(function(){return Jg})),n.d(v,"CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS",(function(){return Zg})),n.d(v,"CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS",(function(){return em})),n.d(v,"CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY",(function(){return tm})),n.d(v,"CONTEXTMENU_ITEMS_CUT",(function(){return nm})),n.d(v,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",(function(){return rm})),n.d(v,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",(function(){return om})),n.d(v,"CONTEXTMENU_ITEMS_MERGE_CELLS",(function(){return im})),n.d(v,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",(function(){return am})),n.d(v,"CONTEXTMENU_ITEMS_ADD_COMMENT",(function(){return lm})),n.d(v,"CONTEXTMENU_ITEMS_EDIT_COMMENT",(function(){return sm})),n.d(v,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",(function(){return um})),n.d(v,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",(function(){return cm})),n.d(v,"CONTEXTMENU_ITEMS_ALIGNMENT",(function(){return fm})),n.d(v,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",(function(){return hm})),n.d(v,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",(function(){return dm})),n.d(v,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",(function(){return pm})),n.d(v,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",(function(){return ym})),n.d(v,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",(function(){return vm})),n.d(v,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",(function(){return gm})),n.d(v,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",(function(){return mm})),n.d(v,"CONTEXTMENU_ITEMS_BORDERS",(function(){return bm})),n.d(v,"CONTEXTMENU_ITEMS_BORDERS_TOP",(function(){return wm})),n.d(v,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",(function(){return Cm})),n.d(v,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",(function(){return Sm})),n.d(v,"CONTEXTMENU_ITEMS_BORDERS_LEFT",(function(){return Om})),n.d(v,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",(function(){return km})),n.d(v,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",(function(){return Rm})),n.d(v,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",(function(){return Em})),n.d(v,"CONTEXTMENU_ITEMS_HIDE_COLUMN",(function(){return Tm})),n.d(v,"CONTEXTMENU_ITEMS_SHOW_COLUMN",(function(){return Pm})),n.d(v,"CONTEXTMENU_ITEMS_HIDE_ROW",(function(){return Mm})),n.d(v,"CONTEXTMENU_ITEMS_SHOW_ROW",(function(){return Am})),n.d(v,"FILTERS_NAMESPACE",(function(){return Im})),n.d(v,"FILTERS_CONDITIONS_NAMESPACE",(function(){return jm})),n.d(v,"FILTERS_CONDITIONS_NONE",(function(){return xm})),n.d(v,"FILTERS_CONDITIONS_EMPTY",(function(){return _m})),n.d(v,"FILTERS_CONDITIONS_NOT_EMPTY",(function(){return Hm})),n.d(v,"FILTERS_CONDITIONS_EQUAL",(function(){return Dm})),n.d(v,"FILTERS_CONDITIONS_NOT_EQUAL",(function(){return Nm})),n.d(v,"FILTERS_CONDITIONS_BEGINS_WITH",(function(){return Lm})),n.d(v,"FILTERS_CONDITIONS_ENDS_WITH",(function(){return Bm})),n.d(v,"FILTERS_CONDITIONS_CONTAINS",(function(){return Vm})),n.d(v,"FILTERS_CONDITIONS_NOT_CONTAIN",(function(){return Fm})),n.d(v,"FILTERS_CONDITIONS_BY_VALUE",(function(){return Wm})),n.d(v,"FILTERS_CONDITIONS_GREATER_THAN",(function(){return Um})),n.d(v,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",(function(){return zm})),n.d(v,"FILTERS_CONDITIONS_LESS_THAN",(function(){return Gm})),n.d(v,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",(function(){return Ym})),n.d(v,"FILTERS_CONDITIONS_BETWEEN",(function(){return Km})),n.d(v,"FILTERS_CONDITIONS_NOT_BETWEEN",(function(){return Xm})),n.d(v,"FILTERS_CONDITIONS_AFTER",(function(){return $m})),n.d(v,"FILTERS_CONDITIONS_BEFORE",(function(){return qm})),n.d(v,"FILTERS_CONDITIONS_TODAY",(function(){return Qm})),n.d(v,"FILTERS_CONDITIONS_TOMORROW",(function(){return Jm})),n.d(v,"FILTERS_CONDITIONS_YESTERDAY",(function(){return Zm})),n.d(v,"FILTERS_DIVS_FILTER_BY_CONDITION",(function(){return eb})),n.d(v,"FILTERS_DIVS_FILTER_BY_VALUE",(function(){return tb})),n.d(v,"FILTERS_LABELS_CONJUNCTION",(function(){return nb})),n.d(v,"FILTERS_LABELS_DISJUNCTION",(function(){return rb})),n.d(v,"FILTERS_VALUES_BLANK_CELLS",(function(){return ob})),n.d(v,"FILTERS_BUTTONS_SELECT_ALL",(function(){return ib})),n.d(v,"FILTERS_BUTTONS_CLEAR",(function(){return ab})),n.d(v,"FILTERS_BUTTONS_OK",(function(){return lb})),n.d(v,"FILTERS_BUTTONS_CANCEL",(function(){return sb})),n.d(v,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",(function(){return ub})),n.d(v,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",(function(){return cb})),n.d(v,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",(function(){return fb}));var g={};n.r(g),n.d(g,"getNormalizedDate",(function(){return oA}));var m,b,w,C=n("e832"),S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("DataGrid")],1)},O=[],k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"example"}},[n("hot-table",{ref:"hotTableComponent",attrs:{data:e.data,settings:e.hotSettings}})],1)},R=[];n("2b96"),n("3d35"),n("213d"),n("0a66"),n("6b2f"),n("8116"),n("bebe"),n("bdb6"),n("5d07"),n("d562"),n("267c"),n("0b09"),n("9827"),n("4e92"),n("acdb"),n("b43b"),n("2a17"),n("1eaf"),n("60ed"),n("2931"),n("7ae5"),n("841e"),n("212c"),n("edaf"),n("d3af"),n("74b4"),n("5350"),n("a0c5"),n("83a9"),n("986e"),n("129d"),n("2cf3"),n("bfe9"),n("9dec"),n("ba9f");function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function T(e){return window.requestAnimationFrame(e)}function P(){return!!document.documentElement.classList}function M(){return!!document.createTextNode("test").textContent}function A(){return!!window.getComputedStyle}function I(e){window.cancelAnimationFrame(e)}function j(){return"ontouchstart"in window}function x(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding="0",n.style.margin="0",e.insertBefore(n,t),document.body.appendChild(e),m=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function _(){return void 0===m&&x(),m}function H(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return b||(b="object"===("undefined"===typeof Intl?"undefined":E(Intl))?new Intl.Collator(e,t).compare:"function"===typeof String.prototype.localeCompare?function(e,t){return"".concat(e).localeCompare(t)}:function(e,t){return e===t?0:e>t?-1:1},b)}function D(){if(void 0!==w)return w;try{var e={get passive(){w=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(t){w=!1}return w}n("b503");function N(e){var t=e.length,n=0;while(n<t)e[n]=[e[n]],n+=1}function L(e,t){var n=t.length,r=0;while(r<n)e.push(t[r]),r+=1}function B(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var n=e.length,r=e[0].length,o=0;o<n;o++)for(var i=0;i<r;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function V(e,t,n,r){var o=-1,i=e,a=n;Array.isArray(e)||(i=Array.from(e));var l=i.length;r&&l&&(o+=1,a=i[o]),o+=1;while(o<l)a=t(a,i[o],o,i),o+=1;return a}function F(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));var o=r.length,i=[],a=-1;while(n<o){var l=r[n];t(l,n,r)&&(a+=1,i[a]=l),n+=1}return i}function W(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));var o=r.length,i=[],a=-1;while(n<o){var l=r[n];a+=1,i[a]=t(l,n,r),n+=1}return i}function U(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));var o=r.length;while(n<o){if(!1===t(r[n],n,r))break;n+=1}return e}function z(e){return V(e,(function(e,t){return e+t}),0)}function G(e){return V(e,(function(e,t){return e>t?e:t}),Array.isArray(e)?e[0]:void 0)}function Y(e){return V(e,(function(e,t){return e<t?e:t}),Array.isArray(e)?e[0]:void 0)}function K(e){return e.length?z(e)/e.length:0}function X(e){return V(e,(function(e,t){return e.concat(Array.isArray(t)?X(t):t)}),[])}function $(e){var t=[];return U(e,(function(e){-1===t.indexOf(e)&&t.push(e)})),t}function q(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],i=r.slice(1),a=o;return U(i,(function(e){a=a.filter((function(t){return!e.includes(t)}))})),a}function Q(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],i=r.slice(1),a=o;return U(i,(function(e){a=a.filter((function(t){return e.includes(t)}))})),a}function J(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],i=r.slice(1),a=new Set(o);return U(i,(function(e){U(e,(function(e){a.has(e)||a.add(e)}))})),Array.from(a)}function Z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function te(e){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},te(e)}function ne(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},he(e,(function(e,n){"__children"!==n&&(e&&"object"===te(e)&&!Array.isArray(e)?t[n]=ne(e):Array.isArray(e)?e.length&&"object"===te(e[0])&&!Array.isArray(e[0])?t[n]=[ne(e[0])]:t[n]=[]:t[n]=null)}))),t}function re(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function oe(e,t,n){var r=Array.isArray(n);return he(t,(function(t,o){(!1===r||n.includes(o))&&(e[o]=t)})),e}function ie(e,t){he(t,(function(n,r){t[r]&&"object"===te(t[r])?(e[r]||(Array.isArray(t[r])?e[r]=[]:"[object Date]"===Object.prototype.toString.call(t[r])?e[r]=t[r]:e[r]={}),ie(e[r],t[r])):e[r]=t[r]}))}function ae(e){return"object"===te(e)?JSON.parse(JSON.stringify(e)):e}function le(e){var t={};return he(e,(function(e,n){t[n]=e})),t}function se(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return U(n,(function(t){e.MIXINS.push(t.MIXIN_NAME),he(t,(function(t,n){if(void 0!==e.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));if("function"===typeof t)e.prototype[n]=t;else{var r=function(e,t){var n="_".concat(e),r=function(e){var t=e;return(Array.isArray(t)||ce(t))&&(t=ae(t)),t};return function(){return void 0===this[n]&&(this[n]=r(t)),this[n]}},o=function(e){var t="_".concat(e);return function(e){this[t]=e}};Object.defineProperty(e.prototype,n,{get:r(n,t),set:o(n),configurable:!0})}}))})),e}function ue(e,t){return JSON.stringify(e)===JSON.stringify(t)}function ce(e){return"[object Object]"===Object.prototype.toString.call(e)}function fe(e,t,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(e,t,r)}function he(e,t){for(var n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,n))&&!1===t(e[n],n,e))break;return e}function de(e,t){var n=t.split("."),r=e;return he(n,(function(e){if(r=r[e],void 0===r)return r=void 0,!1})),r}function pe(e,t,n){var r=t.split("."),o=e;r.forEach((function(e,t){t!==r.length-1?(ge(o,e)||(o[e]={}),o=o[e]):o[e]=n}))}function ye(e){if(!ce(e))return 0;var t=function e(t){var n=0;return ce(t)?he(t,(function(t,r){"__children"!==r&&(n+=e(t))})):n+=1,n};return t(e)}function ve(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r="_".concat(n),o=(t={_touched:!1},ee(t,r,e),ee(t,"isTouched",(function(){return this._touched})),t);return Object.defineProperty(o,n,{get:function(){return this[r]},set:function(e){this._touched=!0,this[r]=e},enumerable:!0,configurable:!0}),o}function ge(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var me=function(e){var t={value:!1,test:function(n,r){t.value=e(n,r)}};return t},be={chrome:me((function(e,t){return/Chrome/.test(e)&&/Google/.test(t)})),chromeWebKit:me((function(e){return/CriOS/.test(e)})),edge:me((function(e){return/Edge/.test(e)})),edgeWebKit:me((function(e){return/EdgiOS/.test(e)})),firefox:me((function(e){return/Firefox/.test(e)})),firefoxWebKit:me((function(e){return/FxiOS/.test(e)})),ie:me((function(e){return/Trident/.test(e)})),ie9:me((function(){return!!document.documentMode})),mobile:me((function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)})),safari:me((function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)}))},we={mac:me((function(e){return/^Mac/.test(e)})),win:me((function(e){return/^Win/.test(e)})),linux:me((function(e){return/^Linux/.test(e)})),ios:me((function(e){return/iPhone|iPad|iPod/i.test(e)}))};function Ce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userAgent,n=void 0===t?navigator.userAgent:t,r=e.vendor,o=void 0===r?navigator.vendor:r;he(be,(function(e){var t=e.test;t(n,o)}))}function Se(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.platform,n=void 0===t?navigator.platform:t;he(we,(function(e){var t=e.test;t(n)}))}function Oe(){return be.chrome.value}function ke(){return be.chromeWebKit.value}function Re(){return be.firefox.value}function Ee(){return be.firefoxWebKit.value}function Te(){return be.safari.value}function Pe(){return be.edge.value}function Me(){return be.edgeWebKit.value}function Ae(){return be.ie.value}function Ie(){return be.ie9.value}function je(){return be.ie.value||be.edge.value}function xe(){return be.mobile.value}function _e(){return we.ios.value}function He(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&we.mac.value}function De(){return we.win.value}function Ne(){return we.mac.value}function Le(){return we.linux.value}Ce(),Se();var Be,Ve,Fe,We,Ue,ze,Ge=n("780f"),Ye=(n("3647"),n("970e"),n("1f22"));function Ke(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=V(e,(function(e,t,r){var o=t.replace(/\r?\n\s*/g,""),i=n[r]?n[r]:"";return e+o+i}),"");return o.trim()}function Xe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function $e(e){return $e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$e(e)}function qe(e){var t;switch($e(e)){case"string":case"number":t="".concat(e);break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function Qe(e){return"undefined"!==typeof e}function Je(e){return"undefined"===typeof e}function Ze(e){return null===e||""===e||Je(e)}function et(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var tt,nt,rt,ot="length",it=function(e){return parseInt(e,16)},at=function(e){return parseInt(e,10)},lt=function(e,t,n){return e["substr"](t,n)},st=function(e){return e["codePointAt"](0)-65},ut=function(e){return"".concat(e).replace(/\-/g,"")},ct=function(e){return it(lt(ut(e),it("12"),st("F")))/(it(lt(ut(e),st("B"),~~![][ot]))||9)},ft=function(){return"undefined"!==typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},ht=!1,dt={invalid:function(){return Ke(Be||(Be=Xe(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."])))},expired:function(e){var t=e.keyValidityDate,n=e.hotVersion;return Ke(Ve||(Ve=Xe(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."])),t,n,t)},missing:function(){return Ke(Fe||(Fe=Xe(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."])))},non_commercial:function(){return""}},pt={invalid:function(){return Ke(We||(We=Xe(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},expired:function(e){var t=e.keyValidityDate,n=e.hotVersion;return Ke(Ue||(Ue=Xe(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'])),t,n,t)},missing:function(){return Ke(ze||(ze=Xe(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},non_commercial:function(){return""}};function yt(e,t){var n,r=!Ze(e),o="string"===typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),i="12.3.0",a="invalid",l="invalid";e=ut(e||"");var s=vt(e);if(r||o||s)if(s){var u=Ye("14/12/2022","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),f=ct(e);n=Ye(864e5*(f+1),"x").format("MMMM DD, YYYY"),c>f?(a="expired",l="expired"):(a="valid",l="valid")}else o?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(ft()&&(a="valid",l="valid"),!ht&&"valid"!==a){var h=dt[a]({keyValidityDate:n,hotVersion:i});h&&console["non_commercial"===a?"info":"warn"](dt[a]({keyValidityDate:n,hotVersion:i})),ht=!0}if("valid"!==l&&t.parentNode){var d=pt[l]({keyValidityDate:n,hotVersion:i});if(d){var p=document.createElement("div");p.className="hot-display-license-info",p.innerHTML=pt[l]({keyValidityDate:n,hotVersion:i}),t.parentNode.insertBefore(p,t.nextSibling)}}}function vt(e){var t=[][ot],n=t;if(e[ot]!==st("Z"))return!1;for(var r="",o="B<H4P+".split(""),i=st(o.shift());i;i=st(o.shift()||"A"))--i<""[ot]?n|=(at("".concat(at(it(r)+(it(lt(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:r=lt(e,i,i?1===o[ot]?9:8:6);return n===t}function gt(e){return e[0].toUpperCase()+e.substr(1)}function mt(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=n.length;while(o){o-=1;var i=qe(n[o]).toLowerCase();-1===e.indexOf(i)&&e.push(i)}return 1===e.length}function bt(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function wt(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function Ct(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,(function(e,n){return"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n]}))}function St(e){return Ot("".concat(e),{ALLOWED_TAGS:[]})}function Ot(e,t){return Ge.sanitize(e,t)}function kt(e){return Pt(e)||Tt(e)||Et(e)||Rt()}function Rt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Et(e,t){if(e){if("string"===typeof e)return Mt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mt(e,t):void 0}}function Tt(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Pt(e){if(Array.isArray(e))return Mt(e)}function Mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function At(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,o=e;while(null!==o){if(n===t){r=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(n+=1,o=o.parentNode)}return r}function It(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function jt(e){return It(e)&&e.parent}function xt(e){return!!Object.getPrototypeOf(e.parent)}function _t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=Node,o=r.ELEMENT_NODE,i=r.DOCUMENT_FRAGMENT_NODE,a=e;while(null!==a&&void 0!==a&&a!==n){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(t.includes(u)||t.includes(a)))return a;var c=a,f=c.host;a=f&&s===i?f:a.parentNode}return null}function Ht(e,t,n){var r=[],o=e;while(o){if(o=_t(o,t,n),!o||n&&!n.contains(o))break;r.push(o),o=o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode}var i=r.length;return i?r[i-1]:null}function Dt(e,t){var n=e.parentNode,r=[];"string"===typeof t?r=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);while(null!==n){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Nt(e){var t=0,n=e;if(n.previousSibling)while(n=n.previousSibling)t+=1;return t}function Lt(e,t,n){var r=n.parentElement.querySelector(".ht_clone_".concat(e));return r?r.contains(t):null}function Bt(e){return e&&e.length?e.filter((function(e){return!!e})):[]}if(P()){var Vt=function(e){var t=e.createElement("div");return t.classList.add("test","test2"),t.classList.contains("test2")};tt=function(e,t){return void 0!==e.classList&&"string"===typeof t&&""!==t&&e.classList.contains(t)},nt=function(e,t){var n=e.ownerDocument,r=t;if("string"===typeof r&&(r=r.split(" ")),r=Bt(r),r.length>0)if(Vt(n)){var o;(o=e.classList).add.apply(o,kt(r))}else{var i=0;while(r[i])e.classList.add(r[i]),i+=1}},rt=function(e,t){var n=e.ownerDocument,r=t;if("string"===typeof r&&(r=r.split(" ")),r=Bt(r),r.length>0)if(Vt(n)){var o;(o=e.classList).remove.apply(o,kt(r))}else{var i=0;while(r[i])e.classList.remove(r[i]),i+=1}}}else{var Ft=function(e){return new RegExp("(\\s|^)".concat(e,"(\\s|$)"))};tt=function(e,t){return void 0!==e.className&&Ft(t).test(e.className)},nt=function(e,t){var n=e.className,r=t;if("string"===typeof r&&(r=r.split(" ")),r=Bt(r),""===n)n=r.join(" ");else for(var o=0;o<r.length;o++)r[o]&&!Ft(r[o]).test(n)&&(n+=" ".concat(r[o]));e.className=n},rt=function(e,t){var n=0,r=e.className,o=t;"string"===typeof o&&(o=o.split(" ")),o=Bt(o);while(o[n])r=r.replace(Ft(o[n])," ").trim(),n+=1;e.className!==r&&(e.className=r)}}function Wt(e,t){return tt(e,t)}function Ut(e,t){nt(e,t)}function zt(e,t){rt(e,t)}function Gt(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,n=t.length-1;n>=0;n--)Gt(t[n])}function Yt(e){var t;while(t=e.lastChild)e.removeChild(t)}var Kt,Xt=/(<(.*)>|&(.*);)/;function $t(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Xt.test(t)?e.innerHTML=n?Ot(t):t:qt(e,t)}function qt(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?M?n.textContent=t:n.data=t:(Yt(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function Qt(e){var t=e.ownerDocument.documentElement,n=e;while(n!==t){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return Qt(n.host.impl);if(n.host)return Qt(n.host);throw new Error("Lost in Web Components world")}return!1}if(n.style&&"none"===n.style.display)return!1;n=n.parentNode}return!0}function Jt(e){var t,n,r,o,i=e.ownerDocument,a=i.defaultView,l=i.documentElement,s=e;if(_()&&s.firstChild&&"CAPTION"===s.firstChild.nodeName)return o=s.getBoundingClientRect(),{top:o.top+(a.pageYOffset||l.scrollTop)-(l.clientTop||0),left:o.left+(a.pageXOffset||l.scrollLeft)-(l.clientLeft||0)};t=s.offsetLeft,n=s.offsetTop,r=s;while(s=s.offsetParent){if(s===i.body)break;t+=s.offsetLeft,n+=s.offsetTop,r=s}return r&&"fixed"===r.style.position&&(t+=a.pageXOffset||l.scrollLeft,n+=a.pageYOffset||l.scrollTop),{left:t,top:n}}function Zt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollY;return void 0===t&&(t=e.document.documentElement.scrollTop),t}function en(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollX;return void 0===t&&(t=e.document.documentElement.scrollLeft),t}function tn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?Zt(t):e.scrollTop}function nn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?en(t):e.scrollLeft}function rn(e){var t=e.ownerDocument,n=t?t.defaultView:void 0;t||(t=e.document?e.document:e,n=t.defaultView);var r=["auto","scroll"],o=A(),i=e.parentNode;while(i&&i.style&&t.body!==i){var a=i.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return i;if(o){var c=n.getComputedStyle(i);if(l=c.overflow,s=c.overflowX,u=c.overflowY,r.includes(l)||r.includes(s)||r.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(r.includes(u)||r.includes(l)))return i;if(i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(l)))return i;i=i.parentNode}return n}function on(e){var t=e.ownerDocument,n=t.defaultView,r=e.parentNode;while(r&&r.style&&t.body!==r){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;var o=sn(r,n),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return r;r=r.parentNode}return n}function an(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(e){if(e===n)return"width"===t?"".concat(n.innerWidth,"px"):"height"===t?"".concat(n.innerHeight,"px"):void 0;var r=e.style[t];if(""!==r&&void 0!==r)return r;var o=sn(e,n);return""!==o[t]&&void 0!==o[t]?o[t]:void 0}}function ln(e,t){var n=t.selectorText,r=!1;return t.type===CSSRule.STYLE_RULE&&n&&(e.msMatchesSelector?r=e.msMatchesSelector(n):e.matches&&(r=e.matches(n))),r}function sn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function un(e){return e.offsetWidth}function cn(e){return _()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function fn(e){return e.clientHeight||e.innerHeight}function hn(e){return e.clientWidth||e.innerWidth}function dn(e,t,n){e.addEventListener(t,n,!1)}function pn(e,t,n){e.removeEventListener(t,n,!1)}function yn(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var n=t.selection.createRange();if(null===n)return 0;var r=e.createTextRange(),o=r.duplicate();return r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length}return 0}function vn(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var n=t.selection.createRange();if(null===n)return 0;var r=e.createTextRange();return r.text.indexOf(n.text)+n.text.length}return 0}function gn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document,n="";return e.getSelection?n=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(n=t.selection.createRange().text),n}function mn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function bn(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(i){var r=e.parentNode,o=r.style.display;r.style.display="block",e.setSelectionRange(t,n),r.style.display=o}}}function wn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var n=e.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n);var r=t.offsetWidth;n.style.overflow="scroll";var o=t.offsetWidth;return r===o&&(o=n.clientWidth),(e.body||e.documentElement).removeChild(n),r-o}function Cn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===Kt&&(Kt=wn(e)),Kt}function Sn(e){return e.offsetWidth!==e.clientWidth}function On(e){return e.offsetHeight!==e.clientHeight}function kn(e,t,n){Ie()?(e.style.top=n,e.style.left=t):Te()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(n,",0)"):e.style.transform="translate3d(".concat(t,",").concat(n,",0)")}function Rn(e){var t;return e.style.transform&&""!==(t=e.style.transform)?["transform",t]:e.style["-webkit-transform"]&&""!==(t=e.style["-webkit-transform"])?["-webkit-transform",t]:-1}function En(e){e.style.transform&&""!==e.style.transform?e.style.transform="":e.style["-webkit-transform"]&&""!==e.style["-webkit-transform"]&&(e.style["-webkit-transform"]="")}function Tn(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function Pn(e){return Tn(e)&&!1===e.hasAttribute("data-hot-input")}function Mn(e){var t=e.ownerDocument.activeElement;Pn(t)||e.select()}function An(e){return!e.parentNode}function In(e,t){var n=new IntersectionObserver((function(n,r){n.forEach((function(n){n.isIntersecting&&null!==e.offsetParent&&(t(),r.unobserve(e))}))}),{root:e.ownerDocument.body});n.observe(e)}function jn(e){return"function"===typeof e}function xn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0,r={lastCallThrottled:!0},o=null;function i(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];var u=Date.now(),c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);var f=t-(u-n);return c?(r.lastCallThrottled=!1,e.apply(this,l)):(o&&clearTimeout(o),o=setTimeout((function(){r.lastCallThrottled=!1,e.apply(i,l),n=0,o=void 0}),f)),r}return i}function _n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=xn(e,t),o=n;function i(){o=n}function a(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return o?(o-=1,e.apply(this,n)):r.apply(this,n)}return a.clearHits=i,a}function Hn(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;function o(){for(var o=this,i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout((function(){t=e.apply(o,a)}),n),t}return o}function Dn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],o=t.slice(1);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return V(o,(function(e,t){return t(e)}),r.apply(this,t))}}function Nn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return e.apply(this,n.concat(r))}}function Ln(e){var t=e.length;function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var l,s=r.concat(i);return l=s.length>=t?e.apply(this,s):n(s),l}}return n([])}function Bn(e){var t=e.length;function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var l,s=r.concat(i.reverse());return l=s.length>=t?e.apply(this,s):n(s),l}}return n([])}function Vn(e,t,n,r,o,i,a,l){return Qe(l)?e.call(t,n,r,o,i,a,l):Qe(a)?e.call(t,n,r,o,i,a):Qe(i)?e.call(t,n,r,o,i):Qe(o)?e.call(t,n,r,o):Qe(r)?e.call(t,n,r):Qe(n)?e.call(t,n):e.call(t)}function Fn(){var e;Qe(console)&&(e=console).warn.apply(e,arguments)}function Wn(){var e;Qe(console)&&(e=console).error.apply(e,arguments)}n("dd0b");var Un,zn={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Re()?182:174,AUDIO_MUTE:Re()?181:173,AUDIO_UP:Re()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Gn=[zn.ALT,zn.ARROW_DOWN,zn.ARROW_LEFT,zn.ARROW_RIGHT,zn.ARROW_UP,zn.AUDIO_DOWN,zn.AUDIO_MUTE,zn.AUDIO_UP,zn.BACKSPACE,zn.CAPS_LOCK,zn.DELETE,zn.END,zn.ENTER,zn.ESCAPE,zn.F1,zn.F2,zn.F3,zn.F4,zn.F5,zn.F6,zn.F7,zn.F8,zn.F9,zn.F10,zn.F11,zn.F12,zn.F13,zn.F14,zn.F15,zn.F16,zn.F17,zn.F18,zn.F19,zn.HOME,zn.INSERT,zn.MEDIA_NEXT,zn.MEDIA_PLAY_PAUSE,zn.MEDIA_PREV,zn.MEDIA_STOP,zn.NULL,zn.NUM_LOCK,zn.PAGE_DOWN,zn.PAGE_UP,zn.PAUSE,zn.SCROLL_LOCK,zn.SHIFT,zn.TAB];function Yn(e){return 32===e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function Kn(e){return Gn.includes(e)}function Xn(e){var t=[];return Ne()?t.push(zn.COMMAND_LEFT,zn.COMMAND_RIGHT,zn.COMMAND_FIREFOX):t.push(zn.CONTROL),t.includes(e)}function $n(e){return[zn.CONTROL,zn.COMMAND_LEFT,zn.COMMAND_RIGHT,zn.COMMAND_FIREFOX].includes(e)}function qn(e,t){var n=t.split("|"),r=!1;return U(n,(function(t){if(e===zn[t])return r=!0,!1})),r}function Qn(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Jn(e){return!1===e.isImmediatePropagationEnabled}function Zn(e){return 2===e.button}function er(e){return 0===e.button}function tr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rr(e,t,n){return t&&nr(e.prototype,t),n&&nr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function or(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ir=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],ar=Ke(Un||(Un=or(['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.']))),lr=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),sr=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),ur=function(){function e(){tr(this,e),this.globalBucket=this.createEmptyBucket()}return rr(e,[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return U(ir,(function(t){return e[t]=[]})),e}},{key:"getBucket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))U(t,(function(t){return n.add(e,t,r)}));else{lr.has(e)&&Fn(Ct(ar,{hookName:e,removedInVersion:lr.get(e)})),sr.has(e)&&Fn(sr.get(e));var o=this.getBucket(r);if("undefined"===typeof o[e]&&(this.register(e),o[e]=[]),t.skip=!1,-1===o[e].indexOf(t)){var i=!1;t.initialHook&&U(o[e],(function(n,r){if(n.initialHook)return o[e][r]=t,i=!0,!1})),i||o[e].push(t)}}return this}},{key:"once",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)?U(t,(function(t){return n.once(e,t,r)})):(t.runOnce=!0,this.add(e,t,r))}},{key:"remove",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return"undefined"!==typeof r[e]&&r[e].indexOf(t)>=0&&(t.skip=!0,!0)}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(t);return!(void 0===n[e]||!n[e].length)}},{key:"run",value:function(e,t,n,r,o,i,a,l){var s=this.globalBucket[t],u=s?s.length:0,c=0;if(u)while(c<u)if(s[c]&&!s[c].skip){var f=Vn(s[c],e,n,r,o,i,a,l);void 0!==f&&(n=f),s[c]&&s[c].runOnce&&this.remove(t,s[c]),c+=1}else c+=1;var h=this.getBucket(e)[t],d=h?h.length:0,p=0;if(d)while(p<d)if(h[p]&&!h[p].skip){var y=Vn(h[p],e,n,r,o,i,a,l);void 0!==y&&(n=y),h[p]&&h[p].runOnce&&this.remove(t,h[p],e),p+=1}else p+=1;return n}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;he(this.getBucket(e),(function(e,t,n){return n[t].length=0}))}},{key:"register",value:function(e){this.isRegistered(e)||ir.push(e)}},{key:"deregister",value:function(e){this.isRegistered(e)&&ir.splice(ir.indexOf(e),1)}},{key:"isDeprecated",value:function(e){return sr.has(e)||lr.has(e)}},{key:"isRegistered",value:function(e){return ir.indexOf(e)>=0}},{key:"getRegistered",value:function(){return ir}}],[{key:"getSingleton",value:function(){return fr()}}]),e}(),cr=new ur;function fr(){return cr}var hr=ur;function dr(e){return gr(e)||vr(e)||yr(e)||pr()}function pr(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function yr(e,t){if(e){if("string"===typeof e)return mr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mr(e,t):void 0}}function vr(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function gr(e){if(Array.isArray(e))return mr(e)}function mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var br=new Map;function wr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";br.has(e)||br.set(e,new Map);var t=br.get(e);function n(e,n){t.set(e,n)}function r(e){return t.get(e)}function o(e){return t.has(e)}function i(){return dr(t.keys())}function a(){return dr(t.values())}return{register:n,getItem:r,hasItem:o,getNames:i,getValues:a}}var Cr=new WeakMap,Sr=wr("editors"),Or=Sr.register,kr=Sr.getItem,Rr=Sr.hasItem,Er=Sr.getNames;Sr.getValues;function Tr(e){var t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},hr.getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function Pr(e,t){var n;if("function"===typeof e)Cr.get(e)||Ar(null,e),n=Cr.get(e);else{if("string"!==typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=kr(e)}if(!n)throw Error('No editor registered under name "'.concat(e,'"'));return n.getInstance(t)}function Mr(e){if("function"===typeof e)return e;if(!Rr(e))throw Error('No registered editor found under "'.concat(e,'" name'));return kr(e).getConstructor()}function Ar(e,t){e&&"string"!==typeof e&&(t=e,e=t.EDITOR_TYPE);var n=new Tr(t);"string"===typeof e&&Or(e,n),Cr.set(t,n)}function Ir(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xr(e,t,n){return t&&jr(e.prototype,t),n&&jr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var _r=0,Hr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Ir(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return xr(e,[{key:"addEventListener",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(e){n.call(this,Dr(e))}return"boolean"===typeof o||D()||(o=!1),this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:i,options:o,eventManager:this}),e.addEventListener(t,i,o),_r+=1,function(){r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.context.eventListeners.length;while(i)if(i-=1,r=this.context.eventListeners[i],r.event===t&&r.element===e){if(n&&n!==r.callback)continue;if(o&&r.eventManager!==this)continue;this.context.eventListeners.splice(i,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),_r-=1}}},{key:"clearEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context){var t=this.context.eventListeners.length;while(t){t-=1;var n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),_r-=1)}}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(e,t){var n=e.document,r=e;n||(n=e.ownerDocument?e.ownerDocument:e,r=n.defaultView);var o,i={bubbles:!0,cancelable:"mousemove"!==t,view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent("on".concat(t),o)}}]),e}();function Dr(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Qn(this)},e}var Nr=Hr;function Lr(){return _r}function Br(e,t){return zr(e)||Ur(e,t)||Fr(e,t)||Vr()}function Vr(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Fr(e,t){if(e){if("string"===typeof e)return Wr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wr(e,t):void 0}}function Wr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ur(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function zr(e){if(Array.isArray(e))return e}function Gr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kr(e,t,n){return t&&Yr(e.prototype,t),n&&Yr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Xr="editorManager.navigation",$r="editorManager.handlingEditor",qr=function(){function e(t,n,r){var o=this;Gr(this,e),this.instance=t,this.tableMeta=n,this.selection=r,this.eventManager=new Nr(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",(function(e){return o.onAfterDocumentKeyDown(e)})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(e){!o.destroyed&&o.instance.isListening()&&o.openEditor("",e)})),this.instance.view._wt.update("onCellDblClick",(function(e,t,n){return o.onCellDblClick(e,t,n)}))}return Kr(e,[{key:"registerShortcuts",value:function(){var e=this,t=this.instance.getShortcutManager(),n=t.getContext("grid"),r=t.getContext("editor"),o={group:$r};r.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(n,r){e.closeEditorAndSaveChanges(t.isCtrlPressed()),e.moveSelectionAfterEnter(r.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){e.closeEditorAndRestoreOriginalValue(t.isCtrlPressed()),e.activeEditor.focus()}}],o),n.addShortcuts([{keys:[["F2"]],callback:function(t){e.openEditor(null,t,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){e.instance.emptySelectedCells(),e.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(t,n){e.instance.getSettings().enterBeginsEditing?e.cellProperties.readOnly?e.moveSelectionAfterEnter():e.openEditor(null,t,!0):e.moveSelectionAfterEnter(n.includes("shift")),Qn(t)}}],o)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(e){this.lock||this.closeEditor(e)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var e=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(t){t&&e.prepareEditor()}));else{var t=this.instance.getSelectedRangeLast().highlight,n=t.row,r=t.col,o=this.instance.runHooks("modifyGetCellCoords",n,r),i=n,a=r;if(Array.isArray(o)){var l=Br(o,2);i=l[0],a=l[1]}this.cellProperties=this.instance.getCellMeta(i,a);var s=this.instance.rootDocument.activeElement;if(s&&Pn(s)&&s.blur(),this.isCellEditable()){var u=this.instance.getCell(n,r,!0);if(u){var c=this.instance.getCellEditor(this.cellProperties),f=this.instance.colToProp(a),h=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(i),a);this.activeEditor=Pr(c,this.instance),this.activeEditor.prepare(n,r,f,u,h,this.cellProperties)}}else this.clearActiveEditor()}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.isCellEditable()){if(!this.activeEditor){var r=this.instance.getSelectedRangeLast().highlight,o=r.row,i=r.col,a=this.instance.rowIndexMapper.getRenderableFromVisualIndex(o),l=this.instance.columnIndexMapper.getRenderableFromVisualIndex(i);this.instance.view.scrollViewport(this.instance._createCellCoords(a,l)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}else this.clearActiveEditor()}},{key:"closeEditor",value:function(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(e){this.closeEditor(!1,e)}},{key:"closeEditorAndRestoreOriginalValue",value:function(e){this.closeEditor(!0,e)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var e=this.instance.getCellEditor(this.cellProperties),t=this.instance.getSelectedRangeLast().highlight,n=t.row,r=t.col,o=this.instance,i=o.rowIndexMapper,a=o.columnIndexMapper,l=i.isHidden(this.instance.toPhysicalRow(n))||a.isHidden(this.instance.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!e||l)}},{key:"moveSelectionAfterEnter",value:function(e){var t="function"===typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(e){var t=this;if(this.instance.isListening()){var n=e.keyCode;if(this.selection.isSelected()){var r=(e.ctrlKey||e.metaKey)&&!e.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Kn(n)&&!$n(n)&&!r&&!this.isEditorOpened()){var o=this.instance.getShortcutManager(),i=o.getContext("editor"),a={runOnlyIf:function(){return Qe(t.instance.getSelected())},group:Xr};i.addShortcuts([{keys:[["ArrowUp"]],callback:function(){t.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){t.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){t.instance.selection.transformStart(0,-1*t.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){t.instance.selection.transformStart(0,t.instance.getDirectionFactor())}}],a),this.openEditor("",e)}}}}},{key:"onCellDblClick",value:function(e,t,n){"TD"===n.nodeName&&this.openEditor(null,e,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),Qr=new WeakMap;qr.getInstance=function(e,t,n){var r=Qr.get(e);return r||(r=new qr(e,t,n),Qr.set(e,r)),r};var Jr=qr;n("0ee2"),n("1b48"),n("1fe0"),n("89c5"),n("6315");function Zr(e){return ro(e)||no(e)||to(e)||eo()}function eo(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function to(e,t){if(e){if("string"===typeof e)return oo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oo(e,t):void 0}}function no(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ro(e){if(Array.isArray(e))return oo(e)}function oo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var io={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},ao=new RegExp(Object.keys(io).map((function(e){return"(".concat(e,")")})).join("|"),"gi");function lo(e){return"TABLE"===(e&&e.nodeName||"")}function so(e){for(var t=e.hasColHeaders(),n=e.hasRowHeaders(),r=[t?-1:0,n?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,r),i=o.length,a=i>0?o[0].length:0,l=["<table>","</table>"],s=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,f=t?1:0,h=0;h<i;h+=1){for(var d=t&&0===h,p=[],y=0;y<a;y+=1){var v=!d&&n&&0===y,g="";if(d)g="<th>".concat(e.getColHeader(y-c),"</th>");else if(v)g="<th>".concat(e.getRowHeader(h-f),"</th>");else{var m=o[h][y],b=e.getCellMeta(h-f,y-c),w=b.hidden,C=b.rowspan,S=b.colspan;if(!w){var O=[];if(C&&O.push('rowspan="'.concat(C,'"')),S&&O.push('colspan="'.concat(S,'"')),Ze(m))g="<td ".concat(O.join(" "),"></td>");else{var k=m.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");g="<td ".concat(O.join(" "),">").concat(k,"</td>")}}}p.push(g)}var R=["<tr>"].concat(p,["</tr>"]).join("");d?s.splice(1,0,R):u.splice(-1,0,R)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function uo(e){for(var t=e.length,n=["<table>"],r=0;r<t;r+=1){var o=e[r],i=o.length,a=[];0===r&&n.push("<tbody>");for(var l=0;l<i;l+=1){var s=o[l],u=Ze(s)?"":s.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}n.push.apply(n,["<tr>"].concat(a,["</tr>"])),r+1===t&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function co(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n={},r=t.createDocumentFragment(),o=t.createElement("div");r.appendChild(o);var i=e;if("string"===typeof i){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(function(e){var t=e.match(/<td\b[^>]*?>/g)[0],n=e.substring(t.length,e.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),r="</td>";return"".concat(t).concat(n).concat(r)}));o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(i&&lo(i)){var l=o.querySelector('meta[name$="enerator"]'),s=null!==i.querySelector("tbody th"),u=i.querySelector("tr"),c=u?Array.from(u.cells).reduce((function(e,t){return e+t.colSpan}),0)-(s?1:0):0,f=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,p=0,y=0;if(i.tHead){var v=Array.from(i.tHead.rows).filter((function(e){var t=null!==e.querySelector("td");return t&&h.push(e),!t}));p=v.length,d=p>0,p>1?n.nestedHeaders=Array.from(v).reduce((function(e,t){var n=Array.from(t.cells).reduce((function(e,t,n){if(s&&0===n)return e;var r=t.colSpan,o=t.innerHTML,i=r>1?{label:o,colspan:r}:o;return e.push(i),e}),[]);return e.push(n),e}),[]):d&&(n.colHeaders=Array.from(v[0].children).reduce((function(e,t,n){return s&&0===n||e.push(t.innerHTML),e}),[]))}h.length&&(n.fixedRowsTop=h.length),f.length&&(n.fixedRowsBottom=f.length);var g=[].concat(h,Zr(Array.from(i.tBodies).reduce((function(e,t){return e.push.apply(e,Zr(Array.from(t.rows))),e}),[])),Zr(f));y=g.length;for(var m=new Array(y),b=0;b<y;b++)m[b]=new Array(c);for(var w=[],C=[],S=0;S<y;S++)for(var O=g[S],k=Array.from(O.cells),R=k.length,E=0;E<R;E++){var T=k[E],P=T.nodeName,M=T.innerHTML,A=T.rowSpan,I=T.colSpan,j=m[S].findIndex((function(e){return void 0===e}));if("TD"===P){if(A>1||I>1){for(var x=S;x<S+A;x++)if(x<y)for(var _=j;_<j+I;_++)m[x][_]=null;var H=T.getAttribute("style"),D=H&&H.includes("mso-ignore:colspan");D||w.push({col:j,row:S,rowspan:A,colspan:I})}var N="";N=l&&/excel/gi.test(l.content)?M.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):M.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),m[S][j]=N.replace(ao,(function(e){return io[e]}))}else C.push(M)}return w.length&&(n.mergeCells=w),C.length&&(n.rowHeaders=C),m.length&&(n.data=m),n}}function fo(e){return vo(e)||yo(e)||po(e)||ho()}function ho(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function po(e,t){if(e){if("string"===typeof e)return go(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?go(e,t):void 0}}function yo(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function vo(e){if(Array.isArray(e))return go(e)}function go(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mo(e){return mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mo(e)}function bo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=mo(e);if("number"===n)return!isNaN(e)&&isFinite(e);if("string"===n){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);var r=Array.from(new Set(["."].concat(fo(t)))).map((function(e){return"\\".concat(e)})).join("|");return new RegExp("^[+-]?\\s*(((".concat(r,")?\\d+((").concat(r,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}return"object"===n&&(!!e&&"number"===typeof e.valueOf()&&!(e instanceof Date))}function wo(e){return bo(e,[","])}function Co(e,t,n){var r=-1;"function"===typeof t?(n=t,t=e):r=e-1;while(++r<=t)if(!1===n(r))break}function So(e,t,n){var r=e+1;"function"===typeof t&&(n=t,t=0);while(--r>=t)if(!1===n(r))break}function Oo(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function ko(e){return To(e)||Eo(e)||Ao(e)||Ro()}function Ro(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Eo(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function To(e){if(Array.isArray(e))return Io(e)}function Po(e,t){return xo(e)||jo(e,t)||Ao(e,t)||Mo()}function Mo(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ao(e,t){if(e){if("string"===typeof e)return Io(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Io(e,t):void 0}}function Io(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jo(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function xo(e){if(Array.isArray(e))return e}var _o="asc",Ho="desc",Do=new Map([[_o,[-1,1]],[Ho,[1,-1]]]),No=function(e){return"The priority '".concat(e,"' is already declared in a map.")},Lo=function(e){return"The priority '".concat(e,"' is not a number.")};function Bo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorPriorityExists,n=e.errorPriorityNaN,r=new Map;function o(e,o){if(!bo(e))throw new Error(n(e));if(r.has(e))throw new Error(t(e));r.set(e,o)}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_o,t=Do.get(e)||Do.get(_o),n=Po(t,2),o=n[0],i=n[1];return ko(r).sort((function(e,t){return e[0]<t[0]?o:i})).map((function(e){return e[1]}))}return t=jn(t)?t:No,n=jn(n)?n:Lo,{addItem:o,getItems:i}}n("e44e");function Vo(e){return Uo(e)||Wo(e)||Yo(e)||Fo()}function Fo(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Wo(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Uo(e){if(Array.isArray(e))return Ko(e)}function zo(e,t){return $o(e)||Xo(e,t)||Yo(e,t)||Go()}function Go(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Yo(e,t){if(e){if("string"===typeof e)return Ko(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ko(e,t):void 0}}function Ko(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xo(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function $o(e){if(Array.isArray(e))return e}var qo=function(e){return"The id '".concat(e,"' is already declared in a map.")};function Qo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorIdExists,n=new Map;function r(e,r){if(u(e))throw new Error(t(e));n.set(e,r)}function o(e){return n.delete(e)}function i(){n.clear()}function a(e){var t=s().find((function(t){var n=zo(t,2),r=n[0],o=n[1];return e===o&&r}))||[null],n=zo(t,1),r=n[0];return r}function l(e){return n.get(e)}function s(){return Vo(n)}function u(e){return n.has(e)}return t=jn(t)?t:qo,{addItem:r,clear:i,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:o}}function Jo(e){return ni(e)||ti(e)||ei(e)||Zo()}function Zo(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ei(e,t){if(e){if("string"===typeof e)return ri(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ri(e,t):void 0}}function ti(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ni(e){if(Array.isArray(e))return ri(e)}function ri(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var oi=function(e){return"'".concat(e,"' value is already declared in a unique set.")};function ii(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorItemExists,n=new Set;function r(e){if(n.has(e))throw new Error(t(e));n.add(e)}function o(){return Jo(n)}function i(){n.clear()}return t=jn(t)?t:oi,{addItem:r,clear:i,getItems:o}}function ai(e,t){return ui(e)||si(e,t)||hi(e,t)||li()}function li(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function si(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function ui(e){if(Array.isArray(e))return e}function ci(e){return pi(e)||di(e)||hi(e)||fi()}function fi(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function hi(e,t){if(e){if("string"===typeof e)return yi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yi(e,t):void 0}}function di(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function pi(e){if(Array.isArray(e))return yi(e)}function yi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var vi=function(e){return'There is already registered "'.concat(e,'" plugin.')},gi=function(e){return'There is already registered plugin on priority "'.concat(e,'".')},mi=function(e){return'The priority "'.concat(e,'" is not a number.')},bi=Bo({errorPriorityExists:gi,errorPriorityNaN:mi}),wi=ii({errorItemExists:vi}),Ci=Qo({errorIdExists:vi});function Si(){return[].concat(ci(bi.getItems()),ci(wi.getItems()))}function Oi(e){var t=gt(e);return Ci.getItem(t)}function ki(e){return!!Oi(e)}function Ri(e,t,n){var r=Ti(e,t,n),o=ai(r,3);e=o[0],t=o[1],n=o[2],void 0===Oi(e)&&Ei(e,t,n)}function Ei(e,t,n){var r=gt(e);if(Ci.hasItem(r))throw new Error(vi(r));void 0===n?wi.addItem(r):bi.addItem(n,r),Ci.addItem(r,t)}function Ti(e,t,n){return"function"===typeof e&&(t=e,e=t.PLUGIN_KEY,n=t.PLUGIN_PRIORITY),[e,t,n]}var Pi=wr("renderers"),Mi=Pi.register,Ai=Pi.getItem,Ii=Pi.hasItem,ji=Pi.getNames;Pi.getValues;function xi(e){if("function"===typeof e)return e;if(!Ii(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return Ai(e)}function _i(e,t){"string"!==typeof e&&(t=e,e=t.RENDERER_TYPE),Mi(e,t)}var Hi=wr("validators"),Di=Hi.register,Ni=Hi.getItem,Li=Hi.hasItem,Bi=Hi.getNames;Hi.getValues;function Vi(e){if("function"===typeof e)return e;if(!Li(e))throw Error('No registered validator found under "'.concat(e,'" name'));return Ni(e)}function Fi(e,t){"string"!==typeof e&&(t=e,e=t.VALIDATOR_TYPE),Di(e,t)}n("3128"),n("c9cc");function Wi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ui(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zi(e,t,n){return t&&Ui(e.prototype,t),n&&Ui(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Gi=new WeakMap,Yi=function(){function e(t,n,r,o,i,a){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Wi(this,e),this.wtSettings=r,this.domBindings=n,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=t,Gi.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return zi(e,[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",(function(t){return e.onContextMenu(t)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",(function(t){return e.onMouseOut(t)}));var t=function(){e.eventManager.addEventListener(e.wtTable.holder,"touchstart",(function(t){return e.onTouchStart(t)})),e.eventManager.addEventListener(e.wtTable.holder,"touchend",(function(t){return e.onTouchEnd(t)})),e.momentumScrolling||(e.momentumScrolling={}),e.eventManager.addEventListener(e.wtTable.holder,"scroll",(function(){clearTimeout(e.momentumScrolling._timeout),e.momentumScrolling.ongoing||e.wtSettings.getSetting("onBeforeTouchScroll"),e.momentumScrolling.ongoing=!0,e.momentumScrolling._timeout=setTimeout((function(){e.touchApplied||(e.momentumScrolling.ongoing=!1,e.wtSettings.getSetting("onAfterMomentumScroll"))}),200)}))},n=function(){e.eventManager.addEventListener(e.wtTable.holder,"mouseup",(function(t){return e.onMouseUp(t)})),e.eventManager.addEventListener(e.wtTable.holder,"mousedown",(function(t){return e.onMouseDown(t)}))};xe()?t():(j()&&t(),n())}},{key:"selectedCellWasTouched",value:function(e){var t=Gi.get(this),n=this.parentCell(e),r=n.coords;if(t.selectedCellBeforeTouchEnd&&r){var o=[r.row,t.selectedCellBeforeTouchEnd.from.row],i=o[0],a=o[1],l=[r.col,t.selectedCellBeforeTouchEnd.from.col],s=l[0],u=l[1];return i===a&&s===u}return!1}},{key:"parentCell",value:function(e){var t={},n=this.wtTable.TABLE,r=Ht(e,["TD","TH"],n);return r?(t.coords=this.wtTable.getCoords(r),t.TD=r):Wt(e,"wtBorder")&&Wt(e,"current")?(t.coords=this.selections.getCell().cellRange.highlight,t.TD=this.wtTable.getCell(t.coords)):Wt(e,"wtBorder")&&Wt(e,"area")&&this.selections.createOrGetArea().cellRange&&(t.coords=this.selections.createOrGetArea().cellRange.to,t.TD=this.wtTable.getCell(t.coords)),t}},{key:"onMouseDown",value:function(e){var t=Gi.get(this),n=this.domBindings.rootDocument.activeElement,r=Nn(At,e.target),o=e.target;if(o!==n&&r(0)!==n&&r(1)!==n){var i=this.parentCell(o);Wt(o,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,o):i.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,i.coords,i.TD),(0===e.button||this.touchApplied)&&i.TD&&(t.dblClickOrigin[0]=i.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout((function(){t.dblClickOrigin[0]=null}),1e3))}}},{key:"onContextMenu",value:function(e){if(this.wtSettings.has("onCellContextMenu")){var t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}},{key:"onMouseOver",value:function(e){if(this.wtSettings.has("onCellMouseOver")){var t=this.wtTable.TABLE,n=Ht(e.target,["TD","TH"],t),r=this.parent||this;n&&n!==r.lastMouseOver&&Dt(n,t)&&(r.lastMouseOver=n,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(n),n))}}},{key:"onMouseOut",value:function(e){if(this.wtSettings.has("onCellMouseOut")){var t=this.wtTable.TABLE,n=Ht(e.target,["TD","TH"],t),r=Ht(e.relatedTarget,["TD","TH"],t);n&&n!==r&&Dt(n,t)&&this.callListener("onCellMouseOut",e,this.wtTable.getCoords(n),n)}}},{key:"onMouseUp",value:function(e){var t=Gi.get(this),n=this.parentCell(e.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),(0===e.button||this.touchApplied)&&(n.TD===t.dblClickOrigin[0]&&n.TD===t.dblClickOrigin[1]?(Wt(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):n.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout((function(){t.dblClickOrigin[1]=null}),500)))}},{key:"onTouchStart",value:function(e){var t=Gi.get(this);t.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}},{key:"onTouchEnd",value:function(e){var t,n=e.target,r=null===(t=this.parentCell(n))||void 0===t?void 0:t.coords,o=Qe(r)&&r.row>=0&&r.col>=0,i=e.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance");if(i){var a=["A","BUTTON","INPUT"];_e()&&(ke()||Ee())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}},{key:"callListener",value:function(e,t,n,r){var o=this.wtSettings.getSettingPure(e);o&&o(t,n,r,this.facadeGetter())}},{key:"destroy",value:function(){var e=Gi.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}(),Ki=Yi;function Xi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qi(e,t,n){return t&&$i(e.prototype,t),n&&$i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Qi=function(){function e(t,n,r){Xi(this,e),this.offset=t,this.total=n,this.countTH=r}return qi(e,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),e}(),Ji=Qi;function Zi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ea(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ta(e,t,n){return t&&ea(e.prototype,t),n&&ea(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var na=function(){function e(t,n,r){Zi(this,e),this.offset=t,this.total=n,this.countTH=r}return ta(e,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),e}(),ra=na,oa=0,ia=1,aa=2;function la(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ua(e,t,n){return t&&sa(e.prototype,t),n&&sa(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var ca=function(){function e(){la(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return ua(e,[{key:"setSize",value:function(e){this.currentSize=this.nextSize,this.nextSize=e}},{key:"setOffset",value:function(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}]),e}();function fa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ha(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function da(e,t,n){return t&&ha(e.prototype,t),n&&ha(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var pa=function(){function e(){fa(this,e),this.size=new ca,this.workingSpace=oa,this.sharedSize=null}return da(e,[{key:"setSize",value:function(e){this.size.setSize(e)}},{key:"setOffset",value:function(e){this.size.setOffset(e)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof ca}},{key:"isPlaceOn",value:function(e){return this.workingSpace===e}},{key:"append",value:function(e){this.workingSpace=ia,e.workingSpace=aa,this.sharedSize=e.getViewSize()}},{key:"prepend",value:function(e){this.workingSpace=aa,e.workingSpace=ia,this.sharedSize=e.getViewSize()}}]),e}();function ya(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function va(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ga(e,t,n){return t&&va(e.prototype,t),n&&va(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var ma=function(){function e(t,n,r){ya(this,e),this.rootNode=t,this.nodesPool=n,this.sizeSet=new pa,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return ga(e,[{key:"setSize",value:function(e){return this.sizeSet.setSize(e),this}},{key:"setOffset",value:function(e){return this.sizeSet.setOffset(e),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}},{key:"getCurrentNode",value:function(){var e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}},{key:"getRenderedChildCount",value:function(){var e=this.rootNode,t=this.sizeSet,n=0;if(this.isSharedViewSet()){var r=e.firstElementChild;while(r){if(r.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(ia))break;r=r.nextElementSibling}}else n=e.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;var e=this.rootNode,t=this.sizeSet,n=this.isSharedViewSet(),r=t.getViewSize(),o=r.nextSize,i=this.getRenderedChildCount();while(i<o){var a=this.nodesPool();!n||n&&t.isPlaceOn(aa)?e.appendChild(a):e.insertBefore(a,e.firstChild),i+=1}var l=n&&t.isPlaceOn(ia);while(i>o)e.removeChild(l?e.firstChild:e.lastChild),i-=1}},{key:"render",value:function(){var e=this.rootNode,t=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(aa)&&(n+=t.sharedSize.nextSize);var r=e.childNodes[n];if(r.tagName!==this.childNodeType){var o=this.nodesPool();e.replaceChild(o,r),r=o}this.collectedNodes.push(r),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function ba(e){return ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ba(e)}function wa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ca(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sa(e,t,n){return t&&Ca(e.prototype,t),n&&Ca(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oa(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ka(e,t)}function ka(e,t){return ka=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ka(e,t)}function Ra(e){var t=Pa();return function(){var n,r=Ma(e);if(t){var o=Ma(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ea(this,n)}}function Ea(e,t){if(t&&("object"===ba(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ta(e)}function Ta(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pa(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ma(e){return Ma=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ma(e)}var Aa=function(e){Oa(n,e);var t=Ra(n);function n(){return wa(this,n),t.apply(this,arguments)}return Sa(n,[{key:"prependView",value:function(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}]),n}(ma);function Ia(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ja(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xa(e,t,n){return t&&ja(e.prototype,t),n&&ja(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var _a=function(){function e(t){Ia(this,e),this.nodeType=t.toUpperCase()}return xa(e,[{key:"setRootDocument",value:function(e){this.rootDocument=e}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function Ha(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Da(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Na(e,t,n){return t&&Da(e.prototype,t),n&&Da(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var La=function(){function e(t,n){Ha(this,e),this.nodesPool="string"===typeof t?new _a(t):null,this.nodeType=t,this.rootNode=n,this.table=null,this.renderedNodes=0}return Na(e,[{key:"setTable",value:function(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function Ba(e){return Ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ba(e)}function Va(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wa(e,t,n){return t&&Fa(e.prototype,t),n&&Fa(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ua(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&za(e,t)}function za(e,t){return za=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},za(e,t)}function Ga(e){var t=Xa();return function(){var n,r=$a(e);if(t){var o=$a(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ya(this,n)}}function Ya(e,t){if(t&&("object"===Ba(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ka(e)}function Ka(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xa(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function $a(e){return $a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$a(e)}var qa=function(e){Ua(n,e);var t=Ga(n);function n(){var e;return Va(this,n),e=t.call(this,"TH"),e.orderViews=new WeakMap,e.sourceRowIndex=0,e}return Wa(n,[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Aa(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.rowHeaderFunctions,r=e.rowHeadersCount,o=e.rows,i=e.cells,a=0;a<t;a++){var l=this.table.renderedRowToSource(a),s=o.getRenderedNode(a);this.sourceRowIndex=l;var u=this.obtainOrderView(s),c=i.obtainOrderView(s);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var f=0;f<r;f++){u.render();var h=u.getCurrentNode();h.className="",h.removeAttribute("style"),n[f](l,h,f)}u.end()}}}]),n}(La);function Qa(e){return Qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qa(e)}function Ja(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Za(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function el(e,t,n){return t&&Za(e.prototype,t),n&&Za(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function tl(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nl(e,t)}function nl(e,t){return nl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},nl(e,t)}function rl(e){var t=al();return function(){var n,r=ll(e);if(t){var o=ll(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ol(this,n)}}function ol(e,t){if(t&&("object"===Qa(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return il(e)}function il(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function al(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ll(e){return ll=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ll(e)}var sl=function(e){tl(n,e);var t=rl(n);function n(e){return Ja(this,n),t.call(this,null,e)}return el(n,[{key:"adjust",value:function(){var e=this.table,t=e.columnHeadersCount,n=e.rowHeadersCount,r=this.rootNode.firstChild;if(t){for(var o=this.table.columnsToRender,i=o+n,a=0,l=t;a<l;a++){r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;while(this.renderedNodes<i)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;while(this.renderedNodes>i)r.removeChild(r.lastChild),this.renderedNodes-=1}var s=this.rootNode.childNodes.length;if(s>t)for(var u=t;u<s;u++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Yt(r)}},{key:"render",value:function(){for(var e=this.table.columnHeadersCount,t=0;t<e;t+=1)for(var n=this.table,r=n.columnHeaderFunctions,o=n.columnsToRender,i=n.rowHeadersCount,a=this.rootNode.childNodes[t],l=-1*i;l<o;l+=1){var s=this.table.renderedColumnToSource(l),u=a.childNodes[l+i];u.className="",u.removeAttribute("style"),r[t](s,u,t)}}}]),n}(La);function ul(e){return ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ul(e)}function cl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hl(e,t,n){return t&&fl(e.prototype,t),n&&fl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function dl(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pl(e,t)}function pl(e,t){return pl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pl(e,t)}function yl(e){var t=ml();return function(){var n,r=bl(e);if(t){var o=bl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vl(this,n)}}function vl(e,t){if(t&&("object"===ul(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return gl(e)}function gl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ml(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function bl(e){return bl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bl(e)}var wl,Cl=function(e){dl(n,e);var t=yl(n);function n(e){return cl(this,n),t.call(this,null,e)}return hl(n,[{key:"adjust",value:function(){var e=this.table,t=e.columnsToRender,n=e.rowHeadersCount,r=t+n;while(this.renderedNodes<r)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;while(this.renderedNodes>r)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var e=this.table,t=e.columnsToRender,n=e.rowHeadersCount,r=0;r<n;r++){var o=this.table.renderedColumnToSource(r),i=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width="".concat(i,"px")}for(var a=0;a<t;a++){var l=this.table.renderedColumnToSource(a),s=this.table.columnUtils.getStretchedColumnWidth(l);this.rootNode.childNodes[a+n].style.width="".concat(s,"px")}var u=this.rootNode.firstChild;u&&Ut(u,"rowHeader")}}]),n}(La);function Sl(e){return Sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sl(e)}function Ol(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function kl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function El(e,t,n){return t&&Rl(e.prototype,t),n&&Rl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tl(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pl(e,t)}function Pl(e,t){return Pl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pl(e,t)}function Ml(e){var t=jl();return function(){var n,r=xl(e);if(t){var o=xl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Al(this,n)}}function Al(e,t){if(t&&("object"===Sl(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Il(e)}function Il(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jl(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function xl(e){return xl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xl(e)}var _l=!1,Hl=function(e){Tl(n,e);var t=Ml(n);function n(e){var r;return kl(this,n),r=t.call(this,"TR",e),r.orderView=new ma(e,(function(e){return r.nodesPool.obtain(e)}),r.nodeType),r}return El(n,[{key:"getRenderedNode",value:function(e){return this.orderView.getNode(e)}},{key:"render",value:function(){var e=this.table.rowsToRender;!_l&&e>1e3&&(_l=!0,Fn(Ke(wl||(wl=Ol(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting \n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20\n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.']))))),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(var t=0;t<e;t++)this.orderView.render();this.orderView.end()}}]),n}(La);function Dl(e){return Dl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dl(e)}function Nl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ll(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bl(e,t,n){return t&&Ll(e.prototype,t),n&&Ll(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vl(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fl(e,t)}function Fl(e,t){return Fl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Fl(e,t)}function Wl(e){var t=Gl();return function(){var n,r=Yl(e);if(t){var o=Yl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ul(this,n)}}function Ul(e,t){if(t&&("object"===Dl(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return zl(e)}function zl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gl(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Yl(e){return Yl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Yl(e)}var Kl=function(e){Vl(n,e);var t=Wl(n);function n(){var e;return Nl(this,n),e=t.call(this,"TD"),e.orderViews=new WeakMap,e.sourceRowIndex=0,e}return Bl(n,[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Aa(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.columnsToRender,r=e.rows,o=e.rowHeaders,i=0;i<t;i++){var a=this.table.renderedRowToSource(i),l=r.getRenderedNode(i);this.sourceRowIndex=a;var s=this.obtainOrderView(l),u=o.obtainOrderView(l);s.prependView(u).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var c=0;c<n;c++){s.render();var f=s.getCurrentNode(),h=this.table.renderedColumnToSource(c);Wt(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),this.table.cellRenderer(a,h,f)}s.end()}}}]),n}(La);function Xl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ql(e,t,n){return t&&$l(e.prototype,t),n&&$l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ql=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.cellRenderer;Xl(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=r}return ql(e,[{key:"setAxisUtils",value:function(e,t){this.rowUtils=e,this.columnUtils=t}},{key:"setViewportSize",value:function(e,t){this.rowsToRender=e,this.columnsToRender=t}},{key:"setFilters",value:function(e,t){this.rowFilter=e,this.columnFilter=t}},{key:"setHeaderContentRenderers",value:function(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}},{key:"setRenderers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowHeaders,n=e.columnHeaders,r=e.colGroup,o=e.rows,i=e.cells;t.setTable(this),n.setTable(this),r.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=t,this.columnHeaders=n,this.colGroup=r,this.rows=o,this.cells=i}},{key:"renderedRowToSource",value:function(e){return this.rowFilter.renderedToSource(e)}},{key:"renderedColumnToSource",value:function(e){return this.columnFilter.renderedToSource(e)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var e=this.rowsToRender,t=this.rows,n=0;n<e;n++){var r=t.getRenderedNode(n);if(r.firstChild){var o=this.renderedRowToSource(n),i=this.rowUtils.getHeight(o);r.firstChild.style.height=i?"".concat(i-1,"px"):""}}}}]),e}();function Jl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function es(e,t,n){return t&&Zl(e.prototype,t),n&&Zl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var ts=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.TABLE,r=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;Jl(this,e),this.renderer=new Ql(n,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new qa,columnHeaders:new sl(r),colGroup:new Cl(o),rows:new Hl(i),cells:new Kl}),this.renderer.setAxisUtils(a,l)}return es(e,[{key:"setFilters",value:function(e,t){return this.renderer.setFilters(e,t),this}},{key:"setViewportSize",value:function(e,t){return this.renderer.setViewportSize(e,t),this}},{key:"setHeaderContentRenderers",value:function(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function ns(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function os(e,t,n){return t&&rs(e.prototype,t),n&&rs(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var is=function(){function e(t,n){ns(this,e),this.dataAccessObject=t,this.wtSettings=n,this.headerWidths=new Map}return os(e,[{key:"getWidth",value:function(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(e){var t=this.dataAccessObject.wtViewport.columnsRenderCalculator,n=this.getWidth(e);if(t){var r=t.getStretchedColumnWidth(e,n);r&&(n=r)}return n}},{key:"getHeaderHeight",value:function(e){var t=this.wtSettings.getSetting("defaultRowHeight"),n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}},{key:"getHeaderWidth",value:function(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}},{key:"calculateWidths",value:function(){var e=this.wtSettings,t=this.dataAccessObject,n=t.wtTable,r=t.wtViewport,o=t.cloneSource,i=o?o.wtTable.holder:n.holder,a=i.offsetHeight<i.scrollHeight?Cn():0,l=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-a),l=e.getSetting("onModifyRowHeaderWidth",l),null!==l&&void 0!==l)for(var s=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth"),c=0;c<s;c++){var f=Array.isArray(l)?l[c]:l;f=null===f||void 0===f?u:f,this.headerWidths.set(c,f)}}}]),e}();function as(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ls(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ss(e,t,n){return t&&ls(e.prototype,t),n&&ls(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var us=function(){function e(t,n){as(this,e),this.dataAccessObject=t,this.wtSettings=n}return ss(e,[{key:"getHeight",value:function(e){var t=this.wtSettings.getSetting("rowHeight",e),n=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}}]),e}(),cs="top",fs="bottom",hs="inline_start",ds="top_inline_start_corner",ps="bottom_inline_start_corner",ys=[cs,fs,hs,ds,ps],vs=new Map([[cs,"ht_clone_".concat(cs)],[fs,"ht_clone_".concat(fs)],[hs,"ht_clone_".concat(hs," ht_clone_left")],[ds,"ht_clone_".concat(ds," ht_clone_top_left_corner")],[ps,"ht_clone_".concat(ps," ht_clone_bottom_left_corner")]]);function gs(e){return ws(e)||bs(e)||Os(e)||ms()}function ms(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bs(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ws(e){if(Array.isArray(e))return ks(e)}function Cs(e,t){return Es(e)||Rs(e,t)||Os(e,t)||Ss()}function Ss(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Os(e,t){if(e){if("string"===typeof e)return ks(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ks(e,t):void 0}}function ks(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rs(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Es(e){if(Array.isArray(e))return e}function Ts(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ps(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ms(e,t,n){return t&&Ps(e.prototype,t),n&&Ps(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function As(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Is=function(){function e(t,n,r,o,i){var a=this;Ts(this,e),As(this,"wtSettings",null),As(this,"domBindings",void 0),As(this,"TBODY",null),As(this,"THEAD",null),As(this,"COLGROUP",null),As(this,"hasTableHeight",!0),As(this,"hasTableWidth",!0),As(this,"isTableVisible",!1),As(this,"tableOffset",0),As(this,"holderOffset",0),this.domBindings=r,this.isMaster="master"===i,this.name=i,this.dataAccessObject=t,this.facadeGetter=n,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,Gt(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(function(){return a._modifyRowHeaderWidth(l)})),this.rowUtils=new us(this.dataAccessObject,this.wtSettings),this.columnUtils=new is(this.dataAccessObject,this.wtSettings),this.tableRenderer=new ts({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return Ms(e,[{key:"is",value:function(e){return this.name===e}},{key:"fixTableDomTree",value:function(){var e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Wt(n,"wtHolder")||(t=this.domBindings.rootDocument.createElement("div"),t.className="wtSpreader",n&&n.insertBefore(t,e),t.appendChild(e)),t.style.position="relative",t}},{key:"createHider",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Wt(n,"wtHolder")||(t=this.domBindings.rootDocument.createElement("div"),t.className="wtHider",n&&n.insertBefore(t,e),t.appendChild(e)),t}},{key:"createHolder",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Wt(n,"wtHolder")||(t=this.domBindings.rootDocument.createElement("div"),t.style.position="relative",t.className="wtHolder",n&&n.insertBefore(t,e),this.isMaster&&(t.parentNode.className+="ht_master handsontable",t.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),t.appendChild(e)),t}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wtSettings,n=this.dataAccessObject,r=n.wtOverlays,o=n.wtViewport,i=t.getSetting("totalRows"),a=t.getSetting("totalColumns"),l=t.getSetting("rowHeaders"),s=l.length,u=t.getSetting("columnHeaders"),c=u.length,f=!1,h=e;if(this.isMaster&&(this.holderOffset=Jt(this.holder),h=o.createRenderCalculators(h),s&&!t.getSetting("fixedColumnsStart"))){var d=r.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=0!==d,p!==this.correctHeaderWidth&&(h=!1)}if(this.isMaster&&(f=r.updateStateOfRendering()),h)this.isMaster&&o.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=Jt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var y=i>0?this.getFirstRenderedRow():0,v=a>0?this.getFirstRenderedColumn():0;this.rowFilter=new ra(y,i,c),this.columnFilter=new Ji(v,a,s);var g,m=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var b={};this.wtSettings.getSetting("beforeDraw",!0,b),m=!0!==b.skipRender}if(m)if(this.tableRenderer.setHeaderContentRenderers(l,u),(this.is(fs)||this.is(ps))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(g=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(fs))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var w=un(this.hider),C=un(this.TABLE);0!==w&&C!==w&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),g!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(fs)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}var S=!1;return this.isMaster&&(S=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(S=r.bottomOverlay.resetFixedPosition()||S),S=r.inlineStartOverlay.resetFixedPosition()||S,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),S?(r.refreshAll(),r.adjustElementsSize()):this.refreshSelections(h),f&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(e){var t,n,r,o=this.columnFilter.renderedToSource(e),i=this.wtSettings.getSetting("columnHeaders").length,a=this.wtSettings.getSetting("defaultRowHeight"),l=this.wtSettings.getSetting("columnHeaderHeight")||[];while(i)i-=1,t=this.getColumnHeaderHeight(i),n=this.getColumnHeader(o,i),n&&(r=fn(n),(!t&&a<r||t<r)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=r),Array.isArray(l)?null!==l[i]&&void 0!==l[i]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wtSettings,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders"),o=0,i=r.length;o<i;o++)if(n[o]){if(!t[o]||0===t[o].childNodes.length)return;t[o].childNodes[0].style.height="".concat(n[o],"px")}}},{key:"resetOversizedRows",value:function(){var e=this.wtSettings,t=this.dataAccessObject.wtViewport;if((this.isMaster||this.is(fs))&&!e.getSetting("externalRowCalculator"))for(var n=this.getRenderedRowsCount(),r=0;r<n;r++){var o=this.rowFilter.renderedToSource(r);t.oversizedRows&&t.oversizedRows[o]&&(t.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(e){for(var t=this.TABLE.querySelectorAll(".".concat(e)),n=0,r=t.length;n<r;n++)zt(t[n],e)}},{key:"refreshSelections",value:function(e){var t=this.wtSettings,n=this.dataAccessObject.selections;if(n){var r=Array.from(n),o=r.length;if(e){for(var i=[],a=0;a<o;a++){for(var l=r[a].settings,s=l.highlightHeaderClassName,u=l.highlightRowClassName,c=l.highlightColumnClassName,f=r[a].classNames,h=f.length,d=0;d<h;d++)i.includes(f[d])||i.push(f[d]);s&&!i.includes(s)&&i.push(s),u&&!i.includes(u)&&i.push(u),c&&!i.includes(c)&&i.push(c)}var p=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(p))for(var y=0;y<p.length;y++)i.push(p[y]);for(var v=i.length,g=0;g<v;g++)this.removeClassFromCells(i[g])}for(var m=0;m<o;m++)r[m].draw(this.facadeGetter(),e)}}},{key:"getCell",value:function(e){var t,n=e.row,r=e.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(o&&Array.isArray(o)){var i=Cs(o,2);n=i[0],r=i[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;if(t=n<0?this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(n)]:this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)],!t&&n>=0)throw new Error("TR was expected to be rendered but is not");var a=t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!a&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}},{key:"getColumnHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[t];return null===n||void 0===n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}},{key:"getColumnHeaders",value:function(e){var t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach((function(e){var r=e.childNodes[n];r&&t.push(r)})),t}},{key:"getRowHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0!==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)){var n=this.wtSettings.getSetting("rowHeaders").length;if(!(t>=n)){var r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return null===r||void 0===r?void 0:r.childNodes[t]}}}},{key:"getRowHeaders",value:function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];for(var t=[],n=this.wtSettings.getSetting("rowHeaders").length,r=0;r<n;r++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],i=null===o||void 0===o?void 0:o.childNodes[r];i&&t.push(i)}return t}},{key:"getCoords",value:function(e){var t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=_t(t,["TD","TH"])),null===t)return null;var n=t.parentNode,r=n.parentNode,o=Nt(n),i=t.cellIndex;if(Lt(ds,t,this.wtRootElement)||Lt(cs,t,this.wtRootElement))"THEAD"===r.nodeName&&(o-=r.childNodes.length);else if(Lt(ps,t,this.wtRootElement)||Lt(fs,t,this.wtRootElement)){var a=this.wtSettings.getSetting("totalRows");o=a-r.childNodes.length+o}else o=r===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o);return i=Lt(ds,t,this.wtRootElement)||Lt(hs,t,this.wtRootElement)||Lt(ps,t,this.wtRootElement)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),this.wot.createCellCoords(o,i)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var e,t,n,r,o,i=this.TBODY.childNodes.length,a=i*this.wtSettings.getSetting("defaultRowHeight"),l=fn(this.TBODY)-1;if(a!==l||this.wtSettings.getSetting("fixedRowsBottom"))while(i)i-=1,n=this.rowFilter.renderedToSource(i),e=this.getRowHeight(n),r=this.getTrForRow(n),o=r.querySelector("th"),t=o?fn(o):fn(r)-1,(!e&&this.wtSettings.getSetting("defaultRowHeight")<t||e<t)&&(t+=1,this.dataAccessObject.wtViewport.oversizedRows[n]=t)}}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"isColumnHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wtSettings.getSetting("rowHeaders"),n=t.length;return Math.abs(e)<=n}},{key:"isRowHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wtSettings.getSetting("columnHeaders"),n=t.length;return Math.abs(e)<=n}},{key:"isRowBeforeRenderedRows",value:function(e){var t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}},{key:"isRowAfterRenderedRows",value:function(e){return e>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(e){var t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}},{key:"isColumnAfterRenderedColumns",value:function(e){return this.columnFilter&&e>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&e>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&e>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(e){return this.rowUtils.getHeight(e)}},{key:"getColumnHeaderHeight",value:function(e){return this.columnUtils.getHeaderHeight(e)}},{key:"getColumnWidth",value:function(e){return this.columnUtils.getWidth(e)}},{key:"getStretchedColumnWidth",value:function(e){return this.columnUtils.getStretchedColumnWidth(e)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return un(this.TABLE)}},{key:"getHeight",value:function(){return cn(this.TABLE)}},{key:"getTotalWidth",value:function(){var e=un(this.hider);return 0!==e?e:this.getWidth()}},{key:"getTotalHeight",value:function(){var e=cn(this.hider);return 0!==e?e:this.getHeight()}},{key:"isVisible",value:function(){return Qt(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(e){var t=jn(e)?e():null;return Array.isArray(t)?(t=gs(t),t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}},{key:"_correctRowHeaderWidth",value:function(e){var t=e;return"number"!==typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}]),e}(),js=Is,xs="stickyRowsTop",_s={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows");return 0===e?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};fe(_s,"MIXIN_NAME",xs,{writable:!1,enumerable:!1});var Hs=_s,Ds="calculatedColumns",Ns={getFirstRenderedColumn:function(){var e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn:function(){var e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getLastRenderedColumn:function(){var e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn:function(){var e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};fe(Ns,"MIXIN_NAME",Ds,{writable:!1,enumerable:!1});var Ls=Ns;function Bs(e){return Bs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bs(e)}function Vs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fs(e,t,n){return t&&Vs(e.prototype,t),n&&Vs(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ws(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Us(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zs(e,t)}function zs(e,t){return zs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},zs(e,t)}function Gs(e){var t=Xs();return function(){var n,r=$s(e);if(t){var o=$s(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ys(this,n)}}function Ys(e,t){if(t&&("object"===Bs(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ks(e)}function Ks(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xs(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function $s(e){return $s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$s(e)}var qs=function(e){Us(n,e);var t=Gs(n);function n(e,r,o,i){return Ws(this,n),t.call(this,e,r,o,i,cs)}return Fs(n)}(js);se(qs,Hs),se(qs,Ls);var Qs=qs;function Js(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eu(e,t,n){return t&&Zs(e.prototype,t),n&&Zs(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function tu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nu=function(){function e(t){Js(this,e),tu(this,"dataAccessObject",void 0),tu(this,"lastScrolledColumnPos",-1),tu(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return eu(e,[{key:"scrollViewport",value:function(e,t,n,r,o){var i=this.scrollViewportHorizontally(e.col,n,o),a=this.scrollViewportVertically(e.row,t,r);return i||a}},{key:"scrollViewportHorizontally",value:function(e,t,n){var r=this.dataAccessObject,o=r.drawn,i=r.totalColumns;if(!o||!Number.isInteger(e)||e<0||e>i)return!1;var a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn(),s=void 0===t&&void 0===n,u=this.dataAccessObject,c=u.fixedColumnsStart,f=u.inlineStartOverlay;if(s&&e<c)return!1;var h=!1;return-1===a?h=f.scrollTo(e,s?e>this.lastScrolledColumnPos:t):(s&&(e<a||e>l)||!s)&&(h=f.scrollTo(e,s?e>l:t)),h&&(this.lastScrolledColumnPos=e),h}},{key:"scrollViewportVertically",value:function(e,t,n){var r=this.dataAccessObject,o=r.drawn,i=r.totalRows;if(!o||!Number.isInteger(e)||e<0||e>i)return!1;var a=this.getFirstVisibleRow(),l=this.getLastVisibleRow(),s=void 0===t&&void 0===n,u=this.dataAccessObject,c=u.fixedRowsBottom,f=u.fixedRowsTop,h=u.topOverlay;if(s&&(e<f||e>i-c-1))return!1;var d=!1;return-1===a?d=h.scrollTo(e,s?e>this.lastScrolledRowPos:n):(s&&(e<a||e>l)||!s)&&(d=h.scrollTo(e,s?e>l:n)),d&&(this.lastScrolledRowPos=e),d}},{key:"getFirstVisibleRow",value:function(){var e=this.dataAccessObject,t=e.topOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalRows,i=e.fixedRowsTop,a=e.rootWindow,l=n.getFirstVisibleRow();if(t.mainTableScrollableElement===a){var s=Jt(n.wtRootElement),u=fn(n.hider),c=fn(a),f=tn(a,a);if(s.top+u-c<=f){var h=r.getColumnHeaderHeight();h+=t.sumCellSizes(0,i);for(var d=o;d>0;d--)if(h+=t.sumCellSizes(d-1,d),s.top+u-h<=f){l=d;break}}}return l}},{key:"getLastVisibleRow",value:function(){var e=this.dataAccessObject,t=e.topOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalRows,i=e.rootWindow,a=n.getLastVisibleRow();if(t.mainTableScrollableElement===i){var l=Jt(n.wtRootElement),s=tn(i,i);if(l.top>s)for(var u=fn(i),c=r.getColumnHeaderHeight(),f=1;f<=o;f++)if(c+=t.sumCellSizes(f-1,f),l.top+c-s>=u){a=f-2;break}}return a}},{key:"getFirstVisibleColumn",value:function(){var e=this.dataAccessObject,t=e.inlineStartOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalColumns,i=e.rootWindow,a=n.getFirstVisibleColumn();if(t.mainTableScrollableElement===i){var l=Jt(n.wtRootElement),s=hn(n.hider),u=hn(i),c=Math.abs(nn(i,i));if(l.left+s-u<=c)for(var f=r.getRowHeaderWidth(),h=o;h>0;h--)if(f+=t.sumCellSizes(h-1,h),l.left+s-f<=c){a=h;break}}return a}},{key:"getLastVisibleColumn",value:function(){var e=this.dataAccessObject,t=e.inlineStartOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalColumns,i=e.rootWindow,a=n.getLastVisibleColumn();if(t.mainTableScrollableElement===i){var l=Jt(n.wtRootElement),s=Math.abs(nn(i,i));if(l.left>s)for(var u=hn(i),c=r.getRowHeaderWidth(),f=1;f<=o;f++)if(c+=t.sumCellSizes(f-1,f),l.left+c-s>=u){a=f-2;break}}return a}}]),e}(),ru=nu;function ou(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function au(e,t,n){return t&&iu(e.prototype,t),n&&iu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function lu(e,t,n){su(e,t),t.set(e,n)}function su(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cu(e,t){var n=du(e,t,"get");return fu(e,n)}function fu(e,t){return t.get?t.get.call(e):t.value}function hu(e,t,n){var r=du(e,t,"set");return pu(e,r,n),n}function du(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function pu(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}var yu=new WeakMap,vu=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];ou(this,e),uu(this,"row",null),uu(this,"col",null),lu(this,yu,{writable:!0,value:!1}),hu(this,yu,r),"undefined"!==typeof t&&"undefined"!==typeof n&&(this.row=t,this.col=n)}return au(e,[{key:"isValid",value:function(e){return!(this.row<0||this.col<0)&&!(this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this||this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&(cu(this,yu)?this.col<=e.col:this.col>=e.col)}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&(cu(this,yu)?this.col>=e.col:this.col<=e.col)}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&(cu(this,yu)?this.col>=e.col:this.col<=e.col)}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&(cu(this,yu)?this.col<=e.col:this.col>=e.col)}},{key:"normalize",value:function(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,cu(this,yu))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}(),gu=vu;function mu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wu(e,t,n){return t&&bu(e.prototype,t),n&&bu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cu(e,t,n){Su(e,t),t.set(e,n)}function Su(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ou(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ku(e,t){var n=Tu(e,t,"get");return Ru(e,n)}function Ru(e,t){return t.get?t.get.call(e):t.value}function Eu(e,t,n){var r=Tu(e,t,"set");return Pu(e,r,n),n}function Tu(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function Pu(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}var Mu=new WeakMap,Au=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];mu(this,e),Ou(this,"highlight",null),Ou(this,"from",null),Ou(this,"to",null),Cu(this,Mu,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=n.clone(),this.to=r.clone(),Eu(this,Mu,o)}return wu(e,[{key:"setHighlight",value:function(e){return this.highlight=e.clone().normalize(),this}},{key:"setFrom",value:function(e){return this.from=e.clone(),this}},{key:"setTo",value:function(e){return this.to=e.clone(),this}},{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(e){var t=e.row,n=e.col,r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<=t&&o.row>=t&&r.col<=n&&o.col>=n}},{key:"includesRange",value:function(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}},{key:"isOverlappingHorizontally",value:function(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}},{key:"expand",value:function(e){var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}},{key:"expandByRange",value:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=this.getDirection(),o=e.getOuterTopStartCorner(),i=e.getOuterBottomEndCorner(),a=Math.min(t.row,o.row),l=Math.min(t.col,o.col),s=Math.max(n.row,i.row),u=Math.max(n.col,i.col),c=this._createCellCoords(a,l),f=this._createCellCoords(s,u);return this.from=c,this.to=f,this.setDirection(r),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var t=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=t[0],this.to=t[1];break;case"NE-SW":var n=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1];break;default:break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var e=this.getDirection();switch(e){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}},{key:"flipDirectionHorizontally",value:function(){var e=this.getDirection();switch(e){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return ku(this,Mu)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return ku(this,Mu)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return ku(this,Mu)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return ku(this,Mu)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return ku(this,Mu)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return ku(this,Mu)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return ku(this,Mu)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return ku(this,Mu)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(e,t){return!!(t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(t.to.row,t.to.col))))||(e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner()))}},{key:"getOppositeCorner",value:function(e,t){if(!(e instanceof gu))return!1;if(t){var n=t.from,r=t.to;if(t.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,r.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(r.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterTopStartCorner()}}return e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return t.top===n.top&&r.push("top"),t.right===n.right&&r.push("right"),t.bottom===n.bottom&&r.push("bottom"),t.left===n.left&&r.push("left"),r}},{key:"getInner",value:function(){for(var e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||n.push(this._createCellCoords(r,o));return n}},{key:"getAll",value:function(){for(var e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)e.row===r&&e.col===o?n.push(e):t.row===r&&t.col===o?n.push(t):n.push(this._createCellCoords(r,o));return n}},{key:"forAll",value:function(e){for(var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=t.row;r<=n.row;r++)for(var o=t.col;o<=n.col;o++){var i=e(r,o);if(!1===i)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,ku(this,Mu))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(e,t){return new gu(e,t,ku(this,Mu))}}]),e}(),Iu=Au;function ju(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _u(e,t,n){return t&&xu(e.prototype,t),n&&xu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Du=function(){function e(t,n){ju(this,e),Hu(this,"wtTable",void 0),Hu(this,"wtScroll",void 0),Hu(this,"wtViewport",void 0),Hu(this,"wtOverlays",void 0),Hu(this,"selections",void 0),Hu(this,"wtEvent",void 0),Hu(this,"guid","wt_".concat(bt())),Hu(this,"drawInterrupted",!1),Hu(this,"drawn",!1),Hu(this,"domBindings",void 0),Hu(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new ru(this.createScrollDao())}return _u(e,[{key:"eventManager",get:function(){return new Nr(this)}},{key:"findOriginalHeaders",value:function(){var e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){qt(n,e[t])}])}}},{key:"createCellCoords",value:function(e,t){return new gu(e,t,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(e,t,n){return new Iu(e,t,n,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.wtTable.getCell(e);var n=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}},{key:"scrollViewport",value:function(e,t,n,r,o){return!(e.col<0||e.row<0)&&this.wtScroll.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selections(){return e.selections},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function Nu(e){return Nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nu(e)}function Lu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bu(e,t,n){return t&&Lu(e.prototype,t),n&&Lu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fu(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wu(e,t)}function Wu(e,t){return Wu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Wu(e,t)}function Uu(e){var t=Yu();return function(){var n,r=Ku(e);if(t){var o=Ku(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zu(this,n)}}function zu(e,t){if(t&&("object"===Nu(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Gu(e)}function Gu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yu(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ku(e){return Ku=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ku(e)}function Xu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $u=function(e){Fu(n,e);var t=Uu(n);function n(e,r,o){var i;Vu(this,n),i=t.call(this,e,r),Xu(Gu(i),"cloneSource",void 0),Xu(Gu(i),"cloneOverlay",void 0);var a=i.wtSettings.getSetting("facade",Gu(i));return i.cloneSource=o.source,i.cloneOverlay=o.overlay,i.wtTable=i.cloneOverlay.createTable(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=o.viewport,i.selections=o.selections,i.wtEvent=new Ki(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections,o.event),i.findOriginalHeaders(),i}return Bu(n)}(Du);function qu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ju(e,t,n){return t&&Qu(e.prototype,t),n&&Qu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ec=function(){function e(t,n,r,o,i){qu(this,e),Zu(this,"wtSettings",null),fe(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=n,this.wtSettings=o;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,c=a.holder,f=a.wtRootElement;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=c,this.wtRootElement=f,this.trimmingContainer=on(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return Ju(e,[{key:"updateStateOfRendering",value:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=on(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var e=this.wot.wtTable,t=this.domBindings.rootWindow;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=rn(e.TABLE)}},{key:"getRelativeCellPosition",value:function(e,t,n){if(!1!==this.clone.wtTable.holder.contains(e)){var r=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),i=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,s={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop},c=null;return c=r?this.getRelativeCellPositionWithinWindow(i,o,u,s):this.getRelativeCellPositionWithinHolder(i,a,o,u,s),c}Fn("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeStartPosition",value:function(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(e,t,n,r){var o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),i=0,a=0;if(t){var l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Cn())),i=l<=0?-1*l:0}else i=r.start;if(e){var s=this.clone.wtTable.TABLE.getBoundingClientRect();a=s.top-o.top}else a=r.top;return{start:n.start+i,top:n.top+a}}},{key:"getRelativeCellPositionWithinHolder",value:function(e,t,n,r,o){var i={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},a=0,l=0;if(n||(a=i.horizontal-o.start),t){var s=this.wot.wtTable.wtRootElement.getBoundingClientRect(),u=this.clone.wtTable.TABLE.getBoundingClientRect();l=-1*u.top+s.top}else e||(l=i.vertical-o.top);return{start:r.start-a,top:r.top-l}}},{key:"makeClone",value:function(){if(-1===ys.indexOf(this.type))throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,o=n.createElement("DIV"),i=n.createElement("TABLE"),a=e.wtRootElement.parentNode;o.className="".concat(vs.get(this.type)," handsontable"),o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,i.className=e.TABLE.className,o.appendChild(i),a.appendChild(o);var l=this.wtSettings.getSetting("preventOverflow");return!0===l||"horizontal"===l&&this.type===cs||"vertical"===l&&this.type===hs?this.mainTableScrollableElement=r:"hidden"===r.getComputedStyle(a).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=rn(e.TABLE),new $u(i,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}},{key:"reset",value:function(){if(this.clone){var e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,n=e.style,r=t.style,o=e.parentNode.style;U([n,r,o],(function(e){e.width="",e.height=""}))}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function tc(e){return tc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tc(e)}function nc(e,t,n){return nc=fc()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),i=new o;return n&&lc(i,n.prototype),i},nc.apply(null,arguments)}function rc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ic(e,t,n){return t&&oc(e.prototype,t),n&&oc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ac(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lc(e,t)}function lc(e,t){return lc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},lc(e,t)}function sc(e){var t=fc();return function(){var n,r=hc(e);if(t){var o=hc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return uc(this,n)}}function uc(e,t){if(t&&("object"===tc(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return cc(e)}function cc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fc(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function hc(e){return hc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},hc(e)}function dc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pc=function(e){ac(n,e);var t=sc(n);function n(e,r,o,i){var a;return rc(this,n),a=t.call(this,e,r,cs,o,i),dc(cc(a),"cachedFixedRowsTop",-1),a.cachedFixedRowsTop=a.wtSettings.getSetting("fixedRowsTop"),a}return ic(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return nc(Qs,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode,t=this.domBindings.rootWindow,n=this.wtSettings.getSetting("preventOverflow"),r=0,o=!1;if(this.trimmingContainer!==t||n&&"vertical"===n)r=this.getScrollPosition(),En(e);else{var i=this.wot.wtTable,a=i.hider.getBoundingClientRect(),l=Math.ceil(a.bottom),s=e.offsetHeight;o=l===s,r=this.getOverlayOffset(),kn(e,"0px","".concat(r,"px"))}var u=this.adjustHeaderBordersPosition(r,o);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(en(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){var n=this.wtSettings.getSetting("defaultRowHeight"),r=e,o=0;while(r<t){var i=this.wot.wtTable.getRowHeight(r);o+=void 0===i?n:i,r+=1}return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,o=Cn(n),i=this.clone.wtTable.holder.parentNode,a=i.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===l){var s=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(s-=o),s=Math.min(s,e.wtRootElement.scrollWidth),a.width="".concat(s,"px")}else a.width="";this.clone.wtTable.holder.style.width=a.width;var u=cn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(e=null===n||void 0===n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height="".concat(parseInt(t.parentNode.style.height,10)+o,"px")}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable.spreader;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):t.style[e]=""}},{key:"scrollTo",value:function(e,t){var n=this.wot,r=this.wtSettings,o=n.cloneSource?n.cloneSource:n,i=o.wtTable.holder,a=this.getTableParentOffset(),l=0;if(t){var s=this.wot.wtTable.getRowHeight(e),u=this.wot.wtViewport.getViewportHeight();s>u&&(t=!1)}if(t&&i.offsetHeight!==i.clientHeight&&(l=Cn(this.domBindings.rootDocument)),t){var c=r.getSetting("fixedRowsBottom"),f=r.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=n.wtViewport.getViewportHeight()-this.sumCellSizes(f-c,f),a+=1}else a+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return tn(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){var r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),i=r-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>i&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("totalColumns");r?zt(n,"emptyColumns"):Ut(n,"emptyColumns");var o=!1;if(!t){var i=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==i,l=this.wtSettings.getSetting("columnHeaders");if((a||0===i)&&l.length>0){var s=Wt(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||0===this.wtSettings.getSetting("totalRows")?(Ut(n,"innerBorderTop"),o=!s):(zt(n,"innerBorderTop"),o=s)}}return o}}]),n}(ec),yc="stickyRowsBottom",vc={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),n=e-t;return 0===e||0===t?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};fe(vc,"MIXIN_NAME",yc,{writable:!1,enumerable:!1});var gc=vc;function mc(e){return mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mc(e)}function bc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wc(e,t,n){return t&&bc(e.prototype,t),n&&bc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sc(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oc(e,t)}function Oc(e,t){return Oc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Oc(e,t)}function kc(e){var t=Tc();return function(){var n,r=Pc(e);if(t){var o=Pc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Rc(this,n)}}function Rc(e,t){if(t&&("object"===mc(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ec(e)}function Ec(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tc(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Pc(e){return Pc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Pc(e)}var Mc=function(e){Sc(n,e);var t=kc(n);function n(e,r,o,i){return Cc(this,n),t.call(this,e,r,o,i,fs)}return wc(n)}(js);se(Mc,gc),se(Mc,Ls);var Ac=Mc;function Ic(e){return Ic="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ic(e)}function jc(e,t,n){return jc=Fc()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),i=new o;return n&&Nc(i,n.prototype),i},jc.apply(null,arguments)}function xc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hc(e,t,n){return t&&_c(e.prototype,t),n&&_c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dc(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nc(e,t)}function Nc(e,t){return Nc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Nc(e,t)}function Lc(e){var t=Fc();return function(){var n,r=Wc(e);if(t){var o=Wc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bc(this,n)}}function Bc(e,t){if(t&&("object"===Ic(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Vc(e)}function Vc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fc(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Wc(e){return Wc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Wc(e)}function Uc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zc=function(e){Dc(n,e);var t=Lc(n);function n(e,r,o,i){var a;return xc(this,n),a=t.call(this,e,r,fs,o,i),Uc(Vc(a),"cachedFixedRowsBottom",-1),a.cachedFixedRowsBottom=a.wtSettings.getSetting("fixedRowsBottom"),a}return Hc(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return jc(Ac,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var e=this.domBindings.rootWindow,t=this.clone.wtTable.holder.parentNode;t.style.top="";var n=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),t.style.bottom="".concat(n,"px"));var o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,r=this.domBindings.rootDocument,o=this.clone.wtTable.holder.parentNode,i=0;n.hasVerticalScroll()||(i+=n.getWorkspaceHeight()-t.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(i+=Cn(r)),o.style.bottom="".concat(i,"px")}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===t?(t.scrollTo(en(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){var n=this.wot,r=n.wtTable,o=n.wtSettings,i=o.getSetting("defaultRowHeight"),a=e,l=0;while(a<t){var s=r.getRowHeight(a);l+=void 0===s?i:s,a+=1}return l}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,r=this.domBindings,o=r.rootDocument,i=r.rootWindow,a=Cn(o),l=this.clone.wtTable.holder.parentNode,s=l.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||"horizontal"===u){var c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=a),c=Math.min(c,t.wtRootElement.scrollWidth),s.width="".concat(c,"px")}else s.width="";this.clone.wtTable.holder.style.width=s.width;var f=cn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(f=0),s.height="".concat(f,"px")}},{key:"adjustRootChildrenSize",value:function(){var e=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable.spreader;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):t.style[e]=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),r=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=r.wtTable.holder,i=0;t&&o.offsetHeight!==o.clientHeight&&(i=Cn(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return tn(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){var r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),i=r-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+r,0),n>i&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,r=this.wtSettings.getSetting("columnHeaders"),o=!1;if((n||0===t)&&r.length>0){var i=this.wot.wtTable.holder.parentNode,a=Wt(i,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?(Ut(i,"innerBorderBottom"),o=!a):(zt(i,"innerBorderBottom"),o=a)}return o}}]),n}(ec),Gc="calculatedRows",Yc={getFirstRenderedRow:function(){var e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow:function(){var e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getLastRenderedRow:function(){var e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow:function(){var e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};fe(Yc,"MIXIN_NAME",Gc,{writable:!1,enumerable:!1});var Kc=Yc,Xc="stickyColumnsStart",$c={getFirstRenderedColumn:function(){var e=this.wtSettings.getSetting("totalColumns");return 0===e?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};fe($c,"MIXIN_NAME",Xc,{writable:!1,enumerable:!1});var qc=$c;function Qc(e){return Qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qc(e)}function Jc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zc(e,t,n){return t&&Jc(e.prototype,t),n&&Jc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ef(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tf(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nf(e,t)}function nf(e,t){return nf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},nf(e,t)}function rf(e){var t=lf();return function(){var n,r=sf(e);if(t){var o=sf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return of(this,n)}}function of(e,t){if(t&&("object"===Qc(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return af(e)}function af(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lf(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function sf(e){return sf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sf(e)}var uf=function(e){tf(n,e);var t=rf(n);function n(e,r,o,i){return ef(this,n),t.call(this,e,r,o,i,hs)}return Zc(n)}(js);se(uf,Kc),se(uf,qc);var cf=uf;function ff(e){return ff="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ff(e)}function hf(e,t,n){return hf=Cf()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),i=new o;return n&&gf(i,n.prototype),i},hf.apply(null,arguments)}function df(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yf(e,t,n){return t&&pf(e.prototype,t),n&&pf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function vf(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gf(e,t)}function gf(e,t){return gf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},gf(e,t)}function mf(e){var t=Cf();return function(){var n,r=Sf(e);if(t){var o=Sf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bf(this,n)}}function bf(e,t){if(t&&("object"===ff(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return wf(e)}function wf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cf(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Sf(e){return Sf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Sf(e)}var Of=function(e){vf(n,e);var t=mf(n);function n(e,r,o,i){return df(this,n),t.call(this,e,r,hs,o,i)}return yf(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return hf(cf,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot.wtTable;if(!this.needFullRender||!e.holder.parentNode)return!1;var t=this.domBindings.rootWindow,n=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow"),o=0;this.trimmingContainer!==t||r&&"horizontal"===r?(o=this.getScrollPosition(),En(n)):(o=this.getOverlayOffset()*(this.isRtl()?-1:1),kn(n,"".concat(o,"px"),"0px"));var i=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),i}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,Zt(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(e,t){var n=this.wtSettings.getSetting("defaultColumnWidth"),r=e,o=0;while(r<t)o+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,o=Cn(n),i=this.clone.wtTable.holder.parentNode,a=i.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===l){var s=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(s-=o),s=Math.min(s,e.wtRootElement.scrollHeight),a.height="".concat(s,"px")}else a.height="";this.clone.wtTable.holder.style.height=a.height;var u=un(this.clone.wtTable.TABLE);a.width="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(e=null===n||void 0===n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width="".concat(parseInt(t.parentNode.style.width,10)+o,"px")}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),r=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=r.wtTable.holder,i=0;if(t){var a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(t=!1)}return t&&o.offsetWidth!==o.clientWidth&&(i=Cn(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var e=this.wtSettings.getSetting("preventOverflow"),t=0;return e||this.trimmingContainer!==this.domBindings.rootWindow||(t=this.wot.wtTable.holderOffset.left),t}},{key:"getScrollPosition",value:function(){return Math.abs(nn(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!t||"horizontal"!==t)){n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var r=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),i=r-o;n>i&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),r=this.wtSettings.getSetting("fixedColumnsStart"),o=this.wtSettings.getSetting("totalRows");o?zt(t,"emptyRows"):Ut(t,"emptyRows");var i=!1;if(r&&!n.length)Ut(t,"innerBorderLeft innerBorderInlineStart");else if(!r&&n.length){var a=Wt(t,"innerBorderInlineStart");e?(Ut(t,"innerBorderLeft innerBorderInlineStart"),i=!a):(zt(t,"innerBorderLeft innerBorderInlineStart"),i=a)}return i}}]),n}(ec);function kf(e){return kf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kf(e)}function Rf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ef(e,t,n){return t&&Rf(e.prototype,t),n&&Rf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pf(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mf(e,t)}function Mf(e,t){return Mf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Mf(e,t)}function Af(e){var t=xf();return function(){var n,r=_f(e);if(t){var o=_f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return If(this,n)}}function If(e,t){if(t&&("object"===kf(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return jf(e)}function jf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xf(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _f(e){return _f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_f(e)}var Hf=function(e){Pf(n,e);var t=Af(n);function n(e,r,o,i){return Tf(this,n),t.call(this,e,r,o,i,ds)}return Ef(n)}(js);se(Hf,Hs),se(Hf,qc);var Df=Hf;function Nf(e){return Nf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nf(e)}function Lf(e,t,n){return Lf=Kf()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),i=new o;return n&&Uf(i,n.prototype),i},Lf.apply(null,arguments)}function Bf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ff(e,t,n){return t&&Vf(e.prototype,t),n&&Vf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wf(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Uf(e,t)}function Uf(e,t){return Uf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Uf(e,t)}function zf(e){var t=Kf();return function(){var n,r=Xf(e);if(t){var o=Xf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Gf(this,n)}}function Gf(e,t){if(t&&("object"===Nf(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Yf(e)}function Yf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kf(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Xf(e){return Xf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xf(e)}function $f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qf=function(e){Wf(n,e);var t=zf(n);function n(e,r,o,i,a,l){var s;return Bf(this,n),s=t.call(this,e,r,ds,o,i),$f(Yf(s),"topOverlay",void 0),$f(Yf(s),"inlineStartOverlay",void 0),s.topOverlay=a,s.inlineStartOverlay=l,s}return Ff(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Lf(Df,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var t=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();kn(e,"".concat(t,"px"),"".concat(n,"px"))}else En(e);var r=cn(this.clone.wtTable.TABLE),o=un(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height="".concat(r,"px"),e.style.width="".concat(o,"px"),!1}}]),n}(ec);function Qf(e){return Qf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qf(e)}function Jf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zf(e,t,n){return t&&Jf(e.prototype,t),n&&Jf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function eh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function th(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nh(e,t)}function nh(e,t){return nh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},nh(e,t)}function rh(e){var t=ah();return function(){var n,r=lh(e);if(t){var o=lh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oh(this,n)}}function oh(e,t){if(t&&("object"===Qf(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ih(e)}function ih(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ah(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function lh(e){return lh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lh(e)}var sh=function(e){th(n,e);var t=rh(n);function n(e,r,o,i){return eh(this,n),t.call(this,e,r,o,i,ps)}return Zf(n)}(js);se(sh,gc),se(sh,qc);var uh=sh;function ch(e){return ch="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ch(e)}function fh(e,t,n){return fh=wh()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),i=new o;return n&&vh(i,n.prototype),i},fh.apply(null,arguments)}function hh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ph(e,t,n){return t&&dh(e.prototype,t),n&&dh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function yh(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vh(e,t)}function vh(e,t){return vh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},vh(e,t)}function gh(e){var t=wh();return function(){var n,r=Ch(e);if(t){var o=Ch(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mh(this,n)}}function mh(e,t){if(t&&("object"===ch(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return bh(e)}function bh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wh(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ch(e){return Ch=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ch(e)}var Sh=function(e){yh(n,e);var t=gh(n);function n(e,r,o,i,a,l){var s;return hh(this,n),s=t.call(this,e,r,ps,o,i),s.bottomOverlay=a,s.inlineStartOverlay=l,s}return ph(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return fh(uh,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var n=this.inlineStartOverlay.getOverlayOffset(),r=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]="".concat(n,"px"),t.style.bottom="".concat(r,"px")}else En(t),this.repositionOverlay();var o=cn(this.clone.wtTable.TABLE),i=un(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),t.style.height="".concat(o,"px"),t.style.width="".concat(i,"px"),!1}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,r=this.domBindings.rootDocument,o=this.clone.wtTable.holder.parentNode,i=0;n.hasVerticalScroll()||(i+=n.getWorkspaceHeight()-t.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(i+=Cn(r)),o.style.bottom="".concat(i,"px")}}]),n}(ec);function Oh(e,t,n){return Oh=kh()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),i=new o;return n&&Rh(i,n.prototype),i},Oh.apply(null,arguments)}function kh(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Rh(e,t){return Rh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Rh(e,t)}function Eh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Th(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ph(e,t,n){return t&&Th(e.prototype,t),n&&Th(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ah=function(){function e(t,n,r,o,i,a){var l=this;Eh(this,e),Mh(this,"wot",null),Mh(this,"topOverlay",null),Mh(this,"bottomOverlay",null),Mh(this,"inlineStartOverlay",null),Mh(this,"topInlineStartCornerOverlay",null),Mh(this,"bottomInlineStartCornerOverlay",null),Mh(this,"browserLineHeight",void 0),Mh(this,"wtSettings",null),Mh(this,"resizeObserver",new ResizeObserver((function(e){T((function(){Array.isArray(e)&&e.length&&l.wtSettings.getSetting("onContainerElementResize")}))}))),this.wot=t,this.wtSettings=o,this.domBindings=r,this.facadeGetter=n,this.wtTable=a;var s=this.domBindings,u=s.rootDocument,c=s.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Cn(u);var f="hidden"===c.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=f?a.holder:rn(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}return Ph(e,[{key:"initBrowserLineHeight",value:function(){var e=this.domBindings,t=e.rootWindow,n=e.rootDocument,r=t.getComputedStyle(n.body),o=parseInt(r.lineHeight,10),i=1.2*parseInt(r.fontSize,10);this.browserLineHeight=o||i}},{key:"initOverlays",value:function(){var e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=Oh(pc,e),this.bottomOverlay=Oh(zc,e),this.inlineStartOverlay=Oh(Of,e),this.topInlineStartCornerOverlay=Oh(qf,e.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=Oh(Sh,e.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var e=this,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,o=this.topOverlay.mainTableScrollableElement,i=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",(function(t){return e.onKeyDown(t)})),this.eventManager.addEventListener(n.documentElement,"keyup",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(n,"visibilitychange",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(o,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0}),o!==i&&this.eventManager.addEventListener(i,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0});var a=r.devicePixelRatio&&r.devicePixelRatio>1,l=this.scrollableElement===r,s=this.wtSettings.getSetting("preventWheel"),u={passive:l};(s||a||!Oe())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(function(t){return e.onCloneWheel(t,s)}),u);var c,f=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];f.forEach((function(t){if(t&&t.needFullRender){var n=t.clone.wtTable.holder;e.eventManager.addEventListener(n,"wheel",(function(t){return e.onCloneWheel(t,s)}),u)}})),this.eventManager.addEventListener(r,"resize",(function(){clearTimeout(c),c=setTimeout((function(){e.wtSettings.getSetting("onWindowResize")}),200)})),l||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(e){var t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(r!==t&&o!==t&&!e.target.contains(r)||n!==t&&o!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}},{key:"onCloneWheel",value:function(e,t){var n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=e.target,a=o!==n&&i!==n&&!i.contains(o),l=r!==n&&i!==n&&!i.contains(r);if(!this.keyPressed||!a&&!l){var s=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&s)&&e.preventDefault()}}},{key:"onKeyDown",value:function(e){this.keyPressed=qn(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);var r=this.scrollVertically(t),o=this.scrollHorizontally(n);return r||o}},{key:"scrollVertically",value:function(e){var t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(e){var t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var e=this.domBindings.rootWindow,t=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,r=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=r[0],i=r[1];if(this.horizontalScrolling=t.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=o;var a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var e=this.topOverlay.mainTableScrollableElement,t=e.scrollLeft,n=e.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this.wtTable,t=this.domBindings.rootWindow;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=rn(e.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.updateLastSpreaderSize();t&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}},{key:"updateLastSpreaderSize",value:function(){var e=this.wtTable.spreader,t=e.clientWidth,n=e.clientHeight,r=t!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=n),r}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot.wtViewport,n=this.wtTable,r=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),i=t.getRowHeaderWidth(),a=t.getColumnHeaderHeight(),l=n.hider.style;if(l.width="".concat(i+this.inlineStartOverlay.sumCellSizes(0,r),"px"),l.height="".concat(a+this.topOverlay.sumCellSizes(0,o)+1,"px"),this.scrollbarSize>0){var s=n.wtRootElement,u=s.scrollHeight,c=s.scrollWidth,f=n.holder,h=f.scrollHeight,d=f.scrollWidth;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<d,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(e){if(!e)return null;var t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],n=null;return U(t,(function(t){t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)})),n}},{key:"syncOverlayTableClassNames",value:function(){var e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];U(t,(function(t){t&&(t.clone.wtTable.TABLE.className=e.className)}))}}]),e}(),Ih=Ah;function jh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _h(e,t,n){return t&&xh(e.prototype,t),n&&xh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Dh=function(){function e(t){var n=this;jh(this,e),Hh(this,"settings",{}),Hh(this,"defaults",Object.freeze(this.getDefaults())),he(this.defaults,(function(e,r){if(void 0!==t[r])n.settings[r]=t[r];else{if(void 0===e)throw new Error('A required setting "'.concat(r,'" was not provided'));n.settings[r]=e}}))}return _h(e,[{key:"getDefaults",value:function(){var e=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return e.getSetting("fixedColumnsStart")>0||e.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return e.getSetting("fixedRowsTop")>0||e.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return e.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(t,n,r){var o=e.getSetting("data",t,n);qt(r,void 0===o||null===o?"":o)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(e){return e},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(e){return e},onBeforeHighlightingColumnHeader:function(e){return e},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(e,t){var n=this;return void 0===t?he(e,(function(e,t){n.settings[t]=e})):this.settings[e]=t,this}},{key:"getSetting",value:function(e,t,n,r,o){return"function"===typeof this.settings[e]?this.settings[e](t,n,r,o):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}},{key:"getSettingPure",value:function(e){return this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}]),e}();function Nh(e){return Nh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nh(e)}function Lh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vh(e,t,n){return t&&Bh(e.prototype,t),n&&Bh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fh(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wh(e,t)}function Wh(e,t){return Wh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Wh(e,t)}function Uh(e){var t=Yh();return function(){var n,r=Kh(e);if(t){var o=Kh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zh(this,n)}}function zh(e,t){if(t&&("object"===Nh(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Gh(e)}function Gh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yh(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Kh(e){return Kh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Kh(e)}var Xh=function(e){Fh(n,e);var t=Uh(n);function n(e,r,o,i){return Lh(this,n),t.call(this,e,r,o,i,"master")}return Vh(n,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var e=on(this.wtRootElement),t=this.domBindings.rootWindow;if(e===t){var n=this.wtSettings.getSetting("preventOverflow");n||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var r=e.parentElement,o=an(e,"height",t),i=an(e,"overflow",t),a=this.holder.style,l=e.scrollWidth,s=e.scrollHeight,u=e.getBoundingClientRect(),c=u.width,f=u.height,h=["auto","hidden","scroll"];if(r&&h.includes(i)){var d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);var p=parseInt(sn(d,t).height,10);r.removeChild(d),0===p&&(f=0)}f=Math.min(f,s),a.height="auto"===o?"auto":"".concat(f,"px"),c=Math.min(c,l),a.width="".concat(c,"px"),a.overflow="",this.hasTableHeight="auto"===a.height||f>0,this.hasTableWidth=c>0}this.isTableVisible=Qt(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var e=this.wtSettings,t=this.dataAccessObject.wtViewport,n="master",r=e.getSetting("columnHeaders"),o=r.length;if(o&&!t.hasOversizedColumnHeadersMarked[n]){for(var i=e.getSetting("rowHeaders"),a=i.length,l=this.getRenderedColumnsCount(),s=0;s<o;s++)for(var u=-1*a;u<l;u++)this.markIfOversizedColumnHeader(u);t.hasOversizedColumnHeadersMarked[n]=!0}}}]),n}(js);se(Xh,Kc),se(Xh,Ls);var $h=Xh,qh=1,Qh=2;function Jh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ed(e,t,n){return t&&Zh(e.prototype,t),n&&Zh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var td=new WeakMap,nd=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.scrollbarHeight;Jh(this,e),td.set(this,{viewportHeight:n,scrollOffset:r,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return ed(e,[{key:"calculate",value:function(){for(var t,n=0,r=!0,o=[],i=td.get(this),a=i.calculationType,l=i.overrideFn,s=i.rowHeightFn,u=i.scrollOffset,c=i.totalRows,f=i.viewportHeight,h=i.horizontalScrollbarHeight||0,d=0;d<c;d++)if(t=s(d),isNaN(t)&&(t=e.DEFAULT_HEIGHT),n<=u&&a!==Qh&&(this.startRow=d),n>=u&&n+(a===Qh?t:0)<=u+f-h&&(null===this.startRow&&(this.startRow=d),this.endRow=d),o.push(n),n+=t,a!==Qh&&(this.endRow=d),n>=u+f-h){r=!1;break}if(this.endRow===c-1&&r){this.startRow=this.endRow;while(this.startRow>0){var p=o[this.endRow]+t-o[this.startRow-1];if((p<=f-h||a!==Qh)&&(this.startRow-=1),p>=f-h)break}}a===qh&&null!==this.startRow&&l&&l(this),this.startPosition=o[this.startRow],void 0===this.startPosition&&(this.startPosition=null),c<this.endRow&&(this.endRow=c-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}(),rd=nd;function od(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function id(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ad(e,t,n){return t&&id(e.prototype,t),n&&id(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var ld=new WeakMap,sd=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,s=t.stretchMode,u=t.stretchingItemWidthFn,c=void 0===u?function(e){return e}:u;od(this,e),ld.set(this,{viewportWidth:n,scrollOffset:r,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:l,stretchingColumnWidthFn:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return ad(e,[{key:"calculate",value:function(){for(var e,t=0,n=!0,r=[],o=ld.get(this),i=o.calculationType,a=o.overrideFn,l=o.scrollOffset,s=o.totalColumns,u=o.viewportWidth,c=0;c<s;c++){e=this._getColumnWidth(c),t<=l&&i!==Qh&&(this.startColumn=c);var f=l>0?u+1:u;if(t>=l&&t+(i===Qh?e:0)<=l+f&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=c),this.endColumn=c),r.push(t),t+=e,i!==Qh&&(this.endColumn=c),t>=l+u){n=!1;break}}if(this.endColumn===s-1&&n){this.startColumn=this.endColumn;while(this.startColumn>0){var h=r[this.endColumn]+e-r[this.startColumn-1];if((h<=u||i!==Qh)&&(this.startColumn-=1),h>u)break}}i===qh&&null!==this.startColumn&&a&&a(this),this.startPosition=r[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(e){if("none"!==this.stretch){var t=e;this.totalTargetWidth=t;for(var n=ld.get(this),r=n.totalColumns,o=0,i=0;i<r;i++){var a=this._getColumnWidth(i),l=n.stretchingColumnWidthFn(void 0,i);"number"===typeof l?t-=l:o+=a}var s=t-o;if("all"===this.stretch&&s>0)this.stretchAllRatio=t/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&t!==1/0){var u=this._getColumnWidth(r-1),c=s+u;this.stretchLastWidth=c>=0?c:u}}}},{key:"getStretchedColumnWidth",value:function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n}},{key:"_getStretchedAllColumnWidth",value:function(e,t){var n=0,r=ld.get(this),o=r.totalColumns;if(!this.stretchAllColumnsWidth[e]){var i=Math.round(t*this.stretchAllRatio),a=r.stretchingColumnWidthFn(i,e);this.stretchAllColumnsWidth[e]=void 0===a?i:isNaN(a)?this._getColumnWidth(e):a}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var l=0;l<this.stretchAllColumnsWidth.length;l++)n+=this.stretchAllColumnsWidth[l];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}},{key:"_getStretchedLastColumnWidth",value:function(e){var t=ld.get(this),n=t.totalColumns;return e===n-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var n=ld.get(this).columnWidthFn(t);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}(),ud=sd;function cd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hd(e,t,n){return t&&fd(e.prototype,t),n&&fd(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var dd=function(){function e(t,n,r,o,i){var a=this;cd(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(function(){a.clientHeight=a.getWorkspaceHeight()}))}return hd(e,[{key:"getWorkspaceHeight",value:function(){var e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer,n=0;if(t===this.domBindings.rootWindow)n=e.documentElement.clientHeight;else{var r=cn(t);n=r>0&&t.clientHeight>0?t.clientHeight:1/0}return n}},{key:"getWorkspaceWidth",value:function(){var e,t,n=this.wtSettings,r=this.domBindings,o=r.rootDocument,i=r.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=o.documentElement.offsetWidth,s=n.getSetting("totalColumns"),u=n.getSetting("preventOverflow"),c=n.getSetting("rtlMode"),f=this.wtTable.TABLE.getBoundingClientRect(),h=c?f.right-l:f.left,d=l-h;if(u)return un(this.wtTable.wtRootElement);if(e=n.getSetting("freezeOverlays")?Math.min(d,l):Math.min(this.getContainerFillWidth(),d,l),a===i&&s>0&&this.sumColumnWidths(0,s-1)>e)return o.documentElement.clientWidth;if(a!==i&&(t=an(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),"scroll"===t||"hidden"===t||"auto"===t))return Math.max(e,a.clientWidth);var p=n.getSetting("stretchH");return"none"!==p&&p?e:Math.max(e,un(this.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,t){var n=0,r=e;while(r<t)n+=this.wtTable.getColumnWidth(r),r+=1;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);var n=t.offsetWidth;return this.containerWidth=n,e.removeChild(t),n}},{key:"getWorkspaceOffset",value:function(){return Jt(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var e=this.wtSettings.getSetting("columnHeaders");return e.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=cn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}},{key:"getRowHeaderWidth",value:function(){var e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var n=0,r=t.length;n<r;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(t.length){var o=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var i=0,a=t.length;i<a;i++)o?(this.rowHeaderWidth+=un(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth();if(e===1/0)return e;var t=this.getRowHeaderWidth();return t>0?e-t:e}},{key:"createRowsCalculator",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qh,o=this.wtSettings,i=this.wtTable;this.rowHeaderWidth=NaN,e=o.getSetting("renderAllRows")&&r===qh?1/0:this.getViewportHeight();var a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;a<0&&(a=0);var l=o.getSetting("fixedRowsTop"),s=o.getSetting("fixedRowsBottom"),u=o.getSetting("totalRows");return l&&(n=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=n,e-=n),s&&this.dataAccessObject.bottomOverlay.clone&&(n=this.dataAccessObject.bottomOverlay.sumCellSizes(u-s,u),e-=n),t=i.holder.clientHeight===i.holder.offsetHeight?0:Cn(this.domBindings.rootDocument),new rd({viewportSize:e,scrollOffset:a,totalItems:o.getSetting("totalRows"),itemSizeFn:function(e){return i.getRowHeight(e)},overrideFn:o.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:t})}},{key:"createColumnsCalculator",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qh,t=this.wtSettings,n=this.wtTable,r=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN,o<0&&(o=0);var i=t.getSetting("fixedColumnsStart");if(i){var a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,i);o+=a,r-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(r-=Cn(this.domBindings.rootDocument)),new ud({viewportSize:r,scrollOffset:Math.abs(o),totalItems:t.getSetting("totalColumns"),itemSizeFn:function(e){return n.getColumnWidth(e)},overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:function(e,n){return t.getSetting("onBeforeStretchingColumnWidth",e,n)}})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e;if(t){var n=this.createRowsCalculator(Qh),r=this.createColumnsCalculator(Qh);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(r)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(qh),this.columnsRenderCalculator=this.createColumnsCalculator(qh)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(Qh),this.columnsVisibleCalculator=this.createColumnsCalculator(Qh)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){if(!this.rowsVisibleCalculator)return!1;var t=e.startRow,n=e.endRow;if(null===t&&null===n)return!1;var r=this.rowsRenderCalculator,o=r.startRow,i=r.endRow;return!(t<o||t===o&&t>0)&&!(n>i||n===i&&n<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){if(!this.columnsVisibleCalculator)return!1;var t=e.startColumn,n=e.endColumn;if(null===t&&null===n)return!1;var r=this.columnsRenderCalculator,o=r.startColumn,i=r.endColumn;return!(t<o||t===o&&t>0)&&!(n>i||n===i&&n<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){he(this.hasOversizedColumnHeadersMarked,(function(e,t,n){n[t]=void 0}))}}]),e}(),pd=dd;function yd(e){return yd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yd(e)}function vd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function md(e,t,n){return t&&gd(e.prototype,t),n&&gd(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function bd(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wd(e,t)}function wd(e,t){return wd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},wd(e,t)}function Cd(e){var t=kd();return function(){var n,r=Rd(e);if(t){var o=Rd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Sd(this,n)}}function Sd(e,t){if(t&&("object"===yd(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Od(e)}function Od(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kd(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Rd(e){return Rd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Rd(e)}var Ed=function(e){bd(n,e);var t=Cd(n);function n(e,r){var o;vd(this,n),o=t.call(this,e,new Dh(r));var i=o.wtSettings.getSetting("facade",Od(o));return o.wtTable=new $h(o.getTableDao(),i,o.domBindings,o.wtSettings),o.wtViewport=new pd(o.getViewportDao(),o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.selections=o.wtSettings.getSetting("selections"),o.wtEvent=new Ki(i,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections),o.wtOverlays=new Ih(Od(o),i,o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.exportSettingsAsClassNames(),o.findOriginalHeaders(),o}return md(n,[{key:"exportSettingsAsClassNames",value:function(){var e=this,t={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];he(t,(function(t,o){e.wtSettings.getSetting(o).length&&r.push(t),n.push(t)})),zt(this.wtTable.wtRootElement.parentNode,n),Ut(this.wtTable.wtRootElement.parentNode,r)}},{key:"getViewportDao",value:function(){var e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}]),n}(Du);function Td(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Md(e,t,n){return t&&Pd(e.prototype,t),n&&Pd(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ad=function(){function e(t){Td(this,e),t instanceof Du?this._wot=t:this._initFromSettings(t)}return Md(e,[{key:"_initFromSettings",value:function(t){t.facade=function(t){var n=new e(t);return function(){return n}},this._wot=new Ed(t.table,t)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(e){this._wot.drawn=e}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(e){this._wot.drawInterrupted=e}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(e){this._wot.lastMouseOver=e}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(e){this._wot.momentumScrolling=e}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(e){this._wot.touchApplied=e}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(e){this._wot.eventListeners=e}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(e,t){return this._wot.createCellCoords(e,t)}},{key:"createCellRange",value:function(e,t,n){return this._wot.createCellRange(e,t,n)}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}},{key:"scrollViewport",value:function(e,t,n,r,o){return this._wot.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this._wot.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this._wot.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(e,t){return this._wot.wtSettings.update(e,t),this}},{key:"getSetting",value:function(e,t,n,r,o){return this._wot.wtSettings.getSetting(e,t,n,r,o)}},{key:"hasSetting",value:function(e){return this._wot.wtSettings.hasSetting(e)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}();function Id(e){var t=e.isShiftKey,n=e.isLeftClick,r=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,l=e.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||c)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):c&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!c&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!c&&o.row<0||c&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var f=!i.inInSelection(o),h=n||r&&f;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function jd(e){var t=e.isLeftClick,n=e.coords,r=e.selection,o=e.controller,i=e.cellCoordsFactory;if(t){var a=r.isSelectedByRowHeader(),l=r.isSelectedByColumnHeader(),s=r.tableProps.countCols(),u=r.tableProps.countRows();l&&!o.column?r.setRangeEnd(i(u-1,n.col)):a&&!o.row?r.setRangeEnd(i(n.row,s-1)):o.cell||r.setRangeEnd(n)}}var xd=new Map([["mousedown",Id],["mouseover",jd],["touchstart",Id]]);function _d(e,t){var n=t.coords,r=t.selection,o=t.controller,i=t.cellCoordsFactory;xd.get(e.type)({coords:n,selection:r,controller:o,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:er(e)||"touchstart"===e.type,isRightClick:Zn(e)})}var Hd=new WeakMap,Dd=Symbol("rootInstance");function Nd(e){Hd.set(e,!0)}function Ld(e){return e===Dd}function Bd(e){return Hd.has(e)}function Vd(e,t){return Ud(e)||Wd(e,t)||Yd(e,t)||Fd()}function Fd(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Wd(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Ud(e){if(Array.isArray(e))return e}function zd(e){return Xd(e)||Kd(e)||Yd(e)||Gd()}function Gd(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Yd(e,t){if(e){if("string"===typeof e)return $d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$d(e,t):void 0}}function Kd(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Xd(e){if(Array.isArray(e))return $d(e)}function $d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jd(e,t,n){return t&&Qd(e.prototype,t),n&&Qd(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zd(e,t,n){ep(e,t),t.set(e,n)}function ep(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function np(e,t){var n=ip(e,t,"get");return rp(e,n)}function rp(e,t){return t.get?t.get.call(e):t.value}function op(e,t,n){var r=ip(e,t,"set");return ap(e,r,n),n}function ip(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function ap(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}var lp=new WeakMap,sp=new WeakMap,up=new WeakMap,cp=function(){function e(t){qd(this,e),tp(this,"instance",void 0),tp(this,"eventManager",void 0),tp(this,"settings",void 0),tp(this,"THEAD",void 0),tp(this,"TBODY",void 0),tp(this,"_wt",void 0),tp(this,"activeWt",void 0),Zd(this,sp,{writable:!0,value:0}),Zd(this,up,{writable:!0,value:0}),tp(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new Nr(this.instance),this.settings=this.instance.getSettings(),lp.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return Jd(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}},{key:"getCellAtCoords",value:function(e,t){var n=this._wt.getCell(e,t);return n<0?null:n}},{key:"scrollViewport",value:function(e,t,n,r,o){return this._wt.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this._wt.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this._wt.scrollViewportVertically(e,t,n)}},{key:"createElements",value:function(){var e=lp.get(this),t=this.instance,n=t.rootElement,r=t.rootDocument,o=n.getAttribute("style");o&&n.setAttribute("data-originalstyle",o),Ut(n,"handsontable"),e.table=r.createElement("TABLE"),Ut(e.table,"htCore"),this.instance.getSettings().tableClassName&&Ut(e.table,this.instance.getSettings().tableClassName),this.THEAD=r.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var e=this,t=lp.get(this),n=this.instance,r=n.rootElement,o=n.rootDocument,i=n.selection,a=o.documentElement;this.eventManager.addEventListener(r,"mousedown",(function(n){if(t.selectionMouseDown=!0,!e.isTextSelectionAllowed(n.target)){var r=e.instance.rootWindow;mn(r),n.preventDefault(),r.focus()}})),this.eventManager.addEventListener(r,"mouseup",(function(){t.selectionMouseDown=!1})),this.eventManager.addEventListener(r,"mousemove",(function(n){t.selectionMouseDown&&!e.isTextSelectionAllowed(n.target)&&(e.settings.fragmentSelection&&mn(e.instance.rootWindow),n.preventDefault())})),this.eventManager.addEventListener(a,"keyup",(function(e){i.isInProgress()&&!e.shiftKey&&i.finish()})),this.eventManager.addEventListener(a,"mouseup",(function(n){i.isInProgress()&&er(n)&&i.finish(),t.mouseDown=!1,!Pn(o.activeElement)&&(i.isSelected()||i.isSelectedByAnyHeader()||r.contains(n.target)||Zn(n))||e.instance.unlisten()})),this.eventManager.addEventListener(a,"contextmenu",(function(e){i.isInProgress()&&Zn(e)&&(i.finish(),t.mouseDown=!1)})),this.eventManager.addEventListener(a,"touchend",(function(){i.isInProgress()&&i.finish(),t.mouseDown=!1})),this.eventManager.addEventListener(a,"mousedown",(function(n){var i=n.target,l=n.x||n.clientX,s=n.y||n.clientY,u=n.target;if(!t.mouseDown&&r&&e.instance.view){var c=e.instance.view._wt.wtTable.holder;if(u===c){var f=Cn(o);if(o.elementFromPoint(l+f,s)!==c||o.elementFromPoint(l,s+f)!==c)return}else while(u!==a){if(null===u){if(n.isTargetWebComponent)break;return}if(u===r)return;u=u.parentNode}var h="function"===typeof e.settings.outsideClickDeselects?e.settings.outsideClickDeselects(i):e.settings.outsideClickDeselects;h?e.instance.deselectCell():e.instance.destroyEditor(!1,!1)}})),this.eventManager.addEventListener(t.table,"selectstart",(function(t){e.settings.fragmentSelection||Tn(t.target)||t.preventDefault()}))}},{key:"translateFromRenderableToVisualCoords",value:function(e){var t,n=e.row,r=e.col;return(t=this.instance)._createCellCoords.apply(t,zd(this.translateFromRenderableToVisualIndex(n,r)))}},{key:"translateFromRenderableToVisualIndex",value:function(e,t){var n=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===r&&(r=t),[n,r]}},{key:"countRenderableIndexes",value:function(e,t){var n=Math.min(e.getNotTrimmedIndexesLength(),t),r=e.getNearestNotHiddenIndex(n-1,-1);return null===r?0:e.getRenderableFromVisualIndex(r)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(e,t,n,r){if(isNaN(e)||e<0)return 0;var o=n.getNearestNotHiddenIndex(e,t),i=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(i))return 0;var a=0;return t<0?a=i+1:t>0&&(a=r-i),a}},{key:"countNotHiddenFixedColumnsStart",value:function(){var e=this.instance.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var e=this.instance.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var e=this.instance.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>t}},{key:"initializeWalkontable",value:function(){var e=this,t=lp.get(this),n={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:t.table,isDataViewInstance:function(){return Bd(e.instance)},preventOverflow:function(){return e.settings.preventOverflow},preventWheel:function(){return e.settings.preventWheel},stretchH:function(){return e.settings.stretchH},data:function(t,n){var r;return(r=e.instance).getDataAtCell.apply(r,zd(e.translateFromRenderableToVisualIndex(t,n)))},totalRows:function(){return e.countRenderableRows()},totalColumns:function(){return e.countRenderableColumns()},fixedColumnsStart:function(){return e.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return e.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return e.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return e.settings.fixedColumnsStart>0||n.rowHeaders().length>0},shouldRenderTopOverlay:function(){return e.settings.fixedRowsTop>0||n.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return e.settings.fixedRowsBottom>0},minSpareRows:function(){return e.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var t=[];return e.instance.hasRowHeaders()&&t.push((function(t,n){var r=t>=0?e.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t;e.appendRowHeader(r,n)})),e.instance.runHooks("afterGetRowHeaderRenderers",t),op(e,up,t.length),t},columnHeaders:function(){var t=[];return e.instance.hasColHeaders()&&t.push((function(t,n){var r=t>=0?e.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;e.appendColHeader(r,n)})),e.instance.runHooks("afterGetColumnHeaderRenderers",t),op(e,sp,t.length),t},columnWidth:function(t){var n=e.instance.columnIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getColWidth(null===n?t:n)},rowHeight:function(t){var n=e.instance.rowIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getRowHeight(null===n?t:n)},cellRenderer:function(t,n,r){var o=e.translateFromRenderableToVisualIndex(t,n),i=Vd(o,2),a=i[0],l=i[1],s=e.instance.runHooks("modifyGetCellCoords",a,l),u=a,c=l;if(Array.isArray(s)){var f=Vd(s,2);u=f[0],c=f[1]}var h=e.instance.getCellMeta(u,c),d=e.instance.colToProp(c),p=e.instance.getDataAtRowProp(u,d);e.instance.hasHook("beforeValueRender")&&(p=e.instance.runHooks("beforeValueRender",p,h)),e.instance.runHooks("beforeRenderer",r,a,l,d,p,h),e.instance.getCellRenderer(h)(e.instance,r,a,l,d,p,h),e.instance.runHooks("afterRenderer",r,a,l,d,p,h)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return e.settings.fragmentSelection},onWindowResize:function(){e.instance&&!e.instance.isDestroyed&&e.instance.refreshDimensions()},onContainerElementResize:function(){e.instance&&!e.instance.isDestroyed&&e.instance.refreshDimensions()},onCellMouseDown:function(n,r,o,i){var a=e.translateFromRenderableToVisualCoords(r),l={row:!1,column:!1,cell:!1};e.instance.listen(),e.activeWt=i,t.mouseDown=!0,e.instance.runHooks("beforeOnCellMouseDown",n,a,o,l),Jn(n)||(_d(n,{coords:a,selection:e.instance.selection,controller:l,cellCoordsFactory:function(t,n){return e.instance._createCellCoords(t,n)}}),e.instance.runHooks("afterOnCellMouseDown",n,a,o),e.activeWt=e._wt)},onCellContextMenu:function(n,r,o,i){var a=e.translateFromRenderableToVisualCoords(r);e.activeWt=i,t.mouseDown=!1,e.instance.selection.isInProgress()&&e.instance.selection.finish(),e.instance.runHooks("beforeOnCellContextMenu",n,a,o),Jn(n)||(e.instance.runHooks("afterOnCellContextMenu",n,a,o),e.activeWt=e._wt)},onCellMouseOut:function(t,n,r,o){var i=e.translateFromRenderableToVisualCoords(n);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseOut",t,i,r),Jn(t)||(e.instance.runHooks("afterOnCellMouseOut",t,i,r),e.activeWt=e._wt)},onCellMouseOver:function(n,r,o,i){var a=e.translateFromRenderableToVisualCoords(r),l={row:!1,column:!1,cell:!1};e.activeWt=i,e.instance.runHooks("beforeOnCellMouseOver",n,a,o,l),Jn(n)||(t.mouseDown&&_d(n,{coords:a,selection:e.instance.selection,controller:l,cellCoordsFactory:function(t,n){return e.instance._createCellCoords(t,n)}}),e.instance.runHooks("afterOnCellMouseOver",n,a,o),e.activeWt=e._wt)},onCellMouseUp:function(t,n,r,o){var i=e.translateFromRenderableToVisualCoords(n);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseUp",t,i,r),Jn(t)||e.instance.isDestroyed||(e.instance.runHooks("afterOnCellMouseUp",t,i,r),e.activeWt=e._wt)},onCellCornerMouseDown:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(t,n){return e.beforeRender(t,n)},onDraw:function(t){return e.afterRender(t)},onScrollVertically:function(){return e.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return e.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return e.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(t,n,r){var o=e.instance.rowIndexMapper,i=o.getVisualFromRenderableIndex(t),a=e.instance.runHooks("beforeHighlightingRowHeader",i,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,1))},onBeforeHighlightingColumnHeader:function(t,n,r){var o=e.instance.columnIndexMapper,i=o.getVisualFromRenderableIndex(t),a=e.instance.runHooks("beforeHighlightingColumnHeader",i,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,1))},onAfterDrawSelection:function(t,n,r){var o,i=e.translateFromRenderableToVisualIndex(t,n),a=Vd(i,2),l=a[0],s=a[1],u=e.instance.selection.getSelectedRange(),c=u.size();if(c>0){var f=(null!==r&&void 0!==r?r:0)+1-c,h=u.peekByIndex(f);o=[h.from.row,h.from.col,h.to.row,h.to.col]}return e.instance.runHooks("afterDrawSelection",l,s,o,r)},onBeforeDrawBorders:function(t,n){var r=Vd(t,4),o=r[0],i=r[1],a=r[2],l=r[3],s=[e.instance.rowIndexMapper.getVisualFromRenderableIndex(o),e.instance.columnIndexMapper.getVisualFromRenderableIndex(i),e.instance.rowIndexMapper.getVisualFromRenderableIndex(a),e.instance.columnIndexMapper.getVisualFromRenderableIndex(l)];return e.instance.runHooks("beforeDrawBorders",s,n)},onBeforeTouchScroll:function(){return e.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return e.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,n){var r=e.instance.columnIndexMapper.getVisualFromRenderableIndex(n);return e.instance.runHooks("beforeStretchingColumnWidth",t,r)},onModifyRowHeaderWidth:function(t){return e.instance.runHooks("modifyRowHeaderWidth",t)},onModifyGetCellCoords:function(t,n,r){var o=e.instance.rowIndexMapper,i=e.instance.columnIndexMapper,a=n>=0?i.getVisualFromRenderableIndex(n):n,l=t>=0?o.getVisualFromRenderableIndex(t):t,s=e.instance.runHooks("modifyGetCellCoords",l,a,r);if(Array.isArray(s)){var u=Vd(s,4),c=u[0],f=u[1],h=u[2],d=u[3];return[c>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,1)):c,f>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(f,1)):f,h>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1)):h,d>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(d,-1)):d]}},viewportRowCalculatorOverride:function(t){var n=e.settings.viewportRowRenderingOffset;if("auto"===n&&e.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){var r=e.countRenderableRows(),o=t.startRow,i=t.endRow;if("number"===typeof n)t.startRow=Math.max(o-n,0),t.endRow=Math.min(i+n,r-1);else if("auto"===n){var a=Math.ceil(i/r*12);t.startRow=Math.max(o-a,0),t.endRow=Math.min(i+a,r-1)}}e.instance.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function(t){var n=e.settings.viewportColumnRenderingOffset;if("auto"===n&&e.settings.fixedColumnsStart&&(n=10),n>0||"auto"===n){var r=e.countRenderableColumns(),o=t.startColumn,i=t.endColumn;if("number"===typeof n&&(t.startColumn=Math.max(o-n,0),t.endColumn=Math.min(i+n,r-1)),"auto"===n){var a=Math.ceil(i/r*6);t.startColumn=Math.max(o-a,0),t.endColumn=Math.min(i+a,r-1)}}e.instance.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function(){return e.settings.rowHeaderWidth},columnHeaderHeight:function(){var t=e.instance.runHooks("modifyColumnHeaderHeight");return e.settings.columnHeaderHeight||t}};this.instance.runHooks("beforeInitWalkontable",n),this._wt=new Ad(n),this.activeWt=this._wt;var r=this._wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),i=o.width,a=o.height;this.setLastSize(i,a),this.eventManager.addEventListener(r,"mousedown",(function(e){e.target===r&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(r,"contextmenu",(function(e){e.target===r&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(function(){e.settings.observeDOMVisibility&&e._wt.drawInterrupted&&(e.instance.forceFullRender=!0,e.render())}))}},{key:"isTextSelectionAllowed",value:function(e){if(Tn(e))return!0;var t=Dt(e,this.instance.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}},{key:"isMouseDown",value:function(){return lp.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var e,t;return null!==(e=null===(t=this.instance.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&void 0!==e&&e}},{key:"isCellEdited",value:function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()}},{key:"beforeRender",value:function(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}},{key:"afterRender",value:function(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;if(!Wt(n,"relative"))return Yt(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var r=this.instance,o=r.rootDocument,i=r.getRowHeader,a=o.createElement("div"),l=o.createElement("span");a.className="relative",l.className="rowHeader",this.updateCellHeader(l,e,i),a.appendChild(l),t.appendChild(a)}this.instance.runHooks("afterGetRowHeader",e,t)}},{key:"appendColHeader",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.instance.getColHeader,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t.firstChild){var o=t.firstChild;Wt(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,n,r):(Yt(t),this.appendColHeader(e,t,n,r))}else{var i=this.instance.rootDocument,a=i.createElement("div"),l=i.createElement("span");a.className="relative",l.className="colHeader",this.updateCellHeader(l,e,n,r),a.appendChild(l),t.appendChild(a)}this.instance.runHooks("afterGetColHeader",e,t,r)}},{key:"updateCellHeader",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=t,i=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Wt(e,"colHeader")?o=i.wtTable.columnFilter.sourceToRendered(t):Wt(e,"rowHeader")&&(o=i.wtTable.rowFilter.sourceToRendered(t))),o>-1?$t(e,n(t,r)):(qt(e,String.fromCharCode(160)),Ut(e,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(e){var t=this._wt.wtViewport.getWorkspaceWidth(),n=t-e;return n>0?n:0}},{key:"maximumVisibleElementHeight",value:function(e){var t=this._wt.wtViewport.getWorkspaceHeight(),n=t-e;return n>0?n:0}},{key:"setLastSize",value:function(e,t){var n=lp.get(this),r=[e,t];n.lastWidth=r[0],n.lastHeight=r[1]}},{key:"getLastSize",value:function(){var e=lp.get(this);return{width:e.lastWidth,height:e.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return np(this,sp)}},{key:"getRowHeadersCount",value:function(){return np(this,up)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}(),fp=cp;function hp(e){return hp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hp(e)}var dp="ABCDEFGHIJKLMNOPQRSTUVWXYZ",pp=dp.length;function yp(e){var t,n=e+1,r="";while(n>0)t=(n-1)%pp,r=String.fromCharCode(65+t)+r,n=parseInt((n-t)/pp,10);return r}function vp(e){var t=0;if(e)for(var n=0,r=e.length-1;n<e.length;n+=1,r-=1)t+=Math.pow(pp,r)*(dp.indexOf(e[n])+1);return t-=1,t}function gp(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(e=0;e<n;e++){var i=[];for(t=0;t<r;t++)i.push(yp(t)+(e+1));o.push(i)}return o}function mp(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(e=0;e<n;e++){var i={};for(t=0;t<r;t++)i["prop".concat(t)]=yp(t)+(e+1);o.push(i)}return o}function bp(e,t){for(var n,r=[],o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function wp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e,r=[];return Array.isArray(e)&&Array.isArray(e[0])||(n=[e]),n.forEach((function(e,n){Array.isArray(e)?e.forEach((function(e,o){r.push([n+t,o,e])})):Object.keys(e).forEach((function(o){r.push([n+t,o,e[o]])}))})),r}function Cp(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&ce(e[0])&&(t=ye(e[0]))),t}function Sp(e){return!!(Array.isArray(e)&&e.length&&e.every((function(e){return Array.isArray(e)})))}function Op(e){return!!(Array.isArray(e)&&e.length&&e.every((function(e){return"object"===hp(e)&&!Array.isArray(e)&&null!==e})))}function kp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ep(e,t,n){return t&&Rp(e.prototype,t),n&&Rp(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Tp=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];kp(this,e),this.hot=t,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return Ep(e,[{key:"modifyRowData",value:function(e){var t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}},{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}},{key:"setData",value:function(e){this.data=e}},{key:"getAtColumn",value:function(e){var t=this,n=[];return U(this.data,(function(r,o){var i=t.getAtCell(o,e);n.push(i)})),n}},{key:"getAtRow",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=void 0===t&&void 0===n,a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],i?a.forEach((function(t,n){l[n]=r.getAtPhysicalCell(e,n,a)})):Co(t,n,(function(n){l[n-t]=r.getAtPhysicalCell(e,n,a)}));else if(ce(a)||jn(a))if(l=o?[]:{},!i||o){var s=0,u=this.countFirstRowKeys()-1;Co(s,u,(function(i){var c=r.colToProp(i);if(i>=(t||s)&&i<=(n||u)&&!Number.isInteger(c)){var f=r.getAtPhysicalCell(e,c,a);o?l.push(f):pe(l,c,f)}}))}else he(a,(function(t,n){pe(l,n,r.getAtPhysicalCell(e,n,a))}));return l}},{key:"setAtCell",value:function(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var r=ve(n);this.hot.runHooks("modifySourceData",e,this.propToCol(t),r,"set"),r.isTouched()&&(n=r.value)}Number.isInteger(t)?this.data[e][t]=n:pe(this.data[e],t,n)}}},{key:"getAtPhysicalCell",value:function(e,t,n){var r=null;if(n&&(r="string"===typeof t?de(n,t):"function"===typeof t?t(n):n[t]),this.hot.hasHook("modifySourceData")){var o=ve(r);this.hot.runHooks("modifySourceData",e,this.colToProp(t),o,"get"),o.isTouched()&&(r=o.value)}return r}},{key:"getAtCell",value:function(e,t){var n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}},{key:"getByRange",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,i=null,a=null,l=null,s=null;null===t||null===n?(o=!0,i=0,l=this.countRows()-1):(i=Math.min(t.row,n.row),a=Math.min(t.col,n.col),l=Math.max(t.row,n.row),s=Math.max(t.col,n.col));var u=[];return Co(i,l,(function(t){u.push(o?e.getAtRow(t,void 0,void 0,r):e.getAtRow(t,a,s,r))})),u}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}},{key:"countFirstRowKeys",value:function(){return Cp(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}(),Pp=Tp,Mp=(n("7003"),n("7cd7"),"localHooks"),Ap={_localHooks:Object.create(null),addLocalHook:function(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks:function(e,t,n,r,o,i,a){if(this._localHooks[e])for(var l=this._localHooks[e].length,s=0;s<l;s++)Vn(this._localHooks[e][s],this,t,n,r,o,i,a)},clearLocalHooks:function(){return this._localHooks={},this}};fe(Ap,"MIXIN_NAME",Mp,{writable:!1,enumerable:!1});var Ip=Ap;function jp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _p(e,t,n){return t&&xp(e.prototype,t),n&&xp(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Hp=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;jp(this,e),this.indexedValues=[],this.initValueOrFn=t}return _p(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(e){var t=this.indexedValues;if(e<t.length)return t[e]}},{key:"setValues",value:function(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,jn(this.initValueOrFn)?Co(t-1,(function(t){return e.indexedValues.push(e.initValueOrFn(t))})):Co(t-1,(function(){return e.indexedValues.push(e.initValueOrFn)})),this.runLocalHooks("change")}},{key:"init",value:function(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();function Dp(e){return Vp(e)||Bp(e)||Lp(e)||Np()}function Np(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Lp(e,t){if(e){if("string"===typeof e)return Fp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fp(e,t):void 0}}function Bp(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Vp(e){if(Array.isArray(e))return Fp(e)}function Fp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Wp(e,t,n){return[].concat(Dp(e.slice(0,t)),Dp(n),Dp(e.slice(t)))}function Up(e,t){return F(e,(function(e){return!1===t.includes(e)}))}function zp(e,t){return W(e,(function(e){return e-t.filter((function(t){return t<e})).length}))}function Gp(e,t){var n=t[0],r=t.length;return W(e,(function(e){return e>=n?e+r:e}))}function Yp(e){return Yp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yp(e)}function Kp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $p(e,t,n){return t&&Xp(e.prototype,t),n&&Xp(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function qp(){return qp="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Qp(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},qp.apply(this,arguments)}function Qp(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=oy(e),null===e)break;return e}function Jp(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zp(e,t)}function Zp(e,t){return Zp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Zp(e,t)}function ey(e){var t=ry();return function(){var n,r=oy(e);if(t){var o=oy(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ty(this,n)}}function ty(e,t){if(t&&("object"===Yp(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ny(e)}function ny(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ry(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function oy(e){return oy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oy(e)}se(Hp,Ip);var iy=function(e){Jp(n,e);var t=ey(n);function n(){return Kp(this,n),t.call(this,(function(e){return e}))}return $p(n,[{key:"insert",value:function(e,t){var r=Gp(this.indexedValues,t);this.indexedValues=Wp(r,e,t),qp(oy(n.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=Up(this.indexedValues,e);this.indexedValues=zp(t,e),qp(oy(n.prototype),"remove",this).call(this,e)}}]),n}(Hp);function ay(e){return cy(e)||uy(e)||sy(e)||ly()}function ly(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function sy(e,t){if(e){if("string"===typeof e)return fy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fy(e,t):void 0}}function uy(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function cy(e){if(Array.isArray(e))return fy(e)}function fy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hy(e,t,n,r){var o=n.length?n[0]:void 0;return[].concat(ay(e.slice(0,o)),ay(n.map((function(e,t){return jn(r)?r(e,t):r}))),ay(void 0===o?[]:e.slice(o)))}function dy(e,t){return F(e,(function(e,n){return!1===t.includes(n)}))}function py(e){return py="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},py(e)}function yy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gy(e,t,n){return t&&vy(e.prototype,t),n&&vy(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function my(){return my="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=by(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},my.apply(this,arguments)}function by(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Ey(e),null===e)break;return e}function wy(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cy(e,t)}function Cy(e,t){return Cy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Cy(e,t)}function Sy(e){var t=Ry();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oy(this,n)}}function Oy(e,t){if(t&&("object"===py(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ky(e)}function ky(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ry(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ey(e){return Ey=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ey(e)}var Ty=function(e){wy(n,e);var t=Sy(n);function n(){return yy(this,n),t.apply(this,arguments)}return gy(n,[{key:"insert",value:function(e,t){this.indexedValues=hy(this.indexedValues,e,t,this.initValueOrFn),my(Ey(n.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=dy(this.indexedValues,e),my(Ey(n.prototype),"remove",this).call(this,e)}}]),n}(Hp);function Py(e){return Py="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Py(e)}function My(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ay(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Iy(e,t,n){return t&&Ay(e.prototype,t),n&&Ay(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function jy(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xy(e,t)}function xy(e,t){return xy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xy(e,t)}function _y(e){var t=Ny();return function(){var n,r=Ly(e);if(t){var o=Ly(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hy(this,n)}}function Hy(e,t){if(t&&("object"===Py(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Dy(e)}function Dy(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ny(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ly(e){return Ly=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ly(e)}var By=function(e){jy(n,e);var t=_y(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return My(this,n),t.call(this,e)}return Iy(n,[{key:"getHiddenIndexes",value:function(){return V(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}]),n}(Ty);function Vy(e){return Vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vy(e)}function Fy(e){return Gy(e)||zy(e)||Uy(e)||Wy()}function Wy(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Uy(e,t){if(e){if("string"===typeof e)return Yy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yy(e,t):void 0}}function zy(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Gy(e){if(Array.isArray(e))return Yy(e)}function Yy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ky(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $y(e,t,n){return t&&Xy(e.prototype,t),n&&Xy(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function qy(){return qy="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Qy(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},qy.apply(this,arguments)}function Qy(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=ov(e),null===e)break;return e}function Jy(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zy(e,t)}function Zy(e,t){return Zy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Zy(e,t)}function ev(e){var t=rv();return function(){var n,r=ov(e);if(t){var o=ov(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tv(this,n)}}function tv(e,t){if(t&&("object"===Vy(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return nv(e)}function nv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rv(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ov(e){return ov=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ov(e)}function iv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var av=function(e){Jy(n,e);var t=ev(n);function n(){var e;Ky(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),iv(nv(e),"orderOfIndexes",[]),e}return $y(n,[{key:"getValues",value:function(){var e=this;return this.orderOfIndexes.map((function(t){return e.indexedValues[t]}))}},{key:"setValues",value:function(e){this.orderOfIndexes=Fy(Array(e.length).keys()),qy(ov(n.prototype),"setValues",this).call(this,e)}},{key:"setValueAtIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0)}},{key:"clearValue",value:function(e){this.orderOfIndexes=Up(this.orderOfIndexes,[e]),jn(this.initValueOrFn)?qy(ov(n.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn(e)):qy(ov(n.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,qy(ov(n.prototype),"setDefaultValues",this).call(this,e)}},{key:"insert",value:function(e,t){this.indexedValues=hy(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=Gp(this.orderOfIndexes,t),qy(ov(n.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=dy(this.indexedValues,e),this.orderOfIndexes=Up(this.orderOfIndexes,e),this.orderOfIndexes=zp(this.orderOfIndexes,e),qy(ov(n.prototype),"remove",this).call(this,e)}},{key:"getEntries",value:function(){var e=this;return this.orderOfIndexes.map((function(t){return[t,e.getValueAtIndex(t)]}))}}]),n}(Hp);function lv(e){return lv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lv(e)}function sv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cv(e,t,n){return t&&uv(e.prototype,t),n&&uv(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function fv(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hv(e,t)}function hv(e,t){return hv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hv(e,t)}function dv(e){var t=vv();return function(){var n,r=gv(e);if(t){var o=gv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pv(this,n)}}function pv(e,t){if(t&&("object"===lv(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return yv(e)}function yv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vv(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function gv(e){return gv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gv(e)}var mv=function(e){fv(n,e);var t=dv(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return sv(this,n),t.call(this,e)}return cv(n,[{key:"getTrimmedIndexes",value:function(){return V(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}]),n}(Ty),bv=new Map([["hiding",By],["index",Hp],["linkedPhysicalIndexToValue",av],["physicalIndexToValue",Ty],["trimming",mv]]);function wv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!bv.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(bv.get(e))(t)}function Cv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ov(e,t,n){return t&&Sv(e.prototype,t),n&&Sv(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var kv=0,Rv=function(){function e(){Cv(this,e),this.collection=new Map}return Ov(e,[{key:"register",value:function(e,t){var n=this;!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(function(){return n.runLocalHooks("change",t)})),kv+=1)}},{key:"unregister",value:function(e){var t=this.collection.get(e);Qe(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),kv-=1)}},{key:"unregisterAll",value:function(){var e=this;this.collection.forEach((function(t,n){return e.unregister(n)})),this.collection.clear()}},{key:"get",value:function(e){return Je(e)?Array.from(this.collection.values()):this.collection.get(e)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(e){this.collection.forEach((function(t){t.remove(e)}))}},{key:"insertToEvery",value:function(e,t){this.collection.forEach((function(n){n.insert(e,t)}))}},{key:"initEvery",value:function(e){this.collection.forEach((function(t){t.init(e)}))}}]),e}();function Ev(){return kv}function Tv(e){return Tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tv(e)}function Pv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Av(e,t,n){return t&&Mv(e.prototype,t),n&&Mv(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Iv(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jv(e,t)}function jv(e,t){return jv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},jv(e,t)}function xv(e){var t=Dv();return function(){var n,r=Nv(e);if(t){var o=Nv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _v(this,n)}}function _v(e,t){if(t&&("object"===Tv(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Hv(e)}function Hv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dv(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Nv(e){return Nv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Nv(e)}se(Rv,Ip);var Lv=function(e){Iv(n,e);var t=xv(n);function n(e,r){var o;return Pv(this,n),o=t.call(this),o.mergedValuesCache=[],o.aggregationFunction=e,o.fallbackValue=r,o}return Av(n,[{key:"getMergedValues",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.mergedValuesCache;if(0===this.getLength())return[];for(var t=W(this.get(),(function(e){return e.getValues()})),n=[],r=Qe(t[0])&&t[0].length||0,o=0;o<r;o+=1){for(var i=[],a=0;a<this.getLength();a+=1)i.push(t[a][o]);n.push(i)}return W(n,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(e,t){var n=this.getMergedValues(t)[e];return Qe(n)?n:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),n}(Rv);function Bv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fv(e,t,n){return t&&Vv(e.prototype,t),n&&Vv(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wv(e,t,n){Uv(e,t),t.set(e,n)}function Uv(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zv(e,t,n){var r=Kv(e,t,"set");return Gv(e,r,n),n}function Gv(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function Yv(e,t){var n=Kv(e,t,"get");return Xv(e,n)}function Kv(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function Xv(e,t){return t.get?t.get.call(e):t.value}var $v=new WeakMap,qv=function(){function e(){Bv(this,e),Wv(this,$v,{writable:!0,value:[]})}return Fv(e,[{key:"subscribe",value:function(e){return this.addLocalHook("change",e),this._write(Yv(this,$v)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(e){return e.length>0&&this.runLocalHooks("change",e),this}},{key:"_writeInitialChanges",value:function(e){zv(this,$v,e)}}]),e}();function Qv(e,t){for(var n=[],r=0,o=0;r<e.length&&o<t.length;r++,o++)e[r]!==t[o]&&n.push({op:"replace",index:o,oldValue:e[r],newValue:t[o]});for(;r<t.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:t[r]});for(;o<e.length;o++)n.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return n}function Jv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eg(e,t,n){return t&&Zv(e.prototype,t),n&&Zv(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function tg(e,t,n){ng(e,t),t.set(e,n)}function ng(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rg(e,t){var n=ag(e,t,"get");return og(e,n)}function og(e,t){return t.get?t.get.call(e):t.value}function ig(e,t,n){var r=ag(e,t,"set");return lg(e,r,n),n}function ag(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function lg(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}se(qv,Ip);var sg,ug=new WeakMap,cg=new WeakMap,fg=new WeakMap,hg=new WeakMap,dg=new WeakMap,pg=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.initialIndexValue;Jv(this,e),tg(this,ug,{writable:!0,value:new Set}),tg(this,cg,{writable:!0,value:[]}),tg(this,fg,{writable:!0,value:[]}),tg(this,hg,{writable:!0,value:!1}),tg(this,dg,{writable:!0,value:!1}),ig(this,dg,null!==n&&void 0!==n&&n)}return eg(e,[{key:"createObserver",value:function(){var e=this,t=new qv;return rg(this,ug).add(t),t.addLocalHook("unsubscribe",(function(){rg(e,ug).delete(t)})),t._writeInitialChanges(Qv(rg(this,cg),rg(this,fg))),t}},{key:"emit",value:function(e){var t=rg(this,fg);rg(this,hg)&&rg(this,cg).length===e.length||(0===e.length?e=new Array(t.length).fill(rg(this,dg)):ig(this,cg,new Array(e.length).fill(rg(this,dg))),rg(this,hg)||(ig(this,hg,!0),t=rg(this,cg)));var n=Qv(t,e);rg(this,ug).forEach((function(e){return e._write(n)})),ig(this,fg,e)}}]),e}();function yg(e){return bg(e)||mg(e)||gg(e)||vg()}function vg(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function gg(e,t){if(e){if("string"===typeof e)return wg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wg(e,t):void 0}}function mg(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function bg(e){if(Array.isArray(e))return wg(e)}function wg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cg(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Sg(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Og(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kg(e,t,n){return t&&Og(e.prototype,t),n&&Og(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Rg,Eg=new Set(["getFirstNotHiddenIndex"]),Tg=function(){function e(){var t=this;Sg(this,e),this.indexesSequence=new iy,this.trimmingMapsCollection=new Lv((function(e){return e.some((function(e){return!0===e}))}),!1),this.hidingMapsCollection=new Lv((function(e){return e.some((function(e){return!0===e}))}),!1),this.variousMapsCollection=new Rv,this.hidingChangesObservable=new pg({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(function(e){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(function(e){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(function(e){t.runLocalHooks("change",e,t.variousMapsCollection)}))}return kg(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(e){if("hiding"!==e)throw new Error('Unsupported index map type "'.concat(e,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(e,t,n){return this.registerMap(e,wv(t,n))}},{key:"registerMap",value:function(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error('Map with name "'.concat(e,'" has been already registered.'));t instanceof mv?this.trimmingMapsCollection.register(e,t):t instanceof By?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);var n=this.getNumberOfIndexes();return n>0&&t.init(n),t}},{key:"unregisterMap",value:function(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(e){var t=this.notTrimmedIndexesCache[e];return Qe(t)?t:null}},{key:"getPhysicalFromRenderableIndex",value:function(e){var t=this.renderablePhysicalIndexesCache[e];return Qe(t)?t:null}},{key:"getVisualFromPhysicalIndex",value:function(e){var t=this.fromPhysicalToVisualIndexesCache.get(e);return Qe(t)?t:null}},{key:"getVisualFromRenderableIndex",value:function(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}},{key:"getRenderableFromVisualIndex",value:function(e){var t=this.fromVisualToRenderableIndexesCache.get(e);return Qe(t)?t:null}},{key:"getFirstNotHiddenIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e-t;Eg.has("getFirstNotHiddenIndex")&&(Eg.delete("getFirstNotHiddenIndex"),Fn(Ke(sg||(sg=Cg(['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next \n                        major release. Please use "getNearestNotHiddenIndex" instead.'],['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20\n                        major release. Please use "getNearestNotHiddenIndex" instead.'])))));var o=this.getPhysicalFromVisualIndex(e);return null===o?!0===n&&r!==e-t?this.getFirstNotHiddenIndex(r,-t,!1,r):null:!1===this.isHidden(o)?e:this.getFirstNotHiddenIndex(e+t,t,n,r)}},{key:"getNearestNotHiddenIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getPhysicalFromVisualIndex(e);if(null===r)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;var o=Array.from(this.fromVisualToRenderableIndexesCache.keys()),i=-1;return i=t>0?o.findIndex((function(t){return t>e})):o.reverse().findIndex((function(t){return t<e})),-1===i?n?this.getNearestNotHiddenIndex(e,-t,!1):null:o[i]}},{key:"initToLength",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=yg(new Array(e).keys()),this.notHiddenIndexesCache=yg(new Array(e).keys()),this.suspendOperations(),this.indexesSequence.init(e),this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(e){var t=this.getNumberOfIndexes();if(e<t){var n=yg(Array(this.getNumberOfIndexes()-e).keys()).map((function(t){return t+e}));this.removeIndexes(n)}else this.insertIndexes(t,e-t)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(e){this.indexesSequence.setValues(e)}},{key:"getNotTrimmedIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;var n=this.getIndexesSequence();return n.filter((function(t){return!1===e.isTrimmed(t)}))}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notHiddenIndexesCache;var n=this.getIndexesSequence();return n.filter((function(t){return!1===e.isHidden(t)}))}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;var n=this.getNotTrimmedIndexes();return n.filter((function(t){return!1===e.isHidden(t)}))}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(e,t){var n=this;"number"===typeof e&&(e=[e]);var r=W(e,(function(e){return n.getPhysicalFromVisualIndex(e)})),o=this.getNotTrimmedIndexesLength(),i=e.length,a=Up(this.getIndexesSequence(),r),l=o-i;if(t+i<o){var s=a.filter((function(e){return!1===n.isTrimmed(e)}))[t];l=a.indexOf(s)}this.setIndexesSequence(Wp(a,l,r))}},{key:"isTrimmed",value:function(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}},{key:"isHidden",value:function(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}},{key:"insertIndexes",value:function(e,t){var n=this.getNotTrimmedIndexes()[e],r=Qe(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),i=W(new Array(t).fill(r),(function(e,t){return e+t}));this.suspendOperations(),this.indexesSequence.insert(o,i),this.trimmingMapsCollection.insertToEvery(o,i),this.hidingMapsCollection.insertToEvery(o,i),this.variousMapsCollection.insertToEvery(o,i),this.resumeOperations()}},{key:"removeIndexes",value:function(e){this.suspendOperations(),this.indexesSequence.remove(e),this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}},{key:"updateCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(n,t)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromRenderableIndex(t),r=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(r,t)}}}]),e}();function Pg(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Mg(e,t){return he(t,(function(t,n){Je(e[n])&&(e[n]=t)})),e}function Ag(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,n=t.exec(e);return n?"".concat(n[1].toLowerCase(),"-").concat(n[2].toUpperCase()):e}function Ig(e){Qe(e)&&Wn(Ke(Rg||(Rg=Pg(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language\\x20\n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'])),e))}function jg(e,t){var n=Array.isArray(e)&&Number.isInteger(t);return n?e[t]:e}se(Tg,Ip);var xg=wr("phraseFormatters"),_g=xg.register,Hg=xg.getValues;function Dg(e,t){_g(e,t)}function Ng(){return Hg()}Dg("pluralize",jg);var Lg,Bg="ContextMenu:items",Vg=Bg,Fg="".concat(Vg,".noItems"),Wg="".concat(Vg,".insertRowAbove"),Ug="".concat(Vg,".insertRowBelow"),zg="".concat(Vg,".insertColumnOnTheLeft"),Gg="".concat(Vg,".insertColumnOnTheRight"),Yg="".concat(Vg,".removeRow"),Kg="".concat(Vg,".removeColumn"),Xg="".concat(Vg,".undo"),$g="".concat(Vg,".redo"),qg="".concat(Vg,".readOnly"),Qg="".concat(Vg,".clearColumn"),Jg="".concat(Vg,".copy"),Zg="".concat(Vg,".copyWithHeaders"),em="".concat(Vg,".copyWithGroupHeaders"),tm="".concat(Vg,".copyHeadersOnly"),nm="".concat(Vg,".cut"),rm="".concat(Vg,".freezeColumn"),om="".concat(Vg,".unfreezeColumn"),im="".concat(Vg,".mergeCells"),am="".concat(Vg,".unmergeCells"),lm="".concat(Vg,".addComment"),sm="".concat(Vg,".editComment"),um="".concat(Vg,".removeComment"),cm="".concat(Vg,".readOnlyComment"),fm="".concat(Vg,".align"),hm="".concat(Vg,".align.left"),dm="".concat(Vg,".align.center"),pm="".concat(Vg,".align.right"),ym="".concat(Vg,".align.justify"),vm="".concat(Vg,".align.top"),gm="".concat(Vg,".align.middle"),mm="".concat(Vg,".align.bottom"),bm="".concat(Vg,".borders"),wm="".concat(Vg,".borders.top"),Cm="".concat(Vg,".borders.right"),Sm="".concat(Vg,".borders.bottom"),Om="".concat(Vg,".borders.left"),km="".concat(Vg,".borders.remove"),Rm="".concat(Vg,".nestedHeaders.insertChildRow"),Em="".concat(Vg,".nestedHeaders.detachFromParent"),Tm="".concat(Vg,".hideColumn"),Pm="".concat(Vg,".showColumn"),Mm="".concat(Vg,".hideRow"),Am="".concat(Vg,".showRow"),Im="Filters:",jm="".concat(Im,"conditions"),xm="".concat(jm,".none"),_m="".concat(jm,".isEmpty"),Hm="".concat(jm,".isNotEmpty"),Dm="".concat(jm,".isEqualTo"),Nm="".concat(jm,".isNotEqualTo"),Lm="".concat(jm,".beginsWith"),Bm="".concat(jm,".endsWith"),Vm="".concat(jm,".contains"),Fm="".concat(jm,".doesNotContain"),Wm="".concat(jm,".byValue"),Um="".concat(jm,".greaterThan"),zm="".concat(jm,".greaterThanOrEqualTo"),Gm="".concat(jm,".lessThan"),Ym="".concat(jm,".lessThanOrEqualTo"),Km="".concat(jm,".isBetween"),Xm="".concat(jm,".isNotBetween"),$m="".concat(jm,".after"),qm="".concat(jm,".before"),Qm="".concat(jm,".today"),Jm="".concat(jm,".tomorrow"),Zm="".concat(jm,".yesterday"),eb="".concat(Im,"labels.filterByCondition"),tb="".concat(Im,"labels.filterByValue"),nb="".concat(Im,"labels.conjunction"),rb="".concat(Im,"labels.disjunction"),ob="".concat(Im,"values.blankCells"),ib="".concat(Im,"buttons.selectAll"),ab="".concat(Im,"buttons.clear"),lb="".concat(Im,"buttons.ok"),sb="".concat(Im,"buttons.cancel"),ub="".concat(Im,"buttons.placeholder.search"),cb="".concat(Im,"buttons.placeholder.value"),fb="".concat(Im,"buttons.placeholder.secondValue");function hb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */var db=(Lg={languageCode:"en-US"},hb(Lg,Fg,"No available options"),hb(Lg,Wg,"Insert row above"),hb(Lg,Ug,"Insert row below"),hb(Lg,zg,"Insert column left"),hb(Lg,Gg,"Insert column right"),hb(Lg,Yg,["Remove row","Remove rows"]),hb(Lg,Kg,["Remove column","Remove columns"]),hb(Lg,Xg,"Undo"),hb(Lg,$g,"Redo"),hb(Lg,qg,"Read only"),hb(Lg,Qg,"Clear column"),hb(Lg,fm,"Alignment"),hb(Lg,hm,"Left"),hb(Lg,dm,"Center"),hb(Lg,pm,"Right"),hb(Lg,ym,"Justify"),hb(Lg,vm,"Top"),hb(Lg,gm,"Middle"),hb(Lg,mm,"Bottom"),hb(Lg,rm,"Freeze column"),hb(Lg,om,"Unfreeze column"),hb(Lg,bm,"Borders"),hb(Lg,wm,"Top"),hb(Lg,Cm,"Right"),hb(Lg,Sm,"Bottom"),hb(Lg,Om,"Left"),hb(Lg,km,"Remove border(s)"),hb(Lg,lm,"Add comment"),hb(Lg,sm,"Edit comment"),hb(Lg,um,"Delete comment"),hb(Lg,cm,"Read-only comment"),hb(Lg,im,"Merge cells"),hb(Lg,am,"Unmerge cells"),hb(Lg,Jg,"Copy"),hb(Lg,Zg,["Copy with header","Copy with headers"]),hb(Lg,em,["Copy with group header","Copy with group headers"]),hb(Lg,tm,["Copy header only","Copy headers only"]),hb(Lg,nm,"Cut"),hb(Lg,Rm,"Insert child row"),hb(Lg,Em,"Detach from parent"),hb(Lg,Tm,["Hide column","Hide columns"]),hb(Lg,Pm,["Show column","Show columns"]),hb(Lg,Mm,["Hide row","Hide rows"]),hb(Lg,Am,["Show row","Show rows"]),hb(Lg,xm,"None"),hb(Lg,_m,"Is empty"),hb(Lg,Hm,"Is not empty"),hb(Lg,Dm,"Is equal to"),hb(Lg,Nm,"Is not equal to"),hb(Lg,Lm,"Begins with"),hb(Lg,Bm,"Ends with"),hb(Lg,Vm,"Contains"),hb(Lg,Fm,"Does not contain"),hb(Lg,Um,"Greater than"),hb(Lg,zm,"Greater than or equal to"),hb(Lg,Gm,"Less than"),hb(Lg,Ym,"Less than or equal to"),hb(Lg,Km,"Is between"),hb(Lg,Xm,"Is not between"),hb(Lg,$m,"After"),hb(Lg,qm,"Before"),hb(Lg,Qm,"Today"),hb(Lg,Jm,"Tomorrow"),hb(Lg,Zm,"Yesterday"),hb(Lg,ob,"Blank cells"),hb(Lg,eb,"Filter by condition"),hb(Lg,tb,"Filter by value"),hb(Lg,nb,"And"),hb(Lg,rb,"Or"),hb(Lg,ib,"Select all"),hb(Lg,ab,"Clear"),hb(Lg,lb,"OK"),hb(Lg,sb,"Cancel"),hb(Lg,ub,"Search"),hb(Lg,cb,"Value"),hb(Lg,fb,"Second value"),Lg),pb=db,yb=pb.languageCode,vb=wr("languagesDictionaries"),gb=vb.register,mb=vb.getItem,bb=vb.hasItem,wb=vb.getValues;function Cb(e,t){var n=e,r=t;return ce(e)&&(r=e,n=r.languageCode),Sb(n,r),gb(n,ae(r)),ae(r)}function Sb(e,t){e!==yb&&Mg(t,mb(yb))}function Ob(e){return kb(e)?ae(mb(e)):null}function kb(e){return bb(e)}function Rb(){return wb()}function Eb(e,t,n){var r=Ob(e);if(null===r)return null;var o=r[t];if(Je(o))return null;var i=Tb(o,n);return Array.isArray(i)?i[0]:i}function Tb(e,t){var n=e;return U(Ng(),(function(r){n=r(e,t)})),n}function Pb(e){var t=Ag(e);return kb(t)||(t=yb,Ig(e)),t}Cb(pb);n("7dc0");var Mb="active-header",Ab="area",Ib="cell",jb="fill",xb="header",_b="custom-selection";n("93ae");function Hb(e,t){return Vb(e)||Bb(e,t)||Nb(e,t)||Db()}function Db(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Nb(e,t){if(e){if("string"===typeof e)return Lb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lb(e,t):void 0}}function Lb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bb(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Vb(e){if(Array.isArray(e))return e}function Fb(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ub(e,t,n){return t&&Wb(e.prototype,t),n&&Wb(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var zb=function(){function e(t,n){Fb(this,e),n&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}return Ub(e,[{key:"registerListeners",value:function(){var e=this,t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(function(){return e.onMouseDown()})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}));for(var n=function(t,n){var r=e.main.childNodes[t];e.eventManager.addEventListener(r,"mouseenter",(function(n){return e.onMouseEnter(n,e.main.childNodes[t])}))},r=0,o=this.main.childNodes.length;r<o;r++)n(r,o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,t){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),Qn(e);var n=this,r=this.wot.rootDocument.body,o=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(r,"mousemove",a)}function i(e){return e.clientY<Math.floor(o.top)||(e.clientY>Math.ceil(o.top+o.height)||(e.clientX<Math.floor(o.left)||(e.clientX>Math.ceil(o.left+o.width)||void 0)))}function a(e){i(e)&&(n.eventManager.removeEventListener(r,"mousemove",a),t.style.display="block")}}},{key:"createBorders",value:function(e){var t=this.wot.rootDocument;this.main=t.createElement("div");var n=["top","start","bottom","end","corner"],r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(var o=0;o<5;o++){var i=n[o],a=t.createElement("div");a.className="wtBorder ".concat(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(a.className+=" hidden"),r=a.style,r.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:e.border.color,r.height=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(e.border.width,"px"),r.width=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(e.border.width,"px"),this.main.appendChild(a)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),xe()&&this.createMultipleSelectorHandles(),this.disappear();var l=this.wot.wtTable,s=l.bordersHolder;s||(s=t.createElement("div"),s.className="htBorders",l.bordersHolder=s,l.spreader.appendChild(s)),s.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var e=this,t=this.wot.rootDocument;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")};var n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var o={position:"absolute",height:"".concat(r,"px"),width:"".concat(r,"px"),"border-radius":"".concat(parseInt(r/1.5,10),"px")};he(o,(function(t,n){e.selectionHandles.styles.bottomHitArea[n]=t,e.selectionHandles.styles.topHitArea[n]=t}));var i={position:"absolute",height:"".concat(n,"px"),width:"".concat(n,"px"),"border-radius":"".concat(parseInt(n/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};he(i,(function(t,n){e.selectionHandles.styles.bottom[n]=t,e.selectionHandles.styles.top[n]=t})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(e,t){var n=this.wot.selections.createOrGetArea();return!(!n.cellRange||e===n.cellRange.to.row&&t===n.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,t,n,r,o,i){var a=this.wot.wtSettings.getSetting("rtlMode"),l=a?"right":"left",s=this.selectionHandles.styles,u=s.top,c=s.topHitArea,f=s.bottom,h=s.bottomHitArea,d=parseInt(u.borderWidth,10),p=parseInt(u.width,10),y=parseInt(c.width,10),v=this.wot.wtTable.getWidth(),g=this.wot.wtTable.getHeight();u.top="".concat(parseInt(n-p-1,10),"px"),u[l]="".concat(parseInt(r-p-1,10),"px"),c.top="".concat(parseInt(n-y/4*3,10),"px"),c[l]="".concat(parseInt(r-y/4*3,10),"px");var m=Math.min(parseInt(r+o,10),v-p-2*d),b=Math.min(parseInt(r+o-y/4,10),v-y-2*d);f[l]="".concat(m,"px"),h[l]="".concat(b,"px");var w=Math.min(parseInt(n+i,10),g-p-2*d),C=Math.min(parseInt(n+i-y/4,10),g-y-2*d);f.top="".concat(w,"px"),h.top="".concat(C,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,t)?(f.display="none",h.display="none"):(f.display="block",h.display="block")):(u.display="none",f.display="none",c.display="none",h.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){for(var t,n,r,o,i,a,l=this.wot,s=l.wtTable,u=l.rootDocument,c=l.rootWindow,f=s.getRenderedRowsCount(),h=0;h<f;h+=1){var d=s.rowFilter.renderedToSource(h);if(d>=e[0]&&d<=e[2]){t=d,i=e[0];break}}for(var p=f-1;p>=0;p-=1){var y=s.rowFilter.renderedToSource(p);if(y>=e[0]&&y<=e[2]){n=y;break}}for(var v=s.getRenderedColumnsCount(),g=0;g<v;g+=1){var m=s.columnFilter.renderedToSource(g);if(m>=e[1]&&m<=e[3]){r=m,a=e[1];break}}for(var b=v-1;b>=0;b-=1){var w=s.columnFilter.renderedToSource(b);if(w>=e[1]&&w<=e[3]){o=w;break}}if(void 0!==t&&void 0!==r){var C=s.getCell(this.wot.createCellCoords(t,r)),S=t!==n||r!==o,O=S?s.getCell(this.wot.createCellCoords(n,o)):C,k=Jt(C),R=S?Jt(O):k,E=Jt(s.TABLE),T=un(s.TABLE),P=k.top,M=k.left,A=this.wot.wtSettings.getSetting("rtlMode"),I=0,j=0;if(A){var x=un(C),_=c.innerWidth-E.left-T;j=M+x-R.left,I=c.innerWidth-M-x-_-1}else j=R.left+un(O)-M,I=M-E.left-1;if(this.isEntireColumnSelected(t,n)){var H=this.getDimensionsFromHeader("columns",r,o,i,E),D=null;if(H){var N=Hb(H,3);D=N[0],I=N[1],j=N[2]}D&&(C=D)}var L=P-E.top-1,B=R.top+cn(O)-P;if(this.isEntireRowSelected(r,o)){var V=this.getDimensionsFromHeader("rows",t,n,a,E),F=null;if(V){var W=Hb(V,3);F=W[0],L=W[1],B=W[2]}F&&(C=F)}var U=sn(C,c);parseInt(U.borderTopWidth,10)>0&&(L+=1,B=B>0?B-1:0),parseInt(U[A?"borderRightWidth":"borderLeftWidth"],10)>0&&(I+=1,j=j>0?j-1:0);var z=A?"right":"left";this.topStyle.top="".concat(L,"px"),this.topStyle[z]="".concat(I,"px"),this.topStyle.width="".concat(j,"px"),this.topStyle.display="block",this.startStyle.top="".concat(L,"px"),this.startStyle[z]="".concat(I,"px"),this.startStyle.height="".concat(B,"px"),this.startStyle.display="block";var G=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(L+B-G,"px"),this.bottomStyle[z]="".concat(I,"px"),this.bottomStyle.width="".concat(j,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(L,"px"),this.endStyle[z]="".concat(I+j-G,"px"),this.endStyle.height="".concat(B+1,"px"),this.endStyle.display="block";var Y=this.settings.border.cornerVisible;Y="function"===typeof Y?Y(this.settings.layerLevel):Y;var K=this.wot.getSetting("onModifyGetCellCoords",n,o),X=n,$=o;if(K&&Array.isArray(K)){var q=Hb(K,4);X=q[2],$=q[3]}if(xe()||!Y||this.isPartRange(X,$))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(L+B+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[z]="".concat(I+j+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Q=on(s.TABLE),J=Q===c;J&&(Q=u.documentElement);var Z=parseInt(this.cornerDefaultStyle.width,10)/2,ee=parseInt(this.cornerDefaultStyle.height,10)/2;if(o===this.wot.getSetting("totalColumns")-1){var te=J?O.getBoundingClientRect().left:O.offsetLeft,ne=!1,re=0;A?(re=te-parseInt(this.cornerDefaultStyle.width,10)/2,ne=re<0):(re=te+un(O)+parseInt(this.cornerDefaultStyle.width,10)/2,ne=re>=hn(Q)),ne&&(this.cornerStyle[z]="".concat(Math.floor(I+j+this.cornerCenterPointOffset-Z),"px"),this.cornerStyle[A?"borderLeftWidth":"borderRightWidth"]=0)}if(n===this.wot.getSetting("totalRows")-1){var oe=J?O.getBoundingClientRect().top:O.offsetTop,ie=oe+cn(O)+parseInt(this.cornerDefaultStyle.height,10)/2,ae=ie>=fn(Q);ae&&(this.cornerStyle.top="".concat(Math.floor(L+B+this.cornerCenterPointOffset-ee),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}xe()&&this.updateMultipleSelectionHandlesPosition(n,o,L,I,j,B)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(e,t,n,r,o){var i=this.wot.wtTable,a=i.wtRootElement.parentNode,l=null,s=null,u=null,c=null,f=null,h=null,d=null,p=null;switch(e){case"rows":l=function(){return i.getRowHeader.apply(i,arguments)},s=function(){return cn.apply(void 0,arguments)},u="ht__selection--rows",h="top";break;case"columns":l=function(){return i.getColumnHeader.apply(i,arguments)},s=function(){return un.apply(void 0,arguments)},u="ht__selection--columns",h="left";break;default:}if(a.classList.contains(u)){var y=this.wot.getSetting("columnHeaders").length;if(d=l(t,y-r),p=l(n,y-r),!d||!p)return!1;var v=Jt(d),g=Jt(p);return d&&p&&(c=v[h]-o[h]-1,f=g[h]+s(p)-v[h]),[d,c,f]}return!1}},{key:"changeBorderStyle",value:function(e,t){var n=this[e].style,r=t[e];!r||r.hide?Ut(this[e],"hidden"):(Wt(this[e],"hidden")&&zt(this[e],"hidden"),n.backgroundColor=r.color,"top"!==e&&"bottom"!==e||(n.height="".concat(r.width,"px")),"start"!==e&&"end"!==e||(n.width="".concat(r.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(e){var t={width:1,color:"#000"},n=this[e].style;n.backgroundColor=t.color,n.width="".concat(t.width,"px"),n.height="".concat(t.width,"px")}},{key:"toggleHiddenClass",value:function(e,t){this.changeBorderToDefaultStyle(e),t?Ut(this[e],"hidden"):zt(this[e],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",xe()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}(),Gb=zb;function Yb(e,t){return Qb(e)||qb(e,t)||Xb(e,t)||Kb()}function Kb(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Xb(e,t){if(e){if("string"===typeof e)return $b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$b(e,t):void 0}}function $b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qb(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Qb(e){if(Array.isArray(e))return e}function Jb(e){return Jb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jb(e)}function Zb(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ew(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tw(e,t,n){return t&&ew(e.prototype,t),n&&ew(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var nw=function(){function e(t,n){Zb(this,e),this.settings=t,this.cellRange=n||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return tw(e,[{key:"getBorder",value:function(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new Gb(e,this.settings)),this.instanceBorders[e.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}},{key:"replace",value:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}},{key:"addClassAtCoords",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=e.wtTable.getCell(this.settings.createCellCoords(t,n));if("object"===Jb(i)){var a=r;o&&(a=this.classNameGenerator(i),this.classNames.includes(a)||this.classNames.push(a)),Ut(i,a)}return this}},{key:"linearClassNameGenerator",value:function(e,t){return function n(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===t||0===o)return e;var i=o>=0?o:t,a=e;i-=1;var l=0===i?e:"".concat(e,"-").concat(i);if(Wt(r,l)){var s=i+1;a="".concat(e,"-").concat(s)}else a=n(r,i);return a}}},{key:"draw",value:function(e){if(this.isEmpty())this.settings.border&&this.getBorder(e).disappear();else{var t=e.wtTable.getRenderedRowsCount(),n=e.wtTable.getRenderedColumnsCount(),r=this.getCorners(),o=Yb(r,4),i=o[0],a=o[1],l=o[2],s=o[3],u=this.settings,c=u.highlightHeaderClassName,f=u.highlightColumnClassName,h=u.highlightRowClassName,d=u.highlightOnlyClosestHeader,p=u.selectionType,y=void 0===p||["active-header","header"].includes(p);if(y&&null!==a&&null!==s)for(var v=0,g=0;g<n;g+=1){var m=e.wtTable.columnFilter.renderedToSource(g);if(m>=a&&m<=s){var b=e.wtTable.getColumnHeaders(m),w=b.length-1;d&&b.length>1&&(b=[b[w]]);for(var C=0;C<b.length;C+=1){var S=[],O=b[C];c&&S.push(c),f&&S.push(f),C=d?w:C;var k=e.getSetting("onBeforeHighlightingColumnHeader",m,C,{selectionType:p,columnCursor:v,selectionWidth:s-a+1,classNames:S});k!==m&&(O=e.wtTable.getColumnHeader(k,C)),Ut(O,S)}v+=1}}if(null!==i&&null!==l)for(var R=0,E=0;E<t;E+=1){var T=e.wtTable.rowFilter.renderedToSource(E);if(y&&T>=i&&T<=l){var P=e.wtTable.getRowHeaders(T),M=P.length-1;d&&P.length>1&&(P=[P[M]]);for(var A=0;A<P.length;A+=1){var I=[],j=P[A];c&&I.push(c),h&&I.push(h),A=d?M:A;var x=e.getSetting("onBeforeHighlightingRowHeader",T,A,{selectionType:p,rowCursor:R,selectionHeight:l-i+1,classNames:I});x!==T&&(j=e.wtTable.getRowHeader(x,A)),Ut(j,I)}R+=1}if(null!==a&&null!==s)for(var _=0;_<n;_+=1){var H=e.wtTable.columnFilter.renderedToSource(_);T>=i&&T<=l&&H>=a&&H<=s?this.settings.className&&this.addClassAtCoords(e,T,H,this.settings.className,this.settings.markIntersections):T>=i&&T<=l?h&&this.addClassAtCoords(e,T,H,h):H>=a&&H<=s&&f&&this.addClassAtCoords(e,T,H,f);var D=e.getSetting("onAfterDrawSelection",T,H,this.settings.layerLevel);"string"===typeof D&&this.addClassAtCoords(e,T,H,D)}}e.getSetting("onBeforeDrawBorders",r,this.settings.className),this.settings.border&&this.getBorder(e).appear(r)}}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach((function(e){return e.destroy()}))}}]),e}(),rw=nw;function ow(e){return ow="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ow(e)}function iw(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aw(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lw(e,t,n){return t&&aw(e.prototype,t),n&&aw(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function sw(){return sw="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=uw(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},sw.apply(this,arguments)}function uw(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=vw(e),null===e)break;return e}function cw(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fw(e,t)}function fw(e,t){return fw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fw(e,t)}function hw(e){var t=yw();return function(){var n,r=vw(e);if(t){var o=vw(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dw(this,n)}}function dw(e,t){if(t&&("object"===ow(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return pw(e)}function pw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yw(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function vw(e){return vw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vw(e)}function gw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mw=function(e){cw(n,e);var t=hw(n);function n(e,r){var o;return iw(this,n),o=t.call(this,e,null),gw(pw(o),"visualCellRange",null),o.visualCellRange=r||null,o.commit(),o}return lw(n,[{key:"add",value:function(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}},{key:"clear",value:function(){return this.visualCellRange=null,sw(vw(n.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(e){var t=e.from,n=e.to,r=this.getNearestNotHiddenCoords(t,1),o=this.getNearestNotHiddenCoords(n,-1);if(null===r||null===o)return null;if(r.row>o.row||r.col>o.col){var i="header"===this.settings.type||"active-header"===this.settings.type;if(!i)return null;r=t,o=n}return this.settings.createCellRange(r,r,o)}},{key:"getNearestNotHiddenCoords",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),e.row,t);if(null===r)return null;var o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),e.col,n);return null===o?null:this.settings.createCellCoords(r,o)}},{key:"getNearestNotHiddenIndex",value:function(e,t,n){if(t<0)return t;var r=e.getNearestNotHiddenIndex(t,n),o="header"===this.settings.type||"active-header"===this.settings.type;return o&&null===r?-1:r}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to),this}},{key:"syncWith",value:function(e){var t="N-S"===e.getVerticalDirection()?1:-1,n="W-E"===e.getHorizontalDirection()?1:-1,r=this.getNearestNotHiddenCoords(e.from.clone().normalize(),t,n);if(null!==r&&e.overlaps(r)){if(null===this.cellRange){var o=this.settings.visualToRenderableCoords(r);this.cellRange=this.settings.createCellRange(o)}return e.setHighlight(r),this}return e.setHighlight(e.from),this}},{key:"getCorners",value:function(){var e=this.cellRange,t=e.from,n=e.to,r=null===t.row||null===n.row,o=null===t.col||null===n.col,i=this.settings.createCellCoords(r?null:Math.min(t.row,n.row),o?null:Math.min(t.col,n.col)),a=this.settings.createCellCoords(r?null:Math.max(t.row,n.row),o?null:Math.max(t.col,n.col));return[i.row,i.col,a.row,a.col]}},{key:"getVisualCorners",value:function(){var e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}},{key:"createRenderableCellRange",value:function(e,t){var n=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(t);return this.settings.createCellRange(n,n,r)}}]),n}(rw),bw=mw,ww=["activeHeaderClassName"];function Cw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cw(Object(n),!0).forEach((function(t){Ow(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ow(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kw(e,t){if(null==e)return{};var n,r,o=Rw(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Rw(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function Ew(e){var t=e.activeHeaderClassName,n=kw(e,ww),r=new bw(Sw(Sw({highlightHeaderClassName:t},n),{},{selectionType:Mb}));return r}var Tw=Ew,Pw=["layerLevel","areaCornerVisible"];function Mw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Aw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mw(Object(n),!0).forEach((function(t){Iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Iw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jw(e,t){if(null==e)return{};var n,r,o=xw(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function xw(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function _w(e){var t=e.layerLevel,n=e.areaCornerVisible,r=jw(e,Pw),o=new bw(Aw(Aw({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:n}},r),{},{selectionType:Ab}));return o}var Hw=_w,Dw=["cellCornerVisible"];function Nw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nw(Object(n),!0).forEach((function(t){Bw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vw(e,t){if(null==e)return{};var n,r,o=Fw(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Fw(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function Ww(e){var t=e.cellCornerVisible,n=Vw(e,Dw),r=new bw(Lw(Lw({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},n),{},{selectionType:Ib}));return r}var Uw=Ww,zw=["border","visualCellRange"];function Gw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gw(Object(n),!0).forEach((function(t){Kw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xw(e,t){if(null==e)return{};var n,r,o=$w(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function $w(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function qw(e){var t=e.border,n=e.visualCellRange,r=Xw(e,zw),o=new bw(Yw(Yw(Yw({},t),r),{},{selectionType:_b}),n);return o}var Qw=qw;n("f74c");function Jw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jw(Object(n),!0).forEach((function(t){eC(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function eC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tC(e){if(null==e)throw new TypeError("Cannot destructure "+e)}function nC(e){var t=Object.assign({},(tC(e),e)),n=new bw(Zw(Zw({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:jb}));return n}var rC=nC,oC=["headerClassName","rowClassName","columnClassName"];function iC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function aC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iC(Object(n),!0).forEach((function(t){lC(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sC(e,t){if(null==e)return{};var n,r,o=uC(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function uC(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function cC(e){var t=e.headerClassName,n=e.rowClassName,r=e.columnClassName,o=sC(e,oC),i=new bw(aC(aC({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:n,highlightColumnClassName:r},o),{},{highlightOnlyClosestHeader:!0,selectionType:xb}));return i}var fC=cC;function hC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hC(Object(n),!0).forEach((function(t){pC(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yC=wr("highlight/types"),vC=yC.register,gC=yC.getItem;function mC(e,t){return gC(e)(dC({type:e},t))}function bC(e){return OC(e)||SC(e)||CC(e)||wC()}function wC(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function CC(e,t){if(e){if("string"===typeof e)return kC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kC(e,t):void 0}}function SC(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function OC(e){if(Array.isArray(e))return kC(e)}function kC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function RC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function EC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?RC(Object(n),!0).forEach((function(t){TC(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function TC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function AC(e,t,n){return t&&MC(e.prototype,t),n&&MC(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}vC(Mb,Tw),vC(Ab,Hw),vC(Ib,Uw),vC(_b,Qw),vC(jb,rC),vC(xb,fC);var IC=function(e){function t(e){PC(this,t),this.options=e,this.layerLevel=0,this.cell=mC(Ib,e),this.fill=mC(jb,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return AC(t,[{key:"isEnabledFor",value:function(e,t){var n=e;e===Ib&&(n="current");var r=this.options.disabledCellSelection(t.row,t.col);return"string"===typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}},{key:"useLayerLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var e,t=this.layerLevel;return this.areas.has(t)?e=this.areas.get(t):(e=mC(Ab,EC({layerLevel:t},this.options)),this.areas.set(t,e)),e}},{key:"getAreas",value:function(){return bC(this.areas.values())}},{key:"createOrGetHeader",value:function(){var e,t=this.layerLevel;return this.headers.has(t)?e=this.headers.get(t):(e=mC(xb,EC({},this.options)),this.headers.set(t,e)),e}},{key:"getHeaders",value:function(){return bC(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var e,t=this.layerLevel;return this.activeHeaders.has(t)?e=this.activeHeaders.get(t):(e=mC(Mb,EC({},this.options)),this.activeHeaders.set(t,e)),e}},{key:"getActiveHeaders",value:function(){return bC(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return bC(this.customSelections.values())}},{key:"addCustomSelection",value:function(e){this.customSelections.push(mC(_b,EC(EC({},this.options),e)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),U(this.areas.values(),(function(e){e.clear()})),U(this.headers.values(),(function(e){e.clear()})),U(this.activeHeaders.values(),(function(e){e.clear()}))}},{key:e,value:function(){return[this.cell,this.fill].concat(bC(this.areas.values()),bC(this.headers.values()),bC(this.activeHeaders.values()),bC(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator),jC=IC;function xC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HC(e,t,n){return t&&_C(e.prototype,t),n&&_C(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var DC=function(e){function t(e){xC(this,t),this.ranges=[],this.createCellRange=e}return HC(t,[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}},{key:"add",value:function(e){return this.ranges.push(this.createCellRange(e)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(e){return this.ranges.some((function(t){return t.includes(e)}))}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+t-1;return n>=0&&(e=this.ranges[n]),e}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator),NC=DC;function LC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VC(e,t,n){return t&&BC(e.prototype,t),n&&BC(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var FC=function(){function e(t,n){LC(this,e),this.range=t,this.options=n}return VC(e,[{key:"transformStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.options.createCellCoords(e,t),o=this.range.current().highlight,i=this.options.visualToRenderableCoords(o),a=i.row,l=i.col,s=o,u=0,c=0;if(this.runLocalHooks("beforeTransformStart",r),null!==a&&null!==l){var f=this.options.countRows(),h=this.options.countCols(),d=this.options.fixedRowsBottom(),p=this.options.minSpareRows(),y=this.options.minSpareCols(),v=this.options.autoWrapRow(),g=this.options.autoWrapCol();a+e>f-1?n&&p>0&&!(d&&a>=f-d-1)?(this.runLocalHooks("insertRowRequire",f),f=this.options.countRows()):g&&(r.row=1-f,r.col=l+r.col===h-1?1-h:1):g&&a+r.row<0&&l+r.col>=0&&(r.row=f-1,r.col=l+r.col===0?h-1:-1),l+r.col>h-1?n&&y>0?(this.runLocalHooks("insertColRequire",h),h=this.options.countCols()):v&&(r.row=a+r.row===f-1?1-f:1,r.col=1-h):v&&l+r.col<0&&a+r.row>=0&&(r.row=a+r.row===0?f-1:-1,r.col=h-1);var m=this.options.createCellCoords(a+r.row,l+r.col);u=0,c=0,m.row<0?(u=-1,m.row=0):m.row>0&&m.row>=f&&(u=1,m.row=f-1),m.col<0?(c=-1,m.col=0):m.col>0&&m.col>=h&&(c=1,m.col=h-1),s=this.options.renderableToVisualCoords(m)}return this.runLocalHooks("afterTransformStart",s,u,c),s}},{key:"transformEnd",value:function(e,t){var n=this.options.createCellCoords(e,t),r=this.range.current(),o=r.to,i=0,a=0;this.runLocalHooks("beforeTransformEnd",n);var l=this.options.visualToRenderableCoords(r.highlight),s=l.row,u=l.col;if(null!==s&&null!==u){var c=this.options.countRows(),f=this.options.countCols(),h=this.options.visualToRenderableCoords(r.to),d=h.row,p=h.col,y=this.options.createCellCoords(d+n.row,p+n.col);i=0,a=0,y.row<0?(i=-1,y.row=0):y.row>0&&y.row>=c&&(i=1,y.row=c-1),y.col<0?(a=-1,y.col=0):y.col>0&&y.col>=f&&(a=1,y.col=f-1),o=this.options.renderableToVisualCoords(y)}return this.runLocalHooks("afterTransformEnd",o,i,a),o}}]),e}();se(FC,Ip);var WC=FC;function UC(e,t){return XC(e)||KC(e,t)||GC(e,t)||zC()}function zC(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function GC(e,t){if(e){if("string"===typeof e)return YC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?YC(e,t):void 0}}function YC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function KC(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function XC(e){if(Array.isArray(e))return e}function $C(e){return $C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$C(e)}var qC,QC=0,JC=1,ZC=2,eS=3,tS=[eS,ZC],nS=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],rS=Symbol("root"),oS=Symbol("child");function iS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rS;if(t!==rS&&t!==oS)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(e),r=t===rS,o=QC;if(n){var i=e[0];if(0===e.length)o=JC;else if(r&&i instanceof Iu)o=eS;else if(r&&Array.isArray(i))o=iS(i,oS);else if(e.length>=2&&e.length<=4){var a=!e.some((function(e,t){return!nS[t].includes($C(e))}));a&&(o=ZC)}}return o}function aS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.keepDirection,r=void 0!==n&&n,o=t.propToCol;if(!tS.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(t){var n=e===eS,i=n?t.from.row:t[0],a=n?t.from.col:t[1],l=n?t.to.row:t[2],s=n?t.to.col:t[3];if("function"===typeof o&&("string"===typeof a&&(a=o(a)),"string"===typeof s&&(s=o(s))),Je(l)&&(l=i),Je(s)&&(s=a),!r){var u=i,c=a,f=l,h=s;i=Math.min(u,f),a=Math.min(c,h),l=Math.max(u,f),s=Math.max(c,h)}return[i,a,l,s]}}function lS(e){var t=iS(e);if(t===QC||t===JC)return[];var n=aS(t),r=new Set;U(e,(function(e){var t=n(e),o=UC(t,4),i=o[1],a=o[3],l=Math.max(i,0),s=a-l+1;U(Array.from(new Array(s),(function(e,t){return l+t})),(function(e){r.has(e)||r.add(e)}))}));var o=Array.from(r).sort((function(e,t){return e-t})),i=V(o,(function(e,t,n,r){return 0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e}),[]);return i}function sS(e){var t=iS(e);if(t===QC||t===JC)return[];var n=aS(t),r=new Set;U(e,(function(e){var t=n(e),o=UC(t,3),i=o[0],a=o[2],l=Math.max(i,0),s=a-l+1;U(Array.from(new Array(s),(function(e,t){return l+t})),(function(e){r.has(e)||r.add(e)}))}));var o=Array.from(r).sort((function(e,t){return e-t})),i=V(o,(function(e,t,n,r){return 0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e}),[]);return i}function uS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"===typeof e&&e>=0&&e<t}function cS(e,t){return yS(e)||pS(e,t)||hS(e,t)||fS()}function fS(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function hS(e,t){if(e){if("string"===typeof e)return dS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dS(e,t):void 0}}function dS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pS(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function yS(e){if(Array.isArray(e))return e}function vS(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function gS(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bS(e,t,n){return t&&mS(e.prototype,t),n&&mS(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var wS=function(){function e(t,n){var r=this;gS(this,e),this.settings=t,this.tableProps=n,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new NC((function(e,t,n){return r.tableProps.createCellRange(e,t,n)})),this.highlight=new jC({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(e,t){return r.tableProps.isDisabledCellSelection(e,t)},cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)},createCellCoords:function(e,t){return r.tableProps.createCellCoords(e,t)},createCellRange:function(e,t,n){return r.tableProps.createCellRange(e,t,n)},rowIndexMapper:function(){return r.tableProps.rowIndexMapper()},columnIndexMapper:function(){return r.tableProps.columnIndexMapper()}}),this.transformation=new WC(this.selectedRange,{countRows:function(){return r.tableProps.countRowsTranslated()},countCols:function(){return r.tableProps.countColsTranslated()},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)},createCellCoords:function(e,t){return r.tableProps.createCellCoords(e,t)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(t))})),this.transformation.addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(t))}))}return bS(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,o=Je(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,i=e.row<0,a=e.col<0,l=i&&a,s=e.clone();this.selectedByCorner=l,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),s),(!r||r&&!o&&Je(t))&&this.selectedRange.clear(),this.selectedRange.add(s),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&a&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&i&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(e)}},{key:"setRangeStartOnly",value:function(e,t){this.setRangeStart(e,t,!0)}},{key:"setRangeEnd",value:function(e){if(!this.selectedRange.isEmpty()){var t=e.clone();this.runLocalHooks("beforeSetRangeEnd",t),this.begin();var n=this.selectedRange.current();"single"!==this.settings.selectionMode&&n.setTo(this.tableProps.createCellCoords(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Ib,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n);var r=this.getLayerLevel();r<this.highlight.layerLevel&&(U(this.highlight.getAreas(),(function(e){e.clear()})),U(this.highlight.getHeaders(),(function(e){e.clear()})),U(this.highlight.getActiveHeaders(),(function(e){e.clear()}))),this.highlight.useLayerLevel(r);var o=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();if(o.clear(),i.clear(),a.clear(),this.highlight.isEnabledFor(Ab,n.highlight)&&(this.isMultiple()||r>=1)&&(o.add(n.from).add(n.to).commit(),1===r)){var l=this.selectedRange.previous();this.highlight.useLayerLevel(r-1).createOrGetArea().add(l.from).commit().syncWith(l),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(xb,n.highlight)){var s=0===this.tableProps.countRowsTranslated(),u=0===this.tableProps.countColsTranslated(),c=n;if((s||u)&&(c=n.clone()),s&&(c.from.row=-1),u&&(c.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&c.from.normalize(),i.add(c.from).commit()):i.add(c.from).add(c.to).commit(),this.isEntireRowSelected()){var f=this.tableProps.countCols()===n.getWidth();f&&a.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var h=this.tableProps.countRows()===n.getHeight();h&&a.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",e)}}},{key:"isMultiple",value:function(){var e=ve(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}},{key:"transformStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(e,t,n))}},{key:"transformEnd",value:function(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}},{key:"isEntireRowSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}},{key:"isSelectedByColumnHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}},{key:"isEntireColumnSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(e){return this.selectedRange.includes(e)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.tableProps.countRows(),r=this.tableProps.countCols();if(e||t||0!==n&&0!==r){var o=this.tableProps.createCellCoords(t?-1:0,e?-1:0),i=this.tableProps.createCellCoords(n-1,r-1);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(i),this.finish()}}},{key:"selectCells",value:function(e){var t=this,n=iS(e);if(n===JC)return!1;if(n===QC)throw new Error(Ke(qC||(qC=vS(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."]))));var r=aS(n,{propToCol:function(e){return t.tableProps.propToCol(e)},keepDirection:!0}),o=this.tableProps.countRows(),i=this.tableProps.countCols(),a=!e.some((function(e){var t=r(e),n=cS(t,4),a=n[0],l=n[1],s=n[2],u=n[3],c=uS(a,o)&&uS(l,i)&&uS(s,o)&&uS(u,i);return!c}));return a&&(this.clear(),U(e,(function(e){var n=r(e),o=cS(n,4),i=o[0],a=o[1],l=o[2],s=o[3];t.setRangeStartOnly(t.tableProps.createCellCoords(i,a),!1),t.setRangeEnd(t.tableProps.createCellCoords(l,s)),t.finish()}))),a}},{key:"selectColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r="string"===typeof e?this.tableProps.propToCol(e):e,o="string"===typeof t?this.tableProps.propToCol(t):t,i=this.tableProps.countCols(),a=this.tableProps.countRows(),l=uS(r,i)&&uS(o,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,r)),this.setRangeEnd(this.tableProps.createCellCoords(a-1,o)),this.finish()),l}},{key:"selectRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.tableProps.countRows(),o=this.tableProps.countCols(),i=uS(e,r)&&uS(t,r);return i&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,n)),this.setRangeEnd(this.tableProps.createCellCoords(t,o-1)),this.finish()),i}},{key:"refresh",value:function(){var e=this.highlight.getCustomSelections();if(e.forEach((function(e){e.commit()})),this.isSelected()){var t=this.highlight.getCell(),n=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(var r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);var o=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();o.commit(),i.commit(),a.commit()}this.highlight.useLayerLevel(n)}}}]),e}();se(wS,Ip);var CS=wS,SS=wr("cellTypes"),OS=SS.register,kS=SS.getItem,RS=SS.hasItem,ES=SS.getNames;SS.getValues;function TS(e){if(!RS(e))throw Error('You declared cell type "'.concat(e,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return kS(e)}function PS(e,t){"string"!==typeof e&&(t=e,e=t.CELL_TYPE);var n=t,r=n.editor,o=n.renderer,i=n.validator;r&&Ar(e,r),o&&_i(e,o),i&&Fi(e,i),OS(e,t)}function MS(e,t){var n;return"CELL_TYPE"!==e&&((null===(n=t._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(e))||!ge(t,e))}function AS(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r="string"===typeof t.type?TS(t.type):t.type;if(e._automaticallyAssignedMetaProps&&he(t,(function(t,n){e._automaticallyAssignedMetaProps.delete(n)})),ce(r)){n!==e||e._automaticallyAssignedMetaProps||(e._automaticallyAssignedMetaProps=new Set);var o={};he(r,(function(t,r){var i;MS(r,n)&&(o[r]=t,null===(i=e._automaticallyAssignedMetaProps)||void 0===i||i.add(r))})),oe(e,o)}}function IS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}re(n,e);for(var r=0;r<t.length;r++)n.prototype[t[r]]=void 0;return n}function jS(e){return Number.isInteger(e)&&e>=0}function xS(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function _S(e){return null===e||void 0===e}function HS(e){return HS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},HS(e)}var DS=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(e){var t,n,r;for(t=0,n=this.countRows();t<n;t++)if(r=this.getDataAtCell(t,e),!1===Ze(r))return!1;return!0},isEmptyRow:function(e){var t,n,r,o;for(t=0,n=this.countCols();t<n;t++)if(r=this.getDataAtCell(e,t),!1===Ze(r))return"object"===HS(r)&&(o=this.getCellMeta(e,t),ue(this.getSchema()[o.prop],r));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function NS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function LS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?NS(Object(n),!0).forEach((function(t){BS(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NS(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function BS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FS(e,t,n){return t&&VS(e.prototype,t),n&&VS(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function WS(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function US(){return FS((function e(){WS(this,e)}))}var zS=function(){function e(t){WS(this,e),this.metaCtor=US(),this.meta=this.metaCtor.prototype,oe(this.meta,DS()),this.meta.instance=t}return FS(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){var t;oe(this.meta,e),AS(this.meta,LS(LS({},e),{},{type:null!==(t=e.type)&&void 0!==t?t:this.meta.type}),e)}}]),e}();function GS(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function KS(e,t,n){return t&&YS(e.prototype,t),n&&YS(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var XS=function(){function e(t){GS(this,e);var n=t.getMetaConstructor();this.meta=new n}return KS(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){oe(this.meta,e),AS(this.meta,e,e)}}]),e}();function $S(e){return ZS(e)||JS(e)||QS(e)||qS()}function qS(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function QS(e,t){if(e){if("string"===typeof e)return eO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eO(e,t):void 0}}function JS(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ZS(e){if(Array.isArray(e))return eO(e)}function eO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rO(e,t,n){return t&&nO(e.prototype,t),n&&nO(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var oO=function(e){function t(e){tO(this,t),this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}return rO(t,[{key:"obtain",value:function(e){xS((function(){return jS(e)}),"Expecting an unsigned number.");var t,n=this._getStorageIndexByKey(e);if(n>=0)t=this.data[n],void 0===t&&(t=this.valueFactory(e),this.data[n]=t);else if(t=this.valueFactory(e),this.holes.size>0){var r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=t,this.index[e]=r}else this.data.push(t),this.index[e]=this.data.length-1;return t}},{key:"insert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;xS((function(){return jS(e)||_S(e)}),"Expecting an unsigned number or null/undefined argument.");for(var n=[],r=this.data.length,o=0;o<t;o++)n.push(r+o),this.data.push(void 0);var i=_S(e)?this.index.length:e;this.index=[].concat($S(this.index.slice(0,i)),n,$S(this.index.slice(i)))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;xS((function(){return jS(e)||_S(e)}),"Expecting an unsigned number or null/undefined argument.");for(var n=this.index.splice(_S(e)?this.index.length-t:e,t),r=0;r<n.length;r++){var o=n[r];"number"===typeof o&&this.holes.add(o)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var e=this;return F(this.data,(function(t,n){return!e.holes.has(n)}))[Symbol.iterator]()}},{key:"entries",value:function(){for(var e=[],t=0;t<this.data.length;t++){var n=this._getKeyByStorageIndex(t);-1!==n&&e.push([n,this.data[t]])}var r=0;return{next:function(){if(r<e.length){var t=e[r];return r+=1,{value:t,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(e){return this.index.length>e?this.index[e]:-1}},{key:"_getKeyByStorageIndex",value:function(e){return this.index.indexOf(e)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function iO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lO(e,t,n){return t&&aO(e.prototype,t),n&&aO(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var sO=["data","width"],uO=function(){function e(t){var n=this;iO(this,e),this.globalMeta=t,this.metas=new oO((function(){return n._createMeta()}))}return lO(e,[{key:"updateMeta",value:function(e,t){var n=this.getMeta(e);oe(n,t),AS(n,t)}},{key:"createColumn",value:function(e,t){this.metas.insert(e,t)}},{key:"removeColumn",value:function(e,t){this.metas.remove(e,t)}},{key:"getMeta",value:function(e){return this.metas.obtain(e)}},{key:"getMetaConstructor",value:function(e){return this.metas.obtain(e).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return IS(this.globalMeta.getMetaConstructor(),sO).prototype}}]),e}();function cO(e){return pO(e)||dO(e)||hO(e)||fO()}function fO(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function hO(e,t){if(e){if("string"===typeof e)return yO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yO(e,t):void 0}}function dO(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function pO(e){if(Array.isArray(e))return yO(e)}function yO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mO(e,t,n){return t&&gO(e.prototype,t),n&&gO(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var bO=function(){function e(t){var n=this;vO(this,e),this.columnMeta=t,this.metas=new oO((function(){return n._createRow()}))}return mO(e,[{key:"updateMeta",value:function(e,t,n){var r=this.getMeta(e,t);oe(r,n),AS(r,n)}},{key:"createRow",value:function(e,t){this.metas.insert(e,t)}},{key:"createColumn",value:function(e,t){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}},{key:"removeRow",value:function(e,t){this.metas.remove(e,t)}},{key:"removeColumn",value:function(e,t){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}},{key:"getMeta",value:function(e,t,n){var r=this.metas.obtain(e).obtain(t);return void 0===n?r:r[n]}},{key:"setMeta",value:function(e,t,n,r){var o,i=this.metas.obtain(e).obtain(t);null===(o=i._automaticallyAssignedMetaProps)||void 0===o||o.delete(n),i[n]=r}},{key:"removeMeta",value:function(e,t,n){var r=this.metas.obtain(e).obtain(t);delete r[n]}},{key:"getMetas",value:function(){for(var e=[],t=Array.from(this.metas.values()),n=0;n<t.length;n++)e.push.apply(e,cO(t[n].values()));return e}},{key:"getMetasAtRow",value:function(e){xS((function(){return jS(e)}),"Expecting an unsigned number.");var t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var e=this;return new oO((function(t){return e._createMeta(t)}))}},{key:"_createMeta",value:function(e){var t=this.columnMeta.getMetaConstructor(e);return new t}}]),e}();function wO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SO(e,t,n){return t&&CO(e.prototype,t),n&&CO(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var OO=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];wO(this,e),this.hot=t,this.globalMeta=new zS(t),this.tableMeta=new XS(this.globalMeta),this.columnMeta=new uO(this.globalMeta),this.cellMeta=new bO(this.columnMeta),o.forEach((function(e){return new e(n)})),this.globalMeta.updateMeta(r)}return SO(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(e){this.globalMeta.updateMeta(e)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(e){this.tableMeta.updateMeta(e)}},{key:"getColumnMeta",value:function(e){return this.columnMeta.getMeta(e)}},{key:"updateColumnMeta",value:function(e,t){this.columnMeta.updateMeta(e,t)}},{key:"getCellMeta",value:function(e,t,n){var r=n.visualRow,o=n.visualColumn,i=this.cellMeta.getMeta(e,t);return i.visualRow=r,i.visualCol=o,i.row=e,i.col=t,this.runLocalHooks("afterGetCellMeta",i),i}},{key:"getCellMetaKeyValue",value:function(e,t,n){if("string"!==typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}},{key:"setCellMeta",value:function(e,t,n,r){this.cellMeta.setMeta(e,t,n,r)}},{key:"updateCellMeta",value:function(e,t,n){this.cellMeta.updateMeta(e,t,n)}},{key:"removeCellMeta",value:function(e,t,n){this.cellMeta.removeMeta(e,t,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(e){return this.cellMeta.getMetasAtRow(e)}},{key:"createRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}},{key:"createColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}},{key:"removeColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();function kO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function EO(e,t,n){return t&&RO(e.prototype,t),n&&RO(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}se(OO,Ip);var TO=function(){function e(t){var n=this;kO(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",(function(e){return n.extendCellMeta(e)})),hr.getSingleton().add("beforeRender",(function(e){e&&n.metaSyncMemo.clear()}),this.metaManager.hot)}return EO(e,[{key:"extendCellMeta",value:function(e){var t,n=e.row,r=e.col;if(null===(t=this.metaSyncMemo.get(n))||void 0===t||!t.has(r)){var o=e.visualRow,i=e.visualCol,a=this.metaManager.hot,l=a.colToProp(i);e.prop=l,a.runHooks("beforeGetCellMeta",o,i,e);var s,u=ge(e,"type")?e.type:null,c=jn(e.cells)?e.cells(n,r,l):null;if(u)if(c)c.type=null!==(s=c.type)&&void 0!==s?s:u;else c={type:u};c&&this.metaManager.updateCellMeta(n,r,c),a.runHooks("afterGetCellMeta",o,i,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}}]),e}();function PO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function AO(e,t,n){return t&&MO(e.prototype,t),n&&MO(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var IO=function(){function e(t){PO(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(e){var t=this.metaManager.hot.isRtl();if(t&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(e,t,n){if(!n)throw new Error("The `".concat(e,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return AO(e,[{key:"extendMetaProps",value:function(){var e=this;this.propDescriptors.forEach((function(t,n){var r=t.target,o=t.onChange,i=void 0===o?function(){}:o,a="string"===typeof r,l=a?r:n,s="_".concat(l);e.metaManager.globalMeta.meta[s]=e.metaManager.globalMeta.meta[l],e.installPropWatcher(n,s,i),a&&e.installPropWatcher(r,s,i)}))}},{key:"installPropWatcher",value:function(e,t,n){var r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get:function(){return this[t]},set:function(o){var i=!r.usageTracker.has(e);r.usageTracker.add(e),n.call(r,e,o,i),this[t]=o},enumerable:!0,configurable:!0})}}]),e}(),jO=(n("8125"),/^(\r\n|\n\r|\r|\n)/),xO=/^[^\t\r\n]+/,_O=/^\t/;function HO(e){var t=[[""]];if(0===e.length)return t;var n,r=0,o=0;while(e.length>0){if(n===e.length)break;if(n=e.length,e.match(_O))e=e.replace(_O,""),r+=1,t[o][r]="";else if(e.match(jO))e=e.replace(jO,""),r=0,o+=1,t[o]=[""];else{var i="";if(e.startsWith('"')){var a=0,l=!0;while(l){var s=e.slice(0,1);'"'===s&&(a+=1),i+=s,e=e.slice(1),(0===e.length||e.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(function(e){return new Array(Math.floor(e.length/2)).fill('"').join("")}))}else{var u=e.match(xO);i=u?u[0]:"",e=e.slice(i.length)}t[o][r]=i}}return t}function DO(e){var t,n,r,o,i,a="";for(t=0,n=e.length;t<n;t+=1){for(o=e[t].length,r=0;r<o;r+=1)r>0&&(a+="\t"),i=e[t][r],"string"===typeof i?i.indexOf("\n")>-1?a+='"'.concat(i.replace(/"/g,'""'),'"'):a+=i:a+=null===i||void 0===i?"":i;t!==n-1&&(a+="\n")}return a}function NO(e){return FO(e)||VO(e)||BO(e)||LO()}function LO(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function BO(e,t){if(e){if("string"===typeof e)return WO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?WO(e,t):void 0}}function VO(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function FO(e){if(Array.isArray(e))return WO(e)}function WO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function UO(e){return UO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},UO(e)}function zO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GO(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function YO(e,t,n){return t&&GO(e.prototype,t),n&&GO(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var KO=function(){function e(t,n,r){zO(this,e),this.instance=t,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return YO(e,[{key:"createMap",value:function(){var e=this.getSchema();if("undefined"===typeof e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var t,n=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,n){var r=0,o=0,i=!1;if("function"===typeof n){var a=ye(e);r=a>0?a:this.countFirstRowKeys(),i=!0}else{var l=this.tableMeta.maxCols;r=Math.min(l,n.length)}for(t=0;t<r;t++){var s=i?n(t):n[t];if(ce(s)){if("undefined"!==typeof s.data){var u=i?o:t;this.colToPropCache[u]=s.data,this.propToColCache.set(s.data,u)}o+=1}}}else this.recursiveDuckColumns(e)}},{key:"countFirstRowKeys",value:function(){return Cp(this.dataSource)}},{key:"recursiveDuckColumns",value:function(e,t,n){var r,o=this,i=t,a=n;return"undefined"===typeof i&&(i=0,a=""),"object"!==UO(e)||Array.isArray(e)||he(e,(function(e,t){null===e?(r=a+t,o.colToPropCache.push(r),o.propToColCache.set(r,i),i+=1):i=o.recursiveDuckColumns(e,i,"".concat(t,"."))})),i}},{key:"colToProp",value:function(e){if(!1===Number.isInteger(e))return e;var t=this.instance.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&Qe(this.colToPropCache[t])?this.colToPropCache[t]:t}},{key:"propToCol",value:function(e){var t=this.propToColCache.get(e);if(Qe(t))return this.instance.toVisualColumn(t);var n=this.instance.toVisualColumn(e);return null===n?e:n}},{key:"getSchema",value:function(){var e=this.tableMeta.dataSchema;return e?"function"===typeof e?e():e:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?ne(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.source,i=r.mode,a=void 0===i?"above":i,l=this.instance.countSourceRows(),s=l,u=0,c=e;("number"!==typeof c||c>=l)&&(c=l),c<this.instance.countRows()&&(s=this.instance.toPhysicalRow(c));var f=this.instance.runHooks("beforeCreateRow",c,n,o);if(!1===f||null===s)return{delta:0};var h=this.tableMeta.maxRows,d=this.getSchema().length,p=[],y=function(){var e=null;"array"===t.instance.dataType?t.tableMeta.dataSchema?e=ae(t.getSchema()):(e=[],Co(d-1,(function(){return e.push(null)}))):"function"===t.instance.dataType?e=t.tableMeta.dataSchema(c+u):(e={},ie(e,t.getSchema())),p.push(e),u+=1};while(u<n&&l+u<h)y();this.instance.rowIndexMapper.insertIndexes(c,u),"below"===a&&(s=Math.min(s+1,l)),this.spliceData(s,0,p);var v=this.instance.toVisualRow(s);return this.instance.countSourceRows()===p.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),u>0&&(void 0===e||null===e?this.metaManager.createRow(null,u):"auto"!==o&&this.metaManager.createRow(s,n)),this.instance.runHooks("afterCreateRow",v,u,o),this.instance.forceFullRender=!0,{delta:u,startPhysicalIndex:s}}},{key:"createCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.source,o=n.mode,i=void 0===o?"start":o;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var a=this.dataSource,l=this.tableMeta.maxCols,s=this.instance.countSourceCols(),u=e;("number"!==typeof u||u>=s)&&(u=s);var c=this.instance.runHooks("beforeCreateCol",u,t,r);if(!1===c)return{delta:0};var f=s;u<this.instance.countCols()&&(f=this.instance.toPhysicalColumn(u));var h=this.instance.countSourceRows(),d=this.instance.countCols(),p=0,y=f;"end"===i&&(y=Math.min(y+1,s));var v=y;while(p<t&&d<l){if("number"!==typeof u||u>=d)if(h>0)for(var g=0;g<h;g+=1)"undefined"===typeof a[g]&&(a[g]=[]),a[g].push(null);else a.push([null]);else for(var m=0;m<h;m++)a[m].splice(y,0,null);p+=1,y+=1,d+=1}this.instance.columnIndexMapper.insertIndexes(u,p),p>0&&(void 0===e||null===e?this.metaManager.createColumn(null,p):"auto"!==r&&this.metaManager.createColumn(v,t));var b=this.instance.toVisualColumn(v);return this.instance.runHooks("afterCreateCol",b,p,r),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:p,startPhysicalIndex:v}}},{key:"removeRow",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(e)?e:-n,i=this.visualRowsToPhysical(o,n),a=this.instance.countSourceRows();o=(a+o)%a;var l=this.instance.runHooks("beforeRemoveRow",o,i.length,i,r);if(!1===l)return!1;var s=i.length;if(this.filterData(o,s,i),o<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(i);var u=Qe(this.tableMeta.columns)||Qe(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===u&&this.instance.columnIndexMapper.setIndexesSequence([])}var c=i.slice(0).sort((function(e,t){return t-e}));return c.forEach((function(e){t.metaManager.removeRow(e,1)})),this.instance.runHooks("afterRemoveRow",o,s,i,r),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var r="number"!==typeof e?-t:e;r=(this.instance.countCols()+r)%this.instance.countCols();var o=this.visualColumnsToPhysical(r,t),i=o.slice(0).sort((function(e,t){return t-e})),a=this.instance.runHooks("beforeRemoveCol",r,t,o,n);if(!1===a)return!1;for(var l=!0,s=i.length,u=this.dataSource,c=0;c<s;c++)l&&o[0]!==o[c]-c&&(l=!1);if(l)for(var f=0,h=this.instance.countSourceRows();f<h;f++)u[f].splice(o[0],t),0===f&&this.metaManager.removeColumn(o[0],t);else for(var d=0,p=this.instance.countSourceRows();d<p;d++)for(var y=0;y<s;y++)u[d].splice(i[y],1),0===d&&this.metaManager.removeColumn(i[y],1);return r<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",r,t,o,n),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(e,t,n){for(var r=this.instance.getDataAtCol(e),o=r.slice(t,t+n),i=r.slice(t+n),a=arguments.length,l=new Array(a>3?a-3:0),s=3;s<a;s++)l[s-3]=arguments[s];L(l,i);var u=0;while(u<n)l.push(null),u+=1;return N(l),this.instance.populateFromArray(t,e,l,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(e,t,n){for(var r=this.instance.getSourceDataAtRow(e),o=r.slice(t,t+n),i=r.slice(t+n),a=arguments.length,l=new Array(a>3?a-3:0),s=3;s<a;s++)l[s-3]=arguments[s];L(l,i);var u=0;while(u<n)l.push(null),u+=1;return this.instance.populateFromArray(e,t,[l],null,null,"spliceRow"),o}},{key:"spliceData",value:function(e,t,n){var r=this,o=this.instance.runHooks("beforeDataSplice",e,t,n);if(!1!==o){var i=[].concat(NO(this.dataSource.slice(0,e)),NO(n),NO(this.dataSource.slice(e)));this.dataSource.length=0,i.forEach((function(e){return r.dataSource.push(e)}))}}},{key:"filterData",value:function(e,t,n){var r=this.instance.runHooks("filterData",e,t,n);!1===Array.isArray(r)&&(r=this.dataSource.filter((function(e,t){return-1===n.indexOf(t)}))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}},{key:"get",value:function(e,t){var n=this.instance.toPhysicalRow(e),r=this.dataSource[n],o=this.instance.runHooks("modifyRowData",n);r=isNaN(o)?o:r;var i=null;if(r&&r.hasOwnProperty&&ge(r,t))i=r[t];else if("string"===typeof t&&t.indexOf(".")>-1){var a=t.split("."),l=r;if(!l)return null;for(var s=0,u=a.length;s<u;s++)if(l=l[a[s]],"undefined"===typeof l)return null;i=l}else"function"===typeof t&&(i=t(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var c=ve(i);this.instance.runHooks("modifyData",n,this.propToCol(t),c,"get"),c.isTouched()&&(i=c.value)}return i}},{key:"getCopyable",value:function(e,t){return this.instance.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}},{key:"set",value:function(e,t,n){var r=this.instance.toPhysicalRow(e),o=n,i=this.dataSource[r],a=this.instance.runHooks("modifyRowData",r);if(i=isNaN(a)?a:i,this.instance.hasHook("modifyData")){var l=ve(o);this.instance.runHooks("modifyData",r,this.propToCol(t),l,"set"),l.isTouched()&&(o=l.value)}if(i&&i.hasOwnProperty&&ge(i,t))i[t]=o;else if("string"===typeof t&&t.indexOf(".")>-1){var s,u=t.split("."),c=i,f=0;for(f=0,s=u.length-1;f<s;f++)"undefined"===typeof c[u[f]]&&(c[u[f]]={}),c=c[u[f]];c[u[f]]=o}else"function"===typeof t?t(this.dataSource.slice(r,r+1)[0],o):i[t]=o}},{key:"visualRowsToPhysical",value:function(e,t){var n,r=this.instance.countSourceRows(),o=[],i=(r+e)%r,a=t;while(i<r&&a)n=this.instance.toPhysicalRow(i),o.push(n),a-=1,i+=1;return o}},{key:"visualColumnsToPhysical",value:function(e,t){var n=this.instance.countCols(),r=[],o=(n+e)%n,i=t;while(o<n&&i){var a=this.instance.toPhysicalColumn(o);r.push(a),i-=1,o+=1}return r}},{key:"clear",value:function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}},{key:"getLength",value:function(){var e,t=this.tableMeta.maxRows;e=t<0||0===t?0:t||1/0;var n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,e)}},{key:"getAll",value:function(){var t={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-n.row!==0||this.instance.countSourceRows()?this.getRange(t,n,e.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(t,n,r){var o,i,a,l=[],s=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(0===s||0===u)return[];var c=r===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(s-1,0),Math.max(t.row,n.row)),h=Math.min(Math.max(u-1,0),Math.max(t.col,n.col));for(o=Math.min(t.row,n.row);o<=f;o++){a=[];var d=o>=0?this.instance.toPhysicalRow(o):o;for(i=Math.min(t.col,n.col);i<=h;i++){if(null===d)break;a.push(c.call(this,o,this.colToProp(i)))}null!==d&&l.push(a)}return l}},{key:"getText",value:function(t,n){return DO(this.getRange(t,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(t,n){return DO(this.getRange(t,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}(),XO=KO;function $O(e){return $O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$O(e)}function qO(e,t,n,r){var o=r.hotInstance,i=r.dataMap,a=r.dataSource,l=r.internalSource,s=r.source,u=r.metaManager,c=r.firstRun,f=gt(l),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":jn(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),e=o.runHooks("before".concat(f),e,c,s);var d=new XO(o,e,u);if(t(d),"object"===$O(e)&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat($O(e)," given)"));var p,y=d.getSchema();e=[];var v=0,g=0;for(v=0,g=h.startRows;v<g;v++)if("object"!==o.dataType&&"function"!==o.dataType||!h.dataSchema)if("array"===o.dataType)p=ae(y[0]),e.push(p);else{p=[];for(var m=0,b=h.startCols;m<b;m++)p.push(null);e.push(p)}else p=ae(y),e.push(p)}Array.isArray(e[0])&&(o.dataType="array"),h.data=e,d.dataSource=e,a.data=e,a.dataType=o.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),n(d),o.runHooks("after".concat(f),e,c,s),c||(o.runHooks("afterChange",null,l),o.render())}var QO,JO=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),ZO=function(e){return e.map((function(e){var t=e.toLowerCase();return JO.has(t)?JO.get(t):t})).sort().join("+")},ek=function(e){return e.split("+")},tk=function(e){return e.toLowerCase()};function nk(e){return ik(e)||ok(e)||sk(e)||rk()}function rk(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ok(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ik(e){if(Array.isArray(e))return uk(e)}function ak(e,t){return fk(e)||ck(e,t)||sk(e,t)||lk()}function lk(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function sk(e,t){if(e){if("string"===typeof e)return uk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uk(e,t):void 0}}function uk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ck(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function fk(e){if(Array.isArray(e))return e}function hk(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var dk=function(e){var t=Qo({errorIdExists:function(t){return'The "'.concat(t,'" shortcut is already registered in the "').concat(e,'" context.')}}),n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.keys,r=e.callback,o=e.group,i=e.runOnlyIf,a=void 0===i?function(){return!0}:i,l=e.captureCtrl,s=void 0!==l&&l,u=e.preventDefault,c=void 0===u||u,f=e.stopPropagation,h=void 0!==f&&f,d=e.relativeToGroup,p=e.position;if(Je(o))throw new Error("You need to define the shortcut's group.");if(!1===jn(r))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(n))throw new Error(Ke(QO||(QO=hk(["Pass the shortcut's keys as an array of arrays, \n      using the KeyboardEvent.key properties: \n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."],["Pass the shortcut\\'s keys as an array of arrays,\\x20\n      using the KeyboardEvent.key properties:\\x20\n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."]))));var y={callback:r,group:o,runOnlyIf:a,captureCtrl:s,preventDefault:c,stopPropagation:h};if(Qe(d)){var v=[d,p];y.relativeToGroup=v[0],y.position=v[1]}n.forEach((function(e){var n=ZO(e),r=t.hasItem(n);if(r){var o=t.getItem(n),i=o.findIndex((function(e){return e.group===d}));-1!==i?"before"===p?i-=1:i+=1:i=o.length,o.splice(i,0,y)}else t.addItem(n,[y])}))},r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((function(e){he(t,(function(n,r){!1===Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=t[r])})),n(e)}))},o=function(e){var n=ZO(e);t.removeItem(n)},i=function(e){var n=t.getItems();n.forEach((function(t){var n=ak(t,2),r=n[0],i=n[1],a=i.filter((function(t){return t.group!==e}));0===a.length?o(ek(r)):(i.length=0,i.push.apply(i,nk(a)))}))},a=function(e){var n=ZO(e),r=t.getItem(n);return Qe(r)?r.slice():[]},l=function(e){var n=ZO(e);return t.hasItem(n)};return{addShortcut:n,addShortcuts:r,getShortcuts:a,hasShortcut:l,removeShortcutsByKeys:o,removeShortcutsByGroup:i}};function pk(){var e=new Set;return{press:function(t){e.add(t)},release:function(t){e.delete(t)},releaseAll:function(){e.clear()},isPressed:function(t){return e.has(t)}}}var yk=["meta","alt","shift","control"],vk=pk();function gk(e,t,n,r,o){var i=function(e){return yk.includes(e)},a=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return e.altKey&&n.push("alt"),t&&(e.ctrlKey||e.metaKey)?n.push("control/meta"):(e.ctrlKey&&n.push("control"),e.metaKey&&n.push("meta")),e.shiftKey&&n.push("shift"),n},l=function(e){if(!1!==t(e)){var l=n(e);if(229!==e.keyCode&&!1!==l&&!Jn(e)){var s=tk(e.key),u=[];i(s)?vk.press(s):u=a(e);var c=[s].concat(u),f=o(e,c);!f&&(Ne()&&u.includes("meta")||!Ne()&&u.includes("control"))&&o(e,[s].concat(a(e,!0))),r(e)}}},s=function(e){if(!1!==t(e)){var n=tk(e.key);!1!==i(n)&&vk.release(n)}},u=function(){vk.releaseAll()},c=function(){var t=e;while(t)t.document.documentElement.addEventListener("keydown",l),t.document.documentElement.addEventListener("keyup",s),t.document.documentElement.addEventListener("blur",u),t=jt(t)},f=function(){var t=e;while(t)t.document.documentElement.removeEventListener("keydown",l),t.document.documentElement.removeEventListener("keyup",s),t.document.documentElement.removeEventListener("blur",u),t=jt(t)};return{mount:c,unmount:f,isPressed:function(e){return vk.isPressed(e)}}}var mk,bk,wk=function(e){var t=e.ownerWindow,n=e.handleEvent,r=e.beforeKeyDown,o=e.afterKeyDown,i=Qo({errorIdExists:function(e){return'The "'.concat(e,'" context name is already registered.')}}),a="grid",l=function(e){var t=dk(e);return i.addItem(e,t),t},s=function(){return a},u=function(e){return i.getItem(e)},c=function(e){a=e},f=!1,h=gk(t,n,r,o,(function(e,t){var n=u(s()),r=!1;if(!n.hasShortcut(t))return r;for(var o=n.getShortcuts(t),i=0;i<o.length;i++){var a=o[i],l=a.callback,c=a.runOnlyIf,h=a.preventDefault,d=a.stopPropagation,p=a.captureCtrl;if(!1!==c(e)&&(f=p,r=!1===l(e,t),f=!1,h&&e.preventDefault(),d&&e.stopPropagation(),r))break}return r}));return h.mount(),{addContext:l,getActiveContextName:s,getContext:u,setActiveContextName:c,isCtrlPressed:function(){return!f&&(h.isPressed("control")||h.isPressed("meta"))},destroy:function(){return h.unmount()}}};function Ck(e){return Ck="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ck(e)}function Sk(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Ok(e,t){return Ek(e)||Rk(e,t)||Mk(e,t)||kk()}function kk(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Rk(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Ek(e){if(Array.isArray(e))return e}function Tk(e){return Ik(e)||Ak(e)||Mk(e)||Pk()}function Pk(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Mk(e,t){if(e){if("string"===typeof e)return jk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jk(e,t):void 0}}function Ak(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ik(e){if(Array.isArray(e))return jk(e)}function jk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var xk="gridDefault",_k=null,Hk=new Set;function Dk(e,t){var n,r,o,i,a,l=this,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=!1,c=this,f=new Nr(c),h=!0;Ld(s)&&Nd(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=null!==(n=null===t||void 0===t?void 0:t.layoutDirection)&&void 0!==n?n:"inherit",p=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return"rtl"===p},this.isLtr=function(){return!c.isRtl()},this.getDirectionFactor=function(){return c.isLtr()?1:-1},t.language=Pb(t.language);var y=new OO(c,t,[TO,IO]),v=y.getTableMeta(),g=y.getGlobalMeta(),m=Qo();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),Bd(this)&&yt(t.licenseKey,e),this.guid="ht_".concat(bt()),this.columnIndexMapper=new Tg,this.rowIndexMapper=new Tg,o=new Pp(c),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var b=function(e){var t=e.row,n=e.col;return c._createCellCoords(t>=0?c.rowIndexMapper.getRenderableFromVisualIndex(t):t,n>=0?c.columnIndexMapper.getRenderableFromVisualIndex(n):n)},w=function(e){var t=e.row,n=e.col;return c._createCellCoords(t>=0?c.rowIndexMapper.getVisualFromRenderableIndex(t):t,n>=0?c.columnIndexMapper.getVisualFromRenderableIndex(n):n)},C=new CS(v,{rowIndexMapper:function(){return c.rowIndexMapper},columnIndexMapper:function(){return c.columnIndexMapper},countCols:function(){return c.countCols()},countRows:function(){return c.countRows()},propToCol:function(e){return r.propToCol(e)},isEditorOpened:function(){return!!c.getActiveEditor()&&c.getActiveEditor().isOpened()},countColsTranslated:function(){return l.view.countRenderableColumns()},countRowsTranslated:function(){return l.view.countRenderableRows()},getShortcutManager:function(){return c.getShortcutManager()},createCellCoords:function(e,t){return c._createCellCoords(e,t)},createCellRange:function(e,t,n){return c._createCellRange(e,t,n)},visualToRenderableCoords:b,renderableToVisualCoords:w,isDisabledCellSelection:function(e,t){return c.getCellMeta(e,t).disableVisualSelection}});this.selection=C;var S=function(e){var t=e.hiddenIndexesChanged;t&&l.selection.refresh()};function O(e){var t=Ag(e);kb(t)?(c.runHooks("beforeLanguageChange",t),g.language=t,c.runHooks("afterLanguageChange",t)):Ig(e)}function k(e,t){var n="className"===e?c.rootElement:c.table;if(h)Ut(n,t);else{var r=[],o=[];g[e]&&(r=Array.isArray(g[e])?g[e]:Z(g[e])),t&&(o=Array.isArray(t)?t:Z(t));var i=q(r,o),a=q(o,r);i.length&&zt(n,i),a.length&&Ut(n,a)}g[e]=t}function R(){var e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function E(e){var t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function T(e,t,n){if(e.length){var o=c.getActiveEditor(),i=c.runHooks("beforeChange",e,t||"edit"),a=!0;if(!1!==i){var l=new R;l.onQueueEmpty=function(e){o&&a&&o.cancelChanges(),n(e)};for(var s=e.length-1;s>=0;s--)if(null===e[s])e.splice(s,1);else{var u=Ok(e[s],4),f=u[0],h=u[1],d=u[3],p=r.propToCol(h),y=c.getCellMeta(f,p);"numeric"===y.type&&"string"===typeof d&&wo(d)&&(e[s][3]=E(d)),c.getCellValidator(y)&&(l.addValidatorToQueue(),c.validateCell(e[s][3],y,function(t,n){return function(r){if("boolean"!==typeof r)throw new Error("Validation error: result is not boolean");if(!1===r&&!1===n.allowInvalid){a=!1,e.splice(t,1),n.valid=!0;var o=c.getCell(n.visualRow,n.visualCol);null!==o&&zt(o,v.invalidCellClassName)}l.removeValidatorFormQueue()}}(s,y),t))}l.checkIfQueueIsEmpty()}else o&&o.cancelChanges()}}function P(e,t){var n=e.length-1;if(!(n<0)){for(;n>=0;n--){var o=!1;if(null!==e[n]){if(null!==e[n][2]&&void 0!==e[n][2]||null!==e[n][3]&&void 0!==e[n][3]){if(v.allowInsertRow)while(e[n][0]>c.countRows()-1){var l=r.createRow(void 0,void 0,{source:t}),s=l.delta;if(0===s){o=!0;break}}if("array"===c.dataType&&(!v.columns||0===v.columns.length)&&v.allowInsertColumn)while(r.propToCol(e[n][1])>c.countCols()-1){var u=r.createCol(void 0,void 0,{source:t}),f=u.delta;if(0===f){o=!0;break}}o||r.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1)}c.forceFullRender=!0,i.adjustRowsAndCols(),c.runHooks("beforeChangeRender",e,t),a.lockEditor(),c._refreshBorders(null),a.unlockEditor(),c.view.adjustElementsSize(),c.runHooks("afterChange",e,t||"edit");var h=c.getActiveEditor();h&&Qe(h.refreshValue)&&h.refreshValue()}}function M(e,t,n){return Array.isArray(e)?e:[[e,t,n]]}this.columnIndexMapper.addLocalHook("cacheUpdated",S),this.rowIndexMapper.addLocalHook("cacheUpdated",S),this.selection.addLocalHook("beforeSetRangeStart",(function(e){l.runHooks("beforeSetRangeStart",e)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(function(e){l.runHooks("beforeSetRangeStartOnly",e)})),this.selection.addLocalHook("beforeSetRangeEnd",(function(e){l.runHooks("beforeSetRangeEnd",e),e.row<0&&(e.row=l.view._wt.wtTable.getFirstVisibleRow()),e.col<0&&(e.col=l.view._wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(function(e){var t=ve(!1),n=l.selection.getSelectedRange(),r=n.current(),o=r.from,i=r.to,a=n.size()-1;l.runHooks("afterSelection",o.row,o.col,i.row,i.col,t,a),l.runHooks("afterSelectionByProp",o.row,c.colToProp(o.col),i.row,c.colToProp(i.col),t,a);var s=l.selection.isSelectedByAnyHeader(),f=l.selection.selectedRange.current(),h=!0;u&&(h=!1),t.isTouched()&&(h=!t.value);var d=l.selection.isSelectedByRowHeader(),p=l.selection.isSelectedByColumnHeader();!1!==h&&(s?d?l.view.scrollViewportVertically(c.rowIndexMapper.getRenderableFromVisualIndex(e.row)):p&&l.view.scrollViewportHorizontally(c.columnIndexMapper.getRenderableFromVisualIndex(e.col)):f&&!l.selection.isMultiple()?l.view.scrollViewport(b(f.from)):l.view.scrollViewport(b(e))),d&&p?Ut(l.rootElement,["ht__selection--rows","ht__selection--columns"]):d?(zt(l.rootElement,"ht__selection--columns"),Ut(l.rootElement,"ht__selection--rows")):p?(zt(l.rootElement,"ht__selection--rows"),Ut(l.rootElement,"ht__selection--columns")):zt(l.rootElement,["ht__selection--rows","ht__selection--columns"]),l._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(function(e){var t=e.length-1,n=e[t],r=n.from,o=n.to;l.runHooks("afterSelectionEnd",r.row,r.col,o.row,o.col,t),l.runHooks("afterSelectionEndByProp",r.row,c.colToProp(r.col),o.row,c.colToProp(o.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(function(e){var t=l.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("beforeModifyTransformStart",(function(e){l.runHooks("modifyTransformStart",e)})),this.selection.addLocalHook("afterModifyTransformStart",(function(e,t,n){l.runHooks("afterModifyTransformStart",e,t,n)})),this.selection.addLocalHook("beforeModifyTransformEnd",(function(e){l.runHooks("modifyTransformEnd",e)})),this.selection.addLocalHook("afterModifyTransformEnd",(function(e,t,n){l.runHooks("afterModifyTransformEnd",e,t,n)})),this.selection.addLocalHook("afterDeselect",(function(){a.destroyEditor(),l._refreshBorders(),zt(l.rootElement,["ht__selection--rows","ht__selection--columns"]),l.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(function(e){l.alter("insert_row_above",e,1,"auto")})),this.selection.addLocalHook("insertColRequire",(function(e){l.alter("insert_col_start",e,1,"auto")})),i={alter:function(e,t){var n,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,u=function(e){if(0===e.length)return[];var t=Tk(e);t.sort((function(e,t){var n=Ok(e,1),r=n[0],o=Ok(t,1),i=o[0];return r===i?0:r>i?1:-1}));var n=V(t,(function(e,t){var n=Ok(t,2),r=n[0],o=n[1],i=e[e.length-1],a=Ok(i,2),l=a[0],s=a[1],u=l+s;if(r<=u){var c=Math.max(o-(u-r),0);i[1]+=c}else e.push([r,o]);return e}),[t[0]]);return n};switch(e){case"insert_row":Hk.has(e)||(Hk.add(e),Fn(Ke(mk||(mk=Sk(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),e)));case"insert_row_below":case"insert_row_above":var f=c.countSourceRows();if(v.maxRows===f)return;var h="insert_row_below"===e?"below":"above";t=null!==(n=t)&&void 0!==n?n:"insert_row"===e||"below"===h?f:0;var d=r.createRow(t,a,{source:l,mode:h}),p=d.delta,y=d.startPhysicalIndex;if(p){var g=C.selectedRange.current(),m=null===g||void 0===g?void 0:g.from,b=null===m||void 0===m?void 0:m.row,w=c.toVisualRow(y);if(C.isSelectedByCorner())c.selectAll();else if(Qe(b)&&b>=w){var S=g.to,O=S.row,k=S.col,R=m.col;C.isSelectedByRowHeader()&&(R=-1),C.getSelectedRange().pop(),C.setRangeStartOnly(c._createCellCoords(b+p,R),!0),C.setRangeEnd(c._createCellCoords(O+p,k))}else c._refreshBorders()}break;case"insert_col":Hk.has(e)||(Hk.add(e),Fn(Ke(bk||(bk=Sk(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),e)));case"insert_col_start":case"insert_col_end":var E="insert_col_end"===e?"end":"start";t=null!==(o=t)&&void 0!==o?o:"insert_col"===e||"end"===E?c.countSourceCols():0;var T=r.createCol(t,a,{source:l,mode:E}),P=T.delta,M=T.startPhysicalIndex;if(P){if(Array.isArray(v.colHeaders)){var A=[c.toVisualColumn(M),0];A.length+=P,Array.prototype.splice.apply(v.colHeaders,A)}var I=C.selectedRange.current(),j=null===I||void 0===I?void 0:I.from,x=null===j||void 0===j?void 0:j.col,_=c.toVisualColumn(M);if(C.isSelectedByCorner())c.selectAll();else if(Qe(x)&&x>=_){var H=I.to,D=H.row,N=H.col,L=j.row;C.isSelectedByColumnHeader()&&(L=-1),C.getSelectedRange().pop(),C.setRangeStartOnly(c._createCellCoords(L,x+P),!0),C.setRangeEnd(c._createCellCoords(D,N+P))}else c._refreshBorders()}break;case"remove_row":var B=function(e){var t=0;U(e,(function(e){var n=Ok(e,2),o=n[0],i=n[1],a=Ze(o)?c.countRows()-1:Math.max(o-t,0);Number.isInteger(o)&&(o=Math.max(o-t,0));var s=r.removeRow(o,i,l);if(s){var u=c.countRows(),f=v.fixedRowsTop;f>=a+1&&(v.fixedRowsTop-=Math.min(i,f-a));var h=v.fixedRowsBottom;h&&a>=u-h&&(v.fixedRowsBottom-=Math.min(i,h)),t+=i}}))};Array.isArray(t)?B(u(t)):B([[t,a]]),i.adjustRowsAndCols(),c._refreshBorders();break;case"remove_col":var F=function(e){var t=0;U(e,(function(e){var n=Ok(e,2),o=n[0],i=n[1],a=Ze(o)?c.countCols()-1:Math.max(o-t,0),s=c.toPhysicalColumn(a);Number.isInteger(o)&&(o=Math.max(o-t,0));var u=r.removeCol(o,i,l);if(u){var f=v.fixedColumnsStart;f>=a+1&&(v.fixedColumnsStart-=Math.min(i,f-a)),Array.isArray(v.colHeaders)&&("undefined"===typeof s&&(s=-1),v.colHeaders.splice(s,i)),t+=i}}))};Array.isArray(t)?F(u(t)):F([[t,a]]),i.adjustRowsAndCols(),c._refreshBorders();break;default:throw new Error('There is no such action "'.concat(e,'"'))}s||i.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t=v.minRows,n=v.minSpareRows,o=v.minCols,i=v.minSpareCols;if(0===c.countRows()&&0===c.countCols()&&C.deselect(),t){var a=c.countRows();a<t&&r.createRow(a,t-a,{source:"auto"})}if(n){var l=c.countEmptyRows(!0);if(l<n){var s=n-l,u=Math.min(s,v.maxRows-c.countSourceRows());r.createRow(c.countRows(),u,{source:"auto"})}}(o||i)&&(e=c.countEmptyCols(!0));var f=c.countCols();if(o&&!v.columns&&f<o){var h=o-f;e+=h,r.createCol(f,h,{source:"auto"})}if(i&&!v.columns&&"array"===c.dataType&&e<i){f=c.countCols();var d=i-e,p=Math.min(d,v.maxCols-f);r.createCol(f,p,{source:"auto"})}if(C.isSelected()){var y=c.countRows(),g=c.countCols();U(C.selectedRange,(function(e){var t=!1,n=e.from.row,r=e.from.col,o=e.to.row,i=e.to.col;n>y-1?(n=y-1,t=!0,o>n&&(o=n)):o>y-1&&(o=y-1,t=!0,n>o&&(n=o)),r>g-1?(r=g-1,t=!0,i>r&&(i=r)):i>g-1&&(i=g-1,t=!0,r>i&&(r=i)),t&&c.selectCell(n,r,o,i)}))}c.view&&c.view.adjustElementsSize()},populateFromArray:function(e,t,n,r,o,i,a){var l,s,u,f,h=[],d={},p=[],y=e.row,g=e.col;if(s=t.length,0===s)return!1;var m=0,b=0;switch(ce(n)&&(m=n.col-g+1,b=n.row-y+1),o){case"shift_down":var w=B(t),C=w.length,S=Math.max(C,m),O=c.getData().slice(y),k=B(O).slice(g,g+S);for(u=0;u<S;u+=1)if(u<C){for(l=0,s=w[u].length;l<b-s;l+=1)w[u].push(w[u][l%s]);u<k.length?p.push(w[u].concat(k[u])):p.push(w[u].concat(new Array(O.length).fill(null)))}else p.push(w[u%C].concat(k[u]));c.populateFromArray(y,g,B(p));break;case"shift_right":var R=t.length,E=Math.max(R,b),T=c.getData().slice(y).map((function(e){return e.slice(g)}));for(l=0;l<E;l+=1)if(l<R){for(u=0,f=t[l].length;u<m-f;u+=1)t[l].push(t[l][u%f]);var P;if(l<T.length)for(var M=0;M<T[l].length;M+=1)t[l].push(T[l][M]);else(P=t[l]).push.apply(P,Tk(new Array(T[0].length).fill(null)))}else t.push(t[l%s].slice(0,E).concat(T[l]));c.populateFromArray(y,g,t);break;case"overwrite":default:d.row=e.row,d.col=e.col;var A,I={row:n&&e?n.row-e.row+1:1,col:n&&e?n.col-e.col+1:1},j=0,x=0,_=!0,H=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t[e%t.length];return null!==n?r[n%r.length]:r},D=t.length,N=n?n.row-e.row+1:0;for(s=n?N:Math.max(D,N),l=0;l<s;l++){if(n&&d.row>n.row&&N>D||!v.allowInsertRow&&d.row>c.countRows()-1||d.row>=v.maxRows)break;var L=l-j,V=H(L).length,F=n?n.col-e.col+1:0;if(f=n?F:Math.max(V,F),d.col=e.col,A=c.getCellMeta(d.row,d.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!A.skipRowOnPaste){for(x=0,u=0;u<f;u++){if(n&&d.col>n.col&&F>V||!v.allowInsertColumn&&d.col>c.countCols()-1||d.col>=v.maxCols)break;if(A=c.getCellMeta(d.row,d.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!A.skipColumnOnPaste)if(A.readOnly&&"UndoRedo.undo"!==r)d.col+=1;else{var W=u-x,U=H(L,W),z=c.getDataAtCell(d.row,d.col),G={row:L,col:W};if("Autofill.fill"===r){var Y=c.runHooks("beforeAutofillInsidePopulate",G,i,t,a,{},I);Y&&(U=Je(Y.value)?U:Y.value)}if(null!==U&&"object"===Ck(U))if(Array.isArray(U)&&null===z&&(z=[]),null===z||"object"!==Ck(z))_=!1;else{var K=ne(Array.isArray(z)?z:z[0]||z),X=ne(Array.isArray(U)?U:U[0]||U);ue(K,X)||Array.isArray(K)&&Array.isArray(X)?U=ae(U):_=!1}else null!==z&&"object"===Ck(z)&&(_=!1);_&&h.push([d.row,d.col,U]),_=!0,d.col+=1}else x+=1,d.col+=1,f+=1}d.row+=1}else j+=1,d.row+=1,s+=1}c.setDataAtCell(h,null,null,r||"populateFromArray");break}}},this.init=function(){o.setData(v.data),c.runHooks("beforeInit"),(xe()||He())&&Ut(c.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new fp(this),a=Jr.getInstance(c,v,C),c.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&null===c.rootElement.offsetParent&&In(c.rootElement,(function(){c.view._wt.wtOverlays.updateLastSpreaderSize(),c.render(),c.view.adjustElementsSize()})),"object"===Ck(h)&&(c.runHooks("afterChange",h[0],h[1]),h=!1),c.runHooks("afterInit")},this._createCellCoords=function(e,t){return c.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,n){return c.view._wt.createCellRange(e,t,n)},this.validateCell=function(e,t,n,r){var o=c.getCellValidator(t);function i(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(r&&!0!==t.hidden){var o=t.visualCol,i=t.visualRow,a=c.getCell(i,o,!0);if(a&&"TH"!==a.nodeName){var l=c.rowIndexMapper.getRenderableFromVisualIndex(i),s=c.columnIndexMapper.getRenderableFromVisualIndex(o);c.view._wt.getSetting("cellRenderer",l,s,a)}n(e)}else n(e)}et(o)&&(o=function(e){return function(t,n){n(e.test(t))}}(o)),jn(o)?(e=c.runHooks("beforeValidate",e,t.visualRow,t.prop,r),c._registerImmediate((function(){o.call(t,e,(function(n){c&&(n=c.runHooks("afterValidate",n,e,t.visualRow,t.prop,r),t.valid=n,i(n),c.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,r))}))}))):c._registerImmediate((function(){t.valid=!0,i(t.valid,!1)}))},this.setDataAtCell=function(e,t,n,i){var a,l,s,u=M(e,t,n),f=[],h=i;for(a=0,l=u.length;a<l;a++){if("object"!==Ck(u[a]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof u[a][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");s=u[a][1]>=this.countCols()?u[a][1]:r.colToProp(u[a][1]),f.push([u[a][0],s,o.getAtCell(this.toPhysicalRow(u[a][0]),u[a][1]),u[a][2]])}h||"object"!==Ck(e)||(h=t),c.runHooks("afterSetDataAtCell",f,h),T(f,h,(function(){P(f,h)}))},this.setDataAtRowProp=function(e,t,n,r){var i,a,l=M(e,t,n),s=[],u=r;for(i=0,a=l.length;i<a;i++)s.push([l[i][0],l[i][1],o.getAtCell(this.toPhysicalRow(l[i][0]),l[i][1]),l[i][2]]);u||"object"!==Ck(e)||(u=t),c.runHooks("afterSetDataAtRowProp",s,u),T(s,u,(function(){P(s,u)}))},this.listen=function(){c&&!c.isListening()&&(_k=c.guid,c.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(_k=null,c.runHooks("afterUnlisten"))},this.isListening=function(){return _k===c.guid},this.destroyEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];c._refreshBorders(e,t)},this.populateFromArray=function(e,t,n,r,o,a,l,s,u){if("object"!==Ck(n)||"object"!==Ck(n[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var f="number"===typeof r?c._createCellCoords(r,o):null;return i.populateFromArray(c._createCellCoords(e,t),n,f,a,l,s,u)},this.spliceCol=function(e,t,n){for(var o,i=arguments.length,a=new Array(i>3?i-3:0),l=3;l<i;l++)a[l-3]=arguments[l];return(o=r).spliceCol.apply(o,[e,t,n].concat(a))},this.spliceRow=function(e,t,n){for(var o,i=arguments.length,a=new Array(i>3?i-3:0),l=3;l<i;l++)a[l-3]=arguments[l];return(o=r).spliceRow.apply(o,[e,t,n].concat(a))},this.getSelected=function(){if(C.isSelected())return W(C.getSelectedRange(),(function(e){var t=e.from,n=e.to;return[t.row,t.col,n.row,n.col]}))},this.getSelectedLast=function(){var e,t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(C.isSelected())return Array.from(C.getSelectedRange())},this.getSelectedRangeLast=function(){var e,t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(e){var t=this;if(C.isSelected()&&0!==this.countRows()&&0!==this.countCols()){var n=[];U(C.getSelectedRange(),(function(e){var r=e.getTopStartCorner(),o=e.getBottomEndCorner();Co(r.row,o.row,(function(e){Co(r.col,o.col,(function(r){t.getCellMeta(e,r).readOnly||n.push([e,r,null])}))}))})),n.length>0&&this.setDataAtCell(n,e)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(a.lockEditor(),this._refreshBorders(null),a.unlockEditor()))},this.batchRender=function(e){this.suspendRender();var t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();var n=e();return this.resumeExecution(t),n},this.batch=function(e){this.suspendRender(),this.suspendExecution();var t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(c.view){var e=c.view.getLastSize(),t=e.width,n=e.height,r=c.rootElement.getBoundingClientRect(),o=r.width,i=r.height,a=o!==t||i!==n,l=!1===c.runHooks("beforeRefreshDimensions",{width:t,height:n},{width:o,height:i},a);l||((a||c.view._wt.wtOverlays.scrollableElement===c.rootWindow)&&(c.view.setLastSize(o,i),c.render()),c.runHooks("afterRefreshDimensions",{width:t,height:n},{width:o,height:i},a))}},this.updateData=function(e,t){var n=this;qO(e,(function(e){r=e}),(function(e){r=e,c.columnIndexMapper.fitToLength(n.getInitialColumnCount()),c.rowIndexMapper.fitToLength(n.countSourceRows()),i.adjustRowsAndCols()}),{hotInstance:c,dataMap:r,dataSource:o,internalSource:"updateData",source:t,metaManager:y,firstRun:h})},this.loadData=function(e,t){qO(e,(function(e){r=e}),(function(){y.clearCellsCache(),c.initIndexMappers(),i.adjustRowsAndCols(),h&&(h=[null,"loadData"])}),{hotInstance:c,dataMap:r,dataSource:o,internalSource:"loadData",source:t,metaManager:y,firstRun:h})},this.getInitialColumnCount=function(){var e=v.columns,t=0;if(Array.isArray(e))t=e.length;else if(jn(e))if("array"===c.dataType)for(var n=this.countSourceCols(),o=0;o<n;o+=1)e(o)&&(t+=1);else"object"!==c.dataType&&"function"!==c.dataType||(t=r.colToPropCache.length);else if(Qe(v.dataSchema)){var i=r.getSchema();t=Array.isArray(i)?i.length:ye(i)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,n,o){return Je(e)?r.getAll():r.getRange(c._createCellCoords(e,t),c._createCellCoords(n,o),r.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,o){return r.getCopyableText(c._createCellCoords(e,t),c._createCellCoords(n,o))},this.getCopyableData=function(e,t){return r.getCopyable(e,r.colToProp(t))},this.getSchema=function(){return r.getSchema()},this.updateSettings=function(e){var t,n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=(h?c.loadData:c.updateData).bind(this),s=!1;if(Qe(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Qe(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Qe(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(t in e)"data"===t||("language"===t?O(e.language):"className"===t?k("className",e.className):"tableClassName"===t&&c.table?(k("tableClassName",e.tableClassName),c.view._wt.wtOverlays.syncOverlayTableClassNames()):hr.getSingleton().isRegistered(t)||hr.getSingleton().isDeprecated(t)?(jn(e[t])||Array.isArray(e[t]))&&(e[t].initialHook=!0,c.addHook(t,e[t])):!o&&ge(e,t)&&(g[t]=e[t]));void 0===e.data&&void 0===v.data?l(null,"updateSettings"):void 0!==e.data?l(e.data,"updateSettings"):void 0!==e.columns&&(r.createMap(),c.initIndexMappers());var u=c.countCols(),f=v.columns;if(f&&jn(f)&&(s=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||y.clearCache(),u>0)for(t=0,n=0;t<u;t++){if(f){var d=s?f(t):f[n];d&&y.updateColumnMeta(n,d)}n+=1}Qe(e.cell)&&he(e.cell,(function(e){c.setCellMetaObject(e.row,e.col,e)})),c.runHooks("afterCellMetaReset");var p=c.rootElement.style.height;""!==p&&(p=parseInt(c.rootElement.style.height,10));var m=e.height;if(jn(m)&&(m=m()),o){var b=c.rootElement.getAttribute("style");b&&c.rootElement.setAttribute("data-initialstyle",c.rootElement.getAttribute("style"))}if(null===m){var w=c.rootElement.getAttribute("data-initialstyle");w&&(w.indexOf("height")>-1||w.indexOf("overflow")>-1)?c.rootElement.setAttribute("style",w):(c.rootElement.style.height="",c.rootElement.style.overflow="")}else void 0!==m&&(c.rootElement.style.height=isNaN(m)?"".concat(m):"".concat(m,"px"),c.rootElement.style.overflow="hidden");if("undefined"!==typeof e.width){var C=e.width;jn(C)&&(C=C()),c.rootElement.style.width=isNaN(C)?"".concat(C):"".concat(C,"px")}o||(c.view&&(c.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),c.view._wt.exportSettingsAsClassNames()),c.runHooks("afterUpdateSettings",e)),i.adjustRowsAndCols(),c.view&&!h&&(c.forceFullRender=!0,a.lockEditor(),c._refreshBorders(null),c.view._wt.wtOverlays.adjustElementsSize(),a.unlockEditor()),o||!c.view||""!==p&&""!==m&&void 0!==m||p===m||c.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=c.getSelectedLast();if(v.getValue){if(jn(v.getValue))return v.getValue.call(c);if(e)return c.getData()[e[0][0]][v.getValue]}else if(e)return c.getDataAtCell(e[0],e[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,n,r,o){i.alter(e,t,n,r,o)},this.getCell=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,o=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;o=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===o||null===r?null:c.view.getCellAtCoords(c._createCellCoords(o,r),n)},this.getCoords=function(e){var t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;var n=t.row,r=t.col,o=n,i=r;return n>=0&&(o=this.rowIndexMapper.getVisualFromRenderableIndex(n)),r>=0&&(i=this.columnIndexMapper.getVisualFromRenderableIndex(r)),c._createCellCoords(o,i)},this.colToProp=function(e){return r.colToProp(e)},this.propToCol=function(e){return r.propToCol(e)},this.toVisualRow=function(e){return l.rowIndexMapper.getVisualFromPhysicalIndex(e)},this.toVisualColumn=function(e){return l.columnIndexMapper.getVisualFromPhysicalIndex(e)},this.toPhysicalRow=function(e){return l.rowIndexMapper.getPhysicalFromVisualIndex(e)},this.toPhysicalColumn=function(e){return l.columnIndexMapper.getPhysicalFromVisualIndex(e)},this.getDataAtCell=function(e,t){return r.get(e,r.colToProp(t))},this.getDataAtRowProp=function(e,t){return r.get(e,t)},this.getDataAtCol=function(e){var t;return(t=[]).concat.apply(t,Tk(r.getRange(c._createCellCoords(0,e),c._createCellCoords(v.data.length-1,e),r.DESTINATION_RENDERER)))},this.getDataAtProp=function(e){var t,n=r.getRange(c._createCellCoords(0,r.propToCol(e)),c._createCellCoords(v.data.length-1,r.propToCol(e)),r.DESTINATION_RENDERER);return(t=[]).concat.apply(t,Tk(n))},this.getSourceData=function(e,t,n,r){var i;return i=void 0===e?o.getData():o.getByRange(c._createCellCoords(e,t),c._createCellCoords(n,r)),i},this.getSourceDataArray=function(e,t,n,r){var i;return i=void 0===e?o.getData(!0):o.getByRange(c._createCellCoords(e,t),c._createCellCoords(n,r),!0),i},this.getSourceDataAtCol=function(e){return o.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,n,r){var i=M(e,t,n),a=this.hasHook("afterSetSourceDataAtCell"),l=[];a&&U(i,(function(e){var t=Ok(e,3),n=t[0],r=t[1],i=t[2];l.push([n,r,o.getAtCell(n,r),i])})),U(i,(function(e){var t=Ok(e,3),n=t[0],r=t[1],i=t[2];o.setAtCell(n,r,i)})),a&&this.runHooks("afterSetSourceDataAtCell",l,r),this.render();var s=c.getActiveEditor();s&&Qe(s.refreshValue)&&s.refreshValue()},this.getSourceDataAtRow=function(e){return o.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return o.getAtCell(e,t)},this.getDataAtRow=function(e){var t=r.getRange(c._createCellCoords(e,0),c._createCellCoords(e,this.countCols()-1),r.DESTINATION_RENDERER);return t[0]||[]},this.getDataType=function(e,t,n,r){var o=this,i=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,n,r],a=i[0],l=i[1],s=i[2],u=i[3],c=null,f=null;void 0===s&&(s=a),void 0===u&&(u=l);var h="mixed";return Co(Math.max(Math.min(a,s),0),Math.max(a,s),(function(e){var t=!0;return Co(Math.max(Math.min(l,u),0),Math.max(l,u),(function(n){var r=o.getCellMeta(e,n);return f=r.type,c?t=c===f:c=f,t})),h=t?f:"mixed",t})),h},this.removeCellMeta=function(e,t,n){var r=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],o=r[0],i=r[1],a=y.getCellMetaKeyValue(o,i,n),l=c.runHooks("beforeRemoveCellMeta",e,t,n,a);!1!==l&&(y.removeCellMeta(o,i,n),c.runHooks("afterRemoveCellMeta",e,t,n,a)),a=null},this.spliceCellsMeta=function(e){for(var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");n>0&&y.removeRow(this.toPhysicalRow(e),n),o.length>0&&U(o.reverse(),(function(n){y.createRow(t.toPhysicalRow(e)),U(n,(function(n,r){return t.setCellMetaObject(e,r,n)}))})),c.render()},this.setCellMetaObject=function(e,t,n){var r=this;"object"===Ck(n)&&he(n,(function(n,o){r.setCellMeta(e,t,o,n)}))},this.setCellMeta=function(e,t,n,r){var o=c.runHooks("beforeSetCellMeta",e,t,n,r);if(!1!==o){var i=e,a=t;e<this.countRows()&&(i=this.toPhysicalRow(e)),t<this.countCols()&&(a=this.toPhysicalColumn(t)),y.setCellMeta(i,a,n,r),c.runHooks("afterSetCellMeta",e,t,n,r)}},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(e,t){var n=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);return null===n&&(n=e),null===r&&(r=t),y.getCellMeta(n,r,{visualRow:e,visualColumn:t})},this.getCellMetaAtRow=function(e){return y.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===c.dataType||v.columns)},this.getCellRenderer=function(e,t){var n="number"===typeof e?c.getCellMeta(e,t).renderer:e.renderer;return"string"===typeof n?xi(n):Je(n)?xi("text"):n},this.getCellEditor=function(e,t){var n="number"===typeof e?c.getCellMeta(e,t).editor:e.editor;return"string"===typeof n?Mr(n):Je(n)?Mr("text"):n},this.getCellValidator=function(e,t){var n="number"===typeof e?c.getCellMeta(e,t).validator:e.validator;return"string"===typeof n?Vi(n):n},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){var r=new R;e&&(r.onQueueEmpty=e);var o=c.countRows()-1;while(o>=0)if(void 0===t||-1!==t.indexOf(o)){var i=c.countCols()-1;while(i>=0)void 0===n||-1!==n.indexOf(i)?(r.addValidatorToQueue(),c.validateCell(c.getDataAtCell(o,i),c.getCellMeta(o,i),(function(e){if("boolean"!==typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()}),"validateCells"),i-=1):i-=1;o-=1}else o-=1;r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){var t=v.rowHeaders,n=e;return void 0!==n&&(n=c.runHooks("modifyRowHeader",n)),void 0===n?(t=[],Co(c.countRows()-1,(function(e){t.push(c.getRowHeader(e))}))):Array.isArray(t)&&void 0!==t[n]?t=t[n]:jn(t)?t=t(n):t&&"string"!==typeof t&&"number"!==typeof t&&(t=n+1),t},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(void 0!==v.colHeaders&&null!==v.colHeaders)return!!v.colHeaders;for(var e=0,t=c.countCols();e<t;e++)if(c.getColHeader(e))return!0;return!1},this.getColHeader=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=c.runHooks("modifyColHeader",e);if(void 0===n){for(var r=[],o=c.countCols(),i=0;i<o;i++)r.push(c.getColHeader(i));return r}var a=v.colHeaders,l=function(e){for(var t=[],n=c.countCols(),r=0;r<n;r++)jn(v.columns)&&v.columns(r)&&t.push(r);return t[e]},s=c.toPhysicalColumn(n),u=l(s);return!1===v.colHeaders?a=null:v.columns&&jn(v.columns)&&v.columns(u)&&v.columns(u).title?a=v.columns(u).title:v.columns&&v.columns[s]&&v.columns[s].title?a=v.columns[s].title:Array.isArray(v.colHeaders)&&void 0!==v.colHeaders[s]?a=v.colHeaders[s]:jn(v.colHeaders)?a=v.colHeaders(s):v.colHeaders&&"string"!==typeof v.colHeaders&&"number"!==typeof v.colHeaders&&(a=yp(n)),a=c.runHooks("modifyColumnHeaderValue",a,e,t),a},this._getColWidthFromSettings=function(e){var t;if(e>=0){var n=c.getCellMeta(0,e);t=n.width}if(void 0!==t&&t!==v.width||(t=v.colWidths),void 0!==t&&null!==t){switch(Ck(t)){case"object":t=t[e];break;case"function":t=t(e);break;default:break}"string"===typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e){var t=c._getColWidthFromSettings(e);return t=c.runHooks("modifyColWidth",t,e),void 0===t&&(t=ud.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){var t=v.rowHeights;if(void 0!==t&&null!==t){switch(Ck(t)){case"object":t=t[e];break;case"function":t=t(e);break;default:break}"string"===typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=c._getRowHeightFromSettings(e);return t=c.runHooks("modifyRowHeight",t,e),t},this.countSourceRows=function(){return o.countRows()},this.countSourceCols=function(){return o.countFirstRowKeys()},this.countRows=function(){return r.getLength()},this.countCols=function(){var e=v.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return c.view._wt.drawn?c.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return c.view._wt.drawn?c.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return c.view._wt.drawn?c.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return c.view._wt.drawn?c.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return So(c.countRows()-1,(function(n){if(c.isEmptyRow(n))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return So(c.countCols()-1,(function(n){if(c.isEmptyCol(n))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return v.isEmptyRow.call(c,e)},this.isEmptyCol=function(e){return v.isEmptyCol.call(c,e)},this.selectCell=function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Je(e)&&!Je(t)&&this.selectCells([[e,t,n,r]],o,i)},this.selectCells=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===t&&(u=!0);var r=C.selectCells(e);return r&&n&&c.listen(),u=!1,r},this.selectColumns=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return C.selectColumns(e,t)},this.selectRows=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return C.selectRows(e,t)},this.deselectCell=function(){C.deselect()},this.selectAll=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e&&this.hasRowHeaders(),n=e&&this.hasColHeaders();u=!0,C.selectAll(t,n),u=!1};var A=function(e,t){return e.getNearestNotHiddenIndex(t,1,!0)};function I(e){return function(){throw new Error('The "'.concat(e,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.scrollViewportTo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!n,a=!r,l=e,s=t;if(o){var u=Number.isInteger(e),f=Number.isInteger(t),h=u?A(this.rowIndexMapper,e):void 0,d=f?A(this.columnIndexMapper,t):void 0;if(null===h||null===d)return!1;l=u?c.rowIndexMapper.getRenderableFromVisualIndex(h):void 0,s=f?c.columnIndexMapper.getRenderableFromVisualIndex(d):void 0}var p=Number.isInteger(l),y=Number.isInteger(s);return p&&y?c.view.scrollViewport(c._createCellCoords(l,s),i,r,n,a):p&&!1===y?c.view.scrollViewportVertically(l,i,n):!(!y||!1!==p)&&c.view.scrollViewportHorizontally(s,r,a)},this.destroy=function(){if(c._clearTimeouts(),c._clearImmediates(),c.view&&c.view.destroy(),o&&o.destroy(),o=null,this.getShortcutManager().destroy(),y.clearCache(),Bd(c)){var e=this.rootDocument.querySelector(".hot-display-license-info");e&&e.parentNode.removeChild(e)}Yt(c.rootElement),f.destroy(),a&&a.destroy(),c.batchExecution((function(){c.rowIndexMapper.unregisterAll(),c.columnIndexMapper.unregisterAll(),m.getItems().forEach((function(e){var t=Ok(e,2),n=t[1];n.destroy()})),m.clear(),c.runHooks("afterDestroy")}),!0),hr.getSingleton().destroy(c),he(c,(function(e,t,n){jn(e)?n[t]=I(t):"guid"!==t&&(n[t]=null)})),c.isDestroyed=!0,r&&r.destroy(),c.rowIndexMapper=null,c.columnIndexMapper=null,r=null,i=null,C=null,a=null,c=null},this.getActiveEditor=function(){return a.getActiveEditor()},this.getPlugin=function(e){var t=gt(e);return"UndoRedo"===t?this.undoRedo:m.getItem(t)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:m.getId(e)},this.getInstance=function(){return c},this.addHook=function(e,t){hr.getSingleton().add(e,t,c)},this.hasHook=function(e){return hr.getSingleton().has(e,c)||hr.getSingleton().has(e)},this.addHookOnce=function(e,t){hr.getSingleton().once(e,t,c)},this.removeHook=function(e,t){hr.getSingleton().remove(e,t,c)},this.runHooks=function(e,t,n,r,o,i,a){return hr.getSingleton().run(c,e,t,n,r,o,i,a)},this.getTranslatedPhrase=function(e,t){return Eb(v.language,e,t)},this.toHTML=function(){return so(l)},this.toTableElement=function(){var e=l.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",so(l)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;"function"===typeof n&&(n=setTimeout(n,t)),this.timeouts.push(n)},this._clearTimeouts=function(){U(this.timeouts,(function(e){clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){U(this.immediates,(function(e){clearImmediate(e)}))},this._refreshBorders=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];a.destroyEditor(e),c.view.render(),t&&C.isSelected()&&a.prepareEditor()},this.isRtl=function(){return"rtl"===c.rootWindow.getComputedStyle(c.rootElement).direction},this.isLtr=function(){return!c.isRtl()},this.getDirectionFactor=function(){return c.isLtr()?1:-1};var j=wk({handleEvent:function(e){var t=c.isListening(),n=void 0!==(null===e||void 0===e?void 0:e.key);return t&&n},beforeKeyDown:function(e){return l.runHooks("beforeKeyDown",e)},afterKeyDown:function(e){l.isDestroyed||c.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});this.getShortcutManager=function(){return j};var x=j.addContext("grid"),_={runOnlyIf:function(){return Qe(c.getSelected())&&c.countRenderedRows()>0&&c.countRenderedCols()>0},group:xk};j.setActiveContextName("grid"),x.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){c.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var e=c.getSelectedRange(),t=e[e.length-1].highlight,n=t.row,r=t.col,o=c.getDataAtCell(n,r),i=new Map,a=0;a<e.length;a++)e[a].forAll((function(e,t){if(e>=0&&t>=0&&(e!==n||t!==r)){var a=c.getCellMeta(e,t),l=a.readOnly;l||i.set("".concat(e,"x").concat(t),[e,t,o])}}));c.setDataAtCell(Array.from(i.values()))},runOnlyIf:function(){return c.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){C.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){C.setRangeStart(c._createCellCoords(c.rowIndexMapper.getNearestNotHiddenIndex(0,1),c.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){C.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e=c.getSelectedRangeLast(),t=e.from,n=e.to,r=c.rowIndexMapper.getNearestNotHiddenIndex(0,1);C.setRangeStart(t.clone()),C.setRangeEnd(c._createCellCoords(r,n.col))},runOnlyIf:function(){return!(c.selection.isSelectedByCorner()||c.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){C.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){C.setRangeStart(c._createCellCoords(c.rowIndexMapper.getNearestNotHiddenIndex(c.countRows()-1,-1),c.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){C.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e=c.getSelectedRangeLast(),t=e.from,n=e.to,r=c.rowIndexMapper.getNearestNotHiddenIndex(c.countRows()-1,-1);C.setRangeStart(t.clone()),C.setRangeEnd(c._createCellCoords(r,n.col))},runOnlyIf:function(){return!(c.selection.isSelectedByCorner()||c.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){C.transformStart(0,-1*c.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=c.getSelectedRangeLast().highlight.row,n=(e=c.columnIndexMapper).getNearestNotHiddenIndex.apply(e,Tk(c.isRtl()?[c.countCols()-1,-1]:[0,1]));C.setRangeStart(c._createCellCoords(t,n))}},{keys:[["ArrowLeft","Shift"]],callback:function(){C.transformEnd(0,-1*c.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=c.getSelectedRangeLast(),n=t.from,r=t.to,o=(e=c.columnIndexMapper).getNearestNotHiddenIndex.apply(e,Tk(c.isRtl()?[c.countCols()-1,-1]:[0,1]));C.setRangeStart(n.clone()),C.setRangeEnd(c._createCellCoords(r.row,o))},runOnlyIf:function(){return!(c.selection.isSelectedByCorner()||c.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){C.transformStart(0,c.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=c.getSelectedRangeLast().highlight.row,n=(e=c.columnIndexMapper).getNearestNotHiddenIndex.apply(e,Tk(c.isRtl()?[0,1]:[c.countCols()-1,-1]));C.setRangeStart(c._createCellCoords(t,n))}},{keys:[["ArrowRight","Shift"]],callback:function(){C.transformEnd(0,c.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=c.getSelectedRangeLast(),n=t.from,r=t.to,o=(e=c.columnIndexMapper).getNearestNotHiddenIndex.apply(e,Tk(c.isRtl()?[0,1]:[c.countCols()-1,-1]));C.setRangeStart(n.clone()),C.setRangeEnd(c._createCellCoords(r.row,o))},runOnlyIf:function(){return!(c.selection.isSelectedByCorner()||c.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var e=parseInt(c.getSettings().fixedColumnsStart,10),t=c.getSelectedRangeLast().highlight.row,n=c.columnIndexMapper.getNearestNotHiddenIndex(e,1);C.setRangeStart(c._createCellCoords(t,n))},runOnlyIf:function(){return c.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){C.setRangeEnd(c._createCellCoords(C.selectedRange.current().from.row,c.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var e=parseInt(c.getSettings().fixedRowsTop,10),t=parseInt(c.getSettings().fixedColumnsStart,10),n=c.rowIndexMapper.getNearestNotHiddenIndex(e,1),r=c.columnIndexMapper.getNearestNotHiddenIndex(t,1);C.setRangeStart(c._createCellCoords(n,r))},runOnlyIf:function(){return c.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){C.setRangeStart(c._createCellCoords(c.getSelectedRangeLast().highlight.row,c.columnIndexMapper.getNearestNotHiddenIndex(c.countCols()-1,-1)))},runOnlyIf:function(){return c.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){C.setRangeEnd(c._createCellCoords(C.selectedRange.current().from.row,c.columnIndexMapper.getNearestNotHiddenIndex(c.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var e=parseInt(c.getSettings().fixedRowsBottom,10),t=c.rowIndexMapper.getNearestNotHiddenIndex(c.countRows()-e-1,-1),n=c.columnIndexMapper.getNearestNotHiddenIndex(c.countCols()-1,-1);C.setRangeStart(c._createCellCoords(t,n))},runOnlyIf:function(){return c.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){C.transformStart(-c.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var e=c.getSelectedRangeLast(),t=e.to,n=Math.max(t.row-c.countVisibleRows(),0),r=c.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(null!==r){var o=c._createCellCoords(r,t.col),i=t.row-c.view.getFirstFullyVisibleRow(),a=Math.max(o.row-i,0);C.setRangeEnd(o),c.scrollViewportTo(a)}}},{keys:[["PageDown"]],callback:function(){C.transformStart(c.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var e=c.getSelectedRangeLast(),t=e.to,n=Math.min(t.row+c.countVisibleRows(),c.countRows()-1),r=c.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(null!==r){var o=c._createCellCoords(r,t.col),i=t.row-c.view.getFirstFullyVisibleRow(),a=Math.min(o.row-i,c.countRows()-1);C.setRangeEnd(o),c.scrollViewportTo(a)}}},{keys:[["Tab"]],callback:function(e){var t="function"===typeof v.tabMoves?v.tabMoves(e):v.tabMoves;C.transformStart(t.row,t.col,!0)}},{keys:[["Shift","Tab"]],callback:function(e){var t="function"===typeof v.tabMoves?v.tabMoves(e):v.tabMoves;C.transformStart(-t.row,-t.col)}}],_),Si().forEach((function(e){var t=Oi(e);m.addItem(e,new t(l))})),hr.getSingleton().run(c,"construct")}var Nk="hooksRefRegisterer",Lk={_hooksStorage:Object.create(null),addHook:function(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey:function(e){var t=this;U(this._hooksStorage[e]||[],(function(n){t.hot.removeHook(e,n)}))},clearHooks:function(){var e=this;he(this._hooksStorage,(function(t,n){return e.removeHooksByKey(n)})),this._hooksStorage={}}};fe(Lk,"MIXIN_NAME",Nk,{writable:!1,enumerable:!1});var Bk=Lk;function Vk(e){return Vk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vk(e)}function Fk(e,t){return Yk(e)||Gk(e,t)||Uk(e,t)||Wk()}function Wk(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Uk(e,t){if(e){if("string"===typeof e)return zk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zk(e,t):void 0}}function zk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Gk(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Yk(e){if(Array.isArray(e))return e}function Kk(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xk(e,t)}function Xk(e,t){return Xk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Xk(e,t)}function $k(e){var t=Jk();return function(){var n,r=Zk(e);if(t){var o=Zk(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qk(this,n)}}function qk(e,t){if(t&&("object"===Vk(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Qk(e)}function Qk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jk(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Zk(e){return Zk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Zk(e)}function eR(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nR(e,t,n){return t&&tR(e.prototype,t),n&&tR(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var rR="base",oR=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),iR="baseEditor",aR=function(){function e(t){eR(this,e),this.hot=t,this.instance=t,this.state=oR.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return nR(e,[{key:"_fireCallbacks",value:function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(e,t,n,r,o,i){this.TD=r,this.row=e,this.col=t,this.prop=n,this.originalValue=o,this.cellProperties=i,this.state=oR.VIRGIN}},{key:"extend",value:function(){return function(e){Kk(n,e);var t=$k(n);function n(){return eR(this,n),t.apply(this,arguments)}return nR(n)}(this.constructor)}},{key:"saveValue",value:function(e,t){var n,r,o,i,a=this;if(t){var l=this.hot.getSelectedLast();n=Math.max(Math.min(l[0],l[2]),0),r=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),i=Math.max(l[1],l[3])}else{var s=[this.row,this.col,null,null];n=s[0],r=s[1],o=s[2],i=s[3]}var u=this.hot.runHooks("modifyGetCellCoords",n,r);if(Array.isArray(u)){var c=Fk(u,2);n=c[0],r=c[1]}var f=this.hot.getShortcutManager(),h=f.getContext("editor"),d={runOnlyIf:function(){return Qe(a.hot.getSelected())},group:iR};this.isInFullEditMode()&&h.addShortcuts([{keys:[["ArrowUp"]],callback:function(){a.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){a.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){a.hot.selection.transformStart(0,-1*a.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){a.hot.selection.transformStart(0,a.hot.getDirectionFactor())}}],d),this.hot.populateFromArray(n,r,e,o,i,"edit")}},{key:"beginEditing",value:function(e,t){if(this.state===oR.VIRGIN){var n=this.hot,r=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(r,o)),this.state=oR.EDITING,this.isInFullEditMode()){var i="string"===typeof e?e:qe(this.originalValue);this.setValue(i)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(e,t,n){var r,o=this;if(n){var i=this._closeCallback;this._closeCallback=function(e){i&&i(e),n(e),o.hot.view.render()}}if(!this.isWaiting()){var a=this.hot.getShortcutManager(),l=a.getContext("editor");if(l.removeShortcutsByGroup(iR),l.removeShortcutsByGroup(Xr),this.state!==oR.VIRGIN){if(this.state===oR.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();var s=this.getValue();r=this.cellProperties.trimWhitespace?[["string"===typeof s?String.prototype.trim.call(s||""):s]]:[[s]],this.state=oR.WAITING,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(e){o.state=oR.FINISHED,o.discardEditor(e)})):(this.state=oR.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){o._fireCallbacks(!0)}))}}},{key:"cancelChanges",value:function(){this.state=oR.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(e){if(this.state===oR.FINISHED)if(!1===e&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=oR.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=oR.VIRGIN,this._fireCallbacks(!0);var t=this.hot.getShortcutManager();t.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===oR.WAITING}},{key:"getEditedCellRect",value:function(){var e,t=this.getEditedCell();if(t){var n=this.hot.view._wt,r=n.wtOverlays,o=n.wtViewport,i=this.hot.rootWindow,a=Jt(t),l=un(t),s=Jt(this.hot.rootElement),u=un(this.hot.rootElement),c=r.topOverlay.holder,f=r.inlineStartOverlay.holder,h=c!==i?c.scrollTop:0,d=f!==i?f.scrollLeft:0,p=i.innerWidth-s.left-u,y=null!==(e=r.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt,v=y.wtTable,g=v.name,m=["master","inline_start"].includes(g)?h:0,b=["master","top","bottom"].includes(g)?d:0,w=a.top===s.top?0:1,C=a.top-s.top-w-m,S=0;S=this.hot.isRtl()?i.innerWidth-a.left-l-p-1+b:a.left-s.left-1-b,["top","top_inline_start_corner"].includes(g)&&(C+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(g)&&(S+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));var O=this.hot.hasColHeaders(),k=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),E=this.hot.rowIndexMapper.getRenderableIndexesLength(),T=E-this.hot.view._wt.getSetting("fixedRowsBottom");(O&&k<=0||k===T)&&(C+=1),R<=0&&(S+=1);var P=o.rowsRenderCalculator.startPosition,M=o.columnsRenderCalculator.startPosition,A=Math.abs(r.inlineStartOverlay.getScrollPosition()),I=r.topOverlay.getScrollPosition(),j=Cn(this.hot.rootDocument),x=t.offsetTop+P-I,_=0;if(this.hot.isRtl()){var H=t.offsetLeft;_=H>=0?v.getWidth()-t.offsetLeft:Math.abs(H),_+=M-A-l}else _=t.offsetLeft+M-A;var D=sn(this.TD,this.hot.rootWindow),N=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",L=parseInt(D[N],10)>0?0:1,B=parseInt(D.borderTopWidth,10)>0?0:1,V=un(t)+L,F=cn(t)+B,W=Sn(c)?j:0,U=On(f)?j:0,z=this.hot.view.maximumVisibleElementWidth(_)-W+L,G=Math.max(this.hot.view.maximumVisibleElementHeight(x)-U+B,23);return{top:C,start:S,height:F,maxHeight:G,width:V,maxWidth:z}}}},{key:"getEditedCellsLayerClass",value:function(){var e=this.checkEditorSection();switch(e){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var e=this.hot.countRows(),t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}],[{key:"EDITOR_TYPE",get:function(){return rR}}]),e}();function lR(){var e,t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=document.body,r=document.createTextNode(""),o=document.createElement("SPAN"),i=function(e,t,n){e.addEventListener(t,n,!1)},a=function(e,t,n){e.removeEventListener(t,n,!1)},l=function(i){var a,l;i?/^[a-zA-Z \.,\\\/\|0-9]$/.test(i)||(i="."):i="",void 0!==r.textContent?r.textContent=e.value+i:r.data=e.value+i,o.style.position="absolute",o.style.fontSize=f(e).fontSize,o.style.fontFamily=f(e).fontFamily,o.style.whiteSpace="pre",n.appendChild(o),a=o.clientWidth+2,n.removeChild(o),e.style.height=t.minHeight+"px",t.minWidth>a?e.style.width=t.minWidth+"px":a>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=a+"px",l=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>l?e.style.height=t.minHeight+"px":t.maxHeight<l?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=l+"px"},s=function(){window.setTimeout(l,0)},u=function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)t.minHeight=e.clientHeight;else{var i=parseInt(n.minHeight);isNaN(i)||(t.minHeight=i)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)t.maxHeight=e.clientHeight;else{var a=parseInt(n.maxHeight);isNaN(a)||(t.maxHeight=a)}if(n&&n.minWidth)if("inherit"==n.minWidth)t.minWidth=e.clientWidth;else{var l=parseInt(n.minWidth);isNaN(l)||(t.minWidth=l)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)t.maxWidth=e.clientWidth;else{var s=parseInt(n.maxWidth);isNaN(s)||(t.maxWidth=s)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))},c=function(n,r,o){e=n,u(r),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),o&&(i(e,"change",l),i(e,"cut",s),i(e,"paste",s),i(e,"drop",s),i(e,"keydown",s),i(e,"focus",l),i(e,"compositionstart",s),i(e,"compositionupdate",s),i(e,"compositionend",s)),l()};function f(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}return{init:function(e,t,n){c(e,t,n)},unObserve:function(){a(e,"change",l),a(e,"cut",s),a(e,"paste",s),a(e,"drop",s),a(e,"keydown",s),a(e,"focus",l),a(e,"compositionstart",s),a(e,"compositionupdate",s),a(e,"compositionend",s)},resize:l}}function sR(e,t){for(var n=yn(t),r=t.value.split("\n"),o=n,i=0,a=0;a<r.length;a++){var l=r[a];0!==a&&(i+=r[a-1].length+1);var s=i+l.length;if("home"===e?o=i:"end"===e&&(o=s),n<=s)break}bn(t,o)}function uR(e){return uR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uR(e)}function cR(e,t){return yR(e)||pR(e,t)||hR(e,t)||fR()}function fR(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function hR(e,t){if(e){if("string"===typeof e)return dR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dR(e,t):void 0}}function dR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pR(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function yR(e){if(Array.isArray(e))return e}function vR(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mR(e,t,n){return t&&gR(e.prototype,t),n&&gR(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function bR(){return bR="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=wR(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},bR.apply(this,arguments)}function wR(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=TR(e),null===e)break;return e}function CR(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SR(e,t)}function SR(e,t){return SR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},SR(e,t)}function OR(e){var t=ER();return function(){var n,r=TR(e);if(t){var o=TR(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kR(this,n)}}function kR(e,t){if(t&&("object"===uR(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return RR(e)}function RR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ER(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function TR(e){return TR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},TR(e)}se(aR,Bk);var PR="ht_editor_visible",MR="ht_editor_hidden",AR="textEditor",IR="text",jR=function(e){CR(n,e);var t=OR(n);function n(e){var r;return vR(this,n),r=t.call(this,e),r.eventManager=new Nr(RR(r)),r.autoResize=lR(),r.TEXTAREA=void 0,r.textareaStyle=void 0,r.TEXTAREA_PARENT=void 0,r.textareaParentStyle=void 0,r.layerClass=void 0,r.createElements(),r.bindEvents(),r.hot.addHookOnce("afterDestroy",(function(){return r.destroy()})),r}return mR(n,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(e){this.TEXTAREA.value=e}},{key:"open",value:function(){var e=this;this.refreshDimensions(),this.showEditableElement();var t=this.hot.getShortcutManager();t.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",(function(t){return e.onAfterDocumentKeyDown(t)})),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(e,t,r,o,i,a){var l=this.state;if(bR(TR(n.prototype),"prepare",this).call(this,e,t,r,o,i,a),!a.readOnly){this.refreshDimensions(!0);var s=a.allowInvalid,u=a.fragmentSelection;s&&(this.TEXTAREA.value=""),l!==oR.FINISHED&&this.hideEditableElement();var c=!u;c&&!xe()&&this.focus()}}},{key:"beginEditing",value:function(e,t){this.state===oR.VIRGIN&&(this.TEXTAREA.value="",bR(TR(n.prototype),"beginEditing",this).call(this,e,t))}},{key:"focus",value:function(){this.TEXTAREA.select(),bn(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var e=this.hot.rootDocument;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Ut(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Ut(this.TEXTAREA_PARENT,"handsontableInputHolder"),Wt(this.TEXTAREA_PARENT,this.layerClass)&&zt(this.TEXTAREA_PARENT,this.layerClass),Ut(this.TEXTAREA_PARENT,MR),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(Ae()||Pe())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",zt(this.TEXTAREA_PARENT,this.layerClass),Ut(this.TEXTAREA_PARENT,MR)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var e=this.TEXTAREA_PARENT.childNodes,t=!1;Co(e.length-1,(function(n){var r=e[n];if(Wt(r,"handsontableEditor"))return t=!0,!1})),Wt(this.TEXTAREA_PARENT,MR)&&zt(this.TEXTAREA_PARENT,MR),t?(this.layerClass=PR,Ut(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Ut(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===oR.EDITING||e)if(this.TD=this.getEditedCell(),this.TD){var t=this.getEditedCellRect(),n=t.top,r=t.start,o=t.width,i=t.maxWidth,a=t.height,l=t.maxHeight;this.textareaParentStyle.top="".concat(n,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(r,"px"),this.showEditableElement();var s=sn(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=s.fontSize,this.TEXTAREA.style.fontFamily=s.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var u=sn(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),f=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),h=o-c,d=a-f,p=i-c,y=l-f;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(h,p),minHeight:Math.min(d,y),maxWidth:p,maxHeight:y},!0)}else e||this.close()}},{key:"bindEvents",value:function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",(function(e){return e.stopPropagation()})),this.eventManager.addEventListener(this.TEXTAREA,"paste",(function(e){return e.stopPropagation()})),_e()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(function(){return e.finishEditing(!1)})),this.addHook("afterScrollHorizontally",(function(){return e.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return e.refreshDimensions()})),this.addHook("afterColumnResize",(function(){e.refreshDimensions(),e.focus()})),this.addHook("afterRowResize",(function(){e.refreshDimensions(),e.focus()}))}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager(),n=t.getContext("editor"),r={runOnlyIf:function(){return Qe(e.hot.getSelected())},group:AR},o=function(){e.hot.rootDocument.execCommand("insertText",!1,"\n")};n.addShortcuts([{keys:[["Tab"]],callback:function(t){var n=e.hot.getSettings(),r="function"===typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.hot.selection.transformStart(r.row,r.col,!0)}},{keys:[["Shift","Tab"]],callback:function(t){var n=e.hot.getSettings(),r="function"===typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.hot.selection.transformStart(-r.row,-r.col)}},{keys:[["Control","Enter"]],callback:function(){return o(),!1},runOnlyIf:function(t){return!e.hot.selection.isMultiple()&&!t.altKey},relativeToGroup:$r,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return o(),!1},runOnlyIf:function(){return!e.hot.selection.isMultiple()},relativeToGroup:$r,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return o(),!1},relativeToGroup:$r,position:"before"},{keys:[["PageUp"]],callback:function(){e.hot.selection.transformStart(-e.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){e.hot.selection.transformStart(e.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(t,n){var r=cR(n,1),o=r[0];sR(o,e.TEXTAREA)}},{keys:[["End"]],callback:function(t,n){var r=cR(n,1),o=r[0];sR(o,e.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){e.hot._registerTimeout((function(){e.autoResize.resize()}),10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){e.hot._registerTimeout((function(){e.autoResize.resize()}),10)}}],r)}},{key:"unregisterShortcuts",value:function(){var e=this.hot.getShortcutManager(),t=e.getContext("editor");t.removeShortcutsByGroup(Xr),t.removeShortcutsByGroup(AR),t.removeShortcutsByGroup(iR)}},{key:"onAfterDocumentKeyDown",value:function(e){var t=[zn.ARROW_UP,zn.ARROW_RIGHT,zn.ARROW_DOWN,zn.ARROW_LEFT];-1===t.indexOf(e.keyCode)&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return IR}}]),n}(aR),xR="base";function _R(e,t,n,r,o,i,a){var l=[],s=[];a.className&&Ut(t,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),!1===a.valid&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),!1===a.wordWrap&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!i&&a.placeholder&&l.push(a.placeholderCellClassName),zt(t,s),Ut(t,l)}_R.RENDERER_TYPE=xR;var HR="text";function DR(e,t,n,r,o,i,a){_R.apply(this,[e,t,n,r,o,i,a]);var l=i;if(!l&&a.placeholder&&(l=a.placeholder),l=qe(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){Yt(t);var s=e.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=e.getSourceDataAtRow(n),t.appendChild(s)}else qt(t,l)}DR.RENDERER_TYPE=HR;var NR="text",LR={CELL_TYPE:NR,editor:jR,renderer:DR};function BR(e,t){var n=new Dk(e,t||{},Dd);return n.init(),n}PS(LR),BR.editors={BaseEditor:aR},BR.Core=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Dk(e,t,Dd)},BR.DefaultSettings=DS(),BR.hooks=hr.getSingleton(),BR.CellCoords=gu,BR.CellRange=Iu,BR.packageName="handsontable",BR.buildDate="20/12/2022 01:38:46",BR.version="12.3.0",BR.languages={dictionaryKeys:v,getLanguageDictionary:Ob,getLanguagesDictionaries:Rb,registerLanguageDictionary:Cb,getTranslatedPhrase:Eb};var VR=BR,FR=n("216e");function WR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function UR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?WR(Object(n),!0).forEach((function(t){XR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WR(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zR(e){return zR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zR(e)}function GR(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YR(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function KR(e,t,n){return t&&YR(e.prototype,t),n&&YR(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function XR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $R(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QR(e,t)}function qR(e){return qR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qR(e)}function QR(e,t){return QR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},QR(e,t)}function JR(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ZR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eE(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ZR(e)}function tE(e){var t=JR();return function(){var n,r=qR(e);if(t){var o=qR(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return eE(this,n)}}var nE=Symbol("unassigned"),rE=null,oE="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function iE(e){e.hotInstance&&(e.hotInstance.addHook("beforeChange",(function(){e.__internalEdit=!0})),e.hotInstance.addHook("beforeCreateRow",(function(){e.__internalEdit=!0})),e.hotInstance.addHook("beforeCreateCol",(function(){e.__internalEdit=!0})),e.hotInstance.addHook("beforeRemoveRow",(function(){e.__internalEdit=!0})),e.hotInstance.addHook("beforeRemoveCol",(function(){e.__internalEdit=!0})))}function aE(e){var t=VR.hooks.getRegistered(),n={};for(var r in Object.assign(n,VR.DefaultSettings),n)n[r]={default:nE};for(var o=0;o<t.length;o++)n[t[o]]={default:nE};return n.settings={default:nE},"HotTable"===e&&(n.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},n.wrapperRendererCacheSize={type:Number,default:3e3}),n}function lE(e){var t={},n=e["settings"];if(n!==nE)for(var r in n)n.hasOwnProperty(r)&&n[r]!==nE&&(t[r]=n[r]);for(var o in e)e.hasOwnProperty(o)&&"settings"!==o&&e[o]!==nE&&(t[o]=e[o]);return t}function sE(e,t){var n=lE(e),r=e.settings?e.settings:n,o=e.settings?n:null,i={};for(var a in r)!r.hasOwnProperty(a)||void 0===r[a]||t&&"data"!==a&&hE(t[a],r[a])||(i[a]=r[a]);for(var l in o)!o.hasOwnProperty(l)||"id"===l||"settings"===l||"wrapperRendererCacheSize"===l||void 0===o[l]||t&&"data"!==l&&hE(t[l],o[l])||(i[l]=o[l]);return i}function uE(e,t){var n=null;return e.every((function(e,r){return!e.data||!e.data.attrs||void 0===e.data.attrs[t]||(n=e,!1)})),n}function cE(e){return e.filter((function(e){return"HotColumn"===e.$options.name}))}function fE(e,t,n,r){var o=t.$el?t.$el.ownerDocument:document,i={propsData:n,parent:t,data:r};rE||(rE=o.createElement("DIV"),rE.id="vueHotComponents",o.body.appendChild(rE));var a=o.createElement("DIV");return rE.appendChild(a),new e.componentOptions.Ctor(i).$mount(a)}function hE(e,t){return JSON.stringify(e)===JSON.stringify(t)}var dE="12.3.0";"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self&&self;function pE(e,t){return t={exports:{}},e(t,t.exports),t.exports}var yE=pE((function(e,t){(function(e,n){var r=t;n(r)})(0,(function(e){var t=Symbol("newer"),n=Symbol("older");function r(e,t){"number"!==typeof e&&(t=e,e=0),this.size=0,this.limit=e,this.oldest=this.newest=void 0,this._keymap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}function o(e,r){this.key=e,this.value=r,this[t]=void 0,this[n]=void 0}e.LRUMap=r,r.prototype._markEntryAsUsed=function(e){e!==this.newest&&(e[t]&&(e===this.oldest&&(this.oldest=e[t]),e[t][n]=e[n]),e[n]&&(e[n][t]=e[t]),e[t]=void 0,e[n]=this.newest,this.newest&&(this.newest[t]=e),this.newest=e)},r.prototype.assign=function(e){var r,i=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var a=e[Symbol.iterator](),l=a.next();!l.done;l=a.next()){var s=new o(l.value[0],l.value[1]);if(this._keymap.set(s.key,s),r?(r[t]=s,s[n]=r):this.oldest=s,r=s,0==i--)throw new Error("overflow")}this.newest=r,this.size=this._keymap.size},r.prototype.get=function(e){var t=this._keymap.get(e);if(t)return this._markEntryAsUsed(t),t.value},r.prototype.set=function(e,r){var i=this._keymap.get(e);return i?(i.value=r,this._markEntryAsUsed(i),this):(this._keymap.set(e,i=new o(e,r)),this.newest?(this.newest[t]=i,i[n]=this.newest):this.oldest=i,this.newest=i,++this.size,this.size>this.limit&&this.shift(),this)},r.prototype.shift=function(){var e=this.oldest;if(e)return this.oldest[t]?(this.oldest=this.oldest[t],this.oldest[n]=void 0):(this.oldest=void 0,this.newest=void 0),e[t]=e[n]=void 0,this._keymap["delete"](e.key),--this.size,[e.key,e.value]},r.prototype.has=function(e){return this._keymap.has(e)}}))})),vE=yE.LRUMap,gE={name:"HotTable",props:aE("HotTable"),watch:{mergedHotSettings:function(e){this.hotInstance&&void 0!==e&&(e.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete e.data),Object.keys(e).length?this.hotInstance.updateSettings(e):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var e=this,t=new vE(this.wrapperRendererCacheSize);return t.shift=function(){var e=vE.prototype.shift.call(this);return e[1].component.$destroy(),e},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:t,editorCache:new Map,get hotInstance(){return!e.__hotInstance||e.__hotInstance&&!e.__hotInstance.isDestroyed?e.__hotInstance:(console.warn(oE),null)},set hotInstance(t){e.__hotInstance=t}}},computed:{mergedHotSettings:function(){return sE(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var e=this.getGlobalRendererVNode(),t=this.getGlobalEditorVNode(),n=sE(this.$props);n.columns=this.columnSettings?this.columnSettings:n.columns,t&&(n.editor=this.getEditorClass(t,this),t.child.$destroy()),e&&(n.renderer=this.getRendererWrapper(e,this),e.child.$destroy()),this.hotInstance=new VR.Core(this.$el,n),this.hotInstance.init(),iE(this),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var t,n=this.hotInstance.getSourceData(),r=[],o=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(n&&n.length!==i&&n.length<i)for(var s=n.length;s<i;s++)r.push(s);if(a)if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&(null===(t=n[0])||void 0===t?void 0:t.length)!==l&&n[0].length<l)for(var u=n[0].length;u<l;u++)o.push(u);this.hotInstance.batch((function(){r.length>0?e.hotInstance.rowIndexMapper.removeIndexes(r):e.hotInstance.rowIndexMapper.insertIndexes(i-1,n.length-i),a&&0!==n.length&&(o.length>0?e.hotInstance.columnIndexMapper.removeIndexes(o):e.hotInstance.columnIndexMapper.insertIndexes(l-1,n[0].length-l))}))}},getGlobalRendererVNode:function(){var e=this.$slots["default"]||[];return uE(e,"hot-renderer")},getGlobalEditorVNode:function(){var e=this.$slots["default"]||[];return uE(e,"hot-editor")},getColumnSettings:function(){var e=cE(this.$children),t=!1,n=e.map((function(e){return e.usesRendererComponent&&(t=!0),UR({},e.columnSettings)}));return t&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),n.length?n:void 0},getRendererWrapper:function(e,t){var n=this;return function(r,o,i,a,l,s,u){if(o&&!o.getAttribute("ghost-table")){var c=n.rendererCache,f={hotInstance:r,TD:o,row:i,col:a,prop:l,value:s,cellProperties:u,isRenderer:!0};if(c&&!c.has("".concat(i,"-").concat(a))){var h=fE(e,t,e.componentOptions.propsData,f);c.set("".concat(i,"-").concat(a),{component:h,lastUsedTD:null})}var d=c.get("".concat(i,"-").concat(a)),p=d.component,y=d.lastUsedTD;if(Object.assign(p.$data,f),!p.$el.parentElement||y!==o){while(o.firstChild)o.removeChild(o.firstChild);o.appendChild(p.$el),d.lastUsedTD=o}}return o}},getEditorClass:function(e,t){var n=e.key?e.key.toString():null,r=e.componentOptions.Ctor.options.name,o=n?"".concat(r,":").concat(n):r,i=this.editorCache,a=null;return i.has(o)?a=i.get(o):(a=fE(e,t,e.componentOptions.propsData,{isEditor:!0}),i.set(o,a)),a.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:dE};function mE(e,t,n,r,o,i,a,l,s,u){"boolean"!==typeof a&&(s=l,l=a,a=!1);const c="function"===typeof n?n.options:n;let f;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,o&&(c.functional=!0)),r&&(c._scopeId=r),i?(f=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,s(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},c._ssrRegister=f):t&&(f=a?function(e){t.call(this,u(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,l(e))}),f)if(c.functional){const e=c.render;c.render=function(t,n){return f.call(n),e(t,n)}}else{const e=c.beforeCreate;c.beforeCreate=e?[].concat(e,f):[f]}return n}var bE=gE,wE=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:e.id}},[e._t("default")],2)},CE=[],SE=void 0,OE=void 0,kE=void 0,RE=!1,EE=mE({render:wE,staticRenderFns:CE},SE,bE,OE,RE,kE,!1,void 0,void 0,void 0);aE("HotColumn");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function TE(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function PE(e){return PE="function"===typeof Symbol&&"symbol"===zR(Symbol.iterator)?function(e){return zR(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":zR(e)},PE(e)}function ME(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AE(e){return IE(e)||jE(e)||xE()}function IE(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function jE(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function xE(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _E(){return"undefined"!==typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function HE(e,t){DE(e,t),Object.getOwnPropertyNames(t.prototype).forEach((function(n){DE(e.prototype,t.prototype,n)})),Object.getOwnPropertyNames(t).forEach((function(n){DE(e,t,n)}))}function DE(e,t,n){var r=n?Reflect.getOwnMetadataKeys(t,n):Reflect.getOwnMetadataKeys(t);r.forEach((function(r){var o=n?Reflect.getOwnMetadata(r,t,n):Reflect.getOwnMetadata(r,t);n?Reflect.defineMetadata(r,o,e,n):Reflect.defineMetadata(r,o,e)}))}var NE={__proto__:[]},LE=NE instanceof Array;function BE(e){var t=PE(e);return null==e||"object"!==t&&"function"!==t}function VE(e,t){var n=t.prototype._init;t.prototype._init=function(){var t=this,n=Object.getOwnPropertyNames(e);if(e.$options.props)for(var r in e.$options.props)e.hasOwnProperty(r)||n.push(r);n.forEach((function(n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){e[n]=t},configurable:!0})}))};var r=new t;t.prototype._init=n;var o={};return Object.keys(r).forEach((function(e){void 0!==r[e]&&(o[e]=r[e])})),o}var FE=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function WE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.name=t.name||e._componentTag||e.name;var n=e.prototype;Object.getOwnPropertyNames(n).forEach((function(e){if("constructor"!==e)if(FE.indexOf(e)>-1)t[e]=n[e];else{var r=Object.getOwnPropertyDescriptor(n,e);void 0!==r.value?"function"===typeof r.value?(t.methods||(t.methods={}))[e]=r.value:(t.mixins||(t.mixins=[])).push({data:function(){return ME({},e,r.value)}}):(r.get||r.set)&&((t.computed||(t.computed={}))[e]={get:r.get,set:r.set})}})),(t.mixins||(t.mixins=[])).push({data:function(){return VE(this,e)}});var r=e.__decorators__;r&&(r.forEach((function(e){return e(t)})),delete e.__decorators__);var o=Object.getPrototypeOf(e.prototype),i=o instanceof FR["a"]?o.constructor:FR["a"],a=i.extend(t);return zE(a,e,i),_E()&&HE(a,e),a}var UE={prototype:!0,arguments:!0,callee:!0,caller:!0};function zE(e,t,n){Object.getOwnPropertyNames(t).forEach((function(r){if(!UE[r]){var o=Object.getOwnPropertyDescriptor(e,r);if(!o||o.configurable){var i=Object.getOwnPropertyDescriptor(t,r);if(!LE){if("cid"===r)return;var a=Object.getOwnPropertyDescriptor(n,r);if(!BE(i.value)&&a&&a.value===i.value)return}Object.defineProperty(e,r,i)}}}))}function GE(e){return"function"===typeof e?WE(e):function(t){return WE(t,e)}}GE.registerHooks=function(e){FE.push.apply(FE,AE(e))};var YE=function(e){$R(n,e);var t=tE(n);function n(){var e;return GR(this,n),e=t.apply(this,arguments),e.name="BaseEditorComponent",e.instance=null,e.row=null,e.col=null,e.prop=null,e.TD=null,e.originalValue=null,e.cellProperties=null,e.state=null,e.hot=null,e}return KR(n,[{key:"mounted",value:function(){var e=this;this.$data.hotCustomEditorClass=function(){var t=function(t){$R(r,t);var n=tE(r);function r(t){var o;return GR(this,r),o=n.call(this,t),e.$data.hotCustomEditorInstance=ZR(o),o}return KR(r,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),r}(VR.editors.BaseEditor);return Object.getOwnPropertyNames(VR.editors.BaseEditor.prototype).forEach((function(n){"constructor"!==n&&(t.prototype[n]=function(){for(var t,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(t=e[n]).call.apply(t,[this].concat(o))})})),t}()}},{key:"_fireCallbacks",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=VR.editors.BaseEditor.prototype._fireCallbacks).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"beginEditing",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.beginEditing).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"cancelChanges",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.cancelChanges).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"checkEditorSection",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.checkEditorSection).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"close",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.close).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"discardEditor",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.discardEditor).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"enableFullEditMode",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.enableFullEditMode).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"extend",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.extend).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"finishEditing",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.finishEditing).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"focus",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.focus).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getValue",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.getValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"init",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.init).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isInFullEditMode",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.isInFullEditMode).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isOpened",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.isOpened).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isWaiting",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.isWaiting).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"open",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.open).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"prepare",value:function(e,t,n,r,o,i){return this.$data.hotInstance=i.instance,this.$data.row=e,this.$data.col=t,this.$data.prop=n,this.$data.TD=r,this.$data.originalValue=o,this.$data.cellProperties=i,VR.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,e,t,n,r,o,i)}},{key:"saveValue",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.saveValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"setValue",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.setValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"addHook",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.addHook).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"removeHooksByKey",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.removeHooksByKey).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"clearHooks",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.clearHooks).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCell",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.getEditedCell).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellRect",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.getEditedCellRect).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsZIndex",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsLayerClass",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=VR.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}}]),n}(FR["a"]);YE=TE([GE({})],YE);n("cbfe");var KE=[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]],XE="selected",$E="odd";function qE(){return KE}n("add1");function QE(e){return QE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},QE(e)}function JE(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eT(e,t,n){return t&&ZE(e.prototype,t),n&&ZE(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function tT(){return tT="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=nT(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},tT.apply(this,arguments)}function nT(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=uT(e),null===e)break;return e}function rT(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oT(e,t)}function oT(e,t){return oT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},oT(e,t)}function iT(e){var t=sT();return function(){var n,r=uT(e);if(t){var o=uT(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return aT(this,n)}}function aT(e,t){if(t&&("object"===QE(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return lT(e)}function lT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sT(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function uT(e){return uT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},uT(e)}var cT="handsontableEditor",fT="handsontable",hT=function(e){rT(n,e);var t=iT(n);function n(){return JE(this,n),t.apply(this,arguments)}return eT(n,[{key:"open",value:function(){tT(uT(n.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),bn(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),tT(uT(n.prototype),"close",this).call(this)}},{key:"prepare",value:function(e,t,r,o,i,a){tT(uT(n.prototype),"prepare",this).call(this,e,t,r,o,i,a);var l=this,s={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(e,t){var n=this.getSourceData(t.row,t.col);void 0!==n&&l.setValue(n),l.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&oe(s,a.handsontable),this.htOptions=s}},{key:"beginEditing",value:function(e,t){var r=this.hot.getSettings().onBeginEditing;r&&!1===r()||tT(uT(n.prototype),"beginEditing",this).call(this,e,t)}},{key:"createElements",value:function(){tT(uT(n.prototype),"createElements",this).call(this);var e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}},{key:"finishEditing",value:function(e,t,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var o=this.htEditor.getInstance().getValue();void 0!==o&&this.setValue(o)}tT(uT(n.prototype),"finishEditing",this).call(this,e,t,r)}},{key:"assignHooks",value:function(){var e=this;this.hot.addHook("afterDestroy",(function(){e.htEditor&&e.htEditor.destroy()}))}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager(),r=t.getContext("editor");tT(uT(n.prototype),"registerShortcuts",this).call(this);var o={group:cT,relativeToGroup:Xr,position:"before"},i=function(t,n){var r=e.htEditor.getInstance();if(void 0!==t&&(t<0||r.flipped&&t>r.countRows()-1?r.deselectCell():r.selectCell(t,0),r.getData().length))return n.preventDefault(),Qn(n),e.hot.listen(),e.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:function(t){var n,r,o=e.htEditor.getInstance();return!o.getSelectedLast()&&o.flipped?n=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(r=o.getSelectedLast()[0],n=Math.max(0,r-1)):(r=o.getSelectedLast()[0],n=r-1)),i(n,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(t){var n,r,o=e.htEditor.getInstance();if(o.getSelectedLast()||o.flipped){if(o.getSelectedLast())if(o.flipped)n=o.getSelectedLast()[0]+1;else if(!o.flipped){var a=o.countRows()-1;r=o.getSelectedLast()[0],n=Math.min(a,r+1)}}else n=0;return i(n,t)},preventDefault:!1}],o)}},{key:"unregisterShortcuts",value:function(){tT(uT(n.prototype),"unregisterShortcuts",this).call(this);var e=this.hot.getShortcutManager(),t=e.getContext("editor");t.removeShortcutsByGroup(cT)}}],[{key:"EDITOR_TYPE",get:function(){return fT}}]),n}(jR);function dT(e){return dT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dT(e)}function pT(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vT(e,t,n){return t&&yT(e.prototype,t),n&&yT(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function gT(){return gT="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=mT(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},gT.apply(this,arguments)}function mT(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=RT(e),null===e)break;return e}function bT(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wT(e,t)}function wT(e,t){return wT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},wT(e,t)}function CT(e){var t=kT();return function(){var n,r=RT(e);if(t){var o=RT(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ST(this,n)}}function ST(e,t){if(t&&("object"===dT(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return OT(e)}function OT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kT(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function RT(e){return RT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},RT(e)}function ET(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var TT=new WeakMap,PT="autocomplete",MT=function(e){bT(n,e);var t=CT(n);function n(e){var r;return pT(this,n),r=t.call(this,e),ET(OT(r),"sortByRelevance",(function(e,t,n){var r,o,i,a,l=[],s=[],u=e.length,c=t.length;if(0===u){for(i=0;i<c;i++)s.push(i);return s}for(i=0;i<c;i++){if(o=St(qe(t[i])),n)a=o.indexOf(e);else{var f=this.cellProperties.locale;a=o.toLocaleLowerCase(f).indexOf(e.toLocaleLowerCase(f))}-1!==a&&(r=o.length-a-u,l.push({baseIndex:i,index:a,charsLeft:r,value:o}))}for(l.sort((function(e,t){if(-1===t.index)return-1;if(-1===e.index)return 1;if(e.index<t.index)return-1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return-1;if(e.charsLeft>t.charsLeft)return 1}return 0})),i=0,c=l.length;i<c;i++)s.push(l[i].baseIndex);return s})),r.query=null,r.strippedChoices=[],r.rawChoices=[],TT.set(OT(r),{skipOne:!1,isMacOS:r.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),r}return vT(n,[{key:"getValue",value:function(){var e=this,t=this.rawChoices.find((function(t){var n=e.stripValueIfNeeded(t);return n===e.TEXTAREA.value}));return Qe(t)?t:this.TEXTAREA.value}},{key:"createElements",value:function(){gT(RT(n.prototype),"createElements",this).call(this),Ut(this.htContainer,"autocompleteEditor"),Ut(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}},{key:"open",value:function(){var e=this,t=TT.get(this);gT(RT(n.prototype),"open",this).call(this);var r=this.htEditor.getInstance(),o=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var i=Cn();0===i&&t.isMacOS&&(i+=15),this.addHook("beforeKeyDown",(function(t){return e.onBeforeKeyDown(t)})),r.updateSettings({colWidths:o?[un(this.TEXTAREA)-2]:void 0,width:o?un(this.TEXTAREA)+i:void 0,renderer:function(t,n,r,o,i,a,l){DR(t,n,r,o,i,a,l);var s,u,c=e.cellProperties,f=c.filteringCaseSensitive,h=c.allowHtml,d=c.locale,p=e.query,y=qe(a);y&&!h&&(s=!0===f?y.indexOf(p):y.toLocaleLowerCase(d).indexOf(p.toLocaleLowerCase(d)),-1!==s&&(u=y.substr(s,p.length),y=y.replace(u,"<strong>".concat(u,"</strong>")))),n.innerHTML=y},autoColumnSize:!0}),t.skipOne&&(t.skipOne=!1),this.hot._registerTimeout((function(){e.queryChoices(e.TEXTAREA.value)}))}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),gT(RT(n.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(e){gT(RT(n.prototype),"discardEditor",this).call(this,e),this.hot.view.render()}},{key:"queryChoices",value:function(e){var t=this,n=this.cellProperties.source;this.query=e,"function"===typeof n?n.call(this.cellProperties,e,(function(e){t.rawChoices=e,t.updateChoicesList(t.stripValuesIfNeeded(e))})):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(e){var t=yn(this.TEXTAREA),n=vn(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,i=null,a=null,l=e;r&&(i=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));var s=Array.isArray(i)?i.length:0;if(!1===o)s&&(a=i[0]);else{for(var u=[],c=0,f=l.length;c<f;c++){if(r&&s<=c)break;s?u.push(l[i[c]]):u.push(l[c])}a=0,l=u}this.strippedChoices=l,this.htEditor.loadData(B([l])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(a),this.hot.listen(),bn(this.TEXTAREA,t,t===n?void 0:n)}},{key:"flipDropdownIfNeeded",value:function(){var e=on(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(t||!t&&(n||"horizontal"===n))return!1;var r=Jt(this.TEXTAREA),o=cn(this.TEXTAREA),i=this.getDropdownHeight(),a=e.scrollTop,l=cn(this.hot.view._wt.wtTable.THEAD),s=Jt(e),u=r.top-s.top-l+a,c=e.scrollHeight-u-l-o,f=i>c&&u>c;return f?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(f?u:c,i),f}},{key:"limitDropdownIfNeeded",value:function(e,t){if(t>e){var n=0,r=0,o=0,i=null;do{o=this.htEditor.getRowHeight(r)||this.htEditor.view._wt.getSetting("defaultRowHeight"),n+=o,r+=1}while(n<e);i=n-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+t-i,"px")),this.setDropdownHeight(n-o)}}},{key:"flipDropdown",value:function(e){var t=this.htEditor.rootElement.style;t.position="absolute",t.top="".concat(-e,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var e=this.htEditor.getColWidth(0)+Cn(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(e){this.htEditor.updateSettings({height:e})}},{key:"highlightBestMatchingChoice",value:function(e){"number"===typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}},{key:"stripValueIfNeeded",value:function(e){return this.stripValuesIfNeeded([e])[0]}},{key:"stripValuesIfNeeded",value:function(e){var t=this.cellProperties.allowHtml,n=W(e,(function(e){return qe(e)})),r=W(n,(function(e){return t?e:St(e)}));return r}},{key:"allowKeyEventPropagation",value:function(e){var t=this.htEditor.getSelectedRangeLast(),n={row:t?t.from.row:-1},r=!1;return e===zn.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(r=!0),e===zn.ARROW_UP&&n.row>-1&&(r=!0),r}},{key:"onBeforeKeyDown",value:function(e){var t=this,n=TT.get(this);if(n.skipOne=!1,Yn(e.keyCode)||e.keyCode===zn.BACKSPACE||e.keyCode===zn.DELETE||e.keyCode===zn.INSERT){var r=10;if(e.keyCode===zn.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout((function(){t.queryChoices(t.TEXTAREA.value),n.skipOne=!0}),r)}}}],[{key:"EDITOR_TYPE",get:function(){return PT}}]),n}(hT);function AT(e){return AT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},AT(e)}function IT(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xT(e,t,n){return t&&jT(e.prototype,t),n&&jT(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _T(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HT(e,t)}function HT(e,t){return HT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},HT(e,t)}function DT(e){var t=BT();return function(){var n,r=VT(e);if(t){var o=VT(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return NT(this,n)}}function NT(e,t){if(t&&("object"===AT(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return LT(e)}function LT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BT(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function VT(e){return VT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},VT(e)}var FT="checkbox",WT=function(e){_T(n,e);var t=DT(n);function n(){return IT(this,n),t.apply(this,arguments)}return xT(n,[{key:"beginEditing",value:function(e,t){if(t&&"mouseup"===t.type){var n=this.TD.querySelector('input[type="checkbox"]');Wt(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return FT}}]),n}(aR),UT=n("e83b");function zT(e){return zT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zT(e)}function GT(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function KT(e,t,n){return t&&YT(e.prototype,t),n&&YT(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function XT(){return XT="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=$T(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},XT.apply(this,arguments)}function $T(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=nP(e),null===e)break;return e}function qT(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QT(e,t)}function QT(e,t){return QT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},QT(e,t)}function JT(e){var t=tP();return function(){var n,r=nP(e);if(t){var o=nP(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ZT(this,n)}}function ZT(e,t){if(t&&("object"===zT(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return eP(e)}function eP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tP(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function nP(e){return nP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nP(e)}var rP="date",oP="dateEditor",iP=function(e){qT(n,e);var t=JT(n);function n(e){var r;return GT(this,n),r=t.call(this,e),r.defaultDateFormat="DD/MM/YYYY",r.isCellEdited=!1,r.parentDestroyed=!1,r.$datePicker=null,r}return KT(n,[{key:"init",value:function(){var e=this;if("function"!==typeof Ye)throw new Error("You need to include moment.js to your project.");if("function"!==typeof UT)throw new Error("You need to include Pikaday to your project.");XT(nP(n.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",(function(){e.parentDestroyed=!0,e.destroyElements()}))}},{key:"createElements",value:function(){XT(nP(n.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Ut(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var e=new Nr(this);e.addEventListener(this.datePicker,"mousedown",(function(e){return e.stopPropagation()}))}},{key:"destroyElements",value:function(){var e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}},{key:"prepare",value:function(e,t,r,o,i,a){XT(nP(n.prototype),"prepare",this).call(this,e,t,r,o,i,a)}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.hot.getShortcutManager(),r=t.getContext("editor");XT(nP(n.prototype),"open",this).call(this),this.showDatepicker(e),r.addShortcut({keys:[["Enter"]],callback:function(e){e.stopPropagation()},group:oP})}},{key:"close",value:function(){var e,t=this;this._opened=!1,null!==(e=this.$datePicker)&&void 0!==e&&e.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout((function(){t.instance._refreshBorders()}));var r=this.hot.getShortcutManager(),o=r.getContext("editor");o.removeShortcutsByGroup(oP),XT(nP(n.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var r=this.originalValue;void 0!==r&&this.setValue(r)}XT(nP(n.prototype),"finishEditing",this).call(this,e,t)}},{key:"showDatepicker",value:function(e){var t,n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.instance.view.isMouseDown(),i=!!e&&Kn(e.keyCode);this.datePicker.style.display="block",this.$datePicker=new UT(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+n.top+cn(this.TD),"px");var a=this.hot.rootWindow.pageXOffset;a=this.hot.isRtl()?n.right-un(this.datePicker):n.left,this.datePickerStyle.left="".concat(a,"px"),this.originalValue?(t=this.originalValue,Ye(t,r,!0).isValid()&&this.$datePicker.setMoment(Ye(t,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),i||o||this.setValue("")):this.cellProperties.defaultDate?(t=this.cellProperties.defaultDate,Ye(t,r,!0).isValid()&&this.$datePicker.setMoment(Ye(t,r),!0),i||o||this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var e=this,t=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&ie(n,this.cellProperties.datePickerConfig);var r=n.onSelect,o=n.onClose;return n.field=t,n.trigger=t,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=function(t){var n=t;isNaN(n.getTime())||(n=Ye(n).format(e.cellProperties.dateFormat||e.defaultDateFormat)),e.setValue(n),e.hideDatepicker(),r&&r()},n.onClose=function(){e.parentDestroyed||e.finishEditing(!1),o&&o()},n}}],[{key:"EDITOR_TYPE",get:function(){return rP}}]),n}(jR);function aP(e){return aP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aP(e)}function lP(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uP(e,t,n){return t&&sP(e.prototype,t),n&&sP(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function cP(){return cP="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=fP(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},cP.apply(this,arguments)}function fP(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=mP(e),null===e)break;return e}function hP(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dP(e,t)}function dP(e,t){return dP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},dP(e,t)}function pP(e){var t=gP();return function(){var n,r=mP(e);if(t){var o=mP(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return yP(this,n)}}function yP(e,t){if(t&&("object"===aP(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return vP(e)}function vP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gP(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function mP(e){return mP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mP(e)}var bP="dropdown",wP=function(e){hP(n,e);var t=pP(n);function n(){return lP(this,n),t.apply(this,arguments)}return uP(n,[{key:"prepare",value:function(e,t,r,o,i,a){cP(mP(n.prototype),"prepare",this).call(this,e,t,r,o,i,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return bP}}]),n}(MT);function CP(e){return CP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},CP(e)}function SP(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kP(e,t,n){return t&&OP(e.prototype,t),n&&OP(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function RP(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EP(e,t)}function EP(e,t){return EP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},EP(e,t)}function TP(e){var t=AP();return function(){var n,r=IP(e);if(t){var o=IP(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return PP(this,n)}}function PP(e,t){if(t&&("object"===CP(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return MP(e)}function MP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AP(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function IP(e){return IP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},IP(e)}hr.getSingleton().add("beforeValidate",(function(e,t,n){var r=this.getCellMeta(t,this.propToCol(n));r.editor===wP&&void 0===r.strict&&(r.filter=!1,r.strict=!0)}));var jP="numeric",xP=function(e){RP(n,e);var t=TP(n);function n(){return SP(this,n),t.apply(this,arguments)}return kP(n,null,[{key:"EDITOR_TYPE",get:function(){return jP}}]),n}(jR);function _P(e){return _P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_P(e)}function HP(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NP(e,t,n){return t&&DP(e.prototype,t),n&&DP(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function LP(){return LP="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=BP(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},LP.apply(this,arguments)}function BP(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=YP(e),null===e)break;return e}function VP(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FP(e,t)}function FP(e,t){return FP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},FP(e,t)}function WP(e){var t=GP();return function(){var n,r=YP(e);if(t){var o=YP(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return UP(this,n)}}function UP(e,t){if(t&&("object"===_P(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return zP(e)}function zP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GP(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function YP(e){return YP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},YP(e)}var KP="password",XP=function(e){VP(n,e);var t=WP(n);function n(){return HP(this,n),t.apply(this,arguments)}return NP(n,[{key:"createElements",value:function(){LP(YP(n.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Yt(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return KP}}]),n}(jR);function $P(e){return $P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$P(e)}function qP(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function JP(e,t,n){return t&&QP(e.prototype,t),n&&QP(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZP(){return ZP="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=eM(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ZP.apply(this,arguments)}function eM(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=lM(e),null===e)break;return e}function tM(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nM(e,t)}function nM(e,t){return nM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},nM(e,t)}function rM(e){var t=aM();return function(){var n,r=lM(e);if(t){var o=lM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oM(this,n)}}function oM(e,t){if(t&&("object"===$P(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return iM(e)}function iM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aM(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function lM(e){return lM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lM(e)}var sM="ht_editor_visible",uM="selectEditor",cM="select",fM=function(e){tM(n,e);var t=rM(n);function n(){return qP(this,n),t.apply(this,arguments)}return JP(n,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Ut(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(e){this.select.value=e}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var e=this.hot.getShortcutManager();e.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",Wt(this.select,sM)&&zt(this.select,sM),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var e=this;this.addHook("afterScrollHorizontally",(function(){return e.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return e.refreshDimensions()})),this.addHook("afterColumnResize",(function(){return e.refreshDimensions()})),this.addHook("afterRowResize",(function(){return e.refreshDimensions()}))}},{key:"prepare",value:function(e,t,r,o,i,a){var l=this;ZP(lM(n.prototype),"prepare",this).call(this,e,t,r,o,i,a);var s,u=this.cellProperties.selectOptions;s="function"===typeof u?this.prepareOptions(u(this.row,this.col,this.prop)):this.prepareOptions(u),Yt(this.select),he(s,(function(e,t){var n=l.hot.rootDocument.createElement("OPTION");n.value=t,$t(n,e),l.select.appendChild(n)}))}},{key:"prepareOptions",value:function(e){var t={};if(Array.isArray(e))for(var n=0,r=e.length;n<r;n++)t[e[n]]=e[n];else"object"===$P(e)&&(t=e);return t}},{key:"refreshValue",value:function(){var e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===oR.EDITING)if(this.TD=this.getEditedCell(),this.TD){var e=this.getEditedCellRect(),t=e.top,n=e.start,r=e.width,o=e.height,i=this.select.style;i.height="".concat(o,"px"),i.width="".concat(r,"px"),i.top="".concat(t,"px"),i[this.hot.isRtl()?"right":"left"]="".concat(n,"px"),i.margin="0px",Ut(this.select,sM)}else this.close()}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager(),n=t.getContext("editor"),r={group:uM};!1!==this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var t=e.select.selectedIndex-1;t>=0&&(e.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var t=e.select.selectedIndex+1;t<=e.select.length-1&&(e.select[t].selected=!0)}}],r)}},{key:"unregisterShortcuts",value:function(){var e=this.hot.getShortcutManager(),t=e.getContext("editor");t.removeShortcutsByGroup(uM)}}],[{key:"EDITOR_TYPE",get:function(){return cM}}]),n}(aR);function hM(e){return hM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hM(e)}function dM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yM(e,t,n){return t&&pM(e.prototype,t),n&&pM(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function vM(){return vM="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=gM(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},vM.apply(this,arguments)}function gM(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=kM(e),null===e)break;return e}function mM(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bM(e,t)}function bM(e,t){return bM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bM(e,t)}function wM(e){var t=OM();return function(){var n,r=kM(e);if(t){var o=kM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return CM(this,n)}}function CM(e,t){if(t&&("object"===hM(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return SM(e)}function SM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OM(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function kM(e){return kM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kM(e)}var RM="time",EM=function(e){mM(n,e);var t=wM(n);function n(){return dM(this,n),t.apply(this,arguments)}return yM(n,[{key:"prepare",value:function(e,t,r,o,i,a){vM(kM(n.prototype),"prepare",this).call(this,e,t,r,o,i,a),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return RM}}]),n}(jR);function TM(){Ar(aR),Ar(MT),Ar(WT),Ar(iP),Ar(wP),Ar(hT),Ar(xP),Ar(XP),Ar(fM),Ar(jR),Ar(EM)}var PM="html";function MM(e,t,n,r,o,i,a){_R.apply(this,[e,t,n,r,o,i,a]),$t(t,null===i||void 0===i?"":i,!1)}MM.RENDERER_TYPE=PM;var AM="autocomplete";function IM(e,t,n,r,o,i,a){var l=e.rootDocument,s=a.allowHtml?MM:DR,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[e,t,n,r,o,i,a]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),Ut(t,"htAutocomplete"),!e.acArrowListener){var c=new Nr(e);e.acArrowListener=function(o){Wt(o.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(n,r),t)},c.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",(function(){c.destroy()}))}}IM.RENDERER_TYPE=AM;var jM=new WeakMap,xM=new WeakMap,_M="htBadValue",HM="data-row",DM="data-col",NM="checkboxRenderer",LM="checkbox";function BM(e,t,n,r,o,i,a){var l=e.rootDocument;_R.apply(this,[e,t,n,r,o,i,a]),VM(e);var s=FM(l),u=a.label,c=!1;if("undefined"===typeof a.checkedTemplate&&(a.checkedTemplate=!0),"undefined"===typeof a.uncheckedTemplate&&(a.uncheckedTemplate=!1),Yt(t),i===a.checkedTemplate||qe(i).toLocaleLowerCase(a.locale)===qe(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||qe(i).toLocaleLowerCase(a.locale)===qe(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:Ze(i)?Ut(s,"noValue"):(s.style.display="none",Ut(s,_M),c=!0),s.setAttribute(HM,n),s.setAttribute(DM,r),!c&&u){var f="";if(u.value)f="function"===typeof u.value?u.value.call(this,n,r,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(n,u.property);f=null!==h?h:""}var d=WM(l,f,!0!==u.separated);"before"===u.position?u.separated?(t.appendChild(d),t.appendChild(s)):(d.appendChild(s),s=d):u.position&&"after"!==u.position||(u.separated?(t.appendChild(s),t.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}function p(){var t=e.getShortcutManager(),n=t.getContext("grid"),r={group:NM};n.addShortcuts([{keys:[["space"]],callback:function(){return y(),!v()}},{keys:[["enter"]],callback:function(){return y(),!v()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return y(!0),!v()},relativeToGroup:$r,position:"before"}],r)}function y(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e.getSelectedRange();if(n)for(var r=0;r<n.length;r++){for(var o=n[r].getTopStartCorner(),i=o.row,a=o.col,l=n[r].getBottomEndCorner(),s=l.row,u=l.col,c=[],f=i;f<=s;f+=1)for(var h=a;h<=u;h+=1){var d=e.getCellMeta(f,h);if("checkbox"!==d.type)return;if(!0!==d.readOnly){"undefined"===typeof d.checkedTemplate&&(d.checkedTemplate=!0),"undefined"===typeof d.uncheckedTemplate&&(d.uncheckedTemplate=!1);var p=e.getDataAtCell(f,h);!1===t?[d.checkedTemplate,d.checkedTemplate.toString()].includes(p)?c.push([f,h,d.uncheckedTemplate]):[d.uncheckedTemplate,d.uncheckedTemplate.toString(),null,void 0].includes(p)&&c.push([f,h,d.checkedTemplate]):c.push([f,h,d.uncheckedTemplate])}}c.length>0&&e.setDataAtCell(c)}}function v(){var t=e.getSelectedRange();if(t){for(var n=0;n<t.length;n++)for(var r=t[n].getTopStartCorner(),o=t[n].getBottomEndCorner(),i=r.row;i<=o.row;i++)for(var a=r.col;a<=o.col;a++){var l=e.getCellMeta(i,a);if("checkbox"!==l.type)return!1;var s=e.getCell(i,a);if(null===s||void 0===s)return!0;var u=s.querySelectorAll("input[type=checkbox]");if(u.length>0&&!l.readOnly)return!0}return!1}}(!u||u&&!u.separated)&&t.appendChild(s),c&&t.appendChild(l.createTextNode("#bad-value#")),jM.has(e)||(jM.set(e,!0),p())}function VM(e){var t=xM.get(e);if(!t){var n=e.rootElement;t=new Nr(e),t.addEventListener(n,"click",(function(t){return zM(t,e)})),t.addEventListener(n,"mouseup",(function(t){return UM(t,e)})),t.addEventListener(n,"change",(function(t){return GM(t,e)})),xM.set(e,t)}return t}function FM(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function WM(e,t,n){var r=e.createElement("label");return r.className="htCheckboxRendererLabel ".concat(n?"fullWidth":""),r.appendChild(e.createTextNode(t)),r.cloneNode(!0)}function UM(e,t){var n=e.target;YM(n)&&n.hasAttribute(HM)&&n.hasAttribute(DM)&&setTimeout(t.listen,10)}function zM(e,t){var n=e.target;if(YM(n)&&n.hasAttribute(HM)&&n.hasAttribute(DM)){var r=parseInt(n.getAttribute(HM),10),o=parseInt(n.getAttribute(DM),10),i=t.getCellMeta(r,o);i.readOnly&&e.preventDefault()}}function GM(e,t){var n=e.target;if(YM(n)&&n.hasAttribute(HM)&&n.hasAttribute(DM)){var r=parseInt(n.getAttribute(HM),10),o=parseInt(n.getAttribute(DM),10),i=t.getCellMeta(r,o);if(!i.readOnly){var a=null;a=e.target.checked?void 0===i.uncheckedTemplate||i.checkedTemplate:void 0!==i.uncheckedTemplate&&i.uncheckedTemplate,t.setDataAtCell(r,o,a)}}}function YM(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}hr.getSingleton().add("modifyAutoColumnSizeSeed",(function(e,t,n){var r=t.label,o=t.type,i=t.row,a=t.column,l=t.prop;if(o===LM){if(r){var s=r.value,u=r.property,c=n;if(s)c="function"===typeof s?s(i,a,l,n):s;else if(u){var f=this.getDataAtRowProp(i,u);c=null!==f?f:n}e=c}return e}})),BM.RENDERER_TYPE=LM;var KM=n("e0c5"),XM="numeric";function $M(e,t,n,r,o,i,a){var l=i;if(bo(l)){var s=a.numericFormat,u=s&&s.culture||"-",c=s&&s.pattern,f=a.className||"",h=f.length?f.split(" "):[];if("undefined"!==typeof u&&!KM.languages()[u]){var d=u.replace("-",""),p=KM.allLanguages?KM.allLanguages[u]:KM[d];p&&KM.registerLanguage(p)}KM.setLanguage(u),l=KM(l).format(c||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),t.dir="ltr"}DR(e,t,n,r,o,l,a)}$M.RENDERER_TYPE=XM;var qM="password";function QM(e,t,n,r,o,i,a){DR.apply(this,[e,t,n,r,o,i,a]);var l=a.hashLength||t.innerHTML.length,s=a.hashSymbol||"*",u="";Co(l-1,(function(){u+=s})),$t(t,u)}QM.RENDERER_TYPE=qM;var JM="time";function ZM(e,t,n,r,o,i,a){DR.apply(this,[e,t,n,r,o,i,a]),t.dir="ltr"}function eA(){_i(IM),_i(_R),_i(BM),_i(MM),_i($M),_i(QM),_i(DR),_i(ZM)}ZM.RENDERER_TYPE=JM;var tA="autocomplete";function nA(e,t){var n=e;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?t(!0):this.strict&&this.source?"function"===typeof this.source?this.source(n,rA(n,t)):rA(n,t)(this.source):t(!0)}function rA(e,t){var n=e;return function(e){for(var r=!1,o=0,i=e.length;o<i;o++)if(n===e[o]){r=!0;break}t(r)}}nA.VALIDATOR_TYPE=tA;n("7f16");function oA(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}var iA="date";function aA(e,t){var n=Pr(rP,this.instance),r=e,o=!0;null!==r&&void 0!==r||(r="");var i=Ye(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),a=Ye(new Date(r)).isValid()||i;if(this.allowEmpty&&""===r&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(!0===this.correctFormat){var l=lA(r,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;t(o)}function lA(e,t){var n,r=Ye(oA(e)),o=Ye(e,t),i=e.search(/[A-z]/g)>-1;return n=r.isValid()&&r.format("x")===o.format("x")||!o.isValid()||i?r:o,n.format(t)}aA.VALIDATOR_TYPE=iA;var sA="numeric";function uA(e,t){var n=e;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?t(!0):t(""!==n&&bo(e))}uA.VALIDATOR_TYPE=sA;var cA=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],fA="time";function hA(e,t){var n=this.timeFormat||"h:mm:ss a",r=!0,o=e;null===o&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=Ye(o,cA,!0).isValid()?Ye(o):Ye(o,n),l=a.isValid(),s=Ye(o,n,!0).isValid()&&!i;if(this.allowEmpty&&""===o&&(l=!0,s=!0),l||(r=!1),!l&&s&&(r=!0),l&&!s)if(!0===this.correctFormat){var u=a.format(n),c=this.instance.toVisualRow(this.row),f=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,f,u,"timeValidator"),r=!0}else r=!1;t(r)}function dA(){Fi(nA),Fi(aA),Fi(uA),Fi(hA)}hA.VALIDATOR_TYPE=fA;var pA="autocomplete",yA={CELL_TYPE:pA,editor:MT,renderer:IM,validator:nA},vA="checkbox",gA={CELL_TYPE:vA,editor:WT,renderer:BM},mA="date",bA={CELL_TYPE:mA,editor:iP,renderer:IM,validator:aA},wA="dropdown",CA={CELL_TYPE:wA,editor:wP,renderer:IM,validator:nA},SA="handsontable",OA={CELL_TYPE:SA,editor:hT,renderer:IM},kA="numeric",RA={CELL_TYPE:kA,editor:xP,renderer:$M,validator:uA,dataType:"number"},EA="password",TA={CELL_TYPE:EA,editor:XP,renderer:QM,copyable:!1},PA="time",MA={CELL_TYPE:PA,editor:EM,renderer:ZM,validator:hA};function AA(){PS(yA),PS(gA),PS(bA),PS(CA),PS(OA),PS(RA),PS(TA),PS(LR),PS(MA)}n("ce05");function IA(e,t){return DA(e)||HA(e,t)||xA(e,t)||jA()}function jA(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xA(e,t){if(e){if("string"===typeof e)return _A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_A(e,t):void 0}}function _A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function HA(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function DA(e){if(Array.isArray(e))return e}function NA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BA(e,t,n){return t&&LA(e.prototype,t),n&&LA(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function VA(e,t){FA(e,t),t.add(e)}function FA(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WA(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var UA=new Map([["plugin",ki],["cell-type",RS],["editor",Rr],["renderer",Ii],["validator",Li]]),zA="base",GA=new WeakMap,YA=[],KA=null,XA=new WeakSet,$A=function(){function e(t){var n=this;NA(this,e),VA(this,XA),fe(this,"hot",t,{writable:!1}),GA.set(this,{hooks:{}}),KA=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(function(){return n.onAfterPluginsInitialized()})),this.hot.addHook("afterUpdateSettings",(function(e){return n.onUpdateSettings(e)})),this.hot.addHook("beforeInit",(function(){return n.init()}))}return BA(e,[{key:"init",value:function(){var e=this;this.pluginName=this.hot.getPluginName(this);var t=this.constructor.PLUGIN_DEPS,n=Array.isArray(t)?t:[];if(n.length>0){var r=[];if(n.forEach((function(e){var t=e.split(":"),n=IA(t,2),o=n[0],i=n[1];if(!UA.has(o))throw new Error('Unknown plugin dependency type "'.concat(o,'" was found.'));UA.get(o)(i)||r.push(" - ".concat(i," (").concat(o,")"))})),r.length>0){var o=["The ".concat(this.pluginName," plugin requires the following modules:\n"),"".concat(r.join("\n"),"\n")].join("");YA.push(o)}}KA||(KA=Si()),KA.indexOf("UndoRedo")>=0&&KA.splice(KA.indexOf("UndoRedo"),1),KA.indexOf(this.pluginName)>=0&&KA.splice(KA.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(function(){e.isEnabled&&e.isEnabled()&&e.enablePlugin()}));var i=0===KA.length;if(i){if(YA.length>0){var a=["".concat(YA.join("\n"),"\n"),"You have to import and register them manually."].join("");throw new Error(a)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(e,t){GA.get(this).hooks[e]=GA.get(this).hooks[e]||[];var n=GA.get(this).hooks[e];this.hot.addHook(e,t),n.push(t),GA.get(this).hooks[e]=n}},{key:"removeHooks",value:function(e){var t=this;U(GA.get(this).hooks[e]||[],(function(n){t.hot.removeHook(e,n)}))}},{key:"clearHooks",value:function(){var e=this,t=GA.get(this).hooks;he(t,(function(t,n){return e.removeHooks(n)})),t.length=0}},{key:"callOnPluginsReady",value:function(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}},{key:"onAfterPluginsInitialized",value:function(){U(this.pluginsInitializedCallbacks,(function(e){return e()})),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(e){var t=WA(this,XA,qA).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var e=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),he(this,(function(t,n){"hot"!==n&&(e[n]=null)})),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return zA}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function qA(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if("boolean"===typeof t)return t;for(var n=0;n<t.length;n++)if(void 0!==e[t[n]])return!0;return!1}function QA(e,t){return nI(e)||tI(e,t)||ZA(e,t)||JA()}function JA(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ZA(e,t){if(e){if("string"===typeof e)return eI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eI(e,t):void 0}}function eI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tI(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function nI(e){if(Array.isArray(e))return e}function rI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iI(e,t,n){return t&&oI(e.prototype,t),n&&oI(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var aI=function(){function e(t){rI(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return iI(e,[{key:"addRow",value:function(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(e){var t=this.hot.getColHeader(0);if(null!==t&&void 0!==t){var n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}},{key:"addColumn",value:function(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(e){this.injected||this.injectTable(),U(this.rows,(function(t){e(t.row,cn(t.table)-1)}))}},{key:"getWidths",value:function(e){this.injected||this.injectTable(),U(this.columns,(function(t){var n=t.table.getBoundingClientRect(),r=n.width;e(t.col,Math.ceil(r))}))}},{key:"setSettings",value:function(e){this.settings=e}},{key:"setSetting",value:function(e,t){this.settings||(this.settings={}),this.settings[e]=t}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(e){return this.settings?this.settings[e]:null}},{key:"createColGroupsCol",value:function(){var e=this,t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1)),this.samples.forEach((function(n){U(n.strings,(function(n){t.appendChild(e.createColElement(n.col))}))})),t}},{key:"createRow",value:function(e){var t=this,n=this.hot.rootDocument,r=n.createDocumentFragment(),o=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,o),r.appendChild(o)),this.samples.forEach((function(o){U(o.strings,(function(o){var i=o.col,a=t.hot.getCellMeta(e,i);a.col=i,a.row=e;var l=t.hot.getCellRenderer(a),s=n.createElement("td");s.setAttribute("ghost-table",1),l(t.hot,s,e,i,t.hot.colToProp(i),o.value,a),r.appendChild(s)}))})),r}},{key:"appendColumnHeadersRow",value:function(){var e=this,t=this.hot.rootDocument,n=t.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){var o=t.createElement("th");r.push([-1,o]),n.appendChild(o)}this.samples.forEach((function(e){U(e.strings,(function(e){var o=e.col,i=t.createElement("th");r.push([o,i]),n.appendChild(i)}))})),this.table.tHead.appendChild(n),U(r,(function(t){var n=QA(t,2),r=n[0],o=n[1];e.hot.view.appendColHeader(r,o)}))}},{key:"createCol",value:function(e){var t=this,n=this.hot.rootDocument,r=n.createDocumentFragment();return this.samples.forEach((function(o){U(o.strings,(function(o){var i=o.row,a=t.hot.getCellMeta(i,e);a.col=e,a.row=i;var l=t.hot.getCellRenderer(a),s=n.createElement("td"),u=n.createElement("tr");s.setAttribute("ghost-table",1),l(t.hot,s,i,e,t.hot.colToProp(e),o.value,a),u.appendChild(s),r.appendChild(u)}))})),r}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(e){var t=this.hot.rootDocument.createElement("col");return t.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(e),"px"),t}},{key:"createTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.hot.rootDocument,n=t.createDocumentFragment(),r=t.createElement("table"),o=t.createElement("thead"),i=t.createElement("tbody"),a=t.createElement("colgroup"),l=t.createElement("tr"),s=t.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(l.appendChild(s),o.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&i.appendChild(l),r.appendChild(i),Ut(r,e),n.appendChild(r),{fragment:n,table:r,tHead:o,tBody:i,colGroup:a,tr:l,th:s}}},{key:"createContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.hot.rootDocument,n=t.createDocumentFragment(),r=t.createElement("div"),o="htGhostTable htAutoSize ".concat(e.trim());return Ut(r,o),n.appendChild(r),{fragment:n,container:r}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}]),e}(),lI=aI;function sI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fI(e,t,n){return t&&cI(e.prototype,t),n&&cI(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var hI=function(){function e(t){uI(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return fI(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(e){this.customSampleCount=e}},{key:"setAllowDuplicates",value:function(e){this.allowDuplicates=e}},{key:"generateRowSamples",value:function(e,t){return this.generateSamples("row",t,e)}},{key:"generateColumnSamples",value:function(e,t){return this.generateSamples("col",t,e)}},{key:"generateSamples",value:function(e,t,n){var r=this,o=new Map,i="number"===typeof n?{from:n,to:n}:n,a=i.from,l=i.to;return Co(a,l,(function(n){var i=r.generateSample(e,t,n);o.set(n,i)})),o}},{key:"generateSample",value:function(e,t,n){var r=this;if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");var o=new Map,i="row"===e?"col":"row",a=[];return Co(t.from,t.to,(function(t){var l,s="row"===e?r.dataFactory(n,t):r.dataFactory(t,n),u=s.value,c=s.bundleSeed,f="string"===typeof c&&c.length>0;l=f?c:ce(u)?"".concat(Object.keys(u).length):Array.isArray(u)?"".concat(u.length):"".concat(qe(u).length),o.has(l)||o.set(l,{needed:r.getSampleCount(),strings:[]});var h=o.get(l);if(h.needed){var d=a.indexOf(u)>-1;(!d||r.allowDuplicates||f)&&(h.strings.push(sI({value:u},i,t)),a.push(u),h.needed-=1)}})),o}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}(),dI=hI;function pI(e){return pI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pI(e)}function yI(e,t){return wI(e)||bI(e,t)||gI(e,t)||vI()}function vI(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function gI(e,t){if(e){if("string"===typeof e)return mI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mI(e,t):void 0}}function mI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bI(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function wI(e){if(Array.isArray(e))return e}function CI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OI(e,t,n){return t&&SI(e.prototype,t),n&&SI(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function kI(){return kI="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=RI(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},kI.apply(this,arguments)}function RI(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=jI(e),null===e)break;return e}function EI(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TI(e,t)}function TI(e,t){return TI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},TI(e,t)}function PI(e){var t=II();return function(){var n,r=jI(e);if(t){var o=jI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return MI(this,n)}}function MI(e,t){if(t&&("object"===pI(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return AI(e)}function AI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function II(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function jI(e){return jI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jI(e)}hr.getSingleton().register("modifyAutoColumnSizeSeed");var xI="autoColumnSize",_I=10,HI=new WeakMap,DI="autoColumnSize",NI=function(e){EI(n,e);var t=PI(n);function n(e){var r;return CI(this,n),r=t.call(this,e),HI.set(AI(r),{cachedColumnHeaders:[]}),r.ghostTable=new lI(r.hot),r.samplesGenerator=new dI((function(e,t){var n=r.hot.getCellMeta(e,t),o="";n.spanned||(o=r.hot.getDataAtCell(e,t));var i="";return r.hot.hasHook("modifyAutoColumnSizeSeed")&&(i=r.hot.runHooks("modifyAutoColumnSizeSeed",i,n,o)),{value:o,bundleSeed:i}})),r.firstCalculation=!0,r.inProgress=!1,r.measuredColumns=0,r.columnWidthsMap=new Ty,r.hot.columnIndexMapper.registerMap(DI,r.columnWidthsMap),r.addHook("beforeColumnResize",(function(e,t,n){return r.onBeforeColumnResize(e,t,n)})),r}return OI(n,[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings()[xI]&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings()[xI];t&&null!==t.useHeaders&&void 0!==t.useHeaders&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("beforeChangeRender",(function(t){return e.onBeforeChange(t)})),this.addHook("afterFormulasValuesUpdate",(function(t){return e.onAfterFormulasValuesUpdate(t)})),this.addHook("beforeViewRender",(function(t){return e.onBeforeViewRender(t)})),this.addHook("modifyColWidth",(function(t,n){return e.getColumnWidth(n,t)})),this.addHook("afterInit",(function(){return e.onAfterInit()})),kI(jI(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),kI(jI(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var e=this;kI(jI(n.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",(function(t,n,r){return e.onBeforeColumnResize(t,n,r)}))}},{key:"calculateVisibleColumnsWidth",value:function(){var e=this.hot.countRows();if(e){var t=this.hot.renderCall,n=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();-1!==n&&-1!==r&&this.calculateColumnsWidth({from:n,to:r},void 0,t)}}},{key:"calculateColumnsWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"===typeof t?{from:t,to:t}:t,i="number"===typeof n?{from:n,to:n}:n;Co(o.from,o.to,(function(t){var n=e.hot.toPhysicalColumn(t);if(null===n&&(n=t),r||null===e.columnWidthsMap.getValueAtIndex(n)&&!e.hot._getColWidthFromSettings(n)){var o=e.samplesGenerator.generateColumnSamples(t,i);U(o,(function(t){var n=yI(t,2),r=n[0],o=n[1];return e.ghostTable.addColumn(r,o)}))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((function(){e.ghostTable.getWidths((function(t,n){var r=e.hot.toPhysicalColumn(t);e.columnWidthsMap.setValueAtIndex(r,n)}))}),!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},r=0,o=this.hot.countCols()-1,i=null;this.inProgress=!0;var a=function a(){if(!e.hot)return I(i),void(e.inProgress=!1);e.calculateColumnsWidth({from:r,to:Math.min(r+n.CALCULATION_STEP,o)},t),r=r+n.CALCULATION_STEP+1,r<o?i=T(a):(I(i),e.inProgress=!1,e.hot.view.adjustElementsSize())},l=this.getSyncCalculationLimit();this.firstCalculation&&l>=0&&(this.calculateColumnsWidth({from:0,to:l},t),this.firstCalculation=!1,r=l+1),r<o?a():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings()[xI],t=e&&ge(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&ge(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var e=this.hot.getSettings()[xI],t=n.SYNC_CALCULATION_LIMIT,r=this.hot.countCols()-1;return ce(e)&&(t=e.syncLimit,wt(t)?t=Oo(r,t):t>>=0),Math.min(t,r)}},{key:"getColumnWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&"number"===typeof r&&(r=Math.max(r,ud.DEFAULT_WIDTH))),r}},{key:"getFirstVisibleColumn",value:function(){var e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getFirstVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){var n=e.wtTable.getFirstRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"getLastVisibleColumn",value:function(){var e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getLastVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){var n=e.wtTable.getLastRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var e=this.hot.getColHeader(),t=HI.get(this),n=t.cachedColumnHeaders,r=V(e,(function(e,t,r){var o=n.length;return(o-1<r||n[r]!==t)&&e.push(r),o-1<r?n.push(t):n[r]=t,e}),[]);return r}},{key:"clearCache",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution((function(){U(t,(function(t){e.columnWidthsMap.setValueAtIndex(t,null)}))}),!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!F(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(function(e){return null===e})).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout((function(){e.hot&&e.recalculateAllColumnsWidth()}),0)}},{key:"onBeforeChange",value:function(e){var t=this,n=W(e,(function(e){var n=yI(e,2),r=n[1];return t.hot.toPhysicalColumn(t.hot.propToCol(r))}));this.clearCache(Array.from(new Set(n)))}},{key:"onBeforeColumnResize",value:function(e,t,n){var r=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}},{key:"onAfterInit",value:function(){HI.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(e){var t=F(e,(function(e){var t;return Qe(null===(t=e.address)||void 0===t?void 0:t.col)})),n=W(t,(function(e){return e.address.col}));this.clearCache(Array.from(new Set(n)))}},{key:"destroy",value:function(){this.ghostTable.clean(),kI(jI(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return xI}},{key:"PLUGIN_PRIORITY",get:function(){return _I}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),n}($A),LI={horizontal:"horizontal",vertical:"vertical"};function BI(e,t,n,r){var o=n.length,i=n?n[0].length:0,a=[],l=t.row-e.row,s=t.col-e.col;if(-1!==["down","up"].indexOf(r)){for(var u=[],c=0;c<s;c++){var f=parseInt(n[0][c],10),h=parseInt(n[o-1][c],10),d=("down"===r?h-f:f-h)/(o-1)||0;u.push(d)}a.push(u)}if(-1!==["right","left"].indexOf(r))for(var p=0;p<l;p++){var y=parseInt(n[p][0],10),v=parseInt(n[p][i-1],10),g=("right"===r?v-y:y-v)/(i-1)||0;a.push([g])}return a}function VI(e,t,n){var r,o,i;return t[0]===e[0]&&t[1]<e[1]?(i="left",r=n(t[0],t[1]),o=n(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(i="right",r=n(t[0],e[3]+1),o=n(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(i="up",r=n(t[0],t[1]),o=n(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(i="down",r=n(e[2]+1,t[1]),o=n(t[2],t[3])),r&&r.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:r,endOfDragCoords:o}}function FI(e){var t={};return!0===e?(t.directions=Object.keys(LI),t.autoInsertRow=!0):ce(e)?(Qe(e.autoInsertRow)?e.direction===LI.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,Qe(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(LI)):"string"===typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function WI(e){return WI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},WI(e)}function UI(e){return YI(e)||GI(e)||$I(e)||zI()}function zI(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function GI(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function YI(e){if(Array.isArray(e))return qI(e)}function KI(e,t){return JI(e)||QI(e,t)||$I(e,t)||XI()}function XI(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $I(e,t){if(e){if("string"===typeof e)return qI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qI(e,t):void 0}}function qI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function QI(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function JI(e){if(Array.isArray(e))return e}function ZI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ej(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tj(e,t,n){return t&&ej(e.prototype,t),n&&ej(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function nj(){return nj="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=rj(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},nj.apply(this,arguments)}function rj(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=cj(e),null===e)break;return e}function oj(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ij(e,t)}function ij(e,t){return ij=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ij(e,t)}function aj(e){var t=uj();return function(){var n,r=cj(e);if(t){var o=cj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lj(this,n)}}function lj(e,t){if(t&&("object"===WI(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return sj(e)}function sj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uj(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function cj(e){return cj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cj(e)}hr.getSingleton().register("modifyAutofillRange"),hr.getSingleton().register("beforeAutofill"),hr.getSingleton().register("afterAutofill");var fj="autofill",hj=20,dj=["fillHandle"],pj="insert_row_below",yj=200,vj=function(e){oj(n,e);var t=aj(n);function n(e){var r;return ZI(this,n),r=t.call(this,e),r.eventManager=new Nr(sj(r)),r.addingStarted=!1,r.mouseDownOnCellCorner=!1,r.mouseDragOutside=!1,r.handleDraggedCells=0,r.directions=[],r.autoInsertRow=!1,r}return tj(n,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(function(t){return e.onAfterCellCornerMouseDown(t)})),this.addHook("afterOnCellCornerDblClick",(function(t){return e.onCellCornerDblClick(t)})),this.addHook("beforeOnCellMouseOver",(function(t,n){return e.onBeforeCellMouseOver(n)})),nj(cj(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),nj(cj(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),nj(cj(n.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var e=this,t=this.hot.getSelectedRangeLast(),n=t.getTopStartCorner(),r=n.row,o=n.col,i=t.getBottomEndCorner(),a=i.row,l=i.col,s=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:o,endRow:a,endCol:l}]),u=[],c=[],f=[];return U(s,(function(e){for(var t=e.startRow;t<=e.endRow;t+=1)-1===u.indexOf(t)&&u.push(t);for(var n=e.startCol;n<=e.endCol;n+=1)-1===c.indexOf(n)&&c.push(n)})),U(u,(function(t){var n=[];U(c,(function(r){n.push(e.hot.getCopyableData(t,r))})),f.push(n)})),f}},{key:"fillIn",value:function(){var e=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var t=this.hot.selection.highlight.getFill().getVisualCorners(),n=KI(t,4),r=n[0],o=n[1],i=n[2],a=n[3],l=this.hot.getSelectedRangeLast(),s=l.getTopStartCorner(),u=l.getBottomEndCorner();this.resetSelectionOfDraggedArea();var c=[s.row,s.col,u.row,u.col],f=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,r),Math.min(s.col,o),Math.max(u.row,i),Math.max(u.col,a)],c),h=VI(c,f,(function(t,n){return e.hot._createCellCoords(t,n)})),d=h.directionOfDrag,p=h.startOfDragCoords,y=h.endOfDragCoords;if(p&&p.row>-1&&p.col>-1){var v=this.getSelectionData(),g=l.clone(),m=this.hot._createCellRange(p,p,y),b=this.hot.runHooks("beforeAutofill",v,g,m,d);if(!1===b)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var w=BI(p,y,v,d),C=b,S=b;if(["up","left"].indexOf(d)>-1&&(1!==S.length||0!==S[0].length))if(C=[],"up"===d)for(var O=y.row-p.row+1,k=O%S.length,R=0;R<O;R++)C.push(S[(R+(S.length-k))%S.length]);else for(var E=y.col-p.col+1,T=E%S[0].length,P=0;P<S.length;P++){C.push([]);for(var M=0;M<E;M++)C[P].push(S[P][(M+(S[P].length-T))%S[P].length])}this.hot.populateFromArray(p.row,p.col,C,y.row,y.col,"".concat(this.pluginName,".fill"),null,d,w),this.setSelection(f),this.hot.runHooks("afterAutofill",C,g,m,d),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}},{key:"getCoordsOfDragAndDropBorders",value:function(e){var t=this.hot.getSelectedRangeLast(),n=t.getBottomEndCorner(),r=e;if(this.directions.includes(LI.vertical)&&this.directions.includes(LI.horizontal)){var o=t.getTopStartCorner();(n.col<=e.col||o.col>=e.col)&&(r=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||o.row>e.row)&&(r=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(LI.vertical))r=this.hot._createCellCoords(e.row,n.col);else{if(!this.directions.includes(LI.horizontal))return;r=this.hot._createCellCoords(n.row,e.col)}return this.reduceSelectionAreaIfNeeded(r)}},{key:"showBorder",value:function(e){var t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}},{key:"addRow",value:function(){var e=this;this.hot._registerTimeout((function(){e.hot.alter(pj,void 0,1,"".concat(e.pluginName,".fill")),e.addingStarted=!1}),yj)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){var e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(e){for(var t,n=this.hot.getData(),r=this.hot.countRows(),o=e[2]+1;o<r;o++){for(var i=e[1];i<=e[3];i++){var a=n[o][i];if(a)return-1}var l=n[o][e[1]-1],s=n[o][e[3]+1];(l||s)&&(t=o)}return t}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}},{key:"setSelection",value:function(e){var t;(t=this.hot).selectCell.apply(t,UI(W(e,(function(e){return Math.max(e,0)}))).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(e){var t=this.hot.rootDocument.documentElement,n=Jt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+cn(this.hot.table),r=Jt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+un(this.hot.table);return e.clientY>n&&e.clientX<=r}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()})),this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)}))}},{key:"onCellCornerDblClick",value:function(){var e=this.selectAdjacent();e&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(e){var t=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var e=FI(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}},{key:"destroy",value:function(){nj(cj(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fj}},{key:"PLUGIN_PRIORITY",get:function(){return hj}},{key:"SETTING_KEYS",get:function(){return[fj].concat(dj)}}]),n}($A);function gj(e){return gj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gj(e)}function mj(e,t){return Oj(e)||Sj(e,t)||wj(e,t)||bj()}function bj(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function wj(e,t){if(e){if("string"===typeof e)return Cj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cj(e,t):void 0}}function Cj(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Sj(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Oj(e){if(Array.isArray(e))return e}function kj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ej(e,t,n){return t&&Rj(e.prototype,t),n&&Rj(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tj(){return Tj="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Pj(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Tj.apply(this,arguments)}function Pj(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Hj(e),null===e)break;return e}function Mj(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Aj(e,t)}function Aj(e,t){return Aj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Aj(e,t)}function Ij(e){var t=_j();return function(){var n,r=Hj(e);if(t){var o=Hj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jj(this,n)}}function jj(e,t){if(t&&("object"===gj(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return xj(e)}function xj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _j(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Hj(e){return Hj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Hj(e)}var Dj="autoRowSize",Nj=40,Lj="autoRowSize",Bj=function(e){Mj(n,e);var t=Ij(n);function n(e){var r;return kj(this,n),r=t.call(this,e),r.rowHeightsMap=void 0,r.headerHeight=null,r.ghostTable=new lI(r.hot),r.samplesGenerator=new dI((function(e,t){var n;return e>=0?n=r.hot.getDataAtCell(e,t):-1===e&&(n=r.hot.getColHeader(t)),{value:n}})),r.firstCalculation=!0,r.inProgress=!1,r.measuredRows=0,r.rowHeightsMap=new Ty,r.hot.rowIndexMapper.registerMap(Lj,r.rowHeightsMap),r.addHook("beforeRowResize",(function(e,t,n){return r.onBeforeRowResize(e,t,n)})),r}return Ej(n,[{key:"isEnabled",value:function(){var e=this.hot.getSettings()[Dj];return!0===e||ce(e)}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("beforeChangeRender",(function(t){return e.onBeforeChange(t)})),this.addHook("beforeColumnResize",(function(){return e.recalculateAllRowsHeight()})),this.addHook("beforeViewRender",(function(t){return e.onBeforeViewRender(t)})),this.addHook("modifyRowHeight",(function(t,n){return e.getRowHeight(n,t)})),this.addHook("modifyColumnHeaderHeight",(function(){return e.getColumnHeaderHeight()})),Tj(Hj(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=this;this.headerHeight=null,Tj(Hj(n.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",(function(t,n,r){return e.onBeforeRowResize(t,n,r)}))}},{key:"calculateRowsHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"===typeof t?{from:t,to:t}:t,i="number"===typeof n?{from:n,to:n}:n;if(null!==this.hot.getColHeader(0)){var a=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(a.get(-1))}Co(o.from,o.to,(function(t){if(r||null===e.rowHeightsMap.getValueAtIndex(t)){var n=e.samplesGenerator.generateRowSamples(t,i);U(n,(function(t){var n=mj(t,2),r=n[0],o=n[1];return e.ghostTable.addRow(r,o)}))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((function(){e.ghostTable.getHeights((function(t,n){t<0?e.headerHeight=n:e.rowHeightsMap.setValueAtIndex(e.hot.toPhysicalRow(t),n)}))}),!0),this.measuredRows=o.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},r=0,o=this.hot.countRows()-1,i=null;this.inProgress=!0;var a=function a(){if(!e.hot)return I(i),void(e.inProgress=!1);e.calculateRowsHeight({from:r,to:Math.min(r+n.CALCULATION_STEP,o)},t),r=r+n.CALCULATION_STEP+1,r<o?i=T(a):(I(i),e.inProgress=!1,e.hot.view.adjustElementsSize(!0),e.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&e.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},l=this.getSyncCalculationLimit();this.firstCalculation&&l>=0&&(this.calculateRowsHeight({from:0,to:l},t),this.firstCalculation=!1,r=l+1),r<o?a():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings()[Dj],t=e&&ge(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&ge(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){Qt(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var e=this.hot.getSettings()[Dj],t=n.SYNC_CALCULATION_LIMIT,r=this.hot.countRows()-1;return ce(e)&&(t=e.syncLimit,wt(t)?t=Oo(r,t):t>>=0),Math.min(t,r)}},{key:"getRowHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e)),r=t;return null!==n&&n>(t||0)&&(r=n),r}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(e){var t=this,n="number"===typeof e?{from:e,to:e}:e,r=n.from,o=n.to;this.hot.batchExecution((function(){Co(Math.min(r,o),Math.max(r,o),(function(e){t.rowHeightsMap.setValueAtIndex(e,null)}))}),!0)}},{key:"isNeedRecalculate",value:function(){return!!F(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(function(e){return null===e})).length}},{key:"onBeforeViewRender",value:function(){var e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(-1!==n&&-1!==r){if(this.calculateRowsHeight({from:n,to:r},void 0,e),t){var o=this.hot.countRows()-1;this.calculateRowsHeight({from:o-t,to:o})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(e,t,n){var r=e;return n&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout((function(){e.hot&&e.recalculateAllRowsHeight()}),0)}},{key:"onBeforeChange",value:function(e){var t=null;1===e.length?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),null!==t&&this.clearCacheByRange(t)}},{key:"destroy",value:function(){this.ghostTable.clean(),Tj(Hj(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Dj}},{key:"PLUGIN_PRIORITY",get:function(){return Nj}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),n}($A),Vj=new Map([["indexesSequence",{getListWithInsertedItems:Wp,getListWithRemovedItems:Up}],["physicallyIndexed",{getListWithInsertedItems:hy,getListWithRemovedItems:dy}]]),Fj=function(e){if(!1===Vj.has(e))throw new Error("Alter strategy with ID '".concat(e,"' does not exist."));return Vj.get(e)};function Wj(e){return Wj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wj(e)}function Uj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gj(e,t,n){return t&&zj(e.prototype,t),n&&zj(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yj(){return Yj="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Kj(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Yj.apply(this,arguments)}function Kj(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=ex(e),null===e)break;return e}function Xj(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$j(e,t)}function $j(e,t){return $j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$j(e,t)}function qj(e){var t=Zj();return function(){var n,r=ex(e);if(t){var o=ex(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Qj(this,n)}}function Qj(e,t){if(t&&("object"===Wj(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Jj(e)}function Jj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zj(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ex(e){return ex=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ex(e)}var tx=Fj("physicallyIndexed"),nx=tx.getListWithInsertedItems,rx=tx.getListWithRemovedItems,ox=function(e){Xj(n,e);var t=qj(n);function n(){return Uj(this,n),t.call(this,(function(e){return e}))}return Gj(n,[{key:"insert",value:function(e,t){var r=Gp(this.indexedValues,t);this.indexedValues=nx(r,e,t,this.initValueOrFn),Yj(ex(n.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=rx(this.indexedValues,e);this.indexedValues=zp(t,e),Yj(ex(n.prototype),"remove",this).call(this,e)}}]),n}(Hp),ix=ox;function ax(e){return ax="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ax(e)}function lx(e){return fx(e)||cx(e)||ux(e)||sx()}function sx(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ux(e,t){if(e){if("string"===typeof e)return hx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hx(e,t):void 0}}function cx(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function fx(e){if(Array.isArray(e))return hx(e)}function hx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dx(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function px(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yx(e,t,n){return t&&px(e.prototype,t),n&&px(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function vx(){return vx="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=gx(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},vx.apply(this,arguments)}function gx(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=kx(e),null===e)break;return e}function mx(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bx(e,t)}function bx(e,t){return bx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bx(e,t)}function wx(e){var t=Ox();return function(){var n,r=kx(e);if(t){var o=kx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Cx(this,n)}}function Cx(e,t){if(t&&("object"===ax(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Sx(e)}function Sx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ox(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function kx(e){return kx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kx(e)}var Rx=Fj("physicallyIndexed"),Ex=Rx.getListWithInsertedItems,Tx=Rx.getListWithRemovedItems,Px=function(e){mx(n,e);var t=wx(n);function n(){return dx(this,n),t.call(this,(function(e){return e}))}return yx(n,[{key:"insert",value:function(e,t){var r=this;this.indexedValues=Ex(this.indexedValues,e,t,(function(e,t){return r.getNextValue(t)})),vx(kx(n.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=Tx(this.indexedValues,e),vx(kx(n.prototype),"remove",this).call(this,e)}},{key:"getNextValue",value:function(e){return Math.max.apply(Math,lx(this.getValues()))+1+e}}]),n}(Hp),Mx=Px;function Ax(e){return Ax="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ax(e)}function Ix(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jx(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xx(e,t,n){return t&&jx(e.prototype,t),n&&jx(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _x(){return _x="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Hx(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},_x.apply(this,arguments)}function Hx(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Wx(e),null===e)break;return e}function Dx(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nx(e,t)}function Nx(e,t){return Nx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Nx(e,t)}function Lx(e){var t=Fx();return function(){var n,r=Wx(e);if(t){var o=Wx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bx(this,n)}}function Bx(e,t){if(t&&("object"===Ax(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Vx(e)}function Vx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fx(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Wx(e){return Wx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Wx(e)}var Ux="bindRowsWithHeaders",zx=210,Gx="loose",Yx=new Map([["loose",ix],["strict",Mx]]),Kx=function(e){Dx(n,e);var t=Lx(n);function n(e){var r;return Ix(this,n),r=t.call(this,e),r.headerIndexes=null,r}return xx(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Ux]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings()[Ux];"string"!==typeof t&&(t=Gx);var r=Yx.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",(function(t){return e.onModifyRowHeader(t)})),_x(Wx(n.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),_x(Wx(n.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}},{key:"destroy",value:function(){_x(Wx(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ux}},{key:"PLUGIN_PRIORITY",get:function(){return zx}}]),n}($A);function Xx(e){return Xx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xx(e)}function $x(e){return Zx(e)||Jx(e)||Qx(e)||qx()}function qx(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Qx(e,t){if(e){if("string"===typeof e)return e_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e_(e,t):void 0}}function Jx(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Zx(e){if(Array.isArray(e))return e_(e)}function e_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r_(e,t,n){return t&&n_(e.prototype,t),n&&n_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function o_(){return o_="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=i_(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},o_.apply(this,arguments)}function i_(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=h_(e),null===e)break;return e}function a_(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l_(e,t)}function l_(e,t){return l_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l_(e,t)}function s_(e){var t=f_();return function(){var n,r=h_(e);if(t){var o=h_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u_(this,n)}}function u_(e,t){if(t&&("object"===Xx(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c_(e)}function c_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f_(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function h_(e){return h_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h_(e)}function d_(e,t,n){p_(e,t),t.set(e,n)}function p_(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v_(e,t){var n=b_(e,t,"get");return g_(e,n)}function g_(e,t){return t.get?t.get.call(e):t.value}function m_(e,t,n){var r=b_(e,t,"set");return w_(e,r,n),n}function b_(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function w_(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}var C_="collapsibleColumns",S_=290,O_=["nestedHeaders"],k_="collapsibleIndicator",R_=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),E_=new WeakMap,T_=function(e){a_(n,e);var t=s_(n);function n(){var e;t_(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),y_(c_(e),"nestedHeadersPlugin",null),y_(c_(e),"eventManager",new Nr(c_(e))),y_(c_(e),"headerStateManager",null),d_(c_(e),E_,{writable:!0,value:null}),e}return r_(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[C_]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings(),r=t.nestedHeaders;r||Fn("You need to configure the Nested Headers plugin in order to use collapsible headers."),m_(this,E_,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(function(){return e.onInit()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("afterGetColHeader",(function(){return e.onAfterGetColHeader.apply(e,arguments)})),this.addHook("beforeOnCellMouseDown",(function(t,n,r){return e.onBeforeOnCellMouseDown(t,n,r)})),o_(h_(n.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var e=this.hot.getSettings(),t=e.collapsibleColumns;"boolean"===typeof t?this.headerStateManager.mapState((function(e){return{collapsible:e.origColspan>1}})):Array.isArray(t)&&(this.headerStateManager.mapState((function(){return{collapsible:!1}})),this.headerStateManager.mergeStateWith(t))}o_(h_(n.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),m_(this,E_,null),this.nestedHeadersPlugin=null,this.clearButtons(),o_(h_(n.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(e){e&&e.parentNode.removeChild(e)};Co(0,e-1,(function(e){var i=t.childNodes[e],a=n.childNodes[e],l=r?r.childNodes[e]:null;Co(0,i.childNodes.length-1,(function(e){var t=i.childNodes[e].querySelector(".".concat(k_));o(t),a&&a.childNodes[e]&&(t=a.childNodes[e].querySelector(".".concat(k_)),o(t)),r&&l&&l.childNodes[e]&&(t=l.childNodes[e].querySelector(".".concat(k_)),o(t))}))}),!0)}}},{key:"expandSection",value:function(e){this.toggleCollapsibleSection([e],"expand")}},{key:"collapseSection",value:function(e){this.toggleCollapsibleSection([e],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(e){var t=this,n=this.headerStateManager.mapNodes((function(n){var r=n.collapsible,o=n.origColspan,i=n.headerLevel,a=n.columnIndex,l=n.isCollapsed;if(!0===r&&o>1&&(l&&"expand"===e||!l&&"collapse"===e))return{row:t.headerStateManager.levelToRowCoords(i),col:a}}));this.toggleCollapsibleSection(n,e)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(e,t){var n=this;if(!R_.has(t))throw new Error("Unsupported action is passed (".concat(t,")."));if(Array.isArray(e)){var r=F(e,(function(e){var t=e.row;return t<0})),o=r.length>0;U(r,(function(e){var r,i=e.row,a=e.col,l=null!==(r=n.headerStateManager.getHeaderSettings(i,a))&&void 0!==r?r:{},s=l.collapsible,u=l.isCollapsed;if(!s||u&&"collapse"===t||!u&&"expand"===t)return o=!1,!1}));var i=[],a=[];o&&U(r,(function(e){var r=e.row,o=e.col,l=n.headerStateManager.triggerNodeModification(t,r,o),s=l.colspanCompensation,u=l.affectedColumns,c=l.rollbackModification;s>0&&(a.push.apply(a,$x(u)),i.push(c))}));var l=this.getCollapsedColumns(),s=[];"collapse"===t?s=$([].concat($x(l),a)):"expand"===t&&(s=F(l,(function(e){return!a.includes(e)})));var u=R_.get(t),c=this.hot.runHooks(u.beforeHook,l,s,o);if(!1!==c){this.hot.batchExecution((function(){U(a,(function(e){v_(n,E_).setValueAtIndex(n.hot.toPhysicalColumn(e),u.hideColumn)}))}),!0);var f=this.getCollapsedColumns().length!==l.length;this.hot.runHooks(u.afterHook,l,s,o,f),this.hot.render(),this.hot.view.adjustElementsSize(!0)}else U(i,(function(e){e()}))}}},{key:"getCollapsedColumns",value:function(){return v_(this,E_).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(e,t,n){var r,o,i=null!==(r=this.headerStateManager.getHeaderSettings(n,e))&&void 0!==r?r:{},a=i.collapsible,l=i.origColspan,s=i.isCollapsed,u=a&&l>1&&e>=this.hot.getSettings().fixedColumnsStart,c=t.querySelector(".".concat(k_));u?(c||(c=this.hot.rootDocument.createElement("div"),Ut(c,k_),t.querySelector("div:first-child").appendChild(c)),zt(c,["collapsed","expanded"]),s?(Ut(c,"collapsed"),qt(c,"+")):(Ut(c,"expanded"),qt(c,"-"))):null===(o=c)||void 0===o||o.remove()}},{key:"onBeforeOnCellMouseDown",value:function(e,t){Wt(e.target,k_)&&(Wt(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):Wt(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),Qn(e))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(e,t){t||this.updatePlugin()}},{key:"destroy",value:function(){m_(this,E_,null),o_(h_(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return C_}},{key:"PLUGIN_PRIORITY",get:function(){return S_}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[C_].concat(O_)}}]),n}($A);function P_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P_(Object(n),!0).forEach((function(t){A_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I_(e,t){return D_(e)||H_(e,t)||x_(e,t)||j_()}function j_(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x_(e,t){if(e){if("string"===typeof e)return __(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?__(e,t):void 0}}function __(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function H_(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function D_(e){if(Array.isArray(e))return e}function N_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B_(e,t,n){return t&&L_(e.prototype,t),n&&L_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var V_=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],F_=!1,W_=!0,U_=!0,z_=function(){function e(t,n){N_(this,e),this.hot=t,this.sortingStates=new av,this.sortEmptyCells=F_,this.indicator=W_,this.headerAction=U_,this.compareFunctionFactory=void 0,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}return B_(e,[{key:"updateAllColumnsProperties",value:function(e){var t=this;ce(e)&&he(e,(function(e,n){V_.includes(n)&&(t[n]=e)}))}},{key:"getAllColumnsProperties",value:function(){var e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"===typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}},{key:"getSortOrderOfColumn",value:function(e){var t;return null===(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))||void 0===t?void 0:t.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex((function(t){var n=I_(t,1),r=n[0];return r===e}))}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return 0===this.getNumberOfSortedColumns()}},{key:"isColumnSorted",value:function(e){return ce(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}},{key:"getSortStates",value:function(){var e=this;if(null===this.sortingStates)return[];var t=this.sortingStates.getEntries();return t.map((function(t){var n=I_(t,2),r=n[0],o=n[1];return M_({column:e.hot.toVisualColumn(r)},o)}))}},{key:"getColumnSortState",value:function(e){var t=this.getSortOrderOfColumn(e);if(Qe(t))return{column:e,sortOrder:t}}},{key:"setSortStates",value:function(e){this.sortingStates.clear();for(var t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),G_="asc",Y_="desc",K_="colHeader";function X_(e){if(!1===ce(e))return!1;var t=e.column,n=e.sortOrder;return Number.isInteger(t)&&[G_,Y_].includes(n)}function $_(e){if(e.some((function(e){return!1===X_(e)})))return!1;var t=e.map((function(e){var t=e.column;return t}));return new Set(t).size===t.length}function q_(e){if(e!==Y_)return e===G_?Y_:G_}function Q_(e){var t=e.querySelector(".".concat(K_));return t}function J_(e,t){if(e<0||!t.parentNode)return!1;var n=t.parentNode.parentNode.childNodes,r=Array.from(n).indexOf(t.parentNode)-n.length;return-1===r}function Z_(e,t,n){return-1===e&&t>=0&&!1===Zn(n)}var eH="ascending",tH="descending",nH="indicatorDisabled",rH="columnSorting",oH="sortAction",iH=new Map([[G_,eH],[Y_,tH]]);function aH(e,t,n,r){var o=[rH];if(r&&o.push(oH),!1===n)return o.push(nH),o;var i=e.getSortOrderOfColumn(t);return Qe(i)&&o.push(iH.get(i)),o}function lH(){return Array.from(iH.values()).concat(oH,nH,rH)}var sH=0,uH=-1,cH=1;function fH(e,t){for(var n=EH(t),r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];e.sort(n.apply(void 0,o))}function hH(e,t,n){var r=t.locale;return function(t,o){var i=n.sortEmptyCells;return"string"===typeof t&&(t=t.toLocaleLowerCase(r)),"string"===typeof o&&(o=o.toLocaleLowerCase(r)),t===o?sH:Ze(t)?Ze(o)?sH:i&&"asc"===e?uH:cH:Ze(o)?i&&"asc"===e?cH:uH:isNaN(t)&&!isNaN(o)?"asc"===e?cH:uH:!isNaN(t)&&isNaN(o)?"asc"===e?uH:cH:(isNaN(t)||isNaN(o)||(t=parseFloat(t),o=parseFloat(o)),t<o?"asc"===e?uH:cH:t>o?"asc"===e?cH:uH:sH)}}var dH="default";function pH(e,t,n){return function(t,r){var o=parseFloat(t),i=parseFloat(r),a=n.sortEmptyCells;if(o===i||isNaN(o)&&isNaN(i))return sH;if(a){if(Ze(t))return"asc"===e?uH:cH;if(Ze(r))return"asc"===e?cH:uH}return isNaN(o)?cH:isNaN(i)?uH:o<i?"asc"===e?uH:cH:o>i?"asc"===e?cH:uH:sH}}var yH="numeric";function vH(e,t,n){var r=t.checkedTemplate,o=t.uncheckedTemplate,i=n.sortEmptyCells;return function(a,l){var s=Ze(a),u=Ze(l),c=s?o:a,f=u?o:l,h=c===o||c===r,d=f===o||f===r;if(!1===i){if(s&&!1===u)return cH;if(!1===s&&u)return uH}return!1===h&&d?"asc"===e?uH:cH:h&&!1===d?"asc"===e?cH:uH:!1===h&&!1===d?hH(e,t,n)(a,l):c===o&&f===r?"asc"===e?uH:cH:c===r&&f===o?"asc"===e?cH:uH:sH}}var gH="checkbox";function mH(e,t,n){return function(r,o){var i=n.sortEmptyCells;if(r===o)return sH;if(Ze(r))return Ze(o)?sH:i&&"asc"===e?uH:cH;if(Ze(o))return i&&"asc"===e?cH:uH;var a=t.dateFormat,l=Ye(r,a),s=Ye(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?"asc"===e?uH:cH:s.isBefore(l)?"asc"===e?cH:uH:sH:uH:cH}}var bH="date",wH=wr("sorting.compareFunctionFactory"),CH=wH.register,SH=wH.getItem,OH=wH.hasItem,kH=wr("sorting.mainSortComparator"),RH=kH.register,EH=kH.getItem;function TH(e){return OH(e)?SH(e):SH(dH)}function PH(e){return xH(e)||jH(e)||AH(e)||MH()}function MH(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function AH(e,t){if(e){if("string"===typeof e)return IH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?IH(e,t):void 0}}function IH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jH(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function xH(e){if(Array.isArray(e))return e}function _H(e,t){return function(n,r){var o=PH(n),i=o.slice(1),a=PH(r),l=a.slice(1);return function(n){var r=e[n],o=t[n],a=i[n],s=l[n],u=o.columnSorting,c=u.compareFunctionFactory?u.compareFunctionFactory:TH(o.type),f=c(r,o,u)(a,s);return f}(0)}}function HH(e){return HH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},HH(e)}CH(yH,pH),CH(gH,vH),CH(bH,mH),CH(dH,hH);var DH=["column"],NH=["column"];function LH(e){return WH(e)||FH(e)||VH(e)||BH()}function BH(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function VH(e,t){if(e){if("string"===typeof e)return UH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?UH(e,t):void 0}}function FH(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function WH(e){if(Array.isArray(e))return UH(e)}function UH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function GH(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zH(Object(n),!0).forEach((function(t){YH(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zH(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function YH(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KH(e,t){if(null==e)return{};var n,r,o=XH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function XH(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function $H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qH(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function QH(e,t,n){return t&&qH(e.prototype,t),n&&qH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function JH(){return JH="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=ZH(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},JH.apply(this,arguments)}function ZH(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=aD(e),null===e)break;return e}function eD(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tD(e,t)}function tD(e,t){return tD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},tD(e,t)}function nD(e){var t=iD();return function(){var n,r=aD(e);if(t){var o=aD(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rD(this,n)}}function rD(e,t){if(t&&("object"===HH(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return oD(e)}function oD(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iD(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function aD(e){return aD=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},aD(e)}var lD="columnSorting",sD=50,uD="append",cD="replace";RH(lD,_H),hr.getSingleton().register("beforeColumnSort"),hr.getSingleton().register("afterColumnSort");var fD=function(e){eD(n,e);var t=nD(n);function n(e){var r;return $H(this,n),r=t.call(this,e),r.columnStatesManager=null,r.columnMetaCache=null,r.pluginKey=lD,r.indexesSequenceCache=null,r}return QH(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.columnStatesManager=new z_(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Ty((function(t){var n=e.hot.toVisualColumn(t);return null===n&&(n=t),e.getMergedPluginSettings(n)})),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",(function(t,n){return e.onAfterGetColHeader(t,n)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("afterOnCellMouseDown",(function(t,n){return e.onAfterOnCellMouseDown(t,n)})),this.addHook("afterInit",(function(){return e.loadOrSortBySettings()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.hot.view&&this.loadOrSortBySettings(),JH(aD(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=this,t=function(t,n){var r=Q_(n);!1!==J_(t,n)&&null!==r&&e.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",(function(){e.hot.removeHook("afterGetColHeader",t)})),this.hot.batchExecution((function(){null!==e.indexesSequenceCache&&(e.hot.rowIndexMapper.setIndexesSequence(e.indexesSequenceCache.getValues()),e.hot.rowIndexMapper.unregisterMap(e.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,JH(aD(n.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(e){var t=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(n),o=this.hot.runHooks("beforeColumnSort",t,n,r);!1!==o&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new iy),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",t,r?n:t,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(e){return Qe(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(e){var t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}},{key:"getNormalizedSortConfigs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}},{key:"areValidSortConfigs",value:function(e){var t=this.hot.countCols();return $_(e)&&e.every((function(e){var n=e.column;return n<=t&&n>=0}))}},{key:"saveAllSortSettings",value:function(e){var t=this,n=this.columnStatesManager.getAllColumnsProperties(),r=function(e){var n=e.column,r=KH(e,DH);return GH({column:t.hot.toPhysicalColumn(n)},r)};n.initialConfig=W(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}},{key:"getAllSavedSortSettings",value:function(){var e=this,t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);var n=t.value,r=function(t){var n=t.column,r=KH(t,NH);return GH({column:e.hot.toVisualColumn(n)},r)};return Qe(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=W(n.initialConfig,r)),n}},{key:"getColumnNextConfig",value:function(e){var t=this.columnStatesManager.getSortOrderOfColumn(e);if(Qe(t)){var n=q_(t);return Qe(n)?{column:e,sortOrder:n}:void 0}var r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:q_()}}},{key:"getNextSortConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uD,n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=-1!==n,o=this.getSortConfig(),i=this.getColumnNextConfig(e);if(r){if(Je(i))return[].concat(LH(o.slice(0,n)),LH(o.slice(n+1)));if(t===uD)return[].concat(LH(o.slice(0,n)),LH(o.slice(n+1)),[i]);if(t===cD)return[].concat(LH(o.slice(0,n)),[i],LH(o.slice(n+1)))}return Qe(i)?o.concat(i):o}},{key:"getPluginColumnConfig",value:function(e){if(ce(e)){var t=e[this.pluginKey];if(ce(t))return t}return{}}},{key:"getMergedPluginSettings",value:function(e){var t=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(n,t,this.getPluginColumnConfig(o.columns[e])):jn(o.columns)?Object.assign(n,t,this.getPluginColumnConfig(o.columns(e))):Object.assign(n,t)}},{key:"getFirstCellSettings",value:function(e){var t=this.hot.getCellMeta(0,e),n=Object.create(t);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}},{key:"getNumberOfRowsToSort",value:function(e){var t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}},{key:"sortByPresetSortStates",value:function(e){var t=this;if(0!==e.length){for(var n=[],r=this.hot.countRows(),o=function(n){return W(e,(function(e){return t.hot.getDataAtCell(n,e.column)}))},i=0;i<this.getNumberOfRowsToSort(r);i+=1)n.push([this.hot.toPhysicalRow(i)].concat(o(i)));var a=W(n,(function(e){return e[0]}));fH(n,this.pluginKey,W(e,(function(e){return e.sortOrder})),W(e,(function(e){return t.getFirstCellSettings(e.column)})));for(var l=n.length;l<r;l+=1)n.push([l].concat(o(l)));var s=W(n,(function(e){return e[0]})),u=new Map(W(a,(function(e,t){return[e,s[t]]}))),c=W(this.hot.rowIndexMapper.getIndexesSequence(),(function(e){return u.has(e)?u.get(e):e}));this.hot.rowIndexMapper.setIndexesSequence(c)}else this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues())}},{key:"loadOrSortBySettings",value:function(){var e=this.getAllSavedSortSettings();if(ce(e))this.sortBySettings(e);else{var t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}},{key:"sortBySettings",value:function(e){if(ce(e)){this.columnStatesManager.updateAllColumnsProperties(e);var t=e.initialConfig;(Array.isArray(t)||ce(t))&&this.sort(t)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(e,t){var n=Q_(t);if(!1!==J_(e,t)&&null!==n){var r=this.getFirstCellSettings(e)[this.pluginKey],o=r.indicator,i=r.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,e,o,i)}}},{key:"updateHeaderClasses",value:function(e){if(zt(e,lH(e)),!1!==this.enabled){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Ut(e,aH.apply(void 0,n))}}},{key:"onUpdateSettings",value:function(e){JH(aD(n.prototype),"onUpdateSettings",this).call(this),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Qe(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}},{key:"onAfterLoadData",value:function(e){!0===e&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(e,t){var n=this.getFirstCellSettings(t)[this.pluginKey],r=n.headerAction;return r&&"SPAN"===e.target.nodeName}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){!1!==Z_(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(e,t){!1!==Z_(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}},{key:"destroy",value:function(){var e;null===(e=this.columnStatesManager)||void 0===e||e.destroy(),JH(aD(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return lD}},{key:"PLUGIN_PRIORITY",get:function(){return sD}}]),n}($A);n("61cc");function hD(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pD(e,t,n){return t&&dD(e.prototype,t),n&&dD(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var yD,vD=function(){function e(t,n){hD(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=n,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return pD(e,[{key:"getEndpoint",value:function(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(e){return this.parseSettings(e.call(this))}},{key:"parseSettings",value:function(e){var t=this,n=[],r=e;if(r||"function"!==typeof this.settings)return r||(r=this.settings),U(r,(function(e){var r={};t.assignSetting(e,r,"ranges",[[0,t.hot.countRows()-1]]),t.assignSetting(e,r,"reversedRowCoords",!1),t.assignSetting(e,r,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),t.assignSetting(e,r,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),t.assignSetting(e,r,"sourceColumn",e.destinationColumn),t.assignSetting(e,r,"type","sum"),t.assignSetting(e,r,"forceNumeric",!1),t.assignSetting(e,r,"suppressDataTypeErrors",!0),t.assignSetting(e,r,"suppressDataTypeErrors",!0),t.assignSetting(e,r,"customFunction",null),t.assignSetting(e,r,"readOnly",!0),t.assignSetting(e,r,"roundFloat",!1),n.push(r)})),n;this.settingsType="function"}},{key:"assignSetting",value:function(e,t,n,r){if("ranges"!==n||void 0!==e[n]){if("ranges"!==n||0!==e[n].length)if(void 0===e[n]){if(r instanceof Error)throw r;t[n]=r}else"destinationRow"===n&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]}else t[n]=r}},{key:"resetSetupBeforeStructureAlteration",value:function(e,t,n){if("function"===this.settingsType){var r=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();U(o,(function(o){"row"===r&&o.destinationRow>=t&&("insert_row"===e?o.alterRowOffset=n:"remove_row"===e&&(o.alterRowOffset=-1*n)),"col"===r&&o.destinationColumn>=t&&("insert_col"===e?o.alterColumnOffset=n:"remove_col"===e&&(o.alterColumnOffset=-1*n))})),this.resetAllEndpoints(o,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(e,t,n,r,o){var i=this,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"!==this.settingsType){var l=e.indexOf("row")>-1?"row":"col",s=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=0===e.indexOf("move_row"),f=t;U(u,(function(e){"row"===l&&e.destinationRow>=f&&(e.alterRowOffset=s*n),"col"===l&&e.destinationColumn>=f&&(e.alterColumnOffset=s*n)})),this.resetAllEndpoints(u,!c),U(u,c?function(e){i.extendEndpointRanges(e,f,r[0],r.length),i.recreatePhysicalRanges(e),i.clearOffsetInformation(e)}:function(e){i.shiftEndpointCoordinates(e,f)}),a&&this.refreshAllEndpoints()}else{var h=function e(){return i.hot.removeHook("beforeViewRender",e),i.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",h)}}},{key:"clearOffsetInformation",value:function(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(e,t,n,r){U(e.ranges,(function(e){e[1]&&(t>=e[0]&&t<=e[1]?n>e[1]?e[1]+=r:n<e[0]&&(e[0]-=r):n>=e[0]&&n<=e[1]&&(e[1]-=r,t<=e[0]&&(e[0]+=1,e[1]+=1)))}))}},{key:"recreatePhysicalRanges",value:function(e){var t=this,n=e.ranges,r=[],o=[];U(n,(function(e){var n=[];if(e[1])for(var r=e[0];r<=e[1];r++)n.push(t.hot.toPhysicalRow(r));else n.push(t.hot.toPhysicalRow(e[0]));o.push(n)})),U(o,(function(e){var t=[];U(e,(function(n,o){0===o?t.push(n):e[o]!==e[o-1]+1&&(t.push(e[o-1]),r.push(t),t=[],t.push(n)),o===e.length-1&&(t.push(n),r.push(t))}))})),e.ranges=r}},{key:"shiftEndpointCoordinates",value:function(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,U(e.ranges,(function(n){U(n,(function(r,o){r>=t&&(n[o]+=e.alterRowOffset||0)}))}))):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t.some((function(t){var n=t.alterRowOffset||0,r=t.alterColumnOffset||0;return t.destinationRow+n>=e.hot.countRows()||t.destinationColumn+r>=e.hot.countCols()}));r||(this.cellsToSetCache=[],U(t,(function(t){e.resetEndpointValue(t,n)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var e=this;this.cellsToSetCache=[],U(this.getAllEndpoints(),(function(t){e.currentEndpoint=t,e.plugin.calculate(t),e.setEndpointValue(t,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(e){var t=this,n=[];this.cellsToSetCache=[],U(e,(function(e,r,o){"".concat(e[2]||"")!=="".concat(e[3])&&U(t.getAllEndpoints(),(function(e,i){t.hot.propToCol(o[r][1])===e.sourceColumn&&-1===n.indexOf(i)&&n.push(i)}))})),U(n,(function(e){t.refreshEndpoint(t.getEndpoint(e))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?n:0)),this.hot.toVisualColumn(e.destinationColumn+(t?r:0)),""])}},{key:"setEndpointValue",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols())this.throwOutOfBoundsWarning();else{var o=this.hot.toVisualRow(e.destinationRow);if(null!==o){var i=this.hot.getCellMeta(o,e.destinationColumn);"init"!==t&&i.readOnly===e.readOnly||(i.readOnly=e.readOnly,i.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),n?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}}},{key:"throwOutOfBoundsWarning",value:function(){Fn("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}(),gD=vD;function mD(e){return null===e||void 0===e||isNaN(e)}function bD(e){return bD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bD(e)}function wD(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function CD(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OD(e,t,n){return t&&SD(e.prototype,t),n&&SD(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function kD(){return kD="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=RD(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},kD.apply(this,arguments)}function RD(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=jD(e),null===e)break;return e}function ED(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TD(e,t)}function TD(e,t){return TD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},TD(e,t)}function PD(e){var t=ID();return function(){var n,r=jD(e);if(t){var o=jD(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return MD(this,n)}}function MD(e,t){if(t&&("object"===bD(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return AD(e)}function AD(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ID(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function jD(e){return jD=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jD(e)}var xD="columnSummary",_D=220,HD=function(e){ED(n,e);var t=PD(n);function n(e){var r;return CD(this,n),r=t.call(this,e),r.endpoints=null,r}return OD(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[xD]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[xD],this.endpoints=new gD(this,this.settings),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange.apply(e,arguments)})),this.addHook("beforeCreateRow",(function(t,n,r){return e.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,n,null,r)})),this.addHook("beforeCreateCol",(function(t,n,r){return e.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,n,null,r)})),this.addHook("beforeRemoveRow",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_row"].concat(r))})),this.addHook("beforeRemoveCol",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_col"].concat(r))})),this.addHook("afterCreateRow",(function(t,n,r){return e.endpoints.resetSetupAfterStructureAlteration("insert_row",t,n,null,r)})),this.addHook("afterCreateCol",(function(t,n,r){return e.endpoints.resetSetupAfterStructureAlteration("insert_col",t,n,null,r)})),this.addHook("afterRemoveRow",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_row"].concat(r))})),this.addHook("afterRemoveCol",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_col"].concat(r))})),this.addHook("afterRowMove",(function(){return e.onAfterRowMove.apply(e,arguments)})),kD(jD(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break;default:break}}},{key:"calculateSum",value:function(e){var t=this,n=0;return he(e.ranges,(function(r){n+=t.getPartialSum(r,e.sourceColumn)})),n}},{key:"getPartialSum",value:function(e,t){var n=0,r=e[1]||e[0],o=null,i=0;do{if(o=this.getCellValue(r,t),o=mD(o)?null:o,null!==o){var a=("".concat(o).split(".")[1]||[]).length||1;a>i&&(i=a)}n+=o||0,r-=1}while(r>=e[0]);return Math.round(n*Math.pow(10,i))/Math.pow(10,i)}},{key:"calculateMinMax",value:function(e,t){var n=this,r=null;return he(e.ranges,(function(o){var i=n.getPartialMinMax(o,e.sourceColumn,t);if(null===r&&null!==i&&(r=i),null!==i)switch(t){case"min":r=Math.min(r,i);break;case"max":r=Math.max(r,i);break;default:break}})),null===r?"Not enough data":r}},{key:"getPartialMinMax",value:function(e,t,n){var r,o=null,i=e[1]||e[0];do{if(r=this.getCellValue(i,t),r=mD(r)?null:r,null===o)o=r;else if(null!==r)switch(n){case"min":o=Math.min(o,r);break;case"max":o=Math.max(o,r);break;default:break}i-=1}while(i>=e[0]);return o}},{key:"countEmpty",value:function(e,t){var n,r=0,o=e[1]||e[0];do{n=this.getCellValue(o,t),n=mD(n)?null:n,null===n&&(r+=1),o-=1}while(o>=e[0]);return r}},{key:"countEntries",value:function(e){var t=this,n=0,r=e.ranges;return he(r,(function(r){var o=void 0===r[1]?1:r[1]-r[0]+1,i=t.countEmpty(r,e.sourceColumn);n+=o,n-=i})),n}},{key:"calculateAverage",value:function(e){var t=this.calculateSum(e),n=this.countEntries(e);return t/n}},{key:"getCellValue",value:function(e,t){var n=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(t),o=this.hot.getSourceDataAtCell(e,t),i="";if(null!==n&&null!==r&&(i=this.hot.getCellMeta(n,r).className||""),i.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"===typeof o&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Ke(yD||(yD=wD(["ColumnSummary plugin: cell at (",", ",") is not in a \n          numeric format. Cannot do the calculation."],["ColumnSummary plugin: cell at (",", ",") is not in a\\x20\n          numeric format. Cannot do the calculation."])),e,t));return o}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(e,t){e&&"ColumnSummary.reset"!==t&&"ColumnSummary.set"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)}},{key:"onAfterRowMove",value:function(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return xD}},{key:"PLUGIN_PRIORITY",get:function(){return _D}}]),n}($A);function DD(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ND(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LD(e,t,n){return t&&ND(e.prototype,t),n&&ND(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var BD=function(){function e(t,n){DD(this,e),this.rootDocument=t,this.isRtl=n,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return LD(e,[{key:"setPosition",value:function(e,t){this.editorStyle.left="".concat(e,"px"),this.editorStyle.top="".concat(t,"px")}},{key:"setSize",value:function(e,t){if(e&&t){var n=this.getInputElement();n.style.width="".concat(e,"px"),n.style.height="".concat(t,"px")}}},{key:"getSize",value:function(){return{width:un(this.getInputElement()),height:cn(this.getInputElement())}}},{key:"resetSize",value:function(){var e=this.getInputElement();e.style.width="",e.style.height=""}},{key:"setReadOnlyState",value:function(e){var t=this.getInputElement();t.readOnly=e}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e||"";this.getInputElement().value=t}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var t=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return t.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Ut(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Ut(t,e.CLASS_EDITOR),Ut(n,e.CLASS_INPUT),t.appendChild(n),this.container.appendChild(t),t}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}(),VD=BD,FD="---------";function WD(){return{name:FD}}function UD(e){return W(e,(function(e){return{start:e.getTopStartCorner(),end:e.getBottomEndCorner()}}))}function zD(e){return Wt(e,"htSeparator")}function GD(e){return Wt(e,"htSubmenu")}function YD(e){return Wt(e,"htDisabled")}function KD(e){return Wt(e,"htSelectionDisabled")}function XD(e){var t=e.getSelected();return t?t[0]<0?null:t:null}function $D(e,t){if(-1!==e.indexOf(t))return e;var n=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(n," ").concat(t)}function qD(e,t){if(-1!==e.indexOf(t))return e;var n=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(n," ").concat(t)}function QD(e,t){var n={};return U(e,(function(e){e.forAll((function(e,r){e>=0&&r>=0&&(n[e]||(n[e]=[]),n[e][r]=t(e,r))}))})),n}function JD(e,t,n,r,o){U(e,(function(e){e.forAll((function(e,i){e>=0&&i>=0&&ZD(e,i,t,n,r,o)}))}))}function ZD(e,t,n,r,o,i){var a=o(e,t),l=r;a.className&&(l="vertical"===n?$D(a.className,r):qD(a.className,r)),i(e,t,"className",l)}function eN(e,t){var n=!1;return Array.isArray(e)&&U(e,(function(e){return e.forAll((function(e,r){if(e>=0&&r>=0&&t(e,r))return n=!0,!1})),n})),n}function tN(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function nN(e,t){return!e.hidden||!("function"===typeof e.hidden&&e.hidden.call(t))}function rN(e,t){for(var n=e.slice(0),r=0;r<n.length;){if(n[r].name!==t)break;n.shift()}return n}function oN(e,t){var n=e.slice(0);return n.reverse(),n=rN(n,t),n.reverse(),n}function iN(e){var t=[];return U(e,(function(e,n){n>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)})),t}function aN(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:FD,n=e.slice(0);return n=rN(n,t),n=oN(n,t),n=iN(n),n}function lN(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uN(e,t,n){return t&&sN(e.prototype,t),n&&sN(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var cN=250,fN=250,hN=function(){function e(t){lN(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return uN(e,[{key:"hide",value:function(){var e=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout((function(){!1===e.wasLastActionShow&&e.runLocalHooks("hide")}),fN)}},{key:"show",value:function(e){this.wasLastActionShow=!0,this.showDebounced(e)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cN;this.showDebounced=Hn((function(t){e.wasLastActionShow&&e.runLocalHooks("show",t.from.row,t.from.col)}),t)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();se(hN,Ip);var dN=hN;function pN(e){return pN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pN(e)}function yN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vN(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mN(e,t,n){return t&&gN(e.prototype,t),n&&gN(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function bN(){return bN="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=wN(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},bN.apply(this,arguments)}function wN(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=TN(e),null===e)break;return e}function CN(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SN(e,t)}function SN(e,t){return SN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},SN(e,t)}function ON(e){var t=EN();return function(){var n,r=TN(e);if(t){var o=TN(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kN(this,n)}}function kN(e,t){if(t&&("object"===pN(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return RN(e)}function RN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EN(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function TN(e){return TN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},TN(e)}var PN="comments",MN=60,AN=new WeakMap,IN="comment",jN="value",xN="style",_N="readOnly",HN=function(e){CN(n,e);var t=ON(n);function n(e){var r;return vN(this,n),r=t.call(this,e),r.editor=null,r.displaySwitch=null,r.eventManager=null,r.range={},r.preventEditorAutoSwitch=!1,AN.set(RN(r),{tempEditorDimensions:{},cellBelowCursor:null}),r}return mN(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PN]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.editor||(this.editor=new VD(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Nr(this)),this.displaySwitch||(this.displaySwitch=new dN(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(function(t){return e.addToContextMenu(t)})),this.addHook("afterRenderer",(function(t,n,r,o,i,a){return e.onAfterRenderer(t,a)})),this.addHook("afterScrollHorizontally",(function(){return e.hide()})),this.addHook("afterScrollVertically",(function(){return e.hide()})),this.addHook("afterBeginEditing",(function(){return e.hide()})),this.displaySwitch.addLocalHook("hide",(function(){return e.hide()})),this.displaySwitch.addLocalHook("show",(function(t,n){return e.showAtCell(t,n)})),this.registerListeners(),bN(TN(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),bN(TN(n.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){bN(TN(n.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var e=this,t=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(t,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()})),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",(function(){return e.onEditorBlur()})),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",(function(t){return e.onEditorMouseDown(t)})),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",(function(t){return e.onEditorMouseUp(t)}))}},{key:"setRange",value:function(e){this.range=e}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(e){var t=_t(e.target,"TD","TBODY");return!!(t&&Wt(t,"htCommentCell")&&_t(t,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(e){return this.editor.getInputElement()===e.target}},{key:"setComment",value:function(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.editor.getValue(),n="";null!==e&&void 0!==e?n=e:null!==t&&void 0!==t&&(n=t);var r=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(r,o,yN({},jN,n)),this.hot.render()}},{key:"setCommentAtCell",value:function(e,t,n){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(n)}},{key:"removeComment",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,IN),e&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(n)}},{key:"getComment",value:function(){var e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,jN)}},{key:"getCommentAtCell",value:function(e,t){return this.getCommentMeta(e,t,jN)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.range.from,t=e.row,n=e.col;if(t<0||t>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;var r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(r[IN]?r[IN][jN]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(n||this.range.from&&this.editor.isVisible()){var r=this.hot,o=r.rowIndexMapper,i=r.columnIndexMapper,a=this.range.from,l=a.row,s=a.col,u=o.getRenderableFromVisualIndex(l),c=i.getRenderableFromVisualIndex(s),f=null===u;this.editor.setPosition(0,0),null===u&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(l,-1))),null===c&&(c=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1)));var h=null===u,d=null===c;u=null!==(e=u)&&void 0!==e?e:0,c=null!==(t=c)&&void 0!==t?t:0;var p=this.hot,y=p.rootWindow,v=p.view._wt,g=v.wtTable,m=v.getCell({row:u,col:c},!0),b=this.getCommentMeta(l,s,xN);b?this.editor.setSize(b.width,b.height):this.editor.resetSize();var w=d?0:g.getStretchedColumnWidth(c),C=f&&!h?cn(m):0,S=m.getBoundingClientRect(),O=S.left,k=S.top,R=S.width,E=S.height,T=this.editor.getSize(),P=T.width,M=T.height,A=this.hot.rootWindow,I=A.innerWidth,j=A.innerHeight,x=this.hot.rootDocument.documentElement,_=O+y.scrollX+w,H=k+y.scrollY+C;this.hot.isRtl()&&(_-=P+w),this.hot.isLtr()&&O+R+P>I?_=O+y.scrollX-P-1:this.hot.isRtl()&&_<-(x.scrollWidth-x.clientWidth)&&(_=O+y.scrollX+w+1),k+M>j&&(H-=M-E+1),this.editor.setPosition(_,H),this.editor.setReadOnlyState(this.getCommentMeta(l,s,_N))}}},{key:"checkSelectionCommentsConsistency",value:function(){var e=this.hot.getSelectedRangeLast();if(!e)return!1;var t=!1,n=e.getTopStartCorner();return this.getCommentMeta(n.row,n.col,jN)&&(t=!0),t}},{key:"updateCommentMeta",value:function(e,t,n){var r,o=this.hot.getCellMeta(e,t)[IN];o?(r=ae(o),ie(r,n)):r=n,this.hot.setCellMeta(e,t,IN,r)}},{key:"getCommentMeta",value:function(e,t,n){var r=this.hot.getCellMeta(e,t);if(r[IN])return r[IN][n]}},{key:"onMouseDown",value:function(e){if(this.hot.view&&this.hot.view._wt&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(e)){var t=_t(e.target,"TD","TBODY"),n=null;t&&(n=this.hot.getCoords(t)),(!t||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}},{key:"onMouseOver",value:function(e){var t=AN.get(this),n=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Wt(e.target,"wtBorder")||t.cellBelowCursor===e.target)&&this.editor)if(t.cellBelowCursor=n.elementFromPoint(e.clientX,e.clientY),this.targetIsCellWithComment(e)){var r=this.hot._createCellRange(this.hot.getCoords(e.target));this.displaySwitch.show(r)}else Dt(e.target,n)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(e,t){t[IN]&&t[IN][jN]&&Ut(e,t.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(e){var t=AN.get(this);t.tempEditorDimensions={width:un(e.target),height:cn(e.target)}}},{key:"onEditorMouseUp",value:function(e){var t=AN.get(this),n=un(e.target),r=cn(e.target);n===t.tempEditorDimensions.width+1&&r===t.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,yN({},xN,{width:n,height:r}))}},{key:"onContextMenuAddComment",value:function(){var e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:e.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var e=this,t=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,t.forAll((function(t,n){t>=0&&n>=0&&e.removeCommentAtCell(t,n,!1)})),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var e=this,t=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,t.forAll((function(t,n){if(t>=0&&n>=0){var r=!!e.getCommentMeta(t,n,_N);e.updateCommentMeta(t,n,yN({},_N,!r))}}))}},{key:"addToContextMenu",value:function(e){var t=this,n=function(){return t.hot.rowIndexMapper.getRenderableIndexesLength()>0&&t.hot.columnIndexMapper.getRenderableIndexesLength()>0};e.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return t.checkSelectionCommentsConsistency()?t.hot.getTranslatedPhrase(sm):t.hot.getTranslatedPhrase(lm)},callback:function(){return t.onContextMenuAddComment()},disabled:function(){return!n()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(um)},callback:function(){return t.onContextMenuRemoveComment()},disabled:function(){return!n()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner())}},{key:"commentsReadOnly",name:function(){var e=this,t=this.getTranslatedPhrase(cm),n=eN(this.getSelectedRangeLast(),(function(t,n){var r=e.getCellMeta(t,n)[IN];if(r&&(r=r[_N]),r)return!0}));return n&&(t=tN(t)),t},callback:function(){return t.onContextMenuMakeReadOnly()},disabled:function(){return!n()||(!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner())||!t.checkSelectionCommentsConsistency())}})}},{key:"getDisplayDelaySetting",value:function(){var e=this.hot.getSettings()[PN];if(ce(e))return e.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),bN(TN(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PN}},{key:"PLUGIN_PRIORITY",get:function(){return MN}}]),n}($A);function DN(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NN(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LN(e,t,n){return t&&NN(e.prototype,t),n&&NN(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var BN=function(){function e(t){DN(this,e),this.hot=t,this.commands={},this.commonCallback=null}return LN(e,[{key:"registerCommand",value:function(e,t){this.commands[e]=t}},{key:"setCommonCallback",value:function(e){this.commonCallback=e}},{key:"execute",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=e.split(":"),a=i[0],l=2===i.length?i[1]:null,s=this.commands[a];if(!s)throw new Error("Menu command '".concat(a,"' not exists."));if(l&&s.submenu&&(s=VN(l,s.submenu.items)),!0!==s.disabled&&("function"!==typeof s.disabled||!0!==s.disabled.call(this.hot))&&!ge(s,"submenu")){var u=[];"function"===typeof s.callback&&u.push(s.callback),"function"===typeof this.commonCallback&&u.push(this.commonCallback),r.unshift(i.join(":")),U(u,(function(e){return e.apply(t.hot,r)}))}}}]),e}();function VN(e,t){var n;return U(t,(function(t){var r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===e)return n=t,!1})),n}var FN=BN,WN="alignment";function UN(){return{key:WN,name:function(){return this.getTranslatedPhrase(fm)},disabled:function(){return 0===this.countRows()||0===this.countCols()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(WN,":left"),name:function(){var e=this,t=this.getTranslatedPhrase(hm),n=eN(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htLeft"))return!0}));return n&&(t=tN(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=QD(t,(function(t,n){return e.getCellMeta(t,n).className})),r="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",n,t,r,o),JD(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(WN,":center"),name:function(){var e=this,t=this.getTranslatedPhrase(dm),n=eN(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htCenter"))return!0}));return n&&(t=tN(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=QD(t,(function(t,n){return e.getCellMeta(t,n).className})),r="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",n,t,r,o),JD(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(WN,":right"),name:function(){var e=this,t=this.getTranslatedPhrase(pm),n=eN(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htRight"))return!0}));return n&&(t=tN(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=QD(t,(function(t,n){return e.getCellMeta(t,n).className})),r="horizontal",o="htRight";this.runHooks("beforeCellAlignment",n,t,r,o),JD(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(WN,":justify"),name:function(){var e=this,t=this.getTranslatedPhrase(ym),n=eN(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htJustify"))return!0}));return n&&(t=tN(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=QD(t,(function(t,n){return e.getCellMeta(t,n).className})),r="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",n,t,r,o),JD(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{name:FD},{key:"".concat(WN,":top"),name:function(){var e=this,t=this.getTranslatedPhrase(vm),n=eN(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htTop"))return!0}));return n&&(t=tN(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=QD(t,(function(t,n){return e.getCellMeta(t,n).className})),r="vertical",o="htTop";this.runHooks("beforeCellAlignment",n,t,r,o),JD(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(WN,":middle"),name:function(){var e=this,t=this.getTranslatedPhrase(gm),n=eN(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htMiddle"))return!0}));return n&&(t=tN(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=QD(t,(function(t,n){return e.getCellMeta(t,n).className})),r="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",n,t,r,o),JD(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1},{key:"".concat(WN,":bottom"),name:function(){var e=this,t=this.getTranslatedPhrase(mm),n=eN(this.getSelectedRange(),(function(t,n){var r=e.getCellMeta(t,n).className;if(r&&-1!==r.indexOf("htBottom"))return!0}));return n&&(t=tN(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=QD(t,(function(t,n){return e.getCellMeta(t,n).className})),r="vertical",o="htBottom";this.runHooks("beforeCellAlignment",n,t,r,o),JD(t,r,o,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),this.render()},disabled:!1}]}}}var zN="clear_column";function GN(){return{key:zN,name:function(){return this.getTranslatedPhrase(Qg)},callback:function(e,t){var n=t[0].start.col,r=t[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t[0].start.row,t[0].end.row),r,"ContextMenu.clearColumn")},disabled:function(){var e=XD(this);return!e||!this.selection.isSelectedByColumnHeader()}}}var YN="col_left";function KN(){return{key:YN,name:function(){return this.getTranslatedPhrase(zg)},callback:function(){var e=this.getSelectedRangeLast().getTopLeftCorner(),t=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(t,e.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=XD(this);if(!e)return!0;if(this.selection.isSelectedByCorner()){var t=this.countCols();return 0===t}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var XN="col_right";function $N(){return{key:XN,name:function(){return this.getTranslatedPhrase(Gg)},callback:function(){var e=this.getSelectedRangeLast().getTopRightCorner(),t=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(t,e.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=XD(this);return!e||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden:function(){return!this.getSettings().allowInsertColumn}}}var qN="make_read_only";function QN(){return{key:qN,name:function(){var e=this,t=this.getTranslatedPhrase(qg),n=eN(this.getSelectedRange(),(function(t,n){return e.getCellMeta(t,n).readOnly}));return n&&(t=tN(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=eN(t,(function(t,n){return e.getCellMeta(t,n).readOnly}));U(t,(function(t){t.forAll((function(t,r){t>=0&&r>=0&&e.setCellMeta(t,r,"readOnly",!n)}))})),this.render()},disabled:function(){return!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))}}}var JN="redo";function ZN(){return{key:JN,name:function(){return this.getTranslatedPhrase($g)},callback:function(){this.redo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function eL(e,t){return iL(e)||oL(e,t)||nL(e,t)||tL()}function tL(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function nL(e,t){if(e){if("string"===typeof e)return rL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rL(e,t):void 0}}function rL(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oL(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function iL(e){if(Array.isArray(e))return e}var aL="remove_col";function lL(){return{key:aL,name:function(){var e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{var n=eL(e[0],4),r=n[1],o=n[3];r-o!==0&&(t=1)}return this.getTranslatedPhrase(Kg,t)},callback:function(){this.alter("remove_col",lS(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=XD(this);if(!e)return!0;var t=this.countCols();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByRowHeader()||0===t},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function sL(e,t){return dL(e)||hL(e,t)||cL(e,t)||uL()}function uL(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function cL(e,t){if(e){if("string"===typeof e)return fL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fL(e,t):void 0}}function fL(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hL(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function dL(e){if(Array.isArray(e))return e}var pL="remove_row";function yL(){return{key:pL,name:function(){var e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{var n=sL(e[0],3),r=n[0],o=n[2];r-o!==0&&(t=1)}return this.getTranslatedPhrase(Yg,t)},callback:function(){this.alter("remove_row",sS(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var e=XD(this);if(!e)return!0;var t=this.countRows();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByColumnHeader()||0===t},hidden:function(){return!this.getSettings().allowRemoveRow}}}var vL="row_above";function gL(){return{key:vL,name:function(){return this.getTranslatedPhrase(Wg)},callback:function(){var e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled:function(){var e=XD(this);if(!e)return!0;if(this.selection.isSelectedByCorner()){var t=this.countRows();return 0===t}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var mL="row_below";function bL(){return{key:mL,name:function(){return this.getTranslatedPhrase(Ug)},callback:function(){var e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled:function(){var e=XD(this);return!e||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}}var wL="no_items";function CL(){return{key:wL,name:function(){return this.getTranslatedPhrase(Fg)},disabled:!0,isCommand:!1}}var SL,OL="undo";function kL(){return{key:OL,name:function(){return this.getTranslatedPhrase(Xg)},callback:function(){this.undo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function RL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var EL=[vL,mL,YN,XN,zN,pL,aL,OL,JN,qN,WN,FD,wL],TL=(SL={},RL(SL,FD,WD),RL(SL,wL,CL),RL(SL,vL,gL),RL(SL,mL,bL),RL(SL,YN,KN),RL(SL,XN,$N),RL(SL,zN,GN),RL(SL,pL,yL),RL(SL,aL,lL),RL(SL,OL,kL),RL(SL,JN,ZN),RL(SL,qN,QN),RL(SL,WN,UN),SL);function PL(){var e={};return he(TL,(function(t,n){e[n]=t()})),e}function ML(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IL(e,t,n){return t&&AL(e.prototype,t),n&&AL(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var jL=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;ML(this,e),this.hot=t,this.predefinedItems=PL(),this.defaultOrderPattern=n}return IL(e,[{key:"setPredefinedItems",value:function(e){var t=this,n={};this.defaultOrderPattern.length=0,he(e,(function(e,r){var o="";e.name===FD?(n[FD]=e,o=FD):isNaN(parseInt(r,10))?(e.key=void 0===e.key?r:e.key,n[r]=e,o=e.key):(n[e.key]=e,o=e.key),t.defaultOrderPattern.push(o)})),this.predefinedItems=n}},{key:"getItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return xL(e,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function xL(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),ce(o)?he(o,(function(e,t){var o=n["string"===typeof e?e:t];o||(o=e),ce(e)?oe(o,e):"string"===typeof o&&(o={name:o}),void 0===o.key&&(o.key=t),r.push(o)})):U(o,(function(e,t){var o=n[e];!o&&EL.indexOf(e)>=0||(o||(o={name:e,key:"".concat(t)}),ce(e)&&oe(o,e),void 0===o.key&&(o.key=t),r.push(o))})),r}var _L=jL;function HL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NL(e,t,n){return t&&DL(e.prototype,t),n&&DL(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var LL=function(){function e(t,n){HL(this,e);var r,o,i,a,l,s,u=Zt(n),c=en(n);this.rootWindow=n,this.type=this.getSourceType(t),"literal"===this.type?(r=parseInt(t.top,10),i=parseInt(t.left,10),l=t.height||0,s=t.width||0,o=r,a=i,r+=u,i+=c):"event"===this.type&&(r=parseInt(t.pageY,10),i=parseInt(t.pageX,10),l=t.target.clientHeight,s=t.target.clientWidth,o=r-u,a=i-c),this.top=r,this.topRelative=o,this.left=i,this.leftRelative=a,this.scrollTop=u,this.scrollLeft=c,this.cellHeight=l,this.cellWidth=s}return NL(e,[{key:"getSourceType",value:function(e){var t="literal";return e instanceof Event&&(t="event"),t}},{key:"fitsAbove",value:function(e){return this.topRelative>=e.offsetHeight}},{key:"fitsBelow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}},{key:"fitsOnRight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}},{key:"fitsOnLeft",value:function(e){return this.leftRelative>=e.offsetWidth}}]),e}(),BL=LL;function VL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function FL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?VL(Object(n),!0).forEach((function(t){WL(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function WL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function UL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GL(e,t,n){return t&&zL(e.prototype,t),n&&zL(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var YL=215,KL="menu",XL=KL,$L=function(){function e(t,n){UL(this,e),this.hot=t,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:YL,container:this.hot.rootDocument.documentElement},this.eventManager=new Nr(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return GL(e,[{key:"registerEvents",value:function(){var e=this,t=this.hot.rootWindow;while(t)this.eventManager.addEventListener(t.document,"mousedown",(function(t){return e.onDocumentMouseDown(t)})),this.eventManager.addEventListener(t.document,"contextmenu",(function(t){return e.onDocumentContextMenu(t)})),t=jt(t)}},{key:"setMenuItems",value:function(e){this.menuItems=e}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[e]=t}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var t=Hn((function(t){return e.openSubMenu(t)}),300),n=this.options.minWidth||YL,r=!1,o=F(this.menuItems,(function(t){return t.key===wL&&(r=!0),nN(t,e.hot)}));if(o.length<1&&!r)o.push(PL()[wL]);else if(0===o.length)return;o=aN(o,FD);var i=!1,a={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(e){return Qe(e)&&e<n?n:e},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(t,n,r,o,i,a){return e.menuItemRenderer(t,n,r,o,i,a)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(n,r){e.isAllSubMenusClosed()?t(r.row):e.openSubMenu(r.row)},rowHeights:function(e){return o[e].name===FD?1:23},afterOnCellContextMenu:function(t){t.preventDefault(),De()&&i&&e.hasSelectedItem()&&e.close(!0)},beforeOnCellMouseUp:function(t){e.hasSelectedItem()&&(i=!e.isCommandPassive(e.getSelectedItem()),e.executeCommand(t))},afterOnCellMouseUp:function(t){De()&&Zn(t)||!i||!e.hasSelectedItem()||(xe()||He()?setTimeout((function(){return e.close(!0)}),325):e.close(!0))},afterUnlisten:function(){!e.hasSelectedItem()&&e.isOpened()&&e.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new Dk(this.container,a),this.hotMenu.addHook("afterInit",(function(){return e.onAfterInit()})),this.hotMenu.addHook("afterSelection",(function(){return e.onAfterSelection.apply(e,arguments)})),this.hotMenu.init(),this.hotMenu.listen();var l=this.hotMenu.getShortcutManager(),s=l.addContext(XL),u={group:KL},c=FL(FL({},u),{},{runOnlyIf:function(t){return!1===Tn(t.target)||!1===e.container.contains(t.target)}});l.setActiveContextName("menu"),s.addShortcuts([{keys:[["Escape"]],callback:function(){e.keyEvent=!0,e.close(),e.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.selectNextCell(t[0],t[1]):e.selectFirstCell(),e.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.selectPrevCell(t[0],t[1]):e.selectLastCell(),e.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var t=e.hotMenu.getSelectedLast();if(e.keyEvent=!0,t){var n=e.openSubMenu(t[0]);n&&n.selectFirstCell()}e.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t&&e.isSubMenu()&&(e.close(),e.parentMenu&&e.parentMenu.hotMenu.listen()),e.keyEvent=!1}},{keys:[["Enter"]],callback:function(t){var n=e.hotMenu.getSelectedLast();e.keyEvent=!0,e.hotMenu.getSourceDataAtRow(n[0]).submenu||(e.executeCommand(t),e.close(!0)),e.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.hotMenu.selection.transformStart(-e.hotMenu.countVisibleRows(),0):e.selectFirstCell(),e.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.hotMenu.selection.transformStart(e.hotMenu.countVisibleRows(),0):e.selectLastCell(),e.keyEvent=!1}}],c),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(t){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!n||!GD(n))return!1;var r=this.hotMenu.getSourceDataAtRow(t),o=new e(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(r.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=o,o}},{key:"closeSubMenu",value:function(e){var t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];n&&(n.destroy(),delete this.hotSubMenus[t.key])}},{key:"closeAllSubMenus",value:function(){var e=this;U(this.hotMenu.getData(),(function(t,n){return e.closeSubMenu(n)}))}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){var e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(e){if(this.isOpened()&&this.hasSelectedItem()){var t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),!this.isCommandPassive(t)){var n=this.hot.getSelectedRange(),r=n?UD(n):[];this.runLocalHooks("executeCommand",t.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,e)}}}},{key:"isCommandPassive",value:function(e){var t=e.isCommand,n=e.name,r=e.disabled,o=e.submenu,i=!0===r||"function"===typeof r&&!0===r.call(this.hot);return!1===t||n===FD||!0===i||o}},{key:"setPosition",value:function(e){var t=new BL(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),this.hot.isLtr()?this.setHorizontalPositionForLtr(t):this.setHorizontalPositionForRtl(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))}},{key:"setHorizontalPositionForRtl",value:function(e){e.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(e):this.setPositionOnRightOfCursor(e)}},{key:"setHorizontalPositionForLtr",value:function(e){e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)}},{key:"setPositionAboveCursor",value:function(e){var t=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(t=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(t,"px")}},{key:"setPositionBelowCursor",value:function(e){var t=this.offset.below+e.top+1;this.isSubMenu()&&(t=e.top-1),this.container.style.top="".concat(t,"px")}},{key:"setPositionOnRightOfCursor",value:function(e){var t=e.left;if(this.isSubMenu()){var n=this.parentMenu.container.getBoundingClientRect(),r=n.right;t+=e.cellWidth+r-(e.left+e.cellWidth)}else t+=this.offset.right;this.container.style.left="".concat(t,"px")}},{key:"setPositionOnLeftOfCursor",value:function(e){var t=this.offset.left+e.left-this.container.offsetWidth;if(this.isSubMenu()){var n=this.parentMenu.container.getBoundingClientRect(),r=n.left;t-=e.left-r}this.container.style.left="".concat(t,"px")}},{key:"selectFirstCell",value:function(){var e=this.hotMenu.getCell(0,0);zD(e)||YD(e)||KD(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);zD(t)||YD(t)||KD(t)?this.selectPrevCell(e,0):(this.hotMenu.selectCell(e,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(e,0,!0,!1))}},{key:"selectNextCell",value:function(e,t){var n=e+1,r=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,t):null;r&&(zD(r)||YD(r)||KD(r)?this.selectNextCell(n,t):this.hotMenu.selectCell(n,t))}},{key:"selectPrevCell",value:function(e,t){var n=e-1,r=n>=0?this.hotMenu.getCell(n,t):null;r&&(zD(r)||YD(r)||KD(r)?this.selectPrevCell(n,t):this.hotMenu.selectCell(n,t))}},{key:"menuItemRenderer",value:function(e,t,n,r,o,i){var a=this,l=e.getSourceDataAtRow(n),s=this.hot.rootDocument.createElement("div"),u=function(e){return ge(e,"submenu")},c=function(e){return new RegExp(FD,"i").test(e.name)},f=function(e){return!0===e.disabled||"function"===typeof e.disabled&&!0===e.disabled.call(a.hot)},h=function(e){return e.disableSelection},d=i;"function"===typeof d&&(d=d.call(this.hot)),Yt(t),Ut(s,"htItemWrapper"),t.appendChild(s),c(l)?Ut(t,"htSeparator"):"function"===typeof l.renderer?(Ut(t,"htCustomMenuRenderer"),t.appendChild(l.renderer(e,s,n,r,o,d))):$t(s,d),f(l)?(Ut(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()}))):h(l)?(Ut(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()}))):u(l)?(Ut(t,"htSubmenu"),h(l)?this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})):this.eventManager.addEventListener(t,"mouseenter",(function(){return e.selectCell(n,r,void 0,void 0,!1,!1)}))):(zt(t,["htSubmenu","htDisabled"]),h(l)?this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})):this.eventManager.addEventListener(t,"mouseenter",(function(){return e.selectCell(n,r,void 0,void 0,!1,!1)})))}},{key:"createContainer",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.options.container.ownerDocument,r=t;return r&&(jn(r)&&(r=r.call(this.hot),r=null===r||Je(r)?"":r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r="".concat(this.options.className,"Sub_").concat(r),e=n.querySelector(".".concat(this.options.className,".").concat(r))),e||(e=n.createElement("div"),Ut(e,"htMenu ".concat(this.options.className)),r&&Ut(e,r),this.options.container.appendChild(e)),e}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var e=this.hotMenu.view._wt.wtTable,t=this.hotMenu.getSettings().data,n=e.hider.style,r=e.holder.style,o=parseInt(n.width,10),i=V(t,(function(e,t){return e+(t.name===FD?1:26)}),0);r.width="".concat(o+3,"px"),r.height="".concat(i+3,"px"),n.height=r.height}},{key:"onAfterSelection",value:function(e,t,n,r,o){!1===this.keyEvent&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Dt(e.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Dt(e.target,".htMenu")||this.close(!0))}},{key:"onDocumentContextMenu",value:function(e){this.isOpened()&&Wt(e.target,"htCore")&&Dt(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}]),e}();se($L,Ip);var qL=$L;function QL(e){return QL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},QL(e)}function JL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eB(e,t,n){return t&&ZL(e.prototype,t),n&&ZL(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function tB(){return tB="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=nB(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},tB.apply(this,arguments)}function nB(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=uB(e),null===e)break;return e}function rB(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oB(e,t)}function oB(e,t){return oB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},oB(e,t)}function iB(e){var t=sB();return function(){var n,r=uB(e);if(t){var o=uB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return aB(this,n)}}function aB(e,t){if(t&&("object"===QL(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return lB(e)}function lB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sB(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function uB(e){return uB=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},uB(e)}var cB="contextMenu",fB=70;hr.getSingleton().register("afterContextMenuDefaultOptions"),hr.getSingleton().register("beforeContextMenuShow"),hr.getSingleton().register("afterContextMenuShow"),hr.getSingleton().register("afterContextMenuHide"),hr.getSingleton().register("afterContextMenuExecute");var hB=function(e){rB(n,e);var t=iB(n);function n(e){var r;return JL(this,n),r=t.call(this,e),r.eventManager=new Nr(lB(r)),r.commandExecutor=new FN(r.hot),r.itemsFactory=null,r.menu=null,r}return eB(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[cB]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings()[cB];"function"===typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new qL(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(function(){return e.onMenuBeforeOpen()})),this.menu.addLocalHook("afterOpen",(function(){return e.onMenuAfterOpen()})),this.menu.addLocalHook("afterClose",(function(){return e.onMenuAfterClose()})),this.menu.addLocalHook("executeCommand",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.executeCommand).call.apply(t,[e].concat(r))})),this.addHook("afterOnCellContextMenu",(function(t){return e.onAfterOnCellContextMenu(t)})),tB(uB(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),tB(uB(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),tB(uB(n.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(e){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),this.menu.isOpened())){var t=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement,o=r.getBoundingClientRect(),i=o.top,a=o.left;t=i-Zt(e.view),n=a-en(e.view)}else t=-1*Zt(this.menu.hotMenu.rootWindow),n=-1*en(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(e.pageY,10)+t,left:parseInt(e.pageX,10)+n})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(e){var t;null===this.itemsFactory&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(t=this.commandExecutor).execute.apply(t,[e].concat(r))}},{key:"prepareMenuItems",value:function(){var e=this;this.itemsFactory=new _L(this.hot,n.DEFAULT_ITEMS);var t=this.hot.getSettings()[cB],r={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);var o=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),U(o,(function(t){return e.commandExecutor.registerCommand(t.key,t)}))}},{key:"onAfterOnCellContextMenu",value:function(e){var t=this.hot.getSettings(),n=t.rowHeaders,r=t.colHeaders;function o(e){return"TD"===e.nodeName||"TD"===e.parentNode.nodeName}var i=e.target;this.close(),Wt(i,"handsontableInput")||(e.preventDefault(),e.stopPropagation(),(n||r||o(i)||Wt(i,"current")&&Wt(i,"wtBorder"))&&this.open(e))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),tB(uB(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return cB}},{key:"PLUGIN_PRIORITY",get:function(){return fB}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[vL,mL,FD,YN,XN,FD,pL,aL,FD,OL,JN,FD,qN,FD,WN]}}]),n}($A);function dB(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(Jg)},callback:function(){e.copyCellsOnly()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function pB(e){return{key:"copy_column_headers_only",name:function(){var e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(tm,t)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function yB(e){return{key:"copy_with_column_group_headers",name:function(){var e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(em,t)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function vB(e){return{key:"copy_with_column_headers",name:function(){var e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(Zg,t)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function gB(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(nm)},callback:function(){e.cut()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function mB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wB(e,t,n){return t&&bB(e.prototype,t),n&&bB(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}hB.SEPARATOR={name:FD};var CB=function(){function e(){mB(this,e),this.data={}}return wB(e,[{key:"setData",value:function(e,t){this.data[e]=t}},{key:"getData",value:function(e){return this.data[e]||void 0}}]),e}();function SB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OB(e,t,n){return t&&SB(e.prototype,t),n&&SB(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function kB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var RB=OB((function e(){kB(this,e),this.clipboardData=new CB}));function EB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PB(e,t,n){return t&&TB(e.prototype,t),n&&TB(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var MB=function(){function e(t){EB(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Nr(this),this.listenersCount=new WeakSet,this.container=t}return PB(e,[{key:"useSecondaryElement",value:function(){var e=DB(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),_B(this.eventManager,e,this)),this.mainElement=e}},{key:"setFocusableElement",value:function(e){this.listenersCount.has(e)||(this.listenersCount.add(e),_B(this.eventManager,e,this)),this.mainElement=e}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",xe()||Mn(this.mainElement)}}]),e}();se(MB,Ip);var AB=new WeakMap;function IB(e){var t=new MB(e),n=AB.get(e);return n=isNaN(n)?0:n,AB.set(e,n+1),t}function jB(e){e.eventManager.clear()}var xB=function(e,t){return function(n){return t.runLocalHooks(e,n)}};function _B(e,t,n){e.addEventListener(t,"copy",xB("copy",n)),e.addEventListener(t,"cut",xB("cut",n)),e.addEventListener(t,"paste",xB("paste",n))}var HB=new WeakMap;function DB(e){var t=HB.get(e);if(t)return t.parentElement||e.appendChild(t),t;var n=e.defaultView?e:e.ownerDocument,r=n.createElement("textarea");return HB.set(e,r),r.setAttribute("data-hot-input",""),r.className="HandsontableCopyPaste",r.tabIndex=-1,r.autocomplete="off",r.wrap="hard",r.value=" ",e.appendChild(r),r}function NB(e){if(e instanceof MB){var t=AB.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),jB(e),t<=0){t=0;var n=HB.get(e.container);n&&n.parentNode&&(n.parentNode.removeChild(n),HB.delete(e.container)),e.mainElement=null}AB.set(e.container,t)}}function LB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VB(e,t,n){return t&&BB(e.prototype,t),n&&BB(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function FB(e,t){UB(e,t),t.add(e)}function WB(e,t,n){UB(e,t),t.set(e,n)}function UB(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zB(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function GB(e,t){var n=XB(e,t,"get");return YB(e,n)}function YB(e,t){return t.get?t.get.call(e):t.value}function KB(e,t,n){var r=XB(e,t,"set");return $B(e,r,n),n}function XB(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function $B(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}var qB=new WeakMap,QB=new WeakMap,JB=new WeakMap,ZB=new WeakMap,eV=new WeakMap,tV=new WeakMap,nV=new WeakSet,rV=new WeakSet,oV=function(){function e(t){var n=t.countRows,r=t.countColumns,o=t.rowsLimit,i=t.columnsLimit,a=t.countColumnHeaders;LB(this,e),FB(this,rV),FB(this,nV),WB(this,qB,{writable:!0,value:void 0}),WB(this,QB,{writable:!0,value:void 0}),WB(this,JB,{writable:!0,value:void 0}),WB(this,ZB,{writable:!0,value:void 0}),WB(this,eV,{writable:!0,value:void 0}),WB(this,tV,{writable:!0,value:void 0}),KB(this,QB,n),KB(this,JB,r),KB(this,ZB,o),KB(this,eV,i),KB(this,tV,a)}return VB(e,[{key:"setSelectedRange",value:function(e){KB(this,qB,e)}},{key:"getCellsRange",value:function(){if(0===GB(this,QB).call(this)||0===GB(this,JB).call(this))return null;var e=GB(this,qB).getTopStartCorner(),t=e.row,n=e.col,r=GB(this,qB).getBottomEndCorner(),o=r.row,i=r.col,a=zB(this,rV,aV).call(this,t,o),l=zB(this,nV,iV).call(this,n,i),s=o!==a||i!==l;return{isRangeTrimmed:s,startRow:t,startCol:n,endRow:a,endCol:l}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(0===GB(this,JB).call(this)||0===GB(this,tV).call(this))return null;var e=GB(this,qB).getTopStartCorner(),t=e.col,n=GB(this,qB).getBottomEndCorner(),r=n.col,o=zB(this,nV,iV).call(this,t,r),i=r!==o;return{isRangeTrimmed:i,startRow:-1,startCol:t,endRow:-1,endCol:o}}},{key:"getAllColumnHeadersRange",value:function(){if(0===GB(this,JB).call(this)||0===GB(this,tV).call(this))return null;var e=GB(this,qB).getTopStartCorner(),t=e.col,n=GB(this,qB).getBottomEndCorner(),r=n.col,o=zB(this,nV,iV).call(this,t,r),i=r!==o;return{isRangeTrimmed:i,startRow:-GB(this,tV).call(this),startCol:t,endRow:-1,endCol:o}}}]),e}();function iV(e,t){return Math.min(t,Math.max(e+GB(this,eV).call(this)-1,e))}function aV(e,t){return Math.min(t,Math.max(e+GB(this,ZB).call(this)-1,e))}function lV(e){var t=[],n=[];return U(e,(function(e){var r=Math.min(e.startRow,e.endRow),o=Math.max(e.startRow,e.endRow);Co(r,o,(function(e){-1===t.indexOf(e)&&t.push(e)}));var i=Math.min(e.startCol,e.endCol),a=Math.max(e.startCol,e.endCol);Co(i,a,(function(e){-1===n.indexOf(e)&&n.push(e)}))})),{rows:t,columns:n}}function sV(e,t){return dV(e)||hV(e,t)||cV(e,t)||uV()}function uV(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function cV(e,t){if(e){if("string"===typeof e)return fV(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fV(e,t):void 0}}function fV(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hV(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function dV(e){if(Array.isArray(e))return e}function pV(e){return pV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pV(e)}function yV(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gV(e,t,n){return t&&vV(e.prototype,t),n&&vV(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function mV(){return mV="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=bV(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},mV.apply(this,arguments)}function bV(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=EV(e),null===e)break;return e}function wV(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CV(e,t)}function CV(e,t){return CV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},CV(e,t)}function SV(e){var t=RV();return function(){var n,r=EV(e);if(t){var o=EV(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return OV(this,n)}}function OV(e,t){if(t&&("object"===pV(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return kV(e)}function kV(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RV(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function EV(e){return EV=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},EV(e)}function TV(e,t){MV(e,t),t.add(e)}function PV(e,t,n){MV(e,t),t.set(e,n)}function MV(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AV(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IV(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function jV(e,t){var n=HV(e,t,"get");return xV(e,n)}function xV(e,t){return t.get?t.get.call(e):t.value}function _V(e,t,n){var r=HV(e,t,"set");return DV(e,r,n),n}function HV(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function DV(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}hr.getSingleton().register("afterCopyLimit"),hr.getSingleton().register("modifyCopyableRange"),hr.getSingleton().register("beforeCut"),hr.getSingleton().register("afterCut"),hr.getSingleton().register("beforePaste"),hr.getSingleton().register("afterPaste"),hr.getSingleton().register("beforeCopy"),hr.getSingleton().register("afterCopy");var NV="copyPaste",LV=80,BV=["fragmentSelection"],VV=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),FV=new WeakMap,WV=new WeakMap,UV=new WeakMap,zV=new WeakMap,GV=new WeakMap,YV=new WeakMap,KV=new WeakMap,XV=new WeakSet,$V=function(e){wV(n,e);var t=SV(n);function n(){var e;yV(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),TV(kV(e),XV),AV(kV(e),"columnsLimit",1/0),AV(kV(e),"rowsLimit",1/0),AV(kV(e),"pasteMode","overwrite"),AV(kV(e),"uiContainer",e.hot.rootDocument.body),PV(kV(e),FV,{writable:!0,value:!1}),PV(kV(e),WV,{writable:!0,value:!1}),PV(kV(e),UV,{writable:!0,value:!1}),PV(kV(e),zV,{writable:!0,value:"cells-only"}),PV(kV(e),GV,{writable:!0,value:!1}),PV(kV(e),YV,{writable:!0,value:!1}),PV(kV(e),KV,{writable:!0,value:new oV({countRows:function(){return e.hot.countRows()},countColumns:function(){return e.hot.countCols()},rowsLimit:function(){return e.rowsLimit},columnsLimit:function(){return e.columnsLimit},countColumnHeaders:function(){return e.hot.view.getColumnHeadersCount()}})}),AV(kV(e),"copyableRanges",[]),AV(kV(e),"focusableElement",void 0),e}return gV(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[NV]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t,r,o=this.hot.getSettings(),i=o[NV];if("object"===pV(i))this.pasteMode=null!==(t=i.pasteMode)&&void 0!==t?t:this.pasteMode,this.rowsLimit=isNaN(i.rowsLimit)?this.rowsLimit:i.rowsLimit,this.columnsLimit=isNaN(i.columnsLimit)?this.columnsLimit:i.columnsLimit,_V(this,FV,!!i.copyColumnHeaders),_V(this,WV,!!i.copyColumnGroupHeaders),_V(this,UV,!!i.copyColumnHeadersOnly),this.uiContainer=null!==(r=i.uiContainer)&&void 0!==r?r:this.uiContainer;this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("afterOnCellMouseUp",(function(){return e.onAfterOnCellMouseUp()})),this.addHook("afterSelectionEnd",(function(){return e.onAfterSelectionEnd()})),this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown()})),this.focusableElement=IB(this.uiContainer),this.focusableElement.addLocalHook("copy",(function(t){return e.onCopy(t)})).addLocalHook("cut",(function(t){return e.onCut(t)})).addLocalHook("paste",(function(t){return e.onPaste(t)})),mV(EV(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),mV(EV(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&NB(this.focusableElement),mV(EV(n.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";_V(this,zV,e),_V(this,GV,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){_V(this,YV,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(e){return DO(this.getRangedData(e))}},{key:"getRangedData",value:function(e){var t=this,n=[],r=lV(e),o=r.rows,i=r.columns;return U(o,(function(e){var r=[];U(i,(function(n){e<0?r.push(t.hot.getColHeader(n,e)):r.push(t.hot.getCopyableData(e,n))})),n.push(r)})),n}},{key:"paste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e||t){var n=new RB;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(n)}}},{key:"setCopyableText",value:function(){var e=this.hot.getSelectedRangeLast();if(e){jV(this,KV).setSelectedRange(e);var t=new Map([["headers",null],["cells",null]]);"column-headers-only"===jV(this,zV)?t.set("headers",jV(this,KV).getMostBottomColumnHeadersRange()):("with-column-headers"===jV(this,zV)?t.set("headers",jV(this,KV).getMostBottomColumnHeadersRange()):"with-column-group-headers"===jV(this,zV)&&t.set("headers",jV(this,KV).getAllColumnHeadersRange()),t.set("cells",jV(this,KV).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter((function(e){return null!==e})).map((function(e){var t=e.startRow,n=e.startCol,r=e.endRow,o=e.endCol;return{startRow:t,startCol:n,endRow:r,endCol:o}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var n=t.get("cells");if(null!==n&&n.isRangeTrimmed){var r=n.startRow,o=n.startCol,i=n.endRow,a=n.endCol;this.hot.runHooks("afterCopyLimit",i-r+1,a-o+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var e,t=null===(e=this.hot.getActiveEditor())||void 0===e?void 0:e.TEXTAREA;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var e;return null===(e=this.hot.getActiveEditor())||void 0===e?void 0:e.isOpened()}},{key:"populateValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(e.length){var n=e.length,r=e[0].length,o=[],i=t.getTopStartCorner(),a=i.row,l=i.col,s=t.getBottomEndCorner(),u=s.row,c=s.col,f=a,h=l,d=a,p=l;while(o.length<n||f<=u){var y=this.hot.getCellMeta(f,l),v=y.skipRowOnPaste,g=y.visualRow;if(f=g+1,!0!==v){d=g,h=l;var m=[],b=o.length%n;while(m.length<r||h<=c){var w=this.hot.getCellMeta(a,h),C=w.skipColumnOnPaste,S=w.visualCol;if(h=S+1,!0!==C){p=S;var O=m.length%r;m.push(e[b][O])}}o.push(m)}}return this.hot.populateFromArray(a,l,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,d,p]}}},{key:"onCopy",value:function(e){if((this.hot.isListening()||jV(this,GV))&&!this.isEditorOpened()){this.setCopyableText(),_V(this,GV,!1);var t=this.getRangedData(this.copyableRanges),n=IV(this,XV,qV).call(this,this.copyableRanges),r=!!this.hot.runHooks("beforeCopy",t,this.copyableRanges,n);if(r){var o=DO(t);if(e&&e.clipboardData){var i=uo(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[VV,i].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",t,this.copyableRanges,n)}_V(this,zV,"cells-only"),e.preventDefault()}}},{key:"onCut",value:function(e){if((this.hot.isListening()||jV(this,YV))&&!this.isEditorOpened()){this.setCopyableText(),_V(this,YV,!1);var t=this.getRangedData(this.copyableRanges),n=!!this.hot.runHooks("beforeCut",t,this.copyableRanges);if(n){var r=DO(t);if(e&&e.clipboardData){var o=uo(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[VV,o].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",t,this.copyableRanges)}e.preventDefault()}}},{key:"onPaste",value:function(e){if(this.hot.isListening()&&!this.isEditorOpened()){var t;if(e&&e.preventDefault&&e.preventDefault(),e&&"undefined"!==typeof e.clipboardData){var n=Ot(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(n&&/(<table)|(<TABLE)/g.test(n)){var r=co(n,this.hot.rootDocument);t=r.data}else t=e.clipboardData.getData("text/plain")}else"undefined"===typeof ClipboardEvent&&"undefined"!==typeof this.hot.rootWindow.clipboardData&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if("string"===typeof t&&(t=HO(t)),(!t||0!==t.length)&&!1!==this.hot.runHooks("beforePaste",t,this.copyableRanges)){var o=this.populateValues(t),i=sV(o,4),a=i[0],l=i[1],s=i[2],u=i[3];this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,s),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){e.items.push({name:"---------"},dB(this)),jV(this,FV)&&e.items.push(vB(this)),jV(this,WV)&&e.items.push(yB(this)),jV(this,UV)&&e.items.push(pB(this)),e.items.push(gB(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&gn()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(NB(this.focusableElement),this.focusableElement=null),mV(EV(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return NV}},{key:"SETTING_KEYS",get:function(){return[NV].concat(BV)}},{key:"PLUGIN_PRIORITY",get:function(){return LV}}]),n}($A);function qV(e){for(var t=lV(e),n=t.rows,r=0,o=0;o<n.length;o++){if(n[o]>=0)break;r+=1}return{columnHeadersCount:r}}function QV(e,t){return"border_row".concat(e,"col").concat(t)}function JV(){return{width:1,color:"#000"}}function ZV(){return{hide:!0}}function eF(){return{width:1,color:"#000",cornerVisible:!1}}function tF(e){var t,n;(Qe(e.start)||Qe(e.left))&&(e.start=null!==(t=e.start)&&void 0!==t?t:e.left);(Qe(e.end)||Qe(e.right))&&(e.end=null!==(n=e.end)&&void 0!==n?n:e.right);return delete e.left,delete e.right,e}function nF(e){return Qe(e.start)&&(e.left=e.start),Qe(e.end)&&(e.right=e.end),e}function rF(e,t){return{id:QV(e,t),border:eF(),row:e,col:t,top:ZV(),bottom:ZV(),start:ZV(),end:ZV()}}function oF(e,t){return ge(t,"border")&&t.border&&(e.border=t.border),ge(t,"top")&&Qe(t.top)&&(t.top?(ce(t.top)||(t.top=JV()),e.top=t.top):(t.top=ZV(),e.top=t.top)),ge(t,"bottom")&&Qe(t.bottom)&&(t.bottom?(ce(t.bottom)||(t.bottom=JV()),e.bottom=t.bottom):(t.bottom=ZV(),e.bottom=t.bottom)),ge(t,"start")&&Qe(t.start)&&(t.start?(ce(t.start)||(t.start=JV()),e.start=t.start):(t.start=ZV(),e.start=t.start)),ge(t,"end")&&Qe(t.end)&&(t.end?(ce(t.end)||(t.end=JV()),e.end=t.end):(t.end=ZV(),e.end=t.end)),e}function iF(e,t){var n=!1;return U(e.getSelectedRange(),(function(r){r.forAll((function(r,o){if(!(r<0||o<0)){var i=e.getCellMeta(r,o).borders;if(i){if(!t)return n=!0,!1;if(!ge(i[t],"hide")||!1===i[t].hide)return n=!0,!1}}}))})),n}function aF(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function lF(e){return e.some((function(e){return Qe(e.left)||Qe(e.right)}))}function sF(e){return e.some((function(e){return Qe(e.start)||Qe(e.end)}))}var uF=new Map([["left","start"],["right","end"]]);function cF(e){var t;return null!==(t=uF.get(e))&&void 0!==t?t:e}function fF(e){return{key:"borders:top",name:function(){var e=this.getTranslatedPhrase(wm),t=iF(this,"top");return t&&(e=aF(e)),e},callback:function(t,n){var r=iF(this,"top");e.prepareBorder(n,"top",r)}}}function hF(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var e=this.getTranslatedPhrase(Cm),n=iF(this,t);return n&&(e=aF(e)),e},callback:function(n,r){var o=iF(this,t);e.prepareBorder(r,t,o)}}}function dF(e){return{key:"borders:bottom",name:function(){var e=this.getTranslatedPhrase(Sm),t=iF(this,"bottom");return t&&(e=aF(e)),e},callback:function(t,n){var r=iF(this,"bottom");e.prepareBorder(n,"bottom",r)}}}function pF(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var e=this.getTranslatedPhrase(Om),n=iF(this,t);return n&&(e=aF(e)),e},callback:function(n,r){var o=iF(this,t);e.prepareBorder(r,t,o)}}}function yF(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(km)},callback:function(t,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!iF(this)}}}function vF(e){return vF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vF(e)}function gF(e,t){return SF(e)||CF(e,t)||bF(e,t)||mF()}function mF(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bF(e,t){if(e){if("string"===typeof e)return wF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wF(e,t):void 0}}function wF(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function CF(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function SF(e){if(Array.isArray(e))return e}function OF(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function RF(e,t,n){return t&&kF(e.prototype,t),n&&kF(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function EF(){return EF="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=TF(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},EF.apply(this,arguments)}function TF(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=_F(e),null===e)break;return e}function PF(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MF(e,t)}function MF(e,t){return MF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},MF(e,t)}function AF(e){var t=xF();return function(){var n,r=_F(e);if(t){var o=_F(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return IF(this,n)}}function IF(e,t){if(t&&("object"===vF(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return jF(e)}function jF(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xF(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _F(e){return _F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_F(e)}function HF(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var DF="customBorders",NF=90,LF=function(e){PF(n,e);var t=AF(n);function n(){var e;OF(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),HF(jF(e),"savedBorders",[]),e}return RF(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[DF]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("init",(function(){return e.onAfterInit()})),EF(_F(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),EF(_F(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),EF(_F(n.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(e,t){var n=this,r=["top","bottom","start","end"],o=null;t&&(this.checkSettingsCohesion([t]),r=Object.keys(t),o=tF(t));var i=iS(e),a=aS(i);U(e,(function(e){for(var t=a(e),i=gF(t,4),l=i[0],s=i[1],u=i[2],c=i[3],f=function(e){for(var t=function(t){U(r,(function(r){n.prepareBorderFromCustomAdded(e,t,o,cF(r))}))},i=s;i<=c;i+=1)t(i)},h=l;h<=u;h+=1)f(h)})),this.hot.view.render()}},{key:"getBorders",value:function(e){var t=this;if(!Array.isArray(e))return this.savedBorders;var n=iS(e),r=aS(n),o=[];return U(e,(function(e){for(var n=r(e),i=gF(n,4),a=i[0],l=i[1],s=i[2],u=i[3],c=function(e){for(var n=function(n){U(t.savedBorders,(function(t){t.row===e&&t.col===n&&o.push(nF(t))}))},r=l;r<=u;r+=1)n(r)},f=a;f<=s;f+=1)c(f)})),o}},{key:"clearBorders",value:function(e){var t=this;e?this.setBorders(e):(U(this.savedBorders,(function(e){t.clearBordersFromSelectionSettings(e.id),t.clearNullCellRange(),t.hot.removeCellMeta(e.row,e.col,"borders")})),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(e,t){var n=this.checkSavedBorders(e);n||this.savedBorders.push(e);var r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col)),o=this.checkCustomSelections(e,r,t);o||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}},{key:"prepareBorderFromCustomAdded",value:function(e,t,n,r){var o=this.hot.countRows(),i=this.hot.countCols();if(!(e>=o||t>=i)){var a=rF(e,t);n&&(a=oF(a,n),U(this.hot.selection.highlight.customSelections,(function(e){if(a.id===e.settings.id)return Object.assign(e.settings,n),a.id=e.settings.id,a.top=e.settings.top,a.bottom=e.settings.bottom,a.start=e.settings.start,a.end=e.settings.end,!1}))),this.hot.setCellMeta(e,t,"borders",nF(a)),this.insertBorderIntoSettings(a,r)}}},{key:"prepareBorderFromCustomAddedRange",value:function(e,t){var n=this,r=Math.min(e.to.row,this.hot.countRows()-1),o=Math.min(e.to.col,this.hot.countCols()-1);Co(e.from.row,r,(function(r){Co(e.from.col,o,(function(o){var i=rF(r,o),a=0;r===e.from.row&&ge(t,"top")&&(a+=1,i.top=t.top),r===e.to.row&&ge(t,"bottom")&&(a+=1,i.bottom=t.bottom),o===e.from.col&&ge(t,"start")&&(a+=1,i.start=t.start),o===e.to.col&&ge(t,"end")&&(a+=1,i.end=t.end),a>0&&(n.hot.setCellMeta(r,o,"borders",nF(i)),n.insertBorderIntoSettings(i))}))}))}},{key:"removeAllBorders",value:function(e,t){var n=QV(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}},{key:"setBorder",value:function(e,t,n,r){var o=this.hot.getCellMeta(e,t).borders;if(o=o&&void 0!==o.border?tF(o):rF(e,t),r){o[n]=ZV();var i=this.countHide(o);if(4===i)this.removeAllBorders(e,t);else{var a=this.checkCustomSelectionsFromContextMenu(o,n,r);a||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",nF(o))}}else{o[n]=JV();var l=this.checkCustomSelectionsFromContextMenu(o,n,r);l||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",nF(o))}}},{key:"prepareBorder",value:function(e,t,n){var r=this;U(e,(function(e){var o=e.start,i=e.end;if(o.row===i.row&&o.col===i.col)"noBorders"===t?r.removeAllBorders(o.row,o.col):r.setBorder(o.row,o.col,t,n);else switch(t){case"noBorders":Co(o.col,i.col,(function(e){Co(o.row,i.row,(function(t){r.removeAllBorders(t,e)}))}));break;case"top":Co(o.col,i.col,(function(e){r.setBorder(o.row,e,t,n)}));break;case"bottom":Co(o.col,i.col,(function(e){r.setBorder(i.row,e,t,n)}));break;case"start":Co(o.row,i.row,(function(e){r.setBorder(e,o.col,t,n)}));break;case"end":Co(o.row,i.row,(function(e){r.setBorder(e,i.col,t,n)}));break;default:break}}))}},{key:"createCustomBorders",value:function(e){var t=this;U(e,(function(e){var n=tF(e);e.range?t.prepareBorderFromCustomAddedRange(e.range,n):t.prepareBorderFromCustomAdded(e.row,e.col,n)}))}},{key:"countHide",value:function(e){var t=e.top,n=e.bottom,r=e.start,o=e.end,i=[t,n,r,o];return V(i,(function(e,t){var n=e;return t&&t.hide&&(n+=1),n}),0)}},{key:"clearBordersFromSelectionSettings",value:function(e){var t=W(this.hot.selection.highlight.customSelections,(function(e){return e.settings.id})).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}},{key:"clearNullCellRange",value:function(){var e=this;U(this.hot.selection.highlight.customSelections,(function(t,n){if(null===t.cellRange)return e.hot.selection.highlight.customSelections[n].destroy(),e.hot.selection.highlight.customSelections.splice(n,1),!1}))}},{key:"hideBorders",value:function(){var e=this;U(this.savedBorders,(function(t){e.clearBordersFromSelectionSettings(t.id),e.clearNullCellRange()}))}},{key:"spliceBorder",value:function(e){var t=W(this.savedBorders,(function(e){return e.id})).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}},{key:"checkSavedBorders",value:function(e){var t=this,n=!1,r=this.countHide(e);return 4===r?(this.spliceBorder(e.id),n=!0):U(this.savedBorders,(function(r,o){if(e.id===r.id)return t.savedBorders[o]=e,n=!0,!1})),n}},{key:"checkCustomSelectionsFromContextMenu",value:function(e,t,n){var r=!1;return U(this.hot.selection.highlight.customSelections,(function(o){if(e.id===o.settings.id)return he(o.instanceBorders,(function(e){e.toggleHiddenClass(t,n)})),r=!0,!1})),r}},{key:"checkCustomSelections",value:function(e,t,n){var r=this.countHide(e),o=!1;return 4===r?(this.removeAllBorders(e.row,e.col),o=!0):U(this.hot.selection.highlight.customSelections,(function(r){if(e.id===r.settings.id)return r.visualCellRange=t,r.commit(),n&&he(r.instanceBorders,(function(t){t.changeBorderStyle(n,e)})),o=!0,!1})),o}},{key:"changeBorderSettings",value:function(){var e=this.hot.getSettings()[DF];if(Array.isArray(e)){var t=ae(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else void 0!==e&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(e){var t=lF(e),n=sF(e);if(t&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(e){this.hot.getSettings()[DF]&&e.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(bm)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[fF(this),hF(this),dF(this),pF(this),yF(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){EF(_F(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return DF}},{key:"PLUGIN_PRIORITY",get:function(){return NF}}]),n}($A);function BF(e){return BF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},BF(e)}function VF(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FF(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function WF(e,t,n){return t&&FF(e.prototype,t),n&&FF(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function UF(){return UF="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=zF(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},UF.apply(this,arguments)}function zF(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=QF(e),null===e)break;return e}function GF(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YF(e,t)}function YF(e,t){return YF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},YF(e,t)}function KF(e){var t=qF();return function(){var n,r=QF(e);if(t){var o=QF(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return XF(this,n)}}function XF(e,t){if(t&&("object"===BF(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return $F(e)}function $F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qF(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function QF(e){return QF=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},QF(e)}var JF="dragToScroll",ZF=100,eW=function(e){GF(n,e);var t=KF(n);function n(e){var r;return VF(this,n),r=t.call(this,e),r.eventManager=new Nr($F(r)),r.boundaries=null,r.callback=null,r.listening=!1,r}return WF(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[JF]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterOnCellMouseDown",(function(t){return e.setupListening(t)})),this.addHook("afterOnCellCornerMouseDown",(function(t){return e.setupListening(t)})),this.registerEvents(),UF(QF(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),UF(QF(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),UF(QF(n.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(e){this.boundaries=e}},{key:"setCallback",value:function(e){this.callback=e}},{key:"check",value:function(e,t){var n=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,r)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootWindow,n=t;while(n)this.eventManager.addEventListener(n.document,"contextmenu",(function(){return e.unlisten()})),this.eventManager.addEventListener(n.document,"mouseup",(function(){return e.unlisten()})),this.eventManager.addEventListener(n.document,"mousemove",(function(t){return e.onMouseMove(t)})),n=jt(n)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(e){if(!Zn(e)){var t=this.hot.view._wt.wtTable.holder;t!==this.hot.rootWindow&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback((function(e,n){e<0?t.scrollLeft-=50:e>0&&(t.scrollLeft+=50),n<0?t.scrollTop-=20:n>0&&(t.scrollTop+=20)})),this.listen())}}},{key:"onMouseMove",value:function(e){this.isListening()&&this.check(e.clientX,e.clientY)}},{key:"destroy",value:function(){UF(QF(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return JF}},{key:"PLUGIN_PRIORITY",get:function(){return ZF}}]),n}($A);function tW(e){return tW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tW(e)}function nW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oW(e,t,n){return t&&rW(e.prototype,t),n&&rW(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function iW(){return iW="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=aW(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},iW.apply(this,arguments)}function aW(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=dW(e),null===e)break;return e}function lW(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sW(e,t)}function sW(e,t){return sW=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sW(e,t)}function uW(e){var t=hW();return function(){var n,r=dW(e);if(t){var o=dW(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cW(this,n)}}function cW(e,t){if(t&&("object"===tW(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return fW(e)}function fW(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hW(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function dW(e){return dW=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dW(e)}hr.getSingleton().register("afterDropdownMenuDefaultOptions"),hr.getSingleton().register("beforeDropdownMenuShow"),hr.getSingleton().register("afterDropdownMenuShow"),hr.getSingleton().register("afterDropdownMenuHide"),hr.getSingleton().register("afterDropdownMenuExecute");var pW="dropdownMenu",yW=230,vW="changeType",gW=function(e){lW(n,e);var t=uW(n);function n(e){var r;return nW(this,n),r=t.call(this,e),r.eventManager=new Nr(fW(r)),r.commandExecutor=new FN(r.hot),r.itemsFactory=null,r.menu=null,r.hot.addHook("afterGetColHeader",(function(e,t){return r.onAfterGetColHeader(e,t)})),r}return oW(n,[{key:"isEnabled",value:function(){return this.hot.getSettings()[pW]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.itemsFactory=new _L(this.hot,n.DEFAULT_ITEMS);var t=this.hot.getSettings()[pW],r={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"===typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),iW(dW(n.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady((function(){e.hot.runHooks("afterDropdownMenuDefaultOptions",r),e.itemsFactory.setPredefinedItems(r.items);var n=e.itemsFactory.getItems(t);e.menu&&e.menu.destroy(),e.menu=new qL(e.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||e.hot.rootDocument.body}),e.hot.runHooks("beforeDropdownMenuSetItems",n),e.menu.setMenuItems(n),e.menu.addLocalHook("beforeOpen",(function(){return e.onMenuBeforeOpen()})),e.menu.addLocalHook("afterOpen",(function(){return e.onMenuAfterOpen()})),e.menu.addLocalHook("afterClose",(function(){return e.onMenuAfterClose()})),e.menu.addLocalHook("executeCommand",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.executeCommand).call.apply(t,[e].concat(r))})),U(n,(function(t){return e.commandExecutor.registerCommand(t.key,t)}))}))}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),iW(dW(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),iW(dW(n.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(t){return e.onTableClick(t)}))}},{key:"open",value:function(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(t=this.commandExecutor).execute.apply(t,[e].concat(r))}},{key:"setListening",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(e){if(e.stopPropagation(),Wt(e.target,vW)&&!this.menu.isOpened()){var t=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement,o=r.getBoundingClientRect(),i=o.top,a=o.left;t=i,n=a}var l=e.target.getBoundingClientRect();this.open({left:l.left+n,top:l.top+e.target.offsetHeight+3+t,width:l.width,height:l.height})}}},{key:"onAfterGetColHeader",value:function(e,t){var n=t.parentNode;if(n){var r=n.parentNode.childNodes,o=Array.prototype.indexOf.call(r,n);if(!(e<0||o!==r.length-1)){var i=t.querySelector(".".concat(vW));if(!this.enabled||!i)if(this.enabled){var a=this.hot.rootDocument.createElement("button");a.className=vW,a.type="button",a.onclick=function(){return!1},t.firstChild.insertBefore(a,t.firstChild.firstChild)}else i&&i.parentNode.removeChild(i)}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),iW(dW(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return pW}},{key:"PLUGIN_PRIORITY",get:function(){return yW}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[YN,XN,FD,aL,FD,zN,FD,qN,FD,WN]}}]),n}($A);function mW(e,t){return OW(e)||SW(e,t)||wW(e,t)||bW()}function bW(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function wW(e,t){if(e){if("string"===typeof e)return CW(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?CW(e,t):void 0}}function CW(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function SW(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function OW(e){if(Array.isArray(e))return e}function kW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function EW(e,t,n){return t&&RW(e.prototype,t),n&&RW(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}gW.SEPARATOR={name:FD};var TW=function(){function e(t){kW(this,e),this.hot=t,this.options={}}return EW(e,[{key:"setOptions",value:function(e){this.options=e}},{key:"getData",value:function(){var e=this,t=this._getDataRange(),n=t.startRow,r=t.startCol,o=t.endRow,i=t.endCol,a=this.options,l=[];return Co(n,o,(function(t){var n=[];!a.exportHiddenRows&&e._isHiddenRow(t)||(Co(r,i,(function(r){!a.exportHiddenColumns&&e._isHiddenColumn(r)||n.push(e.hot.getDataAtCell(t,r))})),l.push(n))})),l}},{key:"getRowHeaders",value:function(){var e=this,t=[];if(this.options.rowHeaders){var n=this._getDataRange(),r=n.startRow,o=n.endRow,i=this.hot.getRowHeader();Co(r,o,(function(n){!e.options.exportHiddenRows&&e._isHiddenRow(n)||t.push(i[n])}))}return t}},{key:"getColumnHeaders",value:function(){var e=this,t=[];if(this.options.columnHeaders){var n=this._getDataRange(),r=n.startCol,o=n.endCol,i=this.hot.getColHeader();Co(r,o,(function(n){!e.options.exportHiddenColumns&&e._isHiddenColumn(n)||t.push(i[n])}))}return t}},{key:"_getDataRange",value:function(){var e=this.hot.countCols()-1,t=this.hot.countRows()-1,n=mW(this.options.range,4),r=n[0],o=void 0===r?0:r,i=n[1],a=void 0===i?0:i,l=n[2],s=void 0===l?t:l,u=n[3],c=void 0===u?e:u;return o=Math.max(o,0),a=Math.max(a,0),s=Math.min(s,t),c=Math.min(c,e),{startRow:o,startCol:a,endRow:s,endCol:c}}},{key:"_isHiddenRow",value:function(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}},{key:"_isHiddenColumn",value:function(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}]),e}(),PW=TW;function MW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IW(e,t,n){return t&&AW(e.prototype,t),n&&AW(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var jW=function(){function e(t,n){MW(this,e),this.dataProvider=t,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}return IW(e,[{key:"_mergeOptions",value:function(t){var n=le(this.constructor.DEFAULT_OPTIONS),r=new Date;return n=oe(le(e.DEFAULT_OPTIONS),n),n=oe(n,t),n.filename=Ct(n.filename,{YYYY:r.getFullYear(),MM:"".concat(r.getMonth()+1).padStart(2,"0"),DD:"".concat(r.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}(),xW=jW;function _W(e){return _W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_W(e)}function HW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DW(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NW(e,t,n){return t&&DW(e.prototype,t),n&&DW(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function LW(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BW(e,t)}function BW(e,t){return BW=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},BW(e,t)}function VW(e){var t=UW();return function(){var n,r=zW(e);if(t){var o=zW(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return FW(this,n)}}function FW(e,t){if(t&&("object"===_W(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return WW(e)}function WW(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UW(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function zW(e){return zW=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zW(e)}var GW=String.fromCharCode(13),YW=String.fromCharCode(34),KW=String.fromCharCode(10),XW=function(e){LW(n,e);var t=VW(n);function n(){return HW(this,n),t.apply(this,arguments)}return NW(n,[{key:"export",value:function(){var e=this,t=this.options,n=this.dataProvider.getData(),r=this.dataProvider.getColumnHeaders(),o=r.length>0,i=this.dataProvider.getRowHeaders(),a=i.length>0,l=t.bom?String.fromCharCode(65279):"";return o&&(r=W(r,(function(t){return e._escapeCell(t,!0)})),a&&(l+=t.columnDelimiter),l+=r.join(t.columnDelimiter),l+=t.rowDelimiter),U(n,(function(n,r){r>0&&(l+=t.rowDelimiter),a&&(l+=e._escapeCell(i[r])+t.columnDelimiter),l+=n.map((function(t){return e._escapeCell(t)})).join(t.columnDelimiter)})),l}},{key:"_escapeCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=qe(e);return""!==n&&(t||n.indexOf(GW)>=0||n.indexOf(YW)>=0||n.indexOf(KW)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n='"'.concat(n,'"')),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}}]),n}(xW),$W=XW;function qW(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var QW="csv",JW=qW({},QW,$W);function ZW(e,t,n){return"function"===typeof JW[e]?new JW[e](t,n):null}function eU(e){return eU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eU(e)}function tU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rU(e,t,n){return t&&nU(e.prototype,t),n&&nU(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function oU(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iU(e,t)}function iU(e,t){return iU=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},iU(e,t)}function aU(e){var t=uU();return function(){var n,r=cU(e);if(t){var o=cU(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lU(this,n)}}function lU(e,t){if(t&&("object"===eU(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return sU(e)}function sU(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uU(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function cU(e){return cU=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cU(e)}var fU="exportFile",hU=240,dU=function(e){oU(n,e);var t=aU(n);function n(){return tU(this,n),t.apply(this,arguments)}return rU(n,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()}},{key:"exportAsBlob",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}},{key:"downloadFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.hot,r=n.rootDocument,o=n.rootWindow,i=this._createTypeFormatter(e,t),a=this._createBlob(i),l=o.URL||o.webkitURL,s=r.createElement("a"),u="".concat(i.options.filename,".").concat(i.options.fileExtension);if(void 0!==s.download){var c=l.createObjectURL(a);s.style.display="none",s.setAttribute("href",c),s.setAttribute("download",u),r.body.appendChild(s),s.dispatchEvent(new MouseEvent("click")),r.body.removeChild(s),setTimeout((function(){l.revokeObjectURL(c)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,u)}},{key:"_createTypeFormatter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!JW[e])throw new Error('Export format type "'.concat(e,'" is not supported.'));return ZW(e,new PW(this.hot),t)}},{key:"_createBlob",value:function(e){var t=null;return"undefined"!==typeof Blob&&(t=new Blob([e.export()],{type:"".concat(e.options.mimeType,";charset=").concat(e.options.encoding)})),t}}],[{key:"PLUGIN_KEY",get:function(){return fU}},{key:"PLUGIN_PRIORITY",get:function(){return hU}}]),n}($A);function pU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vU(e,t,n){return t&&yU(e.prototype,t),n&&yU(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var gU=function(){function e(t,n){var r=n.id,o=n.stateless,i=void 0===o||o;pU(this,e),this.hot=t,this.id=r,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new av)}return vU(e,[{key:"reset",value:function(){U(this.elements,(function(e){return e.reset()}))}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return null===this.hot||this.hidden}},{key:"restoreState",value:function(e){this.state&&this.setState(this.state.getValueAtIndex(e))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(e){this.state&&this.state.setValueAtIndex(e,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),U(this.elements,(function(e){return e.destroy()})),this.state=null,this.elements=null,this.hot=null}}]),e}();se(gU,Ip);var mU=gU,bU={};function wU(e,t){if(!bU[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var n=bU[e],r=n.condition,o=n.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(e){return r.apply(e.meta.instance,[].concat([e],[i]))}}function CU(e){if(!bU[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return bU[e].descriptor}function SU(e,t,n){n.key=e,bU[e]={condition:t,descriptor:n}}var OU="none";function kU(){return!0}SU(OU,kU,{name:xm,inputsCount:0,showOperators:!1});var RU="empty";function EU(e){return Ze(e.value)}SU(RU,EU,{name:_m,inputsCount:0,showOperators:!0});var TU="not_empty";function PU(e,t){return!wU(RU,t)(e)}function MU(e,t){return _U(e)||xU(e,t)||IU(e,t)||AU()}function AU(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function IU(e,t){if(e){if("string"===typeof e)return jU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jU(e,t):void 0}}function jU(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xU(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function _U(e){if(Array.isArray(e))return e}SU(TU,PU,{name:Hm,inputsCount:0,showOperators:!0});var HU="eq";function DU(e,t){var n=MU(t,1),r=n[0];return qe(e.value).toLocaleLowerCase(e.meta.locale)===qe(r)}SU(HU,DU,{name:Dm,inputsCount:1,showOperators:!0});var NU="neq";function LU(e,t){return!wU(HU,t)(e)}function BU(e,t){return zU(e)||UU(e,t)||FU(e,t)||VU()}function VU(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function FU(e,t){if(e){if("string"===typeof e)return WU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?WU(e,t):void 0}}function WU(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function UU(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function zU(e){if(Array.isArray(e))return e}SU(NU,LU,{name:Nm,inputsCount:1,showOperators:!0});var GU="gt";function YU(e,t){var n=BU(t,1),r=n[0],o=r;return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value>o}function KU(e,t){return JU(e)||QU(e,t)||$U(e,t)||XU()}function XU(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $U(e,t){if(e){if("string"===typeof e)return qU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qU(e,t):void 0}}function qU(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function QU(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function JU(e){if(Array.isArray(e))return e}SU(GU,YU,{name:Um,inputsCount:1,showOperators:!0});var ZU="gte";function ez(e,t){var n=KU(t,1),r=n[0],o=r;return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value>=o}function tz(e,t){return az(e)||iz(e,t)||rz(e,t)||nz()}function nz(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rz(e,t){if(e){if("string"===typeof e)return oz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oz(e,t):void 0}}function oz(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function iz(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function az(e){if(Array.isArray(e))return e}SU(ZU,ez,{name:zm,inputsCount:1,showOperators:!0});var lz="lt";function sz(e,t){var n=tz(t,1),r=n[0],o=r;return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value<o}function uz(e,t){return pz(e)||dz(e,t)||fz(e,t)||cz()}function cz(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fz(e,t){if(e){if("string"===typeof e)return hz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hz(e,t):void 0}}function hz(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dz(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function pz(e){if(Array.isArray(e))return e}SU(lz,sz,{name:Gm,inputsCount:1,showOperators:!0});var yz="lte";function vz(e,t){var n=uz(t,1),r=n[0],o=r;return"numeric"===e.meta.type&&(o=parseFloat(o,10)),e.value<=o}function gz(e,t){return Sz(e)||Cz(e,t)||bz(e,t)||mz()}function mz(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bz(e,t){if(e){if("string"===typeof e)return wz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wz(e,t):void 0}}function wz(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cz(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Sz(e){if(Array.isArray(e))return e}SU(yz,vz,{name:Ym,inputsCount:1,showOperators:!0});var Oz="date_after";function kz(e,t){var n=gz(t,1),r=n[0],o=Ye(e.value,e.meta.dateFormat),i=Ye(r,e.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)>=0}function Rz(e,t){return Az(e)||Mz(e,t)||Tz(e,t)||Ez()}function Ez(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Tz(e,t){if(e){if("string"===typeof e)return Pz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pz(e,t):void 0}}function Pz(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Mz(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Az(e){if(Array.isArray(e))return e}SU(Oz,kz,{name:$m,inputsCount:1,showOperators:!0});var Iz="date_before";function jz(e,t){var n=Rz(t,1),r=n[0],o=Ye(e.value,e.meta.dateFormat),i=Ye(r,e.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)<=0}function xz(e,t){return Lz(e)||Nz(e,t)||Hz(e,t)||_z()}function _z(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Hz(e,t){if(e){if("string"===typeof e)return Dz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dz(e,t):void 0}}function Dz(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Nz(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Lz(e){if(Array.isArray(e))return e}SU(Iz,jz,{name:qm,inputsCount:1,showOperators:!0});var Bz="between";function Vz(e,t){var n=xz(t,2),r=n[0],o=n[1],i=r,a=o;if("numeric"===e.meta.type){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if("date"===e.meta.type){var u=wU(Iz,[a]),c=wU(Oz,[i]);return u(e)&&c(e)}return e.value>=i&&e.value<=a}SU(Bz,Vz,{name:Km,inputsCount:2,showOperators:!0});var Fz="not_between";function Wz(e,t){return!wU(Bz,t)(e)}function Uz(e,t){return Xz(e)||Kz(e,t)||Gz(e,t)||zz()}function zz(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Gz(e,t){if(e){if("string"===typeof e)return Yz(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yz(e,t):void 0}}function Yz(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Kz(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Xz(e){if(Array.isArray(e))return e}SU(Fz,Wz,{name:Xm,inputsCount:2,showOperators:!0});var $z="begins_with";function qz(e,t){var n=Uz(t,1),r=n[0];return qe(e.value).toLocaleLowerCase(e.meta.locale).startsWith(qe(r))}SU($z,qz,{name:Lm,inputsCount:1,showOperators:!0});n("b1c4");function Qz(e,t){return nG(e)||tG(e,t)||Zz(e,t)||Jz()}function Jz(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Zz(e,t){if(e){if("string"===typeof e)return eG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eG(e,t):void 0}}function eG(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tG(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function nG(e){if(Array.isArray(e))return e}var rG="ends_with";function oG(e,t){var n=Qz(t,1),r=n[0];return qe(e.value).toLocaleLowerCase(e.meta.locale).endsWith(qe(r))}function iG(e,t){return cG(e)||uG(e,t)||lG(e,t)||aG()}function aG(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function lG(e,t){if(e){if("string"===typeof e)return sG(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sG(e,t):void 0}}function sG(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uG(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function cG(e){if(Array.isArray(e))return e}SU(rG,oG,{name:Bm,inputsCount:1,showOperators:!0});var fG="contains";function hG(e,t){var n=iG(t,1),r=n[0];return qe(e.value).toLocaleLowerCase(e.meta.locale).indexOf(qe(r))>=0}SU(fG,hG,{name:Vm,inputsCount:1,showOperators:!0});var dG="not_contains";function pG(e,t){return!wU(fG,t)(e)}SU(dG,pG,{name:Fm,inputsCount:1,showOperators:!0});var yG="date_tomorrow";function vG(e){var t=Ye(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Ye().subtract(-1,"days").startOf("day"),"d")}SU(yG,vG,{name:Jm,inputsCount:0});var gG="date_today";function mG(e){var t=Ye(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Ye().startOf("day"),"d")}SU(gG,mG,{name:Qm,inputsCount:0});var bG,wG="date_yesterday";function CG(e){var t=Ye(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Ye().subtract(1,"days").startOf("day"),"d")}function SG(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}SU(wG,CG,{name:Zm,inputsCount:0});var OG="numeric",kG="text",RG="date",EG=(bG={},SG(bG,OG,[OU,FD,RU,TU,FD,HU,NU,FD,GU,ZU,lz,yz,Bz,Fz]),SG(bG,kG,[OU,FD,RU,TU,FD,HU,NU,FD,$z,rG,FD,fG,dG]),SG(bG,RG,[OU,FD,RU,TU,FD,HU,NU,FD,Iz,Oz,Bz,FD,yG,gG,wG]),bG);function TG(e){var t=[],n=e;return EG[n]||(n=kG),U(EG[n],(function(e){var n;n=e===FD?{name:FD}:le(CU(e)),t.push(n)})),t}function PG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function AG(e,t,n){return t&&MG(e.prototype,t),n&&MG(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var IG="built",jG="building",xG=["click","input","keydown","keypress","keyup","focus","blur","change"],_G=function(){function e(t,n){PG(this,e),this.hot=t,this.eventManager=new Nr(this),this.options=oe(e.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return AG(e,[{key:"setValue",value:function(e){this.options.value=e,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===jG?this._element:this.buildState===IG?(this.update(),this._element):(this.buildState=jG,this.build(),this.buildState=IG,this._element)}},{key:"isBuilt",value:function(){return this.buildState===IG}},{key:"translateIfPossible",value:function(e){return"string"===typeof e&&e.startsWith(Im)?this.hot.getTranslatedPhrase(e):e}},{key:"build",value:function(){var e=this,t=function(t,n){e.eventManager.addEventListener(t,n,(function(t){return e.runLocalHooks(n,t,e)}))};if(this.buildState||(this.buildState=jG),this.options.className&&Ut(this._element,this.options.className),this.options.children.length)U(this.options.children,(function(t){return e._element.appendChild(t.element)}));else if(this.options.wrapIt){var n=this.hot.rootDocument.createElement(this.options.tagName);he(this.options,(function(t,r){void 0!==n[r]&&"className"!==r&&"tagName"!==r&&"children"!==r&&(n[r]=e.translateIfPossible(t))})),this._element.appendChild(n),U(xG,(function(e){return t(n,e)}))}else U(xG,(function(n){return t(e._element,n)}))}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return le({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();se(_G,Ip);var HG=_G;function DG(e){return DG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DG(e)}function NG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LG(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BG(e,t,n){return t&&LG(e.prototype,t),n&&LG(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function VG(){return VG="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=FG(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},VG.apply(this,arguments)}function FG(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=XG(e),null===e)break;return e}function WG(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UG(e,t)}function UG(e,t){return UG=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},UG(e,t)}function zG(e){var t=KG();return function(){var n,r=XG(e);if(t){var o=XG(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return GG(this,n)}}function GG(e,t){if(t&&("object"===DG(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return YG(e)}function YG(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KG(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function XG(e){return XG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},XG(e)}var $G=new WeakMap,qG=function(e){WG(n,e);var t=zG(n);function n(e,r){var o;return NG(this,n),o=t.call(this,e,oe(n.DEFAULTS,r)),$G.set(YG(o),{}),o.registerHooks(),o}return BG(n,[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",(function(){return e.onClick()})),this.addLocalHook("keyup",(function(t){return e.onKeyup(t)}))}},{key:"build",value:function(){VG(XG(n.prototype),"build",this).call(this);var e=$G.get(this),t=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,Ut(this._element,"htUIInput"),Ut(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var e=$G.get(this).input;e.type=this.options.type,e.placeholder=this.translateIfPossible(this.options.placeholder),e.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&$G.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(e){this.options.value=e.target.value}}],[{key:"DEFAULTS",get:function(){return le({placeholder:"",type:"text",tagName:"input"})}}]),n}(HG),QG=qG;function JG(e){return JG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},JG(e)}function ZG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tY(e,t,n){return t&&eY(e.prototype,t),n&&eY(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function nY(){return nY="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=rY(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},nY.apply(this,arguments)}function rY(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=cY(e),null===e)break;return e}function oY(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iY(e,t)}function iY(e,t){return iY=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},iY(e,t)}function aY(e){var t=uY();return function(){var n,r=cY(e);if(t){var o=cY(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lY(this,n)}}function lY(e,t){if(t&&("object"===JG(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return sY(e)}function sY(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uY(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function cY(e){return cY=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cY(e)}var fY=new WeakMap,hY=function(e){oY(n,e);var t=aY(n);function n(e,r){var o;return ZG(this,n),o=t.call(this,e,oe(n.DEFAULTS,r)),fY.set(sY(o),{}),o.menu=null,o.items=[],o.registerHooks(),o}return tY(n,[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",(function(){return e.onClick()}))}},{key:"setItems",value:function(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(e){var t=this;return U(e,(function(e){e.name=t.translateIfPossible(e.name)})),e}},{key:"build",value:function(){var e=this;nY(cY(n.prototype),"build",this).call(this),this.menu=new qL(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var t=new HG(this.hot,{className:"htUISelectCaption"}),r=new HG(this.hot,{className:"htUISelectDropdown"}),o=fY.get(this);o.caption=t,o.captionElement=t.element,o.dropdown=r,U([t,r],(function(t){return e._element.appendChild(t.element)})),this.menu.addLocalHook("select",(function(t){return e.onMenuSelect(t)})),this.menu.addLocalHook("afterClose",(function(){return e.onMenuClosed()})),this.update()}},{key:"update",value:function(){var e;this.isBuilt()&&(e=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(xm),fY.get(this).captionElement.textContent=e,nY(cY(n.prototype),"update",this).call(this))}},{key:"openOptions",value:function(){var e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(e){e.name!==FD&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var e=fY.get(this),t=e.caption,r=e.dropdown;t&&t.destroy(),r&&r.destroy(),nY(cY(n.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return le({className:"htUISelect",wrapIt:!1})}}]),n}(HG),dY=hY;function pY(e){return pY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pY(e)}function yY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gY(e,t,n){return t&&vY(e.prototype,t),n&&vY(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function mY(){return mY="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=bY(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},mY.apply(this,arguments)}function bY(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=EY(e),null===e)break;return e}function wY(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CY(e,t)}function CY(e,t){return CY=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},CY(e,t)}function SY(e){var t=RY();return function(){var n,r=EY(e);if(t){var o=EY(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return OY(this,n)}}function OY(e,t){if(t&&("object"===pY(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return kY(e)}function kY(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RY(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function EY(e){return EY=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},EY(e)}var TY=function(e){wY(n,e);var t=SY(n);function n(e,r){var o;return yY(this,n),o=t.call(this,e,{id:r.id,stateless:!1}),o.name=r.name,o.addSeparator=r.addSeparator,o.elements.push(new dY(o.hot,{menuContainer:r.menuContainer})),o.elements.push(new QG(o.hot,{placeholder:cb})),o.elements.push(new QG(o.hot,{placeholder:fb})),o.registerHooks(),o}return gY(n,[{key:"registerHooks",value:function(){var e=this;this.getSelectElement().addLocalHook("select",(function(t){return e.onConditionSelect(t)})),this.getSelectElement().addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),U(this.getInputElements(),(function(t){t.addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)}))}))}},{key:"setState",value:function(e){var t=this;if(this.reset(),e){var n=le(e.command);n.name.startsWith(jm)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),U(e.args,(function(e,r){if(r>n.inputsCount-1)return!1;var o=t.getInputElement(r);o.setValue(e),o[n.inputsCount>r?"show":"hide"](),r||setTimeout((function(){return o.focus()}),10)}))}}},{key:"getState",value:function(){var e=this.getSelectElement().getValue()||CU(OU),t=[];return U(this.getInputElements(),(function(n,r){e.inputsCount>r&&t.push(n.getValue())})),{command:e,args:t}}},{key:"updateState",value:function(e,t){var n=CU(e?e.name:OU);this.state.setValueAtIndex(t,{command:n,args:e?e.args:[]}),e||U(this.getInputElements(),(function(e){return e.setValue(null)}))}},{key:"getSelectElement",value:function(){return this.elements.filter((function(e){return e instanceof dY}))[0]}},{key:"getInputElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}},{key:"getInputElements",value:function(){return this.elements.filter((function(e){return e instanceof QG}))}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,o,i,a){Ut(n.parentNode,"htFiltersMenuCondition"),e.addSeparator&&Ut(n.parentNode,"border");var l=e.hot.rootDocument.createElement("div");return Ut(l,"htFiltersMenuLabel"),l.textContent=a,n.appendChild(l),n.parentNode.hasAttribute("ghost-table")||U(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"reset",value:function(){var e=this.hot.getPlugin("filters").getSelectedColumn(),t=[CU(OU)];if(null!==e){var r=e.visualIndex;t=TG(this.hot.getDataType(0,r,this.hot.countRows(),r))}U(this.getInputElements(),(function(e){return e.hide()})),this.getSelectElement().setItems(t),mY(EY(n.prototype),"reset",this).call(this),this.getSelectElement().setValue(t[0])}},{key:"onConditionSelect",value:function(e){U(this.getInputElements(),(function(t,n){t[e.inputsCount>n?"show":"hide"](),0===n&&setTimeout((function(){return t.focus()}),10)})),this.runLocalHooks("change",e)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(e){qn(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),Qn(e)):qn(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Qn(e))}}]),n}(mU),PY=TY,MY={};function AY(e){if(!MY[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=MY[e].func;return function(e,n){return t(e,n)}}function IY(e){return MY[e].name}function jY(e,t,n){MY[e]={name:t,func:n}}var xY="conjunction",_Y=nb;function HY(e,t){return e.every((function(e){return e.func(t)}))}jY(xY,_Y,HY);var DY="disjunction",NY=rb;function LY(e,t){return e.some((function(e){return e.func(t)}))}jY(DY,NY,LY);var BY="disjunctionWithExtraCondition",VY=rb;function FY(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some((function(e){return e.func(t)}))&&e[e.length-1].func(t)}function WY(e){return WY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},WY(e)}function UY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GY(e,t,n){return t&&zY(e.prototype,t),n&&zY(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function YY(){return YY="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=KY(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},YY.apply(this,arguments)}function KY(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=eK(e),null===e)break;return e}function XY(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$Y(e,t)}function $Y(e,t){return $Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$Y(e,t)}function qY(e){var t=ZY();return function(){var n,r=eK(e);if(t){var o=eK(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return QY(this,n)}}function QY(e,t){if(t&&("object"===WY(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return JY(e)}function JY(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZY(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function eK(e){return eK=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},eK(e)}jY(BY,VY,FY);var tK,nK=new WeakMap,rK=function(e){XY(n,e);var t=qY(n);function n(e,r){var o;return UY(this,n),o=t.call(this,e,oe(n.DEFAULTS,r)),nK.set(JY(o),{}),o}return GY(n,[{key:"build",value:function(){YY(eK(n.prototype),"build",this).call(this);var e=nK.get(this);e.input=this._element.firstChild;var t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=t,this._element.appendChild(t),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var e=nK.get(this);e.input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.checked=e,this.update()}},{key:"focus",value:function(){this.isBuilt()&&nK.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return le({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),n}(HG),oK=rK;function iK(e){return iK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iK(e)}function aK(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function lK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uK(e,t,n){return t&&sK(e.prototype,t),n&&sK(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function cK(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fK(e,t)}function fK(e,t){return fK=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fK(e,t)}function hK(e){var t=yK();return function(){var n,r=vK(e);if(t){var o=vK(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dK(this,n)}}function dK(e,t){if(t&&("object"===iK(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return pK(e)}function pK(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yK(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function vK(e){return vK=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vK(e)}var gK=0,mK=function(e){cK(n,e);var t=hK(n);function n(e,r){var o;return lK(this,n),o=t.call(this,e,{id:r.id,stateless:!1}),o.name=r.name,o.buildOperatorsElement(),o}return uK(n,[{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n){return Ut(n.parentNode,"htFiltersMenuOperators"),n.parentNode.hasAttribute("ghost-table")||U(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"buildOperatorsElement",value:function(){var e=this,t=[xY,DY];U(t,(function(n){var r=new oK(e.hot,{name:"operator",label:{htmlFor:n,textContent:IY(n)},value:n,checked:n===t[gK],id:n});r.addLocalHook("change",(function(t){return e.onRadioInputChange(t)})),e.elements.push(r)}))}},{key:"setChecked",value:function(e){if(this.elements.length<e)throw Error(Ke(tK||(tK=aK(["Radio button with index "," doesn't exist."])),e));U(this.elements,(function(t,n){t.setChecked(n===e)}))}},{key:"getActiveOperationId",value:function(){var e=this.elements.find((function(e){return e instanceof oK&&e.isChecked()}));return e?e.getValue():xY}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(e){this.reset(),e&&this.getActiveOperationId()!==e&&U(this.elements,(function(t){t.setChecked(t.getValue()===e)}))}},{key:"updateState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xY,t=arguments.length>1?arguments[1]:void 0,n=e;n===BY&&(n=DY),this.state.setValueAtIndex(t,n)}},{key:"reset",value:function(){this.setChecked(gK)}},{key:"onRadioInputChange",value:function(e){this.setState(e.target.value)}}]),n}(mU),bK=mK;H();function wK(e,t){var n=e;return""===n&&(n="(".concat(t,")")),n}var CK=new Set([1]).has(1),SK=CK&&"function"===typeof Array.from;function OK(e){var t=e;return CK&&(t=new Set(t)),function(e){var n;return n=CK?t.has(e):!!~t.indexOf(e),n}}function kK(e){return null===e||void 0===e?"":e}function RK(e){var t=e;return t=SK?Array.from(new Set(t)):$(t),t=t.sort((function(e,t){return"number"===typeof e&&"number"===typeof t?e-t:e===t?0:e>t?1:-1})),t}function EK(e,t,n,r){var o,i=[],a=e===t;return a||(o=OK(t)),U(e,(function(e){var t=!1;(a||o(e))&&(t=!0);var l={checked:t,value:e,visualValue:wK(e,n)};r&&r(l),i.push(l)})),i}n("24cc");function TK(e){return TK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},TK(e)}function PK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function AK(e,t,n){return t&&MK(e.prototype,t),n&&MK(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function IK(){return IK="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=jK(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},IK.apply(this,arguments)}function jK(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=BK(e),null===e)break;return e}function xK(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_K(e,t)}function _K(e,t){return _K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_K(e,t)}function HK(e){var t=LK();return function(){var n,r=BK(e);if(t){var o=BK(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return DK(this,n)}}function DK(e,t){if(t&&("object"===TK(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return NK(e)}function NK(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LK(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function BK(e){return BK=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},BK(e)}var VK=new WeakMap,FK=function(e){xK(n,e);var t=HK(n);function n(e,r){var o;return PK(this,n),o=t.call(this,e,oe(n.DEFAULTS,r)),VK.set(NK(o),{}),o}return AK(n,[{key:"build",value:function(){IK(BK(n.prototype),"build",this).call(this);var e=VK.get(this);e.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(VK.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return le({href:"#",tagName:"a"})}}]),n}(HG),WK=FK;function UK(e){return UK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},UK(e)}function zK(e){return XK(e)||KK(e)||YK(e)||GK()}function GK(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function YK(e,t){if(e){if("string"===typeof e)return $K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$K(e,t):void 0}}function KK(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function XK(e){if(Array.isArray(e))return $K(e)}function $K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QK(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function JK(e,t,n){return t&&QK(e.prototype,t),n&&QK(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZK(){return ZK="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=eX(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ZK.apply(this,arguments)}function eX(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=lX(e),null===e)break;return e}function tX(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nX(e,t)}function nX(e,t){return nX=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},nX(e,t)}function rX(e){var t=aX();return function(){var n,r=lX(e);if(t){var o=lX(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oX(this,n)}}function oX(e,t){if(t&&("object"===UK(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return iX(e)}function iX(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aX(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function lX(e){return lX=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lX(e)}var sX=new WeakMap,uX="multipleSelect.itemBox",cX=function(e){tX(n,e);var t=rX(n);function n(e,r){var o;return qK(this,n),o=t.call(this,e,oe(n.DEFAULTS,r)),sX.set(iX(o),{}),o.searchInput=new QG(o.hot,{placeholder:ub,className:"htUIMultipleSelectSearch"}),o.selectAllUI=new WK(o.hot,{textContent:ib,className:"htUISelectAll"}),o.clearAllUI=new WK(o.hot,{textContent:ab,className:"htUIClearAll"}),o.items=[],o.itemsBox=null,o.registerHooks(),o}return JK(n,[{key:"registerHooks",value:function(){var e=this;this.searchInput.addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)})),this.searchInput.addLocalHook("input",(function(t){return e.onInput(t)})),this.selectAllUI.addLocalHook("click",(function(t){return e.onSelectAllClick(t)})),this.clearAllUI.addLocalHook("click",(function(t){return e.onClearAllClick(t)}))}},{key:"setItems",value:function(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(e){this.locale=e}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return zK(this.items)}},{key:"getValue",value:function(){return dX(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var e=this;ZK(lX(n.prototype),"build",this).call(this);var t=this.hot.rootDocument,r=t.createElement("div"),o=new HG(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(o.element),this._element.appendChild(r);var i=function(n){if(e._element){e.itemsBox&&e.itemsBox.destroy(),Ut(n,"htUIMultipleSelectHot"),e.itemsBox=new e.hot.constructor(n,{data:e.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(e,t,n,r,o,i){e.title=i.instance.getDataAtRowProp(t,i.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return e.itemsBox.container.scrollWidth-Cn(t)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:e.hot.isRtl()?"rtl":"ltr"}),e.itemsBox.init();var r=e.itemsBox.getShortcutManager(),o=r.getContext("grid");o.addShortcut({keys:[["Escape"]],callback:function(t){e.runLocalHooks("keydown",t,e)},group:uX})}};i(r),setTimeout((function(){return i(r)}),100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(hX(this.items,this.options.value)),ZK(lX(n.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,ZK(lX(n.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(e){var t,n=this,r=e.target.value.toLocaleLowerCase(this.getLocale());t=""===r?zK(this.items):F(this.items,(function(e){return"".concat(e.value).toLocaleLowerCase(n.getLocale()).indexOf(r)>=0})),this.itemsBox.loadData(t)}},{key:"onInputKeyDown",value:function(e){this.runLocalHooks("keydown",e,this);var t=Nn(qn,e.keyCode);t("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Qn(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(e){var t=[];e.preventDefault(),U(this.itemsBox.getSourceData(),(function(e,n){e.checked=!0,t.push(wp(e,n)[0])})),this.itemsBox.setSourceDataAtCell(t)}},{key:"onClearAllClick",value:function(e){var t=[];e.preventDefault(),U(this.itemsBox.getSourceData(),(function(e,n){e.checked=!1,t.push(wp(e,n)[0])})),this.itemsBox.setSourceDataAtCell(t)}}],[{key:"DEFAULTS",get:function(){return le({className:"htUIMultipleSelect",value:[]})}}]),n}(HG),fX=cX;function hX(e,t){var n=OK(t);return W(e,(function(e){return e.checked=n(e.value),e}))}function dX(e){var t=[];return U(e,(function(e){e.checked&&t.push(e.value)})),t}function pX(e,t){return bX(e)||mX(e,t)||vX(e,t)||yX()}function yX(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function vX(e,t){if(e){if("string"===typeof e)return gX(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gX(e,t):void 0}}function gX(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mX(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function bX(e){if(Array.isArray(e))return e}var wX="by_value";function CX(e,t){var n=pX(t,1),r=n[0];return r(e.value)}function SX(e){return SX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},SX(e)}function OX(e,t){return PX(e)||TX(e,t)||RX(e,t)||kX()}function kX(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function RX(e,t){if(e){if("string"===typeof e)return EX(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?EX(e,t):void 0}}function EX(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function TX(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function PX(e){if(Array.isArray(e))return e}function MX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IX(e,t,n){return t&&AX(e.prototype,t),n&&AX(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function jX(){return jX="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=xX(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},jX.apply(this,arguments)}function xX(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=VX(e),null===e)break;return e}function _X(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HX(e,t)}function HX(e,t){return HX=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},HX(e,t)}function DX(e){var t=BX();return function(){var n,r=VX(e);if(t){var o=VX(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return NX(this,n)}}function NX(e,t){if(t&&("object"===SX(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return LX(e)}function LX(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BX(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function VX(e){return VX=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},VX(e)}SU(wX,CX,{name:"By value",inputsCount:0,inputValuesDecorator:function(e){var t=pX(e,1),n=t[0];return[OK(n)]},showOperators:!1});var FX=function(e){_X(n,e);var t=DX(n);function n(e,r){var o;return MX(this,n),o=t.call(this,e,{id:r.id,stateless:!1}),o.name=r.name,o.elements.push(new fX(o.hot)),o.registerHooks(),o}return IX(n,[{key:"registerHooks",value:function(){var e=this;this.getMultipleSelectElement().addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)}))}},{key:"setState",value:function(e){if(this.reset(),e&&e.command.key===wX){var t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}},{key:"getState",value:function(){var e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?OU:wX},args:[e.getValue()],itemsSnapshot:t}}},{key:"updateState",value:function(e){var t=this,n=function(n,r,o,i,a){var l=F(r,(function(e){return e.name===wX})),s=OX(l,1),u=s[0],c={},f=t.hot.getTranslatedPhrase(ob);if(u){var h=RK(W(i(n,a),(function(e){return e.value})));o&&(u.args[0]=o);var d=[],p=EK(h,u.args[0],f,(function(e){e.checked&&d.push(e.value)})),y=e.editedConditionStack.column;c.locale=t.hot.getCellMeta(0,y).locale,c.args=[d],c.command=CU(wX),c.itemsSnapshot=p}else c.args=[],c.command=CU(OU);t.state.setValueAtIndex(n,c)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter((function(e){return e instanceof fX}))[0]}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,o,i,a){Ut(n.parentNode,"htFiltersMenuValue");var l=e.hot.rootDocument.createElement("div");return Ut(l,"htFiltersMenuLabel"),l.textContent=a,n.appendChild(l),n.parentNode.hasAttribute("ghost-table")||U(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"reset",value:function(){var e=this.hot.getTranslatedPhrase(ob),t=RK(this._getColumnVisibleValues()),r=EK(t,t,e);this.getMultipleSelectElement().setItems(r),jX(VX(n.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(t);var o=this.hot.getPlugin("filters").getSelectedColumn();null!==o&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,o.visualIndex).locale)}},{key:"onInputKeyDown",value:function(e){qn(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Qn(e))}},{key:"_getColumnVisibleValues",value:function(){var e=this.hot.getPlugin("filters").getSelectedColumn();return null===e?[]:W(this.hot.getDataAtCol(e.visualIndex),(function(e){return kK(e)}))}}]),n}(mU),WX=FX;function UX(e){return UX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},UX(e)}function zX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GX(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function YX(e,t,n){return t&&GX(e.prototype,t),n&&GX(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function KX(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XX(e,t)}function XX(e,t){return XX=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},XX(e,t)}function $X(e){var t=JX();return function(){var n,r=ZX(e);if(t){var o=ZX(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qX(this,n)}}function qX(e,t){if(t&&("object"===UX(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return QX(e)}function QX(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JX(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ZX(e){return ZX=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ZX(e)}var e$,t$,n$=function(e){KX(n,e);var t=$X(n);function n(e,r){var o;return zX(this,n),o=t.call(this,e,{id:r.id,stateless:!0}),o.name=r.name,o.elements.push(new QG(o.hot,{type:"button",value:lb,className:"htUIButton htUIButtonOK",identifier:n.BUTTON_OK})),o.elements.push(new QG(o.hot,{type:"button",value:sb,className:"htUIButton htUIButtonCancel",identifier:n.BUTTON_CANCEL})),o.registerHooks(),o}return YX(n,[{key:"registerHooks",value:function(){var e=this;U(this.elements,(function(t){t.addLocalHook("click",(function(t,n){return e.onButtonClick(t,n)}))}))}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n){return Ut(n.parentNode,"htFiltersMenuActionBar"),n.parentNode.hasAttribute("ghost-table")||U(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(e,t){t.options.identifier===n.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),n}(mU),r$=n$;function o$(e,t){return u$(e)||s$(e,t)||a$(e,t)||i$()}function i$(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a$(e,t){if(e){if("string"===typeof e)return l$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l$(e,t):void 0}}function l$(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s$(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function u$(e){if(Array.isArray(e))return e}function c$(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function f$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d$(e,t,n){return t&&h$(e.prototype,t),n&&h$(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var p$="ConditionCollection.filteringStates",y$=function(){function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];f$(this,e),this.hot=t,this.isMapRegistrable=n,this.filteringStates=new av,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(p$,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return d$(e,[{key:"isEmpty",value:function(){return 0===this.getFilteredColumns().length}},{key:"isMatch",value:function(e,t){var n,r=this.filteringStates.getValueAtIndex(t),o=null!==(n=null===r||void 0===r?void 0:r.conditions)&&void 0!==n?n:[],i=null===r||void 0===r?void 0:r.operation;return this.isMatchInConditions(o,e,i)}},{key:"isMatchInConditions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xY;return!e.length||AY(n)(e,t)}},{key:"addCondition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xY,r=arguments.length>3?arguments[3]:void 0,o=this.hot.getCellMeta(0,e).locale,i=W(t.args,(function(e){return"string"===typeof e?e.toLocaleLowerCase(o):e})),a=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);var l=this.getOperation(e);if(l){if(l!==n)throw Error(Ke(e$||(e$=c$(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),e,l))}else if(Je(MY[n]))throw new Error(Ke(t$||(t$=c$(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),n));var s=this.getConditions(e);0===s.length?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:a,args:i,func:wU(a,i)}]},r):s.push({name:a,args:i,func:wU(a,i)}),this.runLocalHooks("afterAdd",e)}},{key:"getConditions",value:function(e){var t,n;return null!==(t=null===(n=this.filteringStates.getValueAtIndex(e))||void 0===n?void 0:n.conditions)&&void 0!==t?t:[]}},{key:"getOperation",value:function(e){var t;return null===(t=this.filteringStates.getValueAtIndex(e))||void 0===t?void 0:t.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map((function(e){var t=o$(e,1),n=t[0];return n}))}},{key:"getColumnStackPosition",value:function(e){return this.getFilteredColumns().indexOf(e)}},{key:"exportAllConditions",value:function(){return V(this.filteringStates.getEntries(),(function(e,t){var n=o$(t,2),r=n[0],o=n[1],i=o.operation,a=o.conditions;return e.push({column:r,operation:i,conditions:W(a,(function(e){var t=e.name,n=e.args;return{name:t,args:n}}))}),e}),[])}},{key:"importAllConditions",value:function(e){var t=this;this.clean(),U(e,(function(e){U(e.conditions,(function(n){return t.addCondition(e.column,n)}))}))}},{key:"removeConditions",value:function(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(e,t){var n=this.getConditions(e);return t?n.some((function(e){return e.name===t})):n.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(p$),this.filteringStates=null,this.clearLocalHooks()}}]),e}();se(y$,Ip);var v$=y$;function g$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b$(e,t,n){return t&&m$(e.prototype,t),n&&m$(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var w$=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};g$(this,e),this.conditionCollection=t,this.columnDataFactory=n}return b$(e,[{key:"filter",value:function(){var e=this,t=[];return U(this.conditionCollection.getFilteredColumns(),(function(n,r){var o=e.columnDataFactory(n);r&&(o=e._getIntersectData(o,t)),t=e.filterByColumn(n,o)})),t}},{key:"filterByColumn",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return U(n,(function(n){void 0!==n&&t.conditionCollection.isMatch(n,e)&&r.push(n)})),r}},{key:"_getIntersectData",value:function(e,t){var n=[];return U(t,(function(t){var r=t.meta.visualRow;void 0!==e[r]&&(n[r]=e[r])})),n}}]),e}(),C$=w$;function S$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k$(e,t,n){return t&&O$(e.prototype,t),n&&O$(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var R$=function(){function e(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return[]};S$(this,e),this.hot=t,this.conditionCollection=n,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",(function(e){return r._onConditionBeforeModify(e)})),this.conditionCollection.addLocalHook("afterRemove",(function(e){return r.updateStatesAtColumn(e)})),this.conditionCollection.addLocalHook("afterAdd",(function(e){return r.updateStatesAtColumn(e)})),this.conditionCollection.addLocalHook("beforeClean",(function(){return r._onConditionBeforeClean()})),this.conditionCollection.addLocalHook("afterClean",(function(){return r._onConditionAfterClean()}))}return k$(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var e=this;this.grouping=!1,U(this.changes,(function(t){e.updateStatesAtColumn(t)})),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}},{key:"updateStatesAtColumn",value:function(e,t){var n=this;if(this.grouping)-1===this.changes.indexOf(e)&&this.changes.push(e);else{var r=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(e);-1===o&&(o=this.latestEditedColumnPosition);var i=r.slice(0,o),a=r.slice(o);a.length&&a[0].column===e&&a.shift();var l=Ln((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new v$(n.hot,!1),i=[].concat(e,r);o.importAllConditions(i);var a,l=n.columnDataFactory(t);a=o.isEmpty()?l:new C$(o,(function(e){return n.columnDataFactory(e)})).filter(),a=W(a,(function(e){return e.meta.visualRow}));var s=OK(a);return o.destroy(),F(l,(function(e){return s(e.meta.visualRow)}))}))(i),s=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:s},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:t})}}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var e=this;U(this.latestOrderStack,(function(t){e.updateStatesAtColumn(t)}))}},{key:"destroy",value:function(){var e=this;this.clearLocalHooks(),he(this,(function(t,n){e[n]=null}))}}]),e}();se(R$,Ip);var E$,T$=R$;function P$(e){return P$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P$(e)}function M$(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function A$(e,t){return H$(e)||_$(e,t)||j$(e,t)||I$()}function I$(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function j$(e,t){if(e){if("string"===typeof e)return x$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x$(e,t):void 0}}function x$(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _$(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function H$(e){if(Array.isArray(e))return e}function D$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N$(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function L$(e,t,n){return t&&N$(e.prototype,t),n&&N$(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function B$(){return B$="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=V$(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},B$.apply(this,arguments)}function V$(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=K$(e),null===e)break;return e}function F$(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W$(e,t)}function W$(e,t){return W$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},W$(e,t)}function U$(e){var t=Y$();return function(){var n,r=K$(e);if(t){var o=K$(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return z$(this,n)}}function z$(e,t){if(t&&("object"===P$(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return G$(e)}function G$(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Y$(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function K$(e){return K$=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},K$(e)}var X$="filters",$$=250,q$=function(e){F$(n,e);var t=U$(n);function n(e){var r;return D$(this,n),r=t.call(this,e),r.eventManager=new Nr(G$(r)),r.dropdownMenuPlugin=null,r.conditionCollection=null,r.conditionUpdateObserver=null,r.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),r.lastSelectedColumn=null,r.filtersRowsMap=null,r.hot.addHook("afterGetColHeader",(function(e,t){return r.onAfterGetColHeader(e,t)})),r}return L$(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[X$]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new mv),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var t=this.hot.getSettings().dropdownMenu,r=t&&t.uiContainer||this.hot.rootDocument.body,o=function(t){return t.addLocalHook("accept",(function(){return e.onActionBarSubmit("accept")})),t.addLocalHook("cancel",(function(){return e.onActionBarSubmit("cancel")})),t.addLocalHook("change",(function(n){return e.onComponentChange(t,n)})),t},i=function(){return"".concat(e.hot.getTranslatedPhrase(eb),":")},a=function(){return"".concat(e.hot.getTranslatedPhrase(tb),":")};if(!this.components.get("filter_by_condition")){var l=new PY(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:r});l.addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),this.components.set("filter_by_condition",o(l))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new bK(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var s=new PY(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});s.addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),this.components.set("filter_by_condition2",o(s))}this.components.get("filter_by_value")||this.components.set("filter_by_value",o(new WX(this.hot,{id:"filter_by_value",name:a}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",o(new r$(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new v$(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new T$(this.hot,this.conditionCollection,(function(t){return e.getDataMapAtColumn(t)})),this.conditionUpdateObserver.addLocalHook("update",(function(t){return e.updateComponents(t)}))),this.components.forEach((function(e){return e.show()})),this.addHook("beforeDropdownMenuSetItems",(function(t){return e.onBeforeDropdownMenuSetItems(t)})),this.addHook("afterDropdownMenuDefaultOptions",(function(t){return e.onAfterDropdownMenuDefaultOptions(t)})),this.addHook("afterDropdownMenuShow",(function(){return e.onAfterDropdownMenuShow()})),this.addHook("afterDropdownMenuHide",(function(){return e.onAfterDropdownMenuHide()})),this.addHook("afterChange",(function(t){return e.onAfterChange(t)})),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),B$(K$(n.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var e,t=this;this.enabled&&(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((function(e,n){e.destroy(),t.components.set(n,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));B$(K$(n.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:xY,o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:t},args:n},r)}},{key:"removeConditions",value:function(e){var t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}},{key:"clearConditions",value:function(e){if(void 0===e)this.conditionCollection.clean();else{var t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}},{key:"filter",value:function(){var e=this,t=this._createDataFilter(),n=!this.conditionCollection.isEmpty(),r=[],o=this.conditionCollection.exportAllConditions(),i=this.hot.runHooks("beforeFilter",o);if(!1!==i)if(n){var a=[];this.hot.batchExecution((function(){e.filtersRowsMap.clear(),r=W(t.filter(),(function(e){return e.meta.visualRow}));var n=OK(r);Co(e.hot.countSourceRows()-1,(function(e){n(e)||a.push(e)})),U(a,(function(t){e.filtersRowsMap.setValueAtIndex(t,!0)}))}),!0),r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var e,t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}},{key:"clearColumnSelection",value:function(){var e=this.getSelectedColumn();null!==e&&this.hot.selectCell(0,e.visualIndex)}},{key:"getDataMapAtColumn",value:function(e){var t=this,n=this.hot.toVisualColumn(e),r=[];return U(this.hot.getSourceDataAtCol(n),(function(e,o){var i,a=t.hot.getCellMeta(o,n),l=a.row,s=a.col,u=a.visualCol,c=a.visualRow,f=a.type,h=a.instance,d=a.dateFormat,p=a.locale,y=null!==(i=t.hot.getDataAtCell(t.hot.toVisualRow(o),n))&&void 0!==i?i:e;r.push({meta:{row:l,col:s,visualCol:u,visualRow:c,type:f,instance:h,dateFormat:d,locale:p},value:kK(y)})})),r}},{key:"onAfterChange",value:function(e){var t=this;e&&U(e,(function(e){var n=A$(e,2),r=n[1],o=t.hot.propToCol(r);t.conditionCollection.hasConditions(o)&&t.updateValueComponentCondition(o)}))}},{key:"updateValueComponentCondition",value:function(e){var t=this.hot.getDataAtCol(e),n=RK(t);this.conditionUpdateObserver.updateStatesAtColumn(e,n)}},{key:"restoreComponents",value:function(e){var t,n=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex;e.forEach((function(e){e.isHidden()||e.restoreState(n)})),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var e=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",(function(){e.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})}))}},{key:"onAfterDropdownMenuDefaultOptions",value:function(e){e.items.push({name:FD}),this.components.forEach((function(t){e.items.push(t.getMenuItemDescriptor())}))}},{key:"getOperationBasedOnArguments",value:function(e,t,n,r){var o=e;return o===DY&&t.command.key!==OU&&n.command.key!==OU&&r.command.key!==OU?o=BY:r.command.key!==OU&&(t.command.key!==OU&&n.command.key!==OU||(o=xY)),o}},{key:"onActionBarSubmit",value:function(e){var t;if("accept"===e){var n,r=this.getSelectedColumn();if(null===r)return void(null===(n=this.dropdownMenuPlugin)||void 0===n||n.close());var o=r.physicalIndex,i=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),i,a,l);this.conditionUpdateObserver.groupChanges();var u=this.conditionCollection.getColumnStackPosition(o);-1===u&&(u=void 0),this.conditionCollection.removeConditions(o),i.command.key!==OU&&(this.conditionCollection.addCondition(o,i,s,u),a.command.key!==OU&&this.conditionCollection.addCondition(o,a,s,u)),l.command.key!==OU&&this.conditionCollection.addCondition(o,l,s,u),this.conditionUpdateObserver.flush(),this.components.forEach((function(e){return e.saveState(o)})),this.filtersRowsMap.clear(),this.filter()}null===(t=this.dropdownMenuPlugin)||void 0===t||t.close()}},{key:"onComponentChange",value:function(e,t){this.updateDependentComponentsVisibility(),e.constructor!==PY||t.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var e=this.components.get("filter_by_condition"),t=e.getState(),n=t.command,r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents.apply(this,r):this.hideComponents.apply(this,r)}},{key:"onAfterGetColHeader",value:function(e,t){var n=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(n)?Ut(t,"htFiltersActive"):zt(t,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new C$(t,(function(t){return e.getDataMapAtColumn(t)}))}},{key:"updateComponents",value:function(e){var t;if(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled){var n=e.editedConditionStack,r=n.conditions,o=n.column,i=r.filter((function(e){return e.name===wX})),a=r.filter((function(e){return e.name!==wX}));if(i.length>=2||a.length>=3)Fn(Ke(E$||(E$=M$(["The filter conditions have been applied properly, but couldnt be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldnt be displayed visually.\\x20\n        The overall amount of conditions exceed the capability of the dropdown menu.\\x20\n        For more details see the documentation."]))));else{var l=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(a[0],o),this.components.get("filter_by_condition2").updateState(a[1],o),this.components.get("filter_operators").updateState(l,o),this.components.get("filter_by_value").updateState(e)}}}},{key:"getIndexesOfComponents",value:function(){var e=[];if(!this.dropdownMenuPlugin)return e;for(var t=this.dropdownMenuPlugin.menu,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return U(r,(function(n){U(t.menuItems,(function(t,r){t.key===n.getMenuItemDescriptor().key&&e.push(r)}))})),e}},{key:"changeComponentsVisibility",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.dropdownMenuPlugin){for(var t=this.dropdownMenuPlugin.menu,n=t.hotMenu,r=n.getPlugin("hiddenRows"),o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=this.getIndexesOfComponents.apply(this,i);e?r.showRows(l):r.hideRows(l),n.render()}}},{key:"hideComponents",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(t))}},{key:"showComponents",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(t))}},{key:"destroy",value:function(){var e=this;this.enabled&&(this.components.forEach((function(t,n){null!==t&&(t.destroy(),e.components.set(n,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),B$(K$(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return X$}},{key:"PLUGIN_PRIORITY",get:function(){return $$}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),n}($A);function Q$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q$(Object(n),!0).forEach((function(t){Z$(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Z$(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eq="internal-use-in-handsontable",tq={licenseKey:eq,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function nq(e){var t,n;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null===(t=e[Jq])||void 0===t||null===(n=t.language)||void 0===n?void 0:n.langCode}}function rq(e){return Object.keys(e).reduce((function(t,n){return"hyperformula"!==n&&(t[n]=e[n]),t}),{})}function oq(e){var t,n=e[Jq],r=rq(null!==n&&void 0!==n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),o=nq(e);return J$(J$(J$({},tq),r),o)}function iq(e){var t,n=e[Jq],r=rq(null!==n&&void 0!==n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),o=nq(e);return J$(J$({},r),o)}function aq(e){return aq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aq(e)}function lq(){var e="engine_relationship",t=wr(Jq);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function sq(){var e="shared_engine_usage",t=wr(Jq);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function uq(e){var t,n=e.getSettings(),r=n[Jq],o=null===r||void 0===r?void 0:r.engine;if(!0===r)return null;if(Je(o))return null;if("function"===typeof o.hyperformula||"function"===typeof o)return cq(null!==(t=o.hyperformula)&&void 0!==t?t:o,n,e);if("object"===aq(o)&&Je(o.hyperformula)){var i=lq(),a=sq().get(o);return i.has(o)||i.set(o,[]),i.get(o).push(e),a&&a.push(e.guid),o.getConfig().licenseKey||o.updateConfig({licenseKey:eq}),o}return null}function cq(e,t,n){var r=t[Jq],o=oq(t),i=lq(),a=sq();dq(e,r.functions),pq(e,r.language);var l=e.buildEmpty(o);return i.set(l,[n]),a.set(l,[n.guid]),yq(l,r.namedExpressions),l.on("sheetAdded",(function(){l.rebuildAndRecalculate()})),l.on("sheetRemoved",(function(){l.rebuildAndRecalculate()})),l}function fq(e){var t,n=lq(),r=0===n.size?[]:Array.from(null!==(t=n.get(e))&&void 0!==t?t:[]);return new Map(r.map((function(e){return[e.getPlugin("formulas").sheetId,e]})))}function hq(e,t){if(e){var n=lq(),r=n.get(e),o=sq(),i=o.get(e);r&&r.includes(t)&&(r.splice(r.indexOf(t),1),0===r.length&&n.delete(e)),i&&i.includes(t.guid)&&(i.splice(i.indexOf(t.guid),1),0===i.length&&(o.delete(e),e.destroy()))}}function dq(e,t){t&&t.forEach((function(t){var n=t.name,r=t.plugin,o=t.translations;try{e.registerFunction(n,r,o)}catch(i){Fn(i.message)}}))}function pq(e,t){if(t){var n=t.langCode;try{e.registerLanguage(n,t)}catch(r){Fn(r.message)}}}function yq(e,t){t&&(e.suspendEvaluation(),t.forEach((function(t){var n=t.name,r=t.expression,o=t.scope,i=t.options;try{e.addNamedExpression(n,r,o,i)}catch(a){Fn(a.message)}})),e.resumeEvaluation())}function vq(e,t){return!Je(t)&&e.doesSheetExist(t)||(t=e.addSheet(t)),t}function gq(e){return"string"===typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}function mq(e){return gq(e)?e.substr(1):e}function bq(e){return Sq(e)||Cq(e)||Pq(e)||wq()}function wq(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Cq(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Sq(e){if(Array.isArray(e))return Mq(e)}function Oq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kq(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oq(Object(n),!0).forEach((function(t){zq(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oq(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Rq(e){return Rq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rq(e)}function Eq(e,t){return Iq(e)||Aq(e,t)||Pq(e,t)||Tq()}function Tq(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Pq(e,t){if(e){if("string"===typeof e)return Mq(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mq(e,t):void 0}}function Mq(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Aq(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Iq(e){if(Array.isArray(e))return e}function jq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xq(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _q(e,t,n){return t&&xq(e.prototype,t),n&&xq(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hq(){return Hq="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Dq(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Hq.apply(this,arguments)}function Dq(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Uq(e),null===e)break;return e}function Nq(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lq(e,t)}function Lq(e,t){return Lq=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Lq(e,t)}function Bq(e){var t=Wq();return function(){var n,r=Uq(e);if(t){var o=Uq(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vq(this,n)}}function Vq(e,t){if(t&&("object"===Rq(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Fq(e)}function Fq(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wq(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Uq(e){return Uq=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Uq(e)}function zq(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gq(e,t,n){Yq(e,t),t.set(e,n)}function Yq(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kq(e,t,n){var r=qq(e,t,"set");return Xq(e,r,n),n}function Xq(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function $q(e,t){var n=qq(e,t,"get");return Qq(e,n)}function qq(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function Qq(e,t){return t.get?t.get.call(e):t.value}var Jq="formulas",Zq=260,eQ="row_move";hr.getSingleton().register("afterNamedExpressionAdded"),hr.getSingleton().register("afterNamedExpressionRemoved"),hr.getSingleton().register("afterSheetAdded"),hr.getSingleton().register("afterSheetRemoved"),hr.getSingleton().register("afterSheetRenamed"),hr.getSingleton().register("afterFormulasValuesUpdate");var tQ=function(e){return"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e},nQ=new WeakMap,rQ=new WeakMap,oQ=new WeakMap,iQ=function(e){Nq(n,e);var t=Bq(n);function n(){var e;jq(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),Gq(Fq(e),nQ,{writable:!0,value:!1}),Gq(Fq(e),rQ,{writable:!0,value:!1}),Gq(Fq(e),oQ,{writable:!0,value:[["valuesUpdated",function(){var t;return(t=e).onEngineValuesUpdated.apply(t,arguments)}],["namedExpressionAdded",function(){var t;return(t=e).onEngineNamedExpressionsAdded.apply(t,arguments)}],["namedExpressionRemoved",function(){var t;return(t=e).onEngineNamedExpressionsRemoved.apply(t,arguments)}],["sheetAdded",function(){var t;return(t=e).onEngineSheetAdded.apply(t,arguments)}],["sheetRenamed",function(){var t;return(t=e).onEngineSheetRenamed.apply(t,arguments)}],["sheetRemoved",function(){var t;return(t=e).onEngineSheetRemoved.apply(t,arguments)}]]}),zq(Fq(e),"staticRegister",wr("formulas")),zq(Fq(e),"engine",null),zq(Fq(e),"sheetName",null),e}return _q(n,[{key:"sheetId",get:function(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Jq]}},{key:"enablePlugin",value:function(){var e,t=this;if(!this.enabled)if(this.engine=null!==(e=uq(this.hot))&&void 0!==e?e:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){var r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==r&&(this.sheetName=r)}this.addHook("beforeLoadData",(function(){return t.onBeforeLoadData.apply(t,arguments)})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("beforeUpdateData",(function(){return t.onBeforeLoadData.apply(t,arguments)})),this.addHook("afterUpdateData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("modifyData",(function(){return t.onModifyData.apply(t,arguments)})),this.addHook("modifySourceData",(function(){return t.onModifySourceData.apply(t,arguments)})),this.addHook("beforeValidate",(function(){return t.onBeforeValidate.apply(t,arguments)})),this.addHook("afterSetSourceDataAtCell",(function(){return t.onAfterSetSourceDataAtCell.apply(t,arguments)})),this.addHook("afterSetDataAtCell",(function(){return t.onAfterSetDataAtCell.apply(t,arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return t.onAfterSetDataAtCell.apply(t,arguments)})),this.addHook("beforeCreateRow",(function(){return t.onBeforeCreateRow.apply(t,arguments)})),this.addHook("beforeCreateCol",(function(){return t.onBeforeCreateCol.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol.apply(t,arguments)})),this.addHook("beforeRemoveRow",(function(){return t.onBeforeRemoveRow.apply(t,arguments)})),this.addHook("beforeRemoveCol",(function(){return t.onBeforeRemoveCol.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol.apply(t,arguments)})),this.addHook("beforeUndo",(function(e){(null===e||void 0===e?void 0:e.actionType)!==eQ&&t.engine.undo()})),this.addHook("beforeRedo",(function(e){(null===e||void 0===e?void 0:e.actionType)!==eQ&&t.engine.redo()})),this.addHook("afterDetachChild",(function(){return t.onAfterDetachChild.apply(t,arguments)})),this.addHook("beforeAutofill",(function(){return t.onBeforeAutofill.apply(t,arguments)})),$q(this,oQ).forEach((function(e){var n=Eq(e,2),r=n[0],o=n[1];return t.engine.on(r,o)})),Hq(Uq(n.prototype),"enablePlugin",this).call(this)}else Fn("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}},{key:"disablePlugin",value:function(){var e=this;$q(this,oQ).forEach((function(t){var n=Eq(t,2),r=n[0],o=n[1];return e.engine.off(r,o)})),hq(this.engine,this.hot),this.engine=null,Hq(Uq(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(e){this.engine.updateConfig(iq(this.hot.getSettings()));var t=this.hot.getSettings()[Jq];if(Qe(t)&&Qe(t.sheetName)&&t.sheetName!==this.sheetName&&this.switchSheet(t.sheetName),!e.data&&null===this.sheetName){var r=this.hot.getSettings()[Jq].sheetName;r&&this.engine.doesSheetExist(r)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!==r&&void 0!==r?r:void 0,this.hot.getSourceDataArray())}Hq(Uq(n.prototype),"updatePlugin",this).call(this,e)}},{key:"destroy",value:function(){var e=this;$q(this,oQ).forEach((function(t){var n,r=Eq(t,2),o=r[0],i=r[1];return null===(n=e.engine)||void 0===n?void 0:n.off(o,i)})),Kq(this,oQ,null),hq(this.engine,this.hot),this.engine=null,Hq(Uq(n.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(e,t,n,r,o){return!o&&e>=n?r+(e-n):t}},{key:"toPhysicalRowPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPhysicalIndexPosition(e,this.hot.toPhysicalRow(e),this.hot.countRows(),this.hot.countSourceRows(),t)}},{key:"toPhysicalColumnPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPhysicalIndexPosition(e,this.hot.toPhysicalColumn(e),this.hot.countCols(),this.hot.countSourceCols(),t)}},{key:"addSheet",value:function(e,t){if(Qe(t)&&!Sp(t))return Fn("The provided data should be an array of arrays."),!1;if(void 0!==e&&null!==e&&this.engine.doesSheetExist(e))return Fn("Sheet with the provided name already exists."),!1;try{var n=this.engine.addSheet(null!==e&&void 0!==e?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(n),t),n}catch(r){return Fn(r.message),!1}}},{key:"switchSheet",value:function(e){if(this.engine.doesSheetExist(e)){this.sheetName=e;var t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,"".concat(gt(Jq),".switchSheet"))}else Wn("The sheet named `".concat(e,"` does not exist, switch aborted."))}},{key:"getCellType",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(t);return null!==r&&null!==o?this.engine.getCellType({sheet:n,row:r,col:o}):"EMPTY"}},{key:"isFormulaCellType",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(t);return null!==r&&null!==o&&this.engine.doesCellHaveFormula({sheet:n,row:r,col:o})}},{key:"renderDependentSheets",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Set;e.forEach((function(e){var t,n=null===e||void 0===e||null===(t=e.address)||void 0===t?void 0:t.sheet;void 0!==n&&(r.has(n)||r.add(n))})),fq(this.engine).forEach((function(e,o){var i;(n||o!==t.sheetId)&&r.has(o)&&(e.render(),null===(i=e.view)||void 0===i||i.adjustElementsSize())}))}},{key:"validateDependentCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function(e){var t,n=null!==(t=null===e||void 0===e?void 0:e.address)&&void 0!==t?t:{},r=n.row,o=n.col,i=n.sheet;return Qe(i)?"".concat(i,":").concat(r,"x").concat(o):""},o=new Set(n.map((function(e){return r(e)})));e.forEach((function(e){var n,i,a=null!==(n=e.address)&&void 0!==n?n:{},l=a.row,s=a.col,u=Qe(l)?t.hot.toVisualRow(l):null,c=Qe(s)?t.hot.toVisualColumn(s):null;if(null!==u&&null!==c){var f=null===e||void 0===e||null===(i=e.address)||void 0===i?void 0:i.sheet,h=r(e);if(void 0!==f&&!o.has(h)){var d=fq(t.engine).get(f);if(!d)return;d.validateCell(d.getDataAtCell(u,c),d.getCellMeta(u,c),(function(){}))}}}))}},{key:"syncChangeWithEngine",value:function(e,t,n){var r={row:this.toPhysicalRowPosition(e),col:this.toPhysicalColumnPosition(t),sheet:this.sheetId};if(this.engine.isItPossibleToSetCellContents(r))return this.engine.setCellContents(r,n);Fn("Not possible to set cell data at ".concat(JSON.stringify(r)))}},{key:"onBeforeValidate",value:function(e,t,n){var r=this.hot.propToCol(n);if(this.isFormulaCellType(t,r)){var o={row:this.hot.toPhysicalRow(t),col:this.hot.toPhysicalColumn(r),sheet:this.sheetId},i=this.engine.getCellValue(o);return"object"===Rq(i)&&null!==i?i.value:i}return e}},{key:"onBeforeAutofill",value:function(e,t,n){var r=this,o=function(e){return kq(kq({},e),{},{sheet:r.sheetId})},i={start:o(t.getTopStartCorner()),end:o(t.getBottomEndCorner())},a={start:o(n.getTopStartCorner()),end:o(n.getBottomEndCorner())};return!1!==this.engine.isItPossibleToSetCellContents(a)&&this.engine.getFillRangeData(i,a)}},{key:"onBeforeLoadData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n.includes(gt(Jq))||Kq(this,rQ,Je(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!n.includes(gt(Jq)))if(this.sheetName=vq(this.engine,this.hot.getSettings()[Jq].sheetName),$q(this,rQ))this.switchSheet(this.sheetName);else{var r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Kq(this,nQ,!0);var o=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(o),Kq(this,nQ,!1)}}}},{key:"onModifyData",value:function(e,t,n,r){if("get"===r&&!$q(this,nQ)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var o=this.hot.toVisualRow(e),i=this.isFormulaCellType(o,t);if(!i){var a=this.getCellType(o,t);if("ARRAY"!==a)return void(gq(n.value)&&(n.value=mq(n.value)))}var l={row:e,col:this.toPhysicalColumnPosition(t),sheet:this.sheetId},s=this.engine.getCellValue(l),u="object"===Rq(s)&&null!==s?s.value:s;n.value=u}}},{key:"onModifySourceData",value:function(e,t,n,r){if("get"===r&&!$q(this,nQ)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var o=this.hot.toVisualRow(e),i=this.hot.propToCol(t),a=this.isFormulaCellType(o,i);if(!a){var l=this.getCellType(o,i);if("ARRAY"!==l)return}var s=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0!==s.width||0!==s.height){var u={row:e,col:this.toPhysicalColumnPosition(i),sheet:this.sheetId};n.value=this.engine.getCellSerialized(u)}}}},{key:"onAfterSetDataAtCell",value:function(e,t){var n=this;if(!tQ(t)){var r=[],o=[],i=this.engine.batch((function(){e.forEach((function(e){var t=Eq(e,4),i=t[0],a=t[1],l=t[3],s=n.hot.propToCol(a),u=n.hot.toPhysicalRow(i),c=n.hot.toPhysicalColumn(s),f={row:u,col:c,sheet:n.sheetId};null!==u&&null!==c?n.syncChangeWithEngine(i,s,l):r.push([i,s,l]),o.push({address:f})}))}));r.length&&this.hot.addHookOnce("afterChange",(function(){var e=n.engine.batch((function(){r.forEach((function(e){var t=Eq(e,3),r=t[0],o=t[1],i=t[2];n.syncChangeWithEngine(r,o,i)}))}));n.renderDependentSheets(e,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,o)}}},{key:"onAfterSetSourceDataAtCell",value:function(e,t){var n=this;if(!tQ(t)){var r=[],o=[];e.forEach((function(e){var t=Eq(e,4),i=t[0],a=t[1],l=t[3],s=n.hot.propToCol(a);if(bo(s)){var u={row:i,col:n.toPhysicalColumnPosition(s),sheet:n.sheetId};n.engine.isItPossibleToSetCellContents(u)?(o.push({address:u}),r.push.apply(r,bq(n.engine.setCellContents(u,l)))):Fn("Not possible to set source cell data at ".concat(JSON.stringify(u)))}})),this.renderDependentSheets(r),this.validateDependentCells(r,o)}}},{key:"onBeforeCreateRow",value:function(e,t){if(null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(e),t]))return!1}},{key:"onBeforeCreateCol",value:function(e,t){if(null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(e),t]))return!1}},{key:"onBeforeRemoveRow",value:function(e,t,n){var r=this,o=n.every((function(e){return r.engine.isItPossibleToRemoveRows(r.sheetId,[e,1])}));return!1!==o&&void 0}},{key:"onBeforeRemoveCol",value:function(e,t,n){var r=this,o=n.every((function(e){return r.engine.isItPossibleToRemoveColumns(r.sheetId,[e,1])}));return!1!==o&&void 0}},{key:"onAfterCreateRow",value:function(e,t,n){if(!tQ(n)){var r=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(e),t]);this.renderDependentSheets(r)}}},{key:"onAfterCreateCol",value:function(e,t,n){if(!tQ(n)){var r=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(e),t]);this.renderDependentSheets(r)}}},{key:"onAfterRemoveRow",value:function(e,t,n,r){var o=this;if(!tQ(r)){var i=n.sort().reverse(),a=this.engine.batch((function(){i.forEach((function(e){o.engine.removeRows(o.sheetId,[e,1])}))}));this.renderDependentSheets(a)}}},{key:"onAfterRemoveCol",value:function(e,t,n,r){var o=this;if(!tQ(r)){var i=n.sort().reverse(),a=this.engine.batch((function(){i.forEach((function(e){o.engine.removeColumns(o.sheetId,[e,1])}))}));this.renderDependentSheets(a)}}},{key:"onAfterDetachChild",value:function(e,t,n){var r,o=this;Kq(this,nQ,!0);var i=this.hot.getSourceDataArray(n,0,n+((null===(r=t.__children)||void 0===r?void 0:r.length)||0),this.hot.countSourceCols());Kq(this,nQ,!1),i.forEach((function(e,t){e.forEach((function(e,r){o.engine.setCellContents({col:r,row:n+t,sheet:o.sheetId},[[e]])}))}))}},{key:"onEngineValuesUpdated",value:function(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}},{key:"onEngineNamedExpressionsAdded",value:function(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}},{key:"onEngineNamedExpressionsRemoved",value:function(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}},{key:"onEngineSheetAdded",value:function(e){this.hot.runHooks("afterSheetAdded",e)}},{key:"onEngineSheetRenamed",value:function(e,t){this.hot.runHooks("afterSheetRenamed",e,t)}},{key:"onEngineSheetRemoved",value:function(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}}],[{key:"PLUGIN_KEY",get:function(){return Jq}},{key:"PLUGIN_PRIORITY",get:function(){return Zq}}]),n}($A);function aQ(e,t){return fQ(e)||cQ(e,t)||sQ(e,t)||lQ()}function lQ(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function sQ(e,t){if(e){if("string"===typeof e)return uQ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uQ(e,t):void 0}}function uQ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cQ(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function fQ(e){if(Array.isArray(e))return e}function hQ(e){return{key:"hidden_columns_hide",name:function(){var e=this.getSelectedLast(),t=0;if(Array.isArray(e)){var n=aQ(e,4),r=n[1],o=n[3];r-o!==0&&(t=1)}return this.getTranslatedPhrase(Tm,t)},callback:function(){for(var t=this.getSelectedRangeLast(),n=t.from,r=t.to,o=Math.max(Math.min(n.col,r.col),0),i=Math.max(n.col,r.col),a=[],l=o;l<=i;l+=1)a.push(l);e.hideColumns(a);var s=a[a.length-1],u=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(u)&&u>=0?this.selectColumns(u):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function dQ(e){return gQ(e)||vQ(e)||yQ(e)||pQ()}function pQ(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function yQ(e,t){if(e){if("string"===typeof e)return mQ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mQ(e,t):void 0}}function vQ(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function gQ(e){if(Array.isArray(e))return mQ(e)}function mQ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bQ(e){var t=[];return{key:"hidden_columns_show",name:function(){var e=t.length>1?1:0;return this.getTranslatedPhrase(Pm,e)},callback:function(){var n,r;if(0!==t.length){var o=t[0],i=t[t.length-1];o=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,i=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(i+1,1))&&void 0!==r?r:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var a=i-o+1===this.countCols();a||this.selectColumns(o,i)}},disabled:!1,hidden:function(){var n=this,r=W(e.getHiddenColumns(),(function(e){return n.toPhysicalColumn(e)}));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),i=o.getTopStartCorner().col,a=o.getBottomEndCorner().col,l=this.columnIndexMapper,s=l.getRenderableFromVisualIndex(i),u=l.getRenderableFromVisualIndex(a),c=l.getNotTrimmedIndexes(),f=[];if(i!==a){var h=a-i+1,d=u-s+1;if(h>d){var p=c.slice(i,a+1);f.push.apply(f,dQ(p.filter((function(e){return r.includes(e)}))))}}else if(0===s&&s<i)f.push.apply(f,dQ(c.slice(0,i)));else if(null===s)f.push.apply(f,dQ(c.slice(0,this.countCols())));else{var y=this.countCols()-1,v=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1));u===v&&y>a&&f.push.apply(f,dQ(c.slice(a+1)))}return U(f,(function(e){t.push(n.toVisualColumn(e))})),0===t.length}}}function wQ(e){return wQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wQ(e)}function CQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SQ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function OQ(e,t,n){return t&&SQ(e.prototype,t),n&&SQ(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function kQ(){return kQ="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=RQ(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},kQ.apply(this,arguments)}function RQ(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=jQ(e),null===e)break;return e}function EQ(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TQ(e,t)}function TQ(e,t){return TQ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},TQ(e,t)}function PQ(e){var t=IQ();return function(){var n,r=jQ(e);if(t){var o=jQ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return MQ(this,n)}}function MQ(e,t){if(t&&("object"===wQ(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return AQ(e)}function AQ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IQ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function jQ(e){return jQ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jQ(e)}function xQ(e,t,n){_Q(e,t),t.set(e,n)}function _Q(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HQ(e,t){var n=LQ(e,t,"get");return DQ(e,n)}function DQ(e,t){return t.get?t.get.call(e):t.value}function NQ(e,t,n){var r=LQ(e,t,"set");return BQ(e,r,n),n}function LQ(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function BQ(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}hr.getSingleton().register("beforeHideColumns"),hr.getSingleton().register("afterHideColumns"),hr.getSingleton().register("beforeUnhideColumns"),hr.getSingleton().register("afterUnhideColumns");var VQ="hiddenColumns",FQ=310,WQ=new WeakMap,UQ=new WeakMap,zQ=function(e){EQ(n,e);var t=PQ(n);function n(){var e;CQ(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),xQ(AQ(e),WQ,{writable:!0,value:{}}),xQ(AQ(e),UQ,{writable:!0,value:null}),e}return OQ(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[VQ]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings()[VQ];ce(t)&&(NQ(this,WQ,t),Je(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),NQ(this,UQ,new By),HQ(this,UQ).addLocalHook("init",(function(){return e.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,HQ(this,UQ)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(t,n,r){return e.onAfterGetCellMeta(t,n,r)})),this.addHook("modifyColWidth",(function(t,n){return e.onModifyColWidth(t,n)})),this.addHook("afterGetColHeader",(function(){return e.onAfterGetColHeader.apply(e,arguments)})),this.addHook("modifyCopyableRange",(function(t){return e.onModifyCopyableRange(t)})),kQ(jQ(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),kQ(jQ(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),NQ(this,WQ,{}),kQ(jQ(n.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(e){var t=this,n=this.getHiddenColumns(),r=this.isValidConfig(e),o=n,i=HQ(this,UQ).getValues().slice(),a=e.length>0;if(r&&a){var l=e.map((function(e){return t.hot.toPhysicalColumn(e)}));U(l,(function(e){i[e]=!1})),o=V(i,(function(e,n,r){return n&&e.push(t.hot.toVisualColumn(r)),e}),[])}var s=this.hot.runHooks("beforeUnhideColumns",n,o,r&&a);!1!==s&&(r&&a&&HQ(this,UQ).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,o,r&&a,r&&o.length<n.length))}},{key:"showColumn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}},{key:"hideColumns",value:function(e){var t=this,n=this.getHiddenColumns(),r=this.isValidConfig(e),o=n;r&&(o=Array.from(new Set(n.concat(e))));var i=this.hot.runHooks("beforeHideColumns",n,o,r);!1!==i&&(r&&this.hot.batchExecution((function(){U(e,(function(e){HQ(t,UQ).setValueAtIndex(t.hot.toPhysicalColumn(e),!0)}))}),!0),this.hot.runHooks("afterHideColumns",n,o,r,r&&o.length>n.length))}},{key:"hideColumn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}},{key:"getHiddenColumns",value:function(){var e=this;return W(HQ(this,UQ).getHiddenIndexes(),(function(t){return e.hot.toVisualColumn(t)}))}},{key:"isHidden",value:function(e){return HQ(this,UQ).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}},{key:"isValidConfig",value:function(e){var t=this.hot.countCols();return!!(Array.isArray(e)&&e.length>0)&&e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"resetCellsMeta",value:function(){U(this.hot.getCellsMeta(),(function(e){e&&(e.skipColumnOnPaste=!1)}))}},{key:"onModifyColWidth",value:function(e,t){return this.isHidden(t)?0:HQ(this,WQ).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"===typeof e&&this.hot.hasColHeaders()?e+15:void 0}},{key:"onAfterGetCellMeta",value:function(e,t,n){if(!1===HQ(this,WQ).copyPasteEnabled&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenColumn");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(e){var t=this;if(HQ(this,WQ).copyPasteEnabled)return e;var n=[],r=function(e,t,r,o){n.push({startRow:e,endRow:t,startCol:r,endCol:o})};return U(e,(function(e){var n=!0,o=0;Co(e.startCol,e.endCol,(function(i){t.isHidden(i)?(n||r(e.startRow,e.endRow,o,i-1),n=!0):(n&&(o=i),i===e.endCol&&r(e.startRow,e.endRow,o,i),n=!1)}))})),n}},{key:"onAfterGetColHeader",value:function(e,t){if(HQ(this,WQ).indicators&&!(e<0)){var n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&n.push("beforeHiddenColumn"),Ut(t,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){e.items.push({name:FD},hQ(this),bQ(this))}},{key:"onMapInit",value:function(){Array.isArray(HQ(this,WQ).columns)&&this.hideColumns(HQ(this,WQ).columns)}},{key:"destroy",value:function(){NQ(this,WQ,null),NQ(this,UQ,null),kQ(jQ(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return VQ}},{key:"PLUGIN_PRIORITY",get:function(){return FQ}}]),n}($A);function GQ(e,t){return qQ(e)||$Q(e,t)||KQ(e,t)||YQ()}function YQ(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function KQ(e,t){if(e){if("string"===typeof e)return XQ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?XQ(e,t):void 0}}function XQ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $Q(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function qQ(e){if(Array.isArray(e))return e}function QQ(e){return{key:"hidden_rows_hide",name:function(){var e=this.getSelectedLast(),t=0;if(Array.isArray(e)){var n=GQ(e,3),r=n[0],o=n[2];r-o!==0&&(t=1)}return this.getTranslatedPhrase(Mm,t)},callback:function(){for(var t=this.getSelectedRangeLast(),n=t.from,r=t.to,o=Math.max(Math.min(n.row,r.row),0),i=Math.max(n.row,r.row),a=[],l=o;l<=i;l+=1)a.push(l);e.hideRows(a);var s=a[a.length-1],u=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(u)&&u>=0?this.selectRows(u):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function JQ(e){return nJ(e)||tJ(e)||eJ(e)||ZQ()}function ZQ(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function eJ(e,t){if(e){if("string"===typeof e)return rJ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rJ(e,t):void 0}}function tJ(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function nJ(e){if(Array.isArray(e))return rJ(e)}function rJ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oJ(e){var t=[];return{key:"hidden_rows_show",name:function(){var e=t.length>1?1:0;return this.getTranslatedPhrase(Am,e)},callback:function(){var n,r;if(0!==t.length){var o=t[0],i=t[t.length-1];o=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,i=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(i+1,1))&&void 0!==r?r:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var a=i-o+1===this.countRows();a||this.selectRows(o,i)}},disabled:!1,hidden:function(){var n=this,r=W(e.getHiddenRows(),(function(e){return n.toPhysicalRow(e)}));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),i=o.getTopStartCorner().row,a=o.getBottomEndCorner().row,l=this.rowIndexMapper,s=l.getRenderableFromVisualIndex(i),u=l.getRenderableFromVisualIndex(a),c=l.getNotTrimmedIndexes(),f=[];if(i!==a){var h=a-i+1,d=u-s+1;if(h>d){var p=c.slice(i,a+1);f.push.apply(f,JQ(p.filter((function(e){return r.includes(e)}))))}}else if(0===s&&s<i)f.push.apply(f,JQ(c.slice(0,i)));else if(null===s)f.push.apply(f,JQ(c.slice(0,this.countRows())));else{var y=this.countRows()-1,v=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1));u===v&&y>a&&f.push.apply(f,JQ(c.slice(a+1)))}return U(f,(function(e){t.push(n.toVisualRow(e))})),0===t.length}}}function iJ(e){return iJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iJ(e)}function aJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sJ(e,t,n){return t&&lJ(e.prototype,t),n&&lJ(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function uJ(){return uJ="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=cJ(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},uJ.apply(this,arguments)}function cJ(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=gJ(e),null===e)break;return e}function fJ(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hJ(e,t)}function hJ(e,t){return hJ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hJ(e,t)}function dJ(e){var t=vJ();return function(){var n,r=gJ(e);if(t){var o=gJ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pJ(this,n)}}function pJ(e,t){if(t&&("object"===iJ(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return yJ(e)}function yJ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vJ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function gJ(e){return gJ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gJ(e)}function mJ(e,t,n){bJ(e,t),t.set(e,n)}function bJ(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wJ(e,t){var n=OJ(e,t,"get");return CJ(e,n)}function CJ(e,t){return t.get?t.get.call(e):t.value}function SJ(e,t,n){var r=OJ(e,t,"set");return kJ(e,r,n),n}function OJ(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function kJ(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}hr.getSingleton().register("beforeHideRows"),hr.getSingleton().register("afterHideRows"),hr.getSingleton().register("beforeUnhideRows"),hr.getSingleton().register("afterUnhideRows");var RJ="hiddenRows",EJ=320,TJ=new WeakMap,PJ=new WeakMap,MJ=function(e){fJ(n,e);var t=dJ(n);function n(){var e;aJ(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),mJ(yJ(e),TJ,{writable:!0,value:{}}),mJ(yJ(e),PJ,{writable:!0,value:null}),e}return sJ(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[RJ]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings()[RJ];ce(t)&&(SJ(this,TJ,t),Je(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),SJ(this,PJ,new By),wJ(this,PJ).addLocalHook("init",(function(){return e.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,wJ(this,PJ)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(t,n,r){return e.onAfterGetCellMeta(t,n,r)})),this.addHook("modifyRowHeight",(function(t,n){return e.onModifyRowHeight(t,n)})),this.addHook("afterGetRowHeader",(function(){return e.onAfterGetRowHeader.apply(e,arguments)})),this.addHook("modifyCopyableRange",(function(t){return e.onModifyCopyableRange(t)})),uJ(gJ(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),uJ(gJ(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),SJ(this,TJ,{}),uJ(gJ(n.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(e){var t=this,n=this.getHiddenRows(),r=this.isValidConfig(e),o=n,i=wJ(this,PJ).getValues().slice(),a=e.length>0;if(r&&a){var l=e.map((function(e){return t.hot.toPhysicalRow(e)}));U(l,(function(e){i[e]=!1})),o=V(i,(function(e,n,r){return n&&e.push(t.hot.toVisualRow(r)),e}),[])}var s=this.hot.runHooks("beforeUnhideRows",n,o,r&&a);!1!==s&&(r&&a&&wJ(this,PJ).setValues(i),this.hot.runHooks("afterUnhideRows",n,o,r&&a,r&&o.length<n.length))}},{key:"showRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}},{key:"hideRows",value:function(e){var t=this,n=this.getHiddenRows(),r=this.isValidConfig(e),o=n;r&&(o=Array.from(new Set(n.concat(e))));var i=this.hot.runHooks("beforeHideRows",n,o,r);!1!==i&&(r&&this.hot.batchExecution((function(){U(e,(function(e){wJ(t,PJ).setValueAtIndex(t.hot.toPhysicalRow(e),!0)}))}),!0),this.hot.runHooks("afterHideRows",n,o,r,r&&o.length>n.length))}},{key:"hideRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}},{key:"getHiddenRows",value:function(){var e=this;return W(wJ(this,PJ).getHiddenIndexes(),(function(t){return e.hot.toVisualRow(t)}))}},{key:"isHidden",value:function(e){return wJ(this,PJ).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}},{key:"isValidConfig",value:function(e){var t=this.hot.countRows();return!!(Array.isArray(e)&&e.length>0)&&e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"resetCellsMeta",value:function(){U(this.hot.getCellsMeta(),(function(e){e&&(e.skipRowOnPaste=!1)}))}},{key:"onModifyRowHeight",value:function(e,t){return this.isHidden(t)?0:e}},{key:"onAfterGetCellMeta",value:function(e,t,n){if(!1===wJ(this,TJ).copyPasteEnabled&&this.isHidden(e)&&(n.skipRowOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenRow");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(e){var t=this;if(wJ(this,TJ).copyPasteEnabled)return e;var n=[],r=function(e,t,r,o){n.push({startRow:e,endRow:t,startCol:r,endCol:o})};return U(e,(function(e){var n=!0,o=0;Co(e.startRow,e.endRow,(function(i){t.isHidden(i)?(n||r(o,i-1,e.startCol,e.endCol),n=!0):(n&&(o=i),i===e.endRow&&r(o,i,e.startCol,e.endCol),n=!1)}))})),n}},{key:"onAfterGetRowHeader",value:function(e,t){if(wJ(this,TJ).indicators&&!(e<0)){var n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&n.push("beforeHiddenRow"),Ut(t,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){e.items.push({name:FD},QQ(this),oJ(this))}},{key:"onMapInit",value:function(){Array.isArray(wJ(this,TJ).rows)&&this.hideRows(wJ(this,TJ).rows)}},{key:"destroy",value:function(){SJ(this,TJ,null),SJ(this,PJ,null),uJ(gJ(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return RJ}},{key:"PLUGIN_PRIORITY",get:function(){return EJ}}]),n}($A);function AJ(e,t){return HJ(e)||_J(e,t)||jJ(e,t)||IJ()}function IJ(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jJ(e,t){if(e){if("string"===typeof e)return xJ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xJ(e,t):void 0}}function xJ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _J(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function HJ(e){if(Array.isArray(e))return e}function DJ(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(rm)},callback:function(t,n){var r=AJ(n,1),o=r[0].start.col;e.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function NJ(e,t){return WJ(e)||FJ(e,t)||BJ(e,t)||LJ()}function LJ(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function BJ(e,t){if(e){if("string"===typeof e)return VJ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?VJ(e,t):void 0}}function VJ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function FJ(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function WJ(e){if(Array.isArray(e))return e}function UJ(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(om)},callback:function(t,n){var r=NJ(n,1),o=r[0].start.col;e.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}function zJ(e){return zJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zJ(e)}function GJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YJ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function KJ(e,t,n){return t&&YJ(e.prototype,t),n&&YJ(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function XJ(){return XJ="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=$J(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},XJ.apply(this,arguments)}function $J(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=nZ(e),null===e)break;return e}function qJ(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QJ(e,t)}function QJ(e,t){return QJ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},QJ(e,t)}function JJ(e){var t=tZ();return function(){var n,r=nZ(e);if(t){var o=nZ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ZJ(this,n)}}function ZJ(e,t){if(t&&("object"===zJ(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return eZ(e)}function eZ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tZ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function nZ(e){return nZ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nZ(e)}hr.getSingleton().register("beforeColumnFreeze"),hr.getSingleton().register("afterColumnFreeze"),hr.getSingleton().register("beforeColumnUnfreeze"),hr.getSingleton().register("afterColumnUnfreeze");var rZ="manualColumnFreeze",oZ=110,iZ=new WeakMap,aZ=function(e){qJ(n,e);var t=JJ(n);function n(e){var r;return GJ(this,n),r=t.call(this,e),iZ.set(eZ(r),{afterFirstUse:!1}),r}return KJ(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[rZ]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(t){return e.addContextMenuEntry(t)})),this.addHook("beforeColumnMove",(function(t,n){return e.onBeforeColumnMove(t,n)})),XJ(nZ(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=iZ.get(this);e.afterFirstUse=!1,XJ(nZ(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),XJ(nZ(n.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(e){var t=iZ.get(this),n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0);var o=this.hot.runHooks("beforeColumnFreeze",e,r);!1!==o&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}},{key:"unfreezeColumn",value:function(e){var t=iZ.get(this),n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0);var o=this.hot.runHooks("beforeColumnUnfreeze",e,r);!1!==o&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}},{key:"addContextMenuEntry",value:function(e){e.items.push({name:"---------"},DJ(this),UJ(this))}},{key:"onBeforeColumnMove",value:function(e,t){var n=iZ.get(this);if(n.afterFirstUse){var r=this.hot.getSettings().fixedColumnsStart;if(t<r)return!1;if(e.some((function(e){return e<r})))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return rZ}},{key:"PLUGIN_PRIORITY",get:function(){return oZ}}]),n}($A);function lZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uZ(e,t,n){return t&&sZ(e.prototype,t),n&&sZ(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var cZ=0,fZ=1,hZ=2,dZ="px",pZ=function(){function e(t){lZ(this,e),this.hot=t,this._element=null,this.state=cZ,this.inlineProperty=t.isRtl()?"right":"left"}return uZ(e,[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=hZ}},{key:"build",value:function(){this.state===cZ&&(this._element=this.hot.rootDocument.createElement("div"),this.state=fZ)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=cZ}},{key:"isAppended",value:function(){return this.state===hZ}},{key:"isBuilt",value:function(){return this.state>=fZ}},{key:"setPosition",value:function(e,t){bo(e)&&(this._element.style.top=e+dZ),bo(t)&&(this._element.style[this.inlineProperty]=t+dZ)}},{key:"getPosition",value:function(){var e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}},{key:"setSize",value:function(e,t){bo(e)&&(this._element.style.width=e+dZ),bo(t)&&(this._element.style.height=t+dZ)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,t){bo(e)&&(this._element.style.marginTop=e+dZ),bo(t)&&(this._element.style["margin".concat(gt(this.inlineProperty))]=t+dZ)}},{key:"getOffset",value:function(){var e=this._element.style,t="margin".concat(gt(this.inlineProperty));return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}}]),e}(),yZ=pZ;function vZ(e){return vZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vZ(e)}function gZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bZ(e,t,n){return t&&mZ(e.prototype,t),n&&mZ(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function wZ(){return wZ="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=CZ(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},wZ.apply(this,arguments)}function CZ(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=PZ(e),null===e)break;return e}function SZ(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OZ(e,t)}function OZ(e,t){return OZ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},OZ(e,t)}function kZ(e){var t=TZ();return function(){var n,r=PZ(e);if(t){var o=PZ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return RZ(this,n)}}function RZ(e,t){if(t&&("object"===vZ(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return EZ(e)}function EZ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TZ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function PZ(e){return PZ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},PZ(e)}var MZ="ht__manualColumnMove--backlight",AZ=function(e){SZ(n,e);var t=kZ(n);function n(){return gZ(this,n),t.apply(this,arguments)}return bZ(n,[{key:"build",value:function(){wZ(PZ(n.prototype),"build",this).call(this),Ut(this._element,MZ)}}]),n}(yZ),IZ=AZ;function jZ(e){return jZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jZ(e)}function xZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HZ(e,t,n){return t&&_Z(e.prototype,t),n&&_Z(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function DZ(){return DZ="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=NZ(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},DZ.apply(this,arguments)}function NZ(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=zZ(e),null===e)break;return e}function LZ(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BZ(e,t)}function BZ(e,t){return BZ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},BZ(e,t)}function VZ(e){var t=UZ();return function(){var n,r=zZ(e);if(t){var o=zZ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return FZ(this,n)}}function FZ(e,t){if(t&&("object"===jZ(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return WZ(e)}function WZ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UZ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function zZ(e){return zZ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zZ(e)}var GZ="ht__manualColumnMove--guideline",YZ=function(e){LZ(n,e);var t=VZ(n);function n(){return xZ(this,n),t.apply(this,arguments)}return HZ(n,[{key:"build",value:function(){DZ(zZ(n.prototype),"build",this).call(this),Ut(this._element,GZ)}}]),n}(yZ),KZ=YZ;function XZ(e){return XZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},XZ(e)}function $Z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qZ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function QZ(e,t,n){return t&&qZ(e.prototype,t),n&&qZ(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function JZ(){return JZ="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=ZZ(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},JZ.apply(this,arguments)}function ZZ(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=a0(e),null===e)break;return e}function e0(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&t0(e,t)}function t0(e,t){return t0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},t0(e,t)}function n0(e){var t=i0();return function(){var n,r=a0(e);if(t){var o=a0(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return r0(this,n)}}function r0(e,t){if(t&&("object"===XZ(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o0(e)}function o0(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i0(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function a0(e){return a0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},a0(e)}hr.getSingleton().register("beforeColumnMove"),hr.getSingleton().register("afterColumnMove");var l0="manualColumnMove",s0=120,u0=new WeakMap,c0="ht__manualColumnMove",f0="show-ui",h0="on-moving--columns",d0="after-selection--columns",p0=function(e){e0(n,e);var t=n0(n);function n(e){var r;return $Z(this,n),r=t.call(this,e),u0.set(o0(r),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),r.eventManager=new Nr(o0(r)),r.backlight=new IZ(e),r.guideline=new KZ(e),r}return QZ(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[l0]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver.apply(e,arguments)})),this.addHook("afterScrollVertically",(function(){return e.onAfterScrollVertically()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.buildPluginUI(),this.registerEvents(),Ut(this.hot.rootElement,c0),JZ(a0(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),JZ(a0(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){zt(this.hot.rootElement,c0),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),JZ(a0(n.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(e,t){return this.moveColumns([e],t)}},{key:"moveColumns",value:function(e,t){var n=u0.get(this),r=n.cachedDropIndex,o=this.isMovePossible(e,t),i=this.hot.runHooks("beforeColumnMove",e,t,r,o);if(n.cachedDropIndex=void 0,!1!==i){o&&this.hot.columnIndexMapper.moveIndexes(e,t);var a=o&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,r,o,a),a}}},{key:"dragColumn",value:function(e,t){return this.dragColumns([e],t)}},{key:"dragColumns",value:function(e,t){var n=this.countFinalIndex(e,t),r=u0.get(this);return r.cachedDropIndex=t,this.moveColumns(e,n)}},{key:"isMovePossible",value:function(e,t){var n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,o=t<0,i=e.some((function(e){return e<0})),a=e.some((function(e){return e>=n}));return!(r||o||i||a)}},{key:"isColumnOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}},{key:"countFinalIndex",value:function(e,t){var n=V(e,(function(e,n){return n<t&&(e+=1),e}),0);return t-n}},{key:"getColumnsWidth",value:function(e,t){for(var n=this.hot.columnIndexMapper,r=0,o=e;o<=t;o+=1){var i=n.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==i&&(r+=this.hot.view._wt.wtTable.getStretchedColumnWidth(i)||0)}return r}},{key:"moveBySettingsOrLoad",value:function(){var e=this.hot.getSettings()[l0];if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}},{key:"isFixedColumnsStart",value:function(e){return e<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}},{key:"prepareColumnsToMoving",value:function(e,t){var n=[];return Co(e,t,(function(e){n.push(e)})),n}},{key:"refreshPositions",value:function(){var e=u0.get(this),t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(e.hoveredColumn)&&t>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1));var n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,o="number"===typeof r.scrollX?r.scrollX:r.scrollLeft,i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.hoveredColumn-1),a=n.hider.offsetWidth,l=n.TBODY.offsetLeft,s=this.backlight.getOffset().start,u=this.backlight.getSize().width,c=0,f=0;if(this.hot.isRtl()){var h=this.hot.rootWindow,d=un(this.hot.rootElement),p=h.innerWidth-e.rootElementOffset-d;f=h.innerWidth-e.target.eventPageX-p-(void 0===r.scrollX?o:0)}else f=e.target.eventPageX-(e.rootElementOffset-(void 0===r.scrollX?o:0));if(e.hasRowHeaders&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(e.hoveredColumn)&&(i+=o),i+=c,e.hoveredColumn<0)e.fixedColumnsStart>0?e.target.col=0:e.target.col=t>0?t-1:t;else if(e.target.TD.offsetWidth/2+i<=f){var y=e.hoveredColumn>=e.countCols?e.countCols-1:e.hoveredColumn;e.target.col=y+1,i+=e.target.TD.offsetWidth}else e.target.col=e.hoveredColumn;var v=f,g=i;f+u+s>=a?v=a-u-s:f+s<l+c&&(v=l+c+Math.abs(s)),i>=a-1?g=a-1:0===g?g=1:void 0!==r.scrollX&&e.hoveredColumn<e.fixedColumnsStart&&(g-=e.rootElementOffset<=r.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,v),this.guideline.setPosition(null,g)}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){var o=this.hot.view._wt.wtTable,i=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),l=u0.get(this),s=Wt(e.target,"sortAction");if(!a||!i||l.pressed||0!==e.button||s)return l.pressed=!1,l.columnsToMove.length=0,void zt(this.hot.rootElement,[h0,f0]);var u=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&c&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));var f=a.from,h=a.to,d=Math.min(f.col,h.col),p=Math.max(f.col,h.col);if(t.row<0&&t.col>=d&&t.col<=p){r.column=!0,l.pressed=!0,l.target.eventPageX=e.pageX,l.target.eventOffsetX=e.offsetX,l.hoveredColumn=t.col,l.target.TD=n,l.target.col=t.col,l.columnsToMove=this.prepareColumnsToMoving(d,p),l.hasRowHeaders=!!this.hot.getSettings().rowHeaders,l.countCols=this.hot.countCols(),l.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,l.rootElementOffset=Jt(this.hot.rootElement).left;var y=l.hasRowHeaders?-1:0,v=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,g=t.col<l.fixedColumnsStart,m=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),b=Math.abs(e.offsetX-(this.hot.isRtl()?e.target.offsetWidth:0)),w=this.getColumnsWidth(d,t.col-1)+b,C=this.getColumnsWidth(y,d-1)+(g?m:0)+w;this.backlight.setPosition(v,C),this.backlight.setSize(this.getColumnsWidth(d,p),o.hider.offsetHeight-v),this.backlight.setOffset(null,-w),Ut(this.hot.rootElement,h0)}else zt(this.hot.rootElement,d0),l.pressed=!1,l.columnsToMove.length=0}},{key:"onMouseMove",value:function(e){var t=u0.get(this);if(t.pressed){if(e.target===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout((function(){this.backlight.setPosition(n)}))}t.target.eventPageX=e.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){var o=this.hot.getSelectedRangeLast(),i=u0.get(this);o&&i.pressed&&(i.columnsToMove.indexOf(t.col)>-1?zt(this.hot.rootElement,f0):Ut(this.hot.rootElement,f0),r.row=!0,r.column=!0,r.cell=!0,i.hoveredColumn=t.col,i.target.TD=n)}},{key:"onMouseUp",value:function(){var e=u0.get(this),t=e.target.col,n=e.columnsToMove.length;if(e.hoveredColumn=void 0,e.pressed=!1,e.backlightWidth=0,zt(this.hot.rootElement,[h0,f0,d0]),this.hot.selection.isSelectedByColumnHeader()&&Ut(this.hot.rootElement,d0),!(n<1||void 0===t)){var r=e.columnsToMove[0],o=this.hot.toPhysicalColumn(r),i=this.dragColumns(e.columnsToMove,t);if(e.columnsToMove.length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var a=this.hot.toVisualColumn(o),l=a+n-1;this.hot.selectColumns(a,l)}}}},{key:"onAfterScrollVertically",value:function(){var e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1,n=e.holder.scrollTop,r=t+n;this.backlight.setPosition(r),this.backlight.setSize(null,e.hider.offsetHeight-r)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),JZ(a0(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return l0}},{key:"PLUGIN_PRIORITY",get:function(){return s0}}]),n}($A);function y0(e){return y0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y0(e)}function v0(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g0(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m0(e,t,n){return t&&g0(e.prototype,t),n&&g0(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function b0(){return b0="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=w0(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},b0.apply(this,arguments)}function w0(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=T0(e),null===e)break;return e}function C0(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S0(e,t)}function S0(e,t){return S0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},S0(e,t)}function O0(e){var t=E0();return function(){var n,r=T0(e);if(t){var o=T0(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k0(this,n)}}function k0(e,t){if(t&&("object"===y0(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return R0(e)}function R0(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E0(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function T0(e){return T0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},T0(e)}var P0="manualColumnResize",M0=130,A0="manualColumnWidths",I0=new WeakMap,j0=function(e){C0(n,e);var t=O0(n);function n(e){var r;v0(this,n),r=t.call(this,e);var o=r.hot.rootDocument;return r.currentTH=null,r.currentCol=null,r.selectedCols=[],r.currentWidth=null,r.newSize=null,r.startY=null,r.startWidth=null,r.startOffset=null,r.handle=o.createElement("DIV"),r.guide=o.createElement("DIV"),r.eventManager=new Nr(R0(r)),r.pressed=null,r.dblclick=0,r.autoresizeTimeout=null,r.columnWidthsMap=void 0,I0.set(R0(r),{config:void 0}),Ut(r.handle,"manualColumnResizer"),Ut(r.guide,"manualColumnResizerGuide"),r}return m0(n,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[P0]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.columnWidthsMap=new Ty,this.columnWidthsMap.addLocalHook("init",(function(){return e.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(function(t,n){return e.onModifyColWidth(t,n)})),this.addHook("beforeStretchingColumnWidth",(function(t,n){return e.onBeforeStretchingColumnWidth(t,n)})),this.addHook("beforeColumnResize",(function(t,n,r){return e.onBeforeColumnResize(t,n,r)})),this.bindEvents(),b0(T0(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),b0(T0(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var e=I0.get(this);e.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),b0(T0(n.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",A0,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var e={};return this.hot.runHooks("persistentStateLoad",A0,e),e.value}},{key:"setManualSize",value:function(e,t){var n=Math.max(t,20),r=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(r,n),n}},{key:"clearManualSize",value:function(e){var t=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(t,null)}},{key:"onMapInit",value:function(){var e=this,t=I0.get(this),n=this.hot.getSettings()[P0],r=this.loadManualColumnWidths();"undefined"!==typeof r?this.hot.batchExecution((function(){r.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0):Array.isArray(n)?(this.hot.batchExecution((function(){n.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0),t.config=n):!0===n&&Array.isArray(t.config)&&this.hot.batchExecution((function(){t.config.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0)}},{key:"setupHandlePosition",value:function(e){var t=this;if(e.parentNode){this.currentTH=e;var n=this.hot.view._wt,r=n.wtTable.getCoords(this.currentTH),o=r.col;if(!(o<0)){var i,a=cn(this.currentTH),l=this.currentTH.getBoundingClientRect(),s=o<n.getSetting("fixedColumnsStart");s&&(i=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),i||(i=n.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.selectedCols=[];var u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){var c=this.hot.getSelectedRange();U(c,(function(e){var n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col;Co(n,r,(function(e){t.selectedCols.includes(e)||t.selectedCols.push(e)}))}))}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=i.start-6,this.startWidth=parseInt(l.width,10),this.handle.style.top="".concat(i.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(a,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var e=parseInt(cn(this.handle),10),t=parseInt(this.handle.style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Ut(this.handle,"active"),Ut(this.guide,"active"),this.guide.style.top="".concat(t,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(n-e,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){zt(this.handle,"active"),zt(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(e){return!!_t(e,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}},{key:"onMouseOver",value:function(e){if(!An(e.target)&&this.checkIfColumnHeader(e.target)){var t=this.getClosestTHParent(e.target);if(!t)return;var n=t.getAttribute("colspan");!t||null!==n&&"1"!==n||this.pressed||this.setupHandlePosition(t)}}},{key:"afterMouseDownTimeout",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){var o=e.hot.runHooks("beforeColumnResize",e.newSize,n,!0);void 0!==o&&(e.newSize=o),"all"===e.hot.getSettings().stretchH?e.clearManualSize(n):e.setManualSize(n,e.newSize),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",e.newSize,n,!0),r&&t()};if(this.dblclick>=2){var r=this.selectedCols.length;r>1?(U(this.selectedCols,(function(e){n(e)})),t()):U(this.selectedCols,(function(e){n(e,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(e){var t=this;Wt(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return t.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(e){var t=this;if(this.pressed){var n=(e.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+n,U(this.selectedCols,(function(e){t.newSize=t.setManualSize(e,t.currentWidth)})),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){e.hot.runHooks("beforeColumnResize",e.newSize,n,!1),r&&t(),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",e.newSize,n,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var r=this.selectedCols.length;r>1?(U(this.selectedCols,(function(e){n(e)})),t()):U(this.selectedCols,(function(e){n(e,!0)}))}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var e=this,t=this.hot,n=t.rootWindow,r=t.rootElement;this.eventManager.addEventListener(r,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(r,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(n,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(n,"mouseup",(function(){return e.onMouseUp()}))}},{key:"onModifyColWidth",value:function(e,t){var n=e;if(this.enabled){var r=this.hot.toPhysicalColumn(t),o=this.columnWidthsMap.getValueAtIndex(r);this.hot.getSettings()[P0]&&o&&(n=o)}return n}},{key:"onBeforeStretchingColumnWidth",value:function(e,t){var n=this.columnWidthsMap.getValueAtIndex(t);return null===n&&(n=e),n}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){b0(T0(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return P0}},{key:"PLUGIN_PRIORITY",get:function(){return M0}}]),n}($A);function x0(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _0(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H0(e,t,n){return t&&_0(e.prototype,t),n&&_0(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var D0=0,N0=1,L0=2,B0="px",V0=function(){function e(t){x0(this,e),this.hot=t,this._element=null,this.state=D0}return H0(e,[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=L0}},{key:"build",value:function(){this.state===D0&&(this._element=this.hot.rootDocument.createElement("div"),this.state=N0)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=D0}},{key:"isAppended",value:function(){return this.state===L0}},{key:"isBuilt",value:function(){return this.state>=N0}},{key:"setPosition",value:function(e,t){void 0!==e&&(this._element.style.top=e+B0),void 0!==t&&(this._element.style.left=t+B0)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(e,t){e&&(this._element.style.width=e+B0),t&&(this._element.style.height=t+B0)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,t){e&&(this._element.style.marginTop=e+B0),t&&(this._element.style.marginLeft=t+B0)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}(),F0=V0;function W0(e){return W0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W0(e)}function U0(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z0(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function G0(e,t,n){return t&&z0(e.prototype,t),n&&z0(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y0(){return Y0="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=K0(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Y0.apply(this,arguments)}function K0(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=e1(e),null===e)break;return e}function X0(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$0(e,t)}function $0(e,t){return $0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$0(e,t)}function q0(e){var t=Z0();return function(){var n,r=e1(e);if(t){var o=e1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Q0(this,n)}}function Q0(e,t){if(t&&("object"===W0(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return J0(e)}function J0(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z0(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function e1(e){return e1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e1(e)}var t1="ht__manualRowMove--backlight",n1=function(e){X0(n,e);var t=q0(n);function n(){return U0(this,n),t.apply(this,arguments)}return G0(n,[{key:"build",value:function(){Y0(e1(n.prototype),"build",this).call(this),Ut(this._element,t1)}}]),n}(F0),r1=n1;function o1(e){return o1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o1(e)}function i1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a1(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l1(e,t,n){return t&&a1(e.prototype,t),n&&a1(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s1(){return s1="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=u1(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s1.apply(this,arguments)}function u1(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=v1(e),null===e)break;return e}function c1(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f1(e,t)}function f1(e,t){return f1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f1(e,t)}function h1(e){var t=y1();return function(){var n,r=v1(e);if(t){var o=v1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d1(this,n)}}function d1(e,t){if(t&&("object"===o1(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return p1(e)}function p1(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y1(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function v1(e){return v1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v1(e)}var g1="ht__manualRowMove--guideline",m1=function(e){c1(n,e);var t=h1(n);function n(){return i1(this,n),t.apply(this,arguments)}return l1(n,[{key:"build",value:function(){s1(v1(n.prototype),"build",this).call(this),Ut(this._element,g1)}}]),n}(F0),b1=m1;function w1(e){return w1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w1(e)}function C1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S1(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O1(e,t,n){return t&&S1(e.prototype,t),n&&S1(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function k1(){return k1="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=R1(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},k1.apply(this,arguments)}function R1(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=j1(e),null===e)break;return e}function E1(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T1(e,t)}function T1(e,t){return T1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T1(e,t)}function P1(e){var t=I1();return function(){var n,r=j1(e);if(t){var o=j1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return M1(this,n)}}function M1(e,t){if(t&&("object"===w1(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return A1(e)}function A1(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I1(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function j1(e){return j1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},j1(e)}hr.getSingleton().register("beforeRowMove"),hr.getSingleton().register("afterRowMove");var x1="manualRowMove",_1=140,H1=new WeakMap,D1="ht__manualRowMove",N1="show-ui",L1="on-moving--rows",B1="after-selection--rows",V1=function(e){E1(n,e);var t=P1(n);function n(e){var r;return C1(this,n),r=t.call(this,e),H1.set(A1(r),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),r.eventManager=new Nr(A1(r)),r.backlight=new r1(e),r.guideline=new b1(e),r}return O1(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[x1]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver.apply(e,arguments)})),this.addHook("afterScrollHorizontally",(function(){return e.onAfterScrollHorizontally()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.buildPluginUI(),this.registerEvents(),Ut(this.hot.rootElement,D1),k1(j1(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),k1(j1(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){zt(this.hot.rootElement,D1),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),k1(j1(n.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(e,t){return this.moveRows([e],t)}},{key:"moveRows",value:function(e,t){var n=H1.get(this),r=n.cachedDropIndex,o=this.isMovePossible(e,t),i=this.hot.runHooks("beforeRowMove",e,t,r,o);if(n.cachedDropIndex=void 0,!1!==i){o&&this.hot.rowIndexMapper.moveIndexes(e,t);var a=o&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,r,o,a),a}}},{key:"dragRow",value:function(e,t){return this.dragRows([e],t)}},{key:"dragRows",value:function(e,t){var n=this.countFinalIndex(e,t),r=H1.get(this);return r.cachedDropIndex=t,this.moveRows(e,n)}},{key:"isMovePossible",value:function(e,t){var n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,o=t<0,i=e.some((function(e){return e<0})),a=e.some((function(e){return e>=n}));return!(r||o||i||a)}},{key:"isRowOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}},{key:"countFinalIndex",value:function(e,t){var n=V(e,(function(e,n){return n<t&&(e+=1),e}),0);return t-n}},{key:"getRowsHeight",value:function(e,t){for(var n=this.hot.rowIndexMapper,r=0,o=e;o<=t;o++){var i=n.getRenderableFromVisualIndex(o);null!==i&&(r+=this.hot.view._wt.wtTable.getRowHeight(i)||23)}return r}},{key:"moveBySettingsOrLoad",value:function(){var e=this.hot.getSettings()[x1];if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}},{key:"isFixedRowTop",value:function(e){return e<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}},{key:"prepareRowsToMoving",value:function(){var e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;var n=e.from,r=e.to,o=Math.min(n.row,r.row),i=Math.max(n.row,r.row);return Co(o,i,(function(e){t.push(e)})),t}},{key:"refreshPositions",value:function(){var e=H1.get(this),t=e.target.coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),o=this.hot.countRows();this.isFixedRowTop(t.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(t.row)&&r<o&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);var i=this.hot.view._wt.wtTable,a=e.target.TD,l=Jt(this.hot.rootElement),s=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1),u=e.target.eventPageY-l.top+i.holder.scrollTop,c=i.hider.offsetHeight,f=i.TBODY.offsetTop,h=this.backlight.getOffset().top,d=this.backlight.getSize().height;this.isFixedRowTop(t.row)&&(s+=i.holder.scrollTop),t.row<0?e.target.row=n>0?n-1:n:a.offsetHeight/2+s<=u?(e.target.row=t.row+1,s+=0===t.row?a.offsetHeight-1:a.offsetHeight):e.target.row=t.row;var p=u,y=s;u+d+h>=c?p=c-d-h:u+h<f&&(p=f+Math.abs(h)),s>=c-1&&(y=c-1),this.backlight.setPosition(p),this.guideline.setPosition(y)}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){var o=this.hot.view._wt,i=o.wtTable,a=o.wtViewport,l=this.hot.selection.isSelectedByRowHeader(),s=this.hot.getSelectedRangeLast(),u=H1.get(this);if(!s||!l||u.pressed||0!==e.button)return u.pressed=!1,u.rowsToMove.length=0,void zt(this.hot.rootElement,[L1,N1]);var c=this.guideline.isBuilt()&&!this.guideline.isAppended(),f=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&f&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));var h=s.from,d=s.to,p=Math.min(h.row,d.row),y=Math.max(h.row,d.row);if(t.col<0&&t.row>=p&&t.row<=y){r.row=!0,u.pressed=!0,u.target.eventPageY=e.pageY,u.target.coords=t,u.target.TD=n,u.rowsToMove=this.prepareRowsToMoving();var v=i.holder.scrollLeft+a.getRowHeaderWidth();this.backlight.setPosition(null,v),this.backlight.setSize(i.hider.offsetWidth-v,this.getRowsHeight(p,y)),this.backlight.setOffset(-1*(this.getRowsHeight(p,t.row-1)+e.offsetY),null),Ut(this.hot.rootElement,L1),this.refreshPositions()}else zt(this.hot.rootElement,B1),u.pressed=!1,u.rowsToMove.length=0}},{key:"onMouseMove",value:function(e){var t=H1.get(this);if(t.pressed){if(e.target===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout((function(){this.backlight.setPosition(null,n)}))}t.target.eventPageY=e.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){var o=this.hot.getSelectedRangeLast(),i=H1.get(this);o&&i.pressed&&(i.rowsToMove.indexOf(t.row)>-1?zt(this.hot.rootElement,N1):Ut(this.hot.rootElement,N1),r.row=!0,r.column=!0,r.cell=!0,i.target.coords=t,i.target.TD=n)}},{key:"onMouseUp",value:function(){var e=H1.get(this),t=e.target.row,n=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,zt(this.hot.rootElement,[L1,N1,B1]),this.hot.selection.isSelectedByRowHeader()&&Ut(this.hot.rootElement,B1),!(n<1||void 0===t)){var r=e.rowsToMove[0],o=this.hot.toPhysicalRow(r),i=this.dragRows(e.rowsToMove,t);if(e.rowsToMove.length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var a=this.hot.toVisualRow(o),l=a+n-1;this.hot.selectRows(a,l)}}}},{key:"onAfterScrollHorizontally",value:function(){var e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=e.holder.scrollLeft,r=t+n;this.backlight.setPosition(null,r),this.backlight.setSize(e.hider.offsetWidth-r)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),k1(j1(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return x1}},{key:"PLUGIN_PRIORITY",get:function(){return _1}}]),n}($A);function F1(e){return F1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F1(e)}function W1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U1(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z1(e,t,n){return t&&U1(e.prototype,t),n&&U1(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function G1(){return G1="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Y1(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},G1.apply(this,arguments)}function Y1(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Z1(e),null===e)break;return e}function K1(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X1(e,t)}function X1(e,t){return X1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},X1(e,t)}function $1(e){var t=J1();return function(){var n,r=Z1(e);if(t){var o=Z1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return q1(this,n)}}function q1(e,t){if(t&&("object"===F1(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Q1(e)}function Q1(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J1(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Z1(e){return Z1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Z1(e)}var e2,t2,n2,r2,o2="manualRowResize",i2=30,a2="manualRowHeights",l2=new WeakMap,s2=function(e){K1(n,e);var t=$1(n);function n(e){var r;W1(this,n),r=t.call(this,e);var o=r.hot.rootDocument;return r.currentTH=null,r.currentRow=null,r.selectedRows=[],r.currentHeight=null,r.newSize=null,r.startY=null,r.startHeight=null,r.startOffset=null,r.handle=o.createElement("DIV"),r.guide=o.createElement("DIV"),r.eventManager=new Nr(Q1(r)),r.pressed=null,r.dblclick=0,r.autoresizeTimeout=null,r.rowHeightsMap=void 0,l2.set(Q1(r),{config:void 0}),Ut(r.handle,"manualRowResizer"),Ut(r.guide,"manualRowResizerGuide"),r}return z1(n,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[o2]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.rowHeightsMap=new Ty,this.rowHeightsMap.addLocalHook("init",(function(){return e.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(function(t,n){return e.onModifyRowHeight(t,n)})),this.bindEvents(),G1(Z1(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),G1(Z1(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var e=l2.get(this);e.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),G1(Z1(n.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",a2,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var e={};return this.hot.runHooks("persistentStateLoad",a2,e),e.value}},{key:"setManualSize",value:function(e,t){var n=this.hot.toPhysicalRow(e),r=Math.max(t,rd.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(n,r),r}},{key:"setupHandlePosition",value:function(e){var t=this;this.currentTH=e;var n=this.hot.view,r=n._wt,o=r.wtTable.getCoords(this.currentTH),i=o.row;if(!(i<0)){var a,l=un(this.currentTH),s=this.currentTH.getBoundingClientRect(),u=i<r.getSetting("fixedRowsTop"),c=i>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");u?a=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col):c&&(a=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),a||(a=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.selectedRows=[];var f=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&f){var h=this.hot.getSelectedRange();U(h,(function(e){var n=e.getTopStartCorner().row,r=e.getBottomStartCorner().row;Co(n,r,(function(e){t.selectedRows.includes(e)||t.selectedRows.push(e)}))}))}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=a.top-6,this.startHeight=parseInt(s.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(a.start,"px"),this.handle.style.width="".concat(l,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var e=parseInt(un(this.handle),10),t=parseInt(this.handle.style[this.inlineDir],10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Ut(this.handle,"active"),Ut(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(t,"px"),this.guide.style.width="".concat(n-e,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){zt(this.handle,"active"),zt(this.guide,"active")}},{key:"checkIfRowHeader",value:function(e){var t,n,r=_t(e,["TH"],this.hot.rootElement);return r&&"TBODY"===(null===(t=e.parentNode)||void 0===t||null===(n=t.parentNode)||void 0===n?void 0:n.tagName)}},{key:"getClosestTHParent",value:function(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}},{key:"getActualRowHeight",value:function(e){var t=this.hot.view._wt.wtTable.getRowHeight(e);return void 0!==t&&this.newSize<t?t:this.newSize}},{key:"onMouseOver",value:function(e){if(!An(e.target)&&this.checkIfRowHeader(e.target)){var t=this.getClosestTHParent(e.target);t&&(this.pressed||this.setupHandlePosition(t))}}},{key:"afterMouseDownTimeout",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){var o=e.hot.runHooks("beforeRowResize",e.getActualRowHeight(n),n,!0);void 0!==o&&(e.newSize=o),e.setManualSize(n,e.newSize),e.hot.runHooks("afterRowResize",e.getActualRowHeight(n),n,!0),r&&t()};if(this.dblclick>=2){var r=this.selectedRows.length;r>1?(U(this.selectedRows,(function(e){n(e)})),t()):U(this.selectedRows,(function(e){n(e,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(e){var t=this;Wt(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return t.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(e){var t=this;this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),U(this.selectedRows,(function(e){t.newSize=t.setManualSize(e,t.currentHeight)})),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){e.hot.runHooks("beforeRowResize",e.getActualRowHeight(n),n,!1),r&&t(),e.saveManualRowHeights(),e.hot.runHooks("afterRowResize",e.getActualRowHeight(n),n,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var r=this.selectedRows.length;r>1?(U(this.selectedRows,(function(e){n(e)})),t()):U(this.selectedRows,(function(e){n(e,!0)}))}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var e=this,t=this.hot,n=t.rootElement,r=t.rootWindow;this.eventManager.addEventListener(n,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(n,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(r,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(r,"mouseup",(function(){return e.onMouseUp()}))}},{key:"onModifyRowHeight",value:function(e,t){var n=e;if(this.enabled){var r=this.hot.toPhysicalRow(t),o=this.rowHeightsMap.getValueAtIndex(r);this.hot.getSettings()[o2]&&o&&(n=o)}return n}},{key:"onMapInit",value:function(){var e=this,t=l2.get(this),n=this.hot.getSettings()[o2],r=this.loadManualRowHeights();this.hot.batchExecution((function(){"undefined"!==typeof r?r.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)})):Array.isArray(n)?(n.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)})),t.config=n):!0===n&&Array.isArray(t.config)&&t.config.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)}))}),!0)}},{key:"destroy",value:function(){G1(Z1(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return o2}},{key:"PLUGIN_PRIORITY",get:function(){return i2}}]),n}($A);function u2(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function c2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h2(e,t,n){return t&&f2(e.prototype,t),n&&f2(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var d2,p2=function(){function e(t,n,r,o,i,a){c2(this,e),this.row=t,this.col=n,this.rowspan=r,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return h2(e,[{key:"normalize",value:function(e){var t=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}},{key:"includesHorizontally",value:function(e){return this.col<=e&&this.col+this.colspan-1>=e}},{key:"includesVertically",value:function(e){return this.row<=e&&this.row+this.rowspan-1>=e}},{key:"shift",value:function(e,t){var n=e[0]||e[1],r=t+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",i=e[0]?"col":"row",a=Math.min(t,r),l=Math.max(t,r),s=this[i],u=this[i]+this[o]-1;if(s>=t&&(this[i]+=n),n>0)t<=u&&t>s&&(this[o]+=n);else if(n<0){if(a<=s&&l>=u)return this.removed=!0,!1;if(s>=a&&s<=l){var c=l-s+1,f=Math.abs(n)-c;this[i]-=f+n,this[o]-=c}else if(s<=a&&u>=l)this[o]+=n;else if(s<=a&&u>=a&&u<l){var h=u-a+1;this[o]-=h}}return!0}},{key:"isFarther",value:function(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(e){return Ke(e2||(e2=u2(["The merged cell declared with {row: ",", col: ",", \n      rowspan: ",", colspan: ","} contains negative values, which is \n      not supported. It will not be added to the collection."],["The merged cell declared with {row: ",", col: ",",\\x20\n      rowspan: ",", colspan: ","} contains negative values, which is\\x20\n      not supported. It will not be added to the collection."])),e.row,e.col,e.rowspan,e.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(e){return Ke(t2||(t2=u2(["The merged cell declared at [",", ","] is positioned \n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned\\x20\n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."])),e.row,e.col)}},{key:"IS_SINGLE_CELL",value:function(e){return Ke(n2||(n2=u2(["The merged cell declared at [",", ",'] has both "rowspan" \n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan"\\x20\n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'])),e.row,e.col)}},{key:"ZERO_SPAN_WARNING",value:function(e){return Ke(r2||(r2=u2(["The merged cell declared at [",", ",'] has "rowspan" \n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan"\\x20\n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'])),e.row,e.col)}},{key:"containsNegativeValues",value:function(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}},{key:"isSingleCell",value:function(e){return 1===e.colspan&&1===e.rowspan}},{key:"containsZeroSpan",value:function(e){return 0===e.colspan||0===e.rowspan}},{key:"isOutOfBounds",value:function(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}}]),e}(),y2=p2;function v2(e,t,n,r){t?t.row===n&&t.col===r?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function g2(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function m2(e){return S2(e)||C2(e)||w2(e)||b2()}function b2(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w2(e,t){if(e){if("string"===typeof e)return O2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O2(e,t):void 0}}function C2(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function S2(e){if(Array.isArray(e))return O2(e)}function O2(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E2(e,t,n){return t&&R2(e.prototype,t),n&&R2(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var T2=function(){function e(t){k2(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return E2(e,[{key:"get",value:function(e,t){var n=this.mergedCells,r=!1;return U(n,(function(n){return!(n.row<=e&&n.row+n.rowspan-1>=e&&n.col<=t&&n.col+n.colspan-1>=t)||(r=n,!1)})),r}},{key:"getByRange",value:function(e){var t=this.mergedCells,n=!1;return U(t,(function(t){return!(t.row<=e.from.row&&t.row+t.rowspan-1>=e.to.row&&t.col<=e.from.col&&t.col+t.colspan-1>=e.to.col)||(n=t,n)})),n}},{key:"getWithinRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCells,o=[],i=e;if(!i.includesRange){var a=this.hot._createCellCoords(i.from.row,i.from.col),l=this.hot._createCellCoords(i.to.row,i.to.col);i=this.hot._createCellRange(a,a,l)}return U(r,(function(e){var r=t.hot._createCellCoords(e.row,e.col),a=t.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1),l=t.hot._createCellRange(r,r,a);n?i.overlaps(l)&&o.push(e):i.includesRange(l)&&o.push(e)})),!!o.length&&o}},{key:"add",value:function(t){var n=this.mergedCells,r=t.row,o=t.col,i=t.rowspan,a=t.colspan,l=new y2(r,o,i,a,this.hot._createCellCoords,this.hot._createCellRange),s=this.get(r,o),u=this.isOverlapping(l);return s||u?(Fn(e.IS_OVERLAPPING_WARNING(l)),!1):(this.hot&&l.normalize(this.hot),n.push(l),l)}},{key:"remove",value:function(e,t){var n=this.mergedCells,r=this.get(e,t),o=r?this.mergedCells.indexOf(r):-1;return!(!r||-1===o)&&(n.splice(o,1),r)}},{key:"clear",value:function(){var e=this,t=this.mergedCells,n=[],r=[];U(t,(function(t){var r=e.hot.getCell(t.row,t.col);r&&n.push([r,e.get(t.row,t.col),t.row,t.col])})),this.mergedCells.length=0,U(n,(function(t,o){Co(0,t.rowspan-1,(function(n){Co(0,t.colspan-1,(function(o){if(0!==o||0!==n){var i=e.hot.getCell(t.row+n,t.col+o);i&&r.push([i,null,null,null])}}))})),n[o][1]=null})),U(n,(function(e){v2.apply(void 0,m2(e))})),U(r,(function(e){v2.apply(void 0,m2(e))}))}},{key:"isOverlapping",value:function(e){var t=this,n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1)),r=!1;return U(this.mergedCells,(function(e){var o=t.hot._createCellRange(t.hot._createCellCoords(0,0),t.hot._createCellCoords(e.row,e.col),t.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));return!o.overlaps(n)||(r=!0,!1)})),r}},{key:"isFirstRenderableMergedCell",value:function(e,t){var n=this.get(e,t);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===t}},{key:"getFirstRenderableCoords",value:function(e,t){var n=this.get(e,t);if(!n||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);var r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(r,o)}},{key:"shiftCollections",value:function(e,t,n){var r=this,o=[0,0];switch(e){case"right":o[0]+=n;break;case"left":o[0]-=n;break;case"down":o[1]+=n;break;case"up":o[1]-=n;break;default:}U(this.mergedCells,(function(e){e.shift(o,t)})),So(this.mergedCells.length-1,0,(function(e){var t=r.mergedCells[e];t&&t.removed&&r.mergedCells.splice(r.mergedCells.indexOf(t),1)}))}}],[{key:"IS_OVERLAPPING_WARNING",value:function(e){return Ke(d2||(d2=g2(["The merged cell declared at [",", ","], overlaps \n      with the other declared merged cell. The overlapping merged cell was not added to the table, please \n      fix your setup."],["The merged cell declared at [",", ","], overlaps\\x20\n      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20\n      fix your setup."])),e.row,e.col)}}]),e}(),P2=T2;function M2(e,t){return _2(e)||x2(e,t)||I2(e,t)||A2()}function A2(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function I2(e,t){if(e){if("string"===typeof e)return j2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j2(e,t):void 0}}function j2(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x2(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function _2(e){if(Array.isArray(e))return e}function H2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N2(e,t,n){return t&&D2(e.prototype,t),n&&D2(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var L2=function(){function e(t){H2(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return N2(e,[{key:"correctSelectionAreaSize",value:function(e){if(e[0]===e[2]&&e[1]===e[3]){var t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}},{key:"getDirection",value:function(e,t){var n=null;return n=t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left",n}},{key:"snapDragArea",value:function(e,t,n,r){var o=t.slice(0),i=this.getAutofillSize(e,t,n),a=M2(e,4),l=a[0],s=a[1],u=a[2],c=a[3],f=["up","down"].indexOf(n)>-1,h=f?u-l+1:c-s+1,d=Math.floor(i/h)*h,p=i-d,y=this.getFarthestCollection(e,t,n,r);if(y)if("down"===n){var v=y.row+y.rowspan-l-p,g=o[2]+v;g>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?v:0}else if("right"===n){var m=y.col+y.colspan-s-p,b=o[3]+m;b>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?m:0}else if("up"===n){var w=u-p-y.row+1,C=o[0]+w;C<0?o[0]+=p:o[0]-=p?w:0}else if("left"===n){var S=c-p-y.col+1,O=o[1]+S;O<0?o[1]+=p:o[1]-=p?S:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:r,fillSize:i,dragArea:o,cycleLength:h}),o}},{key:"updateCurrentFillCache",value:function(e){this.currentFillData||(this.currentFillData={}),oe(this.currentFillData,e)}},{key:"getAutofillSize",value:function(e,t,n){var r=M2(e,4),o=r[0],i=r[1],a=r[2],l=r[3],s=M2(t,4),u=s[0],c=s[1],f=s[2],h=s[3];switch(n){case"up":return o-u;case"down":return f-a;case"left":return i-c;case"right":return h-l;default:return null}}},{key:"getDragArea",value:function(e,t,n){var r=M2(e,4),o=r[0],i=r[1],a=r[2],l=r[3],s=M2(t,4),u=s[0],c=s[1],f=s[2],h=s[3];switch(n){case"up":return[u,c,o-1,l];case"down":return[a+1,i,f,l];case"left":return[u,c,a,i-1];case"right":return[o,l+1,f,h];default:return null}}},{key:"getFarthestCollection",value:function(e,t,n,r){var o=M2(e,4),i=o[0],a=o[1],l=o[2],s=o[3],u=["up","down"].indexOf(n)>-1,c=u?l:s,f=u?i:a,h=this.getAutofillSize(e,t,n),d=u?l-i+1:s-a+1,p=Math.floor(h/d)*d,y=h-p,v=null,g=null,m=null;switch(n){case"up":v="includesVertically",m=c-y+1;break;case"left":v="includesHorizontally",m=c-y+1;break;case"down":v="includesVertically",m=f+y-1;break;case"right":v="includesHorizontally",m=f+y-1;break;default:}return U(r,(function(e){e[v](m)&&e.isFarther(g,n)&&(g=e)})),g}},{key:"recreateAfterDataPopulation",value:function(e){if(this.currentFillData){var t=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=function(e,n){switch(r){case"up":return e.row-n>=t.from.row;case"down":return e.row+e.rowspan-1+n<=t.to.row;case"left":return e.col-n>=t.from.column;case"right":return e.col+e.colspan-1+n<=t.to.column;default:return null}},i=0,a=null,l=1;do{for(var s=0;s<n.length;s+=1){if(a=n[s],i=l*this.currentFillData.cycleLength,o(a,i))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-i,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+i,colspan:a.colspan});break;default:}s===n.length-1&&(l+=1)}}while(o(a,i));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(e){var t=this,n={min:null,max:null},r={min:null,max:null};return U(e,(function(e){var o=e[0],i=t.plugin.hot.propToCol(e[1]);(null===n.min||o<n.min)&&(n.min=o),(null===n.max||o>n.max)&&(n.max=o),(null===r.min||i<r.min)&&(r.min=i),(null===r.max||i>r.max)&&(r.max=i)})),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}},{key:"dragAreaOverlapsCollections",value:function(e,t,n){var r=this.getDragArea(e,t,n),o=M2(r,4),i=o[0],a=o[1],l=o[2],s=o[3],u=this.plugin.hot._createCellCoords(i,a),c=this.plugin.hot._createCellCoords(l,s),f=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(f,!0)}}]),e}(),B2=L2;function V2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W2(e,t,n){return t&&F2(e.prototype,t),n&&F2(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var U2=function(){function e(t){V2(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return W2(e,[{key:"snapDelta",value:function(e,t,n){var r=t.to,o=r.row+e.row,i=r.col+e.col;e.row?this.jumpOverMergedCell(e,n,o):e.col&&this.jumpOverMergedCell(e,n,i)}},{key:"jumpOverMergedCell",value:function(e,t,n){var r=e.row||e.col,o=null,i=null,a=null;e.row?(o=t.includesVertically(n),i=t.row,a=t.getLastRow()):e.col&&(o=t.includesHorizontally(n),i=t.col,a=t.getLastColumn()),0!==r&&(r>0?o&&n!==i&&(r+=a-n+1):o&&n!==a&&(r-=n-i+1),e.row?e.row=r:e.col&&(e.col=r))}},{key:"getUpdatedSelectionRange",value:function(e,t){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+t.row,e.to.col+t.col))}},{key:"getSelectedMergedCellClassName",value:function(e,t,n,r){var o=Math.min(n[0],n[2]),i=Math.min(n[1],n[3]),a=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(void 0!==r){var s=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t);if(s){var u=this.plugin.mergedCellsCollection.get(e,t);if(u){var c=u.getLastRow(),f=u.getLastColumn(),h=o<=u.row&&i<=u.col&&a>=c&&l>=f;return h?"".concat(this.fullySelectedMergedCellClassName,"-").concat(r):this.plugin.selectionCalculations.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange())?"".concat(this.fullySelectedMergedCellClassName,"-multiple"):void 0}}}}},{key:"isMergeCellFullySelected",value:function(e,t){var n=[];if(!t||!e)return!1;for(var r=0;r<e.rowspan;r+=1)for(var o=0;o<e.colspan;o+=1)n.push(this.hot._createCellCoords(e.row+r,e.col+o));for(var i=0;i<n.length;i+=1){for(var a=[],l=0;l<t.length;l+=1)a[l]=t[l].includes(n[i]);if(!a.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var e=[],t=0;t<=7;t+=1)e.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(t));return e.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),e}}]),e}(),z2=U2;function G2(e){return{key:"mergeCells",name:function(){var t=this.getSelectedLast();if(t){var n=e.mergedCellsCollection.get(t[0],t[1]);if(n.row===t[0]&&n.col===t[1]&&n.row+n.rowspan-1===t[2]&&n.col+n.colspan-1===t[3])return this.getTranslatedPhrase(am)}return this.getTranslatedPhrase(im)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var e=this.getSelectedLast();if(!e)return!0;var t=y2.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1});return t||this.selection.isSelectedByCorner()},hidden:!1}}function Y2(e){return Y2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y2(e)}function K2(e,t){return J2(e)||Q2(e,t)||$2(e,t)||X2()}function X2(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $2(e,t){if(e){if("string"===typeof e)return q2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q2(e,t):void 0}}function q2(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Q2(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function J2(e){if(Array.isArray(e))return e}function Z2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function e3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t3(e,t,n){return t&&e3(e.prototype,t),n&&e3(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function n3(){return n3="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=r3(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},n3.apply(this,arguments)}function r3(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=c3(e),null===e)break;return e}function o3(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i3(e,t)}function i3(e,t){return i3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i3(e,t)}function a3(e){var t=u3();return function(){var n,r=c3(e);if(t){var o=c3(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l3(this,n)}}function l3(e,t){if(t&&("object"===Y2(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s3(e)}function s3(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u3(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function c3(e){return c3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c3(e)}hr.getSingleton().register("beforeMergeCells"),hr.getSingleton().register("afterMergeCells"),hr.getSingleton().register("beforeUnmergeCells"),hr.getSingleton().register("afterUnmergeCells");var f3,h3="mergeCells",d3=150,p3=new WeakMap,y3=h3,v3=function(e){o3(n,e);var t=a3(n);function n(e){var r;return Z2(this,n),r=t.call(this,e),p3.set(s3(r),{lastDesiredCoords:null}),r.mergedCellsCollection=null,r.autofillCalculations=null,r.selectionCalculations=null,r}return t3(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[h3]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mergedCellsCollection=new P2(this),this.autofillCalculations=new B2(this),this.selectionCalculations=new z2(this),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("modifyTransformStart",(function(){return e.onModifyTransformStart.apply(e,arguments)})),this.addHook("afterModifyTransformStart",(function(){return e.onAfterModifyTransformStart.apply(e,arguments)})),this.addHook("modifyTransformEnd",(function(){return e.onModifyTransformEnd.apply(e,arguments)})),this.addHook("modifyGetCellCoords",(function(){return e.onModifyGetCellCoords.apply(e,arguments)})),this.addHook("beforeSetRangeStart",(function(){return e.onBeforeSetRangeStart.apply(e,arguments)})),this.addHook("beforeSetRangeStartOnly",(function(){return e.onBeforeSetRangeStart.apply(e,arguments)})),this.addHook("beforeSetRangeEnd",(function(){return e.onBeforeSetRangeEnd.apply(e,arguments)})),this.addHook("afterIsMultipleSelection",(function(){return e.onAfterIsMultipleSelection.apply(e,arguments)})),this.addHook("afterRenderer",(function(){return e.onAfterRenderer.apply(e,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.addMergeActionsToContextMenu.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(){return e.onAfterGetCellMeta.apply(e,arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return e.onAfterViewportRowCalculatorOverride.apply(e,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride.apply(e,arguments)})),this.addHook("modifyAutofillRange",(function(){return e.onModifyAutofillRange.apply(e,arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol.apply(e,arguments)})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange.apply(e,arguments)})),this.addHook("beforeDrawBorders",(function(){return e.onBeforeDrawAreaBorders.apply(e,arguments)})),this.addHook("afterDrawSelection",(function(){return e.onAfterDrawSelection.apply(e,arguments)})),this.addHook("beforeRemoveCellClassNames",(function(){return e.onBeforeRemoveCellClassNames.apply(e,arguments)})),this.addHook("beforeUndoStackChange",(function(e,t){if("MergeCells"===t)return!1})),this.registerShortcuts(),n3(c3(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),n3(c3(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var e=this.hot.getSettings()[h3];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),n3(c3(n.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(e){var t=!0;return!!e&&(y2.containsNegativeValues(e)?(Fn(y2.NEGATIVE_VALUES_WARNING(e)),t=!1):y2.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Fn(y2.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):y2.isSingleCell(e)?(Fn(y2.IS_SINGLE_CELL(e)),t=!1):y2.containsZeroSpan(e)&&(Fn(y2.ZERO_SPAN_WARNING(e)),t=!1),t)}},{key:"generateFromSettings",value:function(e){var t=this;if(Array.isArray(e)){var n=[];if(U(e,(function(e){if(t.validateSetting(e)){var r=t.hot._createCellCoords(e.row,e.col),o=t.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1),i=t.hot._createCellRange(r,r,o);t.mergeRange(i,!0,!0),Co(e.row,e.row+e.rowspan-1,(function(t){Co(e.col,e.col+e.colspan-1,(function(r){!1===(t===e.row&&r===e.col)&&n.push([t,r,null])}))}))}})),0===n.length)return;this.hot.setDataAtCell(n)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!t||this.validateSetting(e)}},{key:"toggleMergeOnSelection",value:function(){var e=this.hot.getSelectedRangeLast();if(e){e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var t=e.from,n=e.to;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"mergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var t=e.from,n=e.to;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"unmergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){var t=e.from,n=e.to;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"mergeRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.getTopStartCorner(),i=e.getBottomEndCorner(),a={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},l=[],s=null;if(!this.canMergeRange(a,n))return!1;this.hot.runHooks("beforeMergeCells",e,n),Co(0,a.rowspan-1,(function(e){Co(0,a.colspan-1,(function(n){var r=null;l[e]||(l[e]=[]),0===e&&0===n?r=t.hot.getSourceDataAtCell(t.hot.toPhysicalRow(a.row),t.hot.toPhysicalColumn(a.col)):t.hot.setCellMeta(a.row+e,a.col+n,"hidden",!0),l[e][n]=r}))})),this.hot.setCellMeta(a.row,a.col,"spanned",!0);var u=this.mergedCellsCollection.add(a);return!u||(r?s=[a.row,a.col,l]:this.hot.populateFromArray(a.row,a.col,l,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",e,a,n),s)}},{key:"unmergeRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),U(r,(function(e){t.mergedCellsCollection.remove(e.row,e.col),Co(0,e.rowspan-1,(function(n){Co(0,e.colspan-1,(function(r){t.hot.removeCellMeta(e.row+n,e.col+r,"hidden")}))})),t.hot.removeCellMeta(e.row,e.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}},{key:"toggleMerge",value:function(e){var t=this.mergedCellsCollection.get(e.from.row,e.from.col),n=t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col;n?this.unmergeRange(e):this.mergeSelection(e)}},{key:"merge",value:function(e,t,n,r){var o=this.hot._createCellCoords(e,t),i=this.hot._createCellCoords(n,r);this.mergeRange(this.hot._createCellRange(o,o,i))}},{key:"unmerge",value:function(e,t,n,r){var o=this.hot._createCellCoords(e,t),i=this.hot._createCellCoords(n,r);this.unmergeRange(this.hot._createCellRange(o,o,i))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[h3]),this.hot.render()}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager(),n=t.getContext("grid");n.addShortcut({keys:[["Control","m"]],callback:function(){e.toggleMerge(e.hot.getSelectedRangeLast()),e.hot.render()},runOnlyIf:function(e){return!e.altKey},group:y3})}},{key:"unregisterShortcuts",value:function(){var e=this.hot.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(y3)}},{key:"onAfterIsMultipleSelection",value:function(e){if(e)for(var t=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=0;r<t.length;r+=1)if(n.from.row===t[r].row&&n.from.col===t[r].col&&n.to.row===t[r].row+t[r].rowspan-1&&n.to.col===t[r].col+t[r].colspan-1)return!1;return e}},{key:"onModifyTransformStart",value:function(e){var t=p3.get(this),n=this.hot.getSelectedRangeLast(),r={row:e.row,col:e.col},o=null,i=this.hot._createCellCoords(n.highlight.row,n.highlight.col),a=this.mergedCellsCollection.get(i.row,i.col);if(t.lastDesiredCoords||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),a){var l=this.hot._createCellCoords(a.row,a.col),s=this.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1),u=this.hot._createCellRange(l,l,s);u.includes(t.lastDesiredCoords)||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),r.row=t.lastDesiredCoords.row?t.lastDesiredCoords.row-i.row:r.row,r.col=t.lastDesiredCoords.col?t.lastDesiredCoords.col-i.col:r.col,e.row>0?r.row=a.row+a.rowspan-1-i.row+e.row:e.row<0&&(r.row=i.row-a.row+e.row),e.col>0?r.col=a.col+a.colspan-1-i.col+e.col:e.col<0&&(r.col=i.col-a.col+e.col)}o=this.hot._createCellCoords(n.highlight.row+r.row,n.highlight.col+r.col);var c=this.mergedCellsCollection.get(o.row,o.col);if(c){var f=this.mergedCellsCollection.getFirstRenderableCoords(c.row,c.col);t.lastDesiredCoords=o,r={row:f.row-i.row,col:f.col-i.col}}0!==r.row&&(e.row=r.row),0!==r.col&&(e.col=r.col)}},{key:"onModifyTransformEnd",value:function(e){var t=this,n=this.hot.getSelectedRangeLast(),r=le(e),o=this.selectionCalculations.getUpdatedSelectionRange(n,e),i=le(r),a=this.mergedCellsCollection.getWithinRange(o,!0);do{i=le(r),this.selectionCalculations.getUpdatedSelectionRange(n,r),U(a,(function(e){t.selectionCalculations.snapDelta(r,n,e)}))}while(r.row!==i.row||r.col!==i.col);e.row=r.row,e.col=r.col}},{key:"onModifyGetCellCoords",value:function(e,t){if(!(e<0||t<0)){var n=this.mergedCellsCollection.get(e,t);if(n){var r=n.row,o=n.col,i=n.colspan,a=n.rowspan;return[r,o,r+a-1,o+i-1]}}}},{key:"addMergeActionsToContextMenu",value:function(e){e.items.push({name:"---------"},G2(this))}},{key:"onAfterRenderer",value:function(e,t,n){var r=this.mergedCellsCollection.get(t,n),o=ce(r)?le(r):void 0;if(ce(o)){var i=this.hot,a=i.rowIndexMapper,l=i.columnIndexMapper,s=o.row,u=o.col,c=o.colspan,f=o.rowspan,h=this.translateMergedCellToRenderable(s,f,u,c),d=K2(h,2),p=d[0],y=d[1],v=a.getRenderableFromVisualIndex(t),g=l.getRenderableFromVisualIndex(n),m=p-v+1,b=y-g+1;o.row=a.getNearestNotHiddenIndex(o.row,1),o.col=l.getNearestNotHiddenIndex(o.col,1),o.rowspan=Math.min(o.rowspan,m),o.colspan=Math.min(o.colspan,b)}v2(e,o,t,n)}},{key:"onBeforeSetRangeStart",value:function(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){var t=this.mergedCellsCollection.get(e.row,e.col),n=[t.row,t.col];e.row=n[0],e.col=n[1]}}},{key:"onBeforeSetRangeEnd",value:function(e){var t=this.hot.getSelectedRangeLast();t.highlight=this.hot._createCellCoords(t.highlight.row,t.highlight.col),t.to=e;var n=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{n=!1;for(var r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){var o=this.mergedCellsCollection.mergedCells[r],i=o.getRange();t.expandByRange(i)&&(e.row=t.to.row,e.col=t.to.col,n=!0)}}while(n)}},{key:"onAfterGetCellMeta",value:function(e,t,n){var r=this.mergedCellsCollection.get(e,t);r&&(r.row!==e||r.col!==t?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(e){var t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}},{key:"modifyViewportRowStart",value:function(e,t){for(var n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.startRow),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(r,o);if(ce(i)){var a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i.row,1));if(a<e.startRow)return e.startRow=a,void this.modifyViewportRowStart(e,t)}}}},{key:"modifyViewportRowEnd",value:function(e,t){for(var n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.endRow),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(r,o);if(ce(i)){var a=i.row+i.rowspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endRow)return e.endRow=l,void this.modifyViewportRowEnd(e,t)}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){var t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}},{key:"modifyViewportColumnStart",value:function(e,t){for(var n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.startColumn),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(o,r);if(ce(i)){var a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i.col,1));if(a<e.startColumn)return e.startColumn=a,void this.modifyViewportColumnStart(e,t)}}}},{key:"modifyViewportColumnEnd",value:function(e,t){for(var n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.endColumn),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(o,r);if(ce(i)){var a=i.col+i.colspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn)return e.endColumn=l,void this.modifyViewportColumnEnd(e,t)}}}},{key:"translateMergedCellToRenderable",value:function(e,t,n,r){var o,i,a=this.hot,l=a.rowIndexMapper,s=a.columnIndexMapper;o=0===t?l.getNearestNotHiddenIndex(e,1):l.getNearestNotHiddenIndex(e+t-1,-1),i=0===r?s.getNearestNotHiddenIndex(n,1):s.getNearestNotHiddenIndex(n+r-1,-1);var u=e>=0?l.getRenderableFromVisualIndex(o):e,c=n>=0?s.getRenderableFromVisualIndex(i):n;return[u,c]}},{key:"onModifyAutofillRange",value:function(e,t){this.autofillCalculations.correctSelectionAreaSize(t);var n=this.autofillCalculations.getDirection(t,e),r=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,r,n))return r=t,r;var o=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}});return o?(r=this.autofillCalculations.snapDragArea(t,r,n,o),r):r}},{key:"onAfterCreateCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}},{key:"onAfterRemoveCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}},{key:"onAfterCreateRow",value:function(e,t,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",e,t)}},{key:"onAfterRemoveRow",value:function(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}},{key:"onAfterChange",value:function(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}},{key:"onBeforeDrawAreaBorders",value:function(e,t){if(t&&"area"===t){var n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);U(r,(function(t){n.getBottomEndCorner().row===t.getLastRow()&&n.getBottomEndCorner().col===t.getLastColumn()&&(e[2]=t.row,e[3]=t.col)}))}}},{key:"onAfterModifyTransformStart",value:function(e,t,n){if(this.enabled){var r=this.mergedCellsCollection.get(e.row,e.col);if(r){var o=t>0,i=t<0,a=n<0,l=n>0,s=r.row+r.rowspan-1===this.hot.countRows()-1,u=0===r.row,c=r.col+r.colspan-1===this.hot.countCols()-1,f=0===r.col;(o&&s||i&&u||l&&c||a&&f)&&(e.row=r.row,e.col=r.col)}}}},{key:"onAfterDrawSelection",value:function(e,t,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,n,r)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return h3}},{key:"PLUGIN_PRIORITY",get:function(){return d3}}]),n}($A);function g3(e){return S3(e)||C3(e)||b3(e)||m3()}function m3(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b3(e,t){if(e){if("string"===typeof e)return w3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w3(e,t):void 0}}function w3(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function C3(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function S3(e){if(Array.isArray(e))return e}function O3(e,t){return function(n,r){var o=g3(n),i=o.slice(1),a=g3(r),l=a.slice(1);return function n(r){var o=e[r],a=t[r],s=i[r],u=l[r],c=a.multiColumnSorting,f=c.compareFunctionFactory?c.compareFunctionFactory:TH(a.type),h=f(o,a,c)(s,u);if(h===sH){var d=r+1;if("undefined"!==typeof t[d])return n(d)}return h}(0)}}function k3(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function R3(){Fn(Ke(f3||(f3=k3(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var E3="sort";function T3(e,t,n){var r=[];return!1===n||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&r.push("".concat(E3,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),r}function P3(e){var t=e.className.split(" "),n=new RegExp("^".concat(E3,"-[0-9]{1,2}$"));return t.filter((function(e){return n.test(e)}))}function M3(e){return M3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M3(e)}function A3(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j3(e,t,n){return t&&I3(e.prototype,t),n&&I3(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function x3(){return x3="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=_3(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},x3.apply(this,arguments)}function _3(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=F3(e),null===e)break;return e}function H3(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D3(e,t)}function D3(e,t){return D3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},D3(e,t)}function N3(e){var t=V3();return function(){var n,r=F3(e);if(t){var o=F3(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return L3(this,n)}}function L3(e,t){if(t&&("object"===M3(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return B3(e)}function B3(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V3(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function F3(e){return F3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},F3(e)}var W3="multiColumnSorting",U3=170,z3="append",G3="columnSorting";RH(W3,O3);var Y3=function(e){H3(n,e);var t=N3(n);function n(e){var r;return A3(this,n),r=t.call(this,e),r.pluginKey=W3,r}return j3(n,[{key:"isEnabled",value:function(){return x3(F3(n.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[G3]&&R3(),x3(F3(n.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){x3(F3(n.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(e){x3(F3(n.prototype),"sort",this).call(this,e)}},{key:"clearSort",value:function(){x3(F3(n.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return x3(F3(n.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(e){return x3(F3(n.prototype),"getSortConfig",this).call(this,e)}},{key:"setSortConfig",value:function(e){x3(F3(n.prototype),"setSortConfig",this).call(this,e)}},{key:"getNormalizedSortConfigs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}},{key:"updateHeaderClasses",value:function(e){for(var t,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];(t=x3(F3(n.prototype),"updateHeaderClasses",this)).call.apply(t,[this,e].concat(o)),zt(e,P3(e)),!1!==this.enabled&&Ut(e,T3.apply(void 0,o))}},{key:"onUpdateSettings",value:function(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[G3]&&R3(),x3(F3(n.prototype),"onUpdateSettings",this).call(this,e)}},{key:"onAfterOnCellMouseDown",value:function(e,t){!1!==Z_(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,z3))):this.sort(this.getColumnNextConfig(t.col)))}}],[{key:"PLUGIN_KEY",get:function(){return W3}},{key:"PLUGIN_PRIORITY",get:function(){return U3}}]),n}(fD);function K3(e){return K3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K3(e)}function X3(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q3(e,t,n){return t&&$3(e.prototype,t),n&&$3(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q3(){return Q3="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=J3(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Q3.apply(this,arguments)}function J3(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=i8(e),null===e)break;return e}function Z3(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e8(e,t)}function e8(e,t){return e8=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e8(e,t)}function t8(e){var t=o8();return function(){var n,r=i8(e);if(t){var o=i8(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return n8(this,n)}}function n8(e,t){if(t&&("object"===K3(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return r8(e)}function r8(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o8(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function i8(e){return i8=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},i8(e)}var a8="multipleSelectionHandles",l8=160,s8=function(e){Z3(n,e);var t=t8(n);function n(e){var r;return X3(this,n),r=t.call(this,e),r.dragged=[],r.eventManager=null,r.lastSetCell=null,r}return q3(n,[{key:"isEnabled",value:function(){return xe()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Nr(this)),this.registerListeners(),Q3(i8(n.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var e=this,t=this,n=this.hot.rootElement;function r(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;var n=t.dragged.indexOf(e);if(-1===n)return!1;0===n?t.dragged=t.dragged.slice(0,1):1===n&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",(function(e){var n;return Wt(e.target,"topSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):Wt(e.target,"bottomSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchend",(function(e){return Wt(e.target,"topSelectionHandle-HitArea")?(r.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):Wt(e.target,"bottomSelectionHandle-HitArea")?(r.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchmove",(function(n){var r,o,i,a,l,s,u=e.hot.rootDocument;if(0!==t.dragged.length){var c=u.elementFromPoint(n.touches[0].clientX,n.touches[0].clientY);c&&c!==t.lastSetCell&&("TD"!==c.nodeName&&"TH"!==c.nodeName||(r=t.hot.getCoords(c),-1===r.col&&(r.col=0),o=t.hot.getSelectedRangeLast(),i=o.getWidth(),a=o.getHeight(),l=o.getDirection(),1===i&&1===a&&t.hot.selection.setRangeEnd(r),s=t.getCurrentRangeCoords(o,r,t.touchStartRange.direction,l,t.dragged[0]),null!==s.start&&t.hot.selection.setRangeStart(s.start),t.hot.selection.setRangeEnd(s.end),t.lastSetCell=c),n.preventDefault())}}))}},{key:"getCurrentRangeCoords",value:function(e,t,n,r,o){var i=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),s=e.getTopEndCorner(),u={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":u="top"===o?{start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,i.col)};break;case"SE-NW":"bottom"===o&&(u={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,i.col)});break;default:break}break;case"NW-SE":switch(r){case"NE-SW":"top"===o?u={start:t,end:l}:u.end=t;break;case"NW-SE":"top"===o?u={start:t,end:a}:u.end=t;break;case"SE-NW":"top"===o?u={start:t,end:i}:u.end=t;break;case"SW-NE":"top"===o?u={start:t,end:s}:u.end=t;break;default:break}break;case"SW-NE":switch(r){case"NW-SE":u="bottom"===o?{start:this.hot._createCellCoords(t.row,i.col),end:this.hot._createCellCoords(l.row,t.col)}:{start:this.hot._createCellCoords(i.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":u="top"===o?{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:{start:this.hot._createCellCoords(t.row,i.col),end:this.hot._createCellCoords(i.row,t.col)};break;case"SE-NW":"bottom"===o?u={start:this.hot._createCellCoords(t.row,s.col),end:this.hot._createCellCoords(i.row,t.col)}:"top"===o&&(u={start:l,end:t});break;default:break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===o&&(u.end=t);break;case"SE-NW":"top"===o?u.end=t:u={start:t,end:i};break;default:break}break;default:break}return u}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return a8}},{key:"PLUGIN_PRIORITY",get:function(){return l8}}]),n}($A);function u8(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.label,n=void 0===t?"":t,r=e.colspan,o=void 0===r?1:r,i=e.origColspan,a=void 0===i?1:i,l=e.collapsible,s=void 0!==l&&l,u=e.crossHiddenColumns,c=void 0===u?[]:u,f=e.isCollapsed,h=void 0!==f&&f,d=e.isHidden,p=void 0!==d&&d,y=e.isRoot,v=void 0!==y&&y,g=e.isPlaceholder,m=void 0!==g&&g;return{label:n,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:c,isHidden:p,isRoot:v,isPlaceholder:m}}function c8(){return{label:"",isPlaceholder:!0}}function f8(e){return y8(e)||p8(e)||d8(e)||h8()}function h8(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d8(e,t){if(e){if("string"===typeof e)return v8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v8(e,t):void 0}}function p8(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function y8(e){if(Array.isArray(e))return v8(e)}function v8(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g8(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=[];if(0===t)return n;U(e,(function(e){var r=[],o=0;n.push(r),U(e,(function(e){var n=u8();if(ce(e)){var i=e.label,a=e.colspan;n.label=qe(i),"number"===typeof a&&a>1&&(n.colspan=a,n.origColspan=a)}else n.label=qe(e);o+=n.origColspan;var l=!1;if(o>=t&&(n.colspan=n.origColspan-(o-t),n.origColspan=n.colspan,l=!0),r.push(n),n.colspan>1)for(var s=0;s<n.colspan-1;s++)r.push(c8());return!l}))}));var r=Math.max.apply(Math,f8(W(n,(function(e){return e.length}))));return U(n,(function(e){if(e.length<r){var t=W(new Array(r-e.length),(function(){return u8()}));e.splice.apply(e,[e.length,0].concat(f8(t)))}})),n}var m8=["row","col"];function b8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w8(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b8(Object(n),!0).forEach((function(t){C8(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b8(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C8(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S8(e,t){if(null==e)return{};var n,r,o=O8(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function O8(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function k8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E8(e,t,n){return t&&R8(e.prototype,t),n&&R8(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function T8(e,t,n){P8(e,t),t.set(e,n)}function P8(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function M8(e,t){var n=j8(e,t,"get");return A8(e,n)}function A8(e,t){return t.get?t.get.call(e):t.value}function I8(e,t,n){var r=j8(e,t,"set");return x8(e,r,n),n}function j8(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function x8(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}var _8=["label","collapsible"],H8=new WeakMap,D8=new WeakMap,N8=new WeakMap,L8=function(){function e(){k8(this,e),T8(this,H8,{writable:!0,value:[]}),T8(this,D8,{writable:!0,value:0}),T8(this,N8,{writable:!0,value:1/0})}return E8(e,[{key:"setColumnsLimit",value:function(e){I8(this,N8,e)}},{key:"setData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];I8(this,H8,g8(e,M8(this,N8))),I8(this,D8,M8(this,H8).length)}},{key:"getData",value:function(){return M8(this,H8)}},{key:"mergeWith",value:function(e){var t=this;U(e,(function(e){var n=e.row,r=e.col,o=S8(e,m8),i=t.getHeaderSettings(n,r);null!==i&&oe(i,o,_8)}))}},{key:"map",value:function(e){U(M8(this,H8),(function(t){U(t,(function(t){var n=e(w8({},t));ce(n)&&oe(t,n,_8)}))}))}},{key:"getHeaderSettings",value:function(e,t){var n;if(e>=M8(this,D8)||e<0)return null;var r=M8(this,H8)[e];return t>=r.length?null:null!==(n=r[t])&&void 0!==n?n:null}},{key:"getHeadersSettings",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=[];if(e>=M8(this,D8)||e<0)return r;for(var o=M8(this,H8)[e],i=0,a=t;a<o.length;a++){var l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(i+=l.colspan,r.push(l),l.colspan>1&&(a+=l.colspan-1),i===n)break;if(i>n)throw new Error("The last column settings cannot overlap the other header layers")}return r}},{key:"getLayersCount",value:function(){return M8(this,D8)}},{key:"getColumnsCount",value:function(){return M8(this,D8)>0?M8(this,H8)[0].length:0}},{key:"clear",value:function(){I8(this,H8,[]),I8(this,D8,0)}}]),e}();function B8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V8(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B8(Object(n),!0).forEach((function(t){z8(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B8(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function F8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U8(e,t,n){return t&&W8(e.prototype,t),n&&W8(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function z8(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G8(e){return $8(e)||X8(e)||K8(e)||Y8()}function Y8(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function K8(e,t){if(e){if("string"===typeof e)return q8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q8(e,t):void 0}}function X8(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function $8(e){if(Array.isArray(e))return q8(e)}function q8(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Q8="DF-pre-order";function J8(e,t){for(var n=e.call(t,this),r=0;r<this.childs.length;r++){if(!1===n)return!1;n=J8.call(this.childs[r],e,t)}return n}var Z8="DF-post-order";function e6(e,t){for(var n=0;n<this.childs.length;n++){var r=e6.call(this.childs[n],e,t);if(!1===r)return!1}return e.call(t,this)}var t6="BF";function n6(e,t){var n=[this];function r(){if(0!==n.length){var o=n.shift();n.push.apply(n,G8(o.childs)),!1!==e.call(t,o)&&r()}}r()}var r6=t6,o6=new Map([[Q8,J8],[Z8,e6],[t6,n6]]),i6=function(){function e(t){F8(this,e),z8(this,"data",{}),z8(this,"parent",null),z8(this,"childs",[]),this.data=t}return U8(e,[{key:"addChild",value:function(e){e.parent=this,this.childs.push(e)}},{key:"cloneTree",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=new e(V8({},t.data)),r=0;r<t.childs.length;r++)n.addChild(this.cloneTree(t.childs[r]));return n}},{key:"replaceTreeWith",value:function(e){this.data=V8({},e.data),this.childs=[];for(var t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}},{key:"walkDown",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r6;if(!o6.has(t))throw new Error('Traversal strategy "'.concat(t,'" does not exist'));o6.get(t).call(this,e,this)}},{key:"walkUp",value:function(e){var t=this,n=function n(r){var o=e.call(t,r);!1!==o&&null!==r.parent&&n(r.parent)};n(this)}}]),e}();function a6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l6(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a6(Object(n),!0).forEach((function(t){s6(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a6(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s6(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u6(e,t){return p6(e)||d6(e,t)||f6(e,t)||c6()}function c6(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f6(e,t){if(e){if("string"===typeof e)return h6(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h6(e,t):void 0}}function h6(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d6(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function p6(e){if(Array.isArray(e))return e}function y6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g6(e,t,n){return t&&v6(e.prototype,t),n&&v6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function m6(e,t,n){b6(e,t),t.set(e,n)}function b6(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function w6(e,t){var n=O6(e,t,"get");return C6(e,n)}function C6(e,t){return t.get?t.get.call(e):t.value}function S6(e,t,n){var r=O6(e,t,"set");return k6(e,r,n),n}function O6(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function k6(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}var R6,E6,T6=new WeakMap,P6=new WeakMap,M6=new WeakMap,A6=function(){function e(t){y6(this,e),m6(this,T6,{writable:!0,value:new Map}),m6(this,P6,{writable:!0,value:new Map}),m6(this,M6,{writable:!0,value:null}),S6(this,M6,t)}return g6(e,[{key:"getRoots",value:function(){return Array.from(w6(this,T6).values())}},{key:"getRootByColumn",value:function(e){var t;return w6(this,P6).has(e)&&(t=w6(this,T6).get(w6(this,P6).get(e))),t}},{key:"getNode",value:function(e,t){var n=this.getRootByColumn(t);if(n){var r,o=t-w6(this,P6).get(t),i=0;return n.walkDown((function(n){var a=n.data,l=a.origColspan,s=a.headerLevel;if(e===s){if(o>=i&&o<=i+l-1)return r=n,r.data.isRoot=t===r.data.columnIndex,!1;i+=l}})),r}}},{key:"rebuildTreeIndex",value:function(){var e=this,t=0;w6(this,P6).clear(),U(w6(this,T6),(function(n){for(var r=u6(n,2),o=r[1].data.colspan,i=t;i<t+o;i++)w6(e,P6).set(i,t);t+=o}))}},{key:"buildTree",value:function(){this.clear();var e=w6(this,M6).getColumnsCount(),t=0;while(t<e){var n=w6(this,M6).getHeaderSettings(0,t),r=new i6;w6(this,T6).set(t,r),this.buildLeaves(r,t,0,n.origColspan),t+=n.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=w6(this,M6).getHeadersSettings(n,t,o);n+=1,U(i,(function(o){var i,a=l6(l6({},o),{},{headerLevel:n-1,columnIndex:t});1===n?(e.data=a,i=e):(i=new i6(a),e.addChild(i)),n<w6(r,M6).getLayersCount()&&r.buildLeaves(i,t,n,o.origColspan),t+=o.origColspan}))}},{key:"clear",value:function(){w6(this,T6).clear(),w6(this,P6).clear()}}]),e}();function I6(e,t){e.walkDown((function(e){var n=e.data,r=e.childs;if(!n.isHidden&&(t(n.columnIndex),0===r.length))for(var o=1;o<n.colspan;o++)t(n.columnIndex+o)}))}function j6(e,t){var n=e.childs;if(0!==n.length)return n[0].data[t]}function x6(e){return j6(e,"origColspan")===e.data.origColspan}function _6(e){var t=e.data,n=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var r=x6(e);if(r)return _6(n[0]);t.isCollapsed=!1;var o=n.slice(1),i=new Set,a=0;if(o.length>0)U(o,(function(e){e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;var t=e.data;a+=t.colspan,I6(e,(function(e){i.add(e)}))}));else{var l=t.colspan,s=t.origColspan,u=t.columnIndex;a=s-l;for(var c=1;c<s;c++)i.add(u+c)}return e.walkUp((function(e){var t=e.data;t.colspan+=a,t.colspan>=t.origColspan?(t.colspan=t.origColspan,t.isCollapsed=!1):x6(e)&&(t.isCollapsed=j6(e,"isCollapsed"))})),{rollbackModification:function(){return H6(e)},affectedColumns:Array.from(i),colspanCompensation:a}}function H6(e){var t,n=e.data,r=e.childs;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=x6(e);if(o)return H6(r[0]);n.isCollapsed=!0;var i=r.slice(1),a=new Set;if(i.length>0)U(i,(function(e){I6(e,(function(e){a.add(e)})),e.data.clonedTree=e.cloneTree(),e.walkDown((function(e){var t=e.data;t.isHidden=!0}))}));else for(var l=n.origColspan,s=n.columnIndex,u=1;u<l;u++){var c=s+u;a.add(c)}var f=n.colspan-(null!==(t=j6(e,"colspan"))&&void 0!==t?t:1);return e.walkUp((function(e){var t=e.data;t.colspan-=f,t.colspan<=1?(t.colspan=1,t.isCollapsed=!0):x6(e)&&(t.isCollapsed=j6(e,"isCollapsed"))})),{rollbackModification:function(){return _6(e)},affectedColumns:Array.from(a),colspanCompensation:f}}function D6(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function N6(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Ke(R6||(R6=D6(["The passed node is not the last node on the tree. Only for \nthe last node, the hide column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the hide column modification can be applied."]))));var n=e.data.crossHiddenColumns;if(!n.includes(t)){var r=!1;e.walkUp((function(e){var t=e.data.collapsible;if(t)return r=!0,!1})),r||e.walkUp((function(e){var n=e.data;n.crossHiddenColumns.push(t),n.colspan>1?n.colspan-=1:n.isHidden=!0}))}}function L6(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function B6(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Ke(E6||(E6=L6(["The passed node is not the last node on the tree. Only for \nthe last node, the show column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the show column modification can be applied."]))));var n=e.data.crossHiddenColumns;if(n.includes(t)){var r=!1;e.walkUp((function(e){var t=e.data.collapsible;if(t)return r=!0,!1})),r||e.walkUp((function(e){var n=e.data;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(t),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1}))}}var V6=new Map([["collapse",H6],["expand",_6],["hide-column",N6],["show-column",B6]]);function F6(e,t,n){if(!V6.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return V6.get(e)(t,n)}var W6=["crossHiddenColumns"];function U6(e,t){if(null==e)return{};var n,r,o=z6(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function z6(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function G6(e){var t=[];return U(e,(function(e){e.walkDown((function(e){for(var n=e.data,r=n.origColspan,o=n.columnIndex,i=n.headerLevel,a=n.crossHiddenColumns,l=K6(t,i),s=!1,u=o;u<o+r;u++){var c=a.includes(u);if(c||s)l.push(c8(n));else{var f=Y6(n);f.isRoot=!0,l.push(f),s=!0}}}))})),t}function Y6(e){var t=u8(e),n=(t.crossHiddenColumns,U6(t,W6));return n}function K6(e,t){var n;return Array.isArray(e[t])?n=e[t]:(n=[],e[t]=n),n}var X6=["row"];function $6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q6(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$6(Object(n),!0).forEach((function(t){Q6(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$6(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q6(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J6(e,t){if(null==e)return{};var n,r,o=Z6(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Z6(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function e5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n5(e,t,n){return t&&t5(e.prototype,t),n&&t5(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function r5(e,t,n){o5(e,t),t.set(e,n)}function o5(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function i5(e,t,n){var r=s5(e,t,"set");return a5(e,r,n),n}function a5(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function l5(e,t){var n=s5(e,t,"get");return u5(e,n)}function s5(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function u5(e,t){return t.get?t.get.call(e):t.value}var c5=new WeakMap,f5=new WeakMap,h5=new WeakMap,d5=function(){function e(){e5(this,e),r5(this,c5,{writable:!0,value:new L8}),r5(this,f5,{writable:!0,value:new A6(l5(this,c5))}),r5(this,h5,{writable:!0,value:[[]]})}return n5(e,[{key:"setState",value:function(e){l5(this,c5).setData(e);var t=!1;try{l5(this,f5).buildTree()}catch(n){l5(this,f5).clear(),l5(this,c5).clear(),t=!0}return i5(this,h5,G6(l5(this,f5).getRoots())),t}},{key:"setColumnsLimit",value:function(e){l5(this,c5).setColumnsLimit(e)}},{key:"mergeStateWith",value:function(e){var t=this,n=W(e,(function(e){var n=e.row,r=J6(e,X6);return q6({row:n<0?t.rowCoordsToLevel(n):n},r)}));l5(this,c5).mergeWith(n),l5(this,f5).buildTree(),i5(this,h5,G6(l5(this,f5).getRoots()))}},{key:"mapState",value:function(e){l5(this,c5).map(e),l5(this,f5).buildTree(),i5(this,h5,G6(l5(this,f5).getRoots()))}},{key:"mapNodes",value:function(e){return V(l5(this,f5).getRoots(),(function(t,n){return n.walkDown((function(n){var r=e(n.data);void 0!==r&&t.push(r)})),t}),[])}},{key:"triggerNodeModification",value:function(e,t,n){t<0&&(t=this.rowCoordsToLevel(t));var r,o=l5(this,f5).getNode(t,n);return o&&(r=F6(e,o,n),i5(this,h5,G6(l5(this,f5).getRoots()))),r}},{key:"triggerColumnModification",value:function(e,t){return this.triggerNodeModification(e,-1,t)}},{key:"rowCoordsToLevel",value:function(e){if(e>=0)return null;var t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}},{key:"levelToRowCoords",value:function(e){if(e<0)return null;var t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}},{key:"getHeaderSettings",value:function(e,t){var n,r;return e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount()?null:null!==(n=null===(r=l5(this,h5)[e])||void 0===r?void 0:r[t])&&void 0!==n?n:null}},{key:"getHeaderTreeNodeData",value:function(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount())return null;var n=l5(this,f5).getNode(e,t);return n?q6({},n.data):null}},{key:"findLeftMostColumnIndex",value:function(e,t){var n,r=null!==(n=this.getHeaderSettings(e,t))&&void 0!==n?n:{isRoot:!0},o=r.isRoot;if(o)return t;var i=t-1;while(i>=0){var a,l=null!==(a=this.getHeaderSettings(e,i))&&void 0!==a?a:{isRoot:!0},s=l.isRoot;if(s)break;i-=1}return i}},{key:"getLayersCount",value:function(){return l5(this,c5).getLayersCount()}},{key:"getColumnsCount",value:function(){return l5(this,c5).getColumnsCount()}},{key:"clear",value:function(){i5(this,h5,[]),l5(this,c5).clear(),l5(this,f5).clear()}}]),e}();function p5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v5(e,t,n){return t&&y5(e.prototype,t),n&&y5(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function g5(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m5,b5,w5=function(){function e(t,n){p5(this,e),g5(this,"hot",void 0),g5(this,"nestedHeaderSettingsGetter",void 0),g5(this,"layersCount",0),g5(this,"container",void 0),g5(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return v5(e,[{key:"setLayersCount",value:function(e){return this.layersCount=e,this}},{key:"getWidth",value:function(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(var n=0;n<t;n++){var r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),o=this.hot.toPhysicalColumn(r);this.widthsMap.setValueAtIndex(o,e[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(e){for(var t=this.hot,n=t.rootDocument,r=t.columnIndexMapper,o=n.createDocumentFragment(),i=n.createElement("table"),a=!!this.hot.getSettings().dropdownMenu,l=r.getRenderableIndexesLength(),s=0;s<this.layersCount;s++){for(var u=n.createElement("tr"),c=0;c<l;c++){var f=r.getVisualFromRenderableIndex(c);null===f&&(f=c);var h=n.createElement("th"),d=this.nestedHeaderSettingsGetter(s,f);if(d&&(!d.isPlaceholder||d.isHidden)){var p=d.label;a&&(p+='<button class="changeType"></button>'),$t(h,p),h.colSpan=d.colspan,u.appendChild(h)}}i.appendChild(u)}o.appendChild(i),e.appendChild(o)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}(),C5=w5;function S5(e){return S5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S5(e)}function O5(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function k5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E5(e,t,n){return t&&R5(e.prototype,t),n&&R5(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function T5(){return T5="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=P5(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},T5.apply(this,arguments)}function P5(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=H5(e),null===e)break;return e}function M5(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A5(e,t)}function A5(e,t){return A5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},A5(e,t)}function I5(e){var t=_5();return function(){var n,r=H5(e);if(t){var o=H5(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return j5(this,n)}}function j5(e,t){if(t&&("object"===S5(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return x5(e)}function x5(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _5(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function H5(e){return H5=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},H5(e)}function D5(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N5(e,t,n){L5(e,t),t.set(e,n)}function L5(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function B5(e,t,n){var r=W5(e,t,"set");return V5(e,r,n),n}function V5(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function F5(e,t){var n=W5(e,t,"get");return U5(e,n)}function W5(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function U5(e,t){return t.get?t.get.call(e):t.value}var z5="nestedHeaders",G5=280,Y5=new WeakMap,K5=new WeakMap,X5=function(e){M5(n,e);var t=I5(n);function n(){var e;k5(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),N5(x5(e),Y5,{writable:!0,value:new d5}),N5(x5(e),K5,{writable:!0,value:null}),D5(x5(e),"ghostTable",new C5(e.hot,(function(t,n){return e.getHeaderSettings(t,n)}))),D5(x5(e),"detectedOverlappedHeaders",!1),e}return E5(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[z5]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings(),r=t.nestedHeaders;Array.isArray(r)&&Array.isArray(r[0])||Fn(Ke(m5||(m5=O5(["Your Nested Headers plugin configuration is invalid. The settings has to be \n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"],["Your Nested Headers plugin configuration is invalid. The settings has to be\\x20\n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"])))),this.addHook("init",(function(){return e.onInit()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("afterOnCellMouseDown",(function(){return e.onAfterOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver.apply(e,arguments)})),this.addHook("afterGetColumnHeaderRenderers",(function(t){return e.onAfterGetColumnHeaderRenderers(t)})),this.addHook("modifyColWidth",(function(){return e.onModifyColWidth.apply(e,arguments)})),this.addHook("modifyColumnHeaderValue",(function(){return e.onModifyColumnHeaderValue.apply(e,arguments)})),this.addHook("beforeHighlightingColumnHeader",(function(){return e.onBeforeHighlightingColumnHeader.apply(e,arguments)})),this.addHook("beforeCopy",(function(){return e.onBeforeCopy.apply(e,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride.apply(e,arguments)})),T5(H5(n.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var e=this;if(this.hot.view){var t=this.hot.getSettings(),r=t.nestedHeaders;F5(this,Y5).setColumnsLimit(this.hot.countCols()),Array.isArray(r)&&(this.detectedOverlappedHeaders=F5(this,Y5).setState(r)),this.detectedOverlappedHeaders&&Fn(Ke(b5||(b5=O5(["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration \n                        is currently not supported."],["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20\n                        is currently not supported."])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((function(t,n){var r=!0===t?"hide-column":"show-column";F5(e,Y5).triggerColumnModification(r,n)})),!F5(this,K5)&&this.enabled&&B5(this,K5,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((function(t){t.forEach((function(t){var n=t.op,r=t.index,o=t.newValue;if("replace"===n){var i=!0===o?"hide-column":"show-column";F5(e,Y5).triggerColumnModification(i,r)}})),e.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),T5(H5(n.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),F5(this,Y5).clear(),F5(this,K5).unsubscribe(),B5(this,K5,null),this.ghostTable.clear(),T5(H5(n.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return F5(this,Y5)}},{key:"getLayersCount",value:function(){return F5(this,Y5).getLayersCount()}},{key:"getHeaderSettings",value:function(e,t){return F5(this,Y5).getHeaderSettings(e,t)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var e=this.hot.view._wt,t=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=0;i<t;i++){var a=n.childNodes[i];if(!a)break;for(var l=r.childNodes[i],s=o?o.childNodes[i]:null,u=0,c=a.childNodes.length;u<c;u++)a.childNodes[u].removeAttribute("colspan"),zt(a.childNodes[u],"hiddenHeader"),l&&l.childNodes[u]&&(l.childNodes[u].removeAttribute("colspan"),zt(l.childNodes[u],"hiddenHeader")),o&&s&&s.childNodes[u]&&(s.childNodes[u].removeAttribute("colspan"),zt(s.childNodes[u],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(e){var t=this,n=this.hot.view._wt.getSetting("fixedColumnsStart");return function(r,o){var i,a=t.hot,l=a.columnIndexMapper,s=a.view,u=l.getVisualFromRenderableIndex(r);null===u&&(u=r),o.removeAttribute("colspan"),zt(o,"hiddenHeader");var c=null!==(i=F5(t,Y5).getHeaderSettings(e,u))&&void 0!==i?i:{label:""},f=c.colspan,h=c.isHidden,d=c.isPlaceholder;if(d||h)Ut(o,"hiddenHeader");else if(f>1){var p,y,v=s._wt.wtOverlays,g=null===(p=v.topInlineStartCornerOverlay)||void 0===p?void 0:p.clone.wtTable.THEAD.contains(o),m=null===(y=v.inlineStartOverlay)||void 0===y?void 0:y.clone.wtTable.THEAD.contains(o),b=g||m?Math.min(f,n-r):f;b>1&&o.setAttribute("colspan",b)}t.hot.view.appendColHeader(u,o,(function(){return t.getColumnHeaderValue.apply(t,arguments)}),e)}}},{key:"getColumnHeaderValue",value:function(e,t){var n,r=null!==(n=F5(this,Y5).getHeaderSettings(t,e))&&void 0!==n?n:{},o=r.isHidden,i=r.isPlaceholder;return i||o?"":this.hot.getColHeader(e,t)}},{key:"onBeforeHighlightingColumnHeader",value:function(e,t,n){var r=F5(this,Y5).getHeaderTreeNodeData(t,e);if(!r)return e;var o=n.classNames,i=n.columnCursor,a=n.selectionType,l=n.selectionWidth,s=F5(this,Y5).getHeaderSettings(t,e),u=s.isRoot,c=s.colspan;if(a===xb){if(!u)return r.columnIndex}else a===Mb&&(c>l-i||!u)&&(o.length=0);return e}},{key:"onBeforeCopy",value:function(e,t,n){var r=n.columnHeadersCount;if(0!==r)for(var o=0;o<t.length;o++){var i=t[o],a=i.startRow,l=i.startCol,s=i.endRow,u=i.endCol,c=s-a+1,f=l-u+1;if(a>=0||1===f)break;for(var h=l;h<=u;h++)for(var d=a;d<=s;d++){var p,y=c+d,v=h-l;if(0!==v){var g=null===(p=F5(this,Y5).getHeaderTreeNodeData(d,h))||void 0===p?void 0:p.isRoot;!1===g&&(e[y][v]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){var o=this._getHeaderTreeNodeDataByCoords(t);o&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(e,t){var n=this._getHeaderTreeNodeDataByCoords(t);if(n){var r=this.hot.selection,o=r.isSelected()?r.getSelectedRange().current():null,i=[],a=n.columnIndex,l=n.origColspan,s=!r.inInSelection(t);e.shiftKey&&o?t.col<o.from.col?i.push(o.getTopEndCorner().col,a,t.row):t.col>o.from.col?i.push(o.getTopStartCorner().col,a+l-1,t.row):i.push(a,a+l-1,t.row):(er(e)||Zn(e)&&s)&&i.push(a,a+l-1,t.row),r.selectColumns.apply(r,i)}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){var o;if(this.hot.view.isMouseDown()){var i=this._getHeaderTreeNodeDataByCoords(t);if(i){var a=i.columnIndex,l=i.origColspan,s=this.hot.getSelectedRangeLast(),u=s.getTopStartCorner(),c=s.getBottomEndCorner(),f=s.from;r.column=!0,r.cell=!0;var h=[];t.col<f.col?h.push(c.col,a):t.col>f.col?h.push(u.col,a+l-1):h.push(a,a+l-1),(o=this.hot).selectColumns.apply(o,h)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(e){e.length=0;for(var t=0;t<F5(this,Y5).getLayersCount();t++)e.push(this.headerRendererFactory(t))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){for(var t=F5(this,Y5).getLayersCount(),n=e.startColumn,r=!!t,o=0;o<t;o++){var i=F5(this,Y5).findLeftMostColumnIndex(o,e.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(i);if(i>=0&&(r=!1),bo(a)&&a<e.startColumn){n=a;break}}e.startColumn=r?F5(this,Y5).getHeaderTreeNodeData(0,n).columnIndex:n}},{key:"onModifyColWidth",value:function(e,t){var n=this.ghostTable.getWidth(t);return e>n?e:n}},{key:"onModifyColumnHeaderValue",value:function(e,t,n){var r,o=null!==(r=F5(this,Y5).getHeaderTreeNodeData(n,t))&&void 0!==r?r:{label:""},i=o.label;return i}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(e,t){t||this.updatePlugin()}},{key:"destroy",value:function(){B5(this,Y5,null),null!==F5(this,K5)&&(F5(this,K5).unsubscribe(),B5(this,K5,null)),T5(H5(n.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(e){if(!(e.row>=0||e.col<0))return F5(this,Y5).getHeaderTreeNodeData(e.row,e.col)}}],[{key:"PLUGIN_KEY",get:function(){return z5}},{key:"PLUGIN_PRIORITY",get:function(){return G5}}]),n}($A);function $5(e){return Z5(e)||J5(e)||Q5(e)||q5()}function q5(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Q5(e,t){if(e){if("string"===typeof e)return e4(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e4(e,t):void 0}}function J5(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Z5(e){if(Array.isArray(e))return e4(e)}function e4(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t4(e){return t4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t4(e)}function n4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o4(e,t,n){return t&&r4(e.prototype,t),n&&r4(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var i4=function(){function e(t,n){n4(this,e),this.hot=n,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return o4(e,[{key:"setData",value:function(e){this.data=e}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}},{key:"updateWithData",value:function(e){this.setData(e),this.rewriteCache()}},{key:"rewriteCache",value:function(){var e=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Co(0,this.data.length-1,(function(t){e.cacheNode(e.data[t],0,null)}))}},{key:"cacheNode",value:function(e,t,n){var r=this;this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&U(e.__children,(function(n){r.cacheNode(n,t+1,e)}))}},{key:"getDataObject",value:function(e){return null===e||void 0===e?null:this.cache.rows[e]}},{key:"readTreeNodes",value:function(e,t,n,r){var o=this,i=!1,a=t;if(isNaN(a)&&a.end)return a;var l=e;return l||(l={__children:this.data},i=!0,a-=1),null!==n&&void 0!==n&&a===n?{result:l,end:!0}:null!==r&&void 0!==r&&l===r?{result:a,end:!0}:(a+=1,l.__children&&U(l.__children,(function(e){if(o.parentReference.set(e,i?null:l),a=o.readTreeNodes(e,a,n,r),isNaN(a)&&a.end)return!1})),a)}},{key:"mockParent",value:function(){var e=this.mockNode();return e.__children=this.data,e}},{key:"mockNode",value:function(){var e={};return he(this.data[0],(function(t,n){e[n]=null})),e}},{key:"getRowIndex",value:function(e){return null===e||void 0===e?null:this.cache.nodeInfo.get(e).row}},{key:"getRowIndexWithinParent",value:function(e){var t=null;t=isNaN(e)?e:this.getDataObject(e);var n=this.getRowParent(e);return null===n||void 0===n?this.data.indexOf(t):n.__children.indexOf(t)}},{key:"countAllRows",value:function(){var e={__children:this.data};return this.countChildren(e)}},{key:"countChildren",value:function(e){var t=this,n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&r.__children?(U(r.__children,(function(e){n+=1,e.__children&&(n+=t.countChildren(e))})),n):0}},{key:"getRowParent",value:function(e){var t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}},{key:"getRowObjectParent",value:function(e){return e&&"object"===t4(e)?this.cache.nodeInfo.get(e).parent:null}},{key:"getRowLevel",value:function(e){var t=null;return t=isNaN(e)?e:this.getDataObject(e),t?this.getRowObjectLevel(t):null}},{key:"getRowObjectLevel",value:function(e){return null===e||void 0===e?null:this.cache.nodeInfo.get(e).level}},{key:"hasChildren",value:function(e){var t=e;return isNaN(t)||(t=this.getDataObject(t)),!(!t.__children||!t.__children.length)}},{key:"isChild",value:function(e){return null!==this.getRowParent(e)}},{key:"getChild",value:function(e,t){var n;return(null===(n=e.__children)||void 0===n?void 0:n[t])||null}},{key:"isRowHighestLevel",value:function(e){return!this.isChild(e)}},{key:"isParent",value:function(e){var t,n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(t=n.__children)||void 0===t?void 0:t.length)}},{key:"addChild",value:function(e,t){var n=t;this.hot.runHooks("beforeAddChild",e,n);var r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);var o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),n||(n=this.mockNode()),o.__children.push(n),this.rewriteCache();var i=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(i,1),this.hot.runHooks("afterCreateRow",i,1),this.hot.runHooks("afterAddChild",e,n)}},{key:"addChildAtIndex",value:function(e,t,n){var r,o=n;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",e,o,t),e){var i=this.getRowIndex(e),a=i+t+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(t,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),r=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[t]);o=this.getDataObject(r),this.hot.runHooks("afterAddChild",e,o,t)}},{key:"addSibling",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",n=this.translateTrimmedRow(e),r=this.getRowParent(n),o=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null);break;default:break}}},{key:"detachFromParent",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=null,o=[];Array.isArray(e)?(Co(e[0],e[2],(function(e){var n=t.translateTrimmedRow(e);o.push(t.getDataObject(n))})),Co(0,o.length-2,(function(e){t.detachFromParent(o[e],!1)})),r=o[o.length-1]):r=e;var i=this.getRowIndex(r),a=this.countChildren(r),l=this.getRowIndexWithinParent(r),s=this.getRowParent(r),u=this.getRowParent(s),c=this.getRowIndex(u),f=null;if(this.hot.runHooks("beforeDetachChild",s,r),null!==l&&void 0!==l){var h=Array.from(new Array(i+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",i,a+1,h,this.plugin.pluginName),s.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,a+1,h,this.plugin.pluginName),u){f=c+this.countChildren(u);var d=this.getChild(u,this.countChildren(u)-1),p=this.getRowIndex(d);this.hot.runHooks("beforeCreateRow",p+1,a+1,this.plugin.pluginName),u.__children.push(r)}else f=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",f-2,a+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",f-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",s,r,this.getRowIndex(r)),n&&this.hot.render()}},{key:"filterData",value:function(e,t,n){var r=this,o=[];U(n,(function(e){o.push(r.getDataObject(e))})),U(o,(function(e){var t=r.getRowIndexWithinParent(e),n=r.getRowParent(e);null===n?r.data.splice(t,1):n.__children.splice(t,1)})),this.rewriteCache()}},{key:"spliceData",value:function(e,t,n){var r,o=this.getDataObject(e-1),i=null,a=e;if(o&&o.__children&&0===o.__children.length?(i=o,a=0):e<this.countAllRows()&&(i=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),i)n?(r=i.__children).splice.apply(r,[a,t].concat($5(n))):i.__children.splice(a,t);else if(n){var l;(l=this.data).splice.apply(l,[a,t].concat($5(n)))}else this.data.splice(a,t);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(e){var t=e,n=null;do{n=this.getRowParent(n),null!==n&&(t=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(e,t,n,r){var o=t===this.hot.countRows(),i=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=i.__children.slice(a,a+1),s=e>t,u=o?this.getRowParent(t-1):this.getRowParent(t);null!==u&&void 0!==u||(u=this.getRowParent(t-1)),null!==u&&void 0!==u||(u=this.getDataObject(t-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(t),u.__children=[]);var c=o||n||r?u.__children.length:this.getRowIndexWithinParent(t),f=i===u;u.__children.splice(c,0,l[0]),i.__children.splice(a+(s&&f?1:0),1),this.syncRowWithRawSource(i),f||this.syncRowWithRawSource(u)}},{key:"translateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}},{key:"untranslateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}]),e}(),a4=i4;function l4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s4(e,t,n){return t&&l4(e.prototype,t),n&&l4(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c4=s4((function e(t,n){u4(this,e),this.hot=n,this.plugin=t})),f4=c4;function h4(e){return h4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h4(e)}function d4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y4(e,t,n){return t&&p4(e.prototype,t),n&&p4(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function v4(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g4(e,t)}function g4(e,t){return g4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g4(e,t)}function m4(e){var t=C4();return function(){var n,r=S4(e);if(t){var o=S4(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return b4(this,n)}}function b4(e,t){if(t&&("object"===h4(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return w4(e)}function w4(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C4(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function S4(e){return S4=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S4(e)}var O4=function(e){v4(n,e);var t=m4(n);function n(e,r){var o;return d4(this,n),o=t.call(this,e,r),o.dataManager=o.plugin.dataManager,o.collapsingUI=o.plugin.collapsingUI,o.rowHeaderWidthCache=null,o}return y4(n,[{key:"appendLevelIndicators",value:function(e,t){var r=this.hot.toPhysicalRow(e),o=this.dataManager.getRowLevel(r),i=this.dataManager.getDataObject(r),a=t.getElementsByTagName("DIV")[0],l=a.querySelector("span.rowHeader"),s=a.querySelectorAll('[class^="ht_nesting"]');if(U(s,(function(e){e&&a.removeChild(e)})),Ut(t,n.CSS_CLASSES.indicatorContainer),o){var u=this.hot.rootDocument,c=l.cloneNode(!0);a.innerHTML="",Co(0,o-1,(function(){var e=u.createElement("SPAN");Ut(e,n.CSS_CLASSES.emptyIndicator),a.appendChild(e)})),a.appendChild(c)}if(this.dataManager.hasChildren(i)){var f=this.hot.rootDocument.createElement("DIV");Ut(t,n.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?Ut(f,"".concat(n.CSS_CLASSES.button," ").concat(n.CSS_CLASSES.expandButton)):Ut(f,"".concat(n.CSS_CLASSES.button," ").concat(n.CSS_CLASSES.collapseButton)),a.appendChild(f)}}},{key:"updateRowHeaderWidth",value:function(e){var t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),n}(f4),k4=O4;function R4(e){return R4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R4(e)}function E4(e){return A4(e)||M4(e)||P4(e)||T4()}function T4(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function P4(e,t){if(e){if("string"===typeof e)return I4(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I4(e,t):void 0}}function M4(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function A4(e){if(Array.isArray(e))return I4(e)}function I4(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function j4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _4(e,t,n){return t&&x4(e.prototype,t),n&&x4(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function H4(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D4(e,t)}function D4(e,t){return D4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},D4(e,t)}function N4(e){var t=V4();return function(){var n,r=F4(e);if(t){var o=F4(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return L4(this,n)}}function L4(e,t){if(t&&("object"===R4(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return B4(e)}function B4(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V4(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function F4(e){return F4=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},F4(e)}var W4=function(e){H4(n,e);var t=N4(n);function n(e,r){var o;return j4(this,n),o=t.call(this,e,r),o.dataManager=o.plugin.dataManager,o.collapsedRows=[],o.collapsedRowsStash={stash:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,e)},shiftStash:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==t&&void 0!==t||(t=1/0),U(o.lastCollapsedRows,(function(r,i){r>=e&&r<t&&(o.lastCollapsedRows[i]=r+n)}))},applyStash:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o.collapseMultipleChildren(o.lastCollapsedRows,e),o.lastCollapsedRows=void 0},trimStash:function(e,t){Co(e,e+t-1,(function(e){var t=o.lastCollapsedRows.indexOf(e);t>-1&&o.lastCollapsedRows.splice(t,1)}))}},o}return _4(n,[{key:"collapseChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,l=null;return isNaN(e)?(i=e,a=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(i)&&U(i.__children,(function(e){o.push(t.dataManager.getRowIndex(e))})),l=this.collapseRows(o,!0,!1),r&&this.trimRows(l),n&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(a)&&this.collapsedRows.push(a),l}},{key:"collapseMultipleChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];U(e,(function(e){o.push.apply(o,E4(t.collapseChildren(e,!1,!1)))})),r&&this.trimRows(o),n&&this.renderAndAdjust()}},{key:"collapseRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([e],t)}},{key:"collapseRows",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return U(e,(function(e){o.push(e),n&&t.collapseChildRows(e,o)})),r&&this.trimRows(o),o}},{key:"collapseChildRows",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){var o=this.dataManager.getDataObject(e);U(o.__children,(function(e){var r=t.dataManager.getRowIndex(e);n.push(r),t.collapseChildRows(r,n)}))}r&&this.trimRows(n)}},{key:"expandRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([e],t)}},{key:"expandRows",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return U(e,(function(e){o.push(e),n&&t.expandChildRows(e,o)})),r&&this.untrimRows(o),o}},{key:"expandChildRows",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){var o=this.dataManager.getDataObject(e);U(o.__children,(function(e){if(!t.isAnyParentCollapsed(e)){var r=t.dataManager.getRowIndex(e);n.push(r),t.expandChildRows(r,n)}}))}r&&this.untrimRows(n)}},{key:"expandChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,l=null;return isNaN(e)?(i=e,a=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(i)&&U(i.__children,(function(e){var n=t.dataManager.getRowIndex(e);o.push(n)})),l=this.expandRows(o,!0,!1),r&&this.untrimRows(l),n&&this.renderAndAdjust(),l}},{key:"expandMultipleChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];U(e,(function(e){o.push.apply(o,E4(t.expandChildren(e,!1,!1)))})),r&&this.untrimRows(o),n&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var e=this,t=this.dataManager.getData(),n=[];U(t,(function(t){e.dataManager.hasChildren(t)&&n.push(t)})),this.collapseMultipleChildren(n),this.renderAndAdjust()}},{key:"expandAll",value:function(){var e=this,t=this.dataManager.getData(),n=[];U(t,(function(t){e.dataManager.hasChildren(t)&&n.push(t)})),this.expandMultipleChildren(n),this.renderAndAdjust()}},{key:"trimRows",value:function(e){var t=this;this.hot.batchExecution((function(){U(e,(function(e){t.plugin.collapsedRowsMap.setValueAtIndex(e,!0)}))}),!0)}},{key:"untrimRows",value:function(e){var t=this;this.hot.batchExecution((function(){U(e,(function(e){t.plugin.collapsedRowsMap.setValueAtIndex(e,!1)}))}),!0)}},{key:"areChildrenCollapsed",value:function(e){var t=this,n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return null===n&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&U(n.__children,(function(e){var n=t.dataManager.getRowIndex(e);if(!t.plugin.collapsedRowsMap.getValueAtIndex(n))return r=!1,!1})),r}},{key:"isAnyParentCollapsed",value:function(e){var t=e;while(null!==t){t=this.dataManager.getRowParent(t);var n=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}},{key:"toggleState",value:function(e,t){if(!(t.col>=0)){var n=this.translateTrimmedRow(t.row);Wt(e.target,k4.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Qn(e))}}},{key:"translateTrimmedRow",value:function(e){return this.hot.toPhysicalRow(e)}},{key:"untranslateTrimmedRow",value:function(e){return this.hot.toVisualRow(e)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),n}(f4),U4=W4;function z4(e){return z4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z4(e)}function G4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K4(e,t,n){return t&&Y4(e.prototype,t),n&&Y4(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function X4(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$4(e,t)}function $4(e,t){return $4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$4(e,t)}function q4(e){var t=Z4();return function(){var n,r=e9(e);if(t){var o=e9(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Q4(this,n)}}function Q4(e,t){if(t&&("object"===z4(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return J4(e)}function J4(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z4(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function e9(e){return e9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e9(e)}var t9,n9=new WeakMap,r9=function(e){X4(n,e);var t=q4(n);function n(e,r){var o;return G4(this,n),o=t.call(this,e,r),n9.set(J4(o),{row_above:function(e,t){var n=t[t.length-1];o.dataManager.addSibling(n.start.row,"above")},row_below:function(e,t){var n=t[t.length-1];o.dataManager.addSibling(n.start.row,"below")}}),o.dataManager=o.plugin.dataManager,o}return K4(n,[{key:"appendOptions",value:function(e){var t=this,n=[{key:"add_child",name:function(){return this.getTranslatedPhrase(Rm)},callback:function(){var e=t.dataManager.translateTrimmedRow(t.hot.getSelectedLast()[0]),n=t.dataManager.getDataObject(e);t.dataManager.addChild(n)},disabled:function(){var e=t.hot.getSelectedLast();return!e||e[0]<0||t.hot.selection.isSelectedByColumnHeader()||t.hot.countRows()>=t.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(Em)},callback:function(){t.dataManager.detachFromParent(t.hot.getSelectedLast())},disabled:function(){var e=t.hot.getSelectedLast(),n=t.dataManager.translateTrimmedRow(e[0]),r=t.dataManager.getRowParent(n);return!r||!e||e[0]<0||t.hot.selection.isSelectedByColumnHeader()||t.hot.countRows()>=t.hot.getSettings().maxRows}},{name:"---------"}];return Co(0,e.items.length-1,(function(t){if(0===t)return U(n,(function(n,r){e.items.splice(t+r,0,n)})),!1})),this.modifyRowInsertingOptions(e)}},{key:"modifyRowInsertingOptions",value:function(e){var t=n9.get(this);return Co(0,e.items.length-1,(function(n){var r=t[e.items[n].key];null!==r&&void 0!==r&&(e.items[n].callback=r)})),e}}]),n}(f4),o9=r9;function i9(e){return u9(e)||s9(e)||l9(e)||a9()}function a9(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l9(e,t){if(e){if("string"===typeof e)return c9(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c9(e,t):void 0}}function s9(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function u9(e){if(Array.isArray(e))return c9(e)}function c9(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f9(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function h9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p9(e,t,n){return t&&d9(e.prototype,t),n&&d9(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var y9=function(){function e(t){h9(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return p9(e,[{key:"onBeforeRowMove",value:function(e,t,n,r){var o=this,i=this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:n,movePossible:r});if(i)return!1;this.movedToCollapsed=!1;var a=n===this.hot.countRows(),l=a?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n),s=!0,u=e.map((function(e){if(!s)return!1;var t=o.dataManager.translateTrimmedRow(e);return s=o.shouldAllowMoving(t,l),t})),c=-1===u.indexOf(l);if(!s||!c)return!1;var f=this.getBaseParent(u),h=this.getTargetParent(a,l),d=f===h;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(h),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,l,d),this.moveRows(u,l,h),this.dataManager.rewriteCache(),this.moveCellsMeta(u,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,n,r,r&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,n),!1}},{key:"displayAPICompatibilityWarning",value:function(e){var t=e.rows,n=e.finalIndex,r=e.dropIndex,o=e.movePossible,i=!1;return Je(r)&&(Fn(Ke(t9||(t9=f9(["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows \n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."],["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20\n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."])))),this.hot.runHooks("afterRowMove",t,n,r,o,!1),i=!0),i}},{key:"shouldAllowMoving",value:function(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}},{key:"getBaseParent",value:function(e){return this.dataManager.getRowParent(e[0])}},{key:"getTargetParent",value:function(e,t){var n=this.dataManager.getRowParent(e?t-1:t);return null!==n&&void 0!==n||(n=this.dataManager.getRowParent(t-1)),n}},{key:"shiftCollapsibleParentsLocations",value:function(e,t,n){n||(Math.max.apply(Math,i9(e))<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}},{key:"moveRows",value:function(e,t,n){var r=this,o=t===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender((function(){e.forEach((function(e){r.dataManager.moveRow(e,t,r.movedToCollapsed,o)}))}))}},{key:"moveCellsMeta",value:function(e,t){var n,r=this,o=[],i=Math.max.apply(Math,i9(e))<t;e.forEach((function(e){o.push(r.hot.getCellMetaAtRow(e))})),this.hot.spliceCellsMeta(e[0],e.length),(n=this.hot).spliceCellsMeta.apply(n,[t-(i?o.length:0),0].concat(o))}},{key:"selectCells",value:function(e,t){var n=e.length,r=0,o=0,i=null,a=null;if(this.movedToCollapsed){var l=null;l=e[n-1]<t?this.dataManager.translateTrimmedRow(t-n):this.dataManager.translateTrimmedRow(t);var s=this.dataManager.getRowParent(null===l?this.hot.countSourceRows()-1:l-1),u=this.dataManager.getRowIndex(s);r=this.dataManager.untranslateTrimmedRow(u),o=r}else e[n-1]<t?(o=t-1,r=o-n+1):(r=t,o=r+n-1);i=this.hot.selection,a=this.hot.countCols()-1,i.setRangeStart(this.hot._createCellCoords(r,0)),i.setRangeEnd(this.hot._createCellCoords(o,a),!0)}},{key:"isRowOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}}]),e}();function v9(e){return v9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v9(e)}function g9(e){return C9(e)||w9(e)||b9(e)||m9()}function m9(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b9(e,t){if(e){if("string"===typeof e)return S9(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S9(e,t):void 0}}function w9(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function C9(e){if(Array.isArray(e))return S9(e)}function S9(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R9(e,t,n){return t&&k9(e.prototype,t),n&&k9(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function E9(){return E9="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=T9(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},E9.apply(this,arguments)}function T9(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=_9(e),null===e)break;return e}function P9(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M9(e,t)}function M9(e,t){return M9=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},M9(e,t)}function A9(e){var t=x9();return function(){var n,r=_9(e);if(t){var o=_9(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return I9(this,n)}}function I9(e,t){if(t&&("object"===v9(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return j9(e)}function j9(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x9(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _9(e){return _9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_9(e)}var H9="nestedRows",D9=300,N9=new WeakMap,L9="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",B9=function(e){P9(n,e);var t=A9(n);function n(e){var r;return O9(this,n),r=t.call(this,e),r.dataManager=null,r.headersUI=null,r.collapsedRowsMap=null,N9.set(j9(r),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),r}return R9(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[H9]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new mv),this.dataManager=new a4(this,this.hot),this.collapsingUI=new U4(this,this.hot),this.headersUI=new k4(this,this.hot),this.contextMenuUI=new o9(this,this.hot),this.rowMoveController=new y9(this),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("beforeViewRender",(function(){return e.onBeforeViewRender.apply(e,arguments)})),this.addHook("modifyRowData",(function(){return e.onModifyRowData.apply(e,arguments)})),this.addHook("modifySourceLength",(function(){return e.onModifySourceLength.apply(e,arguments)})),this.addHook("beforeDataSplice",(function(){return e.onBeforeDataSplice.apply(e,arguments)})),this.addHook("filterData",(function(){return e.onFilterData.apply(e,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetRowHeader",(function(){return e.onAfterGetRowHeader.apply(e,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeRemoveRow",(function(){return e.onBeforeRemoveRow.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("beforeAddChild",(function(){return e.onBeforeAddChild.apply(e,arguments)})),this.addHook("afterAddChild",(function(){return e.onAfterAddChild.apply(e,arguments)})),this.addHook("beforeDetachChild",(function(){return e.onBeforeDetachChild.apply(e,arguments)})),this.addHook("afterDetachChild",(function(){return e.onAfterDetachChild.apply(e,arguments)})),this.addHook("modifyRowHeaderWidth",(function(){return e.onModifyRowHeaderWidth.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("beforeRowMove",(function(){return e.onBeforeRowMove.apply(e,arguments)})),this.addHook("beforeLoadData",(function(t){return e.onBeforeLoadData(t)})),this.addHook("beforeUpdateData",(function(t){return e.onBeforeLoadData(t)})),E9(_9(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),E9(_9(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),E9(_9(n.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(e,t,n,r){return this.rowMoveController.onBeforeRowMove(e,t,n,r)}},{key:"disableCoreAPIModifiers",value:function(){var e=N9.get(this);e.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var e=N9.get(this);e.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n){this.collapsingUI.toggleState(e,t,n)}},{key:"onModifyRowData",value:function(e){var t=N9.get(this);if(!t.skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}},{key:"onModifySourceLength",value:function(){var e=N9.get(this);if(!e.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(e,t,n){var r=N9.get(this);return!(!r.skipCoreAPIModifiers&&!this.dataManager.isRowHighestLevel(e))||(this.dataManager.spliceData(e,t,n),!1)}},{key:"onFilterData",value:function(e,t,n){var r=N9.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*t),this.dataManager.filterData(e,t,n),r.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(e){return this.contextMenuUI.appendOptions(e)}},{key:"onAfterGetRowHeader",value:function(e,t){this.headersUI.appendLevelIndicators(e,t)}},{key:"onModifyRowHeaderWidth",value:function(e){return this.headersUI.rowHeaderWidthCache||e}},{key:"onAfterRemoveRow",value:function(e,t,n,r){var o=this;if(r!==this.pluginName){var i=N9.get(this);setTimeout((function(){i.skipRender=null,o.headersUI.updateRowHeaderWidth(),o.collapsingUI.collapsedRowsStash.applyStash()}),0)}}},{key:"onBeforeRemoveRow",value:function(e,t,n){var r=this,o=Array.from(n.reduce((function(e,t){if(r.dataManager.isParent(t)){var n=r.dataManager.getDataObject(t).__children;return e.add(t),Array.isArray(n)&&n.forEach((function(t){return e.add(r.dataManager.getRowIndex(t))})),e}return e.add(t)}),new Set));n.length=0,n.push.apply(n,o)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(e,t,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var e=Math.max.apply(Math,g9(this.dataManager.cache.levels));e>0&&this.headersUI.updateRowHeaderWidth(e)}},{key:"onBeforeViewRender",value:function(e,t){var n=N9.get(this);n.skipRender&&(t.skipRender=!0)}},{key:"destroy",value:function(){E9(_9(n.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(e){if(!Op(e))return Wn(L9),this.hot.getSettings()[H9]=!1,void this.disablePlugin();this.dataManager.setData(e),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return H9}},{key:"PLUGIN_PRIORITY",get:function(){return D9}}]),n}($A);function V9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W9(e,t,n){return t&&F9(e.prototype,t),n&&F9(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var U9=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;V9(this,e),this.rootWindow=n,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return W9(e,[{key:"saveValue",value:function(e,t){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(e),JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}},{key:"loadValue",value:function(e,t){var n="undefined"===typeof e?t:e,r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(n));return null===r?void 0:JSON.parse(r)}},{key:"reset",value:function(e){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(e))}},{key:"resetAll",value:function(){var e=this;U(this.savedKeys,(function(t,n){e.rootWindow.localStorage.removeItem("".concat(e.prefix,"_").concat(e.savedKeys[n]))})),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var e=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),t="string"===typeof e?JSON.parse(e):void 0;this.savedKeys=t||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}(),z9=U9;function G9(e){return G9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G9(e)}function Y9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X9(e,t,n){return t&&K9(e.prototype,t),n&&K9(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function $9(){return $9="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=q9(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},$9.apply(this,arguments)}function q9(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=r7(e),null===e)break;return e}function Q9(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J9(e,t)}function J9(e,t){return J9=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},J9(e,t)}function Z9(e){var t=n7();return function(){var n,r=r7(e);if(t){var o=r7(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return e7(this,n)}}function e7(e,t){if(t&&("object"===G9(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return t7(e)}function t7(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function n7(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function r7(e){return r7=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r7(e)}hr.getSingleton().register("persistentStateSave"),hr.getSingleton().register("persistentStateLoad"),hr.getSingleton().register("persistentStateReset");var o7="persistentState",i7=0,a7=function(e){Q9(n,e);var t=Z9(n);function n(e){var r;return Y9(this,n),r=t.call(this,e),r.storage=void 0,r}return X9(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[o7]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.storage||(this.storage=new z9(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(function(t,n){return e.saveValue(t,n)})),this.addHook("persistentStateLoad",(function(t,n){return e.loadValue(t,n)})),this.addHook("persistentStateReset",(function(){return e.resetValue()})),$9(r7(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,$9(r7(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),$9(r7(n.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(e,t){t.value=this.storage.loadValue(e)}},{key:"saveValue",value:function(e,t){this.storage.saveValue(e,t)}},{key:"resetValue",value:function(e){"undefined"===typeof e?this.storage.resetAll():this.storage.reset(e)}},{key:"destroy",value:function(){$9(r7(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return o7}},{key:"PLUGIN_PRIORITY",get:function(){return i7}}]),n}($A);function l7(e){return l7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l7(e)}function s7(e){return h7(e)||f7(e)||c7(e)||u7()}function u7(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c7(e,t){if(e){if("string"===typeof e)return d7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d7(e,t):void 0}}function f7(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function h7(e){if(Array.isArray(e))return d7(e)}function d7(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v7(e,t,n){return t&&y7(e.prototype,t),n&&y7(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function g7(){return g7="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=m7(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},g7.apply(this,arguments)}function m7(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=R7(e),null===e)break;return e}function b7(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w7(e,t)}function w7(e,t){return w7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w7(e,t)}function C7(e){var t=k7();return function(){var n,r=R7(e);if(t){var o=R7(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S7(this,n)}}function S7(e,t){if(t&&("object"===l7(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return O7(e)}function O7(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k7(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function R7(e){return R7=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R7(e)}var E7="search",T7=190,P7="htSearchResult",M7=function(e,t,n,r,o){e.getCellMeta(t,n).isSearchResult=o},A7=function(e,t,n){return!(Je(e)||null===e||!e.toLocaleLowerCase||0===e.length)&&(!Je(t)&&null!==t&&-1!==t.toString().toLocaleLowerCase(n.locale).indexOf(e.toLocaleLowerCase(n.locale)))},I7=function(e){b7(n,e);var t=C7(n);function n(e){var r;return p7(this,n),r=t.call(this,e),r.callback=M7,r.queryMethod=A7,r.searchResultClass=P7,r}return v7(n,[{key:"isEnabled",value:function(){return this.hot.getSettings()[E7]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings()[E7];this.updatePluginSettings(t),this.addHook("beforeRenderer",(function(){return e.onBeforeRenderer.apply(e,arguments)})),g7(R7(n.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var e=this,t=function(){return e.onBeforeRenderer.apply(e,arguments)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",(function(){e.hot.removeHook("beforeRenderer",t)})),g7(R7(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),g7(R7(n.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),o=this.hot.countRows(),i=this.hot.countCols(),a=[],l=this.hot;return Co(0,o-1,(function(o){Co(0,i-1,(function(i){var s=t.hot.getDataAtCell(o,i),u=t.hot.getCellMeta(o,i),c=u.search.callback||n,f=u.search.queryMethod||r,h=f(e,s,u);if(h){var d={row:o,col:i,data:s};a.push(d)}c&&c(l,o,i,s,h)}))})),a}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(e){this.callback=e}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(e){this.queryMethod=e}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(e){this.searchResultClass=e}},{key:"updatePluginSettings",value:function(e){ce(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}},{key:"onBeforeRenderer",value:function(e,t,n,r,o,i){var a,l=i.className||[],s=[];"string"===typeof l?s=l.split(" "):(a=s).push.apply(a,s7(l));this.isEnabled()&&i.isSearchResult?s.includes(this.searchResultClass)||s.push("".concat(this.searchResultClass)):s.includes(this.searchResultClass)&&s.splice(s.indexOf(this.searchResultClass),1),i.className=s.join(" ")}},{key:"destroy",value:function(){g7(R7(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return E7}},{key:"PLUGIN_PRIORITY",get:function(){return T7}}]),n}($A);function j7(e){return j7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j7(e)}function x7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H7(e,t,n){return t&&_7(e.prototype,t),n&&_7(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function D7(){return D7="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=N7(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},D7.apply(this,arguments)}function N7(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=z7(e),null===e)break;return e}function L7(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B7(e,t)}function B7(e,t){return B7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},B7(e,t)}function V7(e){var t=U7();return function(){var n,r=z7(e);if(t){var o=z7(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return F7(this,n)}}function F7(e,t){if(t&&("object"===j7(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return W7(e)}function W7(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U7(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function z7(e){return z7=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},z7(e)}var G7="touchScroll",Y7=200,K7=function(e){L7(n,e);var t=V7(n);function n(e){var r;return x7(this,n),r=t.call(this,e),r.scrollbars=[],r.clones=[],r.lockedCollection=!1,r.freezeOverlays=!1,r}return H7(n,[{key:"isEnabled",value:function(){return j()}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterViewRender",(function(){return e.onAfterViewRender()})),this.registerEvents(),D7(z7(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,D7(z7(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){D7(z7(n.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.addHook("beforeTouchScroll",(function(){return e.onBeforeTouchScroll()})),this.addHook("afterMomentumScroll",(function(){return e.onAfterMomentumScroll()}))}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var e=this.hot.view._wt.wtOverlays,t=e.topOverlay,n=e.bottomOverlay,r=e.inlineStartOverlay,o=e.topInlineStartCornerOverlay,i=e.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),n.clone&&this.scrollbars.push(n),this.scrollbars.push(r),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,U(this.clones,(function(e){Ut(e,"hide-tween")}))}},{key:"onAfterMomentumScroll",value:function(){var e=this;this.freezeOverlays=!1,U(this.clones,(function(e){zt(e,"hide-tween"),Ut(e,"show-tween")})),this.hot._registerTimeout((function(){U(e.clones,(function(e){zt(e,"show-tween")}))}),400),U(this.scrollbars,(function(e){e.refresh(),e.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return G7}},{key:"PLUGIN_PRIORITY",get:function(){return Y7}},{key:"SETTING_KEYS",get:function(){return!0}}]),n}($A);function X7(e){return X7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X7(e)}function $7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Q7(e,t,n){return t&&q7(e.prototype,t),n&&q7(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function J7(){return J7="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Z7(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},J7.apply(this,arguments)}function Z7(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=aee(e),null===e)break;return e}function eee(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tee(e,t)}function tee(e,t){return tee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},tee(e,t)}function nee(e){var t=iee();return function(){var n,r=aee(e);if(t){var o=aee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ree(this,n)}}function ree(e,t){if(t&&("object"===X7(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return oee(e)}function oee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iee(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function aee(e){return aee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},aee(e)}var lee="trimRows",see=330,uee=function(e){eee(n,e);var t=nee(n);function n(e){var r;return $7(this,n),r=t.call(this,e),r.trimmedRowsMap=null,r}return Q7(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[lee]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new mv),this.trimmedRowsMap.addLocalHook("init",(function(){return e.onMapInit()})),J7(aee(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var e=this,t=this.hot.getSettings()[lee];Array.isArray(t)&&this.hot.batchExecution((function(){e.trimmedRowsMap.clear(),U(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),J7(aee(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),J7(aee(n.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(e){var t=this,n=this.getTrimmedRows(),r=this.isValidConfig(e),o=n;r&&(o=Array.from(new Set(n.concat(e))));var i=this.hot.runHooks("beforeTrimRow",n,o,r);!1!==i&&(r&&this.hot.batchExecution((function(){U(e,(function(e){t.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),this.hot.runHooks("afterTrimRow",n,o,r,r&&o.length>n.length))}},{key:"trimRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}},{key:"untrimRows",value:function(e){var t=this.getTrimmedRows(),n=this.isValidConfig(e),r=t,o=this.trimmedRowsMap.getValues().slice(),i=e.length>0;n&&i&&(U(e,(function(e){o[e]=!1})),r=V(o,(function(e,t,n){return t&&e.push(n),e}),[]));var a=this.hot.runHooks("beforeUntrimRow",t,r,n&&i);!1!==a&&(n&&i&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",t,r,n&&i,n&&r.length<t.length))}},{key:"untrimRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}},{key:"isTrimmed",value:function(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(e){var t=this.hot.countSourceRows();return e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"onMapInit",value:function(){var e=this,t=this.hot.getSettings()[lee];Array.isArray(t)&&this.hot.batchExecution((function(){U(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0)}},{key:"destroy",value:function(){J7(aee(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return lee}},{key:"PLUGIN_PRIORITY",get:function(){return see}}]),n}($A);function cee(e){return cee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cee(e)}function fee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dee(e,t,n){return t&&hee(e.prototype,t),n&&hee(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function pee(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yee(e,t)}function yee(e,t){return yee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yee(e,t)}function vee(e){var t=bee();return function(){var n,r=wee(e);if(t){var o=wee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gee(this,n)}}function gee(e,t){if(t&&("object"===cee(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return mee(e)}function mee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bee(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function wee(e){return wee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wee(e)}function Cee(e){return kee(e)||Oee(e)||Tee(e)||See()}function See(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Oee(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function kee(e){if(Array.isArray(e))return Pee(e)}function Ree(e,t){return Aee(e)||Mee(e,t)||Tee(e,t)||Eee()}function Eee(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Tee(e,t){if(e){if("string"===typeof e)return Pee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pee(e,t):void 0}}function Pee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Mee(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0)if(i.push(r.value),t&&i.length===t)break}catch(s){l=!0,o=s}finally{try{a||null==n["return"]||n["return"]()}finally{if(l)throw o}}return i}}function Aee(e){if(Array.isArray(e))return e}var Iee="undoRedo",jee="undoRedo";function xee(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",(function(n,r){var o=this,i=n&&n.length;if(i){var a=n.find((function(e){var t=Ree(e,4),n=t[2],r=t[3];return n!==r}));if(a){var l=function(){var t=n.reduce((function(e,t){return e.push(Cee(t)),e}),[]);U(t,(function(t){t[1]=e.propToCol(t[1])}));var r=i>1?o.getSelected():[[t[0][0],t[0][1]]];return new xee.ChangeAction(t,r)};t.done(l,r)}}})),e.addHook("afterCreateRow",(function(e,n,r){t.done((function(){return new xee.CreateRowAction(e,n)}),r)})),e.addHook("beforeRemoveRow",(function(n,r,o,i){var a=function(){var o=e.toPhysicalRow(n),i=ae(t.instance.getSourceData(o,0,o+r-1,t.instance.countSourceCols()-1));return new xee.RemoveRowAction(o,i,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(a,i)})),e.addHook("afterCreateCol",(function(e,n,r){t.done((function(){return new xee.CreateColumnAction(e,n)}),r)})),e.addHook("beforeRemoveCol",(function(n,r,o,i){var a=function(){var o=t.instance.getSourceDataArray(),i=(t.instance.countCols()+n)%t.instance.countCols(),a=[],l=[],s=[];Co(o.length-1,(function(t){var n=[],l=o[t];Co(i,i+(r-1),(function(t){n.push(l[e.toPhysicalColumn(t)])})),a.push(n)})),Co(r-1,(function(t){s.push(e.toPhysicalColumn(i+t))})),Array.isArray(e.getSettings().colHeaders)&&Co(r-1,(function(t){l.push(e.getSettings().colHeaders[e.toPhysicalColumn(i+t)]||null)}));var u=e.columnIndexMapper.getIndexesSequence(),c=e.rowIndexMapper.getIndexesSequence();return new xee.RemoveColumnAction(i,s,a,l,u,c,e.getSettings().fixedColumnsStart)};t.done(a,i)})),e.addHook("beforeCellAlignment",(function(e,n,r,o){t.done((function(){return new xee.CellAlignmentAction(e,n,r,o)}))})),e.addHook("beforeFilter",(function(e){t.done((function(){return new xee.FiltersAction(e)}))})),e.addHook("beforeRowMove",(function(e,n){!1!==e&&t.done((function(){return new xee.RowMoveAction(e,n)}))})),e.addHook("beforeMergeCells",(function(n,r){r||t.done((function(){return new xee.MergeCellsAction(e,n)}))})),e.addHook("afterUnmergeCells",(function(n,r){r||t.done((function(){return new xee.UnmergeCellsAction(e,n)}))})),e.addHook("afterInit",(function(){t.init()}))}xee.prototype.done=function(e,t){if(!this.ignoreNewActions){var n="UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t;if(!n){var r=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",r,t);if(!1!==o){var i=e(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}},xee.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var n=ae(t),r=this.instance.runHooks("beforeUndo",n);if(!1===r)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,(function(){o.ignoreNewActions=!1,o.undoneActions.push(t)})),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}},xee.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var n=ae(t),r=this.instance.runHooks("beforeRedo",n);if(!1===r)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,(function(){o.ignoreNewActions=!1,o.doneActions.push(t)})),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}},xee.prototype.isUndoAvailable=function(){return this.doneActions.length>0},xee.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},xee.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},xee.prototype.isEnabled=function(){return this.enabled},xee.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,Nee(e),this.registerShortcuts(),e.addHook("afterChange",Dee)}},xee.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,Lee(e),this.unregisterShortcuts(),e.removeHook("afterChange",Dee)}},xee.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},xee.Action=function(){},xee.Action.prototype.undo=function(){},xee.Action.prototype.redo=function(){},xee.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"},re(xee.ChangeAction,xee.Action),xee.ChangeAction.prototype.undo=function(e,t){for(var n=ae(this.changes),r=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=n.length;i<a;i++)n[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.undo");for(var l=0,s=n.length;l<s;l++){var u=Ree(n[l],2),c=u[0],f=u[1];e.getSettings().minSpareRows&&c+1+e.getSettings().minSpareRows===e.countRows()&&r===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(c+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&f+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(f+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)},xee.ChangeAction.prototype.redo=function(e,t){for(var n=ae(this.changes),r=0,o=n.length;r<o;r++)n[r].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)},xee.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},re(xee.CreateRowAction,xee.Action),xee.CreateRowAction.prototype.undo=function(e,t){var n=e.countRows(),r=e.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},xee.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},xee.RemoveRowAction=function(e,t,n,r,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=o},re(xee.RemoveRowAction,xee.Action),xee.RemoveRowAction.prototype.undo=function(e,t){var n=this,r=e.getSettings(),o=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((function(e,t){Object.keys(e).forEach((function(r){var i=parseInt(r,10);o.push([n.index+t,isNaN(i)?r:i,e[r]])}))})),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},xee.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},xee.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},re(xee.CreateColumnAction,xee.Action),xee.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},xee.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},xee.RemoveColumnAction=function(e,t,n,r,o,i,a){this.index=e,this.indexes=t,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a},re(xee.RemoveColumnAction,xee.Action),xee.RemoveColumnAction.prototype.undo=function(e,t){var n=this,r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(e,t,r){return r[n.indexes.indexOf(o[t])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(W(this.data[s],i));var u=W(this.headers,i),c=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),U(e.getSourceDataArray(),(function(e,t){U(o,(function(n,r){e[n]=l[t][r],c.push([t,n,e[n]])}))})),e.setSourceDataAtCell(c,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(o[0],o.length),"undefined"!==typeof this.headers&&U(u,(function(t,n){e.getSettings().colHeaders[o[n]]=t})),e.batchExecution((function(){e.rowIndexMapper.setIndexesSequence(n.rowPositions),e.columnIndexMapper.setIndexesSequence(n.columnPositions)}),!0),e.addHookOnce("afterViewRender",t),e.render()},xee.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},xee.CellAlignmentAction=function(e,t,n,r){this.stateBefore=e,this.range=t,this.type=n,this.alignment=r},xee.CellAlignmentAction.prototype.undo=function(e,t){var n=this;U(this.range,(function(t){t.forAll((function(t,r){t>=0&&r>=0&&e.setCellMeta(t,r,"className",n.stateBefore[t][r]||" htLeft")}))})),e.addHookOnce("afterViewRender",t),e.render()},xee.CellAlignmentAction.prototype.redo=function(e,t){JD(this.range,this.type,this.alignment,(function(t,n){return e.getCellMeta(t,n)}),(function(t,n,r,o){return e.setCellMeta(t,n,r,o)})),e.addHookOnce("afterViewRender",t),e.render()},xee.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"},re(xee.FiltersAction,xee.Action),xee.FiltersAction.prototype.undo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},xee.FiltersAction.prototype.redo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};var _ee=function(e){pee(n,e);var t=vee(n);function n(e,r){var o;fee(this,n),o=t.call(this),o.cellRange=r;var i=o.cellRange.getTopStartCorner(),a=o.cellRange.getBottomEndCorner();return o.rangeData=e.getData(i.row,i.col,a.row,a.col),o}return dee(n,[{key:"undo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0);var r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange)}}]),n}(xee.Action);xee.MergeCellsAction=_ee;var Hee=function(e){pee(n,e);var t=vee(n);function n(e,r){var o;return fee(this,n),o=t.call(this),o.cellRange=r,o}return dee(n,[{key:"undo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0),e.render()}}]),n}(xee.Action);function Dee(e,t){var n=this;if("loadData"===t)return n.undoRedo.clear()}function Nee(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function Lee(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}xee.UnmergeCellsAction=Hee,xee.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"},re(xee.RowMoveAction,xee.Action),xee.RowMoveAction.prototype.undo=function(e,t){var n=this,r=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter((function(e){return e>n.finalIndex})),a=o.filter((function(e){return e<=n.finalIndex})),l=i.sort((function(e,t){return t-e})).concat(a.sort((function(e,t){return e-t})));e.addHookOnce("afterViewRender",t);for(var s=0;s<l.length;s+=1){var u=e.toVisualRow(l[s]);r.moveRow(u,l[s])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},xee.RowMoveAction.prototype.redo=function(e,t){var n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),n.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},xee.prototype.init=function(){var e=this.instance.getSettings().undo,t="undefined"===typeof e||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},xee.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),n=t.getContext("grid"),r=function(e){return!e.altKey},o={runOnlyIf:r,group:Iee};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],o)},xee.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(Iee)};var Bee=hr.getSingleton();Bee.add("afterUpdateSettings",(function(){var e;null===(e=this.getPlugin("undoRedo"))||void 0===e||e.init()})),Bee.register("beforeUndo"),Bee.register("afterUndo"),Bee.register("beforeRedo"),Bee.register("afterRedo"),xee.PLUGIN_KEY=jee,xee.SETTING_KEYS=!0;var Vee,Fee,Wee,Uee,zee,Gee=xee;function Yee(){Ri(NI),Ri(vj),Ri(Bj),Ri(Kx),Ri(T_),Ri(fD),Ri(HD),Ri(HN),Ri(hB),Ri($V),Ri(LF),Ri(eW),Ri(gW),Ri(dU),Ri(q$),Ri(iQ),Ri(zQ),Ri(MJ),Ri(aZ),Ri(p0),Ri(j0),Ri(V1),Ri(s2),Ri(v3),Ri(Y3),Ri(s8),Ri(X5),Ri(B9),Ri(a7),Ri(I7),Ri(K7),Ri(uee),Ri(Gee)}function Kee(){TM(),eA(),dA(),AA(),Yee()}function Xee(e){var t="undefined"!==typeof window&&window.jQuery;t&&(t.fn.handsontable=function(t){var n,r=this.first(),o=r.data("handsontable");if("string"!==typeof t){var i=t||{};return o?o.updateSettings(i):(o=new e.Core(r[0],i),r.data("handsontable",o),o.init()),r}if(o){if("undefined"===typeof o[t])throw new Error("Handsontable do not provide action: ".concat(t));for(var a,l=arguments.length,s=new Array(l>1?l-1:0),u=1;u<l;u++)s[u-1]=arguments[u];n=(a=o[t]).call.apply(a,[o].concat(s)),"destroy"===t&&r.removeData()}return n})}Kee(),Xee(VR),VR.__GhostTable=lI,VR._getListenersCounter=Lr,VR._getRegisteredMapsCounter=Ev,VR.EventManager=Nr;var $ee=[o,a,y,g,r,c,l,p,i,s,f,d],qee=[u,h];VR.helper={},VR.dom={},U($ee,(function(e){U(Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(VR.helper[t]=e[t])}))})),U(qee,(function(e){U(Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(VR.dom[t]=e[t])}))})),VR.cellTypes=null!==(Vee=VR.cellTypes)&&void 0!==Vee?Vee:{},U(ES(),(function(e){VR.cellTypes[e]=TS(e)})),VR.cellTypes.registerCellType=PS,VR.cellTypes.getCellType=TS,VR.editors=null!==(Fee=VR.editors)&&void 0!==Fee?Fee:{},U(Er(),(function(e){VR.editors["".concat(gt(e),"Editor")]=Mr(e)})),VR.editors.registerEditor=Ar,VR.editors.getEditor=Mr,VR.renderers=null!==(Wee=VR.renderers)&&void 0!==Wee?Wee:{},U(ji(),(function(e){var t=xi(e);"base"===e&&(VR.renderers.cellDecorator=t),VR.renderers["".concat(gt(e),"Renderer")]=t})),VR.renderers.registerRenderer=_i,VR.renderers.getRenderer=xi,VR.validators=null!==(Uee=VR.validators)&&void 0!==Uee?Uee:{},U(Bi(),(function(e){VR.validators["".concat(gt(e),"Validator")]=Vi(e)})),VR.validators.registerValidator=Fi,VR.validators.getValidator=Vi,VR.plugins=null!==(zee=VR.plugins)&&void 0!==zee?zee:{},U(Si(),(function(e){VR.plugins[e]=Oi(e)})),VR.plugins["".concat(gt($A.PLUGIN_KEY),"Plugin")]=$A,VR.plugins.registerPlugin=Ri,VR.plugins.getPlugin=Oi;var Qee=VR,Jee=function(e,t){var n=t.className;void 0!==n&&Qee.dom.addClass(e,n)},Zee=function(e,t,n,r,o,i,a){var l=document.createElement("div");l.style.width=10*i+"px",Jee(t,a),Qee.dom.addClass(l,"progressBar"),Qee.dom.empty(t),t.appendChild(l)},ete=function(e,t,n,r,o,i,a){Qee.renderers.TextRenderer.apply(this,[e,t,n,r,o,"".repeat(i),a])},tte=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]),nte=function(e,t,n,r,o,i){if(0===n){var a=e.parentElement;null!==a&&(i.instance.getDataAtRowProp(t,"0")?Qee.dom.addClass(a,XE):Qee.dom.removeClass(a,XE),t%2===0?Qee.dom.addClass(a,$E):Qee.dom.removeClass(a,$E))}},rte=function(e,t){var n=document.createElement("input");n.type="checkbox",e>=0&&this.getDataAtRowProp(e,"0")&&(n.checked=!0),Qee.dom.empty(t),t.appendChild(n)};function ote(e,t){if(!(e<0)){var n=this.isRtl()?"htRight":"htLeft";t.firstChild&&(tte.has(e.toString())?(Qee.dom.removeClass(t.firstChild,n),Qee.dom.addClass(t.firstChild,tte.get(e.toString()))):Qee.dom.addClass(t.firstChild,n))}}var ite=function(e,t){var n=e.target;-1===t.col&&e.target&&"INPUT"===n.nodeName&&(e.preventDefault(),this.setDataAtRowProp(t.row,"0",!n.checked))},ate={name:"DataGrid",data:function(){return{hotSettings:{height:450,dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterOnCellMouseDown:ite,afterGetColHeader:ote,afterGetRowHeader:rte,beforeRenderer:nte,colWidths:[140,192,100,90,90,110,97,100,126],colHeaders:["Company name","Name","Sell date","In stock","Qty","Progress","Rating","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:8,renderer:Zee,readOnly:!0,className:"htMiddle"},{data:9,renderer:ete,readOnly:!0,className:"star htCenter"},{data:5,type:"text"},{data:2,type:"text"}],licenseKey:"non-commercial-and-evaluation"},data:qE()}},components:{HotTable:EE}},lte=ate,ste=(n("75e0"),n("a6c2")),ute=Object(ste["a"])(lte,k,R,!1,null,null,null),cte=ute.exports,fte={name:"App",components:{DataGrid:cte}},hte=fte,dte=Object(ste["a"])(hte,S,O,!1,null,null,null),pte=dte.exports;console.log("Handsontable: v"+Qee.version+" ("+Qee.buildDate+") Wrapper: v"+EE.version+" Vue: v"+C["a"].version),C["a"].config.silent=!0,new C["a"]({render:function(e){return e(pte)}}).$mount("#app")}});
//# sourceMappingURL=app.1170460b.js.map