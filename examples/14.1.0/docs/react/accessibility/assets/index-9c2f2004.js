var eG=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var ARe=eG((YRe,uw)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var to=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Av(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function tG(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var i$={exports:{}},Iv={},o$={exports:{}},it={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rg=Symbol.for("react.element"),nG=Symbol.for("react.portal"),rG=Symbol.for("react.fragment"),iG=Symbol.for("react.strict_mode"),oG=Symbol.for("react.profiler"),sG=Symbol.for("react.provider"),aG=Symbol.for("react.context"),lG=Symbol.for("react.forward_ref"),uG=Symbol.for("react.suspense"),cG=Symbol.for("react.memo"),hG=Symbol.for("react.lazy"),Yx=Symbol.iterator;function dG(t){return t===null||typeof t!="object"?null:(t=Yx&&t[Yx]||t["@@iterator"],typeof t=="function"?t:null)}var s$={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},a$=Object.assign,l$={};function gh(t,e,n){this.props=t,this.context=e,this.refs=l$,this.updater=n||s$}gh.prototype.isReactComponent={};gh.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};gh.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function u$(){}u$.prototype=gh.prototype;function VE(t,e,n){this.props=t,this.context=e,this.refs=l$,this.updater=n||s$}var BE=VE.prototype=new u$;BE.constructor=VE;a$(BE,gh.prototype);BE.isPureReactComponent=!0;var Kx=Array.isArray,c$=Object.prototype.hasOwnProperty,UE={current:null},h$={key:!0,ref:!0,__self:!0,__source:!0};function d$(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)c$.call(e,r)&&!h$.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:rg,type:t,key:o,ref:s,props:i,_owner:UE.current}}function fG(t,e){return{$$typeof:rg,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function zE(t){return typeof t=="object"&&t!==null&&t.$$typeof===rg}function gG(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Xx=/\/+/g;function hy(t,e){return typeof t=="object"&&t!==null&&t.key!=null?gG(""+t.key):e.toString(36)}function Ep(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case rg:case nG:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+hy(s,0):r,Kx(i)?(n="",t!=null&&(n=t.replace(Xx,"$&/")+"/"),Ep(i,e,n,"",function(u){return u})):i!=null&&(zE(i)&&(i=fG(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Xx,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",Kx(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+hy(o,a);s+=Ep(o,e,n,l,i)}else if(l=dG(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+hy(o,a++),s+=Ep(o,e,n,l,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Ng(t,e,n){if(t==null)return t;var r=[],i=0;return Ep(t,r,"","",function(o){return e.call(n,o,i++)}),r}function mG(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Sr={current:null},Tp={transition:null},pG={ReactCurrentDispatcher:Sr,ReactCurrentBatchConfig:Tp,ReactCurrentOwner:UE};it.Children={map:Ng,forEach:function(t,e,n){Ng(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ng(t,function(){e++}),e},toArray:function(t){return Ng(t,function(e){return e})||[]},only:function(t){if(!zE(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};it.Component=gh;it.Fragment=rG;it.Profiler=oG;it.PureComponent=VE;it.StrictMode=iG;it.Suspense=uG;it.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pG;it.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=a$({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=UE.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)c$.call(e,l)&&!h$.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:rg,type:t.type,key:i,ref:o,props:r,_owner:s}};it.createContext=function(t){return t={$$typeof:aG,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:sG,_context:t},t.Consumer=t};it.createElement=d$;it.createFactory=function(t){var e=d$.bind(null,t);return e.type=t,e};it.createRef=function(){return{current:null}};it.forwardRef=function(t){return{$$typeof:lG,render:t}};it.isValidElement=zE;it.lazy=function(t){return{$$typeof:hG,_payload:{_status:-1,_result:t},_init:mG}};it.memo=function(t,e){return{$$typeof:cG,type:t,compare:e===void 0?null:e}};it.startTransition=function(t){var e=Tp.transition;Tp.transition={};try{t()}finally{Tp.transition=e}};it.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};it.useCallback=function(t,e){return Sr.current.useCallback(t,e)};it.useContext=function(t){return Sr.current.useContext(t)};it.useDebugValue=function(){};it.useDeferredValue=function(t){return Sr.current.useDeferredValue(t)};it.useEffect=function(t,e){return Sr.current.useEffect(t,e)};it.useId=function(){return Sr.current.useId()};it.useImperativeHandle=function(t,e,n){return Sr.current.useImperativeHandle(t,e,n)};it.useInsertionEffect=function(t,e){return Sr.current.useInsertionEffect(t,e)};it.useLayoutEffect=function(t,e){return Sr.current.useLayoutEffect(t,e)};it.useMemo=function(t,e){return Sr.current.useMemo(t,e)};it.useReducer=function(t,e,n){return Sr.current.useReducer(t,e,n)};it.useRef=function(t){return Sr.current.useRef(t)};it.useState=function(t){return Sr.current.useState(t)};it.useSyncExternalStore=function(t,e,n){return Sr.current.useSyncExternalStore(t,e,n)};it.useTransition=function(){return Sr.current.useTransition()};it.version="18.2.0";o$.exports=it;var Hv=o$.exports;const Wt=Av(Hv);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wG=Hv,vG=Symbol.for("react.element"),CG=Symbol.for("react.fragment"),yG=Object.prototype.hasOwnProperty,SG=wG.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bG={key:!0,ref:!0,__self:!0,__source:!0};function f$(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)yG.call(e,r)&&!bG.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:vG,type:t,key:o,ref:s,props:i,_owner:SG.current}}Iv.Fragment=CG;Iv.jsx=f$;Iv.jsxs=f$;i$.exports=Iv;var pe=i$.exports,T0={},g$={exports:{}},si={},m$={exports:{}},p$={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Y,g){var v=Y.length;Y.push(g);e:for(;0<v;){var S=v-1>>>1,O=Y[S];if(0<i(O,g))Y[S]=g,Y[v]=O,v=S;else break e}}function n(Y){return Y.length===0?null:Y[0]}function r(Y){if(Y.length===0)return null;var g=Y[0],v=Y.pop();if(v!==g){Y[0]=v;e:for(var S=0,O=Y.length,H=O>>>1;S<H;){var D=2*(S+1)-1,X=Y[D],G=D+1,se=Y[G];if(0>i(X,v))G<O&&0>i(se,X)?(Y[S]=se,Y[G]=v,S=G):(Y[S]=X,Y[D]=v,S=D);else if(G<O&&0>i(se,v))Y[S]=se,Y[G]=v,S=G;else break e}}return g}function i(Y,g){var v=Y.sortIndex-g.sortIndex;return v!==0?v:Y.id-g.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var l=[],u=[],c=1,h=null,d=3,f=!1,m=!1,C=!1,b=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(Y){for(var g=n(u);g!==null;){if(g.callback===null)r(u);else if(g.startTime<=Y)r(u),g.sortIndex=g.expirationTime,e(l,g);else break;g=n(u)}}function E(Y){if(C=!1,y(Y),!m)if(n(l)!==null)m=!0,Ue(T);else{var g=n(u);g!==null&&ke(E,g.startTime-Y)}}function T(Y,g){m=!1,C&&(C=!1,p(W),W=-1),f=!0;var v=d;try{for(y(g),h=n(l);h!==null&&(!(h.expirationTime>g)||Y&&!Q());){var S=h.callback;if(typeof S=="function"){h.callback=null,d=h.priorityLevel;var O=S(h.expirationTime<=g);g=t.unstable_now(),typeof O=="function"?h.callback=O:h===n(l)&&r(l),y(g)}else r(l);h=n(l)}if(h!==null)var H=!0;else{var D=n(u);D!==null&&ke(E,D.startTime-g),H=!1}return H}finally{h=null,d=v,f=!1}}var x=!1,A=null,W=-1,B=5,U=-1;function Q(){return!(t.unstable_now()-U<B)}function te(){if(A!==null){var Y=t.unstable_now();U=Y;var g=!0;try{g=A(!0,Y)}finally{g?ee():(x=!1,A=null)}}else x=!1}var ee;if(typeof w=="function")ee=function(){w(te)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,_e=he.port2;he.port1.onmessage=te,ee=function(){_e.postMessage(null)}}else ee=function(){b(te,0)};function Ue(Y){A=Y,x||(x=!0,ee())}function ke(Y,g){W=b(function(){Y(t.unstable_now())},g)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Y){Y.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,Ue(T))},t.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<Y?Math.floor(1e3/Y):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(Y){switch(d){case 1:case 2:case 3:var g=3;break;default:g=d}var v=d;d=g;try{return Y()}finally{d=v}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Y,g){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var v=d;d=Y;try{return g()}finally{d=v}},t.unstable_scheduleCallback=function(Y,g,v){var S=t.unstable_now();switch(typeof v=="object"&&v!==null?(v=v.delay,v=typeof v=="number"&&0<v?S+v:S):v=S,Y){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=v+O,Y={id:c++,callback:g,priorityLevel:Y,startTime:v,expirationTime:O,sortIndex:-1},v>S?(Y.sortIndex=v,e(u,Y),n(l)===null&&Y===n(u)&&(C?(p(W),W=-1):C=!0,ke(E,v-S))):(Y.sortIndex=O,e(l,Y),m||f||(m=!0,Ue(T))),Y},t.unstable_shouldYield=Q,t.unstable_wrapCallback=function(Y){var g=d;return function(){var v=d;d=g;try{return Y.apply(this,arguments)}finally{d=v}}}})(p$);m$.exports=p$;var RG=m$.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w$=Hv,ii=RG;function ne(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v$=new Set,Cf={};function wu(t,e){eh(t,e),eh(t+"Capture",e)}function eh(t,e){for(Cf[t]=e,t=0;t<e.length;t++)v$.add(e[t])}var Ds=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_0=Object.prototype.hasOwnProperty,EG=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qx={},Qx={};function TG(t){return _0.call(Qx,t)?!0:_0.call(qx,t)?!1:EG.test(t)?Qx[t]=!0:(qx[t]=!0,!1)}function _G(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function MG(t,e,n,r){if(e===null||typeof e>"u"||_G(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function br(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Wn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Wn[t]=new br(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Wn[e]=new br(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Wn[t]=new br(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Wn[t]=new br(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Wn[t]=new br(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Wn[t]=new br(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Wn[t]=new br(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Wn[t]=new br(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Wn[t]=new br(t,5,!1,t.toLowerCase(),null,!1,!1)});var jE=/[\-:]([a-z])/g;function GE(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(jE,GE);Wn[e]=new br(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(jE,GE);Wn[e]=new br(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(jE,GE);Wn[e]=new br(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Wn[t]=new br(t,1,!1,t.toLowerCase(),null,!1,!1)});Wn.xlinkHref=new br("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Wn[t]=new br(t,1,!1,t.toLowerCase(),null,!0,!0)});function YE(t,e,n,r){var i=Wn.hasOwnProperty(e)?Wn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(MG(e,n,i,r)&&(n=null),r||i===null?TG(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Bs=w$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,kg=Symbol.for("react.element"),Ec=Symbol.for("react.portal"),Tc=Symbol.for("react.fragment"),KE=Symbol.for("react.strict_mode"),M0=Symbol.for("react.profiler"),C$=Symbol.for("react.provider"),y$=Symbol.for("react.context"),XE=Symbol.for("react.forward_ref"),x0=Symbol.for("react.suspense"),P0=Symbol.for("react.suspense_list"),qE=Symbol.for("react.memo"),ma=Symbol.for("react.lazy"),S$=Symbol.for("react.offscreen"),Zx=Symbol.iterator;function Ah(t){return t===null||typeof t!="object"?null:(t=Zx&&t[Zx]||t["@@iterator"],typeof t=="function"?t:null)}var en=Object.assign,dy;function Ad(t){if(dy===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);dy=e&&e[1]||""}return`
`+dy+t}var fy=!1;function gy(t,e){if(!t||fy)return"";fy=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=a);break}}}finally{fy=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ad(t):""}function xG(t){switch(t.tag){case 5:return Ad(t.type);case 16:return Ad("Lazy");case 13:return Ad("Suspense");case 19:return Ad("SuspenseList");case 0:case 2:case 15:return t=gy(t.type,!1),t;case 11:return t=gy(t.type.render,!1),t;case 1:return t=gy(t.type,!0),t;default:return""}}function O0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Tc:return"Fragment";case Ec:return"Portal";case M0:return"Profiler";case KE:return"StrictMode";case x0:return"Suspense";case P0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case y$:return(t.displayName||"Context")+".Consumer";case C$:return(t._context.displayName||"Context")+".Provider";case XE:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case qE:return e=t.displayName||null,e!==null?e:O0(t.type)||"Memo";case ma:e=t._payload,t=t._init;try{return O0(t(e))}catch{}}return null}function PG(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return O0(e);case 8:return e===KE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ka(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function b$(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function OG(t){var e=b$(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Lg(t){t._valueTracker||(t._valueTracker=OG(t))}function R$(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=b$(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function cw(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function A0(t,e){var n=e.checked;return en({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Jx(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ka(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function E$(t,e){e=e.checked,e!=null&&YE(t,"checked",e,!1)}function I0(t,e){E$(t,e);var n=Ka(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?H0(t,e.type,n):e.hasOwnProperty("defaultValue")&&H0(t,e.type,Ka(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function eP(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function H0(t,e,n){(e!=="number"||cw(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Id=Array.isArray;function Vc(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ka(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function D0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ne(91));return en({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function tP(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ne(92));if(Id(n)){if(1<n.length)throw Error(ne(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ka(n)}}function T$(t,e){var n=Ka(e.value),r=Ka(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function nP(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function _$(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function N0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?_$(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var $g,M$=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for($g=$g||document.createElement("div"),$g.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=$g.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function yf(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Vd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},AG=["Webkit","ms","Moz","O"];Object.keys(Vd).forEach(function(t){AG.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Vd[e]=Vd[t]})});function x$(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Vd.hasOwnProperty(t)&&Vd[t]?(""+e).trim():e+"px"}function P$(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=x$(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var IG=en({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function k0(t,e){if(e){if(IG[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ne(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ne(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ne(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ne(62))}}function L0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $0=null;function QE(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var F0=null,Bc=null,Uc=null;function rP(t){if(t=sg(t)){if(typeof F0!="function")throw Error(ne(280));var e=t.stateNode;e&&(e=$v(e),F0(t.stateNode,t.type,e))}}function O$(t){Bc?Uc?Uc.push(t):Uc=[t]:Bc=t}function A$(){if(Bc){var t=Bc,e=Uc;if(Uc=Bc=null,rP(t),e)for(t=0;t<e.length;t++)rP(e[t])}}function I$(t,e){return t(e)}function H$(){}var my=!1;function D$(t,e,n){if(my)return t(e,n);my=!0;try{return I$(t,e,n)}finally{my=!1,(Bc!==null||Uc!==null)&&(H$(),A$())}}function Sf(t,e){var n=t.stateNode;if(n===null)return null;var r=$v(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ne(231,e,typeof n));return n}var W0=!1;if(Ds)try{var Ih={};Object.defineProperty(Ih,"passive",{get:function(){W0=!0}}),window.addEventListener("test",Ih,Ih),window.removeEventListener("test",Ih,Ih)}catch{W0=!1}function HG(t,e,n,r,i,o,s,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var Bd=!1,hw=null,dw=!1,V0=null,DG={onError:function(t){Bd=!0,hw=t}};function NG(t,e,n,r,i,o,s,a,l){Bd=!1,hw=null,HG.apply(DG,arguments)}function kG(t,e,n,r,i,o,s,a,l){if(NG.apply(this,arguments),Bd){if(Bd){var u=hw;Bd=!1,hw=null}else throw Error(ne(198));dw||(dw=!0,V0=u)}}function vu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function N$(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function iP(t){if(vu(t)!==t)throw Error(ne(188))}function LG(t){var e=t.alternate;if(!e){if(e=vu(t),e===null)throw Error(ne(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return iP(i),t;if(o===r)return iP(i),e;o=o.sibling}throw Error(ne(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(ne(189))}}if(n.alternate!==r)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?t:e}function k$(t){return t=LG(t),t!==null?L$(t):null}function L$(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=L$(t);if(e!==null)return e;t=t.sibling}return null}var $$=ii.unstable_scheduleCallback,oP=ii.unstable_cancelCallback,$G=ii.unstable_shouldYield,FG=ii.unstable_requestPaint,cn=ii.unstable_now,WG=ii.unstable_getCurrentPriorityLevel,ZE=ii.unstable_ImmediatePriority,F$=ii.unstable_UserBlockingPriority,fw=ii.unstable_NormalPriority,VG=ii.unstable_LowPriority,W$=ii.unstable_IdlePriority,Dv=null,Uo=null;function BG(t){if(Uo&&typeof Uo.onCommitFiberRoot=="function")try{Uo.onCommitFiberRoot(Dv,t,void 0,(t.current.flags&128)===128)}catch{}}var io=Math.clz32?Math.clz32:jG,UG=Math.log,zG=Math.LN2;function jG(t){return t>>>=0,t===0?32:31-(UG(t)/zG|0)|0}var Fg=64,Wg=4194304;function Hd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function gw(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=Hd(a):(o&=s,o!==0&&(r=Hd(o)))}else s=n&~i,s!==0?r=Hd(s):o!==0&&(r=Hd(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-io(e),i=1<<n,r|=t[n],e&=~i;return r}function GG(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function YG(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-io(o),a=1<<s,l=i[s];l===-1?(!(a&n)||a&r)&&(i[s]=GG(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function B0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function V$(){var t=Fg;return Fg<<=1,!(Fg&4194240)&&(Fg=64),t}function py(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ig(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-io(e),t[e]=n}function KG(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-io(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function JE(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-io(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ct=0;function B$(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var U$,eT,z$,j$,G$,U0=!1,Vg=[],Da=null,Na=null,ka=null,bf=new Map,Rf=new Map,Ca=[],XG="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sP(t,e){switch(t){case"focusin":case"focusout":Da=null;break;case"dragenter":case"dragleave":Na=null;break;case"mouseover":case"mouseout":ka=null;break;case"pointerover":case"pointerout":bf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rf.delete(e.pointerId)}}function Hh(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=sg(e),e!==null&&eT(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function qG(t,e,n,r,i){switch(e){case"focusin":return Da=Hh(Da,t,e,n,r,i),!0;case"dragenter":return Na=Hh(Na,t,e,n,r,i),!0;case"mouseover":return ka=Hh(ka,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return bf.set(o,Hh(bf.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Rf.set(o,Hh(Rf.get(o)||null,t,e,n,r,i)),!0}return!1}function Y$(t){var e=Yl(t.target);if(e!==null){var n=vu(e);if(n!==null){if(e=n.tag,e===13){if(e=N$(n),e!==null){t.blockedOn=e,G$(t.priority,function(){z$(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function _p(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=z0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);$0=r,n.target.dispatchEvent(r),$0=null}else return e=sg(n),e!==null&&eT(e),t.blockedOn=n,!1;e.shift()}return!0}function aP(t,e,n){_p(t)&&n.delete(e)}function QG(){U0=!1,Da!==null&&_p(Da)&&(Da=null),Na!==null&&_p(Na)&&(Na=null),ka!==null&&_p(ka)&&(ka=null),bf.forEach(aP),Rf.forEach(aP)}function Dh(t,e){t.blockedOn===e&&(t.blockedOn=null,U0||(U0=!0,ii.unstable_scheduleCallback(ii.unstable_NormalPriority,QG)))}function Ef(t){function e(i){return Dh(i,t)}if(0<Vg.length){Dh(Vg[0],t);for(var n=1;n<Vg.length;n++){var r=Vg[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Da!==null&&Dh(Da,t),Na!==null&&Dh(Na,t),ka!==null&&Dh(ka,t),bf.forEach(e),Rf.forEach(e),n=0;n<Ca.length;n++)r=Ca[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ca.length&&(n=Ca[0],n.blockedOn===null);)Y$(n),n.blockedOn===null&&Ca.shift()}var zc=Bs.ReactCurrentBatchConfig,mw=!0;function ZG(t,e,n,r){var i=Ct,o=zc.transition;zc.transition=null;try{Ct=1,tT(t,e,n,r)}finally{Ct=i,zc.transition=o}}function JG(t,e,n,r){var i=Ct,o=zc.transition;zc.transition=null;try{Ct=4,tT(t,e,n,r)}finally{Ct=i,zc.transition=o}}function tT(t,e,n,r){if(mw){var i=z0(t,e,n,r);if(i===null)_y(t,e,r,pw,n),sP(t,r);else if(qG(i,t,e,n,r))r.stopPropagation();else if(sP(t,r),e&4&&-1<XG.indexOf(t)){for(;i!==null;){var o=sg(i);if(o!==null&&U$(o),o=z0(t,e,n,r),o===null&&_y(t,e,r,pw,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else _y(t,e,r,null,n)}}var pw=null;function z0(t,e,n,r){if(pw=null,t=QE(r),t=Yl(t),t!==null)if(e=vu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=N$(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return pw=t,null}function K$(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(WG()){case ZE:return 1;case F$:return 4;case fw:case VG:return 16;case W$:return 536870912;default:return 16}default:return 16}}var _a=null,nT=null,Mp=null;function X$(){if(Mp)return Mp;var t,e=nT,n=e.length,r,i="value"in _a?_a.value:_a.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return Mp=i.slice(t,1<r?1-r:void 0)}function xp(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Bg(){return!0}function lP(){return!1}function ai(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Bg:lP,this.isPropagationStopped=lP,this}return en(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Bg)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Bg)},persist:function(){},isPersistent:Bg}),e}var mh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rT=ai(mh),og=en({},mh,{view:0,detail:0}),eY=ai(og),wy,vy,Nh,Nv=en({},og,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:iT,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Nh&&(Nh&&t.type==="mousemove"?(wy=t.screenX-Nh.screenX,vy=t.screenY-Nh.screenY):vy=wy=0,Nh=t),wy)},movementY:function(t){return"movementY"in t?t.movementY:vy}}),uP=ai(Nv),tY=en({},Nv,{dataTransfer:0}),nY=ai(tY),rY=en({},og,{relatedTarget:0}),Cy=ai(rY),iY=en({},mh,{animationName:0,elapsedTime:0,pseudoElement:0}),oY=ai(iY),sY=en({},mh,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),aY=ai(sY),lY=en({},mh,{data:0}),cP=ai(lY),uY={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cY={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hY={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dY(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=hY[t])?!!e[t]:!1}function iT(){return dY}var fY=en({},og,{key:function(t){if(t.key){var e=uY[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=xp(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?cY[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:iT,charCode:function(t){return t.type==="keypress"?xp(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?xp(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),gY=ai(fY),mY=en({},Nv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hP=ai(mY),pY=en({},og,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:iT}),wY=ai(pY),vY=en({},mh,{propertyName:0,elapsedTime:0,pseudoElement:0}),CY=ai(vY),yY=en({},Nv,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),SY=ai(yY),bY=[9,13,27,32],oT=Ds&&"CompositionEvent"in window,Ud=null;Ds&&"documentMode"in document&&(Ud=document.documentMode);var RY=Ds&&"TextEvent"in window&&!Ud,q$=Ds&&(!oT||Ud&&8<Ud&&11>=Ud),dP=String.fromCharCode(32),fP=!1;function Q$(t,e){switch(t){case"keyup":return bY.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Z$(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var _c=!1;function EY(t,e){switch(t){case"compositionend":return Z$(e);case"keypress":return e.which!==32?null:(fP=!0,dP);case"textInput":return t=e.data,t===dP&&fP?null:t;default:return null}}function TY(t,e){if(_c)return t==="compositionend"||!oT&&Q$(t,e)?(t=X$(),Mp=nT=_a=null,_c=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return q$&&e.locale!=="ko"?null:e.data;default:return null}}var _Y={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gP(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!_Y[t.type]:e==="textarea"}function J$(t,e,n,r){O$(r),e=ww(e,"onChange"),0<e.length&&(n=new rT("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var zd=null,Tf=null;function MY(t){cF(t,0)}function kv(t){var e=Pc(t);if(R$(e))return t}function xY(t,e){if(t==="change")return e}var eF=!1;if(Ds){var yy;if(Ds){var Sy="oninput"in document;if(!Sy){var mP=document.createElement("div");mP.setAttribute("oninput","return;"),Sy=typeof mP.oninput=="function"}yy=Sy}else yy=!1;eF=yy&&(!document.documentMode||9<document.documentMode)}function pP(){zd&&(zd.detachEvent("onpropertychange",tF),Tf=zd=null)}function tF(t){if(t.propertyName==="value"&&kv(Tf)){var e=[];J$(e,Tf,t,QE(t)),D$(MY,e)}}function PY(t,e,n){t==="focusin"?(pP(),zd=e,Tf=n,zd.attachEvent("onpropertychange",tF)):t==="focusout"&&pP()}function OY(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return kv(Tf)}function AY(t,e){if(t==="click")return kv(e)}function IY(t,e){if(t==="input"||t==="change")return kv(e)}function HY(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ao=typeof Object.is=="function"?Object.is:HY;function _f(t,e){if(ao(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!_0.call(e,i)||!ao(t[i],e[i]))return!1}return!0}function wP(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function vP(t,e){var n=wP(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=wP(n)}}function nF(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?nF(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function rF(){for(var t=window,e=cw();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=cw(t.document)}return e}function sT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function DY(t){var e=rF(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&nF(n.ownerDocument.documentElement,n)){if(r!==null&&sT(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=vP(n,o);var s=vP(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var NY=Ds&&"documentMode"in document&&11>=document.documentMode,Mc=null,j0=null,jd=null,G0=!1;function CP(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;G0||Mc==null||Mc!==cw(r)||(r=Mc,"selectionStart"in r&&sT(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),jd&&_f(jd,r)||(jd=r,r=ww(j0,"onSelect"),0<r.length&&(e=new rT("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Mc)))}function Ug(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var xc={animationend:Ug("Animation","AnimationEnd"),animationiteration:Ug("Animation","AnimationIteration"),animationstart:Ug("Animation","AnimationStart"),transitionend:Ug("Transition","TransitionEnd")},by={},iF={};Ds&&(iF=document.createElement("div").style,"AnimationEvent"in window||(delete xc.animationend.animation,delete xc.animationiteration.animation,delete xc.animationstart.animation),"TransitionEvent"in window||delete xc.transitionend.transition);function Lv(t){if(by[t])return by[t];if(!xc[t])return t;var e=xc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in iF)return by[t]=e[n];return t}var oF=Lv("animationend"),sF=Lv("animationiteration"),aF=Lv("animationstart"),lF=Lv("transitionend"),uF=new Map,yP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rl(t,e){uF.set(t,e),wu(e,[t])}for(var Ry=0;Ry<yP.length;Ry++){var Ey=yP[Ry],kY=Ey.toLowerCase(),LY=Ey[0].toUpperCase()+Ey.slice(1);rl(kY,"on"+LY)}rl(oF,"onAnimationEnd");rl(sF,"onAnimationIteration");rl(aF,"onAnimationStart");rl("dblclick","onDoubleClick");rl("focusin","onFocus");rl("focusout","onBlur");rl(lF,"onTransitionEnd");eh("onMouseEnter",["mouseout","mouseover"]);eh("onMouseLeave",["mouseout","mouseover"]);eh("onPointerEnter",["pointerout","pointerover"]);eh("onPointerLeave",["pointerout","pointerover"]);wu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wu("onBeforeInput",["compositionend","keypress","textInput","paste"]);wu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$Y=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dd));function SP(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,kG(r,e,void 0,t),t.currentTarget=null}function cF(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;SP(i,a,u),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,u=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;SP(i,a,u),o=l}}}if(dw)throw t=V0,dw=!1,V0=null,t}function At(t,e){var n=e[Q0];n===void 0&&(n=e[Q0]=new Set);var r=t+"__bubble";n.has(r)||(hF(e,t,2,!1),n.add(r))}function Ty(t,e,n){var r=0;e&&(r|=4),hF(n,t,r,e)}var zg="_reactListening"+Math.random().toString(36).slice(2);function Mf(t){if(!t[zg]){t[zg]=!0,v$.forEach(function(n){n!=="selectionchange"&&($Y.has(n)||Ty(n,!1,t),Ty(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[zg]||(e[zg]=!0,Ty("selectionchange",!1,e))}}function hF(t,e,n,r){switch(K$(e)){case 1:var i=ZG;break;case 4:i=JG;break;default:i=tT}n=i.bind(null,e,n,t),i=void 0,!W0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function _y(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=Yl(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}D$(function(){var u=o,c=QE(n),h=[];e:{var d=uF.get(t);if(d!==void 0){var f=rT,m=t;switch(t){case"keypress":if(xp(n)===0)break e;case"keydown":case"keyup":f=gY;break;case"focusin":m="focus",f=Cy;break;case"focusout":m="blur",f=Cy;break;case"beforeblur":case"afterblur":f=Cy;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=uP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=nY;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=wY;break;case oF:case sF:case aF:f=oY;break;case lF:f=CY;break;case"scroll":f=eY;break;case"wheel":f=SY;break;case"copy":case"cut":case"paste":f=aY;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=hP}var C=(e&4)!==0,b=!C&&t==="scroll",p=C?d!==null?d+"Capture":null:d;C=[];for(var w=u,y;w!==null;){y=w;var E=y.stateNode;if(y.tag===5&&E!==null&&(y=E,p!==null&&(E=Sf(w,p),E!=null&&C.push(xf(w,E,y)))),b)break;w=w.return}0<C.length&&(d=new f(d,m,null,n,c),h.push({event:d,listeners:C}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&n!==$0&&(m=n.relatedTarget||n.fromElement)&&(Yl(m)||m[Ns]))break e;if((f||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,f?(m=n.relatedTarget||n.toElement,f=u,m=m?Yl(m):null,m!==null&&(b=vu(m),m!==b||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=u),f!==m)){if(C=uP,E="onMouseLeave",p="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(C=hP,E="onPointerLeave",p="onPointerEnter",w="pointer"),b=f==null?d:Pc(f),y=m==null?d:Pc(m),d=new C(E,w+"leave",f,n,c),d.target=b,d.relatedTarget=y,E=null,Yl(c)===u&&(C=new C(p,w+"enter",m,n,c),C.target=y,C.relatedTarget=b,E=C),b=E,f&&m)t:{for(C=f,p=m,w=0,y=C;y;y=Pu(y))w++;for(y=0,E=p;E;E=Pu(E))y++;for(;0<w-y;)C=Pu(C),w--;for(;0<y-w;)p=Pu(p),y--;for(;w--;){if(C===p||p!==null&&C===p.alternate)break t;C=Pu(C),p=Pu(p)}C=null}else C=null;f!==null&&bP(h,d,f,C,!1),m!==null&&b!==null&&bP(h,b,m,C,!0)}}e:{if(d=u?Pc(u):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var T=xY;else if(gP(d))if(eF)T=IY;else{T=OY;var x=PY}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(T=AY);if(T&&(T=T(t,u))){J$(h,T,n,c);break e}x&&x(t,d,u),t==="focusout"&&(x=d._wrapperState)&&x.controlled&&d.type==="number"&&H0(d,"number",d.value)}switch(x=u?Pc(u):window,t){case"focusin":(gP(x)||x.contentEditable==="true")&&(Mc=x,j0=u,jd=null);break;case"focusout":jd=j0=Mc=null;break;case"mousedown":G0=!0;break;case"contextmenu":case"mouseup":case"dragend":G0=!1,CP(h,n,c);break;case"selectionchange":if(NY)break;case"keydown":case"keyup":CP(h,n,c)}var A;if(oT)e:{switch(t){case"compositionstart":var W="onCompositionStart";break e;case"compositionend":W="onCompositionEnd";break e;case"compositionupdate":W="onCompositionUpdate";break e}W=void 0}else _c?Q$(t,n)&&(W="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(W="onCompositionStart");W&&(q$&&n.locale!=="ko"&&(_c||W!=="onCompositionStart"?W==="onCompositionEnd"&&_c&&(A=X$()):(_a=c,nT="value"in _a?_a.value:_a.textContent,_c=!0)),x=ww(u,W),0<x.length&&(W=new cP(W,t,null,n,c),h.push({event:W,listeners:x}),A?W.data=A:(A=Z$(n),A!==null&&(W.data=A)))),(A=RY?EY(t,n):TY(t,n))&&(u=ww(u,"onBeforeInput"),0<u.length&&(c=new cP("onBeforeInput","beforeinput",null,n,c),h.push({event:c,listeners:u}),c.data=A))}cF(h,e)})}function xf(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ww(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Sf(t,n),o!=null&&r.unshift(xf(t,o,i)),o=Sf(t,e),o!=null&&r.push(xf(t,o,i))),t=t.return}return r}function Pu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function bP(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Sf(n,o),l!=null&&s.unshift(xf(n,l,a))):i||(l=Sf(n,o),l!=null&&s.push(xf(n,l,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var FY=/\r\n?/g,WY=/\u0000|\uFFFD/g;function RP(t){return(typeof t=="string"?t:""+t).replace(FY,`
`).replace(WY,"")}function jg(t,e,n){if(e=RP(e),RP(t)!==e&&n)throw Error(ne(425))}function vw(){}var Y0=null,K0=null;function X0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var q0=typeof setTimeout=="function"?setTimeout:void 0,VY=typeof clearTimeout=="function"?clearTimeout:void 0,EP=typeof Promise=="function"?Promise:void 0,BY=typeof queueMicrotask=="function"?queueMicrotask:typeof EP<"u"?function(t){return EP.resolve(null).then(t).catch(UY)}:q0;function UY(t){setTimeout(function(){throw t})}function My(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ef(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ef(e)}function La(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function TP(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ph=Math.random().toString(36).slice(2),Lo="__reactFiber$"+ph,Pf="__reactProps$"+ph,Ns="__reactContainer$"+ph,Q0="__reactEvents$"+ph,zY="__reactListeners$"+ph,jY="__reactHandles$"+ph;function Yl(t){var e=t[Lo];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ns]||n[Lo]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=TP(t);t!==null;){if(n=t[Lo])return n;t=TP(t)}return e}t=n,n=t.parentNode}return null}function sg(t){return t=t[Lo]||t[Ns],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Pc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ne(33))}function $v(t){return t[Pf]||null}var Z0=[],Oc=-1;function il(t){return{current:t}}function Ht(t){0>Oc||(t.current=Z0[Oc],Z0[Oc]=null,Oc--)}function xt(t,e){Oc++,Z0[Oc]=t.current,t.current=e}var Xa={},Jn=il(Xa),Vr=il(!1),su=Xa;function th(t,e){var n=t.type.contextTypes;if(!n)return Xa;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Br(t){return t=t.childContextTypes,t!=null}function Cw(){Ht(Vr),Ht(Jn)}function _P(t,e,n){if(Jn.current!==Xa)throw Error(ne(168));xt(Jn,e),xt(Vr,n)}function dF(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ne(108,PG(t)||"Unknown",i));return en({},n,r)}function yw(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Xa,su=Jn.current,xt(Jn,t),xt(Vr,Vr.current),!0}function MP(t,e,n){var r=t.stateNode;if(!r)throw Error(ne(169));n?(t=dF(t,e,su),r.__reactInternalMemoizedMergedChildContext=t,Ht(Vr),Ht(Jn),xt(Jn,t)):Ht(Vr),xt(Vr,n)}var Ss=null,Fv=!1,xy=!1;function fF(t){Ss===null?Ss=[t]:Ss.push(t)}function GY(t){Fv=!0,fF(t)}function ol(){if(!xy&&Ss!==null){xy=!0;var t=0,e=Ct;try{var n=Ss;for(Ct=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ss=null,Fv=!1}catch(i){throw Ss!==null&&(Ss=Ss.slice(t+1)),$$(ZE,ol),i}finally{Ct=e,xy=!1}}return null}var Ac=[],Ic=0,Sw=null,bw=0,Si=[],bi=0,au=null,bs=1,Rs="";function Ul(t,e){Ac[Ic++]=bw,Ac[Ic++]=Sw,Sw=t,bw=e}function gF(t,e,n){Si[bi++]=bs,Si[bi++]=Rs,Si[bi++]=au,au=t;var r=bs;t=Rs;var i=32-io(r)-1;r&=~(1<<i),n+=1;var o=32-io(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,bs=1<<32-io(e)+i|n<<i|r,Rs=o+t}else bs=1<<o|n<<i|r,Rs=t}function aT(t){t.return!==null&&(Ul(t,1),gF(t,1,0))}function lT(t){for(;t===Sw;)Sw=Ac[--Ic],Ac[Ic]=null,bw=Ac[--Ic],Ac[Ic]=null;for(;t===au;)au=Si[--bi],Si[bi]=null,Rs=Si[--bi],Si[bi]=null,bs=Si[--bi],Si[bi]=null}var ri=null,ti=null,Vt=!1,Ji=null;function mF(t,e){var n=Ei(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function xP(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ri=t,ti=La(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ri=t,ti=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=au!==null?{id:bs,overflow:Rs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ei(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ri=t,ti=null,!0):!1;default:return!1}}function J0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function eR(t){if(Vt){var e=ti;if(e){var n=e;if(!xP(t,e)){if(J0(t))throw Error(ne(418));e=La(n.nextSibling);var r=ri;e&&xP(t,e)?mF(r,n):(t.flags=t.flags&-4097|2,Vt=!1,ri=t)}}else{if(J0(t))throw Error(ne(418));t.flags=t.flags&-4097|2,Vt=!1,ri=t}}}function PP(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ri=t}function Gg(t){if(t!==ri)return!1;if(!Vt)return PP(t),Vt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!X0(t.type,t.memoizedProps)),e&&(e=ti)){if(J0(t))throw pF(),Error(ne(418));for(;e;)mF(t,e),e=La(e.nextSibling)}if(PP(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ne(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ti=La(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ti=null}}else ti=ri?La(t.stateNode.nextSibling):null;return!0}function pF(){for(var t=ti;t;)t=La(t.nextSibling)}function nh(){ti=ri=null,Vt=!1}function uT(t){Ji===null?Ji=[t]:Ji.push(t)}var YY=Bs.ReactCurrentBatchConfig;function qi(t,e){if(t&&t.defaultProps){e=en({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Rw=il(null),Ew=null,Hc=null,cT=null;function hT(){cT=Hc=Ew=null}function dT(t){var e=Rw.current;Ht(Rw),t._currentValue=e}function tR(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function jc(t,e){Ew=t,cT=Hc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Wr=!0),t.firstContext=null)}function Mi(t){var e=t._currentValue;if(cT!==t)if(t={context:t,memoizedValue:e,next:null},Hc===null){if(Ew===null)throw Error(ne(308));Hc=t,Ew.dependencies={lanes:0,firstContext:t}}else Hc=Hc.next=t;return e}var Kl=null;function fT(t){Kl===null?Kl=[t]:Kl.push(t)}function wF(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,fT(e)):(n.next=i.next,i.next=n),e.interleaved=n,ks(t,r)}function ks(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var pa=!1;function gT(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vF(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Is(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function $a(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,lt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ks(t,n)}return i=r.interleaved,i===null?(e.next=e,fT(r)):(e.next=i.next,i.next=e),r.interleaved=e,ks(t,n)}function Pp(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,JE(t,n)}}function OP(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Tw(t,e,n,r){var i=t.updateQueue;pa=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,s===null?o=u:s.next=u,s=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==s&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(o!==null){var h=i.baseState;s=0,c=u=l=null,a=o;do{var d=a.lane,f=a.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,C=a;switch(d=e,f=n,C.tag){case 1:if(m=C.payload,typeof m=="function"){h=m.call(f,h,d);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=C.payload,d=typeof m=="function"?m.call(f,h,d):m,d==null)break e;h=en({},h,d);break e;case 2:pa=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=f,l=h):c=c.next=f,s|=d;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;d=a,a=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(1);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);uu|=s,t.lanes=s,t.memoizedState=h}}function AP(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ne(191,i));i.call(r)}}}var CF=new w$.Component().refs;function nR(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:en({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Wv={isMounted:function(t){return(t=t._reactInternals)?vu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=vr(),i=Wa(t),o=Is(r,i);o.payload=e,n!=null&&(o.callback=n),e=$a(t,o,i),e!==null&&(oo(e,t,i,r),Pp(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=vr(),i=Wa(t),o=Is(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=$a(t,o,i),e!==null&&(oo(e,t,i,r),Pp(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=vr(),r=Wa(t),i=Is(n,r);i.tag=2,e!=null&&(i.callback=e),e=$a(t,i,r),e!==null&&(oo(e,t,r,n),Pp(e,t,r))}};function IP(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!_f(n,r)||!_f(i,o):!0}function yF(t,e,n){var r=!1,i=Xa,o=e.contextType;return typeof o=="object"&&o!==null?o=Mi(o):(i=Br(e)?su:Jn.current,r=e.contextTypes,o=(r=r!=null)?th(t,i):Xa),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Wv,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function HP(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Wv.enqueueReplaceState(e,e.state,null)}function rR(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=CF,gT(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Mi(o):(o=Br(e)?su:Jn.current,i.context=th(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(nR(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Wv.enqueueReplaceState(i,i.state,null),Tw(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function kh(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ne(309));var r=n.stateNode}if(!r)throw Error(ne(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;a===CF&&(a=i.refs={}),s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(ne(284));if(!n._owner)throw Error(ne(290,t))}return t}function Yg(t,e){throw t=Object.prototype.toString.call(e),Error(ne(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function DP(t){var e=t._init;return e(t._payload)}function SF(t){function e(p,w){if(t){var y=p.deletions;y===null?(p.deletions=[w],p.flags|=16):y.push(w)}}function n(p,w){if(!t)return null;for(;w!==null;)e(p,w),w=w.sibling;return null}function r(p,w){for(p=new Map;w!==null;)w.key!==null?p.set(w.key,w):p.set(w.index,w),w=w.sibling;return p}function i(p,w){return p=Va(p,w),p.index=0,p.sibling=null,p}function o(p,w,y){return p.index=y,t?(y=p.alternate,y!==null?(y=y.index,y<w?(p.flags|=2,w):y):(p.flags|=2,w)):(p.flags|=1048576,w)}function s(p){return t&&p.alternate===null&&(p.flags|=2),p}function a(p,w,y,E){return w===null||w.tag!==6?(w=Ny(y,p.mode,E),w.return=p,w):(w=i(w,y),w.return=p,w)}function l(p,w,y,E){var T=y.type;return T===Tc?c(p,w,y.props.children,E,y.key):w!==null&&(w.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===ma&&DP(T)===w.type)?(E=i(w,y.props),E.ref=kh(p,w,y),E.return=p,E):(E=Np(y.type,y.key,y.props,null,p.mode,E),E.ref=kh(p,w,y),E.return=p,E)}function u(p,w,y,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=ky(y,p.mode,E),w.return=p,w):(w=i(w,y.children||[]),w.return=p,w)}function c(p,w,y,E,T){return w===null||w.tag!==7?(w=iu(y,p.mode,E,T),w.return=p,w):(w=i(w,y),w.return=p,w)}function h(p,w,y){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Ny(""+w,p.mode,y),w.return=p,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case kg:return y=Np(w.type,w.key,w.props,null,p.mode,y),y.ref=kh(p,null,w),y.return=p,y;case Ec:return w=ky(w,p.mode,y),w.return=p,w;case ma:var E=w._init;return h(p,E(w._payload),y)}if(Id(w)||Ah(w))return w=iu(w,p.mode,y,null),w.return=p,w;Yg(p,w)}return null}function d(p,w,y,E){var T=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return T!==null?null:a(p,w,""+y,E);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case kg:return y.key===T?l(p,w,y,E):null;case Ec:return y.key===T?u(p,w,y,E):null;case ma:return T=y._init,d(p,w,T(y._payload),E)}if(Id(y)||Ah(y))return T!==null?null:c(p,w,y,E,null);Yg(p,y)}return null}function f(p,w,y,E,T){if(typeof E=="string"&&E!==""||typeof E=="number")return p=p.get(y)||null,a(w,p,""+E,T);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case kg:return p=p.get(E.key===null?y:E.key)||null,l(w,p,E,T);case Ec:return p=p.get(E.key===null?y:E.key)||null,u(w,p,E,T);case ma:var x=E._init;return f(p,w,y,x(E._payload),T)}if(Id(E)||Ah(E))return p=p.get(y)||null,c(w,p,E,T,null);Yg(w,E)}return null}function m(p,w,y,E){for(var T=null,x=null,A=w,W=w=0,B=null;A!==null&&W<y.length;W++){A.index>W?(B=A,A=null):B=A.sibling;var U=d(p,A,y[W],E);if(U===null){A===null&&(A=B);break}t&&A&&U.alternate===null&&e(p,A),w=o(U,w,W),x===null?T=U:x.sibling=U,x=U,A=B}if(W===y.length)return n(p,A),Vt&&Ul(p,W),T;if(A===null){for(;W<y.length;W++)A=h(p,y[W],E),A!==null&&(w=o(A,w,W),x===null?T=A:x.sibling=A,x=A);return Vt&&Ul(p,W),T}for(A=r(p,A);W<y.length;W++)B=f(A,p,W,y[W],E),B!==null&&(t&&B.alternate!==null&&A.delete(B.key===null?W:B.key),w=o(B,w,W),x===null?T=B:x.sibling=B,x=B);return t&&A.forEach(function(Q){return e(p,Q)}),Vt&&Ul(p,W),T}function C(p,w,y,E){var T=Ah(y);if(typeof T!="function")throw Error(ne(150));if(y=T.call(y),y==null)throw Error(ne(151));for(var x=T=null,A=w,W=w=0,B=null,U=y.next();A!==null&&!U.done;W++,U=y.next()){A.index>W?(B=A,A=null):B=A.sibling;var Q=d(p,A,U.value,E);if(Q===null){A===null&&(A=B);break}t&&A&&Q.alternate===null&&e(p,A),w=o(Q,w,W),x===null?T=Q:x.sibling=Q,x=Q,A=B}if(U.done)return n(p,A),Vt&&Ul(p,W),T;if(A===null){for(;!U.done;W++,U=y.next())U=h(p,U.value,E),U!==null&&(w=o(U,w,W),x===null?T=U:x.sibling=U,x=U);return Vt&&Ul(p,W),T}for(A=r(p,A);!U.done;W++,U=y.next())U=f(A,p,W,U.value,E),U!==null&&(t&&U.alternate!==null&&A.delete(U.key===null?W:U.key),w=o(U,w,W),x===null?T=U:x.sibling=U,x=U);return t&&A.forEach(function(te){return e(p,te)}),Vt&&Ul(p,W),T}function b(p,w,y,E){if(typeof y=="object"&&y!==null&&y.type===Tc&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case kg:e:{for(var T=y.key,x=w;x!==null;){if(x.key===T){if(T=y.type,T===Tc){if(x.tag===7){n(p,x.sibling),w=i(x,y.props.children),w.return=p,p=w;break e}}else if(x.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===ma&&DP(T)===x.type){n(p,x.sibling),w=i(x,y.props),w.ref=kh(p,x,y),w.return=p,p=w;break e}n(p,x);break}else e(p,x);x=x.sibling}y.type===Tc?(w=iu(y.props.children,p.mode,E,y.key),w.return=p,p=w):(E=Np(y.type,y.key,y.props,null,p.mode,E),E.ref=kh(p,w,y),E.return=p,p=E)}return s(p);case Ec:e:{for(x=y.key;w!==null;){if(w.key===x)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){n(p,w.sibling),w=i(w,y.children||[]),w.return=p,p=w;break e}else{n(p,w);break}else e(p,w);w=w.sibling}w=ky(y,p.mode,E),w.return=p,p=w}return s(p);case ma:return x=y._init,b(p,w,x(y._payload),E)}if(Id(y))return m(p,w,y,E);if(Ah(y))return C(p,w,y,E);Yg(p,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,w!==null&&w.tag===6?(n(p,w.sibling),w=i(w,y),w.return=p,p=w):(n(p,w),w=Ny(y,p.mode,E),w.return=p,p=w),s(p)):n(p,w)}return b}var rh=SF(!0),bF=SF(!1),ag={},zo=il(ag),Of=il(ag),Af=il(ag);function Xl(t){if(t===ag)throw Error(ne(174));return t}function mT(t,e){switch(xt(Af,e),xt(Of,t),xt(zo,ag),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:N0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=N0(e,t)}Ht(zo),xt(zo,e)}function ih(){Ht(zo),Ht(Of),Ht(Af)}function RF(t){Xl(Af.current);var e=Xl(zo.current),n=N0(e,t.type);e!==n&&(xt(Of,t),xt(zo,n))}function pT(t){Of.current===t&&(Ht(zo),Ht(Of))}var Xt=il(0);function _w(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Py=[];function wT(){for(var t=0;t<Py.length;t++)Py[t]._workInProgressVersionPrimary=null;Py.length=0}var Op=Bs.ReactCurrentDispatcher,Oy=Bs.ReactCurrentBatchConfig,lu=0,Jt=null,Cn=null,Pn=null,Mw=!1,Gd=!1,If=0,KY=0;function Bn(){throw Error(ne(321))}function vT(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ao(t[n],e[n]))return!1;return!0}function CT(t,e,n,r,i,o){if(lu=o,Jt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Op.current=t===null||t.memoizedState===null?ZY:JY,t=n(r,i),Gd){o=0;do{if(Gd=!1,If=0,25<=o)throw Error(ne(301));o+=1,Pn=Cn=null,e.updateQueue=null,Op.current=e3,t=n(r,i)}while(Gd)}if(Op.current=xw,e=Cn!==null&&Cn.next!==null,lu=0,Pn=Cn=Jt=null,Mw=!1,e)throw Error(ne(300));return t}function yT(){var t=If!==0;return If=0,t}function Ho(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pn===null?Jt.memoizedState=Pn=t:Pn=Pn.next=t,Pn}function xi(){if(Cn===null){var t=Jt.alternate;t=t!==null?t.memoizedState:null}else t=Cn.next;var e=Pn===null?Jt.memoizedState:Pn.next;if(e!==null)Pn=e,Cn=t;else{if(t===null)throw Error(ne(310));Cn=t,t={memoizedState:Cn.memoizedState,baseState:Cn.baseState,baseQueue:Cn.baseQueue,queue:Cn.queue,next:null},Pn===null?Jt.memoizedState=Pn=t:Pn=Pn.next=t}return Pn}function Hf(t,e){return typeof e=="function"?e(t):e}function Ay(t){var e=xi(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=Cn,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,u=o;do{var c=u.lane;if((lu&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,s=r):l=l.next=h,Jt.lanes|=c,uu|=c}u=u.next}while(u!==null&&u!==o);l===null?s=r:l.next=a,ao(r,e.memoizedState)||(Wr=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,Jt.lanes|=o,uu|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Iy(t){var e=xi(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);ao(o,e.memoizedState)||(Wr=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function EF(){}function TF(t,e){var n=Jt,r=xi(),i=e(),o=!ao(r.memoizedState,i);if(o&&(r.memoizedState=i,Wr=!0),r=r.queue,ST(xF.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Pn!==null&&Pn.memoizedState.tag&1){if(n.flags|=2048,Df(9,MF.bind(null,n,r,i,e),void 0,null),An===null)throw Error(ne(349));lu&30||_F(n,e,i)}return i}function _F(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Jt.updateQueue,e===null?(e={lastEffect:null,stores:null},Jt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function MF(t,e,n,r){e.value=n,e.getSnapshot=r,PF(e)&&OF(t)}function xF(t,e,n){return n(function(){PF(e)&&OF(t)})}function PF(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ao(t,n)}catch{return!0}}function OF(t){var e=ks(t,1);e!==null&&oo(e,t,1,-1)}function NP(t){var e=Ho();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hf,lastRenderedState:t},e.queue=t,t=t.dispatch=QY.bind(null,Jt,t),[e.memoizedState,t]}function Df(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Jt.updateQueue,e===null?(e={lastEffect:null,stores:null},Jt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function AF(){return xi().memoizedState}function Ap(t,e,n,r){var i=Ho();Jt.flags|=t,i.memoizedState=Df(1|e,n,void 0,r===void 0?null:r)}function Vv(t,e,n,r){var i=xi();r=r===void 0?null:r;var o=void 0;if(Cn!==null){var s=Cn.memoizedState;if(o=s.destroy,r!==null&&vT(r,s.deps)){i.memoizedState=Df(e,n,o,r);return}}Jt.flags|=t,i.memoizedState=Df(1|e,n,o,r)}function kP(t,e){return Ap(8390656,8,t,e)}function ST(t,e){return Vv(2048,8,t,e)}function IF(t,e){return Vv(4,2,t,e)}function HF(t,e){return Vv(4,4,t,e)}function DF(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function NF(t,e,n){return n=n!=null?n.concat([t]):null,Vv(4,4,DF.bind(null,e,t),n)}function bT(){}function kF(t,e){var n=xi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&vT(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function LF(t,e){var n=xi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&vT(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function $F(t,e,n){return lu&21?(ao(n,e)||(n=V$(),Jt.lanes|=n,uu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Wr=!0),t.memoizedState=n)}function XY(t,e){var n=Ct;Ct=n!==0&&4>n?n:4,t(!0);var r=Oy.transition;Oy.transition={};try{t(!1),e()}finally{Ct=n,Oy.transition=r}}function FF(){return xi().memoizedState}function qY(t,e,n){var r=Wa(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},WF(t))VF(e,n);else if(n=wF(t,e,n,r),n!==null){var i=vr();oo(n,t,r,i),BF(n,e,r)}}function QY(t,e,n){var r=Wa(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(WF(t))VF(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,ao(a,s)){var l=e.interleaved;l===null?(i.next=i,fT(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=wF(t,e,i,r),n!==null&&(i=vr(),oo(n,t,r,i),BF(n,e,r))}}function WF(t){var e=t.alternate;return t===Jt||e!==null&&e===Jt}function VF(t,e){Gd=Mw=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function BF(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,JE(t,n)}}var xw={readContext:Mi,useCallback:Bn,useContext:Bn,useEffect:Bn,useImperativeHandle:Bn,useInsertionEffect:Bn,useLayoutEffect:Bn,useMemo:Bn,useReducer:Bn,useRef:Bn,useState:Bn,useDebugValue:Bn,useDeferredValue:Bn,useTransition:Bn,useMutableSource:Bn,useSyncExternalStore:Bn,useId:Bn,unstable_isNewReconciler:!1},ZY={readContext:Mi,useCallback:function(t,e){return Ho().memoizedState=[t,e===void 0?null:e],t},useContext:Mi,useEffect:kP,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ap(4194308,4,DF.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ap(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ap(4,2,t,e)},useMemo:function(t,e){var n=Ho();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ho();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=qY.bind(null,Jt,t),[r.memoizedState,t]},useRef:function(t){var e=Ho();return t={current:t},e.memoizedState=t},useState:NP,useDebugValue:bT,useDeferredValue:function(t){return Ho().memoizedState=t},useTransition:function(){var t=NP(!1),e=t[0];return t=XY.bind(null,t[1]),Ho().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Jt,i=Ho();if(Vt){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=e(),An===null)throw Error(ne(349));lu&30||_F(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,kP(xF.bind(null,r,o,t),[t]),r.flags|=2048,Df(9,MF.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Ho(),e=An.identifierPrefix;if(Vt){var n=Rs,r=bs;n=(r&~(1<<32-io(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=If++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=KY++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},JY={readContext:Mi,useCallback:kF,useContext:Mi,useEffect:ST,useImperativeHandle:NF,useInsertionEffect:IF,useLayoutEffect:HF,useMemo:LF,useReducer:Ay,useRef:AF,useState:function(){return Ay(Hf)},useDebugValue:bT,useDeferredValue:function(t){var e=xi();return $F(e,Cn.memoizedState,t)},useTransition:function(){var t=Ay(Hf)[0],e=xi().memoizedState;return[t,e]},useMutableSource:EF,useSyncExternalStore:TF,useId:FF,unstable_isNewReconciler:!1},e3={readContext:Mi,useCallback:kF,useContext:Mi,useEffect:ST,useImperativeHandle:NF,useInsertionEffect:IF,useLayoutEffect:HF,useMemo:LF,useReducer:Iy,useRef:AF,useState:function(){return Iy(Hf)},useDebugValue:bT,useDeferredValue:function(t){var e=xi();return Cn===null?e.memoizedState=t:$F(e,Cn.memoizedState,t)},useTransition:function(){var t=Iy(Hf)[0],e=xi().memoizedState;return[t,e]},useMutableSource:EF,useSyncExternalStore:TF,useId:FF,unstable_isNewReconciler:!1};function oh(t,e){try{var n="",r=e;do n+=xG(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function Hy(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function iR(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var t3=typeof WeakMap=="function"?WeakMap:Map;function UF(t,e,n){n=Is(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ow||(Ow=!0,gR=r),iR(t,e)},n}function zF(t,e,n){n=Is(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){iR(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){iR(t,e),typeof r!="function"&&(Fa===null?Fa=new Set([this]):Fa.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function LP(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new t3;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=m3.bind(null,t,e,n),e.then(t,t))}function $P(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function FP(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Is(-1,1),e.tag=2,$a(n,e,1))),n.lanes|=1),t)}var n3=Bs.ReactCurrentOwner,Wr=!1;function fr(t,e,n,r){e.child=t===null?bF(e,null,n,r):rh(e,t.child,n,r)}function WP(t,e,n,r,i){n=n.render;var o=e.ref;return jc(e,i),r=CT(t,e,n,r,o,i),n=yT(),t!==null&&!Wr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ls(t,e,i)):(Vt&&n&&aT(e),e.flags|=1,fr(t,e,r,i),e.child)}function VP(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!OT(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,jF(t,e,o,r,i)):(t=Np(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:_f,n(s,r)&&t.ref===e.ref)return Ls(t,e,i)}return e.flags|=1,t=Va(o,r),t.ref=e.ref,t.return=e,e.child=t}function jF(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(_f(o,r)&&t.ref===e.ref)if(Wr=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(Wr=!0);else return e.lanes=t.lanes,Ls(t,e,i)}return oR(t,e,n,r,i)}function GF(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},xt(Nc,Qr),Qr|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,xt(Nc,Qr),Qr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,xt(Nc,Qr),Qr|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,xt(Nc,Qr),Qr|=r;return fr(t,e,i,n),e.child}function YF(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function oR(t,e,n,r,i){var o=Br(n)?su:Jn.current;return o=th(e,o),jc(e,i),n=CT(t,e,n,r,o,i),r=yT(),t!==null&&!Wr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ls(t,e,i)):(Vt&&r&&aT(e),e.flags|=1,fr(t,e,n,i),e.child)}function BP(t,e,n,r,i){if(Br(n)){var o=!0;yw(e)}else o=!1;if(jc(e,i),e.stateNode===null)Ip(t,e),yF(e,n,r),rR(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,u=n.contextType;typeof u=="object"&&u!==null?u=Mi(u):(u=Br(n)?su:Jn.current,u=th(e,u));var c=n.getDerivedStateFromProps,h=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==u)&&HP(e,s,r,u),pa=!1;var d=e.memoizedState;s.state=d,Tw(e,r,s,i),l=e.memoizedState,a!==r||d!==l||Vr.current||pa?(typeof c=="function"&&(nR(e,n,c,r),l=e.memoizedState),(a=pa||IP(e,n,a,r,d,l,u))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=u,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,vF(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:qi(e.type,a),s.props=u,h=e.pendingProps,d=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=Mi(l):(l=Br(n)?su:Jn.current,l=th(e,l));var f=n.getDerivedStateFromProps;(c=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==h||d!==l)&&HP(e,s,r,l),pa=!1,d=e.memoizedState,s.state=d,Tw(e,r,s,i);var m=e.memoizedState;a!==h||d!==m||Vr.current||pa?(typeof f=="function"&&(nR(e,n,f,r),m=e.memoizedState),(u=pa||IP(e,n,u,r,d,m,l)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,m,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,m,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),s.props=r,s.state=m,s.context=l,r=u):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return sR(t,e,n,r,o,i)}function sR(t,e,n,r,i,o){YF(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&MP(e,n,!1),Ls(t,e,o);r=e.stateNode,n3.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=rh(e,t.child,null,o),e.child=rh(e,null,a,o)):fr(t,e,a,o),e.memoizedState=r.state,i&&MP(e,n,!0),e.child}function KF(t){var e=t.stateNode;e.pendingContext?_P(t,e.pendingContext,e.pendingContext!==e.context):e.context&&_P(t,e.context,!1),mT(t,e.containerInfo)}function UP(t,e,n,r,i){return nh(),uT(i),e.flags|=256,fr(t,e,n,r),e.child}var aR={dehydrated:null,treeContext:null,retryLane:0};function lR(t){return{baseLanes:t,cachePool:null,transitions:null}}function XF(t,e,n){var r=e.pendingProps,i=Xt.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),xt(Xt,i&1),t===null)return eR(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=zv(s,r,0,null),t=iu(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=lR(n),e.memoizedState=aR,t):RT(e,s));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return r3(t,e,s,r,a,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Va(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=Va(a,o):(o=iu(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?lR(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=aR,r}return o=t.child,t=o.sibling,r=Va(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function RT(t,e){return e=zv({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Kg(t,e,n,r){return r!==null&&uT(r),rh(e,t.child,null,n),t=RT(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function r3(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=Hy(Error(ne(422))),Kg(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=zv({mode:"visible",children:r.children},i,0,null),o=iu(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&rh(e,t.child,null,s),e.child.memoizedState=lR(s),e.memoizedState=aR,o);if(!(e.mode&1))return Kg(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(ne(419)),r=Hy(o,r,void 0),Kg(t,e,s,r)}if(a=(s&t.childLanes)!==0,Wr||a){if(r=An,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,ks(t,i),oo(r,t,i,-1))}return PT(),r=Hy(Error(ne(421))),Kg(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=p3.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,ti=La(i.nextSibling),ri=e,Vt=!0,Ji=null,t!==null&&(Si[bi++]=bs,Si[bi++]=Rs,Si[bi++]=au,bs=t.id,Rs=t.overflow,au=e),e=RT(e,r.children),e.flags|=4096,e)}function zP(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),tR(t.return,e,n)}function Dy(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function qF(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(fr(t,e,r.children,n),r=Xt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&zP(t,n,e);else if(t.tag===19)zP(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(xt(Xt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&_w(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Dy(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&_w(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Dy(e,!0,n,null,o);break;case"together":Dy(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ip(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ls(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),uu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ne(153));if(e.child!==null){for(t=e.child,n=Va(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Va(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function i3(t,e,n){switch(e.tag){case 3:KF(e),nh();break;case 5:RF(e);break;case 1:Br(e.type)&&yw(e);break;case 4:mT(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;xt(Rw,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(xt(Xt,Xt.current&1),e.flags|=128,null):n&e.child.childLanes?XF(t,e,n):(xt(Xt,Xt.current&1),t=Ls(t,e,n),t!==null?t.sibling:null);xt(Xt,Xt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return qF(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),xt(Xt,Xt.current),r)break;return null;case 22:case 23:return e.lanes=0,GF(t,e,n)}return Ls(t,e,n)}var QF,uR,ZF,JF;QF=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};uR=function(){};ZF=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Xl(zo.current);var o=null;switch(n){case"input":i=A0(t,i),r=A0(t,r),o=[];break;case"select":i=en({},i,{value:void 0}),r=en({},r,{value:void 0}),o=[];break;case"textarea":i=D0(t,i),r=D0(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=vw)}k0(n,r);var s;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Cf.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Cf.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&At("scroll",t),o||a===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};JF=function(t,e,n,r){n!==r&&(e.flags|=4)};function Lh(t,e){if(!Vt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Un(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function o3(t,e,n){var r=e.pendingProps;switch(lT(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Un(e),null;case 1:return Br(e.type)&&Cw(),Un(e),null;case 3:return r=e.stateNode,ih(),Ht(Vr),Ht(Jn),wT(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Gg(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ji!==null&&(wR(Ji),Ji=null))),uR(t,e),Un(e),null;case 5:pT(e);var i=Xl(Af.current);if(n=e.type,t!==null&&e.stateNode!=null)ZF(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ne(166));return Un(e),null}if(t=Xl(zo.current),Gg(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Lo]=e,r[Pf]=o,t=(e.mode&1)!==0,n){case"dialog":At("cancel",r),At("close",r);break;case"iframe":case"object":case"embed":At("load",r);break;case"video":case"audio":for(i=0;i<Dd.length;i++)At(Dd[i],r);break;case"source":At("error",r);break;case"img":case"image":case"link":At("error",r),At("load",r);break;case"details":At("toggle",r);break;case"input":Jx(r,o),At("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},At("invalid",r);break;case"textarea":tP(r,o),At("invalid",r)}k0(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&jg(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&jg(r.textContent,a,t),i=["children",""+a]):Cf.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&At("scroll",r)}switch(n){case"input":Lg(r),eP(r,o,!0);break;case"textarea":Lg(r),nP(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=vw)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=_$(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[Lo]=e,t[Pf]=r,QF(t,e,!1,!1),e.stateNode=t;e:{switch(s=L0(n,r),n){case"dialog":At("cancel",t),At("close",t),i=r;break;case"iframe":case"object":case"embed":At("load",t),i=r;break;case"video":case"audio":for(i=0;i<Dd.length;i++)At(Dd[i],t);i=r;break;case"source":At("error",t),i=r;break;case"img":case"image":case"link":At("error",t),At("load",t),i=r;break;case"details":At("toggle",t),i=r;break;case"input":Jx(t,r),i=A0(t,r),At("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=en({},r,{value:void 0}),At("invalid",t);break;case"textarea":tP(t,r),i=D0(t,r),At("invalid",t);break;default:i=r}k0(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?P$(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&M$(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&yf(t,l):typeof l=="number"&&yf(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Cf.hasOwnProperty(o)?l!=null&&o==="onScroll"&&At("scroll",t):l!=null&&YE(t,o,l,s))}switch(n){case"input":Lg(t),eP(t,r,!1);break;case"textarea":Lg(t),nP(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ka(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Vc(t,!!r.multiple,o,!1):r.defaultValue!=null&&Vc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=vw)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Un(e),null;case 6:if(t&&e.stateNode!=null)JF(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ne(166));if(n=Xl(Af.current),Xl(zo.current),Gg(e)){if(r=e.stateNode,n=e.memoizedProps,r[Lo]=e,(o=r.nodeValue!==n)&&(t=ri,t!==null))switch(t.tag){case 3:jg(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&jg(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Lo]=e,e.stateNode=r}return Un(e),null;case 13:if(Ht(Xt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Vt&&ti!==null&&e.mode&1&&!(e.flags&128))pF(),nh(),e.flags|=98560,o=!1;else if(o=Gg(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(ne(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ne(317));o[Lo]=e}else nh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Un(e),o=!1}else Ji!==null&&(wR(Ji),Ji=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Xt.current&1?Sn===0&&(Sn=3):PT())),e.updateQueue!==null&&(e.flags|=4),Un(e),null);case 4:return ih(),uR(t,e),t===null&&Mf(e.stateNode.containerInfo),Un(e),null;case 10:return dT(e.type._context),Un(e),null;case 17:return Br(e.type)&&Cw(),Un(e),null;case 19:if(Ht(Xt),o=e.memoizedState,o===null)return Un(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)Lh(o,!1);else{if(Sn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=_w(t),s!==null){for(e.flags|=128,Lh(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return xt(Xt,Xt.current&1|2),e.child}t=t.sibling}o.tail!==null&&cn()>sh&&(e.flags|=128,r=!0,Lh(o,!1),e.lanes=4194304)}else{if(!r)if(t=_w(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Lh(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Vt)return Un(e),null}else 2*cn()-o.renderingStartTime>sh&&n!==1073741824&&(e.flags|=128,r=!0,Lh(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=cn(),e.sibling=null,n=Xt.current,xt(Xt,r?n&1|2:n&1),e):(Un(e),null);case 22:case 23:return xT(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Qr&1073741824&&(Un(e),e.subtreeFlags&6&&(e.flags|=8192)):Un(e),null;case 24:return null;case 25:return null}throw Error(ne(156,e.tag))}function s3(t,e){switch(lT(e),e.tag){case 1:return Br(e.type)&&Cw(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ih(),Ht(Vr),Ht(Jn),wT(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return pT(e),null;case 13:if(Ht(Xt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ne(340));nh()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ht(Xt),null;case 4:return ih(),null;case 10:return dT(e.type._context),null;case 22:case 23:return xT(),null;case 24:return null;default:return null}}var Xg=!1,Xn=!1,a3=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function Dc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){sn(t,e,r)}else n.current=null}function cR(t,e,n){try{n()}catch(r){sn(t,e,r)}}var jP=!1;function l3(t,e){if(Y0=mw,t=rF(),sT(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,u=0,c=0,h=t,d=null;t:for(;;){for(var f;h!==n||i!==0&&h.nodeType!==3||(a=s+i),h!==o||r!==0&&h.nodeType!==3||(l=s+r),h.nodeType===3&&(s+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===t)break t;if(d===n&&++u===i&&(a=s),d===o&&++c===r&&(l=s),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(K0={focusedElem:t,selectionRange:n},mw=!1,Ce=e;Ce!==null;)if(e=Ce,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ce=t;else for(;Ce!==null;){e=Ce;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var C=m.memoizedProps,b=m.memoizedState,p=e.stateNode,w=p.getSnapshotBeforeUpdate(e.elementType===e.type?C:qi(e.type,C),b);p.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(E){sn(e,e.return,E)}if(t=e.sibling,t!==null){t.return=e.return,Ce=t;break}Ce=e.return}return m=jP,jP=!1,m}function Yd(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&cR(e,n,o)}i=i.next}while(i!==r)}}function Bv(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function hR(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function eW(t){var e=t.alternate;e!==null&&(t.alternate=null,eW(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Lo],delete e[Pf],delete e[Q0],delete e[zY],delete e[jY])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function tW(t){return t.tag===5||t.tag===3||t.tag===4}function GP(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||tW(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function dR(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=vw));else if(r!==4&&(t=t.child,t!==null))for(dR(t,e,n),t=t.sibling;t!==null;)dR(t,e,n),t=t.sibling}function fR(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(fR(t,e,n),t=t.sibling;t!==null;)fR(t,e,n),t=t.sibling}var Ln=null,Qi=!1;function Qs(t,e,n){for(n=n.child;n!==null;)nW(t,e,n),n=n.sibling}function nW(t,e,n){if(Uo&&typeof Uo.onCommitFiberUnmount=="function")try{Uo.onCommitFiberUnmount(Dv,n)}catch{}switch(n.tag){case 5:Xn||Dc(n,e);case 6:var r=Ln,i=Qi;Ln=null,Qs(t,e,n),Ln=r,Qi=i,Ln!==null&&(Qi?(t=Ln,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ln.removeChild(n.stateNode));break;case 18:Ln!==null&&(Qi?(t=Ln,n=n.stateNode,t.nodeType===8?My(t.parentNode,n):t.nodeType===1&&My(t,n),Ef(t)):My(Ln,n.stateNode));break;case 4:r=Ln,i=Qi,Ln=n.stateNode.containerInfo,Qi=!0,Qs(t,e,n),Ln=r,Qi=i;break;case 0:case 11:case 14:case 15:if(!Xn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&cR(n,e,s),i=i.next}while(i!==r)}Qs(t,e,n);break;case 1:if(!Xn&&(Dc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){sn(n,e,a)}Qs(t,e,n);break;case 21:Qs(t,e,n);break;case 22:n.mode&1?(Xn=(r=Xn)||n.memoizedState!==null,Qs(t,e,n),Xn=r):Qs(t,e,n);break;default:Qs(t,e,n)}}function YP(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new a3),e.forEach(function(r){var i=w3.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Ni(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:Ln=a.stateNode,Qi=!1;break e;case 3:Ln=a.stateNode.containerInfo,Qi=!0;break e;case 4:Ln=a.stateNode.containerInfo,Qi=!0;break e}a=a.return}if(Ln===null)throw Error(ne(160));nW(o,s,i),Ln=null,Qi=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){sn(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)rW(e,t),e=e.sibling}function rW(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ni(e,t),mo(t),r&4){try{Yd(3,t,t.return),Bv(3,t)}catch(C){sn(t,t.return,C)}try{Yd(5,t,t.return)}catch(C){sn(t,t.return,C)}}break;case 1:Ni(e,t),mo(t),r&512&&n!==null&&Dc(n,n.return);break;case 5:if(Ni(e,t),mo(t),r&512&&n!==null&&Dc(n,n.return),t.flags&32){var i=t.stateNode;try{yf(i,"")}catch(C){sn(t,t.return,C)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&E$(i,o),L0(a,s);var u=L0(a,o);for(s=0;s<l.length;s+=2){var c=l[s],h=l[s+1];c==="style"?P$(i,h):c==="dangerouslySetInnerHTML"?M$(i,h):c==="children"?yf(i,h):YE(i,c,h,u)}switch(a){case"input":I0(i,o);break;case"textarea":T$(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?Vc(i,!!o.multiple,f,!1):d!==!!o.multiple&&(o.defaultValue!=null?Vc(i,!!o.multiple,o.defaultValue,!0):Vc(i,!!o.multiple,o.multiple?[]:"",!1))}i[Pf]=o}catch(C){sn(t,t.return,C)}}break;case 6:if(Ni(e,t),mo(t),r&4){if(t.stateNode===null)throw Error(ne(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(C){sn(t,t.return,C)}}break;case 3:if(Ni(e,t),mo(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ef(e.containerInfo)}catch(C){sn(t,t.return,C)}break;case 4:Ni(e,t),mo(t);break;case 13:Ni(e,t),mo(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(_T=cn())),r&4&&YP(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Xn=(u=Xn)||c,Ni(e,t),Xn=u):Ni(e,t),mo(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(Ce=t,c=t.child;c!==null;){for(h=Ce=c;Ce!==null;){switch(d=Ce,f=d.child,d.tag){case 0:case 11:case 14:case 15:Yd(4,d,d.return);break;case 1:Dc(d,d.return);var m=d.stateNode;if(typeof m.componentWillUnmount=="function"){r=d,n=d.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(C){sn(r,n,C)}}break;case 5:Dc(d,d.return);break;case 22:if(d.memoizedState!==null){XP(h);continue}}f!==null?(f.return=d,Ce=f):XP(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=h.stateNode,l=h.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=x$("display",s))}catch(C){sn(t,t.return,C)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(C){sn(t,t.return,C)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ni(e,t),mo(t),r&4&&YP(t);break;case 21:break;default:Ni(e,t),mo(t)}}function mo(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(tW(n)){var r=n;break e}n=n.return}throw Error(ne(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(yf(i,""),r.flags&=-33);var o=GP(t);fR(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=GP(t);dR(t,a,s);break;default:throw Error(ne(161))}}catch(l){sn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function u3(t,e,n){Ce=t,iW(t)}function iW(t,e,n){for(var r=(t.mode&1)!==0;Ce!==null;){var i=Ce,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Xg;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Xn;a=Xg;var u=Xn;if(Xg=s,(Xn=l)&&!u)for(Ce=i;Ce!==null;)s=Ce,l=s.child,s.tag===22&&s.memoizedState!==null?qP(i):l!==null?(l.return=s,Ce=l):qP(i);for(;o!==null;)Ce=o,iW(o),o=o.sibling;Ce=i,Xg=a,Xn=u}KP(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,Ce=o):KP(t)}}function KP(t){for(;Ce!==null;){var e=Ce;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Xn||Bv(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Xn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:qi(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&AP(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}AP(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Ef(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}Xn||e.flags&512&&hR(e)}catch(d){sn(e,e.return,d)}}if(e===t){Ce=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ce=n;break}Ce=e.return}}function XP(t){for(;Ce!==null;){var e=Ce;if(e===t){Ce=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ce=n;break}Ce=e.return}}function qP(t){for(;Ce!==null;){var e=Ce;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Bv(4,e)}catch(l){sn(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){sn(e,i,l)}}var o=e.return;try{hR(e)}catch(l){sn(e,o,l)}break;case 5:var s=e.return;try{hR(e)}catch(l){sn(e,s,l)}}}catch(l){sn(e,e.return,l)}if(e===t){Ce=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ce=a;break}Ce=e.return}}var c3=Math.ceil,Pw=Bs.ReactCurrentDispatcher,ET=Bs.ReactCurrentOwner,Ti=Bs.ReactCurrentBatchConfig,lt=0,An=null,mn=null,Fn=0,Qr=0,Nc=il(0),Sn=0,Nf=null,uu=0,Uv=0,TT=0,Kd=null,$r=null,_T=0,sh=1/0,ms=null,Ow=!1,gR=null,Fa=null,qg=!1,Ma=null,Aw=0,Xd=0,mR=null,Hp=-1,Dp=0;function vr(){return lt&6?cn():Hp!==-1?Hp:Hp=cn()}function Wa(t){return t.mode&1?lt&2&&Fn!==0?Fn&-Fn:YY.transition!==null?(Dp===0&&(Dp=V$()),Dp):(t=Ct,t!==0||(t=window.event,t=t===void 0?16:K$(t.type)),t):1}function oo(t,e,n,r){if(50<Xd)throw Xd=0,mR=null,Error(ne(185));ig(t,n,r),(!(lt&2)||t!==An)&&(t===An&&(!(lt&2)&&(Uv|=n),Sn===4&&ya(t,Fn)),Ur(t,r),n===1&&lt===0&&!(e.mode&1)&&(sh=cn()+500,Fv&&ol()))}function Ur(t,e){var n=t.callbackNode;YG(t,e);var r=gw(t,t===An?Fn:0);if(r===0)n!==null&&oP(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&oP(n),e===1)t.tag===0?GY(QP.bind(null,t)):fF(QP.bind(null,t)),BY(function(){!(lt&6)&&ol()}),n=null;else{switch(B$(r)){case 1:n=ZE;break;case 4:n=F$;break;case 16:n=fw;break;case 536870912:n=W$;break;default:n=fw}n=dW(n,oW.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function oW(t,e){if(Hp=-1,Dp=0,lt&6)throw Error(ne(327));var n=t.callbackNode;if(Gc()&&t.callbackNode!==n)return null;var r=gw(t,t===An?Fn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Iw(t,r);else{e=r;var i=lt;lt|=2;var o=aW();(An!==t||Fn!==e)&&(ms=null,sh=cn()+500,ru(t,e));do try{f3();break}catch(a){sW(t,a)}while(1);hT(),Pw.current=o,lt=i,mn!==null?e=0:(An=null,Fn=0,e=Sn)}if(e!==0){if(e===2&&(i=B0(t),i!==0&&(r=i,e=pR(t,i))),e===1)throw n=Nf,ru(t,0),ya(t,r),Ur(t,cn()),n;if(e===6)ya(t,r);else{if(i=t.current.alternate,!(r&30)&&!h3(i)&&(e=Iw(t,r),e===2&&(o=B0(t),o!==0&&(r=o,e=pR(t,o))),e===1))throw n=Nf,ru(t,0),ya(t,r),Ur(t,cn()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ne(345));case 2:zl(t,$r,ms);break;case 3:if(ya(t,r),(r&130023424)===r&&(e=_T+500-cn(),10<e)){if(gw(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){vr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=q0(zl.bind(null,t,$r,ms),e);break}zl(t,$r,ms);break;case 4:if(ya(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-io(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=cn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*c3(r/1960))-r,10<r){t.timeoutHandle=q0(zl.bind(null,t,$r,ms),r);break}zl(t,$r,ms);break;case 5:zl(t,$r,ms);break;default:throw Error(ne(329))}}}return Ur(t,cn()),t.callbackNode===n?oW.bind(null,t):null}function pR(t,e){var n=Kd;return t.current.memoizedState.isDehydrated&&(ru(t,e).flags|=256),t=Iw(t,e),t!==2&&(e=$r,$r=n,e!==null&&wR(e)),t}function wR(t){$r===null?$r=t:$r.push.apply($r,t)}function h3(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!ao(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ya(t,e){for(e&=~TT,e&=~Uv,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-io(e),r=1<<n;t[n]=-1,e&=~r}}function QP(t){if(lt&6)throw Error(ne(327));Gc();var e=gw(t,0);if(!(e&1))return Ur(t,cn()),null;var n=Iw(t,e);if(t.tag!==0&&n===2){var r=B0(t);r!==0&&(e=r,n=pR(t,r))}if(n===1)throw n=Nf,ru(t,0),ya(t,e),Ur(t,cn()),n;if(n===6)throw Error(ne(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,zl(t,$r,ms),Ur(t,cn()),null}function MT(t,e){var n=lt;lt|=1;try{return t(e)}finally{lt=n,lt===0&&(sh=cn()+500,Fv&&ol())}}function cu(t){Ma!==null&&Ma.tag===0&&!(lt&6)&&Gc();var e=lt;lt|=1;var n=Ti.transition,r=Ct;try{if(Ti.transition=null,Ct=1,t)return t()}finally{Ct=r,Ti.transition=n,lt=e,!(lt&6)&&ol()}}function xT(){Qr=Nc.current,Ht(Nc)}function ru(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,VY(n)),mn!==null)for(n=mn.return;n!==null;){var r=n;switch(lT(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Cw();break;case 3:ih(),Ht(Vr),Ht(Jn),wT();break;case 5:pT(r);break;case 4:ih();break;case 13:Ht(Xt);break;case 19:Ht(Xt);break;case 10:dT(r.type._context);break;case 22:case 23:xT()}n=n.return}if(An=t,mn=t=Va(t.current,null),Fn=Qr=e,Sn=0,Nf=null,TT=Uv=uu=0,$r=Kd=null,Kl!==null){for(e=0;e<Kl.length;e++)if(n=Kl[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}Kl=null}return t}function sW(t,e){do{var n=mn;try{if(hT(),Op.current=xw,Mw){for(var r=Jt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Mw=!1}if(lu=0,Pn=Cn=Jt=null,Gd=!1,If=0,ET.current=null,n===null||n.return===null){Sn=1,Nf=e,mn=null;break}e:{var o=t,s=n.return,a=n,l=e;if(e=Fn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=$P(s);if(f!==null){f.flags&=-257,FP(f,s,a,o,e),f.mode&1&&LP(o,u,e),e=f,l=u;var m=e.updateQueue;if(m===null){var C=new Set;C.add(l),e.updateQueue=C}else m.add(l);break e}else{if(!(e&1)){LP(o,u,e),PT();break e}l=Error(ne(426))}}else if(Vt&&a.mode&1){var b=$P(s);if(b!==null){!(b.flags&65536)&&(b.flags|=256),FP(b,s,a,o,e),uT(oh(l,a));break e}}o=l=oh(l,a),Sn!==4&&(Sn=2),Kd===null?Kd=[o]:Kd.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var p=UF(o,l,e);OP(o,p);break e;case 1:a=l;var w=o.type,y=o.stateNode;if(!(o.flags&128)&&(typeof w.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Fa===null||!Fa.has(y)))){o.flags|=65536,e&=-e,o.lanes|=e;var E=zF(o,a,e);OP(o,E);break e}}o=o.return}while(o!==null)}uW(n)}catch(T){e=T,mn===n&&n!==null&&(mn=n=n.return);continue}break}while(1)}function aW(){var t=Pw.current;return Pw.current=xw,t===null?xw:t}function PT(){(Sn===0||Sn===3||Sn===2)&&(Sn=4),An===null||!(uu&268435455)&&!(Uv&268435455)||ya(An,Fn)}function Iw(t,e){var n=lt;lt|=2;var r=aW();(An!==t||Fn!==e)&&(ms=null,ru(t,e));do try{d3();break}catch(i){sW(t,i)}while(1);if(hT(),lt=n,Pw.current=r,mn!==null)throw Error(ne(261));return An=null,Fn=0,Sn}function d3(){for(;mn!==null;)lW(mn)}function f3(){for(;mn!==null&&!$G();)lW(mn)}function lW(t){var e=hW(t.alternate,t,Qr);t.memoizedProps=t.pendingProps,e===null?uW(t):mn=e,ET.current=null}function uW(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=s3(n,e),n!==null){n.flags&=32767,mn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Sn=6,mn=null;return}}else if(n=o3(n,e,Qr),n!==null){mn=n;return}if(e=e.sibling,e!==null){mn=e;return}mn=e=t}while(e!==null);Sn===0&&(Sn=5)}function zl(t,e,n){var r=Ct,i=Ti.transition;try{Ti.transition=null,Ct=1,g3(t,e,n,r)}finally{Ti.transition=i,Ct=r}return null}function g3(t,e,n,r){do Gc();while(Ma!==null);if(lt&6)throw Error(ne(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ne(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(KG(t,o),t===An&&(mn=An=null,Fn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||qg||(qg=!0,dW(fw,function(){return Gc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Ti.transition,Ti.transition=null;var s=Ct;Ct=1;var a=lt;lt|=4,ET.current=null,l3(t,n),rW(n,t),DY(K0),mw=!!Y0,K0=Y0=null,t.current=n,u3(n),FG(),lt=a,Ct=s,Ti.transition=o}else t.current=n;if(qg&&(qg=!1,Ma=t,Aw=i),o=t.pendingLanes,o===0&&(Fa=null),BG(n.stateNode),Ur(t,cn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ow)throw Ow=!1,t=gR,gR=null,t;return Aw&1&&t.tag!==0&&Gc(),o=t.pendingLanes,o&1?t===mR?Xd++:(Xd=0,mR=t):Xd=0,ol(),null}function Gc(){if(Ma!==null){var t=B$(Aw),e=Ti.transition,n=Ct;try{if(Ti.transition=null,Ct=16>t?16:t,Ma===null)var r=!1;else{if(t=Ma,Ma=null,Aw=0,lt&6)throw Error(ne(331));var i=lt;for(lt|=4,Ce=t.current;Ce!==null;){var o=Ce,s=o.child;if(Ce.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Ce=u;Ce!==null;){var c=Ce;switch(c.tag){case 0:case 11:case 15:Yd(8,c,o)}var h=c.child;if(h!==null)h.return=c,Ce=h;else for(;Ce!==null;){c=Ce;var d=c.sibling,f=c.return;if(eW(c),c===u){Ce=null;break}if(d!==null){d.return=f,Ce=d;break}Ce=f}}}var m=o.alternate;if(m!==null){var C=m.child;if(C!==null){m.child=null;do{var b=C.sibling;C.sibling=null,C=b}while(C!==null)}}Ce=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,Ce=s;else e:for(;Ce!==null;){if(o=Ce,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Yd(9,o,o.return)}var p=o.sibling;if(p!==null){p.return=o.return,Ce=p;break e}Ce=o.return}}var w=t.current;for(Ce=w;Ce!==null;){s=Ce;var y=s.child;if(s.subtreeFlags&2064&&y!==null)y.return=s,Ce=y;else e:for(s=w;Ce!==null;){if(a=Ce,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Bv(9,a)}}catch(T){sn(a,a.return,T)}if(a===s){Ce=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,Ce=E;break e}Ce=a.return}}if(lt=i,ol(),Uo&&typeof Uo.onPostCommitFiberRoot=="function")try{Uo.onPostCommitFiberRoot(Dv,t)}catch{}r=!0}return r}finally{Ct=n,Ti.transition=e}}return!1}function ZP(t,e,n){e=oh(n,e),e=UF(t,e,1),t=$a(t,e,1),e=vr(),t!==null&&(ig(t,1,e),Ur(t,e))}function sn(t,e,n){if(t.tag===3)ZP(t,t,n);else for(;e!==null;){if(e.tag===3){ZP(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Fa===null||!Fa.has(r))){t=oh(n,t),t=zF(e,t,1),e=$a(e,t,1),t=vr(),e!==null&&(ig(e,1,t),Ur(e,t));break}}e=e.return}}function m3(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=vr(),t.pingedLanes|=t.suspendedLanes&n,An===t&&(Fn&n)===n&&(Sn===4||Sn===3&&(Fn&130023424)===Fn&&500>cn()-_T?ru(t,0):TT|=n),Ur(t,e)}function cW(t,e){e===0&&(t.mode&1?(e=Wg,Wg<<=1,!(Wg&130023424)&&(Wg=4194304)):e=1);var n=vr();t=ks(t,e),t!==null&&(ig(t,e,n),Ur(t,n))}function p3(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),cW(t,n)}function w3(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ne(314))}r!==null&&r.delete(e),cW(t,n)}var hW;hW=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Vr.current)Wr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Wr=!1,i3(t,e,n);Wr=!!(t.flags&131072)}else Wr=!1,Vt&&e.flags&1048576&&gF(e,bw,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ip(t,e),t=e.pendingProps;var i=th(e,Jn.current);jc(e,n),i=CT(null,e,r,t,i,n);var o=yT();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Br(r)?(o=!0,yw(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,gT(e),i.updater=Wv,e.stateNode=i,i._reactInternals=e,rR(e,r,t,n),e=sR(null,e,r,!0,o,n)):(e.tag=0,Vt&&o&&aT(e),fr(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ip(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=C3(r),t=qi(r,t),i){case 0:e=oR(null,e,r,t,n);break e;case 1:e=BP(null,e,r,t,n);break e;case 11:e=WP(null,e,r,t,n);break e;case 14:e=VP(null,e,r,qi(r.type,t),n);break e}throw Error(ne(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:qi(r,i),oR(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:qi(r,i),BP(t,e,r,i,n);case 3:e:{if(KF(e),t===null)throw Error(ne(387));r=e.pendingProps,o=e.memoizedState,i=o.element,vF(t,e),Tw(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=oh(Error(ne(423)),e),e=UP(t,e,r,n,i);break e}else if(r!==i){i=oh(Error(ne(424)),e),e=UP(t,e,r,n,i);break e}else for(ti=La(e.stateNode.containerInfo.firstChild),ri=e,Vt=!0,Ji=null,n=bF(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(nh(),r===i){e=Ls(t,e,n);break e}fr(t,e,r,n)}e=e.child}return e;case 5:return RF(e),t===null&&eR(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,X0(r,i)?s=null:o!==null&&X0(r,o)&&(e.flags|=32),YF(t,e),fr(t,e,s,n),e.child;case 6:return t===null&&eR(e),null;case 13:return XF(t,e,n);case 4:return mT(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=rh(e,null,r,n):fr(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:qi(r,i),WP(t,e,r,i,n);case 7:return fr(t,e,e.pendingProps,n),e.child;case 8:return fr(t,e,e.pendingProps.children,n),e.child;case 12:return fr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,xt(Rw,r._currentValue),r._currentValue=s,o!==null)if(ao(o.value,s)){if(o.children===i.children&&!Vr.current){e=Ls(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=Is(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),tR(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(ne(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),tR(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}fr(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,jc(e,n),i=Mi(i),r=r(i),e.flags|=1,fr(t,e,r,n),e.child;case 14:return r=e.type,i=qi(r,e.pendingProps),i=qi(r.type,i),VP(t,e,r,i,n);case 15:return jF(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:qi(r,i),Ip(t,e),e.tag=1,Br(r)?(t=!0,yw(e)):t=!1,jc(e,n),yF(e,r,i),rR(e,r,i,n),sR(null,e,r,!0,t,n);case 19:return qF(t,e,n);case 22:return GF(t,e,n)}throw Error(ne(156,e.tag))};function dW(t,e){return $$(t,e)}function v3(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ei(t,e,n,r){return new v3(t,e,n,r)}function OT(t){return t=t.prototype,!(!t||!t.isReactComponent)}function C3(t){if(typeof t=="function")return OT(t)?1:0;if(t!=null){if(t=t.$$typeof,t===XE)return 11;if(t===qE)return 14}return 2}function Va(t,e){var n=t.alternate;return n===null?(n=Ei(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Np(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")OT(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case Tc:return iu(n.children,i,o,e);case KE:s=8,i|=8;break;case M0:return t=Ei(12,n,e,i|2),t.elementType=M0,t.lanes=o,t;case x0:return t=Ei(13,n,e,i),t.elementType=x0,t.lanes=o,t;case P0:return t=Ei(19,n,e,i),t.elementType=P0,t.lanes=o,t;case S$:return zv(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case C$:s=10;break e;case y$:s=9;break e;case XE:s=11;break e;case qE:s=14;break e;case ma:s=16,r=null;break e}throw Error(ne(130,t==null?t:typeof t,""))}return e=Ei(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function iu(t,e,n,r){return t=Ei(7,t,r,e),t.lanes=n,t}function zv(t,e,n,r){return t=Ei(22,t,r,e),t.elementType=S$,t.lanes=n,t.stateNode={isHidden:!1},t}function Ny(t,e,n){return t=Ei(6,t,null,e),t.lanes=n,t}function ky(t,e,n){return e=Ei(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function y3(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=py(0),this.expirationTimes=py(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=py(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function AT(t,e,n,r,i,o,s,a,l){return t=new y3(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Ei(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},gT(o),t}function S3(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ec,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function fW(t){if(!t)return Xa;t=t._reactInternals;e:{if(vu(t)!==t||t.tag!==1)throw Error(ne(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Br(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ne(171))}if(t.tag===1){var n=t.type;if(Br(n))return dF(t,n,e)}return e}function gW(t,e,n,r,i,o,s,a,l){return t=AT(n,r,!0,t,i,o,s,a,l),t.context=fW(null),n=t.current,r=vr(),i=Wa(n),o=Is(r,i),o.callback=e??null,$a(n,o,i),t.current.lanes=i,ig(t,i,r),Ur(t,r),t}function jv(t,e,n,r){var i=e.current,o=vr(),s=Wa(i);return n=fW(n),e.context===null?e.context=n:e.pendingContext=n,e=Is(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=$a(i,e,s),t!==null&&(oo(t,i,s,o),Pp(t,i,s)),s}function Hw(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function JP(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function IT(t,e){JP(t,e),(t=t.alternate)&&JP(t,e)}function b3(){return null}var mW=typeof reportError=="function"?reportError:function(t){console.error(t)};function HT(t){this._internalRoot=t}Gv.prototype.render=HT.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ne(409));jv(t,e,null,null)};Gv.prototype.unmount=HT.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;cu(function(){jv(null,t,null,null)}),e[Ns]=null}};function Gv(t){this._internalRoot=t}Gv.prototype.unstable_scheduleHydration=function(t){if(t){var e=j$();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ca.length&&e!==0&&e<Ca[n].priority;n++);Ca.splice(n,0,t),n===0&&Y$(t)}};function DT(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Yv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function eO(){}function R3(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var u=Hw(s);o.call(u)}}var s=gW(e,r,t,0,null,!1,!1,"",eO);return t._reactRootContainer=s,t[Ns]=s.current,Mf(t.nodeType===8?t.parentNode:t),cu(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=Hw(l);a.call(u)}}var l=AT(t,0,!1,null,null,!1,!1,"",eO);return t._reactRootContainer=l,t[Ns]=l.current,Mf(t.nodeType===8?t.parentNode:t),cu(function(){jv(e,l,n,r)}),l}function Kv(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=Hw(s);a.call(l)}}jv(e,s,t,i)}else s=R3(n,e,t,i,r);return Hw(s)}U$=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Hd(e.pendingLanes);n!==0&&(JE(e,n|1),Ur(e,cn()),!(lt&6)&&(sh=cn()+500,ol()))}break;case 13:cu(function(){var r=ks(t,1);if(r!==null){var i=vr();oo(r,t,1,i)}}),IT(t,1)}};eT=function(t){if(t.tag===13){var e=ks(t,134217728);if(e!==null){var n=vr();oo(e,t,134217728,n)}IT(t,134217728)}};z$=function(t){if(t.tag===13){var e=Wa(t),n=ks(t,e);if(n!==null){var r=vr();oo(n,t,e,r)}IT(t,e)}};j$=function(){return Ct};G$=function(t,e){var n=Ct;try{return Ct=t,e()}finally{Ct=n}};F0=function(t,e,n){switch(e){case"input":if(I0(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=$v(r);if(!i)throw Error(ne(90));R$(r),I0(r,i)}}}break;case"textarea":T$(t,n);break;case"select":e=n.value,e!=null&&Vc(t,!!n.multiple,e,!1)}};I$=MT;H$=cu;var E3={usingClientEntryPoint:!1,Events:[sg,Pc,$v,O$,A$,MT]},$h={findFiberByHostInstance:Yl,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},T3={bundleType:$h.bundleType,version:$h.version,rendererPackageName:$h.rendererPackageName,rendererConfig:$h.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Bs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=k$(t),t===null?null:t.stateNode},findFiberByHostInstance:$h.findFiberByHostInstance||b3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qg.isDisabled&&Qg.supportsFiber)try{Dv=Qg.inject(T3),Uo=Qg}catch{}}si.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=E3;si.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!DT(e))throw Error(ne(200));return S3(t,e,null,n)};si.createRoot=function(t,e){if(!DT(t))throw Error(ne(299));var n=!1,r="",i=mW;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=AT(t,1,!1,null,null,n,!1,r,i),t[Ns]=e.current,Mf(t.nodeType===8?t.parentNode:t),new HT(e)};si.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ne(188)):(t=Object.keys(t).join(","),Error(ne(268,t)));return t=k$(e),t=t===null?null:t.stateNode,t};si.flushSync=function(t){return cu(t)};si.hydrate=function(t,e,n){if(!Yv(e))throw Error(ne(200));return Kv(null,t,e,!0,n)};si.hydrateRoot=function(t,e,n){if(!DT(t))throw Error(ne(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=mW;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=gW(e,null,t,1,n??null,i,!1,o,s),t[Ns]=e.current,Mf(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Gv(e)};si.render=function(t,e,n){if(!Yv(e))throw Error(ne(200));return Kv(null,t,e,!1,n)};si.unmountComponentAtNode=function(t){if(!Yv(t))throw Error(ne(40));return t._reactRootContainer?(cu(function(){Kv(null,null,t,!1,function(){t._reactRootContainer=null,t[Ns]=null})}),!0):!1};si.unstable_batchedUpdates=MT;si.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Yv(n))throw Error(ne(200));if(t==null||t._reactInternals===void 0)throw Error(ne(38));return Kv(t,e,n,!1,r)};si.version="18.2.0-next-9e3b772b8-20220608";function pW(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(pW)}catch(t){console.error(t)}}pW(),g$.exports=si;var wW=g$.exports;const vW=Av(wW);var tO=wW;T0.createRoot=tO.createRoot,T0.hydrateRoot=tO.hydrateRoot;var Fh=function(t){return t&&t.Math===Math&&t},nr=Fh(typeof globalThis=="object"&&globalThis)||Fh(typeof window=="object"&&window)||Fh(typeof self=="object"&&self)||Fh(typeof to=="object"&&to)||Fh(typeof to=="object"&&to)||function(){return this}()||Function("return this")(),NT={},Ai=function(t){try{return!!t()}catch{return!0}},_3=Ai,Yo=!_3(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),M3=Ai,Xv=!M3(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),x3=Xv,Zg=Function.prototype.call,Cu=x3?Zg.bind(Zg):function(){return Zg.apply(Zg,arguments)},CW={},yW={}.propertyIsEnumerable,SW=Object.getOwnPropertyDescriptor,P3=SW&&!yW.call({1:2},1);CW.f=P3?function(e){var n=SW(this,e);return!!n&&n.enumerable}:yW;var qv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},bW=Xv,RW=Function.prototype,vR=RW.call,O3=bW&&RW.bind.bind(vR,vR),Rr=bW?O3:function(t){return function(){return vR.apply(t,arguments)}},EW=Rr,A3=EW({}.toString),I3=EW("".slice),wh=function(t){return I3(A3(t),8,-1)},H3=Rr,D3=Ai,N3=wh,Ly=Object,k3=H3("".split),L3=D3(function(){return!Ly("z").propertyIsEnumerable(0)})?function(t){return N3(t)==="String"?k3(t,""):Ly(t)}:Ly,kT=function(t){return t==null},$3=kT,F3=TypeError,TW=function(t){if($3(t))throw new F3("Can't call method on "+t);return t},W3=L3,V3=TW,Qv=function(t){return W3(V3(t))},$y=typeof document=="object"&&document.all,rr=typeof $y>"u"&&$y!==void 0?function(t){return typeof t=="function"||t===$y}:function(t){return typeof t=="function"},B3=rr,sl=function(t){return typeof t=="object"?t!==null:B3(t)},Fy=nr,U3=rr,z3=function(t){return U3(t)?t:void 0},lg=function(t,e){return arguments.length<2?z3(Fy[t]):Fy[t]&&Fy[t][e]},j3=Rr,LT=j3({}.isPrototypeOf),$T=typeof navigator<"u"&&String(navigator.userAgent)||"",_W=nr,Wy=$T,nO=_W.process,rO=_W.Deno,iO=nO&&nO.versions||rO&&rO.version,oO=iO&&iO.v8,eo,Dw;oO&&(eo=oO.split("."),Dw=eo[0]>0&&eo[0]<4?1:+(eo[0]+eo[1]));!Dw&&Wy&&(eo=Wy.match(/Edge\/(\d+)/),(!eo||eo[1]>=74)&&(eo=Wy.match(/Chrome\/(\d+)/),eo&&(Dw=+eo[1])));var G3=Dw,sO=G3,Y3=Ai,K3=nr,X3=K3.String,FT=!!Object.getOwnPropertySymbols&&!Y3(function(){var t=Symbol("symbol detection");return!X3(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&sO&&sO<41}),q3=FT,MW=q3&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Q3=lg,Z3=rr,J3=LT,e4=MW,t4=Object,WT=e4?function(t){return typeof t=="symbol"}:function(t){var e=Q3("Symbol");return Z3(e)&&J3(e.prototype,t4(t))},n4=String,Zv=function(t){try{return n4(t)}catch{return"Object"}},r4=rr,i4=Zv,o4=TypeError,Jv=function(t){if(r4(t))return t;throw new o4(i4(t)+" is not a function")},s4=Jv,a4=kT,VT=function(t,e){var n=t[e];return a4(n)?void 0:s4(n)},Vy=Cu,By=rr,Uy=sl,l4=TypeError,u4=function(t,e){var n,r;if(e==="string"&&By(n=t.toString)&&!Uy(r=Vy(n,t))||By(n=t.valueOf)&&!Uy(r=Vy(n,t))||e!=="string"&&By(n=t.toString)&&!Uy(r=Vy(n,t)))return r;throw new l4("Can't convert object to primitive value")},xW={exports:{}},aO=nr,c4=Object.defineProperty,BT=function(t,e){try{c4(aO,t,{value:e,configurable:!0,writable:!0})}catch{aO[t]=e}return e},h4=nr,d4=BT,lO="__core-js_shared__",f4=h4[lO]||d4(lO,{}),UT=f4,uO=UT;(xW.exports=function(t,e){return uO[t]||(uO[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.35.0",mode:"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.35.0/LICENSE",source:"https://github.com/zloirock/core-js"});var PW=xW.exports,g4=TW,m4=Object,eC=function(t){return m4(g4(t))},p4=Rr,w4=eC,v4=p4({}.hasOwnProperty),Us=Object.hasOwn||function(e,n){return v4(w4(e),n)},C4=Rr,y4=0,S4=Math.random(),b4=C4(1 .toString),OW=function(t){return"Symbol("+(t===void 0?"":t)+")_"+b4(++y4+S4,36)},R4=nr,E4=PW,cO=Us,T4=OW,_4=FT,M4=MW,kc=R4.Symbol,zy=E4("wks"),x4=M4?kc.for||kc:kc&&kc.withoutSetter||T4,vh=function(t){return cO(zy,t)||(zy[t]=_4&&cO(kc,t)?kc[t]:x4("Symbol."+t)),zy[t]},P4=Cu,hO=sl,dO=WT,O4=VT,A4=u4,I4=vh,H4=TypeError,D4=I4("toPrimitive"),N4=function(t,e){if(!hO(t)||dO(t))return t;var n=O4(t,D4),r;if(n){if(e===void 0&&(e="default"),r=P4(n,t,e),!hO(r)||dO(r))return r;throw new H4("Can't convert object to primitive value")}return e===void 0&&(e="number"),A4(t,e)},k4=N4,L4=WT,zT=function(t){var e=k4(t,"string");return L4(e)?e:e+""},$4=nr,fO=sl,CR=$4.document,F4=fO(CR)&&fO(CR.createElement),jT=function(t){return F4?CR.createElement(t):{}},W4=Yo,V4=Ai,B4=jT,AW=!W4&&!V4(function(){return Object.defineProperty(B4("div"),"a",{get:function(){return 7}}).a!==7}),U4=Yo,z4=Cu,j4=CW,G4=qv,Y4=Qv,K4=zT,X4=Us,q4=AW,gO=Object.getOwnPropertyDescriptor;NT.f=U4?gO:function(e,n){if(e=Y4(e),n=K4(n),q4)try{return gO(e,n)}catch{}if(X4(e,n))return G4(!z4(j4.f,e,n),e[n])};var al={},Q4=Yo,Z4=Ai,IW=Q4&&Z4(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),J4=sl,eK=String,tK=TypeError,ll=function(t){if(J4(t))return t;throw new tK(eK(t)+" is not an object")},nK=Yo,rK=AW,iK=IW,Jg=ll,mO=zT,oK=TypeError,jy=Object.defineProperty,sK=Object.getOwnPropertyDescriptor,Gy="enumerable",Yy="configurable",Ky="writable";al.f=nK?iK?function(e,n,r){if(Jg(e),n=mO(n),Jg(r),typeof e=="function"&&n==="prototype"&&"value"in r&&Ky in r&&!r[Ky]){var i=sK(e,n);i&&i[Ky]&&(e[n]=r.value,r={configurable:Yy in r?r[Yy]:i[Yy],enumerable:Gy in r?r[Gy]:i[Gy],writable:!1})}return jy(e,n,r)}:jy:function(e,n,r){if(Jg(e),n=mO(n),Jg(r),rK)try{return jy(e,n,r)}catch{}if("get"in r||"set"in r)throw new oK("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var aK=Yo,lK=al,uK=qv,ug=aK?function(t,e,n){return lK.f(t,e,uK(1,n))}:function(t,e,n){return t[e]=n,t},HW={exports:{}},yR=Yo,cK=Us,DW=Function.prototype,hK=yR&&Object.getOwnPropertyDescriptor,GT=cK(DW,"name"),dK=GT&&(function(){}).name==="something",fK=GT&&(!yR||yR&&hK(DW,"name").configurable),gK={EXISTS:GT,PROPER:dK,CONFIGURABLE:fK},mK=Rr,pK=rr,SR=UT,wK=mK(Function.toString);pK(SR.inspectSource)||(SR.inspectSource=function(t){return wK(t)});var vK=SR.inspectSource,CK=nr,yK=rr,pO=CK.WeakMap,SK=yK(pO)&&/native code/.test(String(pO)),bK=PW,RK=OW,wO=bK("keys"),NW=function(t){return wO[t]||(wO[t]=RK(t))},YT={},EK=SK,kW=nr,TK=sl,_K=ug,Xy=Us,qy=UT,MK=NW,xK=YT,vO="Object already initialized",bR=kW.TypeError,PK=kW.WeakMap,Nw,kf,kw,OK=function(t){return kw(t)?kf(t):Nw(t,{})},AK=function(t){return function(e){var n;if(!TK(e)||(n=kf(e)).type!==t)throw new bR("Incompatible receiver, "+t+" required");return n}};if(EK||qy.state){var po=qy.state||(qy.state=new PK);po.get=po.get,po.has=po.has,po.set=po.set,Nw=function(t,e){if(po.has(t))throw new bR(vO);return e.facade=t,po.set(t,e),e},kf=function(t){return po.get(t)||{}},kw=function(t){return po.has(t)}}else{var Ou=MK("state");xK[Ou]=!0,Nw=function(t,e){if(Xy(t,Ou))throw new bR(vO);return e.facade=t,_K(t,Ou,e),e},kf=function(t){return Xy(t,Ou)?t[Ou]:{}},kw=function(t){return Xy(t,Ou)}}var IK={set:Nw,get:kf,has:kw,enforce:OK,getterFor:AK},KT=Rr,HK=Ai,DK=rr,em=Us,RR=Yo,NK=gK.CONFIGURABLE,kK=vK,LW=IK,LK=LW.enforce,$K=LW.get,CO=String,kp=Object.defineProperty,FK=KT("".slice),WK=KT("".replace),VK=KT([].join),BK=RR&&!HK(function(){return kp(function(){},"length",{value:8}).length!==8}),UK=String(String).split("String"),zK=HW.exports=function(t,e,n){FK(CO(e),0,7)==="Symbol("&&(e="["+WK(CO(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!em(t,"name")||NK&&t.name!==e)&&(RR?kp(t,"name",{value:e,configurable:!0}):t.name=e),BK&&n&&em(n,"arity")&&t.length!==n.arity&&kp(t,"length",{value:n.arity});try{n&&em(n,"constructor")&&n.constructor?RR&&kp(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=LK(t);return em(r,"source")||(r.source=VK(UK,typeof e=="string"?e:"")),t};Function.prototype.toString=zK(function(){return DK(this)&&$K(this).source||kK(this)},"toString");var jK=HW.exports,GK=rr,YK=al,KK=jK,XK=BT,qK=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(GK(n)&&KK(n,o,r),r.global)i?t[e]=n:XK(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:YK.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},$W={},QK=Math.ceil,ZK=Math.floor,JK=Math.trunc||function(e){var n=+e;return(n>0?ZK:QK)(n)},e8=JK,XT=function(t){var e=+t;return e!==e||e===0?0:e8(e)},t8=XT,n8=Math.max,r8=Math.min,i8=function(t,e){var n=t8(t);return n<0?n8(n+e,0):r8(n,e)},o8=XT,s8=Math.min,a8=function(t){return t>0?s8(o8(t),9007199254740991):0},l8=a8,cg=function(t){return l8(t.length)},u8=Qv,c8=i8,h8=cg,yO=function(t){return function(e,n,r){var i=u8(e),o=h8(i),s=c8(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},d8={includes:yO(!0),indexOf:yO(!1)},f8=Rr,Qy=Us,g8=Qv,m8=d8.indexOf,p8=YT,SO=f8([].push),FW=function(t,e){var n=g8(t),r=0,i=[],o;for(o in n)!Qy(p8,o)&&Qy(n,o)&&SO(i,o);for(;e.length>r;)Qy(n,o=e[r++])&&(~m8(i,o)||SO(i,o));return i},qT=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],w8=FW,v8=qT,C8=v8.concat("length","prototype");$W.f=Object.getOwnPropertyNames||function(e){return w8(e,C8)};var WW={};WW.f=Object.getOwnPropertySymbols;var y8=lg,S8=Rr,b8=$W,R8=WW,E8=ll,T8=S8([].concat),_8=y8("Reflect","ownKeys")||function(e){var n=b8.f(E8(e)),r=R8.f;return r?T8(n,r(e)):n},bO=Us,M8=_8,x8=NT,P8=al,VW=function(t,e,n){for(var r=M8(e),i=P8.f,o=x8.f,s=0;s<r.length;s++){var a=r[s];!bO(t,a)&&!(n&&bO(n,a))&&i(t,a,o(e,a))}},O8=Ai,A8=rr,I8=/#|\.prototype\./,hg=function(t,e){var n=D8[H8(t)];return n===k8?!0:n===N8?!1:A8(e)?O8(e):!!e},H8=hg.normalize=function(t){return String(t).replace(I8,".").toLowerCase()},D8=hg.data={},N8=hg.NATIVE="N",k8=hg.POLYFILL="P",L8=hg,Zy=nr,$8=NT.f,F8=ug,W8=qK,V8=BT,B8=VW,U8=L8,ul=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Zy:i?s=Zy[n]||V8(n,{}):s=(Zy[n]||{}).prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=$8(s,a),l=c&&c.value):l=s[a],o=U8(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;B8(u,l)}(t.sham||l&&l.sham)&&F8(u,"sham",!0),W8(s,a,u,t)}},z8=wh,BW=Array.isArray||function(e){return z8(e)==="Array"},j8=Yo,G8=BW,Y8=TypeError,K8=Object.getOwnPropertyDescriptor,X8=j8&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),UW=X8?function(t,e){if(G8(t)&&!K8(t,"length").writable)throw new Y8("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},q8=TypeError,Q8=9007199254740991,zW=function(t){if(t>Q8)throw q8("Maximum allowed index exceeded");return t},Z8=ul,J8=eC,e6=cg,t6=UW,n6=zW,r6=Ai,i6=r6(function(){return[].push.call({length:4294967296},1)!==4294967297}),o6=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},s6=i6||!o6();Z8({target:"Array",proto:!0,arity:1,forced:s6},{push:function(e){var n=J8(this),r=e6(n),i=arguments.length;n6(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return t6(n,r),r}});var a6=Xv,jW=Function.prototype,RO=jW.apply,EO=jW.call,tC=typeof Reflect=="object"&&Reflect.apply||(a6?EO.bind(RO):function(){return EO.apply(RO,arguments)}),l6=Rr,u6=Jv,c6=function(t,e,n){try{return l6(u6(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},h6=sl,d6=function(t){return h6(t)||t===null},f6=d6,g6=String,m6=TypeError,p6=function(t){if(f6(t))return t;throw new m6("Can't set "+g6(t)+" as a prototype")},w6=c6,v6=ll,C6=p6,GW=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=w6(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return v6(i),C6(o),t?n(i,o):i.__proto__=o,i}}():void 0),y6=al.f,S6=function(t,e,n){n in t||y6(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},b6=rr,R6=sl,TO=GW,E6=function(t,e,n){var r,i;return TO&&b6(r=e.constructor)&&r!==n&&R6(i=r.prototype)&&i!==n.prototype&&TO(t,i),t},T6=vh,_6=T6("toStringTag"),YW={};YW[_6]="z";var M6=String(YW)==="[object z]",x6=M6,P6=rr,Lp=wh,O6=vh,A6=O6("toStringTag"),I6=Object,H6=Lp(function(){return arguments}())==="Arguments",D6=function(t,e){try{return t[e]}catch{}},KW=x6?Lp:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=D6(e=I6(t),A6))=="string"?n:H6?Lp(e):(r=Lp(e))==="Object"&&P6(e.callee)?"Arguments":r},N6=KW,k6=String,XW=function(t){if(N6(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return k6(t)},L6=XW,$6=function(t,e){return t===void 0?arguments.length<2?"":e:L6(t)},F6=sl,W6=ug,V6=function(t,e){F6(e)&&"cause"in e&&W6(t,"cause",e.cause)},B6=Rr,qW=Error,U6=B6("".replace),z6=function(t){return String(new qW(t).stack)}("zxcasd"),QW=/\n\s*at [^:]*:[^\n]*/,j6=QW.test(z6),G6=function(t,e){if(j6&&typeof t=="string"&&!qW.prepareStackTrace)for(;e--;)t=U6(t,QW,"");return t},Y6=Ai,K6=qv,X6=!Y6(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",K6(1,7)),t.stack!==7):!0}),q6=ug,Q6=G6,Z6=X6,_O=Error.captureStackTrace,J6=function(t,e,n,r){Z6&&(_O?_O(t,e):q6(t,"stack",Q6(n,r)))},MO=lg,e5=Us,xO=ug,t5=LT,PO=GW,OO=VW,AO=S6,n5=E6,r5=$6,i5=V6,o5=J6,s5=Yo,a5=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=MO.apply(null,s);if(l){var u=l.prototype;if(e5(u,"cause")&&delete u.cause,!n)return l;var c=MO("Error"),h=e(function(d,f){var m=r5(r?f:d,void 0),C=r?new l(d):new l;return m!==void 0&&xO(C,"message",m),o5(C,h,C.stack,2),this&&t5(u,this)&&n5(C,this,h),arguments.length>o&&i5(C,arguments[o]),C});h.prototype=u,a!=="Error"?PO?PO(h,c):OO(h,c,{name:!0}):s5&&i in l&&(AO(h,l,i),AO(h,l,"prepareStackTrace")),OO(h,l);try{u.name!==a&&xO(u,"name",a),u.constructor=h}catch{}return h}},ZW=ul,l5=nr,Ko=tC,JW=a5,ER="WebAssembly",IO=l5[ER],Lw=new Error("e",{cause:7}).cause!==7,yu=function(t,e){var n={};n[t]=JW(t,e,Lw),ZW({global:!0,constructor:!0,arity:1,forced:Lw},n)},QT=function(t,e){if(IO&&IO[t]){var n={};n[t]=JW(ER+"."+t,e,Lw),ZW({target:ER,stat:!0,constructor:!0,arity:1,forced:Lw},n)}};yu("Error",function(t){return function(n){return Ko(t,this,arguments)}});yu("EvalError",function(t){return function(n){return Ko(t,this,arguments)}});yu("RangeError",function(t){return function(n){return Ko(t,this,arguments)}});yu("ReferenceError",function(t){return function(n){return Ko(t,this,arguments)}});yu("SyntaxError",function(t){return function(n){return Ko(t,this,arguments)}});yu("TypeError",function(t){return function(n){return Ko(t,this,arguments)}});yu("URIError",function(t){return function(n){return Ko(t,this,arguments)}});QT("CompileError",function(t){return function(n){return Ko(t,this,arguments)}});QT("LinkError",function(t){return function(n){return Ko(t,this,arguments)}});QT("RuntimeError",function(t){return function(n){return Ko(t,this,arguments)}});var u5=wh,c5=Rr,h5=function(t){if(u5(t)==="Function")return c5(t)},HO=h5,d5=Jv,f5=Xv,g5=HO(HO.bind),eV=function(t,e){return d5(t),e===void 0?t:f5?g5(t,e):function(){return t.apply(e,arguments)}},m5=lg,tV=m5("document","documentElement"),p5=Rr,ZT=p5([].slice),w5=TypeError,nV=function(t,e){if(t<e)throw new w5("Not enough arguments");return t},v5=$T,C5=/(?:ipad|iphone|ipod).*applewebkit/i.test(v5),y5=nr,S5=wh,b5=S5(y5.process)==="process",ni=nr,R5=tC,E5=eV,DO=rr,T5=Us,rV=Ai,NO=tV,_5=ZT,kO=jT,M5=nV,x5=C5,P5=b5,TR=ni.setImmediate,_R=ni.clearImmediate,O5=ni.process,Jy=ni.Dispatch,A5=ni.Function,LO=ni.MessageChannel,I5=ni.String,eS=0,qd={},$O="onreadystatechange",Lf,dl,tS,nS;rV(function(){Lf=ni.location});var JT=function(t){if(T5(qd,t)){var e=qd[t];delete qd[t],e()}},rS=function(t){return function(){JT(t)}},FO=function(t){JT(t.data)},WO=function(t){ni.postMessage(I5(t),Lf.protocol+"//"+Lf.host)};(!TR||!_R)&&(TR=function(e){M5(arguments.length,1);var n=DO(e)?e:A5(e),r=_5(arguments,1);return qd[++eS]=function(){R5(n,void 0,r)},dl(eS),eS},_R=function(e){delete qd[e]},P5?dl=function(t){O5.nextTick(rS(t))}:Jy&&Jy.now?dl=function(t){Jy.now(rS(t))}:LO&&!x5?(tS=new LO,nS=tS.port2,tS.port1.onmessage=FO,dl=E5(nS.postMessage,nS)):ni.addEventListener&&DO(ni.postMessage)&&!ni.importScripts&&Lf&&Lf.protocol!=="file:"&&!rV(WO)?(dl=WO,ni.addEventListener("message",FO,!1)):$O in kO("script")?dl=function(t){NO.appendChild(kO("script"))[$O]=function(){NO.removeChild(this),JT(t)}}:dl=function(t){setTimeout(rS(t),0)});var iV={set:TR,clear:_R},H5=ul,D5=nr,VO=iV.clear;H5({global:!0,bind:!0,enumerable:!0,forced:D5.clearImmediate!==VO},{clearImmediate:VO});var N5=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",oV=nr,k5=tC,L5=rr,$5=N5,F5=$T,W5=ZT,V5=nV,B5=oV.Function,U5=/MSIE .\./.test(F5)||$5&&function(){var t=oV.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),z5=function(t,e){var n=e?2:1;return U5?function(r,i){var o=V5(arguments.length,1)>n,s=L5(r)?r:B5(r),a=o?W5(arguments,n):[],l=o?function(){k5(s,this,a)}:s;return e?t(l,i):t(l)}:t},j5=ul,sV=nr,BO=iV.set,G5=z5,UO=sV.setImmediate?G5(BO,!1):BO;j5({global:!0,bind:!0,enumerable:!0,forced:sV.setImmediate!==UO},{setImmediate:UO});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function Sa(t){"@babel/helpers - typeof";return Sa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sa(t)}function MR(t,e){return MR=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},MR(t,e)}function Y5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $p(t,e,n){return Y5()?$p=Reflect.construct:$p=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&MR(u,s.prototype),u},$p.apply(null,arguments)}function Gi(t){return K5(t)||X5(t)||q5(t)||Q5()}function K5(t){if(Array.isArray(t))return xR(t)}function X5(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function q5(t,e){if(t){if(typeof t=="string")return xR(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xR(t,e)}}function xR(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Q5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Z5=Object.hasOwnProperty,zO=Object.setPrototypeOf,J5=Object.isFrozen,e9=Object.getPrototypeOf,t9=Object.getOwnPropertyDescriptor,yr=Object.freeze,lo=Object.seal,n9=Object.create,aV=typeof Reflect<"u"&&Reflect,$w=aV.apply,PR=aV.construct;$w||($w=function(e,n,r){return e.apply(n,r)});yr||(yr=function(e){return e});lo||(lo=function(e){return e});PR||(PR=function(e,n){return $p(e,Gi(n))});var r9=Pi(Array.prototype.forEach),jO=Pi(Array.prototype.pop),Wh=Pi(Array.prototype.push),Fp=Pi(String.prototype.toLowerCase),iS=Pi(String.prototype.toString),i9=Pi(String.prototype.match),ki=Pi(String.prototype.replace),o9=Pi(String.prototype.indexOf),s9=Pi(String.prototype.trim),ar=Pi(RegExp.prototype.test),oS=a9(TypeError);function Pi(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return $w(t,e,r)}}function a9(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return PR(t,n)}}function Qe(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:Fp,zO&&zO(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(J5(e)||(e[i]=s),o=s)}t[o]=!0}return t}function fl(t){var e=n9(null),n;for(n in t)$w(Z5,t,[n])===!0&&(e[n]=t[n]);return e}function tm(t,e){for(;t!==null;){var n=t9(t,e);if(n){if(n.get)return Pi(n.get);if(typeof n.value=="function")return Pi(n.value)}t=e9(t)}function r(i){return console.warn("fallback value for",i),null}return r}var GO=yr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),sS=yr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),aS=yr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),l9=yr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),lS=yr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),u9=yr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),YO=yr(["#text"]),KO=yr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),uS=yr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),XO=yr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),nm=yr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),c9=lo(/\{\{[\w\W]*|[\w\W]*\}\}/gm),h9=lo(/<%[\w\W]*|[\w\W]*%>/gm),d9=lo(/\${[\w\W]*}/gm),f9=lo(/^data-[\-\w.\u00B7-\uFFFF]/),g9=lo(/^aria-[\-\w]+$/),m9=lo(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),p9=lo(/^(?:\w+script|data):/i),w9=lo(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),v9=lo(/^html$/i),C9=function(){return typeof window>"u"?null:window},y9=function(e,n){if(Sa(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function lV(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:C9(),e=function(k){return lV(k)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,h=t.HTMLFormElement,d=t.DOMParser,f=t.trustedTypes,m=a.prototype,C=tm(m,"cloneNode"),b=tm(m,"nextSibling"),p=tm(m,"childNodes"),w=tm(m,"parentNode");if(typeof o=="function"){var y=r.createElement("template");y.content&&y.content.ownerDocument&&(r=y.content.ownerDocument)}var E=y9(f,n),T=E?E.createHTML(""):"",x=r,A=x.implementation,W=x.createNodeIterator,B=x.createDocumentFragment,U=x.getElementsByTagName,Q=n.importNode,te={};try{te=fl(r).documentMode?r.documentMode:{}}catch{}var ee={};e.isSupported=typeof w=="function"&&A&&A.createHTMLDocument!==void 0&&te!==9;var he=c9,_e=h9,Ue=d9,ke=f9,Y=g9,g=p9,v=w9,S=m9,O=null,H=Qe({},[].concat(Gi(GO),Gi(sS),Gi(aS),Gi(lS),Gi(YO))),D=null,X=Qe({},[].concat(Gi(KO),Gi(uS),Gi(XO),Gi(nm))),G=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),se=null,re=null,q=!0,Ee=!0,De=!1,Ie=!0,Le=!1,K=!1,ft=!1,Ge=!1,Ne=!1,$e=!1,Me=!1,R=!0,_=!1,P="user-content-",V=!0,I=!1,F={},N=null,L=Qe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),z=null,$=Qe({},["audio","video","img","source","image","track"]),j=null,ae=Qe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),me="http://www.w3.org/1998/Math/MathML",Te="http://www.w3.org/2000/svg",Ae="http://www.w3.org/1999/xhtml",ze=Ae,Mt=!1,et=null,mt=Qe({},[me,Te,Ae],iS),kt,xu=["application/xhtml+xml","text/html"],Ph="text/html",nn,Hn=null,hl=r.createElement("form"),sr=function(k){return k instanceof RegExp||k instanceof Function},wn=function(k){Hn&&Hn===k||((!k||Sa(k)!=="object")&&(k={}),k=fl(k),kt=xu.indexOf(k.PARSER_MEDIA_TYPE)===-1?kt=Ph:kt=k.PARSER_MEDIA_TYPE,nn=kt==="application/xhtml+xml"?iS:Fp,O="ALLOWED_TAGS"in k?Qe({},k.ALLOWED_TAGS,nn):H,D="ALLOWED_ATTR"in k?Qe({},k.ALLOWED_ATTR,nn):X,et="ALLOWED_NAMESPACES"in k?Qe({},k.ALLOWED_NAMESPACES,iS):mt,j="ADD_URI_SAFE_ATTR"in k?Qe(fl(ae),k.ADD_URI_SAFE_ATTR,nn):ae,z="ADD_DATA_URI_TAGS"in k?Qe(fl($),k.ADD_DATA_URI_TAGS,nn):$,N="FORBID_CONTENTS"in k?Qe({},k.FORBID_CONTENTS,nn):L,se="FORBID_TAGS"in k?Qe({},k.FORBID_TAGS,nn):{},re="FORBID_ATTR"in k?Qe({},k.FORBID_ATTR,nn):{},F="USE_PROFILES"in k?k.USE_PROFILES:!1,q=k.ALLOW_ARIA_ATTR!==!1,Ee=k.ALLOW_DATA_ATTR!==!1,De=k.ALLOW_UNKNOWN_PROTOCOLS||!1,Ie=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Le=k.SAFE_FOR_TEMPLATES||!1,K=k.WHOLE_DOCUMENT||!1,Ne=k.RETURN_DOM||!1,$e=k.RETURN_DOM_FRAGMENT||!1,Me=k.RETURN_TRUSTED_TYPE||!1,Ge=k.FORCE_BODY||!1,R=k.SANITIZE_DOM!==!1,_=k.SANITIZE_NAMED_PROPS||!1,V=k.KEEP_CONTENT!==!1,I=k.IN_PLACE||!1,S=k.ALLOWED_URI_REGEXP||S,ze=k.NAMESPACE||Ae,G=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&sr(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(G.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&sr(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(G.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(G.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Le&&(Ee=!1),$e&&(Ne=!0),F&&(O=Qe({},Gi(YO)),D=[],F.html===!0&&(Qe(O,GO),Qe(D,KO)),F.svg===!0&&(Qe(O,sS),Qe(D,uS),Qe(D,nm)),F.svgFilters===!0&&(Qe(O,aS),Qe(D,uS),Qe(D,nm)),F.mathMl===!0&&(Qe(O,lS),Qe(D,XO),Qe(D,nm))),k.ADD_TAGS&&(O===H&&(O=fl(O)),Qe(O,k.ADD_TAGS,nn)),k.ADD_ATTR&&(D===X&&(D=fl(D)),Qe(D,k.ADD_ATTR,nn)),k.ADD_URI_SAFE_ATTR&&Qe(j,k.ADD_URI_SAFE_ATTR,nn),k.FORBID_CONTENTS&&(N===L&&(N=fl(N)),Qe(N,k.FORBID_CONTENTS,nn)),V&&(O["#text"]=!0),K&&Qe(O,["html","head","body"]),O.table&&(Qe(O,["tbody"]),delete se.tbody),yr&&yr(k),Hn=k)},Pt=Qe({},["mi","mo","mn","ms","mtext"]),Fx=Qe({},["foreignobject","desc","title","annotation-xml"]),qj=Qe({},["title","style","font","a","script"]),Hg=Qe({},sS);Qe(Hg,aS),Qe(Hg,l9);var ly=Qe({},lS);Qe(ly,u9);var Qj=function(k){var oe=w(k);(!oe||!oe.tagName)&&(oe={namespaceURI:ze,tagName:"template"});var de=Fp(k.tagName),gt=Fp(oe.tagName);return et[k.namespaceURI]?k.namespaceURI===Te?oe.namespaceURI===Ae?de==="svg":oe.namespaceURI===me?de==="svg"&&(gt==="annotation-xml"||Pt[gt]):!!Hg[de]:k.namespaceURI===me?oe.namespaceURI===Ae?de==="math":oe.namespaceURI===Te?de==="math"&&Fx[gt]:!!ly[de]:k.namespaceURI===Ae?oe.namespaceURI===Te&&!Fx[gt]||oe.namespaceURI===me&&!Pt[gt]?!1:!ly[de]&&(qj[de]||!Hg[de]):!!(kt==="application/xhtml+xml"&&et[k.namespaceURI]):!1},Zo=function(k){Wh(e.removed,{element:k});try{k.parentNode.removeChild(k)}catch{try{k.outerHTML=T}catch{k.remove()}}},uy=function(k,oe){try{Wh(e.removed,{attribute:oe.getAttributeNode(k),from:oe})}catch{Wh(e.removed,{attribute:null,from:oe})}if(oe.removeAttribute(k),k==="is"&&!D[k])if(Ne||$e)try{Zo(oe)}catch{}else try{oe.setAttribute(k,"")}catch{}},Wx=function(k){var oe,de;if(Ge)k="<remove></remove>"+k;else{var gt=i9(k,/^[\r\n\t ]+/);de=gt&&gt[0]}kt==="application/xhtml+xml"&&ze===Ae&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");var Tr=E?E.createHTML(k):k;if(ze===Ae)try{oe=new d().parseFromString(Tr,kt)}catch{}if(!oe||!oe.documentElement){oe=A.createDocument(ze,"template",null);try{oe.documentElement.innerHTML=Mt?T:Tr}catch{}}var Vn=oe.body||oe.documentElement;return k&&de&&Vn.insertBefore(r.createTextNode(de),Vn.childNodes[0]||null),ze===Ae?U.call(oe,K?"html":"body")[0]:K?oe.documentElement:Vn},Vx=function(k){return W.call(k.ownerDocument||k,k,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},Zj=function(k){return k instanceof h&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof c)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},Oh=function(k){return Sa(s)==="object"?k instanceof s:k&&Sa(k)==="object"&&typeof k.nodeType=="number"&&typeof k.nodeName=="string"},Jo=function(k,oe,de){ee[k]&&r9(ee[k],function(gt){gt.call(e,oe,de,Hn)})},Bx=function(k){var oe;if(Jo("beforeSanitizeElements",k,null),Zj(k)||ar(/[\u0080-\uFFFF]/,k.nodeName))return Zo(k),!0;var de=nn(k.nodeName);if(Jo("uponSanitizeElement",k,{tagName:de,allowedTags:O}),k.hasChildNodes()&&!Oh(k.firstElementChild)&&(!Oh(k.content)||!Oh(k.content.firstElementChild))&&ar(/<[/\w]/g,k.innerHTML)&&ar(/<[/\w]/g,k.textContent)||de==="select"&&ar(/<template/i,k.innerHTML))return Zo(k),!0;if(!O[de]||se[de]){if(!se[de]&&zx(de)&&(G.tagNameCheck instanceof RegExp&&ar(G.tagNameCheck,de)||G.tagNameCheck instanceof Function&&G.tagNameCheck(de)))return!1;if(V&&!N[de]){var gt=w(k)||k.parentNode,Tr=p(k)||k.childNodes;if(Tr&&gt)for(var Vn=Tr.length,Dn=Vn-1;Dn>=0;--Dn)gt.insertBefore(C(Tr[Dn],!0),b(k))}return Zo(k),!0}return k instanceof a&&!Qj(k)||(de==="noscript"||de==="noembed"||de==="noframes")&&ar(/<\/no(script|embed|frames)/i,k.innerHTML)?(Zo(k),!0):(Le&&k.nodeType===3&&(oe=k.textContent,oe=ki(oe,he," "),oe=ki(oe,_e," "),oe=ki(oe,Ue," "),k.textContent!==oe&&(Wh(e.removed,{element:k.cloneNode()}),k.textContent=oe)),Jo("afterSanitizeElements",k,null),!1)},Ux=function(k,oe,de){if(R&&(oe==="id"||oe==="name")&&(de in r||de in hl))return!1;if(!(Ee&&!re[oe]&&ar(ke,oe))){if(!(q&&ar(Y,oe))){if(!D[oe]||re[oe]){if(!(zx(k)&&(G.tagNameCheck instanceof RegExp&&ar(G.tagNameCheck,k)||G.tagNameCheck instanceof Function&&G.tagNameCheck(k))&&(G.attributeNameCheck instanceof RegExp&&ar(G.attributeNameCheck,oe)||G.attributeNameCheck instanceof Function&&G.attributeNameCheck(oe))||oe==="is"&&G.allowCustomizedBuiltInElements&&(G.tagNameCheck instanceof RegExp&&ar(G.tagNameCheck,de)||G.tagNameCheck instanceof Function&&G.tagNameCheck(de))))return!1}else if(!j[oe]){if(!ar(S,ki(de,v,""))){if(!((oe==="src"||oe==="xlink:href"||oe==="href")&&k!=="script"&&o9(de,"data:")===0&&z[k])){if(!(De&&!ar(g,ki(de,v,"")))){if(de)return!1}}}}}}return!0},zx=function(k){return k.indexOf("-")>0},jx=function(k){var oe,de,gt,Tr;Jo("beforeSanitizeAttributes",k,null);var Vn=k.attributes;if(Vn){var Dn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:D};for(Tr=Vn.length;Tr--;){oe=Vn[Tr];var Dg=oe,En=Dg.name,cy=Dg.namespaceURI;if(de=En==="value"?oe.value:s9(oe.value),gt=nn(En),Dn.attrName=gt,Dn.attrValue=de,Dn.keepAttr=!0,Dn.forceKeepAttr=void 0,Jo("uponSanitizeAttribute",k,Dn),de=Dn.attrValue,!Dn.forceKeepAttr&&(uy(En,k),!!Dn.keepAttr)){if(!Ie&&ar(/\/>/i,de)){uy(En,k);continue}Le&&(de=ki(de,he," "),de=ki(de,_e," "),de=ki(de,Ue," "));var Gx=nn(k.nodeName);if(Ux(Gx,gt,de)){if(_&&(gt==="id"||gt==="name")&&(uy(En,k),de=P+de),E&&Sa(f)==="object"&&typeof f.getAttributeType=="function"&&!cy)switch(f.getAttributeType(Gx,gt)){case"TrustedHTML":{de=E.createHTML(de);break}case"TrustedScriptURL":{de=E.createScriptURL(de);break}}try{cy?k.setAttributeNS(cy,En,de):k.setAttribute(En,de),jO(e.removed)}catch{}}}}Jo("afterSanitizeAttributes",k,null)}},Jj=function xe(k){var oe,de=Vx(k);for(Jo("beforeSanitizeShadowDOM",k,null);oe=de.nextNode();)Jo("uponSanitizeShadowNode",oe,null),!Bx(oe)&&(oe.content instanceof i&&xe(oe.content),jx(oe));Jo("afterSanitizeShadowDOM",k,null)};return e.sanitize=function(xe){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},oe,de,gt,Tr,Vn;if(Mt=!xe,Mt&&(xe="<!-->"),typeof xe!="string"&&!Oh(xe))if(typeof xe.toString=="function"){if(xe=xe.toString(),typeof xe!="string")throw oS("dirty is not a string, aborting")}else throw oS("toString is not a function");if(!e.isSupported){if(Sa(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof xe=="string")return t.toStaticHTML(xe);if(Oh(xe))return t.toStaticHTML(xe.outerHTML)}return xe}if(ft||wn(k),e.removed=[],typeof xe=="string"&&(I=!1),I){if(xe.nodeName){var Dn=nn(xe.nodeName);if(!O[Dn]||se[Dn])throw oS("root node is forbidden and cannot be sanitized in-place")}}else if(xe instanceof s)oe=Wx("<!---->"),de=oe.ownerDocument.importNode(xe,!0),de.nodeType===1&&de.nodeName==="BODY"||de.nodeName==="HTML"?oe=de:oe.appendChild(de);else{if(!Ne&&!Le&&!K&&xe.indexOf("<")===-1)return E&&Me?E.createHTML(xe):xe;if(oe=Wx(xe),!oe)return Ne?null:Me?T:""}oe&&Ge&&Zo(oe.firstChild);for(var Dg=Vx(I?xe:oe);gt=Dg.nextNode();)gt.nodeType===3&&gt===Tr||Bx(gt)||(gt.content instanceof i&&Jj(gt.content),jx(gt),Tr=gt);if(Tr=null,I)return xe;if(Ne){if($e)for(Vn=B.call(oe.ownerDocument);oe.firstChild;)Vn.appendChild(oe.firstChild);else Vn=oe;return(D.shadowroot||D.shadowrootmod)&&(Vn=Q.call(n,Vn,!0)),Vn}var En=K?oe.outerHTML:oe.innerHTML;return K&&O["!doctype"]&&oe.ownerDocument&&oe.ownerDocument.doctype&&oe.ownerDocument.doctype.name&&ar(v9,oe.ownerDocument.doctype.name)&&(En="<!DOCTYPE "+oe.ownerDocument.doctype.name+`>
`+En),Le&&(En=ki(En,he," "),En=ki(En,_e," "),En=ki(En,Ue," ")),E&&Me?E.createHTML(En):En},e.setConfig=function(xe){wn(xe),ft=!0},e.clearConfig=function(){Hn=null,ft=!1},e.isValidAttribute=function(xe,k,oe){Hn||wn({});var de=nn(xe),gt=nn(k);return Ux(de,gt,oe)},e.addHook=function(xe,k){typeof k=="function"&&(ee[xe]=ee[xe]||[],Wh(ee[xe],k))},e.removeHook=function(xe){if(ee[xe])return jO(ee[xe])},e.removeHooks=function(xe){ee[xe]&&(ee[xe]=[])},e.removeAllHooks=function(){ee={}},e}var S9=lV();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var uV;function Z(){return uV.apply(null,arguments)}function b9(t){uV=t}function uo(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function ou(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function ht(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function e1(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(ht(t,e))return!1;return!0}function Ir(t){return t===void 0}function $s(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function dg(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function cV(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function xa(t,e){for(var n in e)ht(e,n)&&(t[n]=e[n]);return ht(e,"toString")&&(t.toString=e.toString),ht(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Xo(t,e,n,r){return DV(t,e,n,r,!0).utc()}function R9(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Xe(t){return t._pf==null&&(t._pf=R9()),t._pf}var OR;Array.prototype.some?OR=Array.prototype.some:OR=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function t1(t){if(t._isValid==null){var e=Xe(t),n=OR.call(e.parsedDateParts,function(i){return i!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function nC(t){var e=Xo(NaN);return t!=null?xa(Xe(e),t):Xe(e).userInvalidated=!0,e}var qO=Z.momentProperties=[],cS=!1;function n1(t,e){var n,r,i,o=qO.length;if(Ir(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Ir(e._i)||(t._i=e._i),Ir(e._f)||(t._f=e._f),Ir(e._l)||(t._l=e._l),Ir(e._strict)||(t._strict=e._strict),Ir(e._tzm)||(t._tzm=e._tzm),Ir(e._isUTC)||(t._isUTC=e._isUTC),Ir(e._offset)||(t._offset=e._offset),Ir(e._pf)||(t._pf=Xe(e)),Ir(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=qO[n],i=e[r],Ir(i)||(t[r]=i);return t}function fg(t){n1(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),cS===!1&&(cS=!0,Z.updateOffset(this),cS=!1)}function co(t){return t instanceof fg||t!=null&&t._isAMomentObject!=null}function hV(t){Z.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Ii(t,e){var n=!0;return xa(function(){if(Z.deprecationHandler!=null&&Z.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])ht(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}hV(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var QO={};function dV(t,e){Z.deprecationHandler!=null&&Z.deprecationHandler(t,e),QO[t]||(hV(e),QO[t]=!0)}Z.suppressDeprecationWarnings=!1;Z.deprecationHandler=null;function qo(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function E9(t){var e,n;for(n in t)ht(t,n)&&(e=t[n],qo(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function AR(t,e){var n=xa({},t),r;for(r in e)ht(e,r)&&(ou(t[r])&&ou(e[r])?(n[r]={},xa(n[r],t[r]),xa(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)ht(t,r)&&!ht(e,r)&&ou(t[r])&&(n[r]=xa({},n[r]));return n}function r1(t){t!=null&&this.set(t)}var IR;Object.keys?IR=Object.keys:IR=function(t){var e,n=[];for(e in t)ht(t,e)&&n.push(e);return n};var T9={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function _9(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return qo(r)?r.call(e,n):r}function Go(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var i1=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,rm=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,hS={},Yc={};function Oe(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Yc[t]=i),e&&(Yc[e[0]]=function(){return Go(i.apply(this,arguments),e[1],e[2])}),n&&(Yc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function M9(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function x9(t){var e=t.match(i1),n,r;for(n=0,r=e.length;n<r;n++)Yc[e[n]]?e[n]=Yc[e[n]]:e[n]=M9(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=qo(e[s])?e[s].call(i,t):e[s];return o}}function Wp(t,e){return t.isValid()?(e=fV(e,t.localeData()),hS[e]=hS[e]||x9(e),hS[e](t)):t.localeData().invalidDate()}function fV(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(rm.lastIndex=0;n>=0&&rm.test(t);)t=t.replace(rm,r),rm.lastIndex=0,n-=1;return t}var P9={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function O9(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(i1).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var A9="Invalid date";function I9(){return this._invalidDate}var H9="%d",D9=/\d{1,2}/;function N9(t){return this._ordinal.replace("%d",t)}var k9={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function L9(t,e,n,r){var i=this._relativeTime[n];return qo(i)?i(t,e,n,r):i.replace(/%d/i,t)}function $9(t,e){var n=this._relativeTime[t>0?"future":"past"];return qo(n)?n(e):n.replace(/%s/i,e)}var Qd={};function ir(t,e){var n=t.toLowerCase();Qd[n]=Qd[n+"s"]=Qd[e]=t}function Hi(t){return typeof t=="string"?Qd[t]||Qd[t.toLowerCase()]:void 0}function o1(t){var e={},n,r;for(r in t)ht(t,r)&&(n=Hi(r),n&&(e[n]=t[r]));return e}var gV={};function or(t,e){gV[t]=e}function F9(t){var e=[],n;for(n in t)ht(t,n)&&e.push({unit:n,priority:gV[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}function rC(t){return t%4===0&&t%100!==0||t%400===0}function Ri(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function rt(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Ri(e)),n}function Ch(t,e){return function(n){return n!=null?(mV(this,t,n),Z.updateOffset(this,e),this):Fw(this,t)}}function Fw(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function mV(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&rC(t.year())&&t.month()===1&&t.date()===29?(n=rt(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),uC(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function W9(t){return t=Hi(t),qo(this[t])?this[t]():this}function V9(t,e){if(typeof t=="object"){t=o1(t);var n=F9(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Hi(t),qo(this[t]))return this[t](e);return this}var pV=/\d/,li=/\d\d/,wV=/\d{3}/,s1=/\d{4}/,iC=/[+-]?\d{6}/,Nt=/\d\d?/,vV=/\d\d\d\d?/,CV=/\d\d\d\d\d\d?/,oC=/\d{1,3}/,a1=/\d{1,4}/,sC=/[+-]?\d{1,6}/,yh=/\d+/,aC=/[+-]?\d+/,B9=/Z|[+-]\d\d:?\d\d/gi,lC=/Z|[+-]\d\d(?::?\d\d)?/gi,U9=/[+-]?\d+(\.\d{1,3})?/,gg=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ww;Ww={};function ve(t,e,n){Ww[t]=qo(e)?e:function(r,i){return r&&n?n:e}}function z9(t,e){return ht(Ww,t)?Ww[t](e._strict,e._locale):new RegExp(j9(t))}function j9(t){return ei(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function ei(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var HR={};function St(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),$s(e)&&(r=function(o,s){s[e]=rt(o)}),i=t.length,n=0;n<i;n++)HR[t[n]]=r}function mg(t,e){St(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function G9(t,e,n){e!=null&&ht(HR,t)&&HR[t](e,n._a,n,t)}var Zn=0,Es=1,$o=2,bn=3,no=4,Ts=5,ql=6,Y9=7,K9=8;function X9(t,e){return(t%e+e)%e}var un;Array.prototype.indexOf?un=Array.prototype.indexOf:un=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function uC(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=X9(e,12);return t+=(e-n)/12,n===1?rC(t)?29:28:31-n%7%2}Oe("M",["MM",2],"Mo",function(){return this.month()+1});Oe("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Oe("MMMM",0,0,function(t){return this.localeData().months(this,t)});ir("month","M");or("month",8);ve("M",Nt);ve("MM",Nt,li);ve("MMM",function(t,e){return e.monthsShortRegex(t)});ve("MMMM",function(t,e){return e.monthsRegex(t)});St(["M","MM"],function(t,e){e[Es]=rt(t)-1});St(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Es]=i:Xe(n).invalidMonth=t});var q9="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),yV="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),SV=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Q9=gg,Z9=gg;function J9(t,e){return t?uo(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||SV).test(e)?"format":"standalone"][t.month()]:uo(this._months)?this._months:this._months.standalone}function e7(t,e){return t?uo(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[SV.test(e)?"format":"standalone"][t.month()]:uo(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function t7(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Xo([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=un.call(this._shortMonthsParse,s),i!==-1?i:null):(i=un.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=un.call(this._shortMonthsParse,s),i!==-1?i:(i=un.call(this._longMonthsParse,s),i!==-1?i:null)):(i=un.call(this._longMonthsParse,s),i!==-1?i:(i=un.call(this._shortMonthsParse,s),i!==-1?i:null))}function n7(t,e,n){var r,i,o;if(this._monthsParseExact)return t7.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Xo([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function bV(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=rt(e);else if(e=t.localeData().monthsParse(e),!$s(e))return t}return n=Math.min(t.date(),uC(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function RV(t){return t!=null?(bV(this,t),Z.updateOffset(this,!0),this):Fw(this,"Month")}function r7(){return uC(this.year(),this.month())}function i7(t){return this._monthsParseExact?(ht(this,"_monthsRegex")||EV.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(ht(this,"_monthsShortRegex")||(this._monthsShortRegex=Q9),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function o7(t){return this._monthsParseExact?(ht(this,"_monthsRegex")||EV.call(this),t?this._monthsStrictRegex:this._monthsRegex):(ht(this,"_monthsRegex")||(this._monthsRegex=Z9),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function EV(){function t(s,a){return a.length-s.length}var e=[],n=[],r=[],i,o;for(i=0;i<12;i++)o=Xo([2e3,i]),e.push(this.monthsShort(o,"")),n.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(t),n.sort(t),r.sort(t),i=0;i<12;i++)e[i]=ei(e[i]),n[i]=ei(n[i]);for(i=0;i<24;i++)r[i]=ei(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Oe("Y",0,0,function(){var t=this.year();return t<=9999?Go(t,4):"+"+t});Oe(0,["YY",2],0,function(){return this.year()%100});Oe(0,["YYYY",4],0,"year");Oe(0,["YYYYY",5],0,"year");Oe(0,["YYYYYY",6,!0],0,"year");ir("year","y");or("year",1);ve("Y",aC);ve("YY",Nt,li);ve("YYYY",a1,s1);ve("YYYYY",sC,iC);ve("YYYYYY",sC,iC);St(["YYYYY","YYYYYY"],Zn);St("YYYY",function(t,e){e[Zn]=t.length===2?Z.parseTwoDigitYear(t):rt(t)});St("YY",function(t,e){e[Zn]=Z.parseTwoDigitYear(t)});St("Y",function(t,e){e[Zn]=parseInt(t,10)});function Zd(t){return rC(t)?366:365}Z.parseTwoDigitYear=function(t){return rt(t)+(rt(t)>68?1900:2e3)};var TV=Ch("FullYear",!0);function s7(){return rC(this.year())}function a7(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function $f(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Vw(t,e,n){var r=7+e-n,i=(7+$f(t,0,r).getUTCDay()-e)%7;return-i+r-1}function _V(t,e,n,r,i){var o=(7+n-r)%7,s=Vw(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Zd(l)+a):a>Zd(t)?(l=t+1,u=a-Zd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Ff(t,e,n){var r=Vw(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Hs(s,e,n)):i>Hs(t.year(),e,n)?(o=i-Hs(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Hs(t,e,n){var r=Vw(t,e,n),i=Vw(t+1,e,n);return(Zd(t)-r+i)/7}Oe("w",["ww",2],"wo","week");Oe("W",["WW",2],"Wo","isoWeek");ir("week","w");ir("isoWeek","W");or("week",5);or("isoWeek",5);ve("w",Nt);ve("ww",Nt,li);ve("W",Nt);ve("WW",Nt,li);mg(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=rt(t)});function l7(t){return Ff(t,this._week.dow,this._week.doy).week}var u7={dow:0,doy:6};function c7(){return this._week.dow}function h7(){return this._week.doy}function d7(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function f7(t){var e=Ff(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Oe("d",0,"do","day");Oe("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Oe("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Oe("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Oe("e",0,0,"weekday");Oe("E",0,0,"isoWeekday");ir("day","d");ir("weekday","e");ir("isoWeekday","E");or("day",11);or("weekday",11);or("isoWeekday",11);ve("d",Nt);ve("e",Nt);ve("E",Nt);ve("dd",function(t,e){return e.weekdaysMinRegex(t)});ve("ddd",function(t,e){return e.weekdaysShortRegex(t)});ve("dddd",function(t,e){return e.weekdaysRegex(t)});mg(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Xe(n).invalidWeekday=t});mg(["d","e","E"],function(t,e,n,r){e[r]=rt(t)});function g7(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function m7(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function l1(t,e){return t.slice(e,7).concat(t.slice(0,e))}var p7="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),MV="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),w7="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),v7=gg,C7=gg,y7=gg;function S7(t,e){var n=uo(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?l1(n,this._week.dow):t?n[t.day()]:n}function b7(t){return t===!0?l1(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function R7(t){return t===!0?l1(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function E7(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Xo([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=un.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=un.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=un.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=un.call(this._weekdaysParse,s),i!==-1||(i=un.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=un.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=un.call(this._shortWeekdaysParse,s),i!==-1||(i=un.call(this._weekdaysParse,s),i!==-1)?i:(i=un.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=un.call(this._minWeekdaysParse,s),i!==-1||(i=un.call(this._weekdaysParse,s),i!==-1)?i:(i=un.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function T7(t,e,n){var r,i,o;if(this._weekdaysParseExact)return E7.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Xo([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function _7(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=g7(t,this.localeData()),this.add(t-e,"d")):e}function M7(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function x7(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=m7(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function P7(t){return this._weekdaysParseExact?(ht(this,"_weekdaysRegex")||u1.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(ht(this,"_weekdaysRegex")||(this._weekdaysRegex=v7),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function O7(t){return this._weekdaysParseExact?(ht(this,"_weekdaysRegex")||u1.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(ht(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=C7),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function A7(t){return this._weekdaysParseExact?(ht(this,"_weekdaysRegex")||u1.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(ht(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=y7),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function u1(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Xo([2e3,1]).day(o),a=ei(this.weekdaysMin(s,"")),l=ei(this.weekdaysShort(s,"")),u=ei(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function c1(){return this.hours()%12||12}function I7(){return this.hours()||24}Oe("H",["HH",2],0,"hour");Oe("h",["hh",2],0,c1);Oe("k",["kk",2],0,I7);Oe("hmm",0,0,function(){return""+c1.apply(this)+Go(this.minutes(),2)});Oe("hmmss",0,0,function(){return""+c1.apply(this)+Go(this.minutes(),2)+Go(this.seconds(),2)});Oe("Hmm",0,0,function(){return""+this.hours()+Go(this.minutes(),2)});Oe("Hmmss",0,0,function(){return""+this.hours()+Go(this.minutes(),2)+Go(this.seconds(),2)});function xV(t,e){Oe(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}xV("a",!0);xV("A",!1);ir("hour","h");or("hour",13);function PV(t,e){return e._meridiemParse}ve("a",PV);ve("A",PV);ve("H",Nt);ve("h",Nt);ve("k",Nt);ve("HH",Nt,li);ve("hh",Nt,li);ve("kk",Nt,li);ve("hmm",vV);ve("hmmss",CV);ve("Hmm",vV);ve("Hmmss",CV);St(["H","HH"],bn);St(["k","kk"],function(t,e,n){var r=rt(t);e[bn]=r===24?0:r});St(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});St(["h","hh"],function(t,e,n){e[bn]=rt(t),Xe(n).bigHour=!0});St("hmm",function(t,e,n){var r=t.length-2;e[bn]=rt(t.substr(0,r)),e[no]=rt(t.substr(r)),Xe(n).bigHour=!0});St("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[bn]=rt(t.substr(0,r)),e[no]=rt(t.substr(r,2)),e[Ts]=rt(t.substr(i)),Xe(n).bigHour=!0});St("Hmm",function(t,e,n){var r=t.length-2;e[bn]=rt(t.substr(0,r)),e[no]=rt(t.substr(r))});St("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[bn]=rt(t.substr(0,r)),e[no]=rt(t.substr(r,2)),e[Ts]=rt(t.substr(i))});function H7(t){return(t+"").toLowerCase().charAt(0)==="p"}var D7=/[ap]\.?m?\.?/i,N7=Ch("Hours",!0);function k7(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var OV={calendar:T9,longDateFormat:P9,invalidDate:A9,ordinal:H9,dayOfMonthOrdinalParse:D9,relativeTime:k9,months:q9,monthsShort:yV,week:u7,weekdays:p7,weekdaysMin:w7,weekdaysShort:MV,meridiemParse:D7},Ft={},Vh={},Wf;function L7(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function ZO(t){return t&&t.toLowerCase().replace("_","-")}function $7(t){for(var e=0,n,r,i,o;e<t.length;){for(o=ZO(t[e]).split("-"),n=o.length,r=ZO(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=cC(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&L7(o,r)>=n-1)break;n--}e++}return Wf}function F7(t){return t.match("^[^/\\\\]*$")!=null}function cC(t){var e=null,n;if(Ft[t]===void 0&&typeof uw<"u"&&uw&&uw.exports&&F7(t))try{e=Wf._abbr,n=require,n("./locale/"+t),Ba(e)}catch{Ft[t]=null}return Ft[t]}function Ba(t,e){var n;return t&&(Ir(e)?n=zs(t):n=h1(t,e),n?Wf=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Wf._abbr}function h1(t,e){if(e!==null){var n,r=OV;if(e.abbr=t,Ft[t]!=null)dV("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Ft[t]._config;else if(e.parentLocale!=null)if(Ft[e.parentLocale]!=null)r=Ft[e.parentLocale]._config;else if(n=cC(e.parentLocale),n!=null)r=n._config;else return Vh[e.parentLocale]||(Vh[e.parentLocale]=[]),Vh[e.parentLocale].push({name:t,config:e}),null;return Ft[t]=new r1(AR(r,e)),Vh[t]&&Vh[t].forEach(function(i){h1(i.name,i.config)}),Ba(t),Ft[t]}else return delete Ft[t],null}function W7(t,e){if(e!=null){var n,r,i=OV;Ft[t]!=null&&Ft[t].parentLocale!=null?Ft[t].set(AR(Ft[t]._config,e)):(r=cC(t),r!=null&&(i=r._config),e=AR(i,e),r==null&&(e.abbr=t),n=new r1(e),n.parentLocale=Ft[t],Ft[t]=n),Ba(t)}else Ft[t]!=null&&(Ft[t].parentLocale!=null?(Ft[t]=Ft[t].parentLocale,t===Ba()&&Ba(t)):Ft[t]!=null&&delete Ft[t]);return Ft[t]}function zs(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Wf;if(!uo(t)){if(e=cC(t),e)return e;t=[t]}return $7(t)}function V7(){return IR(Ft)}function d1(t){var e,n=t._a;return n&&Xe(t).overflow===-2&&(e=n[Es]<0||n[Es]>11?Es:n[$o]<1||n[$o]>uC(n[Zn],n[Es])?$o:n[bn]<0||n[bn]>24||n[bn]===24&&(n[no]!==0||n[Ts]!==0||n[ql]!==0)?bn:n[no]<0||n[no]>59?no:n[Ts]<0||n[Ts]>59?Ts:n[ql]<0||n[ql]>999?ql:-1,Xe(t)._overflowDayOfYear&&(e<Zn||e>$o)&&(e=$o),Xe(t)._overflowWeeks&&e===-1&&(e=Y9),Xe(t)._overflowWeekday&&e===-1&&(e=K9),Xe(t).overflow=e),t}var B7=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,U7=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,z7=/Z|[+-]\d\d(?::?\d\d)?/,im=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],dS=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],j7=/^\/?Date\((-?\d+)/i,G7=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Y7={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function AV(t){var e,n,r=t._i,i=B7.exec(r)||U7.exec(r),o,s,a,l,u=im.length,c=dS.length;if(i){for(Xe(t).iso=!0,e=0,n=u;e<n;e++)if(im[e][1].exec(i[1])){s=im[e][0],o=im[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(dS[e][1].exec(i[3])){a=(i[2]||" ")+dS[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(z7.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),g1(t)}else t._isValid=!1}function K7(t,e,n,r,i,o){var s=[X7(t),yV.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function X7(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function q7(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Q7(t,e,n){if(t){var r=MV.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Xe(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function Z7(t,e,n){if(t)return Y7[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function IV(t){var e=G7.exec(q7(t._i)),n;if(e){if(n=K7(e[4],e[3],e[2],e[5],e[6],e[7]),!Q7(e[1],n,t))return;t._a=n,t._tzm=Z7(e[8],e[9],e[10]),t._d=$f.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Xe(t).rfc2822=!0}else t._isValid=!1}function J7(t){var e=j7.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(AV(t),t._isValid===!1)delete t._isValid;else return;if(IV(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Z.createFromInputFallback(t)}Z.createFromInputFallback=Ii("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function yc(t,e,n){return t??e??n}function eX(t){var e=new Date(Z.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function f1(t){var e,n,r=[],i,o,s;if(!t._d){for(i=eX(t),t._w&&t._a[$o]==null&&t._a[Es]==null&&tX(t),t._dayOfYear!=null&&(s=yc(t._a[Zn],i[Zn]),(t._dayOfYear>Zd(s)||t._dayOfYear===0)&&(Xe(t)._overflowDayOfYear=!0),n=$f(s,0,t._dayOfYear),t._a[Es]=n.getUTCMonth(),t._a[$o]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[bn]===24&&t._a[no]===0&&t._a[Ts]===0&&t._a[ql]===0&&(t._nextDay=!0,t._a[bn]=0),t._d=(t._useUTC?$f:a7).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[bn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Xe(t).weekdayMismatch=!0)}}function tX(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=yc(e.GG,t._a[Zn],Ff(Dt(),1,4).year),r=yc(e.W,1),i=yc(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Ff(Dt(),o,s),n=yc(e.gg,t._a[Zn],u.year),r=yc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Hs(n,o,s)?Xe(t)._overflowWeeks=!0:l!=null?Xe(t)._overflowWeekday=!0:(a=_V(n,r,i,o,s),t._a[Zn]=a.year,t._dayOfYear=a.dayOfYear)}Z.ISO_8601=function(){};Z.RFC_2822=function(){};function g1(t){if(t._f===Z.ISO_8601){AV(t);return}if(t._f===Z.RFC_2822){IV(t);return}t._a=[],Xe(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=fV(t._f,t._locale).match(i1)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(z9(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Xe(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Yc[o]?(r?Xe(t).empty=!1:Xe(t).unusedTokens.push(o),G9(o,r,t)):t._strict&&!r&&Xe(t).unusedTokens.push(o);Xe(t).charsLeftOver=a-l,e.length>0&&Xe(t).unusedInput.push(e),t._a[bn]<=12&&Xe(t).bigHour===!0&&t._a[bn]>0&&(Xe(t).bigHour=void 0),Xe(t).parsedDateParts=t._a.slice(0),Xe(t).meridiem=t._meridiem,t._a[bn]=nX(t._locale,t._a[bn],t._meridiem),u=Xe(t).era,u!==null&&(t._a[Zn]=t._locale.erasConvertYear(u,t._a[Zn])),f1(t),d1(t)}function nX(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function rX(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Xe(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=n1({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],g1(e),t1(e)&&(s=!0),o+=Xe(e).charsLeftOver,o+=Xe(e).unusedTokens.length*10,Xe(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));xa(t,n||e)}function iX(t){if(!t._d){var e=o1(t._i),n=e.day===void 0?e.date:e.day;t._a=cV([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),f1(t)}}function oX(t){var e=new fg(d1(HV(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function HV(t){var e=t._i,n=t._f;return t._locale=t._locale||zs(t._l),e===null||n===void 0&&e===""?nC({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),co(e)?new fg(d1(e)):(dg(e)?t._d=e:uo(n)?rX(t):n?g1(t):sX(t),t1(t)||(t._d=null),t))}function sX(t){var e=t._i;Ir(e)?t._d=new Date(Z.now()):dg(e)?t._d=new Date(e.valueOf()):typeof e=="string"?J7(t):uo(e)?(t._a=cV(e.slice(0),function(n){return parseInt(n,10)}),f1(t)):ou(e)?iX(t):$s(e)?t._d=new Date(e):Z.createFromInputFallback(t)}function DV(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(ou(t)&&e1(t)||uo(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,oX(o)}function Dt(t,e,n,r){return DV(t,e,n,r,!1)}var aX=Ii("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Dt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:nC()}),lX=Ii("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Dt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:nC()});function NV(t,e){var n,r;if(e.length===1&&uo(e[0])&&(e=e[0]),!e.length)return Dt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function uX(){var t=[].slice.call(arguments,0);return NV("isBefore",t)}function cX(){var t=[].slice.call(arguments,0);return NV("isAfter",t)}var hX=function(){return Date.now?Date.now():+new Date},Bh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function dX(t){var e,n=!1,r,i=Bh.length;for(e in t)if(ht(t,e)&&!(un.call(Bh,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Bh[r]]){if(n)return!1;parseFloat(t[Bh[r]])!==rt(t[Bh[r]])&&(n=!0)}return!0}function fX(){return this._isValid}function gX(){return fo(NaN)}function hC(t){var e=o1(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=dX(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=zs(),this._bubble()}function Vp(t){return t instanceof hC}function DR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function mX(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&rt(t[s])!==rt(e[s]))&&o++;return o+i}function kV(t,e){Oe(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Go(~~(n/60),2)+e+Go(~~n%60,2)})}kV("Z",":");kV("ZZ","");ve("Z",lC);ve("ZZ",lC);St(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=m1(lC,t)});var pX=/([\+\-]|\d\d)/gi;function m1(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(pX)||["-",0,0],o=+(i[1]*60)+rt(i[2]),o===0?0:i[0]==="+"?o:-o)}function p1(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(co(t)||dg(t)?t.valueOf():Dt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Z.updateOffset(n,!1),n):Dt(t).local()}function NR(t){return-Math.round(t._d.getTimezoneOffset())}Z.updateOffset=function(){};function wX(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=m1(lC,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=NR(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?FV(this,fo(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Z.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:NR(this)}function vX(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function CX(t){return this.utcOffset(0,t)}function yX(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(NR(this),"m")),this}function SX(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=m1(B9,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function bX(t){return this.isValid()?(t=t?Dt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function RX(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function EX(){if(!Ir(this._isDSTShifted))return this._isDSTShifted;var t={},e;return n1(t,this),t=HV(t),t._a?(e=t._isUTC?Xo(t._a):Dt(t._a),this._isDSTShifted=this.isValid()&&mX(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function TX(){return this.isValid()?!this._isUTC:!1}function _X(){return this.isValid()?this._isUTC:!1}function LV(){return this.isValid()?this._isUTC&&this._offset===0:!1}var MX=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,xX=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function fo(t,e){var n=t,r=null,i,o,s;return Vp(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:$s(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=MX.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:rt(r[$o])*i,h:rt(r[bn])*i,m:rt(r[no])*i,s:rt(r[Ts])*i,ms:rt(DR(r[ql]*1e3))*i}):(r=xX.exec(t))?(i=r[1]==="-"?-1:1,n={y:gl(r[2],i),M:gl(r[3],i),w:gl(r[4],i),d:gl(r[5],i),h:gl(r[6],i),m:gl(r[7],i),s:gl(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=PX(Dt(n.from),Dt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new hC(n),Vp(t)&&ht(t,"_locale")&&(o._locale=t._locale),Vp(t)&&ht(t,"_isValid")&&(o._isValid=t._isValid),o}fo.fn=hC.prototype;fo.invalid=gX;function gl(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function JO(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function PX(t,e){var n;return t.isValid()&&e.isValid()?(e=p1(e,t),t.isBefore(e)?n=JO(t,e):(n=JO(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function $V(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(dV(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=fo(n,r),FV(this,i,t),this}}function FV(t,e,n,r){var i=e._milliseconds,o=DR(e._days),s=DR(e._months);t.isValid()&&(r=r??!0,s&&bV(t,Fw(t,"Month")+s*n),o&&mV(t,"Date",Fw(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Z.updateOffset(t,o||s))}var OX=$V(1,"add"),AX=$V(-1,"subtract");function WV(t){return typeof t=="string"||t instanceof String}function IX(t){return co(t)||dg(t)||WV(t)||$s(t)||DX(t)||HX(t)||t===null||t===void 0}function HX(t){var e=ou(t)&&!e1(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||ht(t,o);return e&&n}function DX(t){var e=uo(t),n=!1;return e&&(n=t.filter(function(r){return!$s(r)&&WV(t)}).length===0),e&&n}function NX(t){var e=ou(t)&&!e1(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||ht(t,o);return e&&n}function kX(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function LX(t,e){arguments.length===1&&(arguments[0]?IX(arguments[0])?(t=arguments[0],e=void 0):NX(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Dt(),r=p1(n,this).startOf("day"),i=Z.calendarFormat(this,r)||"sameElse",o=e&&(qo(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Dt(n)))}function $X(){return new fg(this)}function FX(t,e){var n=co(t)?t:Dt(t);return this.isValid()&&n.isValid()?(e=Hi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function WX(t,e){var n=co(t)?t:Dt(t);return this.isValid()&&n.isValid()?(e=Hi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function VX(t,e,n,r){var i=co(t)?t:Dt(t),o=co(e)?e:Dt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function BX(t,e){var n=co(t)?t:Dt(t),r;return this.isValid()&&n.isValid()?(e=Hi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function UX(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function zX(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function jX(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=p1(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Hi(e),e){case"year":o=Bp(this,r)/12;break;case"month":o=Bp(this,r);break;case"quarter":o=Bp(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Ri(o)}function Bp(t,e){if(t.date()<e.date())return-Bp(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Z.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Z.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function GX(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function YX(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Wp(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):qo(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Wp(n,"Z")):Wp(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function KX(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function XX(t){t||(t=this.isUtc()?Z.defaultFormatUtc:Z.defaultFormat);var e=Wp(this,t);return this.localeData().postformat(e)}function qX(t,e){return this.isValid()&&(co(t)&&t.isValid()||Dt(t).isValid())?fo({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function QX(t){return this.from(Dt(),t)}function ZX(t,e){return this.isValid()&&(co(t)&&t.isValid()||Dt(t).isValid())?fo({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function JX(t){return this.to(Dt(),t)}function VV(t){var e;return t===void 0?this._locale._abbr:(e=zs(t),e!=null&&(this._locale=e),this)}var BV=Ii("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function UV(){return this._locale}var Bw=1e3,Kc=60*Bw,Uw=60*Kc,zV=(365*400+97)*24*Uw;function Xc(t,e){return(t%e+e)%e}function jV(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-zV:new Date(t,e,n).valueOf()}function GV(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-zV:Date.UTC(t,e,n)}function eq(t){var e,n;if(t=Hi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?GV:jV,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Xc(e+(this._isUTC?0:this.utcOffset()*Kc),Uw);break;case"minute":e=this._d.valueOf(),e-=Xc(e,Kc);break;case"second":e=this._d.valueOf(),e-=Xc(e,Bw);break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function tq(t){var e,n;if(t=Hi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?GV:jV,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Uw-Xc(e+(this._isUTC?0:this.utcOffset()*Kc),Uw)-1;break;case"minute":e=this._d.valueOf(),e+=Kc-Xc(e,Kc)-1;break;case"second":e=this._d.valueOf(),e+=Bw-Xc(e,Bw)-1;break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function nq(){return this._d.valueOf()-(this._offset||0)*6e4}function rq(){return Math.floor(this.valueOf()/1e3)}function iq(){return new Date(this.valueOf())}function oq(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function sq(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function aq(){return this.isValid()?this.toISOString():null}function lq(){return t1(this)}function uq(){return xa({},Xe(this))}function cq(){return Xe(this).overflow}function hq(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Oe("N",0,0,"eraAbbr");Oe("NN",0,0,"eraAbbr");Oe("NNN",0,0,"eraAbbr");Oe("NNNN",0,0,"eraName");Oe("NNNNN",0,0,"eraNarrow");Oe("y",["y",1],"yo","eraYear");Oe("y",["yy",2],0,"eraYear");Oe("y",["yyy",3],0,"eraYear");Oe("y",["yyyy",4],0,"eraYear");ve("N",w1);ve("NN",w1);ve("NNN",w1);ve("NNNN",bq);ve("NNNNN",Rq);St(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Xe(n).era=i:Xe(n).invalidEra=t});ve("y",yh);ve("yy",yh);ve("yyy",yh);ve("yyyy",yh);ve("yo",Eq);St(["y","yy","yyy","yyyy"],Zn);St(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Zn]=n._locale.eraYearOrdinalParse(t,i):e[Zn]=parseInt(t,10)});function dq(t,e){var n,r,i,o=this._eras||zs("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Z(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Z(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function fq(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function gq(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Z(t.since).year():Z(t.since).year()+(e-t.offset)*n}function mq(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function pq(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function wq(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function vq(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Z(i[t].since).year())*n+i[t].offset;return this.year()}function Cq(t){return ht(this,"_erasNameRegex")||v1.call(this),t?this._erasNameRegex:this._erasRegex}function yq(t){return ht(this,"_erasAbbrRegex")||v1.call(this),t?this._erasAbbrRegex:this._erasRegex}function Sq(t){return ht(this,"_erasNarrowRegex")||v1.call(this),t?this._erasNarrowRegex:this._erasRegex}function w1(t,e){return e.erasAbbrRegex(t)}function bq(t,e){return e.erasNameRegex(t)}function Rq(t,e){return e.erasNarrowRegex(t)}function Eq(t,e){return e._eraYearOrdinalRegex||yh}function v1(){var t=[],e=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(ei(s[i].name)),t.push(ei(s[i].abbr)),n.push(ei(s[i].narrow)),r.push(ei(s[i].name)),r.push(ei(s[i].abbr)),r.push(ei(s[i].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Oe(0,["gg",2],0,function(){return this.weekYear()%100});Oe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function dC(t,e){Oe(0,[t,t.length],0,e)}dC("gggg","weekYear");dC("ggggg","weekYear");dC("GGGG","isoWeekYear");dC("GGGGG","isoWeekYear");ir("weekYear","gg");ir("isoWeekYear","GG");or("weekYear",1);or("isoWeekYear",1);ve("G",aC);ve("g",aC);ve("GG",Nt,li);ve("gg",Nt,li);ve("GGGG",a1,s1);ve("gggg",a1,s1);ve("GGGGG",sC,iC);ve("ggggg",sC,iC);mg(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=rt(t)});mg(["gg","GG"],function(t,e,n,r){e[r]=Z.parseTwoDigitYear(t)});function Tq(t){return YV.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function _q(t){return YV.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Mq(){return Hs(this.year(),1,4)}function xq(){return Hs(this.isoWeekYear(),1,4)}function Pq(){var t=this.localeData()._week;return Hs(this.year(),t.dow,t.doy)}function Oq(){var t=this.localeData()._week;return Hs(this.weekYear(),t.dow,t.doy)}function YV(t,e,n,r,i){var o;return t==null?Ff(this,r,i).year:(o=Hs(t,r,i),e>o&&(e=o),Aq.call(this,t,e,n,r,i))}function Aq(t,e,n,r,i){var o=_V(t,e,n,r,i),s=$f(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Oe("Q",0,"Qo","quarter");ir("quarter","Q");or("quarter",7);ve("Q",pV);St("Q",function(t,e){e[Es]=(rt(t)-1)*3});function Iq(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Oe("D",["DD",2],"Do","date");ir("date","D");or("date",9);ve("D",Nt);ve("DD",Nt,li);ve("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});St(["D","DD"],$o);St("Do",function(t,e){e[$o]=rt(t.match(Nt)[0])});var KV=Ch("Date",!0);Oe("DDD",["DDDD",3],"DDDo","dayOfYear");ir("dayOfYear","DDD");or("dayOfYear",4);ve("DDD",oC);ve("DDDD",wV);St(["DDD","DDDD"],function(t,e,n){n._dayOfYear=rt(t)});function Hq(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Oe("m",["mm",2],0,"minute");ir("minute","m");or("minute",14);ve("m",Nt);ve("mm",Nt,li);St(["m","mm"],no);var Dq=Ch("Minutes",!1);Oe("s",["ss",2],0,"second");ir("second","s");or("second",15);ve("s",Nt);ve("ss",Nt,li);St(["s","ss"],Ts);var Nq=Ch("Seconds",!1);Oe("S",0,0,function(){return~~(this.millisecond()/100)});Oe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Oe(0,["SSS",3],0,"millisecond");Oe(0,["SSSS",4],0,function(){return this.millisecond()*10});Oe(0,["SSSSS",5],0,function(){return this.millisecond()*100});Oe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Oe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Oe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Oe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ir("millisecond","ms");or("millisecond",16);ve("S",oC,pV);ve("SS",oC,li);ve("SSS",oC,wV);var Pa,XV;for(Pa="SSSS";Pa.length<=9;Pa+="S")ve(Pa,yh);function kq(t,e){e[ql]=rt(("0."+t)*1e3)}for(Pa="S";Pa.length<=9;Pa+="S")St(Pa,kq);XV=Ch("Milliseconds",!1);Oe("z",0,0,"zoneAbbr");Oe("zz",0,0,"zoneName");function Lq(){return this._isUTC?"UTC":""}function $q(){return this._isUTC?"Coordinated Universal Time":""}var ie=fg.prototype;ie.add=OX;ie.calendar=LX;ie.clone=$X;ie.diff=jX;ie.endOf=tq;ie.format=XX;ie.from=qX;ie.fromNow=QX;ie.to=ZX;ie.toNow=JX;ie.get=W9;ie.invalidAt=cq;ie.isAfter=FX;ie.isBefore=WX;ie.isBetween=VX;ie.isSame=BX;ie.isSameOrAfter=UX;ie.isSameOrBefore=zX;ie.isValid=lq;ie.lang=BV;ie.locale=VV;ie.localeData=UV;ie.max=lX;ie.min=aX;ie.parsingFlags=uq;ie.set=V9;ie.startOf=eq;ie.subtract=AX;ie.toArray=oq;ie.toObject=sq;ie.toDate=iq;ie.toISOString=YX;ie.inspect=KX;typeof Symbol<"u"&&Symbol.for!=null&&(ie[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ie.toJSON=aq;ie.toString=GX;ie.unix=rq;ie.valueOf=nq;ie.creationData=hq;ie.eraName=mq;ie.eraNarrow=pq;ie.eraAbbr=wq;ie.eraYear=vq;ie.year=TV;ie.isLeapYear=s7;ie.weekYear=Tq;ie.isoWeekYear=_q;ie.quarter=ie.quarters=Iq;ie.month=RV;ie.daysInMonth=r7;ie.week=ie.weeks=d7;ie.isoWeek=ie.isoWeeks=f7;ie.weeksInYear=Pq;ie.weeksInWeekYear=Oq;ie.isoWeeksInYear=Mq;ie.isoWeeksInISOWeekYear=xq;ie.date=KV;ie.day=ie.days=_7;ie.weekday=M7;ie.isoWeekday=x7;ie.dayOfYear=Hq;ie.hour=ie.hours=N7;ie.minute=ie.minutes=Dq;ie.second=ie.seconds=Nq;ie.millisecond=ie.milliseconds=XV;ie.utcOffset=wX;ie.utc=CX;ie.local=yX;ie.parseZone=SX;ie.hasAlignedHourOffset=bX;ie.isDST=RX;ie.isLocal=TX;ie.isUtcOffset=_X;ie.isUtc=LV;ie.isUTC=LV;ie.zoneAbbr=Lq;ie.zoneName=$q;ie.dates=Ii("dates accessor is deprecated. Use date instead.",KV);ie.months=Ii("months accessor is deprecated. Use month instead",RV);ie.years=Ii("years accessor is deprecated. Use year instead",TV);ie.zone=Ii("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",vX);ie.isDSTShifted=Ii("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",EX);function Fq(t){return Dt(t*1e3)}function Wq(){return Dt.apply(null,arguments).parseZone()}function qV(t){return t}var dt=r1.prototype;dt.calendar=_9;dt.longDateFormat=O9;dt.invalidDate=I9;dt.ordinal=N9;dt.preparse=qV;dt.postformat=qV;dt.relativeTime=L9;dt.pastFuture=$9;dt.set=E9;dt.eras=dq;dt.erasParse=fq;dt.erasConvertYear=gq;dt.erasAbbrRegex=yq;dt.erasNameRegex=Cq;dt.erasNarrowRegex=Sq;dt.months=J9;dt.monthsShort=e7;dt.monthsParse=n7;dt.monthsRegex=o7;dt.monthsShortRegex=i7;dt.week=l7;dt.firstDayOfYear=h7;dt.firstDayOfWeek=c7;dt.weekdays=S7;dt.weekdaysMin=R7;dt.weekdaysShort=b7;dt.weekdaysParse=T7;dt.weekdaysRegex=P7;dt.weekdaysShortRegex=O7;dt.weekdaysMinRegex=A7;dt.isPM=H7;dt.meridiem=k7;function zw(t,e,n,r){var i=zs(),o=Xo().set(r,e);return i[n](o,t)}function QV(t,e,n){if($s(t)&&(e=t,t=void 0),t=t||"",e!=null)return zw(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=zw(t,r,n,"month");return i}function C1(t,e,n,r){typeof t=="boolean"?($s(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,$s(e)&&(n=e,e=void 0),e=e||"");var i=zs(),o=t?i._week.dow:0,s,a=[];if(n!=null)return zw(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=zw(e,(s+o)%7,r,"day");return a}function Vq(t,e){return QV(t,e,"months")}function Bq(t,e){return QV(t,e,"monthsShort")}function Uq(t,e,n){return C1(t,e,n,"weekdays")}function zq(t,e,n){return C1(t,e,n,"weekdaysShort")}function jq(t,e,n){return C1(t,e,n,"weekdaysMin")}Ba("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=rt(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Z.lang=Ii("moment.lang is deprecated. Use moment.locale instead.",Ba);Z.langData=Ii("moment.langData is deprecated. Use moment.localeData instead.",zs);var es=Math.abs;function Gq(){var t=this._data;return this._milliseconds=es(this._milliseconds),this._days=es(this._days),this._months=es(this._months),t.milliseconds=es(t.milliseconds),t.seconds=es(t.seconds),t.minutes=es(t.minutes),t.hours=es(t.hours),t.months=es(t.months),t.years=es(t.years),this}function ZV(t,e,n,r){var i=fo(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function Yq(t,e){return ZV(this,t,e,1)}function Kq(t,e){return ZV(this,t,e,-1)}function eA(t){return t<0?Math.floor(t):Math.ceil(t)}function Xq(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=eA(kR(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Ri(t/1e3),r.seconds=i%60,o=Ri(i/60),r.minutes=o%60,s=Ri(o/60),r.hours=s%24,e+=Ri(s/24),l=Ri(JV(e)),n+=l,e-=eA(kR(l)),a=Ri(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function JV(t){return t*4800/146097}function kR(t){return t*146097/4800}function qq(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Hi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+JV(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(kR(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function Qq(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+rt(this._months/12)*31536e6:NaN}function js(t){return function(){return this.as(t)}}var Zq=js("ms"),Jq=js("s"),eQ=js("m"),tQ=js("h"),nQ=js("d"),rQ=js("w"),iQ=js("M"),oQ=js("Q"),sQ=js("y");function aQ(){return fo(this)}function lQ(t){return t=Hi(t),this.isValid()?this[t+"s"]():NaN}function Su(t){return function(){return this.isValid()?this._data[t]:NaN}}var uQ=Su("milliseconds"),cQ=Su("seconds"),hQ=Su("minutes"),dQ=Su("hours"),fQ=Su("days"),gQ=Su("months"),mQ=Su("years");function pQ(){return Ri(this.days()/7)}var ps=Math.round,Lc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function wQ(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function vQ(t,e,n,r){var i=fo(t).abs(),o=ps(i.as("s")),s=ps(i.as("m")),a=ps(i.as("h")),l=ps(i.as("d")),u=ps(i.as("M")),c=ps(i.as("w")),h=ps(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,wQ.apply(null,d)}function CQ(t){return t===void 0?ps:typeof t=="function"?(ps=t,!0):!1}function yQ(t,e){return Lc[t]===void 0?!1:e===void 0?Lc[t]:(Lc[t]=e,t==="s"&&(Lc.ss=e-1),!0)}function SQ(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Lc,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Lc,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=vQ(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var fS=Math.abs;function Au(t){return(t>0)-(t<0)||+t}function fC(){if(!this.isValid())return this.localeData().invalidDate();var t=fS(this._milliseconds)/1e3,e=fS(this._days),n=fS(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=Ri(t/60),i=Ri(r/60),t%=60,r%=60,o=Ri(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Au(this._months)!==Au(a)?"-":"",c=Au(this._days)!==Au(a)?"-":"",h=Au(this._milliseconds)!==Au(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var at=hC.prototype;at.isValid=fX;at.abs=Gq;at.add=Yq;at.subtract=Kq;at.as=qq;at.asMilliseconds=Zq;at.asSeconds=Jq;at.asMinutes=eQ;at.asHours=tQ;at.asDays=nQ;at.asWeeks=rQ;at.asMonths=iQ;at.asQuarters=oQ;at.asYears=sQ;at.valueOf=Qq;at._bubble=Xq;at.clone=aQ;at.get=lQ;at.milliseconds=uQ;at.seconds=cQ;at.minutes=hQ;at.hours=dQ;at.days=fQ;at.weeks=pQ;at.months=gQ;at.years=mQ;at.humanize=SQ;at.toISOString=fC;at.toString=fC;at.toJSON=fC;at.locale=VV;at.localeData=UV;at.toIsoString=Ii("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",fC);at.lang=BV;Oe("X",0,0,"unix");Oe("x",0,0,"valueOf");ve("x",aC);ve("X",U9);St("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});St("x",function(t,e,n){n._d=new Date(rt(t))});//! moment.js
Z.version="2.29.4";b9(Dt);Z.fn=ie;Z.min=uX;Z.max=cX;Z.now=hX;Z.utc=Xo;Z.unix=Fq;Z.months=Vq;Z.isDate=dg;Z.locale=Ba;Z.invalid=nC;Z.duration=fo;Z.isMoment=co;Z.weekdays=Uq;Z.parseZone=Wq;Z.localeData=zs;Z.isDuration=Vp;Z.monthsShort=Bq;Z.weekdaysMin=jq;Z.defineLocale=h1;Z.updateLocale=W7;Z.locales=V7;Z.weekdaysShort=zq;Z.normalizeUnits=Hi;Z.relativeTimeRounding=CQ;Z.relativeTimeThreshold=yQ;Z.calendarFormat=kX;Z.prototype=ie;Z.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function e2(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function LR(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Jd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function an(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function oi(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ye(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function M(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function t2(t){return an(t,(e,n)=>e+n,0)}function bQ(t){return an(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function RQ(t){return an(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function EQ(t){return t.length?t2(t)/t.length:0}function n2(t){return an(t,(e,n)=>e.concat(Array.isArray(n)?n2(n):n),[])}function y1(t){const e=[];return M(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function $R(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return M(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function TQ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return M(i,s=>{o=o.filter(a=>s.includes(a))}),o}function _Q(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return M(i,s=>{M(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function FR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const MQ=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:EQ,arrayEach:M,arrayFilter:oi,arrayFlatten:n2,arrayMap:Ye,arrayMax:bQ,arrayMin:RQ,arrayReduce:an,arraySum:t2,arrayUnique:y1,extendArray:LR,getDifferenceOfArrays:$R,getIntersectionOfArrays:TQ,getUnionOfArrays:_Q,pivot:Jd,stringToArray:FR,to2dArray:e2},Symbol.toStringTag,{value:"Module"}));function pt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return an(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Zt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function fe(t){return typeof t<"u"}function _t(t){return typeof t>"u"}function pn(t){return t===null||t===""||_t(t)}function r2(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Nd="length",ef=t=>parseInt(t,16),tA=t=>parseInt(t,10),jw=(t,e,n)=>t.substr(e,n),tf=t=>t.codePointAt(0)-65,WR=t=>`${t}`.replace(/\-/g,""),xQ=t=>ef(jw(WR(t),ef("12"),tf("F")))/(ef(jw(WR(t),tf("B"),~~![][Nd]))||9),PQ=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let nA=!1;const rA={invalid:()=>pt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return pt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>pt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},iA={invalid:()=>pt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return pt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>pt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function i2(t,e){const n=!pn(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.1.0";let o,s="invalid",a="invalid";t=WR(t||"");const l=OQ(t);if(n||r||l)if(l){const u=Z("16/01/2024","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=xQ(t);o=Z((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(PQ()&&(s="valid",a="valid"),!nA&&s!=="valid"&&(rA[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](rA[s]({keyValidityDate:o,hotVersion:i})),nA=!0),a!=="valid"&&e.parentNode&&iA[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=iA[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function OQ(t){let e=[][Nd],n=e;if(t[Nd]!==tf("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=tf(i.shift());o;o=tf(i.shift()||"A"))--o<""[Nd]?n=n|(tA(`${tA(ef(r)+(ef(jw(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=jw(t,o,o?i[Nd]===1?9:8:6);return n===e}const AQ=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:i2,isDefined:fe,isEmpty:pn,isRegExp:r2,isUndefined:_t,stringify:Zt},Symbol.toStringTag,{value:"Module"}));function er(t){return t[0].toUpperCase()+t.substr(1)}function IQ(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Zt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function S1(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function b1(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function R1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function VR(t){return gC(`${t}`,{ALLOWED_TAGS:[]})}function gC(t,e){return S9.sanitize(t,e)}const HQ=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:IQ,isPercentValue:b1,randomString:S1,sanitize:gC,stripTags:VR,substitute:R1,toUpperCaseFirst:er},Symbol.toStringTag,{value:"Module"})),Sh=t=>["tabindex",t],DQ=()=>["role","treegrid"],Vo=()=>["role","presentation"],NQ=()=>["role","gridcell"],kQ=()=>["role","rowheader"],o2=()=>["role","rowgroup"],LQ=()=>["role","columnheader"],BR=()=>["role","row"],$Q=()=>["role","menu"],FQ=()=>["role","menuitem"],WQ=()=>["role","combobox"],s2=()=>["role","listbox"],VQ=()=>["role","option"],BQ=()=>["role","checkbox"],UQ=()=>["scope","col"],zQ=()=>["scope","row"],jQ=()=>["type","text"],E1=t=>["aria-label",t],Gs=()=>["aria-hidden","true"],GQ=()=>["aria-disabled","true"],YQ=()=>["aria-multiselectable","true"],a2=t=>["aria-haspopup",t],l2=t=>["aria-rowcount",t],mC=t=>["aria-colcount",t],u2=t=>["aria-rowindex",t],T1=t=>["aria-colindex",t],_i=t=>["aria-expanded",t],KQ=t=>["aria-sort",t],oA=()=>["aria-readonly","true"],sA=()=>["aria-invalid","true"],XQ=t=>["aria-checked",t],_1=()=>["aria-selected","true"],qQ=()=>["aria-autocomplete","list"],QQ=t=>["aria-controls",t],ZQ=t=>["aria-activedescendant",t],JQ=t=>["aria-live",t],eZ=t=>["aria-relevant",t],tZ=t=>["aria-setsize",t],nZ=t=>["aria-posinset",t];function c2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function h2(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function d2(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Vf(t){return d2(t)&&t.parent}function rZ(t){return!!Object.getPrototypeOf(t.parent)}function qa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function kd(t,e,n){const r=[];let i=t;for(;i&&(i=qa(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function Ua(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function f2(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function da(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function g2(t){return!t||!t.length?[]:t.filter(e=>!!e)}function m2(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function He(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function J(t,e){typeof e=="string"&&(e=e.split(" ")),e=g2(e),e.length>0&&t.classList.add(...e)}function We(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=m2(e,!0);n=g2(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Pe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function bu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=m2(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function M1(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)M1(e[n])}}function ho(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const p2=/(<(.*)>|&(.*);)/;function Ru(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p2.test(e)?t.innerHTML=n?gC(e):e:Qa(t,e)}function Qa(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(ho(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Za(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Za(n.host.impl);if(n.host)return Za(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(Fs(n).display==="none")return!1;n=n.parentNode}return!0}function yn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function x1(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function pC(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function wC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?x1(e):t.scrollTop}function P1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?pC(e):t.scrollLeft}function Bf(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function hu(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=Fs(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function ah(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=Fs(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function iZ(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function Fs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function vt(t){return t.offsetWidth}function Ut(t){return t.offsetHeight}function Ql(t){return t.clientHeight||t.innerHeight}function O1(t){return t.clientWidth||t.innerWidth}function oZ(t,e,n){t.addEventListener(e,n,!1)}function sZ(t,e,n){t.removeEventListener(e,n,!1)}function A1(t){return t.selectionStart?t.selectionStart:0}function w2(t){return t.selectionEnd?t.selectionEnd:0}function aZ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function UR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function pg(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let gS;function lZ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function Rn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return gS===void 0&&(gS=lZ(t)),gS}function v2(t){return t.offsetWidth!==t.clientWidth}function C2(t){return t.offsetHeight!==t.clientHeight}function vC(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function uZ(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function wg(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function nf(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function CC(t){return nf(t)&&t.hasAttribute("data-hot-input")===!1}function cZ(t){const e=t.ownerDocument.activeElement;CC(e)||t.select()}function I1(t){return!t.parentNode}function y2(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function H1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Pe(t,"contenteditable",!0),n&&Pe(t,...Gs()),e&&J(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function D1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&We(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function S2(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;H1(t,n),e(),D1(t,n)}const hZ=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:p2,addClass:J,addEvent:oZ,clearTextSelection:UR,closest:qa,closestDown:kd,empty:ho,fastInnerHTML:Ru,fastInnerText:Qa,getCaretPosition:A1,getComputedStyle:Fs,getCssTransform:uZ,getFrameElement:d2,getParent:c2,getParentWindow:Vf,getScrollLeft:P1,getScrollTop:wC,getScrollableElement:Bf,getScrollbarWidth:Rn,getSelectionEndPosition:w2,getSelectionText:aZ,getStyle:ah,getTrimmingContainer:hu,getWindowScrollLeft:pC,getWindowScrollTop:x1,hasAccessToParentWindow:rZ,hasClass:He,hasHorizontalScrollbar:C2,hasVerticalScrollbar:v2,index:f2,innerHeight:Ql,innerWidth:O1,isChildOf:Ua,isDetached:I1,isInput:nf,isOutsideInput:CC,isThisHotChild:h2,isVisible:Za,makeElementContentEditableAndSelectItsContent:H1,matchesCSSRules:iZ,observeVisibilityChangeOnce:y2,offset:yn,outerHeight:Ut,outerWidth:vt,overlayContainsElement:da,removeAttribute:bu,removeClass:We,removeContentEditableFromElementAndDeselect:D1,removeEvent:sZ,removeTextNodes:M1,resetCssTransform:wg,runWithSelectedContendEditableElement:S2,selectElementIfAllowed:cZ,setAttribute:Pe,setCaretPosition:pg,setOverlayPosition:vC},Symbol.toStringTag,{value:"Module"}));function Tt(t){return typeof t=="function"}function b2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function dZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=b2(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function yC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function fZ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return an(i,(u,c)=>c(u),r.apply(this,a))}}function N1(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function R2(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function gZ(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Gw(t,e,n,r,i,o,s,a){return fe(a)?t.call(e,n,r,i,o,s,a):fe(s)?t.call(e,n,r,i,o,s):fe(o)?t.call(e,n,r,i,o):fe(i)?t.call(e,n,r,i):fe(r)?t.call(e,n,r):fe(n)?t.call(e,n):t.call(e)}const mZ=Object.freeze(Object.defineProperty({__proto__:null,curry:R2,curryRight:gZ,debounce:yC,fastCall:Gw,isFunction:Tt,partial:N1,pipe:fZ,throttle:b2,throttleAfterHits:dZ},Symbol.toStringTag,{value:"Module"}));var pZ=Rr,aA=BW,wZ=rr,lA=wh,vZ=XW,uA=pZ([].push),CZ=function(t){if(wZ(t))return t;if(aA(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?uA(n,i):(typeof i=="number"||lA(i)==="Number"||lA(i)==="String")&&uA(n,vZ(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(aA(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},yZ=ul,E2=lg,T2=tC,SZ=Cu,vg=Rr,_2=Ai,cA=rr,hA=WT,M2=ZT,bZ=CZ,RZ=FT,EZ=String,za=E2("JSON","stringify"),om=vg(/./.exec),dA=vg("".charAt),TZ=vg("".charCodeAt),_Z=vg("".replace),MZ=vg(1 .toString),xZ=/[\uD800-\uDFFF]/g,fA=/^[\uD800-\uDBFF]$/,gA=/^[\uDC00-\uDFFF]$/,mA=!RZ||_2(function(){var t=E2("Symbol")("stringify detection");return za([t])!=="[null]"||za({a:t})!=="{}"||za(Object(t))!=="{}"}),pA=_2(function(){return za("\uDF06\uD834")!=='"\\udf06\\ud834"'||za("\uDEAD")!=='"\\udead"'}),PZ=function(t,e){var n=M2(arguments),r=bZ(e);if(!(!cA(r)&&(t===void 0||hA(t))))return n[1]=function(i,o){if(cA(r)&&(o=SZ(r,this,EZ(i),o)),!hA(o))return o},T2(za,null,n)},OZ=function(t,e,n){var r=dA(n,e-1),i=dA(n,e+1);return om(fA,t)&&!om(gA,i)||om(gA,t)&&!om(fA,r)?"\\u"+MZ(TZ(t,0),16):t};za&&yZ({target:"JSON",stat:!0,arity:3,forced:mA||pA},{stringify:function(e,n,r){var i=M2(arguments),o=T2(mA?PZ:za,null,i);return pA&&typeof o=="string"?_Z(o,xZ,OZ):o}});function lh(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ke(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=lh(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[lh(n[0])]:e[r]=[]:e[r]=null)})),e}function Ys(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function hn(t,e,n){const r=Array.isArray(n);return Ke(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Cg(t,e){Ke(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Cg(t[r],e[r])):t[r]=e[r]})}function tr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Cr(t){const e={};return Ke(t,(n,r)=>{e[r]=n}),e}function bt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return M(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ke(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=m=>{let C=m;return(Array.isArray(C)||je(C))&&(C=tr(C)),C};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function SC(t,e){return JSON.stringify(t)===JSON.stringify(e)}function je(t){return Object.prototype.toString.call(t)==="[object Object]"}function Qo(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ke(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function x2(t,e){const n=e.split(".");let r=t;return Ke(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Up(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(Bt(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function bC(t){if(!je(t))return 0;const e=function(n){let r=0;return je(n)?Ke(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function ro(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Bt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const AZ=Object.freeze(Object.defineProperty({__proto__:null,clone:Cr,createObjectPropListener:ro,deepClone:tr,deepExtend:Cg,deepObjectSize:bC,defineGetter:Qo,duckSchema:lh,extend:hn,getProperty:x2,hasOwnProperty:Bt,inherit:Ys,isObject:je,isObjectEqual:SC,mixin:bt,objectEach:Ke,setProperty:Up},Symbol.toStringTag,{value:"Module"}));function RC(t){return window.requestAnimationFrame(t)}function Uf(t){window.cancelAnimationFrame(t)}function k1(){return"ontouchstart"in window}function P2(){return typeof window<"u"}let Iu;function O2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Iu||(typeof Intl=="object"?Iu=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Iu=(n,r)=>`${n}`.localeCompare(r):Iu=(n,r)=>n===r?0:n>r?-1:1,Iu)}const IZ=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Uf,getComparisonFunction:O2,isCSR:P2,isTouchSupported:k1,requestAnimationFrame:RC},Symbol.toStringTag,{value:"Module"})),wi=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Ks={chrome:wi((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:wi(t=>/CriOS/.test(t)),edge:wi(t=>/Edge/.test(t)),edgeWebKit:wi(t=>/EdgiOS/.test(t)),firefox:wi(t=>/Firefox/.test(t)),firefoxWebKit:wi(t=>/FxiOS/.test(t)),mobile:wi(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:wi((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},bh={mac:wi(t=>/^Mac/.test(t)),win:wi(t=>/^Win/.test(t)),linux:wi(t=>/^Linux/.test(t)),ios:wi(t=>/iPhone|iPad|iPod/i.test(t))};function A2(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ke(Ks,n=>{let{test:r}=n;return void r(t,e)})}function I2(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ke(bh,e=>{let{test:n}=e;return void n(t)})}P2()&&(A2(),I2());function L1(){return Ks.chrome.value}function H2(){return Ks.chromeWebKit.value}function zp(){return Ks.firefox.value}function D2(){return Ks.firefoxWebKit.value}function $1(){return Ks.safari.value}function N2(){return Ks.edge.value}function HZ(){return Ks.edgeWebKit.value}function _s(){return Ks.mobile.value}function F1(){return bh.ios.value}function W1(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&bh.mac.value}function zR(){return bh.win.value}function zf(){return bh.mac.value}function DZ(){return bh.linux.value}const NZ=Object.freeze(Object.defineProperty({__proto__:null,isChrome:L1,isChromeWebKit:H2,isEdge:N2,isEdgeWebKit:HZ,isFirefox:zp,isFirefoxWebKit:D2,isIOS:F1,isIpadOS:W1,isLinuxOS:DZ,isMacOS:zf,isMobileBrowser:_s,isSafari:$1,isWindowsOS:zR,setBrowserMeta:A2,setPlatformMeta:I2},Symbol.toStringTag,{value:"Module"})),be={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:zp()?182:174,AUDIO_MUTE:zp()?181:173,AUDIO_UP:zp()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},kZ=[be.ALT,be.ARROW_DOWN,be.ARROW_LEFT,be.ARROW_RIGHT,be.ARROW_UP,be.AUDIO_DOWN,be.AUDIO_MUTE,be.AUDIO_UP,be.BACKSPACE,be.CAPS_LOCK,be.DELETE,be.END,be.ENTER,be.ESCAPE,be.F1,be.F2,be.F3,be.F4,be.F5,be.F6,be.F7,be.F8,be.F9,be.F10,be.F11,be.F12,be.F13,be.F14,be.F15,be.F16,be.F17,be.F18,be.F19,be.HOME,be.INSERT,be.MEDIA_NEXT,be.MEDIA_PLAY_PAUSE,be.MEDIA_PREV,be.MEDIA_STOP,be.NULL,be.NUM_LOCK,be.PAGE_DOWN,be.PAGE_UP,be.PAUSE,be.SCROLL_LOCK,be.SHIFT,be.TAB];function k2(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function V1(t){return kZ.includes(t)}function LZ(t){const e=[];return zf()?e.push(be.COMMAND_LEFT,be.COMMAND_RIGHT,be.COMMAND_FIREFOX):e.push(be.CONTROL),e.includes(t)}function L2(t){return[be.CONTROL,be.COMMAND_LEFT,be.COMMAND_RIGHT,be.COMMAND_FIREFOX].includes(t)}function Rh(t,e){const n=e.split("|");let r=!1;return M(n,i=>{if(t===be[i])return r=!0,!1}),r}const $Z=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:be,isCtrlKey:LZ,isCtrlMetaKey:L2,isFunctionKey:V1,isKey:Rh,isPrintableChar:k2},Symbol.toStringTag,{value:"Module"}));function Di(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function ba(t){return t.isImmediatePropagationEnabled===!1}function Ja(t){return t.button===2}function EC(t){return t.button===0}function $2(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const FZ=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:ba,isLeftClick:EC,isRightClick:Ja,offsetRelativeTo:$2,stopImmediatePropagation:Di},Symbol.toStringTag,{value:"Module"}));function yt(){fe(console)&&console.warn(...arguments)}function B1(){fe(console)&&console.error(...arguments)}function WZ(t,e,n){return e=VZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VZ(t){var e=BZ(t,"string");return typeof e=="symbol"?e:String(e)}function BZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Hu=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],UZ=pt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,mS=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),pS=new Map([[]]);class F2{static getSingleton(){return jZ()}constructor(){WZ(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return M(Hu,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))M(n,i=>this.add(e,i,r));else{mS.has(e)&&yt(R1(UZ,{hookName:e,removedInVersion:mS.get(e)})),pS.has(e)&&yt(pS.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&M(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?M(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Gw(u[h],e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h]),h+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Gw(u[h],e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h],e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ke(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||Hu.push(e)}deregister(e){this.isRegistered(e)&&Hu.splice(Hu.indexOf(e),1)}isDeprecated(e){return pS.has(e)||mS.has(e)}isRegistered(e){return Hu.indexOf(e)>=0}getRegistered(){return Hu}}const zZ=new F2;function jZ(){return zZ}const we=F2,wS=new Map;function go(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";wS.has(t)||wS.set(t,new Map);const e=wS.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const jR=new WeakMap,{register:GZ,getItem:W2,hasItem:V2,getNames:YZ,getValues:DRe}=go("editors");function KZ(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},we.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function B2(t,e){let n;if(typeof t=="function")jR.get(t)||Hr(null,t),n=jR.get(t);else if(typeof t=="string")n=W2(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Yw(t){if(typeof t=="function")return t;if(!V2(t))throw Error(`No registered editor found under "${t}" name`);return W2(t).getConstructor()}function Hr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new KZ(e);typeof t=="string"&&GZ(t,n),jR.set(e,n)}function XZ(t,e,n){return e=qZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qZ(t){var e=QZ(t,"string");return typeof e=="symbol"?e:String(e)}function QZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let jp=0;class ZZ{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;XZ(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,JZ(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),jp+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),jp-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),jp-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function JZ(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Di(this)},t}const Oi=ZZ;function eJ(){return jp}function wA(t,e){tJ(t,e),e.add(t)}function tJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zs(t,e,n){return e=nJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nJ(t){var e=rJ(t,"string");return typeof e=="symbol"?e:String(e)}function rJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vA(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const TC="editorManager.navigation";var CA=new WeakSet,yA=new WeakSet;class GR{constructor(e,n,r){wA(this,yA),wA(this,CA),Zs(this,"hot",void 0),Zs(this,"tableMeta",void 0),Zs(this,"selection",void 0),Zs(this,"eventManager",void 0),Zs(this,"destroyed",!1),Zs(this,"lock",!1),Zs(this,"activeEditor",void 0),Zs(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Oi(e),this.hot.addHook("afterDocumentKeyDown",i=>vA(this,CA,iJ).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>vA(this,yA,oJ).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i);let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=B2(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function iJ(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||ba(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!V1(n)&&!L2(n)&&!r&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>fe(this.hot.getSelected()),group:TC};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function oJ(t,e,n){n.nodeName==="TD"&&this.openEditor(null,t,!0)}const SA=new WeakMap;GR.getInstance=function(t,e,n){let r=SA.get(t);return r||(r=new GR(t,e,n),SA.set(t,r)),r};const sJ=GR;function sm(t,e){U2(t,e),e.add(t)}function Uh(t,e,n){U2(t,e),e.set(t,n)}function U2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $c(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Yt(t,e){var n=z2(t,e,"get");return aJ(t,n)}function aJ(t,e){return e.get?e.get.call(t):e.value}function zh(t,e,n){var r=z2(t,e,"set");return lJ(t,r,n),n}function z2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function lJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Oa=Object.freeze({CELL:"cell",MIXED:"mixed"});var $n=new WeakMap,am=new WeakMap,lm=new WeakMap,um=new WeakMap,cm=new WeakMap,Kw=new WeakSet,bA=new WeakSet,RA=new WeakSet,EA=new WeakSet;class uJ{constructor(e){var n=this;sm(this,EA),sm(this,RA),sm(this,bA),sm(this,Kw),Uh(this,$n,{writable:!0,value:void 0}),Uh(this,am,{writable:!0,value:void 0}),Uh(this,lm,{writable:!0,value:50}),Uh(this,um,{writable:!0,value:null}),Uh(this,cm,{writable:!0,value:new Map});const r=e.getSettings();zh(this,$n,e),zh(this,am,r.imeFastEdit?Oa.MIXED:Oa.CELL),Yt(this,$n).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return $c(n,EA,dJ).call(n,...o)}),Yt(this,$n).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return $c(n,bA,cJ).call(n,...o)}),Yt(this,$n).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return $c(n,RA,hJ).call(n,...o)})}getFocusMode(){return Yt(this,am)}setFocusMode(e){Object.values(Oa).includes(e)?zh(this,am,e):yt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Yt(this,lm)}setRefocusDelay(e){zh(this,lm,e)}setRefocusElementGetter(e){zh(this,um,e)}getRefocusElement(){if(typeof Yt(this,um)=="function")return Yt(this,um).call(this);var e;return(e=Yt(this,$n).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Yt(this,$n).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Yt(this,$n).runHooks("modifyFocusedElement",s.row,s.col,r);a instanceof HTMLElement||(a=r),a&&!((o=Yt(this,$n).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):$c(this,Kw,U1).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Yt(this,lm);const r=this.getRefocusElement();Yt(this,$n).getSettings().imeFastEdit&&!((e=Yt(this,$n).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(Yt(this,cm).has(n)||Yt(this,cm).set(n,yC(()=>{r.select()},n)),Yt(this,cm).get(n)())}}function U1(t){var e;const n=(e=Yt(this,$n).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Yt(this,$n).selection.isCellVisible(n)){t(null);return}const r=Yt(this,$n).getCell(n.row,n.col,!0);r===null?Yt(this,$n).addHookOnce("afterScroll",()=>{t(Yt(this,$n).getCell(n.row,n.col,!0))}):t(r)}function cJ(){$c(this,Kw,U1).call(this,t=>{const{activeElement:e}=Yt(this,$n).rootDocument;e&&CC(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function hJ(){$c(this,Kw,U1).call(this,t=>{this.getFocusMode()===Oa.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function dJ(t){t.imeFastEdit&&this.getFocusMode()!==Oa.MIXED?this.setFocusMode(Oa.MIXED):!t.imeFastEdit&&this.getFocusMode()!==Oa.CELL&&this.setFocusMode(Oa.CELL)}const j2={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},fJ=new RegExp(Object.keys(j2).map(t=>`(${t})`).join("|"),"gi");function gJ(t){return(t&&t.nodeName||"")==="TABLE"}function YR(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,m=[];for(let b=0;b<s;b+=1){const p=!f&&n&&b===0;let w="";if(f)w=`<th>${t.getColHeader(b-c)}</th>`;else if(p)w=`<th>${t.getRowHeader(d-h)}</th>`;else{const y=i[d][b],{hidden:E,rowspan:T,colspan:x}=t.getCellMeta(d-h,b-c);if(!E){const A=[];if(T&&A.push(`rowspan="${T}"`),x&&A.push(`colspan="${x}"`),pn(y))w=`<td ${A.join(" ")}></td>`;else{const W=y.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");w=`<td ${A.join(" ")}>${W}</td>`}}}m.push(w)}const C=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,C):u.splice(-1,0,C)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function KR(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=pn(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function G2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const y=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,E=>{const T=E.match(/<td\b[^>]*?>/g)[0],x=E.substring(T.length,E.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${T}${x}</td>`});i.insertAdjacentHTML("afterbegin",`${y}`),o=i.querySelector("table")}if(!o||!gJ(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((y,E)=>y+E.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,m=0;if(o.tHead){const y=Array.from(o.tHead.rows).filter(E=>{const T=E.querySelector("td")!==null;return T&&h.push(E),!T});f=y.length,d=f>0,f>1?n.nestedHeaders=Array.from(y).reduce((E,T)=>{const x=Array.from(T.cells).reduce((A,W,B)=>{if(a&&B===0)return A;const{colSpan:U,innerHTML:Q}=W,te=U>1?{label:Q,colspan:U}:Q;return A.push(te),A},[]);return E.push(x),E},[]):d&&(n.colHeaders=Array.from(y[0].children).reduce((E,T,x)=>(a&&x===0||E.push(T.innerHTML),E),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const C=[...h,...Array.from(o.tBodies).reduce((y,E)=>(y.push(...Array.from(E.rows)),y),[]),...c];m=C.length;const b=new Array(m);for(let y=0;y<m;y++)b[y]=new Array(u);const p=[],w=[];for(let y=0;y<m;y++){const E=C[y],T=Array.from(E.cells),x=T.length;for(let A=0;A<x;A++){const W=T[A],{nodeName:B,innerHTML:U,rowSpan:Q,colSpan:te}=W,ee=b[y].findIndex(he=>he===void 0);if(B==="TD"){if(Q>1||te>1){for(let ke=y;ke<y+Q;ke++)if(ke<m)for(let Y=ee;Y<ee+te;Y++)b[ke][Y]=null;const _e=W.getAttribute("style");_e&&_e.includes("mso-ignore:colspan")||p.push({col:ee,row:y,rowspan:Q,colspan:te})}let he="";s&&/excel/gi.test(s.content)?he=U.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):he=U.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[y][ee]=he.replace(fJ,_e=>j2[_e])}else w.push(U)}}return p.length&&(n.mergeCells=p),w.length&&(n.rowHeaders=w),b.length&&(n.data=b),n}const mJ=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:KR,htmlToGridSettings:G2,instanceToHTML:YR},Symbol.toStringTag,{value:"Module"}));function wr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Y2(t){return wr(t,[","])}function Se(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function Xw(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function z1(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Fr(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const pJ=Object.freeze(Object.defineProperty({__proto__:null,clamp:Fr,isNumeric:wr,isNumericLike:Y2,rangeEach:Se,rangeEachReverse:Xw,valueAccordingPercent:z1},Symbol.toStringTag,{value:"Module"})),XR="asc",wJ="desc",TA=new Map([[XR,[-1,1]],[wJ,[1,-1]]]),vJ=t=>`The priority '${t}' is already declared in a map.`,CJ=t=>`The priority '${t}' is not a number.`;function yJ(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=Tt(t)?t:vJ,e=Tt(e)?e:CJ;function r(o,s){if(!wr(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:XR;const[s,a]=TA.get(o)||TA.get(XR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const SJ=t=>`The id '${t}' is already declared in a map.`;function _C(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Tt(t)?t:SJ;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const bJ=t=>`'${t}' value is already declared in a unique set.`;function RJ(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Tt(t)?t:bJ;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const j1=t=>`There is already registered "${t}" plugin.`,EJ=t=>`There is already registered plugin on priority "${t}".`,TJ=t=>`The priority "${t}" is not a number.`,K2=yJ({errorPriorityExists:EJ,errorPriorityNaN:TJ}),X2=RJ({errorItemExists:j1}),qR=_C({errorIdExists:j1});function G1(){return[...K2.getItems(),...X2.getItems()]}function yg(t){const e=er(t);return qR.getItem(e)}function _J(t){return!!yg(t)}function st(t,e,n){[t,e,n]=xJ(t,e,n),yg(t)===void 0&&MJ(t,e,n)}function MJ(t,e,n){const r=er(t);if(qR.hasItem(r))throw new Error(j1(r));n===void 0?X2.addItem(r):K2.addItem(n,r),qR.addItem(r,e)}function xJ(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:PJ,getItem:OJ,hasItem:q2,getNames:AJ,getValues:NRe}=go("renderers");function qw(t){if(typeof t=="function")return t;if(!q2(t))throw Error(`No registered renderer found under "${t}" name`);return OJ(t)}function Yr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),PJ(t,e)}const{register:IJ,getItem:HJ,hasItem:Q2,getNames:DJ,getValues:kRe}=go("validators");function Y1(t){if(typeof t=="function")return t;if(!Q2(t))throw Error(`No registered validator found under "${t}" name`);return HJ(t)}function Gl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),IJ(t,e)}function hm(t,e,n){return e=NJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NJ(t){var e=kJ(t,"string");return typeof e=="symbol"?e:String(e)}function kJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LJ{constructor(e){hm(this,"count",0),hm(this,"startColumn",0),hm(this,"endColumn",0),hm(this,"startPosition",0),this.count=e.totalColumns,this.endColumn=this.count-1}}function dm(t,e,n){return e=$J(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $J(t){var e=FJ(t,"string");return typeof e=="symbol"?e:String(e)}function FJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WJ{constructor(e){dm(this,"count",0),dm(this,"startRow",0),dm(this,"endRow",0),dm(this,"startPosition",0),this.count=e.totalRows,this.endRow=this.count-1}}var Z2={},VJ=FW,BJ=qT,UJ=Object.keys||function(e){return VJ(e,BJ)},zJ=Yo,jJ=IW,GJ=al,YJ=ll,KJ=Qv,XJ=UJ;Z2.f=zJ&&!jJ?Object.defineProperties:function(e,n){YJ(e);for(var r=KJ(n),i=XJ(n),o=i.length,s=0,a;o>s;)GJ.f(e,a=i[s++],r[a]);return e};var qJ=ll,QJ=Z2,_A=qT,ZJ=YT,JJ=tV,eee=jT,tee=NW,MA=">",xA="<",QR="prototype",ZR="script",J2=tee("IE_PROTO"),vS=function(){},eB=function(t){return xA+ZR+MA+t+xA+"/"+ZR+MA},PA=function(t){t.write(eB("")),t.close();var e=t.parentWindow.Object;return t=null,e},nee=function(){var t=eee("iframe"),e="java"+ZR+":",n;return t.style.display="none",JJ.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(eB("document.F=Object")),n.close(),n.F},fm,Gp=function(){try{fm=new ActiveXObject("htmlfile")}catch{}Gp=typeof document<"u"?document.domain&&fm?PA(fm):nee():PA(fm);for(var t=_A.length;t--;)delete Gp[QR][_A[t]];return Gp()};ZJ[J2]=!0;var ree=Object.create||function(e,n){var r;return e!==null?(vS[QR]=qJ(e),r=new vS,vS[QR]=null,r[J2]=e):r=Gp(),n===void 0?r:QJ.f(r,n)},iee=vh,oee=ree,see=al.f,JR=iee("unscopables"),eE=Array.prototype;eE[JR]===void 0&&see(eE,JR,{configurable:!0,value:oee(null)});var tB=function(t){eE[JR][t]=!0},aee=ul,lee=eC,uee=cg,cee=XT,hee=tB;aee({target:"Array",proto:!0},{at:function(e){var n=lee(this),r=uee(n),i=cee(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});hee("at");const wa=1,qn=2;function dee(t,e,n){fee(t,e),e.set(t,n)}function fee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jh(t,e,n){return e=gee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gee(t){var e=mee(t,"string");return typeof e=="symbol"?e:String(e)}function mee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Du(t,e){var n=nB(t,e,"get");return pee(t,n)}function pee(t,e){return e.get?e.get.call(t):e.value}function wee(t,e,n){var r=nB(t,e,"set");return vee(t,r,n),n}function nB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Js=new WeakMap;class Sg{static get DEFAULT_WIDTH(){return 50}constructor(e){jh(this,"count",0),jh(this,"startColumn",null),jh(this,"endColumn",null),jh(this,"startPosition",null),jh(this,"isVisibleInTrimmingContainer",!1),dee(this,Js,{writable:!0,value:void 0}),wee(this,Js,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=Du(this,Js),s=Math.max(Du(this,Js).scrollOffset,0),a=s>0?o+1:o;let l=0,u=!0;const c=[];let h,d=0,f=0;for(let p=0;p<i;p++)if(h=this._getColumnWidth(p),l<=s&&e!==qn&&(this.startColumn=p,d=h),l>=s&&l+(e===qn?h:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=p,d=h),this.endColumn=p),c.push(l),l+=h,f=h,e!==qn&&(this.endColumn=p),l>=s+o){u=!1;break}const m=r+o-a,C=e===qn?0:f,b=e===qn?d:0;if(m<-1*Du(this,Js).inlineStartOffset||r>c.at(-1)+C||-1*Du(this,Js).scrollOffset-Du(this,Js).viewportWidth>-1*b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const p=c[this.endColumn]+h-c[this.startColumn-1];if((p<=o||e!==qn)&&(this.startColumn-=1),p>o)break}e===wa&&this.startColumn!==null&&n&&n(this),this.startPosition=c[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}_getColumnWidth(e){let n=Du(this,Js).columnWidthFn(e);return isNaN(n)&&(n=Sg.DEFAULT_WIDTH),n}}function Cee(t,e,n){yee(t,e),e.set(t,n)}function yee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gh(t,e,n){return e=See(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function See(t){var e=bee(t,"string");return typeof e=="symbol"?e:String(e)}function bee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CS(t,e){var n=rB(t,e,"get");return Ree(t,n)}function Ree(t,e){return e.get?e.get.call(t):e.value}function Eee(t,e,n){var r=rB(t,e,"set");return Tee(t,r,n),n}function rB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Tee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Yh=new WeakMap;class MC{static get DEFAULT_HEIGHT(){return 23}constructor(e){Gh(this,"count",0),Gh(this,"startRow",null),Gh(this,"endRow",null),Gh(this,"startPosition",null),Gh(this,"isVisibleInTrimmingContainer",!1),Cee(this,Yh,{writable:!0,value:void 0}),Eee(this,Yh,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=CS(this,Yh),a=Math.max(CS(this,Yh).scrollOffset,0),l=CS(this,Yh).horizontalScrollbarHeight||0;let u=0,c=!0;const h=[];let d,f=0,m=0;for(let w=0;w<o;w++)if(d=r(w),isNaN(d)&&(d=MC.DEFAULT_HEIGHT),u<=a&&e!==qn&&(this.startRow=w,f=d),u>=a&&u+(e===qn?d:0)<=a+s-l&&(this.startRow===null&&(this.startRow=w,f=d),this.endRow=w),h.push(u),u+=d,m=d,e!==qn&&(this.endRow=w),u>=a+s-l){c=!1;break}const C=i+s-l,b=e===qn?f:0,p=e===qn?0:m;if(C<b||i>h.at(-1)+p?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const w=h[this.endRow]+d-h[this.startRow-1];if((w<=s-l||e!==qn)&&(this.startRow-=1),w>=s-l)break}e===wa&&this.startRow!==null&&n&&n(this),this.startPosition=h[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _ee(t,e,n){Mee(t,e),e.set(t,n)}function Mee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OA(t,e,n){return e=xee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xee(t){var e=Pee(t,"string");return typeof e=="symbol"?e:String(e)}function Pee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nu(t,e){var n=iB(t,e,"get");return Oee(t,n)}function Oee(t,e){return e.get?e.get.call(t):e.value}function AA(t,e,n){var r=iB(t,e,"set");return Aee(t,r,n),n}function iB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Aee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ts=new WeakMap;class Qw{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;OA(this,"row",null),OA(this,"col",null),_ee(this,ts,{writable:!0,value:!1}),AA(this,ts,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Nu(this,ts)}isSouthEastOf(e){return this.row>=e.row&&(Nu(this,ts)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Nu(this,ts)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Nu(this,ts)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Nu(this,ts)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Qw&&AA(this,ts,e.isRtl()),this}clone(){return new Qw(this.row,this.col,Nu(this,ts))}toObject(){return{row:this.row,col:this.col}}}const Zw=Qw;function Iee(t,e,n){Hee(t,e),e.set(t,n)}function Hee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yS(t,e,n){return e=Dee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dee(t){var e=Nee(t,"string");return typeof e=="symbol"?e:String(e)}function Nee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ci(t,e){var n=oB(t,e,"get");return kee(t,n)}function kee(t,e){return e.get?e.get.call(t):e.value}function Lee(t,e,n){var r=oB(t,e,"set");return $ee(t,r,n),n}function oB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function $ee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var _r=new WeakMap;class K1{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;yS(this,"highlight",null),yS(this,"from",null),yS(this,"to",null),Iee(this,_r,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),Lee(this,_r,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),h=this._createCellCoords(a,l),d=this._createCellCoords(u,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ci(this,_r)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ci(this,_r)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ci(this,_r)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ci(this,_r)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ci(this,_r)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ci(this,_r)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ci(this,_r)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ci(this,_r)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Zw))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(ci(this,_r)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(ci(this,_r)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new K1(this.highlight,this.from,this.to,ci(this,_r))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new Zw(e,n,ci(this,_r))}}const X1=K1;function wo(t,e,n){Fee(t,e),e.set(t,n)}function Fee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Re(t,e){var n=sB(t,e,"get");return Wee(t,n)}function Wee(t,e){return e.get?e.get.call(t):e.value}function ea(t,e,n){var r=sB(t,e,"set");return Vee(t,r,n),n}function sB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Vee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var hi=new WeakMap,SS=new WeakMap,Tn=new WeakMap,ku=new WeakMap,gm=new WeakMap,Li=new WeakMap,bS=new WeakMap,Kh=new WeakMap,ml=new WeakMap,vo=new WeakMap;let Bee=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;wo(this,hi,{writable:!0,value:void 0}),wo(this,SS,{writable:!0,value:void 0}),wo(this,Tn,{writable:!0,value:void 0}),wo(this,ku,{writable:!0,value:void 0}),wo(this,gm,{writable:!0,value:void 0}),wo(this,Li,{writable:!0,value:void 0}),wo(this,bS,{writable:!0,value:void 0}),wo(this,Kh,{writable:!0,value:void 0}),wo(this,ml,{writable:!0,value:[null,null]}),wo(this,vo,{writable:!0,value:[null,null]}),ea(this,hi,r),ea(this,SS,n),ea(this,Tn,o),ea(this,ku,s),ea(this,gm,a),ea(this,Li,i),ea(this,bS,e),this.registerEvents()}registerEvents(){Re(this,Li).addEventListener(Re(this,Tn).holder,"contextmenu",r=>this.onContextMenu(r)),Re(this,Li).addEventListener(Re(this,Tn).TABLE,"mouseover",r=>this.onMouseOver(r)),Re(this,Li).addEventListener(Re(this,Tn).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{Re(this,Li).addEventListener(Re(this,Tn).holder,"touchstart",r=>this.onTouchStart(r)),Re(this,Li).addEventListener(Re(this,Tn).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),Re(this,Li).addEventListener(Re(this,Tn).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Re(this,hi).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Re(this,hi).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{Re(this,Li).addEventListener(Re(this,Tn).holder,"mouseup",r=>this.onMouseUp(r)),Re(this,Li).addEventListener(Re(this,Tn).holder,"mousedown",r=>this.onMouseDown(r))};_s()?e():(k1()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(Re(this,Kh)&&r){const[i,o]=[r.row,Re(this,Kh).from.row],[s,a]=[r.col,Re(this,Kh).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=Re(this,Tn).TABLE,i=kd(e,["TD","TH"],r);return i?(n.coords=Re(this,Tn).getCoords(i),n.TD=i):He(e,"wtBorder")&&He(e,"current")?(n.coords=Re(this,ku).getFocusSelection().cellRange.highlight,n.TD=Re(this,Tn).getCell(n.coords)):He(e,"wtBorder")&&He(e,"area")&&Re(this,ku).getAreaSelection().cellRange&&(n.coords=Re(this,ku).getAreaSelection().cellRange.to,n.TD=Re(this,Tn).getCell(n.coords)),n}onMouseDown(e){const n=Re(this,SS).rootDocument.activeElement,r=N1(c2,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);He(i,"corner")?Re(this,hi).getSetting("onCellCornerMouseDown",e,i):o.TD&&Re(this,hi).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(Re(this,vo)[0]=o.TD,clearTimeout(Re(this,ml)[0]),Re(this,ml)[0]=setTimeout(()=>{Re(this,vo)[0]=null},1e3))}onContextMenu(e){if(Re(this,hi).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!Re(this,hi).has("onCellMouseOver"))return;const n=Re(this,Tn).TABLE,r=kd(e.target,["TD","TH"],n),i=Re(this,gm)||this;r&&r!==i.lastMouseOver&&Ua(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,Re(this,Tn).getCoords(r),r))}onMouseOut(e){if(!Re(this,hi).has("onCellMouseOut"))return;const n=Re(this,Tn).TABLE,r=kd(e.target,["TD","TH"],n),i=kd(e.relatedTarget,["TD","TH"],n),o=Re(this,gm)||this;r&&r!==i&&Ua(r,n)&&(this.callListener("onCellMouseOut",e,Re(this,Tn).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&Re(this,hi).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===Re(this,vo)[0]&&n.TD===Re(this,vo)[1]?(He(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),Re(this,vo)[0]=null,Re(this,vo)[1]=null):n.TD===Re(this,vo)[0]&&(Re(this,vo)[1]=n.TD,clearTimeout(Re(this,ml)[1]),Re(this,ml)[1]=setTimeout(()=>{Re(this,vo)[1]=null},500)))}onTouchStart(e){ea(this,Kh,Re(this,ku).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=fe(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&Re(this,hi).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];F1()&&(H2()||D2())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=Re(this,hi).getSettingPure(e);o&&o(n,r,i,Re(this,bS).call(this))}destroy(){clearTimeout(Re(this,ml)[0]),clearTimeout(Re(this,ml)[1]),Re(this,Li).destroy()}};const aB=Bee;function RS(t,e,n){return e=Uee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uee(t){var e=zee(t,"string");return typeof e=="symbol"?e:String(e)}function zee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jee{constructor(e,n,r){RS(this,"offset",void 0),RS(this,"total",void 0),RS(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const Gee=jee;function ES(t,e,n){return e=Yee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yee(t){var e=Kee(t,"string");return typeof e=="symbol"?e:String(e)}function Kee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xee{constructor(e,n,r){ES(this,"offset",void 0),ES(this,"total",void 0),ES(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const qee=Xee,Qee=0,Jw=1,ev=2;function mm(t,e,n){return e=Zee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zee(t){var e=Jee(t,"string");return typeof e=="symbol"?e:String(e)}function Jee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IA{constructor(){mm(this,"currentSize",0),mm(this,"nextSize",0),mm(this,"currentOffset",0),mm(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function TS(t,e,n){return e=ete(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ete(t){var e=tte(t,"string");return typeof e=="symbol"?e:String(e)}function tte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nte{constructor(){TS(this,"size",new IA),TS(this,"workingSpace",Qee),TS(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof IA}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Jw,e.workingSpace=ev,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=ev,e.workingSpace=Jw,this.sharedSize=e.getViewSize()}}function Lu(t,e,n){return e=rte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rte(t){var e=ite(t,"string");return typeof e=="symbol"?e:String(e)}function ite(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lB{constructor(e,n,r){Lu(this,"rootNode",void 0),Lu(this,"nodesPool",void 0),Lu(this,"sizeSet",new nte),Lu(this,"childNodeType",void 0),Lu(this,"visualIndex",0),Lu(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(Jw))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(ev)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn(Jw);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(ev)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class uB extends lB{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function ote(t,e,n){return e=ste(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ste(t){var e=ate(t,"string");return typeof e=="symbol"?e:String(e)}function ate(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lte{constructor(e){ote(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Xh(t,e,n){return e=ute(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ute(t){var e=cte(t,"string");return typeof e=="symbol"?e:String(e)}function cte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bg{constructor(e,n){Xh(this,"nodesPool",null),Xh(this,"nodeType",void 0),Xh(this,"rootNode",void 0),Xh(this,"table",null),Xh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new lte(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function HA(t,e,n){return e=hte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hte(t){var e=dte(t,"string");return typeof e=="symbol"?e:String(e)}function dte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fte extends bg{constructor(){super("TH"),HA(this,"orderViews",new WeakMap),HA(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new uB(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<r;h++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),bu(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Pe(d,[kQ(),zQ(),T1(h+1),Sh(-1)]),n[h](a,d,h)}u.end()}}}class gte extends bg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&ho(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Pe(this.rootNode,[o2()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Pe(s,[BR(),u2(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),bu(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Pe(u,[T1(a+1+this.table.rowHeadersCount),Sh(-1),LQ(),...a>=0?[UQ()]:[BR()]]),r[n](l,u,n)}}}}let DA=!1;class mte extends bg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!DA&&e>1e3&&(DA=!0,yt(pt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&J(r,"rowHeader")}}function pte(t,e,n){return e=wte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wte(t){var e=vte(t,"string");return typeof e=="symbol"?e:String(e)}function vte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let NA=!1;class Cte extends bg{constructor(e){super("TR",e),pte(this,"orderView",void 0),this.orderView=new lB(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!NA&&e>1e3&&(NA=!0,yt(pt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Pe(this.rootNode,[o2()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Pe(o,[BR(),u2(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function kA(t,e,n){return e=yte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yte(t){var e=Ste(t,"string");return typeof e=="symbol"?e:String(e)}function Ste(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bte extends bg{constructor(){super("TD"),kA(this,"orderViews",new WeakMap),kA(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new uB(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<n;d++){c.render();const f=c.getCurrentNode(),m=this.table.renderedColumnToSource(d);if(He(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),bu(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,m,f),this.table.isAriaEnabled()){var o,s;Pe(f,[...f.hasAttribute("role")?[]:[NQ()],Sh(-1),T1(m+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function _n(t,e,n){return e=Rte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rte(t){var e=Ete(t,"string");return typeof e=="symbol"?e:String(e)}function Ete(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tte{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_n(this,"rootNode",void 0),_n(this,"rootDocument",void 0),_n(this,"rowHeaders",null),_n(this,"columnHeaders",null),_n(this,"colGroup",null),_n(this,"rows",null),_n(this,"cells",null),_n(this,"rowFilter",null),_n(this,"columnFilter",null),_n(this,"rowUtils",null),_n(this,"columnUtils",null),_n(this,"rowsToRender",0),_n(this,"columnsToRender",0),_n(this,"rowHeaderFunctions",[]),_n(this,"rowHeadersCount",0),_n(this,"columnHeaderFunctions",[]),_n(this,"columnHeadersCount",0),_n(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class _te{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Tte(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new fte,columnHeaders:new gte(n),colGroup:new mte(r),rows:new Cte(i),cells:new bte}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function qh(t,e,n){Mte(t,e),e.set(t,n)}function Mte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pm(t,e,n){return e=xte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xte(t){var e=Pte(t,"string");return typeof e=="symbol"?e:String(e)}function Pte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zn(t,e){var n=cB(t,e,"get");return Ote(t,n)}function Ote(t,e){return e.get?e.get.call(t):e.value}function Qh(t,e,n){var r=cB(t,e,"set");return Ate(t,r,n),n}function cB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ate(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var wm=new WeakMap,$u=new WeakMap,Zh=new WeakMap,vm=new WeakMap,pl=new WeakMap;class q1{static get DEFAULT_WIDTH(){return 50}constructor(e){let{totalColumns:n,stretchMode:r,stretchingColumnWidthFn:i,columnWidthFn:o}=e;pm(this,"stretchAllRatio",0),pm(this,"stretchLastWidth",0),pm(this,"stretchAllColumnsWidth",[]),qh(this,wm,{writable:!0,value:0}),pm(this,"needVerifyLastColumnWidth",!0),qh(this,$u,{writable:!0,value:()=>0}),qh(this,Zh,{writable:!0,value:s=>s}),qh(this,vm,{writable:!0,value:s=>s}),qh(this,pl,{writable:!0,value:()=>"none"}),Qh(this,$u,n),Qh(this,pl,r),Qh(this,Zh,i??zn(this,Zh)),Qh(this,vm,o??zn(this,vm))}refreshStretching(e){if(zn(this,pl).call(this)==="none")return;Qh(this,wm,e);let n=0;for(let i=0;i<zn(this,$u).call(this);i++){const o=this._getColumnWidth(i),s=zn(this,Zh).call(this,void 0,i);typeof s=="number"?e-=s:n+=o}const r=e-n;if(zn(this,pl).call(this)==="all"&&r>0)this.stretchAllRatio=e/n,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(zn(this,pl).call(this)==="last"&&e!==1/0){const i=this._getColumnWidth(zn(this,$u).call(this)-1),o=r+i;this.stretchLastWidth=o>=0?o:i}}getStretchedColumnWidth(e,n){let r=null;return zn(this,pl).call(this)==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):zn(this,pl).call(this)==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;if(!this.stretchAllColumnsWidth[e]){const i=Math.round(n*this.stretchAllRatio),o=zn(this,Zh).call(this,i,e);o===void 0?this.stretchAllColumnsWidth[e]=i:this.stretchAllColumnsWidth[e]=isNaN(o)?this._getColumnWidth(e):o}if(this.stretchAllColumnsWidth.length===zn(this,$u).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let i=0;i<this.stretchAllColumnsWidth.length;i++)r+=this.stretchAllColumnsWidth[i];r!==zn(this,wm)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=zn(this,wm)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===zn(this,$u).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=zn(this,vm).call(this,e);return isNaN(n)&&(n=q1.DEFAULT_WIDTH),n}}function Cm(t,e,n){return e=Ite(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ite(t){var e=Hte(t,"string");return typeof e=="symbol"?e:String(e)}function Hte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dte{constructor(e,n){Cm(this,"dataAccessObject",void 0),Cm(this,"wtSettings",void 0),Cm(this,"headerWidths",new Map),Cm(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=n,this.stretching=new q1({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(r,i)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",r,i),columnWidthFn:r=>this.dataAccessObject.wtTable.getColumnWidth(r)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let n=this.getWidth(e);const r=this.stretching.getStretchedColumnWidth(e,n);return r&&(n=r),n}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:n,cloneSource:r}=this.dataAccessObject,i=r?r.wtTable.holder:e.holder,o=i.offsetHeight<i.scrollHeight?Rn():0;this.stretching.refreshStretching(n.getViewportWidth()-o)}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function LA(t,e,n){return e=Nte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nte(t){var e=kte(t,"string");return typeof e=="symbol"?e:String(e)}function kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lte{constructor(e,n){LA(this,"dataAccessObject",void 0),LA(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function Co(t,e,n){return e=$te(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $te(t){var e=Fte(t,"string");return typeof e=="symbol"?e:String(e)}function Fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wte{constructor(e,n,r,i,o){Co(this,"wtSettings",null),Co(this,"domBindings",void 0),Co(this,"TBODY",null),Co(this,"THEAD",null),Co(this,"COLGROUP",null),Co(this,"hasTableHeight",!0),Co(this,"hasTableWidth",!0),Co(this,"isTableVisible",!1),Co(this,"tableOffset",0),Co(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,M1(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Lte(this.dataAccessObject,this.wtSettings),this.columnUtils=new Dte(this.dataAccessObject,this.wtSettings),this.tableRenderer=new _te({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!He(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Pe(r,[Vo()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!He(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Pe(r,[Vo()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!He(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Pe(r.parentNode,[Vo()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Pe(r,[Vo()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=!1,d=e;if(this.isMaster&&(this.holderOffset=yn(this.holder),d=i.createRenderCalculators(d),l&&!n.getSetting("fixedColumnsStart"))){const m=r.inlineStartOverlay.getScrollPosition(),C=this.correctHeaderWidth;this.correctHeaderWidth=m!==0,C!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(h=r.updateStateOfRendering()),d)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=yn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const m=o>0?this.getFirstRenderedRow():0,C=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new qee(m,o,c),this.columnFilter=new Gee(C,s,l);let b=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const p={};this.wtSettings.getSetting("beforeDraw",!0,p),b=p.skipRender!==!0}if(b){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Fo)||this.is(ja))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let p;if(this.isMaster&&(p=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Fo))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const w=vt(this.hider),y=vt(this.TABLE);w!==0&&y!==w&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),p!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Fo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let f=!1;return this.isMaster&&(f=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(f=r.bottomOverlay.resetFixedPosition()||f),f=r.inlineStartOverlay.resetFixedPosition()||f,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),f?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(d),h&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Ql(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Fo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=qa(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=f2(r),s=n.cellIndex;return da(gu,n,this.wtRootElement)||da(du,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):da(ja,n,this.wtRootElement)||da(Fo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),da(gu,n,this.wtRootElement)||da(fu,n,this.wtRootElement)||da(ja,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=Ql(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=Ql(l):o=Ql(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return vt(this.TABLE)}getHeight(){return Ut(this.TABLE)}getTotalWidth(){const e=vt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Ut(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Za(this.TABLE)}_modifyRowHeaderWidth(e){let n=Tt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Eh=Wte,Vte="stickyRowsBottom",hB={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Qo(hB,"MIXIN_NAME",Vte,{writable:!1,enumerable:!1});const dB=hB,Bte="stickyColumnsStart",fB={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Qo(fB,"MIXIN_NAME",Bte,{writable:!1,enumerable:!1});const Q1=fB;class Z1 extends Eh{constructor(e,n,r,i){super(e,n,r,i,ja)}}bt(Z1,dB);bt(Z1,Q1);const Ute=Z1,du="top",Fo="bottom",fu="inline_start",gu="top_inline_start_corner",ja="bottom_inline_start_corner",zte=[du,Fo,fu,gu,ja],jte=new Map([[du,`ht_clone_${du}`],[Fo,`ht_clone_${Fo}`],[fu,`ht_clone_${fu} ht_clone_left`],[gu,`ht_clone_${gu} ht_clone_top_left_corner`],[ja,`ht_clone_${ja} ht_clone_bottom_left_corner`]]);function _S(t,e,n){return e=Gte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gte(t){var e=Yte(t,"string");return typeof e=="symbol"?e:String(e)}function Yte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kte{constructor(e){_S(this,"dataAccessObject",void 0),_S(this,"lastScrolledColumnPos",-1),_S(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let h=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?h=c.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(h=c.scrollTo(e,l?e>a:n)),h&&(this.lastScrolledColumnPos=e),h}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:h}=this.dataAccessObject;if(l&&(e<c||e>o-u-1))return!1;let d=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?d=h.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(d=h.scrollTo(e,l?e>a:r)),d&&(this.lastScrolledRowPos=e),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){const a=yn(n.wtRootElement),l=wC(o,o);if(a.top>l){const u=Ql(o);let c=r.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(c+=e.sumCellSizes(h-1,h),a.top+c-l>=u){s=h-2;break}}}return s}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let u=null;if(l){const h=r.TABLE.getBoundingClientRect(),f=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(h.right-f)}else u=yn(r.wtRootElement).left;const c=Math.abs(P1(s,s));if(u>c){const h=O1(s);let d=i.getRowHeaderWidth();for(let f=1;f<=o;f++)if(d+=n.sumCellSizes(f-1,f),u+d-c>=h){a=f-2;break}}}return a}}const Xte=Kte;function $i(t,e,n){return e=qte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qte(t){var e=Qte(t,"string");return typeof e=="symbol"?e:String(e)}function Qte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J1{get eventManager(){return new Oi(this)}constructor(e,n){$i(this,"wtTable",void 0),$i(this,"wtScroll",void 0),$i(this,"wtViewport",void 0),$i(this,"wtOverlays",void 0),$i(this,"selectionManager",void 0),$i(this,"wtEvent",void 0),$i(this,"guid",`wt_${S1()}`),$i(this,"drawInterrupted",!1),$i(this,"drawn",!1),$i(this,"domBindings",void 0),$i(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new Xte(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Qa(r,e[n])}])}}createCellCoords(e,n){return new Zw(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new X1(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function $A(t,e,n){return e=Zte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zte(t){var e=Jte(t,"string");return typeof e=="symbol"?e:String(e)}function Jte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ene extends J1{constructor(e,n,r){super(e,n),$A(this,"cloneSource",void 0),$A(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new aB(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function tne(t,e,n){return e=nne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nne(t){var e=rne(t,"string");return typeof e=="symbol"?e:String(e)}function rne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rg{constructor(e,n,r,i,o){tne(this,"wtSettings",null),Qo(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=hu(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=hu(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Bf(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){yt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Rn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(zte.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${jte.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Pe(o,[Vo()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===du||u==="vertical"&&this.type===fu?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Bf(e.TABLE),new ene(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;M([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class ine extends Rg{constructor(e,n,r,i,o,s){super(e,n,ja,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Ute(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else wg(n),this.repositionOverlay();let r=Ut(this.clone.wtTable.TABLE);const i=vt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Rn(r)),i.style.bottom=`${o}px`}}const one="calculatedColumns",gB={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Qo(gB,"MIXIN_NAME",one,{writable:!1,enumerable:!1});const e_=gB;class t_ extends Eh{constructor(e,n,r,i){super(e,n,r,i,Fo)}}bt(t_,dB);bt(t_,e_);const sne=t_;function ane(t,e,n){return e=lne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lne(t){var e=une(t,"string");return typeof e=="symbol"?e:String(e)}function une(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cne extends Rg{constructor(e,n,r,i){super(e,n,Fo,r,i),ane(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new sne(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Rn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(pC(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=Rn(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Ut(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=Rn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return wC(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=He(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(J(s,"innerBorderBottom"),o=!a):(We(s,"innerBorderBottom"),o=a)}return o}}const hne="calculatedRows",mB={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Qo(mB,"MIXIN_NAME",hne,{writable:!1,enumerable:!1});const pB=mB;class n_ extends Eh{constructor(e,n,r,i){super(e,n,r,i,fu)}}bt(n_,pB);bt(n_,Q1);const dne=n_,fne="localHooks",wB={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Gw(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Qo(wB,"MIXIN_NAME",fne,{writable:!1,enumerable:!1});const zr=wB;let vB=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};bt(vB,zr);const gne=vB,CB="active-header",r_="header",i_="area",o_="focus",mne="fill",pne="row",wne="column",vne="custom-selection",s_=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var Cne=tB;Cne("flat");function yne(t,e){yB(t,e),e.add(t)}function FA(t,e,n){yB(t,e),e.set(t,n)}function yB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MS(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ln(t,e){var n=SB(t,e,"get");return Sne(t,n)}function Sne(t,e){return e.get?e.get.call(t):e.value}function WA(t,e,n){var r=SB(t,e,"set");return bne(t,r,n),n}function SB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function bne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Fi=new WeakMap,Pr=new WeakMap,ym=new WeakSet;class Rne{constructor(){yne(this,ym),FA(this,Fi,{writable:!0,value:void 0}),FA(this,Pr,{writable:!0,value:void 0})}setActiveOverlay(e){return WA(this,Pr,e),this}setActiveSelection(e){return WA(this,Fi,e),this}scan(){const e=ln(this,Fi).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=ln(this,Fi).getCorners(),{wtTable:s}=ln(this,Pr),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let m=s.getColumnHeader(h,f);const C=ln(this,Pr).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:ln(this,Fi).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});C!==null&&(C!==h&&(m=s.getColumnHeader(C,f)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=ln(this,Fi).getCorners(),{wtTable:s}=ln(this,Pr),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let m=s.getRowHeader(h,f);const C=ln(this,Pr).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:ln(this,Fi).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});C!==null&&(C!==h&&(m=s.getRowHeader(C,f)),e(m))}u+=1}}}scanCellsRange(e){const[n,r,i,o]=ln(this,Fi).getCorners(),{wtTable:s}=ln(this,Pr);MS(this,ym,xS).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const u=s.getCell(ln(this,Pr).createCellCoords(a,l)),c=ln(this,Pr).getSetting("onAfterDrawSelection",a,l,ln(this,Fi).settings.layerLevel);typeof c=="string"&&J(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=ln(this,Fi).getCorners(),{wtTable:i}=ln(this,Pr);MS(this,ym,xS).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(ln(this,Pr).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=ln(this,Fi).getCorners(),{wtTable:i}=ln(this,Pr);MS(this,ym,xS).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(ln(this,Pr).createCellCoords(o,s));e(a)}})}}function xS(t){const{wtTable:e}=ln(this,Pr),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class Ene{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=s_,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Di(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),_s()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Ke(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Ke(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),C=parseInt(c.width,10),b=this.wot.wtTable.getWidth(),p=this.wot.wtTable.getHeight();u.top=`${parseInt(r-m-1,10)}px`,u[l]=`${parseInt(i-m-1,10)}px`,c.top=`${parseInt(r-C/4*3,10)}px`,c[l]=`${parseInt(i-C/4*3,10)}px`;const w=Math.min(parseInt(i+o,10),b-m-f*2),y=Math.min(parseInt(i+o-C/4,10),b-C-f*2);h[l]=`${w}px`,d[l]=`${y}px`;const E=Math.min(parseInt(r+s,10),p-m-f*2),T=Math.min(parseInt(r+s-C/4,10),p-C-f*2);h.top=`${E}px`,d.top=`${T}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,u,c;const h=n.getRenderedRowsCount();for(let Y=0;Y<h;Y+=1){const g=n.rowFilter.renderedToSource(Y);if(g>=e[0]&&g<=e[2]){o=g,u=e[0];break}}for(let Y=h-1;Y>=0;Y-=1){const g=n.rowFilter.renderedToSource(Y);if(g>=e[0]&&g<=e[2]){s=g;break}}const d=n.getRenderedColumnsCount();for(let Y=0;Y<d;Y+=1){const g=n.columnFilter.renderedToSource(Y);if(g>=e[1]&&g<=e[3]){a=g,c=e[1];break}}for(let Y=d-1;Y>=0;Y-=1){const g=n.columnFilter.renderedToSource(Y);if(g>=e[1]&&g<=e[3]){l=g;break}}if(o===void 0||a===void 0){this.disappear();return}let f=n.getCell(this.wot.createCellCoords(o,a));const m=o!==s||a!==l,C=m?n.getCell(this.wot.createCellCoords(s,l)):f,b=yn(f),p=m?yn(C):b,w=yn(n.TABLE),y=vt(n.TABLE),E=b.top,T=b.left,x=this.wot.wtSettings.getSetting("rtlMode");let A=0,W=0;if(x){const Y=vt(f),g=i.innerWidth-w.left-y;W=T+Y-p.left,A=i.innerWidth-T-Y-g-1}else W=p.left+vt(C)-T,A=T-w.left-1;if(this.isEntireColumnSelected(o,s)){const Y=this.getDimensionsFromHeader("columns",a,l,u,w);let g=null;Y&&([g,A,W]=Y),g&&(f=g)}let B=E-w.top-1,U=p.top+Ut(C)-E;if(this.isEntireRowSelected(a,l)){const Y=this.getDimensionsFromHeader("rows",o,s,c,w);let g=null;Y&&([g,B,U]=Y),g&&(f=g)}const Q=Fs(f,i);parseInt(Q.borderTopWidth,10)>0&&(B+=1,U=U>0?U-1:0),parseInt(Q[x?"borderRightWidth":"borderLeftWidth"],10)>0&&(A+=1,W=W>0?W-1:0);const te=x?"right":"left";this.topStyle.top=`${B}px`,this.topStyle[te]=`${A}px`,this.topStyle.width=`${W}px`,this.topStyle.display="block",this.startStyle.top=`${B}px`,this.startStyle[te]=`${A}px`,this.startStyle.height=`${U}px`,this.startStyle.display="block";const ee=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${B+U-ee}px`,this.bottomStyle[te]=`${A}px`,this.bottomStyle.width=`${W}px`,this.bottomStyle.display="block",this.endStyle.top=`${B}px`,this.endStyle[te]=`${A+W-ee}px`,this.endStyle.height=`${U+1}px`,this.endStyle.display="block";let he=this.settings.border.cornerVisible;he=typeof he=="function"?he(this.settings.layerLevel):he;const _e=this.wot.getSetting("onModifyGetCellCoords",s,l);let[Ue,ke]=[s,l];if(_e&&Array.isArray(_e)&&([,,Ue,ke]=_e),_s()||!he||this.isPartRange(Ue,ke))this.cornerStyle.display="none";else{this.cornerStyle.top=`${B+U+this.cornerCenterPointOffset-1}px`,this.cornerStyle[te]=`${A+W+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Y=hu(n.TABLE);const g=Y===i;g&&(Y=r.documentElement);const v=parseInt(this.cornerDefaultStyle.width,10)/2,S=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const O=g?C.getBoundingClientRect().left:C.offsetLeft;let H=!1,D=0;x?(D=O-parseInt(this.cornerDefaultStyle.width,10)/2,H=D<0):(D=O+vt(C)+parseInt(this.cornerDefaultStyle.width,10)/2,H=D>=O1(Y)),H&&(this.cornerStyle[te]=`${Math.floor(A+W+this.cornerCenterPointOffset-v)}px`,this.cornerStyle[x?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(g?C.getBoundingClientRect().top:C.offsetTop)+Ut(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=Ql(Y)&&(this.cornerStyle.top=`${Math.floor(B+U+this.cornerCenterPointOffset-S)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}_s()&&this.updateMultipleSelectionHandlesPosition(s,l,B,A,W,U)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,m=null,C=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Ut(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return vt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const b=this.wot.getSetting("columnHeaders").length;if(m=l(n,b-i),C=l(r,b-i),!m||!C)return!1;const p=yn(m),w=yn(C);return m&&C&&(h=p[f]-o[f]-1,d=w[f]+u(C)-p[f]),[m,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?J(this[e],"hidden"):(He(this[e],"hidden")&&We(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?J(this[e],"hidden"):We(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",_s()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const VA=Ene;function Tne(t,e){bB(t,e),e.add(t)}function Fu(t,e,n){bB(t,e),e.set(t,n)}function bB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _ne(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Je(t,e){var n=RB(t,e,"get");return Mne(t,n)}function Mne(t,e){return e.get?e.get.call(t):e.value}function BA(t,e,n){var r=RB(t,e,"set");return xne(t,r,n),n}function RB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function xne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Kn=new WeakMap,Dr=new WeakMap,PS=new WeakMap,Ld=new WeakMap,OS=new WeakMap,wl=new WeakMap,UA=new WeakSet;class Pne{constructor(e){Tne(this,UA),Fu(this,Kn,{writable:!0,value:void 0}),Fu(this,Dr,{writable:!0,value:void 0}),Fu(this,PS,{writable:!0,value:new Rne}),Fu(this,Ld,{writable:!0,value:new WeakMap}),Fu(this,OS,{writable:!0,value:new WeakSet}),Fu(this,wl,{writable:!0,value:new Map}),BA(this,Dr,e)}setActiveOverlay(e){return BA(this,Kn,e),Je(this,PS).setActiveOverlay(Je(this,Kn)),Je(this,Ld).has(Je(this,Kn))||Je(this,Ld).set(Je(this,Kn),new Set),this}getFocusSelection(){return Je(this,Dr)!==null?Je(this,Dr).getFocus():null}getAreaSelection(){return Je(this,Dr)!==null?Je(this,Dr).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Je(this,wl).has(e)){const r=Je(this,wl).get(e);if(r.has(Je(this,Kn)))return r.get(Je(this,Kn));const i=new VA(Je(this,Kn),e.settings);return r.set(Je(this,Kn),i),i}const n=new VA(Je(this,Kn),e.settings);return Je(this,wl).set(e,new Map([[Je(this,Kn),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Je(this,wl).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Je(this,wl).get(e).forEach(n=>n.destroy()),Je(this,wl).delete(e)}render(e){if(Je(this,Dr)===null)return;e&&_ne(this,UA,One).call(this);const n=Array.from(Je(this,Dr)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Je(this,OS).has(s)||(Je(this,OS).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&Je(this,PS).setActiveSelection(s).scan().forEach(m=>{if(r.has(m)){const C=r.get(m);C.has(a)&&u===!0?C.set(a,C.get(a)+1):C.set(a,1)}else r.set(m,new Map([[a,1]]));l&&(i.has(m)||i.set(m,[]),m.nodeName==="TH"&&i.get(m).push(...l))});const d=s.getCorners();Je(this,Kn).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>Je(this,Ld).get(Je(this,Kn)).add(u)),J(s,l),s.nodeName==="TD"&&Array.isArray((a=Je(this,Dr).options)===null||a===void 0?void 0:a.cellAttributes)&&Pe(s,Je(this,Dr).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Pe(o,[...i.get(o)])})}}function One(){const t=Je(this,Ld).get(Je(this,Kn)),e=Je(this,Kn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=Je(this,Kn).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=Je(this,Dr).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=Je(this,Dr).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Je(this,Dr).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...Je(this,Dr).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)We(o[a],n),bu(o[a],s)}),t.clear()}class Ane extends Rg{constructor(e,n,r,i){super(e,n,fu,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new dne(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),vC(r,`${o}px`,"0px")):(o=this.getScrollPosition(),wg(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,x1(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=Rn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=vt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(s_.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=Rn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(P1(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?We(n,"emptyRows"):J(n,"emptyRows");let s=!1;if(i&&!r.length)J(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=He(n,"innerBorderInlineStart");e?(J(n,"innerBorderLeft innerBorderInlineStart"),s=!a):(We(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const Ine="stickyRowsTop",EB={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Qo(EB,"MIXIN_NAME",Ine,{writable:!1,enumerable:!1});const TB=EB;class a_ extends Eh{constructor(e,n,r,i){super(e,n,r,i,gu)}}bt(a_,TB);bt(a_,Q1);const Hne=a_;function zA(t,e,n){return e=Dne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dne(t){var e=Nne(t,"string");return typeof e=="symbol"?e:String(e)}function Nne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kne extends Rg{constructor(e,n,r,i,o,s){super(e,n,gu,r,i),zA(this,"topOverlay",void 0),zA(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Hne(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();vC(e,`${i}px`,`${o}px`)}else wg(e);let n=Ut(this.clone.wtTable.TABLE);const r=vt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class l_ extends Eh{constructor(e,n,r,i){super(e,n,r,i,du)}}bt(l_,TB);bt(l_,e_);const Lne=l_;function $ne(t,e,n){return e=Fne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fne(t){var e=Wne(t,"string");return typeof e=="symbol"?e:String(e)}function Wne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vne extends Rg{constructor(e,n,r,i){super(e,n,du,r,i),$ne(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Lne(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),vC(e,"0px",`${i}px`)}else i=this.getScrollPosition(),wg(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(pC(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=Rn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Ut(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(s_.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=Rn(this.domBindings.rootDocument)),n){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return wC(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?We(r,"emptyColumns"):J(r,"emptyColumns");let o=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){const u=He(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(J(r,"innerBorderTop"),o=!u):(We(r,"innerBorderTop"),o=u)}}return o}}function ns(t,e,n){return e=Bne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bne(t){var e=Une(t,"string");return typeof e=="symbol"?e:String(e)}function Une(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zne{constructor(e,n,r,i,o,s){ns(this,"wot",null),ns(this,"topOverlay",null),ns(this,"bottomOverlay",null),ns(this,"inlineStartOverlay",null),ns(this,"topInlineStartCornerOverlay",null),ns(this,"bottomInlineStartCornerOverlay",null),ns(this,"browserLineHeight",void 0),ns(this,"wtSettings",null),ns(this,"resizeObserver",new ResizeObserver(c=>{RC(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Rn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Bf(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Vne(...e),this.bottomOverlay=new cne(...e),this.inlineStartOverlay=new Ane(...e),this.topInlineStartCornerOverlay=new kne(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new ine(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!L1())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:d}=h.clone.wtTable;this.eventManager.addEventListener(d,"wheel",f=>this.onCloneWheel(f,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Rh(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Bf(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:h,scrollWidth:d}=r.holder;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<d,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return M(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];M(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const jne=zne;function jA(t,e,n){return e=Gne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gne(t){var e=Yne(t,"string");return typeof e=="symbol"?e:String(e)}function Yne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kne{constructor(e){jA(this,"settings",{}),jA(this,"defaults",Object.freeze(this.getDefaults())),Ke(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Qa(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ke(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class u_ extends Eh{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=hu(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=ah(e,"height",n),o=ah(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(Fs(d,n).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Za(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}bt(u_,pB);bt(u_,e_);const Xne=u_;class qne{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Ut(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,h=o-c;let d,f;if(a)return vt(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(h,o):d=Math.min(this.getContainerFillWidth(),h,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>d)return n.documentElement.clientWidth;if(i!==r&&(f=ah(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),f==="scroll"||f==="hidden"||f==="auto"))return Math.max(d,i.clientWidth);const m=e.getSetting("stretchH");return m==="none"||!m?Math.max(d,vt(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return yn(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Ut(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=vt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wa;const{wtSettings:n,wtTable:r}=this;if(n.getSetting("renderAllRows")&&e===wa)return new WJ({totalRows:n.getSetting("totalRows")});let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=Rn(this.domBindings.rootDocument),new MC({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wa;const{wtSettings:n,wtTable:r}=this;if(n.getSetting("renderAllColumns")&&e===wa)return new LJ({totalColumns:n.getSetting("totalColumns")});let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Rn(this.domBindings.rootDocument)),new Sg({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this;if(e&&!n.getSetting("renderAllRows")){const r=this.createRowsCalculator(qn);e=this.areAllProposedVisibleRowsAlreadyRendered(r)}if(e&&!n.getSetting("renderAllColumns")){const r=this.createColumnsCalculator(qn);e=this.areAllProposedVisibleColumnsAlreadyRendered(r)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(wa),this.columnsRenderCalculator=this.createColumnsCalculator(wa)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(qn),this.columnsVisibleCalculator=this.createColumnsCalculator(qn)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Ke(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const Qne=qne;class Zne extends J1{constructor(e,n){super(e,new Kne(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new Xne(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new Qne(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Pne(this.wtSettings.getSetting("selections")),this.wtEvent=new aB(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new jne(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ke(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),We(this.wtTable.wtRootElement.parentNode,n),J(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class c_{constructor(e){e instanceof J1?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new c_(n);return()=>r},this._wot=new Zne(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function GA(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function Jne(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}const ere=new Map([["mousedown",GA],["mouseover",Jne],["touchstart",GA]]);function YA(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;ere.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:EC(t)||t.type==="touchstart",isRightClick:Ja(t)})}const _B=new WeakMap,h_=Symbol("rootInstance");function tre(t){_B.set(t,!0)}function nre(t){return t===h_}function Yp(t){return _B.has(t)}function KA(t,e){MB(t,e),e.add(t)}function vl(t,e,n){MB(t,e),e.set(t,n)}function MB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ta(t,e,n){return e=rre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rre(t){var e=ire(t,"string");return typeof e=="symbol"?e:String(e)}function ire(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tE(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Mn(t,e){var n=xB(t,e,"get");return ore(t,n)}function ore(t,e){return e.get?e.get.call(t):e.value}function di(t,e,n){var r=xB(t,e,"set");return sre(t,r,n),n}function xB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function sre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var AS=new WeakMap,Sm=new WeakMap,bm=new WeakMap,rs=new WeakMap,Wi=new WeakMap,IS=new WeakMap,HS=new WeakMap,nE=new WeakSet,XA=new WeakSet;class are{constructor(e){KA(this,XA),KA(this,nE),ta(this,"hot",void 0),ta(this,"eventManager",void 0),ta(this,"settings",void 0),ta(this,"THEAD",void 0),ta(this,"TBODY",void 0),ta(this,"_wt",void 0),ta(this,"activeWt",void 0),vl(this,AS,{writable:!0,value:0}),vl(this,Sm,{writable:!0,value:0}),ta(this,"postponedAdjustElementsSize",!1),vl(this,bm,{writable:!0,value:!1}),vl(this,rs,{writable:!0,value:void 0}),vl(this,Wi,{writable:!0,value:void 0}),vl(this,IS,{writable:!0,value:0}),vl(this,HS,{writable:!0,value:0}),this.hot=e,this.eventManager=new Oi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),J(e,"handsontable"),di(this,Wi,n.createElement("TABLE")),J(Mn(this,Wi),"htCore"),this.hot.getSettings().tableClassName&&J(Mn(this,Wi),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Pe(Mn(this,Wi),[Vo()]),Pe(e,[DQ(),l2(-1),mC(this.hot.countCols()),YQ()])),this.THEAD=n.createElement("THEAD"),Mn(this,Wi).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),Mn(this,Wi).appendChild(this.TBODY),this.hot.table=Mn(this,Wi),this.hot.container.insertBefore(Mn(this,Wi),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(di(this,bm,!0),!this.isTextSelectionAllowed(o.target)){const{rootWindow:s}=this.hot;UR(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{di(this,bm,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{Mn(this,bm)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&UR(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&EC(o)&&r.finish(),di(this,rs,!1);const s=CC(n.activeElement);nf(n.activeElement)&&!s||(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!Ja(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&Ja(o)&&(r.finish(),di(this,rs,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),di(this,rs,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{const s=o.target,a=o.x||o.clientX,l=o.y||o.clientY;let u=o.target;if(Mn(this,rs)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const d=Rn(n);if(n.elementFromPoint(a+d,l)!==c||n.elementFromPoint(a,l+d)!==c)return}else for(;u!==i;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(Mn(this,Wi),"selectstart",o=>{this.settings.fragmentSelection||nf(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Mn(this,Wi),isDataViewInstance:()=>Yp(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),di(this,Sm,o.length),this.hot.getSettings().ariaTags&&tE(this,nE,PB).call(this)===this.hot.countCols()&&tE(this,XA,lre).call(this,Mn(this,Sm)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),di(this,AS,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),m=this.hot.colToProp(d);let C=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(C=this.hot.runHooks("beforeValueRender",C,f)),this.hot.runHooks("beforeRenderer",a,l,u,m,C,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,m,C,f),this.hot.runHooks("afterRenderer",a,l,u,m,C,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Za(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,di(this,rs,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!ba(o)&&(YA(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,di(this,rs,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!ba(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!ba(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!ba(o)&&(Mn(this,rs)&&YA(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(ba(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,h=o>=0?l.getVisualFromRenderableIndex(o):o,d=this.hot.runHooks("modifyGetCellCoords",h,c,a);if(Array.isArray(d)){const[f,m,C,b]=d;return[f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f,m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,C>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(C,-1)):C,b>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(b,-1)):b]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new c_(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(nf(e))return!0;const n=Ua(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Mn(this,rs)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!He(r,"relative")){ho(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const o=n.firstChild;He(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(ho(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.settings.ariaTags&&(Pe(s,...Vo()),Pe(a,...Vo())),this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(He(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):He(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Ru(e,r(n,i)):(Qa(e,String.fromCharCode(160)),J(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){di(this,IS,e),di(this,HS,n)}getLastSize(){return{width:Mn(this,IS),height:Mn(this,HS)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return Mn(this,AS)}getRowHeadersCount(){return Mn(this,Sm)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function PB(){return parseInt(this.hot.rootElement.getAttribute(mC()[0]),10)}function lre(t){const e=tE(this,nE,PB).call(this)+t;Pe(this.hot.rootElement,...mC(e))}const ure=are,OB="ABCDEFGHIJKLMNOPQRSTUVWXYZ",rE=OB.length;function xC(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%rE,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/rE,10);return n}function cre(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=rE**r*(OB.indexOf(t[n])+1);return e-=1,e}function hre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(xC(i)+(r+1));n.push(o)}return n}function dre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=xC(i)+(r+1);n.push(o)}return n}function fre(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function d_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function f_(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&je(t[0])&&(e=bC(t[0]))),e}function AB(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function IB(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const gre=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:f_,createEmptySpreadsheetData:fre,createSpreadsheetData:hre,createSpreadsheetObjectData:dre,dataRowToChangesArray:d_,isArrayOfArrays:AB,isArrayOfObjects:IB,spreadsheetColumnIndex:cre,spreadsheetColumnLabel:xC},Symbol.toStringTag,{value:"Module"}));function Jh(t,e,n){return e=mre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mre(t){var e=pre(t,"string");return typeof e=="symbol"?e:String(e)}function pre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wre{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Jh(this,"hot",void 0),Jh(this,"data",void 0),Jh(this,"dataType","array"),Jh(this,"colToProp",()=>{}),Jh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return M(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):Se(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if(je(s)||Tt(s))if(i?a=[]:a={},!o||i){const u=this.countFirstRowKeys()-1;Se(0,u,c=>{const h=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(h)){const d=this.getAtPhysicalCell(e,h,s);i?a.push(d):Up(a,h,d)}})}else Ke(s,(l,u)=>{Up(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=ro(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:Up(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=x2(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){const o=ro(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return Se(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return f_(this.data)}destroy(){this.data=null,this.hot=null}}const vre=wre;function qA(t,e,n){return e=Cre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cre(t){var e=yre(t,"string");return typeof e=="symbol"?e:String(e)}function yre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;qA(this,"indexedValues",[]),qA(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Tt(this.initValueOrFn)?Se(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):Se(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}bt(Eu,zr);function g_(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>Tt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function m_(t,e){return oi(t,(n,r)=>e.includes(r)===!1)}class cl extends Eu{insert(e,n){this.indexedValues=g_(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=m_(this.indexedValues,e),super.remove(e)}}class PC extends cl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return an(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function p_(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function jf(t,e){return oi(t,n=>e.includes(n)===!1)}function w_(t,e){return Ye(t,n=>n-e.filter(r=>r<n).length)}function v_(t,e){const n=e[0],r=e.length;return Ye(t,i=>i>=n?i+r:i)}function Sre(t,e,n){return e=bre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bre(t){var e=Rre(t,"string");return typeof e=="symbol"?e:String(e)}function Rre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OC extends Eu{constructor(){super(...arguments),Sre(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=jf(this.orderOfIndexes,[e]),Tt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=g_(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=v_(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=m_(this.indexedValues,e),this.orderOfIndexes=jf(this.orderOfIndexes,e),this.orderOfIndexes=w_(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Eg extends cl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return an(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const QA=new Map([["indexesSequence",{getListWithInsertedItems:p_,getListWithRemovedItems:jf}],["physicallyIndexed",{getListWithInsertedItems:g_,getListWithRemovedItems:m_}]]),HB=t=>{if(QA.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return QA.get(t)};class DB extends Eu{constructor(){super(e=>e)}insert(e,n){const r=v_(this.indexedValues,n);this.indexedValues=p_(r,e,n),super.insert(e,n)}remove(e){const n=jf(this.indexedValues,e);this.indexedValues=w_(n,e),super.remove(e)}}const ZA=new Map([["hiding",PC],["index",Eu],["linkedPhysicalIndexToValue",OC],["physicalIndexToValue",cl],["trimming",Eg]]);function Ere(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!ZA.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(ZA.get(t))(e)}function Tre(t,e,n){return e=_re(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _re(t){var e=Mre(t,"string");return typeof e=="symbol"?e:String(e)}function Mre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let iE=0;class C_{constructor(){Tre(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),iE+=1)}unregister(e){const n=this.collection.get(e);fe(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),iE-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return _t(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}bt(C_,zr);function xre(){return iE}function DS(t,e,n){return e=Pre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pre(t){var e=Ore(t,"string");return typeof e=="symbol"?e:String(e)}function Ore(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JA extends C_{constructor(e,n){super(),DS(this,"mergedValuesCache",[]),DS(this,"aggregationFunction",void 0),DS(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ye(this.get(),o=>o.getValues()),r=[],i=fe(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ye(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return fe(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Are(t,e,n){Ire(t,e),e.set(t,n)}function Ire(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hre(t,e,n){var r=NB(t,e,"set");return Dre(t,r,n),n}function Dre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Nre(t,e){var n=NB(t,e,"get");return kre(t,n)}function NB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function kre(t,e){return e.get?e.get.call(t):e.value}var NS=new WeakMap;class kB{constructor(){Are(this,NS,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(Nre(this,NS)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Hre(this,NS,e)}}bt(kB,zr);function eI(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function ed(t,e,n){Lre(t,e),e.set(t,n)}function Lre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fi(t,e){var n=LB(t,e,"get");return $re(t,n)}function $re(t,e){return e.get?e.get.call(t):e.value}function Rm(t,e,n){var r=LB(t,e,"set");return Fre(t,r,n),n}function LB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Fre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Em=new WeakMap,td=new WeakMap,Tm=new WeakMap,_m=new WeakMap,Mm=new WeakMap;class Wre{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ed(this,Em,{writable:!0,value:new Set}),ed(this,td,{writable:!0,value:[]}),ed(this,Tm,{writable:!0,value:[]}),ed(this,_m,{writable:!0,value:!1}),ed(this,Mm,{writable:!0,value:!1}),Rm(this,Mm,e??!1)}createObserver(){const e=new kB;return fi(this,Em).add(e),e.addLocalHook("unsubscribe",()=>{fi(this,Em).delete(e)}),e._writeInitialChanges(eI(fi(this,td),fi(this,Tm))),e}emit(e){let n=fi(this,Tm);(!fi(this,_m)||fi(this,td).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(fi(this,Mm)):Rm(this,td,new Array(e.length).fill(fi(this,Mm))),fi(this,_m)||(Rm(this,_m,!0),n=fi(this,td)));const r=eI(n,e);fi(this,Em).forEach(i=>i._write(r)),Rm(this,Tm,e)}}function lr(t,e,n){return e=Vre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vre(t){var e=Bre(t,"string");return typeof e=="symbol"?e:String(e)}function Bre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oE{constructor(){lr(this,"indexesSequence",new DB),lr(this,"trimmingMapsCollection",new JA(e=>e.some(n=>n===!0),!1)),lr(this,"hidingMapsCollection",new JA(e=>e.some(n=>n===!0),!1)),lr(this,"variousMapsCollection",new C_),lr(this,"hidingChangesObservable",new Wre({initialIndexValue:!1})),lr(this,"notTrimmedIndexesCache",[]),lr(this,"notHiddenIndexesCache",[]),lr(this,"isBatched",!1),lr(this,"indexesSequenceChanged",!1),lr(this,"indexesChangeSource",void 0),lr(this,"trimmedIndexesChanged",!1),lr(this,"hiddenIndexesChanged",!1),lr(this,"renderablePhysicalIndexesCache",[]),lr(this,"fromPhysicalToVisualIndexesCache",new Map),lr(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,Ere(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Eg?this.trimmingMapsCollection.register(e,n):n instanceof PC?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return fe(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return fe(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return fe(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return fe(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ye(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=jf(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(p_(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=fe(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ye(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}bt(oE,zr);function Ure(t,e){return Ke(e,(n,r)=>{_t(t[r])&&(t[r]=n)}),t}function $B(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function FB(t){fe(t)&&B1(pt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function zre(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:jre,getValues:Gre}=go("phraseFormatters");function Yre(t,e){jre(t,e)}function Kre(){return Gre()}Yre("pluralize",zre);const WB="ContextMenu:items",Be=WB,y_=`${Be}.noItems`,S_=`${Be}.insertRowAbove`,b_=`${Be}.insertRowBelow`,R_=`${Be}.insertColumnOnTheLeft`,E_=`${Be}.insertColumnOnTheRight`,T_=`${Be}.removeRow`,__=`${Be}.removeColumn`,M_=`${Be}.undo`,x_=`${Be}.redo`,P_=`${Be}.readOnly`,O_=`${Be}.clearColumn`,A_=`${Be}.copy`,I_=`${Be}.copyWithHeaders`,H_=`${Be}.copyWithGroupHeaders`,D_=`${Be}.copyHeadersOnly`,N_=`${Be}.cut`,k_=`${Be}.freezeColumn`,L_=`${Be}.unfreezeColumn`,$_=`${Be}.mergeCells`,F_=`${Be}.unmergeCells`,W_=`${Be}.addComment`,V_=`${Be}.editComment`,B_=`${Be}.removeComment`,U_=`${Be}.readOnlyComment`,z_=`${Be}.align`,j_=`${Be}.align.left`,G_=`${Be}.align.center`,Y_=`${Be}.align.right`,K_=`${Be}.align.justify`,X_=`${Be}.align.top`,q_=`${Be}.align.middle`,Q_=`${Be}.align.bottom`,Z_=`${Be}.borders`,J_=`${Be}.borders.top`,eM=`${Be}.borders.right`,tM=`${Be}.borders.bottom`,nM=`${Be}.borders.left`,rM=`${Be}.borders.remove`,iM=`${Be}.nestedHeaders.insertChildRow`,oM=`${Be}.nestedHeaders.detachFromParent`,sM=`${Be}.hideColumn`,aM=`${Be}.showColumn`,lM=`${Be}.hideRow`,uM=`${Be}.showRow`,Er="Filters:",tn=`${Er}conditions`,AC=`${tn}.none`,cM=`${tn}.isEmpty`,hM=`${tn}.isNotEmpty`,dM=`${tn}.isEqualTo`,fM=`${tn}.isNotEqualTo`,gM=`${tn}.beginsWith`,mM=`${tn}.endsWith`,pM=`${tn}.contains`,wM=`${tn}.doesNotContain`,Xre=`${tn}.byValue`,vM=`${tn}.greaterThan`,CM=`${tn}.greaterThanOrEqualTo`,yM=`${tn}.lessThan`,SM=`${tn}.lessThanOrEqualTo`,bM=`${tn}.isBetween`,RM=`${tn}.isNotBetween`,EM=`${tn}.after`,TM=`${tn}.before`,_M=`${tn}.today`,MM=`${tn}.tomorrow`,xM=`${tn}.yesterday`,PM=`${Er}labels.filterByCondition`,OM=`${Er}labels.filterByValue`,AM=`${Er}labels.conjunction`,IC=`${Er}labels.disjunction`,tv=`${Er}values.blankCells`,IM=`${Er}buttons.selectAll`,HM=`${Er}buttons.clear`,DM=`${Er}buttons.ok`,NM=`${Er}buttons.cancel`,kM=`${Er}buttons.placeholder.search`,LM=`${Er}buttons.placeholder.value`,$M=`${Er}buttons.placeholder.secondValue`,FM="CheckboxRenderer:",WM=`${FM}checked`,VM=`${FM}unchecked`,qre=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:WM,CHECKBOX_RENDERER_NAMESPACE:FM,CHECKBOX_UNCHECKED:VM,CONTEXTMENU_ITEMS_ADD_COMMENT:W_,CONTEXTMENU_ITEMS_ALIGNMENT:z_,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Q_,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:G_,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:K_,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:j_,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:q_,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:Y_,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:X_,CONTEXTMENU_ITEMS_BORDERS:Z_,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:tM,CONTEXTMENU_ITEMS_BORDERS_LEFT:nM,CONTEXTMENU_ITEMS_BORDERS_RIGHT:eM,CONTEXTMENU_ITEMS_BORDERS_TOP:J_,CONTEXTMENU_ITEMS_CLEAR_COLUMN:O_,CONTEXTMENU_ITEMS_COPY:A_,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:D_,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:H_,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:I_,CONTEXTMENU_ITEMS_CUT:N_,CONTEXTMENU_ITEMS_EDIT_COMMENT:V_,CONTEXTMENU_ITEMS_FREEZE_COLUMN:k_,CONTEXTMENU_ITEMS_HIDE_COLUMN:sM,CONTEXTMENU_ITEMS_HIDE_ROW:lM,CONTEXTMENU_ITEMS_INSERT_LEFT:R_,CONTEXTMENU_ITEMS_INSERT_RIGHT:E_,CONTEXTMENU_ITEMS_MERGE_CELLS:$_,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:oM,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:iM,CONTEXTMENU_ITEMS_NO_ITEMS:y_,CONTEXTMENU_ITEMS_READ_ONLY:P_,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:U_,CONTEXTMENU_ITEMS_REDO:x_,CONTEXTMENU_ITEMS_REMOVE_BORDERS:rM,CONTEXTMENU_ITEMS_REMOVE_COLUMN:__,CONTEXTMENU_ITEMS_REMOVE_COMMENT:B_,CONTEXTMENU_ITEMS_REMOVE_ROW:T_,CONTEXTMENU_ITEMS_ROW_ABOVE:S_,CONTEXTMENU_ITEMS_ROW_BELOW:b_,CONTEXTMENU_ITEMS_SHOW_COLUMN:aM,CONTEXTMENU_ITEMS_SHOW_ROW:uM,CONTEXTMENU_ITEMS_UNDO:M_,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:L_,CONTEXTMENU_ITEMS_UNMERGE_CELLS:F_,CONTEXT_MENU_ITEMS_NAMESPACE:WB,FILTERS_BUTTONS_CANCEL:NM,FILTERS_BUTTONS_CLEAR:HM,FILTERS_BUTTONS_OK:DM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:kM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:$M,FILTERS_BUTTONS_PLACEHOLDER_VALUE:LM,FILTERS_BUTTONS_SELECT_ALL:IM,FILTERS_CONDITIONS_AFTER:EM,FILTERS_CONDITIONS_BEFORE:TM,FILTERS_CONDITIONS_BEGINS_WITH:gM,FILTERS_CONDITIONS_BETWEEN:bM,FILTERS_CONDITIONS_BY_VALUE:Xre,FILTERS_CONDITIONS_CONTAINS:pM,FILTERS_CONDITIONS_EMPTY:cM,FILTERS_CONDITIONS_ENDS_WITH:mM,FILTERS_CONDITIONS_EQUAL:dM,FILTERS_CONDITIONS_GREATER_THAN:vM,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:CM,FILTERS_CONDITIONS_LESS_THAN:yM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:SM,FILTERS_CONDITIONS_NAMESPACE:tn,FILTERS_CONDITIONS_NONE:AC,FILTERS_CONDITIONS_NOT_BETWEEN:RM,FILTERS_CONDITIONS_NOT_CONTAIN:wM,FILTERS_CONDITIONS_NOT_EMPTY:hM,FILTERS_CONDITIONS_NOT_EQUAL:fM,FILTERS_CONDITIONS_TODAY:_M,FILTERS_CONDITIONS_TOMORROW:MM,FILTERS_CONDITIONS_YESTERDAY:xM,FILTERS_DIVS_FILTER_BY_CONDITION:PM,FILTERS_DIVS_FILTER_BY_VALUE:OM,FILTERS_LABELS_CONJUNCTION:AM,FILTERS_LABELS_DISJUNCTION:IC,FILTERS_NAMESPACE:Er,FILTERS_VALUES_BLANK_CELLS:tv},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const Qre={languageCode:"en-US",[y_]:"No available options",[S_]:"Insert row above",[b_]:"Insert row below",[R_]:"Insert column left",[E_]:"Insert column right",[T_]:["Remove row","Remove rows"],[__]:["Remove column","Remove columns"],[M_]:"Undo",[x_]:"Redo",[P_]:"Read only",[O_]:"Clear column",[z_]:"Alignment",[j_]:"Left",[G_]:"Center",[Y_]:"Right",[K_]:"Justify",[X_]:"Top",[q_]:"Middle",[Q_]:"Bottom",[k_]:"Freeze column",[L_]:"Unfreeze column",[Z_]:"Borders",[J_]:"Top",[eM]:"Right",[tM]:"Bottom",[nM]:"Left",[rM]:"Remove border(s)",[W_]:"Add comment",[V_]:"Edit comment",[B_]:"Delete comment",[U_]:"Read-only comment",[$_]:"Merge cells",[F_]:"Unmerge cells",[A_]:"Copy",[I_]:["Copy with header","Copy with headers"],[H_]:["Copy with group header","Copy with group headers"],[D_]:["Copy header only","Copy headers only"],[N_]:"Cut",[iM]:"Insert child row",[oM]:"Detach from parent",[sM]:["Hide column","Hide columns"],[aM]:["Show column","Show columns"],[lM]:["Hide row","Hide rows"],[uM]:["Show row","Show rows"],[AC]:"None",[cM]:"Is empty",[hM]:"Is not empty",[dM]:"Is equal to",[fM]:"Is not equal to",[gM]:"Begins with",[mM]:"Ends with",[pM]:"Contains",[wM]:"Does not contain",[vM]:"Greater than",[CM]:"Greater than or equal to",[yM]:"Less than",[SM]:"Less than or equal to",[bM]:"Is between",[RM]:"Is not between",[EM]:"After",[TM]:"Before",[_M]:"Today",[MM]:"Tomorrow",[xM]:"Yesterday",[tv]:"Blank cells",[PM]:"Filter by condition",[OM]:"Filter by value",[AM]:"And",[IC]:"Or",[IM]:"Select all",[HM]:"Clear",[DM]:"OK",[NM]:"Cancel",[kM]:"Search",[LM]:"Value",[$M]:"Second value",[WM]:"Checked",[VM]:"Unchecked"},VB=Qre,Zre=qre,sE=VB.languageCode,{register:Jre,getItem:BB,hasItem:eie,getValues:tie}=go("languagesDictionaries");UB(VB);function UB(t,e){let n=t,r=e;return je(t)&&(r=t,n=r.languageCode),nie(n,r),Jre(n,tr(r)),tr(r)}function nie(t,e){t!==sE&&Ure(e,BB(sE))}function zB(t){return BM(t)?tr(BB(t)):null}function BM(t){return eie(t)}function rie(){return tie()}function jB(t,e,n){const r=zB(t);if(r===null)return null;const i=r[e];if(_t(i))return null;const o=iie(i,n);return Array.isArray(o)?o[0]:o}function iie(t,e){let n=t;return M(Kre(),r=>{n=r(t,e)}),n}function oie(t){let e=$B(t);return BM(e)||(e=sE,FB(t)),e}function sie(t,e,n){return e=aie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aie(t){var e=lie(t,"string");return typeof e=="symbol"?e:String(e)}function lie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uie extends gne{constructor(e,n){super(e,null),sie(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}const Xs=uie;function kS(t){let{activeHeaderClassName:e,...n}=t;return new Xs({className:e,...n,selectionType:CB})}function cie(t){let{areaCornerVisible:e,...n}=t;return new Xs({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:i_})}function hie(t){let{...e}=t;return new Xs({className:"highlight",...e,selectionType:i_})}function die(t){let{columnClassName:e,...n}=t;return new Xs({className:e,...n,selectionType:wne})}function fie(t){let{cellCornerVisible:e,...n}=t;return new Xs({className:"current",headerAttributes:[_1()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:o_})}function gie(t){let{border:e,visualCellRange:n,...r}=t;return new Xs({...e,...r,selectionType:vne},n)}function mie(t){let{...e}=t;return new Xs({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:mne})}function tI(t){let{headerClassName:e,...n}=t;return new Xs({className:e,...n,selectionType:r_})}function pie(t){let{rowClassName:e,...n}=t;return new Xs({className:e,...n,selectionType:pne})}let GB;function wie(t,e){vie(t,e),e.add(t)}function vie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mr(t,e,n){return e=Cie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cie(t){var e=yie(t,"string");return typeof e=="symbol"?e:String(e)}function yie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function is(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var yo=new WeakSet;GB=Symbol.iterator;class Sie{constructor(e){wie(this,yo),Mr(this,"options",void 0),Mr(this,"layerLevel",0),Mr(this,"focus",void 0),Mr(this,"fill",void 0),Mr(this,"layeredAreas",new Map),Mr(this,"areas",new Map),Mr(this,"rowHeaders",new Map),Mr(this,"columnHeaders",new Map),Mr(this,"activeRowHeaders",new Map),Mr(this,"activeColumnHeaders",new Map),Mr(this,"activeCornerHeaders",new Map),Mr(this,"rowHighlights",new Map),Mr(this,"columnHighlights",new Map),Mr(this,"customSelections",[]),this.options=e,this.focus=fie(e),this.fill=mie(e)}isEnabledFor(e,n){let r=e;e===o_&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return is(this,yo,os).call(this,this.layeredAreas,cie)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return is(this,yo,os).call(this,this.areas,hie)}getAreas(){return[...this.areas.values()]}createRowHeader(){return is(this,yo,os).call(this,this.rowHeaders,tI)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return is(this,yo,os).call(this,this.columnHeaders,tI)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return is(this,yo,os).call(this,this.activeRowHeaders,kS)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return is(this,yo,os).call(this,this.activeColumnHeaders,kS)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return is(this,yo,os).call(this,this.activeCornerHeaders,kS)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return is(this,yo,os).call(this,this.rowHighlights,pie)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return is(this,yo,os).call(this,this.columnHighlights,die)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(gie({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),M(this.areas.values(),e=>void e.clear()),M(this.layeredAreas.values(),e=>void e.clear()),M(this.rowHeaders.values(),e=>void e.clear()),M(this.columnHeaders.values(),e=>void e.clear()),M(this.activeRowHeaders.values(),e=>void e.clear()),M(this.activeColumnHeaders.values(),e=>void e.clear()),M(this.activeCornerHeaders.values(),e=>void e.clear()),M(this.rowHighlights.values(),e=>void e.clear()),M(this.columnHighlights.values(),e=>void e.clear())}[GB](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function os(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const bie=Sie;let YB;function nI(t,e,n){return e=Rie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rie(t){var e=Eie(t,"string");return typeof e=="symbol"?e:String(e)}function Eie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}YB=Symbol.iterator;class Tie{constructor(e){nI(this,"ranges",[]),nI(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[YB](){return this.ranges[Symbol.iterator]()}}const _ie=Tie;function nd(t,e){KB(t,e),e.add(t)}function LS(t,e,n){KB(t,e),e.set(t,n)}function KB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nt(t,e){var n=XB(t,e,"get");return Mie(t,n)}function Mie(t,e){return e.get?e.get.call(t):e.value}function Or(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function aE(t,e,n){var r=XB(t,e,"set");return xie(t,r,n),n}function XB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function xie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var xm=new WeakMap,ct=new WeakMap,el=new WeakMap,$S=new WeakSet,FS=new WeakSet,lE=new WeakSet,WS=new WeakSet,Cl=new WeakSet;class qB{constructor(e,n){nd(this,Cl),nd(this,WS),nd(this,lE),nd(this,FS),nd(this,$S),LS(this,xm,{writable:!0,value:void 0}),LS(this,ct,{writable:!0,value:void 0}),LS(this,el,{writable:!0,value:{x:0,y:0}}),aE(this,xm,e),aE(this,ct,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Or(this,$S,rI).call(this,{x:nt(this,ct).navigableHeaders()?nt(this,ct).countRowHeaders():0,y:nt(this,ct).navigableHeaders()?nt(this,ct).countColHeaders():0});const i=nt(this,ct).createCellCoords(e,n);let o=nt(this,xm).current().highlight;const s=nt(this,ct).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=Or(this,lE,QB).call(this),{row:h,col:d}=Or(this,WS,oI).call(this,o),f=nt(this,ct).fixedRowsBottom(),m=nt(this,ct).minSpareRows(),C=nt(this,ct).minSpareCols(),b=nt(this,ct).autoWrapRow(),p=nt(this,ct).autoWrapCol(),w=nt(this,ct).createCellCoords(h+i.row,d+i.col);if(w.row>=c){const T=ro(r&&m>0&&f===0),x=w.col+1,A=nt(this,ct).createCellCoords(w.row-c,x>=u?x-u:x);this.runLocalHooks("beforeColumnWrap",T,Or(this,Cl,Wu).call(this,A),x>=u),T.value?this.runLocalHooks("insertRowRequire",nt(this,ct).countRenderableRows()):p&&w.assign(A)}else if(w.row<0){const T=ro(p),x=w.col-1,A=nt(this,ct).createCellCoords(c+w.row,x<0?u+x:x);this.runLocalHooks("beforeColumnWrap",T,Or(this,Cl,Wu).call(this,A),x<0),p&&w.assign(A)}if(w.col>=u){const T=ro(r&&C>0),x=w.row+1,A=nt(this,ct).createCellCoords(x>=c?x-c:x,w.col-u);this.runLocalHooks("beforeRowWrap",T,Or(this,Cl,Wu).call(this,A),x>=c),T.value?this.runLocalHooks("insertColRequire",nt(this,ct).countRenderableColumns()):b&&w.assign(A)}else if(w.col<0){const T=ro(b),x=w.row-1,A=nt(this,ct).createCellCoords(x<0?c+x:x,u+w.col);this.runLocalHooks("beforeRowWrap",T,Or(this,Cl,Wu).call(this,A),x<0),b&&w.assign(A)}const{rowDir:y,colDir:E}=Or(this,FS,iI).call(this,w);a=y,l=E,o=Or(this,Cl,Wu).call(this,w)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){Or(this,$S,rI).call(this,{x:nt(this,ct).navigableHeaders()?nt(this,ct).countRowHeaders():0,y:nt(this,ct).navigableHeaders()?nt(this,ct).countColHeaders():0});const r=nt(this,ct).createCellCoords(e,n),i=nt(this,xm).current(),o=nt(this,ct).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){const{row:u,col:c}=Or(this,WS,oI).call(this,i.to),h=nt(this,ct).createCellCoords(u+r.row,c+r.col),{rowDir:d,colDir:f}=Or(this,FS,iI).call(this,h);a=d,l=f;const m=Or(this,Cl,Wu).call(this,h);r.row===0&&r.col!==0?s.col=m.col:r.row!==0&&r.col===0?s.row=m.row:(s.row=m.row,s.col=m.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function rI(t){let{x:e,y:n}=t;aE(this,el,{x:e,y:n})}function iI(t){const{width:e,height:n}=Or(this,lE,QB).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function QB(){return{width:nt(this,el).x+nt(this,ct).countRenderableColumns(),height:nt(this,el).y+nt(this,ct).countRenderableRows()}}function oI(t){const{row:e,col:n}=nt(this,ct).visualToRenderableCoords(t);return nt(this,ct).createCellCoords(nt(this,el).y+e,nt(this,el).x+n)}function Wu(t){const e=t.clone();return e.col=t.col-nt(this,el).x,e.row=t.row-nt(this,el).y,nt(this,ct).renderableToVisualCoords(e)}bt(qB,zr);const Pie=qB,HC=0,DC=1,ZB=2,UM=3,Oie=[UM,ZB],Aie=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],VS=Symbol("root"),sI=Symbol("child");function uh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:VS;if(e!==VS&&e!==sI)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===VS;let i=HC;if(n){const o=t[0];t.length===0?i=DC:r&&o instanceof X1?i=UM:r&&Array.isArray(o)?i=uh(o,sI):t.length>=2&&t.length<=4&&!t.some((a,l)=>!Aie[l].includes(typeof a))&&(i=ZB)}return i}function Gf(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Oie.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===UM;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),_t(u)&&(u=a),_t(c)&&(c=l),!r){const f=a,m=l,C=u,b=c;a=Math.min(f,C),l=Math.min(m,b),u=Math.max(f,C),c=Math.max(m,b)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function Iie(t){const e=uh(t.getSelected());if(e===HC||e===DC)return[];const n=Gf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;M(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return an(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Hie(t){const e=uh(t.getSelected());if(e===HC||e===DC)return[];const n=Gf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;M(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return an(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Die(t,e,n){Nie(t,e),e.set(t,n)}function Nie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function na(t,e,n){return e=kie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kie(t){var e=Lie(t,"string");return typeof e=="symbol"?e:String(e)}function Lie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aI(t,e,n){var r=JB(t,e,"set");return $ie(t,r,n),n}function $ie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function lI(t,e){var n=JB(t,e,"get");return Fie(t,n)}function JB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Fie(t,e){return e.get?e.get.call(t):e.value}var rd=new WeakMap;class eU{constructor(e,n){var r=this;na(this,"settings",void 0),na(this,"tableProps",void 0),na(this,"inProgress",!1),na(this,"selectedRange",new _ie((i,o,s)=>this.tableProps.createCellRange(i,o,s))),na(this,"highlight",void 0),na(this,"transformation",void 0),na(this,"selectedByRowHeader",new Set),na(this,"selectedByColumnHeader",new Set),Die(this,rd,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new bie({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[_1()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new Pie(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=_t(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&_t(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(o_,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(M(this.highlight.getAreas(),w=>void w.clear()),M(this.highlight.getLayeredAreas(),w=>void w.clear()),M(this.highlight.getRowHeaders(),w=>void w.clear()),M(this.highlight.getColumnHeaders(),w=>void w.clear()),M(this.highlight.getActiveRowHeaders(),w=>void w.clear()),M(this.highlight.getActiveColumnHeaders(),w=>void w.clear()),M(this.highlight.getActiveCornerHeaders(),w=>void w.clear()),M(this.highlight.getRowHighlights(),w=>void w.clear()),M(this.highlight.getColumnHighlights(),w=>void w.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),h=this.highlight.createRowHeader(),d=this.highlight.createColumnHeader(),f=this.highlight.createActiveRowHeader(),m=this.highlight.createActiveColumnHeader(),C=this.highlight.createActiveCornerHeader(),b=this.highlight.createRowHighlight(),p=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),m.clear(),C.clear(),b.clear(),p.clear(),this.highlight.isEnabledFor(i_,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),l===1)){const w=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(w.from).commit().syncWith(w),this.highlight.createLayeredArea().add(w.from).commit().syncWith(w),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(r_,s.highlight)){if(!s.isSingleHeader()){const E=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),T=this.tableProps.createCellCoords(s.to.row,-1),x=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),A=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(h.add(E).commit(),d.add(x).commit(),b.add(E).commit(),p.add(x).commit()):(h.add(E).add(T).commit(),d.add(x).add(A).commit(),b.add(E).add(T).commit(),p.add(x).add(A).commit())}const w=!lI(this,rd)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),y=!lI(this,rd)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());w&&f.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),y&&m.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),w&&y&&C.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=ro(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;aI(this,rd,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Fr(d.row,u,o-1),Fr(d.col,c,s-1)));const m=this.tableProps.createCellCoords(u,c),C=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(m,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.finish(),aI(this,rd,!1)}selectCells(e){var n=this;const r=uh(e);if(r===DC)return!1;if(r===HC)throw new Error(pt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Gf(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),M(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){const f=l===0?0:Fr(r,u,-1),m=s-1,C=this.tableProps.createCellCoords(f,i),b=this.tableProps.createCellCoords(m,o),p=this.tableProps.createCellCoords(Fr(r,u,s-1),i);this.runLocalHooks("beforeSelectColumns",C,b,p),C.row=f,b.row=m,this.setRangeStartOnly(C,void 0,p),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(b),this.runLocalHooks("afterSelectColumns",C,b,p),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){const h=s===0?0:Fr(r,a,-1),d=o-1,f=this.tableProps.createCellCoords(e,h),m=this.tableProps.createCellCoords(n,d),C=this.tableProps.createCellCoords(e,Fr(r,a,o-1));this.runLocalHooks("beforeSelectRows",f,m,C),f.col=h,m.col=d,this.setRangeStartOnly(f,void 0,C),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.runLocalHooks("afterSelectRows",f,m,C),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(r)}}bt(eU,zr);const Wie=eU,uI=/^(\r\n|\n\r|\r|\n)/,Vie=/^[^\t\r\n]+/,cI=/^\t/;function Bie(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(cI))t=t.replace(cI,""),n+=1,e[r][n]="";else if(t.match(uI))t=t.replace(uI,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(Vie);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function rf(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function yl(t,e,n){return e=Uie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uie(t){var e=zie(t,"string");return typeof e=="symbol"?e:String(e)}function zie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){yl(this,"hot",void 0),yl(this,"metaManager",void 0),yl(this,"tableMeta",void 0),yl(this,"dataSource",void 0),yl(this,"duckSchema",void 0),yl(this,"colToPropCache",void 0),yl(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=bC(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(je(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return f_(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ke(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&fe(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(fe(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?lh(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=tr(this.getSchema()):(m=[],Se(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},Cg(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,m=c;i==="end"&&(m=Math.min(m+1,a));const C=m;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let p=0;p<h;p+=1)typeof o[p]>"u"&&(o[p]=[]),o[p].push(null);else o.push([null]);else for(let p=0;p<h;p++)o[p].splice(m,0,null);f+=1,m+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(C,n));const b=this.hot.toVisualColumn(C);return this.hot.runHooks("afterCreateCol",b,f,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:C}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=fe(this.tableMeta.columns)||fe(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];LR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return e2(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];LR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&Bt(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const a=ro(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=ro(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&Bt(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let u=s,c=0,h;for(c=0,h=l.length-1;c<h;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Fc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Fc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return rf(this.getRange(e,n,Fc.DESTINATION_RENDERER))}getCopyableText(e,n){return rf(this.getRange(e,n,Fc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const jie=Fc,{register:Gie,getItem:Yie,hasItem:tU,getNames:Kie,getValues:FRe}=go("cellTypes");function zM(t){if(!tU(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Yie(t)}function gi(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Hr(t,n),r&&Yr(t,r),i&&Gl(t,i),Gie(t,e)}function Xie(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Bt(e,t)}function NC(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?zM(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ke(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!je(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ke(r,(o,s)=>{if(Xie(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),hn(t,i)}function qie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Ys(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Kp(t){return Number.isInteger(t)&&t>=0}function Xp(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Pm(t){return t==null}const nU=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),pn(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),pn(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),SC(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function hI(t,e,n){return e=Qie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qie(t){var e=Zie(t,"string");return typeof e=="symbol"?e:String(e)}function Zie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jie(){return class{}}class eoe{constructor(e){hI(this,"metaCtor",Jie()),hI(this,"meta",void 0),this.meta=this.metaCtor.prototype,hn(this.meta,nU()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;hn(this.meta,e),NC(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function toe(t,e,n){return e=noe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function noe(t){var e=roe(t,"string");return typeof e=="symbol"?e:String(e)}function roe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ioe{constructor(e){toe(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){hn(this.meta,e),NC(this.meta,e,e)}}let rU;function Om(t,e,n){return e=ooe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ooe(t){var e=soe(t,"string");return typeof e=="symbol"?e:String(e)}function soe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}rU=Symbol.iterator;class nv{constructor(e){Om(this,"valueFactory",void 0),Om(this,"data",[]),Om(this,"index",[]),Om(this,"holes",new Set),this.valueFactory=e}obtain(e){Xp(()=>Kp(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Xp(()=>Kp(e)||Pm(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Pm(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Xp(()=>Kp(e)||Pm(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Pm(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return oi(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[rU](){return this.entries()}}function dI(t,e,n){return e=aoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aoe(t){var e=loe(t,"string");return typeof e=="symbol"?e:String(e)}function loe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uoe=["data","width"];class coe{constructor(e){dI(this,"globalMeta",void 0),dI(this,"metas",new nv(()=>this._createMeta())),this.globalMeta=e,this.metas=new nv(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);hn(r,n),NC(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return qie(this.globalMeta.getMetaConstructor(),uoe).prototype}}function fI(t,e,n){return e=hoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hoe(t){var e=doe(t,"string");return typeof e=="symbol"?e:String(e)}function doe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class foe{constructor(e){fI(this,"columnMeta",void 0),fI(this,"metas",new nv(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);hn(i,r),NC(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)e.push(...n[r].values());return e}getMetasAtRow(e){Xp(()=>Kp(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new nv(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class iU{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new eoe(e),this.tableMeta=new ioe(this.globalMeta),this.columnMeta=new coe(this.globalMeta),this.cellMeta=new foe(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}bt(iU,zr);function gI(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=er(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Tt(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new jie(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const m=f.getSchema();t=[];let C,b=0,p=0;for(b=0,p=d.startRows;b<p;b++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)C=tr(m),t.push(C);else if(i.dataType==="array")C=tr(m[0]),t.push(C);else{C=[];for(let w=0,y=d.startCols;w<y;w++)C.push(null);t.push(C)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Pe(i.rootElement,[l2(-1),mC(i.countCols()+(i.view?i.countRowHeaders():0))])}function mI(t,e,n){return e=goe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function goe(t){var e=moe(t,"string");return typeof e=="symbol"?e:String(e)}function moe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class poe{constructor(e){mI(this,"metaManager",void 0),mI(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),we.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Bt(e,"type")?e.type:null;let c=Tt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function BS(t,e,n){return e=woe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function woe(t){var e=voe(t,"string");return typeof e=="symbol"?e:String(e)}function voe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Coe{constructor(e){BS(this,"metaManager",void 0),BS(this,"usageTracker",new Set),BS(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const oU="gridDefault",jM="editorManager.handlingEditor",yoe={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(n.includes("shift"))}},Soe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},boe={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Roe={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),Di(e))}};function Eoe(){return[yoe,Soe,boe,Roe]}const Toe={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},_oe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},Moe={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},xoe={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},Poe={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},Ooe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},Aoe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},Ioe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},Hoe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},Doe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},Noe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},koe={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},Loe={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},$oe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function Foe(){return[Toe,_oe,Moe,xoe,Poe,Ooe,Aoe,Ioe,Hoe,Doe,Noe,koe,Loe,$oe]}const Woe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},Voe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},Boe={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},Uoe={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col)}},zoe={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},joe={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},Goe={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},Yoe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},Koe={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},Xoe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},qoe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},Qoe={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},Zoe={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},Joe={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},ese={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},tse={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function nse(){return[Woe,Voe,Boe,Uoe,zoe,joe,Goe,Yoe,Koe,Xoe,qoe,Qoe,Zoe,Joe,ese,tse]}const rse={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},ise={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},ose={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},sse={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},ase={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},lse=[...Eoe(),...Foe(),...nse(),rse,ise,ose,sse,ase];function sU(t){const e={};return lse.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function use(t){const e=t.getShortcutManager().addContext("editor"),n=sU(t),r={group:jM};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function cse(t){const e=t.getShortcutManager().addContext("grid"),n=sU(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return fe(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:oU};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:jM,runOnlyIf:()=>fe(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function hse(t){[use,cse].forEach(e=>e(t))}function dse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=pI(t),i=pI(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function pI(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Pe(n,[Vo(),Gs()]),n}function fse(t){const e=gse(t);let n;const{activate:r,deactivate:i}=dse(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:uE(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:cE(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,m,C)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,C.value=!0),s){var b;n=(b=t.getSelectedRangeLast())===null||b===void 0?void 0:b.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:oU,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?uE(t):cE(t)),u(),!1;h.preventDefault()},position:"after"}])}function uE(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function cE(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function gse(t){return e=>{if(!e)return null;const n=uE(t),r=cE(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}const wI=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Am=t=>t.map(e=>{const n=e.toLowerCase();return wI.has(n)?wI.get(n):n}).sort().join("+"),mse=t=>t.split("+"),vI=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),pse=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),US=t=>{let{key:e,code:n}=t,r=e;return vI.test(n)?r=n.replace(vI,"$1"):pse.has(n)&&(r=n),r.toLowerCase()},aU=Symbol("shortcut-context");function lU(t){return je(t)&&t.__kindOf===aU}const wse=t=>{const e=_C({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:m=!1,relativeToGroup:C,position:b,forwardToContext:p}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(_t(c))throw new Error("You need to define the shortcut's group.");if(Tt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(pt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const w={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:m};fe(C)&&([w.relativeToGroup,w.position]=[C,b]),lU(p)&&(w.forwardToContext=p),l.forEach(y=>{const E=Am(y);if(e.hasItem(E)){const x=e.getItem(E);let A=x.findIndex(W=>W.group===C);A!==-1?b==="before"?A-=1:A+=1:A=x.length,x.splice(A,0,w)}else e.addItem(E,[w])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ke(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=Am(l);e.removeItem(u)};return{__kindOf:aU,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Am(l),c=e.getItem(u);return fe(c)?c.slice():[]},hasShortcut:l=>{const u=Am(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(m=>m.group!==l);f.length===0?i(mse(h)):(d.length=0,d.push(...f))})}}};function vse(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Cse=["meta","alt","shift","control"],id=vse();let Im=0;function yse(t,e,n,r,i){const o=f=>Cse.includes(f),s=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=[];return f.altKey&&C.push("alt"),m&&(f.ctrlKey||f.metaKey)?C.push("control/meta"):(f.ctrlKey&&C.push("control"),f.metaKey&&C.push("meta")),f.shiftKey&&C.push("shift"),C},a=f=>{if(e(f)===!1)return;const m=n(f);if(f.keyCode===229||m===!1||ba(f))return;const C=US(f);let b=[];o(C)||(b=s(f));const p=[C].concat(b);!i(f,p)&&(zf()&&b.includes("meta")||!zf()&&b.includes("control"))&&i(f,[C].concat(s(f,!0))),r(f)},l=f=>{const m=US(f);o(m)&&id.press(m)},u=f=>{const m=US(f);o(m)&&id.release(m)},c=()=>{id.releaseAll()};return{mount:()=>{let f=t;for(Im+=1;f;)Im===1&&(f.document.documentElement.addEventListener("keydown",l),f.document.documentElement.addEventListener("keyup",u)),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=Vf(f)},unmount:()=>{let f=t;for(Im-=1;f;)Im===0&&(f.document.documentElement.removeEventListener("keydown",l),f.document.documentElement.removeEventListener("keyup",u)),f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=Vf(f)},isPressed:f=>id.isPressed(f),releasePressedKeys:()=>id.releaseAll()}}const Sse=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=_C({errorIdExists:m=>`The "${m}" context name is already registered.`});let s="grid";const a=m=>{const C=wse(m);return o.addItem(m,C),C},l=()=>s,u=m=>o.getItem(m),c=m=>{if(!o.hasItem(m))throw new Error(pt`You've tried to activate the "${m}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=m};let h=!1;const d=function(m,C){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const p=lU(b)?b:u(b);let w=!1;if(!p.hasShortcut(C))return w;const y=p.getShortcuts(C);for(let E=0;E<y.length;E++){const{callback:T,runOnlyIf:x,preventDefault:A,stopPropagation:W,captureCtrl:B,forwardToContext:U}=y[E];if(x(m)===!0){if(h=B,w=T(m,C)===!1,h=!1,A&&m.preventDefault(),W&&(Di(m),m.stopPropagation()),w)break;U&&d(m,C,U)}}return w},f=yse(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};let zS=null;const jS=new Map;function uU(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this;const a=new Oi(s);let l,u,c,h,d,f=!0;nre(i)&&tre(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const m=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",C=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",C),this.isRtl=function(){return C==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=oie(e.language);const b=new iU(s,e,[poe,Coe]),p=b.getTableMeta(),w=b.getGlobalMeta(),y=_C();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Yp(this)&&i2(e.licenseKey,t),this.guid=`ht_${S1()}`,jS.set(this.guid,this),this.columnIndexMapper=new oE,this.rowIndexMapper=new oE,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterRowSequenceChange",g)}),u=new vre(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const E=g=>{const{row:v,col:S}=g;return s._createCellCoords(v>=0?s.rowIndexMapper.getRenderableFromVisualIndex(v):v,S>=0?s.columnIndexMapper.getRenderableFromVisualIndex(S):S)},T=g=>{const{row:v,col:S}=g;return s._createCellCoords(v>=0?s.rowIndexMapper.getVisualFromRenderableIndex(v):v,S>=0?s.columnIndexMapper.getVisualFromRenderableIndex(S):S)};let x=new Wie(p,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:g=>l.propToCol(g),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(g,v)=>s._createCellCoords(g,v),createCellRange:(g,v,S)=>s._createCellRange(g,v,S),visualToRenderableCoords:E,renderableToVisualCoords:T,isDisabledCellSelection:(g,v)=>g<0||v<0?s.getSettings().disableVisualSelection:s.getCellMeta(g,v).disableVisualSelection});this.selection=x;const A=g=>{let{hiddenIndexesChanged:v}=g;v&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",A),this.rowIndexMapper.addLocalHook("cacheUpdated",A),this.selection.addLocalHook("afterSetRangeEnd",g=>{const v=ro(!1),S=this.selection.getSelectedRange(),{from:O,to:H}=S.current(),D=S.size()-1;this.runHooks("afterSelection",O.row,O.col,H.row,H.col,v,D),this.runHooks("afterSelectionByProp",O.row,s.colToProp(O.col),H.row,s.colToProp(H.col),v,D);let X=!0;o&&(X=!1),v.isTouched()&&(X=!v.value);const G=this.selection.selectedRange.current(),se=this.selection.isSelectedByAnyHeader(),re=this.selection.isSelectedByRowHeader(),q=this.selection.isSelectedByColumnHeader();if(X!==!1)if(se)re?this.scrollViewportTo({row:g.row}):q&&this.scrollViewportTo({col:g.col});else if(G&&!this.selection.isMultiple()){const{row:Ee,col:De}=G.from;Ee<0&&De>=0?this.scrollViewportTo({col:De}):De<0&&Ee>=0?this.scrollViewportTo({row:Ee}):this.scrollViewportTo({row:Ee,col:De})}else this.scrollViewportTo(g.toObject());re&&q?J(this.rootElement,["ht__selection--rows","ht__selection--columns"]):re?(We(this.rootElement,"ht__selection--columns"),J(this.rootElement,"ht__selection--rows")):q?(We(this.rootElement,"ht__selection--rows"),J(this.rootElement,"ht__selection--columns")):We(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",g=>{const v=g.length-1,{from:S,to:O}=g[v];this.runHooks("afterSelectionEnd",S.row,S.col,O.row,O.col,v),this.runHooks("afterSelectionEndByProp",S.row,s.colToProp(S.col),O.row,s.colToProp(O.col),v)}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const v=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=v)}),this.selection.addLocalHook("afterDeselect",()=>{h.destroyEditor(),this._refreshBorders(),We(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,v=new Array(g),S=0;S<g;S++)v[S]=arguments[S];return r.runHooks("beforeSetRangeStart",...v)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,v=new Array(g),S=0;S<g;S++)v[S]=arguments[S];return r.runHooks("beforeSetRangeStartOnly",...v)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,v=new Array(g),S=0;S<g;S++)v[S]=arguments[S];return r.runHooks("beforeSetRangeEnd",...v)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,v=new Array(g),S=0;S<g;S++)v[S]=arguments[S];return r.runHooks("beforeSelectColumns",...v)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,v=new Array(g),S=0;S<g;S++)v[S]=arguments[S];return r.runHooks("afterSelectColumns",...v)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,v=new Array(g),S=0;S<g;S++)v[S]=arguments[S];return r.runHooks("beforeSelectRows",...v)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,v=new Array(g),S=0;S<g;S++)v[S]=arguments[S];return r.runHooks("afterSelectRows",...v)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,v=new Array(g),S=0;S<g;S++)v[S]=arguments[S];return r.runHooks("modifyTransformStart",...v)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,v=new Array(g),S=0;S<g;S++)v[S]=arguments[S];return r.runHooks("afterModifyTransformStart",...v)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,v=new Array(g),S=0;S<g;S++)v[S]=arguments[S];return r.runHooks("modifyTransformEnd",...v)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,v=new Array(g),S=0;S<g;S++)v[S]=arguments[S];return r.runHooks("afterModifyTransformEnd",...v)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,v=new Array(g),S=0;S<g;S++)v[S]=arguments[S];return r.runHooks("beforeRowWrap",...v)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,v=new Array(g),S=0;S<g;S++)v[S]=arguments[S];return r.runHooks("beforeColumnWrap",...v)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),c={alter(g,v){var S,O;let H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,D=arguments.length>3?arguments[3]:void 0,X=arguments.length>4?arguments[4]:void 0;const G=se=>{if(se.length===0)return[];const re=[...se];return re.sort((Ee,De)=>{let[Ie]=Ee,[Le]=De;return Ie===Le?0:Ie>Le?1:-1}),an(re,(Ee,De)=>{let[Ie,Le]=De;const K=Ee[Ee.length-1],[ft,Ge]=K,Ne=ft+Ge;if(Ie<=Ne){const $e=Math.max(Le-(Ne-Ie),0);K[1]+=$e}else Ee.push([Ie,Le]);return Ee},[re[0]])};switch(g){case"insert_row_below":case"insert_row_above":const se=s.countSourceRows();if(p.maxRows===se)return;const re=g==="insert_row_below"?"below":"above";v=(S=v)!==null&&S!==void 0?S:re==="below"?se:0;const{delta:q,startPhysicalIndex:Ee}=l.createRow(v,H,{source:D,mode:re});if(q){const Ge=x.selectedRange.current(),Ne=Ge==null?void 0:Ge.from,$e=Ne==null?void 0:Ne.row,Me=s.toVisualRow(Ee);if(x.isSelectedByCorner())x.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(fe($e)&&$e>=Me){const{row:R,col:_}=Ge.to;let P=Ne.col;x.isSelectedByRowHeader()&&(P=-1),x.getSelectedRange().pop(),x.setRangeStartOnly(s._createCellCoords($e+q,P),!0),x.setRangeEnd(s._createCellCoords(R+q,_))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const De=g==="insert_col_end"?"end":"start";v=(O=v)!==null&&O!==void 0?O:De==="end"?s.countSourceCols():0;const{delta:Ie,startPhysicalIndex:Le}=l.createCol(v,H,{source:D,mode:De});if(Ie){if(Array.isArray(p.colHeaders)){const R=[s.toVisualColumn(Le),0];R.length+=Ie,Array.prototype.splice.apply(p.colHeaders,R)}const Ge=x.selectedRange.current(),Ne=Ge==null?void 0:Ge.from,$e=Ne==null?void 0:Ne.col,Me=s.toVisualColumn(Le);if(x.isSelectedByCorner())x.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(fe($e)&&$e>=Me){const{row:R,col:_}=Ge.to;let P=Ne.row;x.isSelectedByColumnHeader()&&(P=-1),x.getSelectedRange().pop(),x.setRangeStartOnly(s._createCellCoords(P,$e+Ie),!0),x.setRangeEnd(s._createCellCoords(R,_+Ie))}else s._refreshBorders()}break;case"remove_row":const K=Ge=>{let Ne=0;M(Ge,$e=>{let[Me,R]=$e;const _=pn(Me)?s.countRows()-1:Math.max(Me-Ne,0);if(Number.isInteger(Me)&&(Me=Math.max(Me-Ne,0)),!l.removeRow(Me,R,D))return;const V=s.countRows(),I=p.fixedRowsTop;I>=_+1&&(p.fixedRowsTop-=Math.min(R,I-_));const F=p.fixedRowsBottom;F&&_>=V-F&&(p.fixedRowsBottom-=Math.min(R,F)),Ne+=R})};Array.isArray(v)?K(G(v)):K([[v,H]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const ft=Ge=>{let Ne=0;M(Ge,$e=>{let[Me,R]=$e;const _=pn(Me)?s.countCols()-1:Math.max(Me-Ne,0);let P=s.toPhysicalColumn(_);if(Number.isInteger(Me)&&(Me=Math.max(Me-Ne,0)),!l.removeCol(Me,R,D))return;const I=p.fixedColumnsStart;I>=_+1&&(p.fixedColumnsStart-=Math.min(R,I-_)),Array.isArray(p.colHeaders)&&(typeof P>"u"&&(P=-1),p.colHeaders.splice(P,R)),Ne+=R})};Array.isArray(v)?ft(G(v)):ft([[v,H]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${g}"`)}X||c.adjustRowsAndCols()},adjustRowsAndCols(){const g=p.minRows,v=p.minSpareRows,S=p.minCols,O=p.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&x.deselect(),g){const H=s.countRows();H<g&&l.createRow(H,g-H,{source:"auto"})}if(v){const H=s.countEmptyRows(!0);if(H<v){const D=v-H,X=Math.min(D,p.maxRows-s.countSourceRows());l.createRow(s.countRows(),X,{source:"auto"})}}{let H;(S||O)&&(H=s.countEmptyCols(!0));let D=s.countCols();if(S&&!p.columns&&D<S){const X=S-D;H+=X,l.createCol(D,X,{source:"auto"})}if(O&&!p.columns&&s.dataType==="array"&&H<O){D=s.countCols();const X=O-H,G=Math.min(X,p.maxCols-D);l.createCol(D,G,{source:"auto"})}}if(x.isSelected()){const H=s.countRows(),D=s.countCols();M(x.selectedRange,X=>{let G=!1,se=X.from.row,re=X.from.col,q=X.to.row,Ee=X.to.col;se>H-1?(se=H-1,G=!0,q>se&&(q=se)):q>H-1&&(q=H-1,G=!0,se>q&&(se=q)),re>D-1?(re=D-1,G=!0,Ee>re&&(Ee=re)):Ee>D-1&&(Ee=D-1,G=!0,re>Ee&&(re=Ee)),G&&(re<0?s.selectRows(se,q,re):se<0?s.selectColumns(re,Ee,se):s.selectCell(se,re,q,Ee))})}s.view&&s.view.adjustElementsSize()},populateFromArray(g,v,S,O,H){let D,X,G,se;const re=[],q={},Ee=[],De=g.row,Ie=g.col;if(X=v.length,X===0)return!1;let Le=0,K=0;switch(je(S)&&(Le=S.col-Ie+1,K=S.row-De+1),H){case"shift_down":const ft=Jd(v),Ge=ft.length,Ne=Math.max(Ge,Le),$e=s.getData().slice(De),Me=Jd($e).slice(Ie,Ie+Ne);for(G=0;G<Ne;G+=1)if(G<Ge){for(D=0,X=ft[G].length;D<K-X;D+=1)ft[G].push(ft[G][D%X]);G<Me.length?Ee.push(ft[G].concat(Me[G])):Ee.push(ft[G].concat(new Array($e.length).fill(null)))}else Ee.push(ft[G%Ge].concat(Me[G]));s.populateFromArray(De,Ie,Jd(Ee));break;case"shift_right":const R=v.length,_=Math.max(R,K),P=s.getData().slice(De).map(j=>j.slice(Ie));for(D=0;D<_;D+=1)if(D<R){for(G=0,se=v[D].length;G<Le-se;G+=1)v[D].push(v[D][G%se]);if(D<P.length)for(let j=0;j<P[D].length;j+=1)v[D].push(P[D][j]);else v[D].push(...new Array(P[0].length).fill(null))}else v.push(v[D%X].slice(0,_).concat(P[D]));s.populateFromArray(De,Ie,v);break;case"overwrite":default:q.row=g.row,q.col=g.col;let V=0,I=0,F=!0,N;const L=function(ae){let me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Te=v[ae%v.length];return me!==null?Te[me%Te.length]:Te},z=v.length,$=S?S.row-g.row+1:0;for(S?X=$:X=Math.max(z,$),D=0;D<X&&!(S&&q.row>S.row&&$>z||!p.allowInsertRow&&q.row>s.countRows()-1||q.row>=p.maxRows);D++){const j=D-V,ae=L(j).length,me=S?S.col-g.col+1:0;if(S?se=me:se=Math.max(ae,me),q.col=g.col,N=s.getCellMeta(q.row,q.col),(O==="CopyPaste.paste"||O==="Autofill.fill")&&N.skipRowOnPaste){V+=1,q.row+=1,X+=1;continue}for(I=0,G=0;G<se&&!(S&&q.col>S.col&&me>ae||!p.allowInsertColumn&&q.col>s.countCols()-1||q.col>=p.maxCols);G++){if(N=s.getCellMeta(q.row,q.col),(O==="CopyPaste.paste"||O==="Autofill.fill")&&N.skipColumnOnPaste){I+=1,q.col+=1,se+=1;continue}if(N.readOnly&&O!=="UndoRedo.undo"){q.col+=1;continue}const Te=G-I;let Ae=L(j,Te),ze=s.getDataAtCell(q.row,q.col);if(Ae!==null&&typeof Ae=="object")if(Array.isArray(Ae)&&ze===null&&(ze=[]),ze===null||typeof ze!="object")F=!1;else{const Mt=lh(Array.isArray(ze)?ze:ze[0]||ze),et=lh(Array.isArray(Ae)?Ae:Ae[0]||Ae);SC(Mt,et)||Array.isArray(Mt)&&Array.isArray(et)?Ae=tr(Ae):F=!1}else ze!==null&&typeof ze=="object"&&(F=!1);F&&re.push([q.row,q.col,Ae]),F=!0,q.col+=1}q.row+=1}s.setDataAtCell(re,null,null,O||"populateFromArray");break}}};function W(g){const v=$B(g);BM(v)?(s.runHooks("beforeLanguageChange",v),w.language=v,s.runHooks("afterLanguageChange",v)):FB(g)}function B(g,v){const S=g==="className"?s.rootElement:s.table;if(f)J(S,v);else{let O=[],H=[];w[g]&&(O=Array.isArray(w[g])?w[g]:FR(w[g])),v&&(H=Array.isArray(v)?v:FR(v));const D=$R(O,H),X=$R(H,O);D.length&&We(S,D),X.length&&J(S,X)}w[g]=v}this.init=function(){u.setData(p.data),s.runHooks("beforeInit"),(_s()||W1())&&J(s.rootElement,"mobile"),this.updateSettings(p,!0),this.view=new ure(this),h=sJ.getInstance(s,p,x),d=new uJ(s),Yp(this)&&fse(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&s.rootElement.offsetParent===null&&y2(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof f=="object"&&(s.runHooks("afterChange",f[0],f[1]),f=!1),s.runHooks("afterInit")};function U(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function Q(g){const v=g.replace(",",".");return isNaN(parseFloat(v))===!1?parseFloat(v):g}function te(g,v,S){if(!g.length)return;const O=s.getActiveEditor(),H=new U;let D=!0;H.onQueueEmpty=X=>{O&&D&&O.cancelChanges(),S(X)};for(let X=g.length-1;X>=0;X--){const[G,se,,re]=g[X],q=l.propToCol(se),Ee=s.getCellMeta(G,q);Ee.type==="numeric"&&typeof re=="string"&&Y2(re)&&(g[X][3]=Q(re)),s.getCellValidator(Ee)&&(H.addValidatorToQueue(),s.validateCell(g[X][3],Ee,function(De,Ie){return function(Le){if(typeof Le!="boolean")throw new Error("Validation error: result is not boolean");if(Le===!1&&Ie.allowInvalid===!1){D=!1,g.splice(De,1),Ie.valid=!0;const K=s.getCell(Ie.visualRow,Ie.visualCol);K!==null&&We(K,p.invalidCellClassName)}H.removeValidatorFormQueue()}}(X,Ee),v))}H.checkIfQueueIsEmpty()}function ee(g,v){let S=g.length-1;if(S<0)return;for(;S>=0;S--){let H=!1;if(g[S]===null){g.splice(S,1);continue}if(!((g[S][2]===null||g[S][2]===void 0)&&(g[S][3]===null||g[S][3]===void 0))){if(p.allowInsertRow)for(;g[S][0]>s.countRows()-1;){const{delta:D}=l.createRow(void 0,void 0,{source:v});if(D===0){H=!0;break}}if(s.dataType==="array"&&(!p.columns||p.columns.length===0)&&p.allowInsertColumn)for(;l.propToCol(g[S][1])>s.countCols()-1;){const{delta:D}=l.createCol(void 0,void 0,{source:v});if(D===0){H=!0;break}}H||l.set(g[S][0],g[S][1],g[S][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",g,v),h.lockEditor(),s._refreshBorders(null),h.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",g,v||"edit");const O=s.getActiveEditor();O&&fe(O.refreshValue)&&O.refreshValue()}this._createCellCoords=function(g,v){return s.view._wt.createCellCoords(g,v)},this._createCellRange=function(g,v,S){return s.view._wt.createCellRange(g,v,S)},this.validateCell=function(g,v,S,O){let H=s.getCellValidator(v);function D(X){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||v.hidden===!0){S(X);return}const se=v.visualCol,re=v.visualRow,q=s.getCell(re,se,!0);if(q&&q.nodeName!=="TH"){const Ee=s.rowIndexMapper.getRenderableFromVisualIndex(re),De=s.columnIndexMapper.getRenderableFromVisualIndex(se);s.view._wt.getSetting("cellRenderer",Ee,De,q)}S(X)}r2(H)&&(H=function(X){return function(G,se){se(X.test(G))}}(H)),Tt(H)?(g=s.runHooks("beforeValidate",g,v.visualRow,v.prop,O),s._registerImmediate(()=>{H.call(v,g,X=>{s&&(X=s.runHooks("afterValidate",X,g,v.visualRow,v.prop,O),v.valid=X,D(X),s.runHooks("postAfterValidate",X,g,v.visualRow,v.prop,O))})})):s._registerImmediate(()=>{v.valid=!0,D(v.valid,!1)})};function he(g,v,S){return Array.isArray(g)?g:[[g,v,S]]}function _e(g,v){const S=s.getActiveEditor(),O=s.runHooks("beforeChange",g,v||"edit"),H=g.filter(D=>D!==null);return O===!1||H.length===0?(S&&S.cancelChanges(),[]):H}this.setDataAtCell=function(g,v,S,O){const H=he(g,v,S),D=[];let X=O,G,se,re;for(G=0,se=H.length;G<se;G++){if(typeof H[G]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof H[G][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");H[G][1]>=this.countCols()?re=H[G][1]:re=l.colToProp(H[G][1]),D.push([H[G][0],re,u.getAtCell(this.toPhysicalRow(H[G][0]),H[G][1]),H[G][2]])}!X&&typeof g=="object"&&(X=v);const q=_e(D,O);s.runHooks("afterSetDataAtCell",q,X),te(q,X,()=>{ee(q,X)})},this.setDataAtRowProp=function(g,v,S,O){const H=he(g,v,S),D=[];let X=O,G,se;for(G=0,se=H.length;G<se;G++)D.push([H[G][0],H[G][1],u.getAtCell(this.toPhysicalRow(H[G][0]),H[G][1]),H[G][2]]);!X&&typeof g=="object"&&(X=v);const re=_e(D,O);s.runHooks("afterSetDataAtRowProp",re,X),te(re,X,()=>{ee(re,X)})},this.listen=function(){s&&!s.isListening()&&(jS.forEach(g=>{s!==g&&g.unlisten()}),zS=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(zS=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return zS===s.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(g,v)},this.populateFromArray=function(g,v,S,O,H,D,X){if(!(typeof S=="object"&&typeof S[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const G=typeof O=="number"?s._createCellCoords(O,H):null;return c.populateFromArray(s._createCellCoords(g,v),S,G,D,X)},this.spliceCol=function(g,v,S){for(var O=arguments.length,H=new Array(O>3?O-3:0),D=3;D<O;D++)H[D-3]=arguments[D];return l.spliceCol(g,v,S,...H)},this.spliceRow=function(g,v,S){for(var O=arguments.length,H=new Array(O>3?O-3:0),D=3;D<O;D++)H[D-3]=arguments[D];return l.spliceRow(g,v,S,...H)},this.getSelected=function(){if(x.isSelected())return Ye(x.getSelectedRange(),g=>{let{from:v,to:S}=g;return[v.row,v.col,S.row,S.col]})},this.getSelectedLast=function(){const g=this.getSelected();let v;return g&&g.length>0&&(v=g[g.length-1]),v},this.getSelectedRange=function(){if(x.isSelected())return Array.from(x.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let v;return g&&g.length>0&&(v=g[g.length-1]),v},this.emptySelectedCells=function(g){if(!x.isSelected()||this.countRows()===0||this.countCols()===0)return;const v=[];M(x.getSelectedRange(),S=>{if(S.isSingleHeader())return;const O=S.getTopStartCorner(),H=S.getBottomEndCorner();Se(O.row,H.row,D=>{Se(O.col,H.col,X=>{this.getCellMeta(D,X).readOnly||v.push([D,X,null])})})}),v.length>0&&this.setDataAtCell(v,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(h.lockEditor(),this._refreshBorders(null),h.unlockEditor()))},this.batchRender=function(g){this.suspendRender();const v=g();return this.resumeRender(),v},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const v=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(v,0),(!this.isExecutionSuspended()&&v===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const S=g();return this.resumeExecution(v),S},this.batch=function(g){this.suspendRender(),this.suspendExecution();const v=g();return this.resumeExecution(),this.resumeRender(),v},this.refreshDimensions=function(){if(!s.view)return;const{width:g,height:v}=s.view.getLastSize(),{width:S,height:O}=s.rootElement.getBoundingClientRect(),H=S!==g||O!==v;s.runHooks("beforeRefreshDimensions",{width:g,height:v},{width:S,height:O},H)!==!1&&((H||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(S,O),s.render()),s.runHooks("afterRefreshDimensions",{width:g,height:v},{width:S,height:O},H))},this.updateData=function(g,v){gI(g,S=>{l=S},S=>{l=S,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:v,metaManager:b,firstRun:f})},this.loadData=function(g,v){gI(g,S=>{l=S},()=>{b.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),f&&(f=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:v,metaManager:b,firstRun:f})},this.getInitialColumnCount=function(){const g=p.columns;let v=0;if(Array.isArray(g))v=g.length;else if(Tt(g))if(s.dataType==="array"){const S=this.countSourceCols();for(let O=0;O<S;O+=1)g(O)&&(v+=1)}else(s.dataType==="object"||s.dataType==="function")&&(v=l.colToPropCache.length);else if(fe(p.dataSchema)){const S=l.getSchema();v=Array.isArray(S)?S.length:bC(S)}else v=this.countSourceCols();return v},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,v,S,O){return _t(g)?l.getAll():l.getRange(s._createCellCoords(g,v),s._createCellCoords(S,O),l.DESTINATION_RENDERER)},this.getCopyableText=function(g,v,S,O){return l.getCopyableText(s._createCellCoords(g,v),s._createCellCoords(S,O))},this.getCopyableData=function(g,v){return l.getCopyable(g,l.colToProp(v))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(g){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const S=(f?s.loadData:s.updateData).bind(this);let O=!1,H,D;if(fe(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(fe(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(fe(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(H in g)H==="data"||(H==="language"?W(g.language):H==="className"?B("className",g.className):H==="tableClassName"&&s.table?(B("tableClassName",g.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):we.getSingleton().isRegistered(H)||we.getSingleton().isDeprecated(H)?(Tt(g[H])||Array.isArray(g[H]))&&(g[H].initialHook=!0,s.addHook(H,g[H])):!v&&Bt(g,H)&&(w[H]=g[H]));g.data===void 0&&p.data===void 0?S(null,"updateSettings"):g.data!==void 0?S(g.data,"updateSettings"):g.columns!==void 0&&(l.createMap(),s.initIndexMappers());const X=s.countCols(),G=p.columns;if(G&&Tt(G)&&(O=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&b.clearCache(),X>0)for(H=0,D=0;H<X;H++){if(G){const q=O?G(H):G[D];q&&b.updateColumnMeta(D,q)}D+=1}fe(g.cell)&&Ke(g.cell,q=>{s.setCellMetaObject(q.row,q.col,q)}),s.runHooks("afterCellMetaReset");let se=s.rootElement.style.height;se!==""&&(se=parseInt(s.rootElement.style.height,10));let re=g.height;if(Tt(re)&&(re=re()),v&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),re===null){const q=s.rootElement.getAttribute("data-initialstyle");q&&(q.indexOf("height")>-1||q.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",q):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else re!==void 0&&(s.rootElement.style.height=isNaN(re)?`${re}`:`${re}px`,s.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let q=g.width;Tt(q)&&(q=q()),s.rootElement.style.width=isNaN(q)?`${q}`:`${q}px`}v||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",g)),c.adjustRowsAndCols(),s.view&&!f&&(s.forceFullRender=!0,h.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),h.unlockEditor()),!v&&s.view&&(se===""||re===""||re===void 0)&&se!==re&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=s.getSelectedLast();if(p.getValue){if(Tt(p.getValue))return p.getValue.call(s);if(g)return s.getData()[g[0][0]][p.getValue]}else if(g)return s.getDataAtCell(g[0],g[1])},this.getSettings=function(){return p},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,v,S,O,H){c.alter(g,v,S,O,H)},this.getCell=function(g,v){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=v,H=g;if(v>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(v)))return null;O=this.columnIndexMapper.getRenderableFromVisualIndex(v)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;H=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return H===null||O===null?null:s.view.getCellAtCoords(s._createCellCoords(H,O),S)},this.getCoords=function(g){const v=this.view._wt.wtTable.getCoords(g);if(v===null)return null;const{row:S,col:O}=v;let H=S,D=O;return S>=0&&(H=this.rowIndexMapper.getVisualFromRenderableIndex(S)),O>=0&&(D=this.columnIndexMapper.getVisualFromRenderableIndex(O)),s._createCellCoords(H,D)},this.colToProp=function(g){return l.colToProp(g)},this.propToCol=function(g){return l.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,v){return l.get(g,l.colToProp(v))},this.getDataAtRowProp=function(g,v){return l.get(g,v)},this.getDataAtCol=function(g){const v=[],S=l.getRange(s._createCellCoords(0,g),s._createCellCoords(p.data.length-1,g),l.DESTINATION_RENDERER);for(let O=0;O<S.length;O+=1)for(let H=0;H<S[O].length;H+=1)v.push(S[O][H]);return v},this.getDataAtProp=function(g){const v=[],S=l.getRange(s._createCellCoords(0,l.propToCol(g)),s._createCellCoords(p.data.length-1,l.propToCol(g)),l.DESTINATION_RENDERER);for(let O=0;O<S.length;O+=1)for(let H=0;H<S[O].length;H+=1)v.push(S[O][H]);return v},this.getSourceData=function(g,v,S,O){let H;return g===void 0?H=u.getData():H=u.getByRange(s._createCellCoords(g,v),s._createCellCoords(S,O)),H},this.getSourceDataArray=function(g,v,S,O){let H;return g===void 0?H=u.getData(!0):H=u.getByRange(s._createCellCoords(g,v),s._createCellCoords(S,O),!0),H},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,v,S,O){const H=he(g,v,S),D=this.hasHook("afterSetSourceDataAtCell"),X=[];D&&M(H,se=>{let[re,q,Ee]=se;X.push([re,q,u.getAtCell(re,q),Ee])}),M(H,se=>{let[re,q,Ee]=se;u.setAtCell(re,q,Ee)}),D&&this.runHooks("afterSetSourceDataAtCell",X,O),this.render();const G=s.getActiveEditor();G&&fe(G.refreshValue)&&G.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,v){return u.getAtCell(g,v)},this.getDataAtRow=function(g){return l.getRange(s._createCellCoords(g,0),s._createCellCoords(g,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,v,S,O){const H=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,v,S,O],[D,X]=H;let[,,G,se]=H,re=null,q=null;G===void 0&&(G=D),se===void 0&&(se=X);let Ee="mixed";return Se(Math.max(Math.min(D,G),0),Math.max(D,G),De=>{let Ie=!0;return Se(Math.max(Math.min(X,se),0),Math.max(X,se),Le=>(q=this.getCellMeta(De,Le).type,re?Ie=re===q:re=q,Ie)),Ee=Ie?q:"mixed",Ie}),Ee},this.removeCellMeta=function(g,v,S){const[O,H]=[this.toPhysicalRow(g),this.toPhysicalColumn(v)];let D=b.getCellMetaKeyValue(O,H,S);s.runHooks("beforeRemoveCellMeta",g,v,S,D)!==!1&&(b.removeCellMeta(O,H,S),s.runHooks("afterRemoveCellMeta",g,v,S,D)),D=null},this.spliceCellsMeta=function(g){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var S=arguments.length,O=new Array(S>2?S-2:0),H=2;H<S;H++)O[H-2]=arguments[H];if(O.length>0&&!Array.isArray(O[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");v>0&&b.removeRow(this.toPhysicalRow(g),v),O.length>0&&M(O.reverse(),D=>{b.createRow(this.toPhysicalRow(g)),M(D,(X,G)=>this.setCellMetaObject(g,G,X))}),s.render()},this.setCellMetaObject=function(g,v,S){typeof S=="object"&&Ke(S,(O,H)=>{this.setCellMeta(g,v,H,O)})},this.setCellMeta=function(g,v,S,O){if(s.runHooks("beforeSetCellMeta",g,v,S,O)===!1)return;let D=g,X=v;g<this.countRows()&&(D=this.toPhysicalRow(g)),v<this.countCols()&&(X=this.toPhysicalColumn(v)),b.setCellMeta(D,X,S,O),s.runHooks("afterSetCellMeta",g,v,S,O)},this.getCellsMeta=function(){return b.getCellsMeta()},this.getCellMeta=function(g,v){let S=this.toPhysicalRow(g),O=this.toPhysicalColumn(v);return S===null&&(S=g),O===null&&(O=v),b.getCellMeta(S,O,{visualRow:g,visualColumn:v})},this.getCellMetaAtRow=function(g){return b.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||p.columns)},this.getCellRenderer=function(g,v){const S=typeof g=="number"?s.getCellMeta(g,v).renderer:g.renderer;return typeof S=="string"?qw(S):_t(S)?qw("text"):S},this.getCellEditor=function(g,v){const S=typeof g=="number"?s.getCellMeta(g,v).editor:g.editor;return typeof S=="string"?Yw(S):_t(S)?Yw("text"):S},this.getCellValidator=function(g,v){const S=typeof g=="number"?s.getCellMeta(g,v).validator:g.validator;return typeof S=="string"?Y1(S):S},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,v){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(v,g)},this.validateColumns=function(g,v){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(v,void 0,g)},this._validateCells=function(g,v,S){const O=new U;g&&(O.onQueueEmpty=g);let H=s.countRows()-1;for(;H>=0;){if(v!==void 0&&v.indexOf(H)===-1){H-=1;continue}let D=s.countCols()-1;for(;D>=0;){if(S!==void 0&&S.indexOf(D)===-1){D-=1;continue}O.addValidatorToQueue(),s.validateCell(s.getDataAtCell(H,D),s.getCellMeta(H,D),X=>{if(typeof X!="boolean")throw new Error("Validation error: result is not boolean");X===!1&&(O.valid=!1),O.removeValidatorFormQueue()},"validateCells"),D-=1}H-=1}O.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let v=p.rowHeaders,S=g;return S!==void 0&&(S=s.runHooks("modifyRowHeader",S)),S===void 0?(v=[],Se(s.countRows()-1,O=>{v.push(s.getRowHeader(O))})):Array.isArray(v)&&v[S]!==void 0?v=v[S]:Tt(v)?v=v(S):v&&typeof v!="string"&&typeof v!="number"&&(v=S+1),v},this.hasRowHeaders=function(){return!!p.rowHeaders},this.hasColHeaders=function(){if(p.colHeaders!==void 0&&p.colHeaders!==null)return!!p.colHeaders;for(let g=0,v=s.countCols();g<v;g++)if(s.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const S=s.runHooks("modifyColHeader",g);if(S===void 0){const G=[],se=s.countCols();for(let re=0;re<se;re++)G.push(s.getColHeader(re));return G}let O=p.colHeaders;const H=function(G){const se=[],re=s.countCols();let q=0;for(;q<re;q++)Tt(p.columns)&&p.columns(q)&&se.push(q);return se[G]},D=s.toPhysicalColumn(S),X=H(D);return p.colHeaders===!1?O=null:p.columns&&Tt(p.columns)&&p.columns(X)&&p.columns(X).title?O=p.columns(X).title:p.columns&&p.columns[D]&&p.columns[D].title?O=p.columns[D].title:Array.isArray(p.colHeaders)&&p.colHeaders[D]!==void 0?O=p.colHeaders[D]:Tt(p.colHeaders)?O=p.colHeaders(D):p.colHeaders&&typeof p.colHeaders!="string"&&typeof p.colHeaders!="number"&&(O=xC(S)),O=s.runHooks("modifyColumnHeaderValue",O,g,v),O},this._getColWidthFromSettings=function(g){let v;if(g>=0&&(v=s.getCellMeta(0,g).width),(v===void 0||v===p.width)&&(v=p.colWidths),v!=null){switch(typeof v){case"object":v=v[g];break;case"function":v=v(g);break}typeof v=="string"&&(v=parseInt(v,10))}return v},this.getColWidth=function(g){let v=s._getColWidthFromSettings(g);return v=s.runHooks("modifyColWidth",v,g),v===void 0&&(v=Sg.DEFAULT_WIDTH),v},this._getRowHeightFromSettings=function(g){let v=p.rowHeights;if(v!=null){switch(typeof v){case"object":v=v[g];break;case"function":v=v(g);break}typeof v=="string"&&(v=parseInt(v,10))}return v},this.getRowHeight=function(g){let v=s._getRowHeightFromSettings(g);return v=s.runHooks("modifyRowHeight",v,g),v},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const g=p.maxCols,v=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,v)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return Xw(s.countRows()-1,S=>{if(s.isEmptyRow(S))v+=1;else if(g===!0)return!1}),v},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return Xw(s.countCols()-1,S=>{if(s.isEmptyCol(S))v+=1;else if(g===!0)return!1}),v},this.isEmptyRow=function(g){return p.isEmptyRow.call(s,g)},this.isEmptyCol=function(g){return p.isEmptyCol.call(s,g)},this.selectCell=function(g,v,S,O){let H=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,D=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return _t(g)||_t(v)?!1:this.selectCells([[g,v,S,O]],H,D)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;v===!1&&(o=!0);const O=x.selectCells(g);return O&&S&&s.listen(),o=!1,O},this.selectColumns=function(g){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,S=arguments.length>2?arguments[2]:void 0;return x.selectColumns(g,v,S)},this.selectRows=function(g){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,S=arguments.length>2?arguments[2]:void 0;return x.selectRows(g,v,S)},this.deselectCell=function(){x.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,S=arguments.length>2?arguments[2]:void 0;o=!0,x.selectAll(g,v,S),o=!1};const Ue=(g,v)=>g.getNearestNotHiddenIndex(v,1,!0);this.scrollViewportTo=function(g){var v;if(typeof g=="number"){var S;g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(S=arguments[4])!==null&&S!==void 0?S:!0}}const{row:O,col:H,verticalSnap:D,horizontalSnap:X,considerHiddenIndexes:G}=(v=g)!==null&&v!==void 0?v:{};let se,re,q,Ee;D!==void 0&&(se=D==="top",re=!se),X!==void 0&&(q=X==="start",Ee=!q);let De=O,Ie=H;if(G===void 0||G){const ft=Number.isInteger(O)&&O>=0,Ge=Number.isInteger(H)&&H>=0,Ne=ft?Ue(this.rowIndexMapper,O):void 0,$e=Ge?Ue(this.columnIndexMapper,H):void 0;if(Ne===null||$e===null)return!1;De=ft?s.rowIndexMapper.getRenderableFromVisualIndex(Ne):O,Ie=Ge?s.columnIndexMapper.getRenderableFromVisualIndex($e):H}const Le=Number.isInteger(De),K=Number.isInteger(Ie);return Le&&De>=0&&K&&Ie>=0?s.view.scrollViewport(s._createCellCoords(De,Ie),se,Ee,re,q):Le&&De>=0&&(K&&Ie<0||!K)?s.view.scrollViewportVertically(De,se,re):K&&Ie>=0&&(Le&&De<0||!Le)?s.view.scrollViewportHorizontally(Ie,Ee,q):!1},this.scrollToFocusedCell=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",g);const{highlight:v}=this.getSelectedRangeLast();this.scrollViewportTo(v.toObject())?this.view.render():(this.removeHook("afterScroll",g),this._registerImmediate(()=>g()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),b.clearCache(),jS.delete(this.guid),Yp(s)){const g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}ho(s.rootElement),a.destroy(),h&&h.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),y.getItems().forEach(g=>{let[,v]=g;v.destroy()}),y.clear(),s.runHooks("afterDestroy")},!0),we.getSingleton().destroy(s),Ke(s,(g,v,S)=>{Tt(g)?S[v]=ke(v):v!=="guid"&&(S[v]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,x=null,h=null,s=null};function ke(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getPlugin=function(g){const v=er(g);return v==="UndoRedo"?this.undoRedo:y.getItem(v)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:y.getId(g)},this.getInstance=function(){return s},this.addHook=function(g,v){we.getSingleton().add(g,v,s)},this.hasHook=function(g){return we.getSingleton().has(g,s)||we.getSingleton().has(g)},this.addHookOnce=function(g,v){we.getSingleton().once(g,v,s)},this.removeHook=function(g,v){we.getSingleton().remove(g,v,s)},this.runHooks=function(g,v,S,O,H,D,X){return we.getSingleton().run(s,g,v,S,O,H,D,X)},this.getTranslatedPhrase=function(g,v){return jB(p.language,g,v)},this.toHTML=()=>YR(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",YR(this)),g.firstElementChild},this.timeouts=[],this._registerTimeout=function(g){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,S=g;typeof S=="function"&&(S=setTimeout(S,v)),this.timeouts.push(S)},this._clearTimeouts=function(){M(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){M(this.immediates,g=>{clearImmediate(g)})},this._refreshBorders=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.destroyEditor(g),s.view.render(),v&&x.isSelected()&&h.prepareEditor()},this._getEditorManager=function(){return h},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const Y=Sse({handleEvent(){return s.isListening()},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&Y.releasePressedKeys()}),this.getShortcutManager=function(){return Y},this.getFocusManager=function(){return d},G1().forEach(g=>{const v=yg(g);y.addItem(g,new v(this))}),hse(s),Y.setActiveContextName("grid"),we.getSingleton().run(s,"construct")}const bse="hooksRefRegisterer",cU={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){M(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ke(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Qo(cU,"MIXIN_NAME",bse,{writable:!1,enumerable:!1});const Rse=cU;function Vi(t,e,n){return e=Ese(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ese(t){var e=Tse(t,"string");return typeof e=="symbol"?e:String(e)}function Tse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _se="base",gn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),hE="baseEditor";class Th{static get EDITOR_TYPE(){return _se}constructor(e){Vi(this,"hot",void 0),Vi(this,"state",gn.VIRGIN),Vi(this,"_opened",!1),Vi(this,"_fullEditMode",!1),Vi(this,"_closeCallback",null),Vi(this,"TD",null),Vi(this,"row",null),Vi(this,"col",null),Vi(this,"prop",null),Vi(this,"originalValue",null),Vi(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=gn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const h=this.hot.getSelectedLast();r=Math.max(Math.min(h[0],h[2]),0),i=Math.max(Math.min(h[1],h[3]),0),o=Math.max(h[0],h[2]),s=Math.max(h[1],h[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>fe(this.hot.getSelected()),group:hE};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==gn.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=gn.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Zt(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(hE),s.removeShortcutsByGroup(TC),this.state===gn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===gn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=gn.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=gn.FINISHED,this.discardEditor(l)}):(this.state=gn.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=gn.FINISHED,this.discardEditor()}discardEditor(e){this.state===gn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=gn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=gn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===gn.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=yn(n),a=vt(n),l=yn(this.hot.rootElement),u=vt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,m=o.innerWidth-l.left-u,{wtTable:C}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,b=C.name,p=["master","inline_start"].includes(b)?d:0,w=["master","top","bottom"].includes(b)?f:0,y=s.top===l.top?0:1;let E=s.top-l.top-y-p,T=0;this.hot.isRtl()?T=o.innerWidth-s.left-a-m-1+w:T=s.left-l.left-1-w,["top","top_inline_start_corner"].includes(b)&&(E+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(T+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const x=this.hot.hasColHeaders(),A=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),W=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),U=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(x&&A<=0||A===U)&&(E+=1),W<=0&&(T+=1);const Q=i.rowsRenderCalculator.startPosition,te=i.columnsRenderCalculator.startPosition,ee=Math.abs(r.inlineStartOverlay.getScrollPosition()),he=r.topOverlay.getScrollPosition(),_e=Rn(this.hot.rootDocument);let Ue=n.offsetTop;if(["inline_start","master"].includes(b)&&(Ue+=Q-he),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:re,wtTable:q}=r.bottomOverlay.clone;Ue+=re.getWorkspaceHeight()-q.getHeight()-_e}let ke=n.offsetLeft;this.hot.isRtl()?(ke>=0?ke=C.getWidth()-n.offsetLeft:ke=Math.abs(ke),ke+=te-ee-a):["top","master","bottom"].includes(b)&&(ke+=te-ee);const Y=Fs(this.TD,this.hot.rootWindow),g=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",v=parseInt(Y[g],10)>0?0:1,S=parseInt(Y.borderTopWidth,10)>0?0:1,O=vt(n)+v,H=Ut(n)+S,D=v2(c)?_e:0,X=C2(h)?_e:0,G=this.hot.view.maximumVisibleElementWidth(ke)-D+v,se=Math.max(this.hot.view.maximumVisibleElementHeight(Ue)-X+S,23);return{top:E,start:T,height:H,maxHeight:se,width:O,maxWidth:G}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}bt(Th,Rse);function CI(t,e,n){t.addEventListener(e,n,!1)}function yI(t,e,n){t.removeEventListener(e,n,!1)}function SI(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function Mse(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,r=t.createTextNode(""),i=t.createElement("span");let o;function s(){r.textContent=o.value,i.style.position="absolute",i.style.fontSize=SI(o).fontSize,i.style.fontFamily=SI(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const c=i.clientWidth+2;n.removeChild(i);const h=o.style;h.height=`${e.minHeight}px`,e.minWidth>c?h.width=`${e.minWidth}px`:c>e.maxWidth?h.width=`${e.maxWidth}px`:h.width=`${c}px`;const d=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>d?h.height=`${e.minHeight}px`:e.maxHeight<d?(h.height=`${e.maxHeight}px`,h.overflowY="visible"):h.height=`${d}px`}function a(){t.defaultView.setTimeout(s,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=o.clientHeight;else{const h=parseInt(c.minHeight,10);isNaN(h)||(e.minHeight=h)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{const h=parseInt(c.maxHeight,10);isNaN(h)||(e.maxHeight=h)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=o.clientWidth;else{const h=parseInt(c.minWidth,10);isNaN(h)||(e.minWidth=h)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{const h=parseInt(c.maxWidth,10);isNaN(h)||(e.maxWidth=h)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function u(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=c,l(h),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.overflowY="",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),d&&(CI(o,"input",s),CI(o,"keydown",a)),s()}return{init:u,resize:s,unObserve(){yI(o,"input",s),yI(o,"keydown",a)}}}function bI(t,e){const n=A1(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}pg(e,i)}function Sl(t,e,n){return e=xse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xse(t){var e=Pse(t,"string");return typeof e=="symbol"?e:String(e)}function Pse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ose="ht_editor_visible",Hm="ht_editor_hidden",RI="textEditor",Ase="text";class Tu extends Th{static get EDITOR_TYPE(){return Ase}constructor(e){super(e),Sl(this,"eventManager",new Oi(this)),Sl(this,"autoResize",Mse(this.hot.rootDocument)),Sl(this,"TEXTAREA",void 0),Sl(this,"textareaStyle",void 0),Sl(this,"TEXTAREA_PARENT",void 0),Sl(this,"textareaParentStyle",void 0),Sl(this,"layerClass",void 0),this.eventManager=new Oi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),h2(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==gn.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===gn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),pg(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Pe(this.TEXTAREA,[["data-hot-input",""],Sh(-1)]),this.hot.getSettings().ariaTags&&Pe(this.TEXTAREA,[Gs()]),J(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),J(this.TEXTAREA_PARENT,"handsontableInputHolder"),He(this.TEXTAREA_PARENT,this.layerClass)&&We(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,Hm),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){N2()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",We(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,Hm)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;Se(e.length-1,r=>{const i=e[r];if(He(i,"handsontableEditor"))return n=!0,!1}),He(this.TEXTAREA_PARENT,Hm)&&We(this.TEXTAREA_PARENT,Hm),n?(this.layerClass=Ose,J(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),J(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==gn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=Fs(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=Fs(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),d=i-c,f=s-h,m=o-c,C=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,m),minHeight:Math.min(f,C),maxWidth:m,maxHeight:C},!0)}bindEvents(){F1()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===gn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===gn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={runOnlyIf:()=>fe(this.hot.getSelected()),group:RI},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:r,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[l]=a;bI(l,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[l]=a;bI(l,this.TEXTAREA)}}],i)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(TC),n.removeShortcutsByGroup(RI),n.removeShortcutsByGroup(hE)}}const Ise="base";function Tg(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&J(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(oA())):a&&c.push(oA()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(sA())):(u.push(s.invalidCellClassName),a&&c.push(sA()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),We(e,u),J(e,l),bu(e,c),Pe(e,h)}Tg.RENDERER_TYPE=Ise;const Hse="text";function qs(t,e,n,r,i,o,s){Tg.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Zt(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){ho(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else Qa(e,a)}qs.RENDERER_TYPE=Hse;const Dse="text",hU={CELL_TYPE:Dse,editor:Tu,renderer:qs};gi(hU);le.editors={BaseEditor:Th};function le(t,e){const n=new uU(t,e||{},h_);return n.init(),n}le.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new uU(t,e,h_)};le.DefaultSettings=nU();le.hooks=we.getSingleton();le.CellCoords=Zw;le.CellRange=X1;le.packageName="handsontable";le.buildDate="16/01/2024 10:27:23";le.version="14.1.0";le.languages={dictionaryKeys:Zre,getLanguageDictionary:zB,getLanguagesDictionaries:rie,registerLanguageDictionary:UB,getTranslatedPhrase:jB};function Yf(t,e,n){return e=rv(e),Wse(t,dU()?Reflect.construct(e,n||[],rv(t).constructor):e.apply(t,n))}function dU(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dU=function(){return!!t})()}function EI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Nse(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?EI(Object(n),!0).forEach(function(r){Lse(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):EI(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function kse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fU(t){var e=kse(t,"string");return typeof e=="symbol"?e:String(e)}function Kf(t){"@babel/helpers - typeof";return Kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kf(t)}function ch(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,fU(r.key),r)}}function hh(t,e,n){return e&&TI(t.prototype,e),n&&TI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Lse(t,e,n){return e=fU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xf(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dE(t,e)}function rv(t){return rv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},rv(t)}function dE(t,e){return dE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},dE(t,e)}function $se(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function Fse(t,e){if(t==null)return{};var n=$se(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function gU(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wse(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gU(t)}function Vse(t){return Bse(t)||Use(t)||zse(t)||jse()}function Bse(t){if(Array.isArray(t))return fE(t)}function Use(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function zse(t,e){if(t){if(typeof t=="string")return fE(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fE(t,e)}}function fE(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function jse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var GS=null,Gse="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",Yse="The Handsontable instance bound to this component was destroyed and cannot be used properly.",iv="global",Kse="hot-wrapper-editor-container";function Xse(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function gE(t,e){var n=Wt.Children.toArray(t),r=Wt.Children.count(t),i=null;return r!==0&&(r===1&&n[0].props[e]?i=n[0]:i=n.find(function(o){return o.props[e]!==void 0})),i||null}function mU(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function pU(t,e){if(typeof t>"u"||e===null)return null;var n=vU(e.props,!1);return n.className="".concat(Kse," ").concat(n.className),vW.createPortal(Wt.createElement("div",Object.assign({},n),e),t.body)}function wU(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:iv,r=gE(t,"hot-editor"),i=mU(r);return r?Wt.cloneElement(r,{emitEditorInstance:function(s,a){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(a??iv,s)},editorColumnScope:n,isEditor:!0}):null}function qse(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;n||(n=document),GS||(GS=n.createDocumentFragment());var r=n.createElement("DIV");GS.appendChild(r);var i=Wt.cloneElement(t,Nse({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:vW.createPortal(i,r,"".concat(e.row,"-").concat(e.col,"-").concat(Math.random())),portalContainer:r}}function vU(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function Qse(){return typeof window<"u"}var CU=function(){function t(){ch(this,t)}return hh(t,null,[{key:"getSettings",value:function(n){var r={};if(n.settings){var i=n.settings;for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])}for(var s in n)s!=="settings"&&s!=="children"&&n.hasOwnProperty(s)&&(r[s]=n[s]);return r}}]),t}(),fa=function(t){Xf(e,t);function e(){return ch(this,e),Yf(this,e,arguments)}return hh(e,[{key:"getSettingsProps",value:function(){var r=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(i){return!r.internalProps.includes(i)}).reduce(function(i,o){return i[o]=r.props[o],i},{})}},{key:"getLocalEditorElement",value:function(){return wU(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var r=this.props._getChildElementByType(this.props.children,"hot-renderer"),i=this.getLocalEditorElement();this.columnSettings=CU.getSettings(this.getSettingsProps()),r!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(r),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),i!==null&&(this.columnSettings.editor=this.props._getEditorClass(i,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var r=this.props._getOwnerDocument(),i=pU(r,this.getLocalEditorElement());return Wt.createElement(Wt.Fragment,null,i)}}]),e}(Wt.Component),Zse=function(t){Xf(e,t);function e(){var n;return ch(this,e),n=Yf(this,e,arguments),n.state={portals:[]},n}return hh(e,[{key:"render",value:function(){return Wt.createElement(Wt.Fragment,null,this.state.portals)}}]),e}(Wt.Component),Jse="14.1.0";function GM(t,e){return e={exports:{}},t(e,e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var In=typeof Symbol=="function"&&Symbol.for,YM=In?Symbol.for("react.element"):60103,KM=In?Symbol.for("react.portal"):60106,kC=In?Symbol.for("react.fragment"):60107,LC=In?Symbol.for("react.strict_mode"):60108,$C=In?Symbol.for("react.profiler"):60114,FC=In?Symbol.for("react.provider"):60109,WC=In?Symbol.for("react.context"):60110,XM=In?Symbol.for("react.async_mode"):60111,VC=In?Symbol.for("react.concurrent_mode"):60111,BC=In?Symbol.for("react.forward_ref"):60112,UC=In?Symbol.for("react.suspense"):60113,eae=In?Symbol.for("react.suspense_list"):60120,zC=In?Symbol.for("react.memo"):60115,jC=In?Symbol.for("react.lazy"):60116,tae=In?Symbol.for("react.block"):60121,nae=In?Symbol.for("react.fundamental"):60117,rae=In?Symbol.for("react.responder"):60118,iae=In?Symbol.for("react.scope"):60119;function ui(t){if(Kf(t)==="object"&&t!==null){var e=t.$$typeof;switch(e){case YM:switch(t=t.type,t){case XM:case VC:case kC:case $C:case LC:case UC:return t;default:switch(t=t&&t.$$typeof,t){case WC:case BC:case jC:case zC:case FC:return t;default:return e}}case KM:return e}}}function yU(t){return ui(t)===VC}var oae=XM,sae=VC,aae=WC,lae=FC,uae=YM,cae=BC,hae=kC,dae=jC,fae=zC,gae=KM,mae=$C,pae=LC,wae=UC,vae=function(e){return yU(e)||ui(e)===XM},Cae=yU,yae=function(e){return ui(e)===WC},Sae=function(e){return ui(e)===FC},bae=function(e){return Kf(e)==="object"&&e!==null&&e.$$typeof===YM},Rae=function(e){return ui(e)===BC},Eae=function(e){return ui(e)===kC},Tae=function(e){return ui(e)===jC},_ae=function(e){return ui(e)===zC},Mae=function(e){return ui(e)===KM},xae=function(e){return ui(e)===$C},Pae=function(e){return ui(e)===LC},Oae=function(e){return ui(e)===UC},Aae=function(e){return typeof e=="string"||typeof e=="function"||e===kC||e===VC||e===$C||e===LC||e===UC||e===eae||Kf(e)==="object"&&e!==null&&(e.$$typeof===jC||e.$$typeof===zC||e.$$typeof===FC||e.$$typeof===WC||e.$$typeof===BC||e.$$typeof===nae||e.$$typeof===rae||e.$$typeof===iae||e.$$typeof===tae)},Iae=ui,Hae={AsyncMode:oae,ConcurrentMode:sae,ContextConsumer:aae,ContextProvider:lae,Element:uae,ForwardRef:cae,Fragment:hae,Lazy:dae,Memo:fae,Portal:gae,Profiler:mae,StrictMode:pae,Suspense:wae,isAsyncMode:vae,isConcurrentMode:Cae,isContextConsumer:yae,isContextProvider:Sae,isElement:bae,isForwardRef:Rae,isFragment:Eae,isLazy:Tae,isMemo:_ae,isPortal:Mae,isProfiler:xae,isStrictMode:Pae,isSuspense:Oae,isValidElementType:Aae,typeOf:Iae},Rt=GM(function(t,e){});Rt.AsyncMode;Rt.ConcurrentMode;Rt.ContextConsumer;Rt.ContextProvider;Rt.Element;Rt.ForwardRef;Rt.Fragment;Rt.Lazy;Rt.Memo;Rt.Portal;Rt.Profiler;Rt.StrictMode;Rt.Suspense;Rt.isAsyncMode;Rt.isConcurrentMode;Rt.isContextConsumer;Rt.isContextProvider;Rt.isElement;Rt.isForwardRef;Rt.isFragment;Rt.isLazy;Rt.isMemo;Rt.isPortal;Rt.isProfiler;Rt.isStrictMode;Rt.isSuspense;Rt.isValidElementType;Rt.typeOf;GM(function(t){t.exports=Hae});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var _I=Object.getOwnPropertySymbols,Dae=Object.prototype.hasOwnProperty,Nae=Object.prototype.propertyIsEnumerable;function kae(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function Lae(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(e).map(function(o){return e[o]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(o){i[o]=o}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}Lae();var $ae="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Fae=$ae;Function.call.bind(Object.prototype.hasOwnProperty);function SU(){}function bU(){}bU.resetWarningCache=SU;var Wae=function(){function e(i,o,s,a,l,u){if(u!==Fae){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function n(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:n,element:e,elementType:e,instanceOf:n,node:e,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:bU,resetWarningCache:SU};return r.PropTypes=r,r},Vae=GM(function(t){t.exports=Wae()}),YS=Vae,qM=function(t){Xf(e,t);function e(){var n;return ch(this,e),n=Yf(this,e,arguments),n.id=null,n.__hotInstance=null,n.hotElementRef=null,n.columnSettings=[],n.renderersPortalManager=null,n.portalCacheArray=[],n.renderedCellCache=new Map,n.editorCache=new Map,n.componentRendererColumns=new Map,n}return hh(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(Yse),null)},set:function(r){this.__hotInstance=r}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return Qse()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(r){this.hotElementRef=r}},{key:"getRendererWrapper",value:function(r){var i=this;return function(o,s,a,l,u,c,h){var d=i.getRenderedCellCache();if(d.has("".concat(a,"-").concat(l))&&(s.innerHTML=d.get("".concat(a,"-").concat(l)).innerHTML),s&&!s.getAttribute("ghost-table")){for(var f=qse(r,{TD:s,row:a,col:l,prop:u,value:c,cellProperties:h,isRenderer:!0},s.ownerDocument),m=f.portal,C=f.portalContainer;s.firstChild;)s.removeChild(s.firstChild);s.appendChild(C),i.portalCacheArray.push(m)}return d.set("".concat(a,"-").concat(l),s),s}}},{key:"getEditorClass",value:function(r){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iv,s=mU(r),a=(i=this.getEditorCache().get(s))===null||i===void 0?void 0:i.get(o);return this.makeEditorClass(a)}},{key:"makeEditorClass",value:function(r){var i=function(o){Xf(s,o);function s(a){var l;return ch(this,s),l=Yf(this,s,[a]),r.hotCustomEditorInstance=gU(l),l.editorComponent=r,l}return hh(s,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),s}(le.editors.BaseEditor);return Object.getOwnPropertyNames(le.editors.BaseEditor.prototype).forEach(function(o){o!=="constructor"&&(i.prototype[o]=function(){for(var s,a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return(s=r[o]).call.apply(s,[r].concat(l))})}),i}},{key:"getGlobalRendererElement",value:function(){return gE(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return wU(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var r=CU.getSettings(this.props),i=this.getGlobalRendererElement(),o=this.getGlobalEditorElement();return r.columns=this.columnSettings.length?this.columnSettings:r.columns,o?r.editor=this.getEditorClass(o,iv):r.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),i?(r.renderer=this.getRendererWrapper(i),this.componentRendererColumns.set("global",!0)):r.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),r}},{key:"displayAutoSizeWarning",value:function(r){var i,o;this.hotInstance&&((i=this.hotInstance.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.enabled||(o=this.hotInstance.getPlugin("autoColumnSize"))!==null&&o!==void 0&&o.enabled)&&this.componentRendererColumns.size>0&&Xse(Gse)}},{key:"setHotColumnSettings",value:function(r,i){this.columnSettings[i]=r}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var r=this;this.renderersPortalManager.setState({portals:Vse(this.portalCacheArray)},function(){r.portalCacheArray=[]})}},{key:"updateHot",value:function(r){this.hotInstance&&this.hotInstance.updateSettings(r,!1)}},{key:"setRenderersPortalManagerRef",value:function(r){this.renderersPortalManager=r}},{key:"componentDidMount",value:function(){var r=this,i=this.createNewGlobalSettings();this.hotInstance=new le.Core(this.hotElementRef,i),this.hotInstance.addHook("beforeViewRender",function(){return r.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return r.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(i)}},{key:"componentDidUpdate",value:function(){this.clearCache();var r=this.createNewGlobalSettings();this.updateHot(r),this.displayAutoSizeWarning(r)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var r=this,i=function(c){return c.type===fa},o=Wt.Children.toArray(this.props.children),s=o.filter(function(u){return i(u)}).map(function(u,c){return Wt.cloneElement(u,{_componentRendererColumns:r.componentRendererColumns,_emitColumnSettings:r.setHotColumnSettings.bind(r),_columnIndex:c,_getChildElementByType:gE.bind(r),_getRendererWrapper:r.getRendererWrapper.bind(r),_getEditorClass:r.getEditorClass.bind(r),_getOwnerDocument:r.getOwnerDocument.bind(r),_getEditorCache:r.getEditorCache.bind(r),children:u.props.children})}),a=vU(this.props),l=pU(this.getOwnerDocument(),this.getGlobalEditorElement());return Wt.createElement(Wt.Fragment,null,Wt.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},a),s),Wt.createElement(Zse,{ref:this.setRenderersPortalManagerRef.bind(this)}),l)}}],[{key:"version",get:function(){return Jse}}]),e}(Wt.Component);qM.propTypes={style:YS.object,id:YS.string,className:YS.string};var Bae=["children"],RU=Wt.forwardRef(function(t,e){var n,r=t.children,i=Fse(t,Bae),o=typeof Wt.useId=="function"?Wt.useId():void 0,s=(n=i.id)!==null&&n!==void 0?n:o;return Wt.createElement(qM,Object.assign({id:s},i,{ref:e}),r)});RU.version=qM.version;Wt.Component;var QM={exports:{}};QM.exports;(function(t){(function(e,n,r){function i(l){var u=this,c=a();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function s(l,u){var c=new i(l),h=u&&u.state,d=c.next;return d.int32=function(){return c.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&o(h,c),d.state=function(){return o(c,{})}),d}function a(){var l=4022871197,u=function(c){c=String(c);for(var h=0;h<c.length;h++){l+=c.charCodeAt(h);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.alea=s})(to,t,!1)})(QM);var Uae=QM.exports,ZM={exports:{}};ZM.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor128=s})(to,t,!1)})(ZM);var zae=ZM.exports,JM={exports:{}};JM.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorwow=s})(to,t,!1)})(JM);var jae=JM.exports,ex={exports:{}};ex.exports;(function(t){(function(e,n,r){function i(a){var l=this;l.next=function(){var c=l.x,h=l.i,d,f;return d=c[h],d^=d>>>7,f=d^d<<24,d=c[h+1&7],f^=d^d>>>10,d=c[h+3&7],f^=d^d>>>3,d=c[h+4&7],f^=d^d<<7,d=c[h+7&7],d=d^d<<13,f^=d^d<<9,c[h]=f,l.i=h+1&7,f};function u(c,h){var d,f=[];if(h===(h|0))f[0]=h;else for(h=""+h,d=0;d<h.length;++d)f[d&7]=f[d&7]<<15^h.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],c.x=f,c.i=0,d=256;d>0;--d)c.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function s(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,c&&(c.x&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorshift7=s})(to,t,!1)})(ex);var Gae=ex.exports,tx={exports:{}};tx.exports;(function(t){(function(e,n,r){function i(a){var l=this;l.next=function(){var c=l.w,h=l.X,d=l.i,f,m;return l.w=c=c+1640531527|0,m=h[d+34&127],f=h[d=d+1&127],m^=m<<13,f^=f<<17,m^=m>>>15,f^=f>>>12,m=h[d]=m^f,l.i=d,m+(c^c>>>16)|0};function u(c,h){var d,f,m,C,b,p=[],w=128;for(h===(h|0)?(f=h,h=null):(h=h+"\0",f=0,w=Math.max(w,h.length)),m=0,C=-32;C<w;++C)h&&(f^=h.charCodeAt((C+32)%h.length)),C===0&&(b=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,C>=0&&(b=b+1640531527|0,d=p[C&127]^=f+b,m=d==0?m+1:0);for(m>=128&&(p[(h&&h.length||0)&127]=-1),m=127,C=4*128;C>0;--C)f=p[m+34&127],d=p[m=m+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,p[m]=f^d;c.w=b,c.X=p,c.i=m}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function s(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,c&&(c.X&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor4096=s})(to,t,!1)})(tx);var Yae=tx.exports,nx={exports:{}};nx.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.next=function(){var h=l.b,d=l.c,f=l.d,m=l.a;return h=h<<25^h>>>7^d,d=d-f|0,f=f<<24^f>>>8^m,m=m-h|0,l.b=h=h<<20^h>>>12^d,l.c=d=d-f|0,l.d=f<<16^d>>>16^m,l.a=m-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(d+f)/(1<<21);while(m===0);return m},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.tychei=s})(to,t,!1)})(nx);var Kae=nx.exports,EU={exports:{}};const Xae={},qae=Object.freeze(Object.defineProperty({__proto__:null,default:Xae},Symbol.toStringTag,{value:"Module"})),Qae=tG(qae);(function(t){(function(e,n,r){var i=256,o=6,s=52,a="random",l=r.pow(i,o),u=r.pow(2,s),c=u*2,h=i-1,d;function f(E,T,x){var A=[];T=T==!0?{entropy:!0}:T||{};var W=p(b(T.entropy?[E,y(n)]:E??w(),3),A),B=new m(A),U=function(){for(var Q=B.g(o),te=l,ee=0;Q<u;)Q=(Q+ee)*i,te*=i,ee=B.g(1);for(;Q>=c;)Q/=2,te/=2,ee>>>=1;return(Q+ee)/te};return U.int32=function(){return B.g(4)|0},U.quick=function(){return B.g(4)/4294967296},U.double=U,p(y(B.S),n),(T.pass||x||function(Q,te,ee,he){return he&&(he.S&&C(he,B),Q.state=function(){return C(B,{})}),ee?(r[a]=Q,te):Q})(U,W,"global"in T?T.global:this==r,T.state)}function m(E){var T,x=E.length,A=this,W=0,B=A.i=A.j=0,U=A.S=[];for(x||(E=[x++]);W<i;)U[W]=W++;for(W=0;W<i;W++)U[W]=U[B=h&B+E[W%x]+(T=U[W])],U[B]=T;(A.g=function(Q){for(var te,ee=0,he=A.i,_e=A.j,Ue=A.S;Q--;)te=Ue[he=h&he+1],ee=ee*i+Ue[h&(Ue[he]=Ue[_e=h&_e+te])+(Ue[_e]=te)];return A.i=he,A.j=_e,ee})(i)}function C(E,T){return T.i=E.i,T.j=E.j,T.S=E.S.slice(),T}function b(E,T){var x=[],A=typeof E,W;if(T&&A=="object")for(W in E)try{x.push(b(E[W],T-1))}catch{}return x.length?x:A=="string"?E:E+"\0"}function p(E,T){for(var x=E+"",A,W=0;W<x.length;)T[h&W]=h&(A^=T[h&W]*19)+x.charCodeAt(W++);return y(T)}function w(){try{var E;return d&&(E=d.randomBytes)?E=E(i):(E=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(E)),y(E)}catch{var T=e.navigator,x=T&&T.plugins;return[+new Date,e,x,e.screen,y(n)]}}function y(E){return String.fromCharCode.apply(0,E)}if(p(r.random(),n),t.exports){t.exports=f;try{d=Qae}catch{}}else r["seed"+a]=f})(typeof self<"u"?self:to,[],Math)})(EU);var Zae=EU.exports,Jae=Uae,ele=zae,tle=jae,nle=Gae,rle=Yae,ile=Kae,_u=Zae;_u.alea=Jae;_u.xor128=ele;_u.xorwow=tle;_u.xorshift7=nle;_u.xor4096=rle;_u.tychei=ile;var ole=_u;const TU=Av(ole);let _U=TU();function MU(){return _U()}function sle(t){_U=TU(t)}function Mu(t,e){let n=t;if(Array.isArray(t)){let r=t;e!=null&&e.maxCharCount&&typeof t[0]=="string"&&(r=t.filter(i=>i.length<=e.maxCharCount)),n=()=>xU(r)}return(e==null?void 0:e.length)===void 0?n(0):Array.from({length:e.length},(r,i)=>n(i))}function xU(t){return t[Math.floor(MU()*t.length)]}function ale({min:t=1,max:e=9999.99,fraction:n=0}={}){if(e<t)throw new Error("Max must be bigger than min");return Number((MU()*(e-t)+t).toFixed(n))}function MI(t){return Mu(()=>xU([!0,!1]),t)}function fs(t){const e={min:(t==null?void 0:t.min)??0,max:(t==null?void 0:t.max)??999999,precision:t==null?void 0:t.precision,fraction:t==null?void 0:t.fraction};return Mu(()=>{if(e.min===e.max)return e.min;const n=ale(e);return e.precision!==void 0?Math.floor(n/e.precision)*e.precision:n},t)}function lle(t){const e=new Date(t.from).getTime(),n=new Date(t.to).getTime();if(e>=n)throw new Error("From must be before to");return Mu(()=>new Date(fs({min:e,max:n})),t)}var ule=["Kautzer, Macejkovic and Fisher","Greenholt - Mosciski","Marquardt - Runolfsdottir","Abernathy Inc","Dickens - Lang","Hand, Bernhard and Kessler","Abbott LLC","Kub Inc","Johnston - Wisozk","Reichert LLC","Kohler LLC","Shanahan - Boyle","Batz - Rice","Cronin, Oberbrunner and Beier","Kuhlman, Schowalter and West","Luettgen Inc","Ward Group","Hills and Sons","Prohaska, Balistreri and Walker","Rempel - Durgan","Bernier LLC","Stehr - Lockman","Roberts, Rogahn and Dooley","Lesch - Jakubowski","Jenkins - Turcotte","Gerhold - Rowe","Block - Rau","Dickinson, Tremblay and Moore","Nader - Fritsch","Kreiger and Sons","Bartell, Wehner and Schowalter","Hegmann Inc","Orn, Spencer and Kiehn","Graham, Sipes and Towne","Hodkiewicz Inc","Mills Group","Legros, Tillman and Hodkiewicz","Lesch - Carter","Lesch Group","Kreiger - Sauer","Cartwright - Schuster","Labadie LLC","Pfannerstill, White and Mosciski","Jenkins LLC","Boehm, Hettinger and Huels","Maggio, Wisoky and Blick","Kozey Inc","Stracke - Wisozk","Olson, Olson and Carter","Orn, Gerlach and Runolfsdottir","Stracke - Kertzmann","Walker - Zieme","Hodkiewicz - Hintz","Lind Group","Fahey, Leannon and Gleichner","Mertz, Gusikowski and Lemke","Heidenreich - Aufderhar","Zboncak and Sons","Carroll Group","Brown LLC","Weber Inc","Rath LLC","Walker Inc","Heller, Hyatt and Jaskolski","Jacobi - Kutch","Skiles and Sons","Durgan - Stamm","Renner - Prosacco","Hahn - Welch","Lesch, Dooley and Bartell","Crona and Sons","Rogahn, Armstrong and Goyette","Lubowitz, Kuhlman and Bailey","Doyle Group","Dooley and Sons","Kerluke LLC","Bogan - Daniel","Hintz - Boehm","Swaniawski and Sons","Kris, Legros and Cartwright","Reichel Group","Russel - Hintz","Welch, Lockman and Hand","Pouros - Brakus","Mohr, Fritsch and Wisozk","Upton - Reichert","Koepp and Sons","Weber and Sons","Quigley, Bins and Becker","Strosin, Oberbrunner and Wunsch","Rodriguez - Spencer","Wilkinson - Dare","Gutkowski Inc","OReilly LLC","Collins, Mante and Pacocha","Steuber, Luettgen and Corkery","Kub and Sons","Lesch and Sons"];function xI(t){return Mu(ule,t)}var cle=["Argentina","Peru","Colombia","Chile","Uruguay","Gabon","Congo","Norfolk Island","Qatar","Syrian Arab Republic","Wallis and Futuna","Somalia","Saint Barthelemy","Comoros","Sri Lanka","Czech Republic","Christmas Island","Macao","Montenegro","Anguilla","Canada","Mayotte","Tajikistan","Afghanistan","Liechtenstein","Cocos (Keeling) Islands","Angola","Bahrain","Dominican Republic","Croatia","Latvia","Virgin Islands, U.S.","United Kingdom","Brazil","Spain","Mongolia","Montserrat","Estonia","Benin","Guinea","Guinea-Bissau","Greece","Lao Peoples Democratic Republic","Puerto Rico","Slovakia (Slovak Republic)","United States of America","Switzerland","Costa Rica","Mauritius","Nigeria","Russian Federation","Germany","Antigua and Barbuda","Albania","Romania","Moldova","Senegal","Tanzania","British Indian Ocean Territory (Chagos Archipelago)","Central African Republic","New Caledonia","Burundi","Panama","Azerbaijan","Namibia","French Southern Territories","Vanuatu","Ethiopia","Burkina Faso","Tunisia","Mozambique","Belarus","Saint Kitts and Nevis","Hungary","Indonesia","Cyprus","Ecuador","Saint Martin","Nauru","Faroe Islands","Iran","Bolivia","Pitcairn Islands","France","Paraguay","Isle of Man","Sierra Leone","Monaco","Belize","Trinidad and Tobago"];function hle(t){return Mu(cle,t)}var dle={china:["Peking roasted duck","Kung pao chicken","Sweet and sour pork","Hot pot","Dim sum","Dumplings","Ma po tofu","Char siu","Chicken chow mein","Beef chow mein","vegetable chow mein","Chicken fried rice","Beef fried rice","Vegetable fried Rice","Special fried Rice","Sichuan pork","Xiaolongbao","Zhajiangmian","Wonton soup","Sweet and sour pork","Duck spring Rolls","Vegetable spring Rolls","Wonton","Peking duck","Lamb hot pot","Spicy crayfish","Guilin rice noodles","Lanzhou hand-pulled noodles","Steamed crab","Shredded pork with garlic sauce","Red braised pork","Sweet and sour Ribs","Xinjiang","Braised pork with vermicelli"],italy:["Butternut squash risotto","Mushroom risotto","Beetroot risotto","Courgette risotto","Pizza","Gnocchi","Spaghetti bolognese","Spaghetti carbonara","Pesto alla Genovese","Beef lasagne","Vegetable lasagne","Gelato","Prosciutto di Parma","Ribollita","Bagna cauda","Polenta","Tortelli and ravioli","Focaccia","Garlic bread","Arancini","Il tartufo","Panzerotto fritto","Fiorentina","Minestrone","Frico","Arrosticini","Olive ascolante","Fritto misto piemontes","Tiramis"],india:["Biryani","Dosa","Tandoori chicken","Samosas","Chaat","Plain naan","Garlic naan","Pilau rice","Steamed rice","Chicken madras","Vegetable madras","Chicken vindaloo","Chicken jalfrezi","Chicken roghan josh","Lamb roghan josh","Beef roghan josh","Butter chicken","Dosa","Gulab jamun","Chicken korma","Mutter paneer","Papadum","Paratha","Raita","Saag paneer","Tandoori chicken","Chicken tikka masala","Pakora","Dal","Chapati","Pasanda","Aloo gobi","Kofta","Chicken makhani","Paneer naan","Chana Aloo Curry"],mexico:["Chilaquiles","Pozole","Tacos al pastor","Tostadas","Chiles en nogada","Elote","Enchiladas","Mole","Guacamole","Tamales","Huevos rancheros","Machaca","Discada","Beef Burrito","Chicken Burrito","Pozole de pollo o duajolote","Menudo","Cochinita pibil","Tamale","Quesadilla","Frijoles puercos","Chile en nogada","Esquites","Alegria de amaranto","Pipin","Aguachile","Ceviche","Pescado zarandeado","Camarones a la diabla","Birria de chivo","Tlayuda","Guacamole con chapulines","Flautas","Torta Ahogada","Carnitas","Caldo Azteca","Gorditas de Nata"],japan:["Sushi","Udon","Tofu","Tempura","Yakitori","Sashimi","Ramen","Donburi","Natto","Oden","Tamagoyaki","Soba","Tonkatsu","Kashipan","Sukiyaki","Miso soup","Okonomiyaki","Mentaiko","Nikujaga","Unagi no kabayaki","Shabu Shabu","Onigiri","Gyoza","Takoyaki","aiseki ryori","Edamame","Yakisoba","Chawanmushi","Wagashi"],france:["Foie gras","Hutres","Cassoulet","Poulet basquaise","Escargots au beurre persill","Mouclade charentaise","Galettes bretonnes","Flemish carbonnade","Quiche lorraine","Raclette","Cheese fondue","Beef fondue","Gratin dauphinois","Tartiflette","Bouillabaisse","Ratatouille","Boeuf bourguignon","Blanquette de veau","Pot-au-feu","Coq-au-vin","Hachis parmentier","Steak tartare","Choucroute","Souffl au fromage","Cuisses de grenouilles","Soupe  loignon","Baguette","Croissant","French cheeses","Fondant au chocolat","Tarte tatin","Macarons","Crme brle","le flottante","Profiteroles","Pain au chocolat"],lebanon:["Kibbeh","Kafta","Kanafeh","Hummus","Rice pilaf","Fattoush","Manakish","Tabbouleh","Sfeeha","Fattoush","Labneh","Muhammara","Lahm bi ajin","Kaak","Chanklich","Mssabaha","Shawarma","Kebbe","Falafel","Halewit el jeben","Namoura","Maamoul","Foul mdammas","Balila","Kawarma","Fattouch"],thailand:["Pad kra pao moo","Tom kha gai","Khao Pad","Chicken pad Thai","Vegetable pad Thai","Moo satay","Tom yum goong","Khao niew mamuang","Kai yad sai","Khao soi","Pad see ew","Laab moo","Gaeng panang","Gai pad med ma muang","Som tam","Poh pia tod","Gaeng massaman","Pla kapung nueng manao","Tod mun pla","Gaeng ped","Gaeng garee","Gaeng keow wan","Moo ping","Durian","Sai ooah","Hoy tod","Kuay teow reua","Mu kratha","Kao ka moo","Yam nua"],greece:["Moussaka","Papoutsakia","Pastitsio","Souvlaki","Soutzoukakia","Stifado","Tomatokeftedes","Tzatziki","Kolokithokeftedes","Giouvetsi","Choriatiki","Kleftiko","Gemista","Fasolada","Bougatsa","Tiropita","Spanakopita","Feta Cheese with Honey","Horta","Tirokroketes","Briam","Saganaki","Gigantes","Dolmades","Fasolatha","Koulouri","Loukoumades","Gyros","Galaktoboureko","Baklava"],turkey:["i kebap","Dner","Kfte","Pide","Kumpir","Meze","Mant","Lahmacun","Menemen","i kebap","skender kebab","Corba","Kuzu tandir","i Kfte","Pilav","Yaprak sarma","Dolma","mam bayld","Borek","Durum","Kumpir","Balik ekmek","Simit","Kunefe","Baklava","Lokum","Halva","Mozzaik pasta","Glla","Mercimek Kftesi","Haydari","Tursu suyu","Kahvalti","Kazan dibi","Hunkar begendi","Islak burgers","Salep","Yogurtlu kebab"],spain:["Tortilla de patatas","Fabada asturiana","Calots","Boquerones al vinagre","Empanada gallega","Paella","Gazpacho","Gachas","Migas","Bocadillo de calamares","Pulpo a feira","Caldo gallego","Lentejas con chorizo","Cocido madrileo","Cachopo","Caracoles"],venezuela:["Pabelln criollo","Arepa","Mondongo","Empanadas","Quesillo","Chicha andina","Tequeos","Cachapa","Hallaca","Perico","Pasticho","Mandocas","Caraotas negras","Patacones","Dulce de leche","Pan de Jamn"],chile:["Humitas","Empanadas","Porotos con riendas","Completos","Manjar","Cordero al palo","Pastel de choclo","Mote con huesillos","Sopaipillas","Curanto"],argentina:["Milanesas","Empanadas","Pizza fugazeta","Asado","Choripan","Bondiola","Bife de chorizo"],colombia:["Bandeja paisa","Chuleta valluna","Sancocho trifsico","Empanada valluna","Salpicon de frutas","Pastel de garbanzo","Ajiaco","Arepas","Arroz de lisa","Sancocho","Pan de bono","Cuchuco","Oblea","Cazuela de mariscos","Pan de yuca","Bollo Limpio","Almojbana","Empanadas","Arroz con Coco","Sopa de mondongo","Cazuela de Mariscos","Arroz con Pollo","Arepa de Huevo","Mote de Queso"],ecuador:["Encebollado","Ceviche","Tigrillo","Bolon de verde","Llapingacho","Mote pillo","Locro de papa","Churrasco"],peru:["Ceviche","Arroz con pollo","Aji de gallina","Llunca de gallina"],"el salvador":["Pupusa","Sopa de patas","Rigua","Flor de izote con huevo","Gallo en chicha"],romania:["Sarmale","Mici","Pomana porcului","Ciorb de fasole cu ciolan","Ciorb de burt","Ciorb rduean","Plcint cu brnz","Ciorb de potroace","Mmlig cu brnz i smntn","Tochitur","Piftie","Iahnie de fasole","Slnin afumat","Crnai afumai","Varz a la Cluj","Gula de cartofi cu afumtur","Cozonac de cas","Ciorb ardeleneasc de porc","Mucenici moldoveneti","Salat de boeuf","Dovleac copt","Papanai cu brnz de vac i afine","Drob de miel","Prjoale moldoveneti","Zacusc de vinete","Zacusc de fasole","Turt dulce","Cltitele cu gem","Cltitele cu brnza de vac","Balmo","Cozonac","Chiftele"]},r$;(r$=Object.keys(dle))==null||r$.length;function PI(t){const e=(t==null?void 0:t.years)??1;if(e<=0)throw new Error("Years must be positive, use future() instead");const n=365*e*24*60*60*1e3,r=new Date,i=new Date(r.getTime()-n);return Mu(()=>lle({from:i,to:r}),t)}var fle=["Small Rubber Shoes","Fantastic Wooden Sausages","Handmade Frozen Salad","Intelligent Soft Car","Intelligent Concrete Chips","Handcrafted Concrete Bacon","Small Fresh Fish","Rustic Metal Towels","Unbranded Cotton Hat","Fantastic Frozen Bike","Generic Rubber Shirt","Unbranded Wooden Keyboard","Awesome Metal Computer","Gorgeous Fresh Shoes","Unbranded Concrete Sausages","Practical Wooden Ball","Ergonomic Soft Towels","Small Plastic Table","Awesome Metal Pants","Licensed Steel Sausages","Handcrafted Rubber Bike","Ergonomic Cotton Computer","Generic Wooden Ball","Fantastic Frozen Soap","Generic Plastic Keyboard","Awesome Cotton Pizza","Licensed Metal Chips","Handcrafted Cotton Towels","Handmade Plastic Tuna","Practical Granite Keyboard","Intelligent Concrete Soap","Rustic Concrete Chips","Fantastic Steel Hat","Rustic Cotton Chair","Gorgeous Metal Pants","Intelligent Metal Bacon","Handmade Rubber Car","Tasty Concrete Keyboard","Incredible Granite Hat","Practical Rubber Fish","Rustic Cotton Gloves","Rustic Cotton Ball","Refined Fresh Shirt","Generic Granite Sausages","Rustic Granite Fish","Practical Wooden Bacon","Sleek Plastic Chair","Handcrafted Fresh Mouse","Small Concrete Shoes","Awesome Fresh Chair","Incredible Soft Computer","Tasty Concrete Chips","Generic Rubber Sausages","Intelligent Concrete Chicken","Rustic Soft Ball","Awesome Steel Towels","Incredible Fresh Bike","Unbranded Granite Chicken","Rustic Concrete Bike","Small Frozen Sausages","Intelligent Plastic Gloves","Ergonomic Frozen Towels","Refined Frozen Ball","Refined Cotton Ball","Licensed Steel Salad","Intelligent Wooden Bacon","Unbranded Metal Shoes","Fantastic Granite Car","Ergonomic Granite Bacon","Awesome Wooden Shirt","Rustic Wooden Pizza","Tasty Frozen Table","Awesome Wooden Hat","Awesome Rubber Salad","Licensed Concrete Fish","Fantastic Soft Cheese","Rustic Frozen Pizza","Refined Concrete Tuna","Small Frozen Tuna","Licensed Granite Cheese","Practical Rubber Car","Rustic Steel Sausages","Awesome Concrete Hat","Awesome Granite Sausages","Sleek Plastic Chips","Handcrafted Wooden Gloves","Intelligent Metal Computer","Fantastic Fresh Sausages","Fantastic Plastic Salad","Unbranded Steel Sausages","Handcrafted Wooden Fish","Sleek Wooden Bacon","Unbranded Plastic Towels","Tasty Soft Sausages","Generic Metal Shirt","Handmade Granite Cheese","Small Fresh Bacon","Tasty Granite Towels","Licensed Steel Chips"];function OI(t){return Mu(fle,t)}sle("42219");const PU=[{companyName:xI({maxCharCount:18}),productName:OI({maxCharCount:18}),sellDate:PI().toLocaleDateString("en-gb"),inStock:MI(),qty:fs({max:500}),orderId:`${fs({max:9,min:0})}${fs({max:9,min:0})}-${fs({max:9999999,min:1111111})}`,country:"United Kingdom"},...Array.from({length:150},()=>({companyName:xI({maxCharCount:18}),productName:OI({maxCharCount:18}),sellDate:PI().toLocaleDateString("en-gb"),inStock:MI(),qty:fs({max:500}),orderId:`${fs({max:9,min:0})}${fs({max:9,min:0})}-${fs({max:9999999,min:1111111})}`,country:hle({maxCharCount:28})}))],gle=PU.reduce((t,e)=>t.includes(e.country)?t:[...t,e.country],[]);function mle({tabNavigation:t,navigableHeaders:e,renderAllRows:n,enterBeginsEditing:r,autoWrapRow:i,autoWrapCol:o,enterMoves:s,changeToggleOptions:a}){const l=u=>{switch(u){case"enable-tab-navigation":a(c=>({...c,tabNavigation:!t}));break;case"enable-header-navigation":a(c=>({...c,navigableHeaders:!e}));break;case"enable-cell-virtualization":a(c=>({...c,renderAllRows:!n,viewportColumnRenderingOffset:n?"auto":9}));break;case"enable-cell-enter-editing":a(c=>({...c,enterBeginsEditing:!r}));break;case"enable-arrow-rl-first-last-column":a(c=>({...c,autoWrapRow:!i}));break;case"enable-arrow-td-first-last-column":a(c=>({...c,autoWrapCol:!o}));break;case"enable-enter-focus-editing":a(c=>({...c,enterMoves:s.row!==1?{col:0,row:1}:{col:0,row:0}}));break}};return pe.jsx(pe.Fragment,{children:pe.jsxs("div",{className:"checkbox-container",children:[pe.jsxs("div",{className:"checkbox-group",children:[pe.jsxs("div",{children:[pe.jsxs("label",{className:"option-label",htmlFor:"enable-tab-navigation",id:"tab-navigation-label",children:[pe.jsx("input",{checked:t,type:"checkbox",id:"enable-tab-navigation",name:"enable-tab-navigation","aria-label":"Enable navigation with the Tab key",onChange:()=>l("enable-tab-navigation")}),"Enable navigation with the Tab key"]}),pe.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#tabNavigation",target:"_blank",className:"external-link",rel:"noopener noreferrer","aria-label":"Learn more enabling/disabling tab navigation (opens in a new window)",children:pe.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"icon outbound",children:[pe.jsx("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),pe.jsx("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]})})]}),pe.jsxs("div",{children:[pe.jsxs("label",{className:"option-label",htmlFor:"enable-header-navigation",id:"header-navigation-label",children:[pe.jsx("input",{checked:e,type:"checkbox",id:"enable-header-navigation",name:"enable-header-navigation","aria-labelledby":"header-navigation-label",onChange:()=>l("enable-header-navigation")}),"Enable navigation across headers"]}),pe.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#navigableheaders",target:"_blank",className:"external-link",rel:"noopener noreferrer","aria-label":"Learn more about enabling/disabling tab navigation across headers (opens in a new window)",children:pe.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"icon outbound",children:[pe.jsx("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),pe.jsx("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]})})]}),pe.jsxs("div",{children:[pe.jsxs("label",{className:"option-label",htmlFor:"enable-cell-virtualization",id:"cell-virtualization-label",children:[pe.jsx("input",{checked:!n,type:"checkbox",id:"enable-cell-virtualization",name:"enable-cell-virtualization","aria-labelledby":"cell-virtualization-label",onChange:()=>l("enable-cell-virtualization")}),"Enable cells virtualization"]}),pe.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#renderAllRows",target:"_blank",className:"external-link",rel:"noopener noreferrer","aria-label":"Learn more about row virtualization (opens in a new window)",children:pe.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"icon outbound",children:[pe.jsx("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),pe.jsx("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]})})]}),pe.jsxs("div",{children:[pe.jsxs("label",{className:"option-label",htmlFor:"enable-cell-enter-editing",id:"cell-enter-editing-label",children:[pe.jsx("input",{checked:r,type:"checkbox",id:"enable-cell-enter-editing",name:"enable-cell-enter-editing","aria-labelledby":"cell-enter-editing-label",onChange:()=>l("enable-cell-enter-editing")}),"The Enter key begins cell editing"]}),pe.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#enterbeginsediting",target:"_blank",className:"external-link",rel:"noopener noreferrer","aria-label":"Learn more about Enter key cell editing (opens in a new window)",children:pe.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"icon outbound",children:[pe.jsx("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),pe.jsx("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]})})]})]}),pe.jsxs("div",{className:"checkbox-group",children:[pe.jsxs("div",{children:[pe.jsxs("label",{className:"option-label",htmlFor:"enable-arrow-rl-first-last-column",id:"arrow-rl-first-last-column-label",children:[pe.jsx("input",{checked:i,type:"checkbox",id:"enable-arrow-rl-first-last-column",name:"enableArrowFirstLastColumn","aria-labelledby":"arrow-rl-first-last-column-label",onChange:()=>l("enable-arrow-rl-first-last-column")}),"The right/left arrow keys move the focus to the first/last column"]}),pe.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#autowrapcol",target:"_blank",className:"external-link",rel:"noopener noreferrer","aria-label":"Learn more about right/left arrow key behavior (opens in a new window)",children:pe.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"icon outbound",children:[pe.jsx("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),pe.jsx("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]})})]}),pe.jsxs("div",{children:[pe.jsxs("label",{className:"option-label",htmlFor:"enable-arrow-td-first-last-column",id:"arrow-td-first-last-column-label",children:[pe.jsx("input",{checked:o,type:"checkbox",id:"enable-arrow-td-first-last-column",name:"enable-arrow-td-first-last-column","aria-labelledby":"arrow-td-first-last-column-label",onChange:()=>l("enable-arrow-td-first-last-column")}),"The up/down arrow keys move the focus to the first/last row"]}),pe.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#autowraprow",target:"_blank",className:"external-link",rel:"noopener noreferrer","aria-label":"Learn more about up/down arrow key behavior (opens in a new window)",children:pe.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"icon outbound",children:[pe.jsx("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),pe.jsx("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]})})]}),pe.jsxs("div",{children:[pe.jsxs("label",{className:"option-label",htmlFor:"enable-enter-focus-editing",id:"enter-focus-editing-label",children:[pe.jsx("input",{checked:s.row!==0,type:"checkbox",id:"enable-enter-focus-editing",name:"enable-enter-focus-editing","aria-labelledby":"enter-focus-editing-label",onChange:()=>l("enable-enter-focus-editing")}),"The Enter key moves the focus after cell edition"]}),pe.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#entermoves",target:"_blank",className:"external-link",rel:"noopener noreferrer","aria-label":"Learn more about Enter key focus behavior (opens in a new window)",children:pe.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"icon outbound",children:[pe.jsx("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),pe.jsx("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]})})]})]})]})})}const AI="handsontableEditor",ple="handsontable";class rx extends Tu{static get EDITOR_TYPE(){return ple}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),pg(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&hn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:AI,relativeToGroup:TC,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Di(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(AI)}}function wle(t,e,n){vle(t,e),e.set(t,n)}function vle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dm(t,e,n){return e=Cle(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cle(t){var e=yle(t,"string");return typeof e=="symbol"?e:String(e)}function yle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function II(t,e){var n=Sle(t,e,"get");return ble(t,n)}function Sle(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ble(t,e){return e.get?e.get.call(t):e.value}const Rle="autocomplete";var KS=new WeakMap;class ix extends rx{constructor(){super(...arguments),Dm(this,"query",null),Dm(this,"strippedChoices",[]),Dm(this,"rawChoices",[]),wle(this,KS,{writable:!0,value:this.hot.guid.slice(0,9)}),Dm(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=VR(Zt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return Rle}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return fe(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),J(this.htContainer,"autocompleteEditor"),J(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Pe(this.TEXTAREA,[jQ(),WQ(),a2("listbox"),qQ()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Pe(this.TEXTAREA,[_i("false"),QQ(`${II(this,KS)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=Rn();a===0&&zf()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[vt(this.TEXTAREA)-2]:void 0,width:e?vt(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,h,d,f,m)=>{qs(l,u,c,h,d,f,m);const{filteringCaseSensitive:C,allowHtml:b,locale:p}=this.cellProperties,w=this.query;let y=Zt(f),E,T;y&&!b&&(E=C===!0?y.indexOf(w):y.toLocaleLowerCase(p).indexOf(w.toLocaleLowerCase(p)),E!==-1&&(T=y.substr(E,w.length),y=y.replace(T,`<strong>${T}</strong>`))),n&&Pe(u,[VQ(),...r?[tZ(i)]:[],...r?[nZ(r.indexOf(f)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${h}`]]),u.innerHTML=y},afterSelection:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);Pe(c,[_1()]),Pe(this.TEXTAREA,...ZQ(c.id))}}}),n&&(Pe(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Vo()),Pe(this.htEditor.rootElement,[s2(),JQ("polite"),eZ("text"),["id",`${II(this,KS)}-listbox-${o}-${s}`]]),Pe(this.TEXTAREA,..._i("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Pe(this.TEXTAREA,[_i("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=A1(this.TEXTAREA),r=w2(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(Jd([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),pg(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=hu(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=yn(this.TEXTAREA),o=Ut(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=Ut(this.hot.view._wt.wtTable.THEAD),u=yn(e),c=i.top-u.top-l+a,h=e.scrollHeight-c-l-o,d=s>h&&c>h;return d?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(d?c:h,s),d}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+Rn(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ye(e,o=>Zt(o));return Ye(r,o=>n?o:VR(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===be.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===be.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(k2(e.keyCode)||e.keyCode===be.BACKSPACE||e.keyCode===be.DELETE||e.keyCode===be.INSERT){let n=10;if(e.keyCode===be.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const Ele="checkbox";class OU extends Th{static get EDITOR_TYPE(){return Ele}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');He(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Aa=()=>window,Ci=()=>window.document,mE=(t,e)=>window.setTimeout(t,e),Oo=function(t,e,n,r){t.addEventListener(e,n,!!r)},ss=function(t,e,n,r){t.removeEventListener(e,n,!!r)},Tle=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Gr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},XS=function(t,e){Gr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},qS=function(t,e){t.className=Tle((" "+t.className+" ").replace(" "+e+" "," "))},ox=function(t){return/Array/.test(Object.prototype.toString.call(t))},Kr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},_le=function(t){let e=t.getDay();return e===0||e===6},Mle=function(t){return t%4===0&&t%100!==0||t%400===0},HI=function(t,e){return[31,Mle(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Nm=function(t){Kr(t)&&t.setHours(0,0,0,0)},km=function(t,e){return t.getTime()===e.getTime()},ov=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Kr(e[r])?n&&(t[r]=new Date(e[r].getTime())):ox(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=ov({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},DI=function(t,e,n){let r=Ci().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=ov(r,n),t.dispatchEvent(r)},NI=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},So={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},kI=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},xle=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},Ple=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},Ole=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():Ple(o,i))+"</td>"},Ale=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},Ile=function(t){return"<tbody>"+t.join("")+"</tbody>"},Hle=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+kI(t,e)+'">'+kI(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},Dle=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,m,C=!0,b=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",ox(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return m='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+f:d+=f+m,c&&(r===0||u.minMonth>=r)&&(C=!1),h&&(r===11||u.maxMonth<=r)&&(b=!1),e===0&&(d+='<button class="pika-prev'+(C?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(b?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},Nle=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+Hle(t)+Ile(e)+"</table>"};function pE(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Aa().event;let o=i.target||i.srcElement;if(o)if(Gr(o,"is-disabled")||(Gr(o,"pika-button")&&!Gr(o,"is-empty")&&!Gr(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&mE(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Gr(o,"pika-prev")?e.prevMonth():Gr(o,"pika-next")&&e.nextMonth()),Gr(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Aa().event;let o=i.target||i.srcElement;o&&(Gr(o,"pika-select-month")?e.gotoMonth(o.value):Gr(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||Aa().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Kr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Ci().activeElement;do if(Gr(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=mE(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Aa().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Gr(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Oo(o,"change",e._onChange)));do if(Gr(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=Ci().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Oo(e.el,"mousedown",e._onMouseDown,!0),Oo(e.el,"touchend",e._onMouseDown,!0),Oo(e.el,"change",e._onChange),n.keyboardInput&&Oo(Ci(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Ci().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Oo(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Kr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Oo(n.trigger,"click",e._onInputClick),Oo(n.trigger,"focus",e._onInputFocus),Oo(n.trigger,"blur",e._onInputBlur)):this.show()}pE.prototype={config:function(t){this._o||(this._o=ov({},So,!0));let e=ov(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Kr(e.minDate)||(e.minDate=!1),Kr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),ox(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||So.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Kr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Kr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",DI(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Kr(t))return;let n=this._o.minDate,r=this._o.maxDate;Kr(n)&&t<n?t=n:Kr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),Nm(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),DI(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Kr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=NI(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=NI({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Nm(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=So.minDate,this._o.minYear=So.minYear,this._o.minMonth=So.minMonth,this._o.startRange=So.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Nm(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=So.maxDate,this._o.maxYear=So.maxYear,this._o.maxMonth=So.maxMonth,this._o.endRange=So.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+Dle(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&mE(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=Aa().innerWidth||Ci().documentElement.clientWidth,i=Aa().innerHeight||Ci().documentElement.clientHeight,o=Ci().body.scrollTop||Ci().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Aa().pageXOffset,a=l.bottom+Aa().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",XS(this.el,u?"left-aligned":"right-aligned"),XS(this.el,c?"bottom-aligned":"top-aligned"),qS(this.el,u?"right-aligned":"left-aligned"),qS(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=HI(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Nm(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=HI(h,u),m=o+s,C=m;for(;C>7;)C-=7;m+=7-C;let b=!1;for(let p=0,w=0;p<m;p++){let y=new Date(t,e,1+(p-s)),E=Kr(this._d)?km(y,this._d):!1,T=km(y,i),x=r.events.indexOf(y.toDateString())!==-1,A=p<s||p>=o+s,W=1+(p-s),B=e,U=t,Q=r.startRange&&km(r.startRange,y),te=r.endRange&&km(r.endRange,y),ee=r.startRange&&r.endRange&&r.startRange<y&&y<r.endRange,he=r.minDate&&y<r.minDate||r.maxDate&&y>r.maxDate||r.disableWeekends&&_le(y)||r.disableDayFn&&r.disableDayFn(y);A&&(p<s?(W=f+W,B=u,U=h):(W=W-o,B=c,U=d));let _e={day:W,month:B,year:U,hasEvent:x,isSelected:E,isToday:T,isDisabled:he,isEmpty:A,isStartRange:Q,isEndRange:te,isInRange:ee,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&E&&(b=!0),l.push(xle(_e)),++w===7&&(r.showWeekNumber&&l.unshift(Ole(this,p-s,e,t,r.firstWeekOfYearMinDays)),a.push(Ale(l,r.isRTL,r.pickWholeWeek,b)),l=[],w=0,b=!1)}return Nle(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),qS(this.el,"is-hidden"),this._o.bound&&(Oo(Ci(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&ss(Ci(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),XS(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),ss(this.el,"mousedown",this._onMouseDown,!0),ss(this.el,"touchend",this._onMouseDown,!0),ss(this.el,"change",this._onChange),t.keyboardInput&&ss(Ci(),"keydown",this._onKeyChange),t.field&&(ss(t.field,"change",this._onInputChange),t.bound&&(ss(t.trigger,"click",this._onInputClick),ss(t.trigger,"focus",this._onInputFocus),ss(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function QS(t,e,n){return e=kle(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kle(t){var e=Lle(t,"string");return typeof e=="symbol"?e:String(e)}function Lle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const AU="date",LI="dateEditor";class IU extends Tu{constructor(){super(...arguments),QS(this,"defaultDateFormat","DD/MM/YYYY"),QS(this,"parentDestroyed",!1),QS(this,"$datePicker",null)}static get EDITOR_TYPE(){return AU}init(){if(typeof Z!="function")throw new Error("You need to include moment.js to your project.");if(typeof pE!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),J(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{He(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:LI})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(LI),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?V1(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new pE(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Z),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+Ut(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-vt(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,Z(s,r,!0).isValid()&&this.$datePicker.setMoment(Z(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,Z(s,r,!0).isValid()&&this.$datePicker.setMoment(Z(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Cg(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=Z(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}}const $le="dropdown";class sx extends ix{static get EDITOR_TYPE(){return $le}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}we.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===sx&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const Fle="numeric";class HU extends Tu{static get EDITOR_TYPE(){return Fle}}const Wle="password";class DU extends Tu{static get EDITOR_TYPE(){return Wle}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&Pe(this.TEXTAREA,[Gs()]),ho(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const ZS="ht_editor_visible",$I="selectEditor",Vle="select";class NU extends Th{static get EDITOR_TYPE(){return Vle}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",J(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",He(this.select,ZS)&&We(this.select,ZS),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),ho(this.select),Ke(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Ru(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==gn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",J(this.select,ZS)}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={group:$I};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:r,callback:()=>{}},{keys:[["ArrowUp"]],callback:()=>{const o=this.select.selectedIndex-1;o>=0&&(this.select[o].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const o=this.select.selectedIndex+1;o<=this.select.length-1&&(this.select[o].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup($I)}}const Ble="time";class kU extends Tu{static get EDITOR_TYPE(){return Ble}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function Ule(){Hr(Th),Hr(ix),Hr(OU),Hr(IU),Hr(sx),Hr(rx),Hr(HU),Hr(DU),Hr(NU),Hr(Tu),Hr(kU)}const zle="html";function ax(t,e,n,r,i,o,s){Tg.apply(this,[t,e,n,r,i,o,s]),Ru(e,o??"",!1)}ax.RENDERER_TYPE=zle;const jle="autocomplete";function _h(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?ax:qs,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Gs()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),J(e,"htAutocomplete"),!t.acArrowListener){const h=new Oi(t);t.acArrowListener=function(d){He(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}_h.RENDERER_TYPE=jle;const Gle="dropdown";function lx(t,e,n,r,i,o,s){_h.apply(this,[t,e,n,r,i,o,s])}lx.RENDERER_TYPE=Gle;const FI=new WeakMap,WI=new WeakMap,Yle="htBadValue",dh="data-row",fh="data-col",Kle="checkboxRenderer",LU="checkbox";we.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===LU){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function ux(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Tg.apply(this,[t,e,n,r,i,o,s]),Xle(t);let u=qle(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),ho(e),o===s.checkedTemplate||Zt(o).toLocaleLowerCase(s.locale)===Zt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Zt(o).toLocaleLowerCase(s.locale)===Zt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:pn(o)?J(u,"noValue"):(u.style.display="none",J(u,Yle),h=!0),Pe(u,[[dh,n],[fh,r]]),l&&Pe(u,[E1(u.checked?t.getTranslatedPhrase(WM):t.getTranslatedPhrase(VM)),XQ(u.checked),BQ()]),!h&&c){let C="";if(c.value)C=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const p=t.getDataAtRowProp(n,c.property);C=p!==null?p:""}const b=Qle(a,C,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(b),e.appendChild(u)):(b.appendChild(u),u=b):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(b)):(b.insertBefore(u,b.firstChild),u=b))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),FI.has(t)||(FI.set(t,!0),d());function d(){const b=t.getShortcutManager().getContext("grid"),p={group:Kle};b.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m())},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),relativeToGroup:jM,position:"before"}],p)}function f(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const b=t.getSelectedRange();if(b)for(let p=0;p<b.length;p++){const{row:w,col:y}=b[p].getTopStartCorner(),{row:E,col:T}=b[p].getBottomEndCorner(),x=[];for(let A=w;A<=E;A+=1)for(let W=y;W<=T;W+=1){const B=t.getCellMeta(A,W);if(B.type!=="checkbox")return;if(B.readOnly===!0)continue;typeof B.checkedTemplate>"u"&&(B.checkedTemplate=!0),typeof B.uncheckedTemplate>"u"&&(B.uncheckedTemplate=!1);const U=t.getDataAtCell(A,W);C===!1?[B.checkedTemplate,B.checkedTemplate.toString()].includes(U)?x.push([A,W,B.uncheckedTemplate]):[B.uncheckedTemplate,B.uncheckedTemplate.toString(),null,void 0].includes(U)&&x.push([A,W,B.checkedTemplate]):x.push([A,W,B.uncheckedTemplate])}x.length>0&&t.setDataAtCell(x)}}function m(){const C=t.getSelectedRange();if(C){for(let b=0;b<C.length;b++){const p=C[b].getTopStartCorner(),w=C[b].getBottomEndCorner();for(let y=p.row;y<=w.row;y++)for(let E=p.col;E<=w.col;E++){const T=t.getCellMeta(y,E);if(T.type!=="checkbox")return!1;const x=t.getCell(y,E);if(x==null)return!0;if(x.querySelectorAll("input[type=checkbox]").length>0&&!T.readOnly)return!0}}return!1}}}ux.RENDERER_TYPE=LU;function Xle(t){let e=WI.get(t);if(!e){const{rootElement:n}=t;e=new Oi(t),e.addEventListener(n,"click",r=>Jle(r,t)),e.addEventListener(n,"mouseup",r=>Zle(r,t)),e.addEventListener(n,"change",r=>eue(r,t)),WI.set(t,e)}return e}function qle(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Qle(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function Zle(t,e){const{target:n}=t;cx(n)&&(!n.hasAttribute(dh)||!n.hasAttribute(fh)||setTimeout(e.listen,10))}function Jle(t,e){const{target:n}=t;if(!cx(n)||!n.hasAttribute(dh)||!n.hasAttribute(fh))return;const r=parseInt(n.getAttribute(dh),10),i=parseInt(n.getAttribute(fh),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function eue(t,e){const{target:n}=t;if(!cx(n)||!n.hasAttribute(dh)||!n.hasAttribute(fh))return;const r=parseInt(n.getAttribute(dh),10),i=parseInt(n.getAttribute(fh),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function cx(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const tue="handsontable";function hx(t,e,n,r,i,o,s){_h.apply(this,[t,e,n,r,i,o,s])}hx.RENDERER_TYPE=tue;function Lm(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var $U={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var h=typeof Lm=="function"&&Lm;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var f=i[u]={exports:{}};r[u][0].call(f.exports,function(m){return s(r[u][1][m]||m)},f,f.exports,n,r,i,o)}return i[u].exports}for(var a=typeof Lm=="function"&&Lm,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",d=1e14,f=14,m=9007199254740991,C=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],b=1e7,p=1e9;function w(B){var U=0|B;return 0<B||B===U?U:U-1}function y(B){for(var U,Q,te=1,ee=B.length,he=B[0]+"";te<ee;){for(U=B[te++]+"",Q=f-U.length;Q--;U="0"+U);he+=U}for(ee=he.length;he.charCodeAt(--ee)===48;);return he.slice(0,ee+1||1)}function E(B,U){var Q,te,ee=B.c,he=U.c,_e=B.s,Ue=U.s,ke=B.e,Y=U.e;if(!_e||!Ue)return null;if(Q=ee&&!ee[0],te=he&&!he[0],Q||te)return Q?te?0:-Ue:_e;if(_e!=Ue)return _e;if(Q=_e<0,te=ke==Y,!ee||!he)return te?0:!ee^Q?1:-1;if(!te)return Y<ke^Q?1:-1;for(Ue=(ke=ee.length)<(Y=he.length)?ke:Y,_e=0;_e<Ue;_e++)if(ee[_e]!=he[_e])return ee[_e]>he[_e]^Q?1:-1;return ke==Y?0:Y<ke^Q?1:-1}function T(B,U,Q,te){if(B<U||Q<B||B!==(B<0?l(B):u(B)))throw Error(c+(te||"Argument")+(typeof B=="number"?B<U||Q<B?" out of range: ":" not an integer: ":" not a primitive number: ")+String(B))}function x(B){var U=B.c.length-1;return w(B.e/f)==U&&B.c[U]%2!=0}function A(B,U){return(1<B.length?B.charAt(0)+"."+B.slice(1):B)+(U<0?"e":"e+")+U}function W(B,U,Q){var te,ee;if(U<0){for(ee=Q+".";++U;ee+=Q);B=ee+B}else if(++U>(te=B.length)){for(ee=Q,U-=te;--U;ee+=Q);B+=ee}else U<te&&(B=B.slice(0,U)+"."+B.slice(U));return B}(s=function B(U){var Q,te,ee,he,_e,Ue,ke,Y,g,v,S=K.prototype={constructor:K,toString:null,valueOf:null},O=new K(1),H=20,D=4,X=-7,G=21,se=-1e7,re=1e7,q=!1,Ee=1,De=0,Ie={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},Le="0123456789abcdefghijklmnopqrstuvwxyz";function K(R,_){var P,V,I,F,N,L,z,$,j=this;if(!(j instanceof K))return new K(R,_);if(_==null){if(R instanceof K)return j.s=R.s,j.e=R.e,void(j.c=(R=R.c)?R.slice():R);if((L=typeof R=="number")&&0*R==0){if(j.s=1/R<0?(R=-R,-1):1,R===~~R){for(F=0,N=R;10<=N;N/=10,F++);return j.e=F,void(j.c=[R])}$=String(R)}else{if($=String(R),!a.test($))return ee(j,$,L);j.s=$.charCodeAt(0)==45?($=$.slice(1),-1):1}-1<(F=$.indexOf("."))&&($=$.replace(".","")),0<(N=$.search(/e/i))?(F<0&&(F=N),F+=+$.slice(N+1),$=$.substring(0,N)):F<0&&(F=$.length)}else{if(T(_,2,Le.length,"Base"),$=String(R),_==10)return $e(j=new K(R instanceof K?R:$),H+j.e+1,D);if(L=typeof R=="number"){if(0*R!=0)return ee(j,$,L,_);if(j.s=1/R<0?($=$.slice(1),-1):1,K.DEBUG&&15<$.replace(/^0\.0*|\./,"").length)throw Error(h+R);L=!1}else j.s=$.charCodeAt(0)===45?($=$.slice(1),-1):1;for(P=Le.slice(0,_),F=N=0,z=$.length;N<z;N++)if(P.indexOf(V=$.charAt(N))<0){if(V=="."){if(F<N){F=z;continue}}else if(!I&&($==$.toUpperCase()&&($=$.toLowerCase())||$==$.toLowerCase()&&($=$.toUpperCase()))){I=!0,N=-1,F=0;continue}return ee(j,String(R),L,_)}-1<(F=($=te($,_,10,j.s)).indexOf("."))?$=$.replace(".",""):F=$.length}for(N=0;$.charCodeAt(N)===48;N++);for(z=$.length;$.charCodeAt(--z)===48;);if($=$.slice(N,++z)){if(z-=N,L&&K.DEBUG&&15<z&&(m<R||R!==u(R)))throw Error(h+j.s*R);if(re<(F=F-N-1))j.c=j.e=null;else if(F<se)j.c=[j.e=0];else{if(j.e=F,j.c=[],N=(F+1)%f,F<0&&(N+=f),N<z){for(N&&j.c.push(+$.slice(0,N)),z-=f;N<z;)j.c.push(+$.slice(N,N+=f));$=$.slice(N),N=f-$.length}else N-=z;for(;N--;$+="0");j.c.push(+$)}}else j.c=[j.e=0]}function ft(R,_,P,V){var I,F,N,L,z;if(P==null?P=D:T(P,0,8),!R.c)return R.toString();if(I=R.c[0],N=R.e,_==null)z=y(R.c),z=V==1||V==2&&(N<=X||G<=N)?A(z,N):W(z,N,"0");else if(F=(R=$e(new K(R),_,P)).e,L=(z=y(R.c)).length,V==1||V==2&&(_<=F||F<=X)){for(;L<_;z+="0",L++);z=A(z,F)}else if(_-=N,z=W(z,F,"0"),L<F+1){if(0<--_)for(z+=".";_--;z+="0");}else if(0<(_+=F-L))for(F+1==L&&(z+=".");_--;z+="0");return R.s<0&&I?"-"+z:z}function Ge(R,_){for(var P,V=1,I=new K(R[0]);V<R.length;V++){if(!(P=new K(R[V])).s){I=P;break}_.call(I,P)&&(I=P)}return I}function Ne(R,_,P){for(var V=1,I=_.length;!_[--I];_.pop());for(I=_[0];10<=I;I/=10,V++);return(P=V+P*f-1)>re?R.c=R.e=null:R.c=P<se?[R.e=0]:(R.e=P,_),R}function $e(R,_,P,V){var I,F,N,L,z,$,j,ae=R.c,me=C;if(ae){e:{for(I=1,L=ae[0];10<=L;L/=10,I++);if((F=_-I)<0)F+=f,N=_,j=(z=ae[$=0])/me[I-N-1]%10|0;else if(($=l((F+1)/f))>=ae.length){if(!V)break e;for(;ae.length<=$;ae.push(0));z=j=0,N=(F%=f)-f+(I=1)}else{for(z=L=ae[$],I=1;10<=L;L/=10,I++);j=(N=(F%=f)-f+I)<0?0:z/me[I-N-1]%10|0}if(V=V||_<0||ae[$+1]!=null||(N<0?z:z%me[I-N-1]),V=P<4?(j||V)&&(P==0||P==(R.s<0?3:2)):5<j||j==5&&(P==4||V||P==6&&(0<F?0<N?z/me[I-N]:0:ae[$-1])%10&1||P==(R.s<0?8:7)),_<1||!ae[0])return ae.length=0,V?(_-=R.e+1,ae[0]=me[(f-_%f)%f],R.e=-_||0):ae[0]=R.e=0,R;if(F==0?(ae.length=$,L=1,$--):(ae.length=$+1,L=me[f-F],ae[$]=0<N?u(z/me[I-N]%me[N])*L:0),V)for(;;){if($==0){for(F=1,N=ae[0];10<=N;N/=10,F++);for(N=ae[0]+=L,L=1;10<=N;N/=10,L++);F!=L&&(R.e++,ae[0]==d&&(ae[0]=1));break}if(ae[$]+=L,ae[$]!=d)break;ae[$--]=0,L=1}for(F=ae.length;ae[--F]===0;ae.pop());}R.e>re?R.c=R.e=null:R.e<se&&(R.c=[R.e=0])}return R}function Me(R){var _,P=R.e;return P===null?R.toString():(_=y(R.c),_=P<=X||G<=P?A(_,P):W(_,P,"0"),R.s<0?"-"+_:_)}return K.clone=B,K.ROUND_UP=0,K.ROUND_DOWN=1,K.ROUND_CEIL=2,K.ROUND_FLOOR=3,K.ROUND_HALF_UP=4,K.ROUND_HALF_DOWN=5,K.ROUND_HALF_EVEN=6,K.ROUND_HALF_CEIL=7,K.ROUND_HALF_FLOOR=8,K.EUCLID=9,K.config=K.set=function(R){var _,P;if(R!=null){if(typeof R!="object")throw Error(c+"Object expected: "+R);if(R.hasOwnProperty(_="DECIMAL_PLACES")&&(T(P=R[_],0,p,_),H=P),R.hasOwnProperty(_="ROUNDING_MODE")&&(T(P=R[_],0,8,_),D=P),R.hasOwnProperty(_="EXPONENTIAL_AT")&&((P=R[_])&&P.pop?(T(P[0],-p,0,_),T(P[1],0,p,_),X=P[0],G=P[1]):(T(P,-p,p,_),X=-(G=P<0?-P:P))),R.hasOwnProperty(_="RANGE"))if((P=R[_])&&P.pop)T(P[0],-p,-1,_),T(P[1],1,p,_),se=P[0],re=P[1];else{if(T(P,-p,p,_),!P)throw Error(c+_+" cannot be zero: "+P);se=-(re=P<0?-P:P)}if(R.hasOwnProperty(_="CRYPTO")){if((P=R[_])!==!!P)throw Error(c+_+" not true or false: "+P);if(P){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw q=!P,Error(c+"crypto unavailable");q=P}else q=P}if(R.hasOwnProperty(_="MODULO_MODE")&&(T(P=R[_],0,9,_),Ee=P),R.hasOwnProperty(_="POW_PRECISION")&&(T(P=R[_],0,p,_),De=P),R.hasOwnProperty(_="FORMAT")){if(typeof(P=R[_])!="object")throw Error(c+_+" not an object: "+P);Ie=P}if(R.hasOwnProperty(_="ALPHABET")){if(typeof(P=R[_])!="string"||/^.$|[+-.\s]|(.).*\1/.test(P))throw Error(c+_+" invalid: "+P);Le=P}}return{DECIMAL_PLACES:H,ROUNDING_MODE:D,EXPONENTIAL_AT:[X,G],RANGE:[se,re],CRYPTO:q,MODULO_MODE:Ee,POW_PRECISION:De,FORMAT:Ie,ALPHABET:Le}},K.isBigNumber=function(R){return R instanceof K||R&&R._isBigNumber===!0||!1},K.maximum=K.max=function(){return Ge(arguments,S.lt)},K.minimum=K.min=function(){return Ge(arguments,S.gt)},K.random=(he=9007199254740992,_e=Math.random()*he&2097151?function(){return u(Math.random()*he)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(R){var _,P,V,I,F,N=0,L=[],z=new K(O);if(R==null?R=H:T(R,0,p),I=l(R/f),q)if(crypto.getRandomValues){for(_=crypto.getRandomValues(new Uint32Array(I*=2));N<I;)9e15<=(F=131072*_[N]+(_[N+1]>>>11))?(P=crypto.getRandomValues(new Uint32Array(2)),_[N]=P[0],_[N+1]=P[1]):(L.push(F%1e14),N+=2);N=I/2}else{if(!crypto.randomBytes)throw q=!1,Error(c+"crypto unavailable");for(_=crypto.randomBytes(I*=7);N<I;)9e15<=(F=281474976710656*(31&_[N])+1099511627776*_[N+1]+4294967296*_[N+2]+16777216*_[N+3]+(_[N+4]<<16)+(_[N+5]<<8)+_[N+6])?crypto.randomBytes(7).copy(_,N):(L.push(F%1e14),N+=7);N=I/7}if(!q)for(;N<I;)(F=_e())<9e15&&(L[N++]=F%1e14);for(I=L[--N],R%=f,I&&R&&(F=C[f-R],L[N]=u(I/F)*F);L[N]===0;L.pop(),N--);if(N<0)L=[V=0];else{for(V=-1;L[0]===0;L.splice(0,1),V-=f);for(N=1,F=L[0];10<=F;F/=10,N++);N<f&&(V-=f-N)}return z.e=V,z.c=L,z}),K.sum=function(){for(var R=1,_=arguments,P=new K(_[0]);R<_.length;)P=P.plus(_[R++]);return P},te=function(){var R="0123456789";function _(P,V,I,F){for(var N,L,z=[0],$=0,j=P.length;$<j;){for(L=z.length;L--;z[L]*=V);for(z[0]+=F.indexOf(P.charAt($++)),N=0;N<z.length;N++)z[N]>I-1&&(z[N+1]==null&&(z[N+1]=0),z[N+1]+=z[N]/I|0,z[N]%=I)}return z.reverse()}return function(P,V,I,F,N){var L,z,$,j,ae,me,Te,Ae,ze=P.indexOf("."),Mt=H,et=D;for(0<=ze&&(j=De,De=0,P=P.replace(".",""),me=(Ae=new K(V)).pow(P.length-ze),De=j,Ae.c=_(W(y(me.c),me.e,"0"),10,I,R),Ae.e=Ae.c.length),$=j=(Te=_(P,V,I,N?(L=Le,R):(L=R,Le))).length;Te[--j]==0;Te.pop());if(!Te[0])return L.charAt(0);if(ze<0?--$:(me.c=Te,me.e=$,me.s=F,Te=(me=Q(me,Ae,Mt,et,I)).c,ae=me.r,$=me.e),ze=Te[z=$+Mt+1],j=I/2,ae=ae||z<0||Te[z+1]!=null,ae=et<4?(ze!=null||ae)&&(et==0||et==(me.s<0?3:2)):j<ze||ze==j&&(et==4||ae||et==6&&1&Te[z-1]||et==(me.s<0?8:7)),z<1||!Te[0])P=ae?W(L.charAt(1),-Mt,L.charAt(0)):L.charAt(0);else{if(Te.length=z,ae)for(--I;++Te[--z]>I;)Te[z]=0,z||(++$,Te=[1].concat(Te));for(j=Te.length;!Te[--j];);for(ze=0,P="";ze<=j;P+=L.charAt(Te[ze++]));P=W(P,$,L.charAt(0))}return P}}(),Q=function(){function R(V,I,F){var N,L,z,$,j=0,ae=V.length,me=I%b,Te=I/b|0;for(V=V.slice();ae--;)j=((L=me*(z=V[ae]%b)+(N=Te*z+($=V[ae]/b|0)*me)%b*b+j)/F|0)+(N/b|0)+Te*$,V[ae]=L%F;return j&&(V=[j].concat(V)),V}function _(V,I,F,N){var L,z;if(F!=N)z=N<F?1:-1;else for(L=z=0;L<F;L++)if(V[L]!=I[L]){z=V[L]>I[L]?1:-1;break}return z}function P(V,I,F,N){for(var L=0;F--;)V[F]-=L,L=V[F]<I[F]?1:0,V[F]=L*N+V[F]-I[F];for(;!V[0]&&1<V.length;V.splice(0,1));}return function(V,I,F,N,L){var z,$,j,ae,me,Te,Ae,ze,Mt,et,mt,kt,xu,Ph,nn,Hn,hl,sr=V.s==I.s?1:-1,wn=V.c,Pt=I.c;if(!(wn&&wn[0]&&Pt&&Pt[0]))return new K(V.s&&I.s&&(wn?!Pt||wn[0]!=Pt[0]:Pt)?wn&&wn[0]==0||!Pt?0*sr:sr/0:NaN);for(Mt=(ze=new K(sr)).c=[],sr=F+($=V.e-I.e)+1,L||(L=d,$=w(V.e/f)-w(I.e/f),sr=sr/f|0),j=0;Pt[j]==(wn[j]||0);j++);if(Pt[j]>(wn[j]||0)&&$--,sr<0)Mt.push(1),ae=!0;else{for(Ph=wn.length,Hn=Pt.length,sr+=2,1<(me=u(L/(Pt[j=0]+1)))&&(Pt=R(Pt,me,L),wn=R(wn,me,L),Hn=Pt.length,Ph=wn.length),xu=Hn,mt=(et=wn.slice(0,Hn)).length;mt<Hn;et[mt++]=0);hl=Pt.slice(),hl=[0].concat(hl),nn=Pt[0],Pt[1]>=L/2&&nn++;do{if(me=0,(z=_(Pt,et,Hn,mt))<0){if(kt=et[0],Hn!=mt&&(kt=kt*L+(et[1]||0)),1<(me=u(kt/nn)))for(L<=me&&(me=L-1),Ae=(Te=R(Pt,me,L)).length,mt=et.length;_(Te,et,Ae,mt)==1;)me--,P(Te,Hn<Ae?hl:Pt,Ae,L),Ae=Te.length,z=1;else me==0&&(z=me=1),Ae=(Te=Pt.slice()).length;if(Ae<mt&&(Te=[0].concat(Te)),P(et,Te,mt,L),mt=et.length,z==-1)for(;_(Pt,et,Hn,mt)<1;)me++,P(et,Hn<mt?hl:Pt,mt,L),mt=et.length}else z===0&&(me++,et=[0]);Mt[j++]=me,et[0]?et[mt++]=wn[xu]||0:(et=[wn[xu]],mt=1)}while((xu++<Ph||et[0]!=null)&&sr--);ae=et[0]!=null,Mt[0]||Mt.splice(0,1)}if(L==d){for(j=1,sr=Mt[0];10<=sr;sr/=10,j++);$e(ze,F+(ze.e=j+$*f-1)+1,N,ae)}else ze.e=$,ze.r=+ae;return ze}}(),Ue=/^(-?)0([xbo])(?=\w[\w.]*$)/i,ke=/^([^.]+)\.$/,Y=/^\.([^.]+)$/,g=/^-?(Infinity|NaN)$/,v=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ee=function(R,_,P,V){var I,F=P?_:_.replace(v,"");if(g.test(F))R.s=isNaN(F)?null:F<0?-1:1,R.c=R.e=null;else{if(!P&&(F=F.replace(Ue,function(N,L,z){return I=(z=z.toLowerCase())=="x"?16:z=="b"?2:8,V&&V!=I?N:L}),V&&(I=V,F=F.replace(ke,"$1").replace(Y,"0.$1")),_!=F))return new K(F,I);if(K.DEBUG)throw Error(c+"Not a"+(V?" base "+V:"")+" number: "+_);R.c=R.e=R.s=null}},S.absoluteValue=S.abs=function(){var R=new K(this);return R.s<0&&(R.s=1),R},S.comparedTo=function(R,_){return E(this,new K(R,_))},S.decimalPlaces=S.dp=function(R,_){var P,V,I;if(R!=null)return T(R,0,p),_==null?_=D:T(_,0,8),$e(new K(this),R+this.e+1,_);if(!(P=this.c))return null;if(V=((I=P.length-1)-w(this.e/f))*f,I=P[I])for(;I%10==0;I/=10,V--);return V<0&&(V=0),V},S.dividedBy=S.div=function(R,_){return Q(this,new K(R,_),H,D)},S.dividedToIntegerBy=S.idiv=function(R,_){return Q(this,new K(R,_),0,1)},S.exponentiatedBy=S.pow=function(R,_){var P,V,I,F,N,L,z,$,j=this;if((R=new K(R)).c&&!R.isInteger())throw Error(c+"Exponent not an integer: "+Me(R));if(_!=null&&(_=new K(_)),N=14<R.e,!j.c||!j.c[0]||j.c[0]==1&&!j.e&&j.c.length==1||!R.c||!R.c[0])return $=new K(Math.pow(+Me(j),N?2-x(R):+Me(R))),_?$.mod(_):$;if(L=R.s<0,_){if(_.c?!_.c[0]:!_.s)return new K(NaN);(V=!L&&j.isInteger()&&_.isInteger())&&(j=j.mod(_))}else{if(9<R.e&&(0<j.e||j.e<-1||(j.e==0?1<j.c[0]||N&&24e7<=j.c[1]:j.c[0]<8e13||N&&j.c[0]<=9999975e7)))return F=j.s<0&&x(R)?-0:0,-1<j.e&&(F=1/F),new K(L?1/F:F);De&&(F=l(De/f+2))}for(z=N?(P=new K(.5),L&&(R.s=1),x(R)):(I=Math.abs(+Me(R)))%2,$=new K(O);;){if(z){if(!($=$.times(j)).c)break;F?$.c.length>F&&($.c.length=F):V&&($=$.mod(_))}if(I){if((I=u(I/2))===0)break;z=I%2}else if($e(R=R.times(P),R.e+1,1),14<R.e)z=x(R);else{if((I=+Me(R))==0)break;z=I%2}j=j.times(j),F?j.c&&j.c.length>F&&(j.c.length=F):V&&(j=j.mod(_))}return V?$:(L&&($=O.div($)),_?$.mod(_):F?$e($,De,D,void 0):$)},S.integerValue=function(R){var _=new K(this);return R==null?R=D:T(R,0,8),$e(_,_.e+1,R)},S.isEqualTo=S.eq=function(R,_){return E(this,new K(R,_))===0},S.isFinite=function(){return!!this.c},S.isGreaterThan=S.gt=function(R,_){return 0<E(this,new K(R,_))},S.isGreaterThanOrEqualTo=S.gte=function(R,_){return(_=E(this,new K(R,_)))===1||_===0},S.isInteger=function(){return!!this.c&&w(this.e/f)>this.c.length-2},S.isLessThan=S.lt=function(R,_){return E(this,new K(R,_))<0},S.isLessThanOrEqualTo=S.lte=function(R,_){return(_=E(this,new K(R,_)))===-1||_===0},S.isNaN=function(){return!this.s},S.isNegative=function(){return this.s<0},S.isPositive=function(){return 0<this.s},S.isZero=function(){return!!this.c&&this.c[0]==0},S.minus=function(R,_){var P,V,I,F,N=this,L=N.s;if(_=(R=new K(R,_)).s,!L||!_)return new K(NaN);if(L!=_)return R.s=-_,N.plus(R);var z=N.e/f,$=R.e/f,j=N.c,ae=R.c;if(!z||!$){if(!j||!ae)return j?(R.s=-_,R):new K(ae?N:NaN);if(!j[0]||!ae[0])return ae[0]?(R.s=-_,R):new K(j[0]?N:D==3?-0:0)}if(z=w(z),$=w($),j=j.slice(),L=z-$){for((I=(F=L<0)?(L=-L,j):($=z,ae)).reverse(),_=L;_--;I.push(0));I.reverse()}else for(V=(F=(L=j.length)<(_=ae.length))?L:_,L=_=0;_<V;_++)if(j[_]!=ae[_]){F=j[_]<ae[_];break}if(F&&(I=j,j=ae,ae=I,R.s=-R.s),0<(_=(V=ae.length)-(P=j.length)))for(;_--;j[P++]=0);for(_=d-1;L<V;){if(j[--V]<ae[V]){for(P=V;P&&!j[--P];j[P]=_);--j[P],j[V]+=d}j[V]-=ae[V]}for(;j[0]==0;j.splice(0,1),--$);return j[0]?Ne(R,j,$):(R.s=D==3?-1:1,R.c=[R.e=0],R)},S.modulo=S.mod=function(R,_){var P,V,I=this;return R=new K(R,_),!I.c||!R.s||R.c&&!R.c[0]?new K(NaN):!R.c||I.c&&!I.c[0]?new K(I):(Ee==9?(V=R.s,R.s=1,P=Q(I,R,0,3),R.s=V,P.s*=V):P=Q(I,R,0,Ee),(R=I.minus(P.times(R))).c[0]||Ee!=1||(R.s=I.s),R)},S.multipliedBy=S.times=function(R,_){var P,V,I,F,N,L,z,$,j,ae,me,Te,Ae,ze,Mt,et=this,mt=et.c,kt=(R=new K(R,_)).c;if(!(mt&&kt&&mt[0]&&kt[0]))return!et.s||!R.s||mt&&!mt[0]&&!kt||kt&&!kt[0]&&!mt?R.c=R.e=R.s=null:(R.s*=et.s,mt&&kt?(R.c=[0],R.e=0):R.c=R.e=null),R;for(V=w(et.e/f)+w(R.e/f),R.s*=et.s,(z=mt.length)<(ae=kt.length)&&(Ae=mt,mt=kt,kt=Ae,I=z,z=ae,ae=I),I=z+ae,Ae=[];I--;Ae.push(0));for(ze=d,Mt=b,I=ae;0<=--I;){for(P=0,me=kt[I]%Mt,Te=kt[I]/Mt|0,F=I+(N=z);I<F;)P=(($=me*($=mt[--N]%Mt)+(L=Te*$+(j=mt[N]/Mt|0)*me)%Mt*Mt+Ae[F]+P)/ze|0)+(L/Mt|0)+Te*j,Ae[F--]=$%ze;Ae[F]=P}return P?++V:Ae.splice(0,1),Ne(R,Ae,V)},S.negated=function(){var R=new K(this);return R.s=-R.s||null,R},S.plus=function(R,_){var P,V=this,I=V.s;if(_=(R=new K(R,_)).s,!I||!_)return new K(NaN);if(I!=_)return R.s=-_,V.minus(R);var F=V.e/f,N=R.e/f,L=V.c,z=R.c;if(!F||!N){if(!L||!z)return new K(I/0);if(!L[0]||!z[0])return z[0]?R:new K(L[0]?V:0*I)}if(F=w(F),N=w(N),L=L.slice(),I=F-N){for((P=0<I?(N=F,z):(I=-I,L)).reverse();I--;P.push(0));P.reverse()}for((I=L.length)-(_=z.length)<0&&(P=z,z=L,L=P,_=I),I=0;_;)I=(L[--_]=L[_]+z[_]+I)/d|0,L[_]=d===L[_]?0:L[_]%d;return I&&(L=[I].concat(L),++N),Ne(R,L,N)},S.precision=S.sd=function(R,_){var P,V,I;if(R!=null&&R!==!!R)return T(R,1,p),_==null?_=D:T(_,0,8),$e(new K(this),R,_);if(!(P=this.c))return null;if(V=(I=P.length-1)*f+1,I=P[I]){for(;I%10==0;I/=10,V--);for(I=P[0];10<=I;I/=10,V++);}return R&&this.e+1>V&&(V=this.e+1),V},S.shiftedBy=function(R){return T(R,-m,m),this.times("1e"+R)},S.squareRoot=S.sqrt=function(){var R,_,P,V,I,F=this,N=F.c,L=F.s,z=F.e,$=H+4,j=new K("0.5");if(L!==1||!N||!N[0])return new K(!L||L<0&&(!N||N[0])?NaN:N?F:1/0);if((P=(L=Math.sqrt(+Me(F)))==0||L==1/0?(((_=y(N)).length+z)%2==0&&(_+="0"),L=Math.sqrt(+_),z=w((z+1)/2)-(z<0||z%2),new K(_=L==1/0?"1e"+z:(_=L.toExponential()).slice(0,_.indexOf("e")+1)+z)):new K(L+"")).c[0]){for((L=(z=P.e)+$)<3&&(L=0);;)if(I=P,P=j.times(I.plus(Q(F,I,$,1))),y(I.c).slice(0,L)===(_=y(P.c)).slice(0,L)){if(P.e<z&&--L,(_=_.slice(L-3,L+1))!="9999"&&(V||_!="4999")){+_&&(+_.slice(1)||_.charAt(0)!="5")||($e(P,P.e+H+2,1),R=!P.times(P).eq(F));break}if(!V&&($e(I,I.e+H+2,0),I.times(I).eq(F))){P=I;break}$+=4,L+=4,V=1}}return $e(P,P.e+H+1,D,R)},S.toExponential=function(R,_){return R!=null&&(T(R,0,p),R++),ft(this,R,_,1)},S.toFixed=function(R,_){return R!=null&&(T(R,0,p),R=R+this.e+1),ft(this,R,_)},S.toFormat=function(R,_,P){var V;if(P==null)R!=null&&_&&typeof _=="object"?(P=_,_=null):R&&typeof R=="object"?(P=R,R=_=null):P=Ie;else if(typeof P!="object")throw Error(c+"Argument not an object: "+P);if(V=this.toFixed(R,_),this.c){var I,F=V.split("."),N=+P.groupSize,L=+P.secondaryGroupSize,z=P.groupSeparator||"",$=F[0],j=F[1],ae=this.s<0,me=ae?$.slice(1):$,Te=me.length;if(L&&(I=N,N=L,Te-=L=I),0<N&&0<Te){for(I=Te%N||N,$=me.substr(0,I);I<Te;I+=N)$+=z+me.substr(I,N);0<L&&($+=z+me.slice(I)),ae&&($="-"+$)}V=j?$+(P.decimalSeparator||"")+((L=+P.fractionGroupSize)?j.replace(new RegExp("\\d{"+L+"}\\B","g"),"$&"+(P.fractionGroupSeparator||"")):j):$}return(P.prefix||"")+V+(P.suffix||"")},S.toFraction=function(R){var _,P,V,I,F,N,L,z,$,j,ae,me,Te=this,Ae=Te.c;if(R!=null&&(!(L=new K(R)).isInteger()&&(L.c||L.s!==1)||L.lt(O)))throw Error(c+"Argument "+(L.isInteger()?"out of range: ":"not an integer: ")+Me(L));if(!Ae)return new K(Te);for(_=new K(O),$=P=new K(O),V=z=new K(O),me=y(Ae),F=_.e=me.length-Te.e-1,_.c[0]=C[(N=F%f)<0?f+N:N],R=!R||0<L.comparedTo(_)?0<F?_:$:L,N=re,re=1/0,L=new K(me),z.c[0]=0;j=Q(L,_,0,1),(I=P.plus(j.times(V))).comparedTo(R)!=1;)P=V,V=I,$=z.plus(j.times(I=$)),z=I,_=L.minus(j.times(I=_)),L=I;return I=Q(R.minus(P),V,0,1),z=z.plus(I.times($)),P=P.plus(I.times(V)),z.s=$.s=Te.s,ae=Q($,V,F*=2,D).minus(Te).abs().comparedTo(Q(z,P,F,D).minus(Te).abs())<1?[$,V]:[z,P],re=N,ae},S.toNumber=function(){return+Me(this)},S.toPrecision=function(R,_){return R!=null&&T(R,1,p),ft(this,R,_,2)},S.toString=function(R){var _,P=this,V=P.s,I=P.e;return I===null?V?(_="Infinity",V<0&&(_="-"+_)):_="NaN":(_=R==null?I<=X||G<=I?A(y(P.c),I):W(y(P.c),I,"0"):R===10?W(y((P=$e(new K(P),H+I+1,D)).c),P.e,"0"):(T(R,2,Le.length,"Base"),te(W(y(P.c),I,"0"),10,R,V,!0)),V<0&&P.c[0]&&(_="-"+_)),_},S.valueOf=S.toJSON=function(){return Me(this)},S._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(S[Symbol.toStringTag]="BigNumber",S[Symbol.for("nodejs.util.inspect.custom")]=S.valueOf),U!=null&&K.set(U),K}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,i){function o(w,y){return function(E){if(Array.isArray(E))return E}(w)||function(E,T){var x=[],A=!0,W=!1,B=void 0;try{for(var U,Q=E[Symbol.iterator]();!(A=(U=Q.next()).done)&&(x.push(U.value),!T||x.length!==T);A=!0);}catch(te){W=!0,B=te}finally{try{A||Q.return==null||Q.return()}finally{if(W)throw B}}return x}(w,y)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function d(w){var y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},E=2<arguments.length?arguments[2]:void 0;if(typeof y=="string"&&(y=l.parseFormat(y)),!a.validateFormat(y))return"ERROR: invalid format";var T=y.prefix||"",x=y.postfix||"",A=function(W,B,U){switch(B.output){case"currency":return B=p(B,s.currentCurrencyDefaultFormat()),function(Le,K,ft){var Ge=ft.currentCurrency(),Ne=Object.assign({},h,K),$e=void 0,Me="",R=!!Ne.totalLength||!!Ne.forceAverage||Ne.average,_=K.currencyPosition||Ge.position,P=K.currencySymbol||Ge.symbol;Ne.spaceSeparated&&(Me=" "),_==="infix"&&($e=Me+P+Me);var V=b({instance:Le,providedFormat:K,state:ft,decimalSeparator:$e});return _==="prefix"&&(V=Le._value<0&&Ne.negative==="sign"?"-".concat(Me).concat(P).concat(V.slice(1)):P+Me+V),_&&_!=="postfix"||(V=V+(Me=R?"":Me)+P),V}(W,B,s);case"percent":return B=p(B,s.currentPercentageDefaultFormat()),function(Le,K,ft,Ge){var Ne=K.prefixSymbol,$e=b({instance:Ge(100*Le._value),providedFormat:K,state:ft}),Me=Object.assign({},h,K);return Ne?"%".concat(Me.spaceSeparated?" ":"").concat($e):"".concat($e).concat(Me.spaceSeparated?" ":"","%")}(W,B,s,U);case"byte":return B=p(B,s.currentByteDefaultFormat()),O=W,D=s,X=U,G=(H=B).base||"binary",se=c[G],re=f(O._value,se.suffixes,se.scale),q=re.value,Ee=re.suffix,De=b({instance:X(q),providedFormat:H,state:D,defaults:D.currentByteDefaultFormat()}),Ie=D.currentAbbreviations(),"".concat(De).concat(Ie.spaced?" ":"").concat(Ee);case"time":return B=p(B,s.currentTimeDefaultFormat()),Y=W,g=Math.floor(Y._value/60/60),v=Math.floor((Y._value-60*g*60)/60),S=Math.round(Y._value-60*g*60-60*v),"".concat(g,":").concat(v<10?"0":"").concat(v,":").concat(S<10?"0":"").concat(S);case"ordinal":return B=p(B,s.currentOrdinalDefaultFormat()),Q=W,te=B,he=(ee=s).currentOrdinal(),_e=Object.assign({},h,te),Ue=b({instance:Q,providedFormat:te,state:ee}),ke=he(Q._value),"".concat(Ue).concat(_e.spaceSeparated?" ":"").concat(ke);case"number":default:return b({instance:W,providedFormat:B,numbro:U})}var Q,te,ee,he,_e,Ue,ke,Y,g,v,S,O,H,D,X,G,se,re,q,Ee,De,Ie}(w,y,E);return A=(A=T+A)+x}function f(w,y,E){var T=y[0],x=Math.abs(w);if(E<=x){for(var A=1;A<y.length;++A){var W=Math.pow(E,A),B=Math.pow(E,A+1);if(W<=x&&x<B){T=y[A],w/=W;break}}T===y[0]&&(w/=Math.pow(E,y.length-1),T=y[y.length-1])}return{value:w,suffix:T}}function m(w){for(var y="",E=0;E<w;E++)y+="0";return y}function C(w,y){return w.toString().indexOf("e")!==-1?function(E,T){var x=E.toString(),A=o(x.split("e"),2),W=A[0],B=A[1],U=o(W.split("."),2),Q=U[0],te=U[1],ee=te===void 0?"":te;if(0<+B)x=Q+ee+m(B-ee.length);else{var he=".";he=+Q<0?"-0".concat(he):"0".concat(he);var _e=(m(-B-1)+Math.abs(Q)+ee).substr(0,T);_e.length<T&&(_e+=m(T-_e.length)),x=he+_e}return 0<+B&&0<T&&(x+=".".concat(m(T))),x}(w,y):(Math.round(+"".concat(w,"e+").concat(y))/Math.pow(10,y)).toFixed(y)}function b(w){var y=w.instance,E=w.providedFormat,T=w.state,x=T===void 0?s:T,A=w.decimalSeparator,W=w.defaults,B=W===void 0?x.currentDefaults():W,U=y._value;if(U===0&&x.hasZeroFormat())return x.getZeroFormat();if(!isFinite(U))return U.toString();var Q,te,ee,he,_e,Ue,ke,Y,g=Object.assign({},h,B,E),v=g.totalLength,S=v?0:g.characteristic,O=g.optionalCharacteristic,H=g.forceAverage,D=!!v||!!H||g.average,X=v?-1:D&&E.mantissa===void 0?0:g.mantissa,G=!v&&(E.optionalMantissa===void 0?X===-1:g.optionalMantissa),se=g.trimMantissa,re=g.thousandSeparated,q=g.spaceSeparated,Ee=g.negative,De=g.forceSign,Ie=g.exponential,Le="";if(D){var K=function(R){var _=R.value,P=R.forceAverage,V=R.abbreviations,I=R.spaceSeparated,F=I!==void 0&&I,N=R.totalLength,L=N===void 0?0:N,z="",$=Math.abs(_),j=-1;if($>=Math.pow(10,12)&&!P||P==="trillion"?(z=V.trillion,_/=Math.pow(10,12)):$<Math.pow(10,12)&&$>=Math.pow(10,9)&&!P||P==="billion"?(z=V.billion,_/=Math.pow(10,9)):$<Math.pow(10,9)&&$>=Math.pow(10,6)&&!P||P==="million"?(z=V.million,_/=Math.pow(10,6)):($<Math.pow(10,6)&&$>=Math.pow(10,3)&&!P||P==="thousand")&&(z=V.thousand,_/=Math.pow(10,3)),z&&(z=(F?" ":"")+z),L){var ae=_.toString().split(".")[0];j=Math.max(L-ae.length,0)}return{value:_,abbreviation:z,mantissaPrecision:j}}({value:U,forceAverage:H,abbreviations:x.currentAbbreviations(),spaceSeparated:q,totalLength:v});U=K.value,Le+=K.abbreviation,v&&(X=K.mantissaPrecision)}if(Ie){var ft=(te=(Q={value:U,characteristicPrecision:S}).value,ee=Q.characteristicPrecision,he=ee===void 0?0:ee,_e=o(te.toExponential().split("e"),2),Ue=_e[0],ke=_e[1],Y=+Ue,he&&1<he&&(Y*=Math.pow(10,he-1),ke=0<=(ke=+ke-(he-1))?"+".concat(ke):ke),{value:Y,abbreviation:"e".concat(ke)});U=ft.value,Le=ft.abbreviation+Le}var Ge,Ne,$e,Me=function(R,_,P,V,I){if(V===-1)return R;var F=C(_,V),N=o(F.toString().split("."),2),L=N[0],z=N[1],$=z===void 0?"":z;if($.match(/^0+$/)&&(P||I))return L;var j=$.match(/0+$/);return I&&j?"".concat(L,".").concat($.toString().slice(0,j.index)):F.toString()}(U.toString(),U,G,X,se);return Me=function(R,_,P,V,I){var F=V.currentDelimiters(),N=F.thousands;I=I||F.decimal;var L=F.thousandsSize||3,z=R.toString(),$=z.split(".")[0],j=z.split(".")[1];return P&&(_<0&&($=$.slice(1)),function(ae,me){for(var Te=[],Ae=0,ze=ae;0<ze;ze--)Ae===me&&(Te.unshift(ze),Ae=0),Ae++;return Te}($.length,L).forEach(function(ae,me){$=$.slice(0,ae+me)+N+$.slice(ae+me)}),_<0&&($="-".concat($))),z=j?$+I+j:$}(Me=function(R,_,P,V){var I=R,F=o(I.toString().split("."),2),N=F[0],L=F[1];if(N.match(/^-?0$/)&&P)return L?"".concat(N.replace("0",""),".").concat(L):N.replace("0","");if(N.length<V)for(var z=V-N.length,$=0;$<z;$++)I="0".concat(I);return I.toString()}(Me,0,O,S),U,re,x,A),(D||Ie)&&(Me=Me+Le),(De||U<0)&&(Ge=Me,$e=Ee,Me=(Ne=U)===0?Ge:+Ge==0?Ge.replace("-",""):0<Ne?"+".concat(Ge):$e==="sign"?Ge:"(".concat(Ge.replace("-",""),")")),Me}function p(w,y){if(!w)return y;var E=Object.keys(w);return E.length===1&&E[0]==="output"?y:w}r.exports=function(w){return{format:function(){for(var y=arguments.length,E=new Array(y),T=0;T<y;T++)E[T]=arguments[T];return d.apply(void 0,E.concat([w]))},getByteUnit:function(){for(var y=arguments.length,E=new Array(y),T=0;T<y;T++)E[T]=arguments[T];return(function(x){var A=c.general;return f(x._value,A.suffixes,A.scale).suffix}).apply(void 0,E.concat([w]))},getBinaryByteUnit:function(){for(var y=arguments.length,E=new Array(y),T=0;T<y;T++)E[T]=arguments[T];return(function(x){var A=c.binary;return f(x._value,A.suffixes,A.scale).suffix}).apply(void 0,E.concat([w]))},getDecimalByteUnit:function(){for(var y=arguments.length,E=new Array(y),T=0;T<y;T++)E[T]=arguments[T];return(function(x){var A=c.decimal;return f(x._value,A.suffixes,A.scale).suffix}).apply(void 0,E.concat([w]))},formatOrDefault:p}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,i){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},h=null,d={};function f(C){u=C}function m(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return m().currency},l.currentAbbreviations=function(){return m().abbreviations},l.currentDelimiters=function(){return m().delimiters},l.currentOrdinal=function(){return m().ordinal},l.currentDefaults=function(){return Object.assign({},m().defaults,d)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().timeFormat)},l.setDefaults=function(C){C=a.parseFormat(C),s.validateFormat(C)&&(d=C)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(C){return h=typeof C=="string"?C:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(C){if(C){if(c[C])return c[C];throw new Error('Unknown tag "'.concat(C,'"'))}return m()},l.registerLanguage=function(C){var b=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(C))throw new Error("Invalid language data");c[C.languageTag]=C,b&&f(C.languageTag)},l.setLanguage=function(C){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[C]){var p=C.split("-")[0],w=Object.keys(c).find(function(y){return y.split("-")[0]===p});return c[w]?void f(w):void f(b)}f(C)},l.registerLanguage(o),u=o.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,i){r.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,r,i){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),h=l;return u.isNumbro(l)&&(h=l._value),h=new o(h),a._value=c.minus(h).toNumber(),a}r.exports=function(a){return{add:function(l,u){return h=u,d=a,f=new o((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new o(m),c._value=f.plus(m).toNumber(),c;var c,h,d,f,m},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return h=u,d=a,f=new o((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new o(m),c._value=f.times(m).toNumber(),c;var c,h,d,f,m},divide:function(l,u){return h=u,d=a,f=new o((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new o(m),c._value=f.dividedBy(m).toNumber(),c;var c,h,d,f,m},set:function(l,u){return c=l,d=h=u,a.isNumbro(h)&&(d=h._value),c._value=d,c;var c,h,d},difference:function(l,u){return c=u,s(d=(h=a)(l._value),c,h),Math.abs(d._value);var c,h,d}}}},{"bignumber.js":1}],7:[function(n,r,i){function o(b,p){for(var w=0;w<p.length;w++){var y=p[w];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(b,y.key,y)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(C),u=n("./unformatting"),c=n("./formatting")(C),h=n("./manipulating")(C),d=n("./parsing"),f=function(){function b(y){(function(E,T){if(!(E instanceof T))throw new TypeError("Cannot call a class as a function")})(this,b),this._value=y}var p,w;return p=b,(w=[{key:"clone",value:function(){return C(this._value)}},{key:"format",value:function(){var y=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,y)}},{key:"formatCurrency",value:function(y){return typeof y=="string"&&(y=d.parseFormat(y)),(y=c.formatOrDefault(y,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,y)}},{key:"formatTime",value:function(){var y=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return y.output="time",c.format(this,y)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(y){return h.difference(this,y)}},{key:"add",value:function(y){return h.add(this,y)}},{key:"subtract",value:function(y){return h.subtract(this,y)}},{key:"multiply",value:function(y){return h.multiply(this,y)}},{key:"divide",value:function(y){return h.divide(this,y)}},{key:"set",value:function(y){return h.set(this,m(y))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(p.prototype,w),b}();function m(b){var p=b;return C.isNumbro(b)?p=b._value:typeof b=="string"?p=C.unformat(b):isNaN(b)&&(p=NaN),p}function C(b){return new f(m(b))}C.version="2.1.2",C.isNumbro=function(b){return b instanceof f},C.language=s.currentLanguage,C.registerLanguage=s.registerLanguage,C.setLanguage=s.setLanguage,C.languages=s.languages,C.languageData=s.languageData,C.zeroFormat=s.setZeroFormat,C.defaultFormat=s.currentDefaults,C.setDefaults=s.setDefaults,C.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,C.validate=a.validate,C.loadLanguagesInNode=l.loadLanguagesInNode,C.unformat=u.unformat,r.exports=C},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,i){r.exports={parseFormat:function(o){var s,a,l,u,c,h,d,f,m,C,b,p,w,y,E,T,x,A,W,B,U=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=U,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=U,function(Q,te){if(Q.indexOf("$")===-1){if(Q.indexOf("%")===-1)return Q.indexOf("bd")!==-1?(te.output="byte",te.base="general"):Q.indexOf("b")!==-1?(te.output="byte",te.base="binary"):Q.indexOf("d")!==-1?(te.output="byte",te.base="decimal"):Q.indexOf(":")===-1?Q.indexOf("o")!==-1&&(te.output="ordinal"):te.output="time";te.output="percent"}else te.output="currency"}(o=(h=(u=o).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,U),d=U,(f=o.match(/[1-9]+[0-9]*/))&&(d.totalLength=+f[0]),m=U,(C=o.split(".")[0].match(/0+/))&&(m.characteristic=C[0].length),function(Q,te){if(Q.indexOf(".")!==-1){var ee=Q.split(".")[0];te.optionalCharacteristic=ee.indexOf("0")===-1}}(o,U),b=U,o.indexOf("a")!==-1&&(b.average=!0),w=U,(p=o).indexOf("K")!==-1?w.forceAverage="thousand":p.indexOf("M")!==-1?w.forceAverage="million":p.indexOf("B")!==-1?w.forceAverage="billion":p.indexOf("T")!==-1&&(w.forceAverage="trillion"),function(Q,te){var ee=Q.split(".")[1];if(ee){var he=ee.match(/0+/);he&&(te.mantissa=he[0].length)}}(o,U),E=U,(y=o).match(/\[\.]/)?E.optionalMantissa=!0:y.match(/\./)&&(E.optionalMantissa=!1),T=U,o.indexOf(",")!==-1&&(T.thousandSeparated=!0),x=U,o.indexOf(" ")!==-1&&(x.spaceSeparated=!0),W=U,(A=o).match(/^\+?\([^)]*\)$/)&&(W.negative="parenthesis"),A.match(/^\+?-/)&&(W.negative="sign"),B=U,o.match(/^\+/)&&(B.forceSign=!0),U)}}},{}],9:[function(n,r,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,f=5<arguments.length?arguments[5]:void 0,m=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===d?0:function C(b,p){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",y=3<arguments.length?arguments[3]:void 0,E=4<arguments.length?arguments[4]:void 0,T=5<arguments.length?arguments[5]:void 0,x=6<arguments.length?arguments[6]:void 0;if(!isNaN(+b))return+b;var A="",W=b.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(W!==b)return-1*C(W,p,w,y,E,T,x);for(var B=0;B<o.length;B++){var U=o[B];if((A=b.replace(U.key,""))!==b)return C(A,p,w,y,E,T,x)*U.factor}if((A=b.replace("%",""))!==b)return C(A,p,w,y,E,T,x)/100;var Q=parseFloat(b);if(!isNaN(Q)){var te=y(Q);if(te&&te!=="."&&(A=b.replace(new RegExp("".concat(s(te),"$")),""))!==b)return C(A,p,w,y,E,T,x);var ee={};Object.keys(T).forEach(function(v){ee[T[v]]=v});for(var he=Object.keys(ee).sort().reverse(),_e=he.length,Ue=0;Ue<_e;Ue++){var ke=he[Ue],Y=ee[ke];if((A=b.replace(ke,""))!==b){var g=void 0;switch(Y){case"thousand":g=Math.pow(10,3);break;case"million":g=Math.pow(10,6);break;case"billion":g=Math.pow(10,9);break;case"trillion":g=Math.pow(10,12)}return C(A,p,w,y,E,T,x)*g}}}}(function(C,b){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",w=C.replace(p,"");return w=(w=w.replace(new RegExp("([0-9])".concat(s(b.thousands),"([0-9])"),"g"),"$1$2")).replace(b.decimal,".")}(l,u,c),u,c,h,d,f,m)}r.exports={unformat:function(l,u){var c,h,d,f=n("./globalState"),m=f.currentDelimiters(),C=f.currentCurrency().symbol,b=f.currentOrdinal(),p=f.getZeroFormat(),w=f.currentAbbreviations(),y=void 0;if(typeof l=="string")y=function(E,T){if(!E.indexOf(":")||T.thousands===":")return!1;var x=E.split(":");if(x.length!==3)return!1;var A=+x[0],W=+x[1],B=+x[2];return!isNaN(A)&&!isNaN(W)&&!isNaN(B)}(l,m)?(c=l.split(":"),h=+c[0],d=+c[1],+c[2]+60*d+3600*h):a(l,m,C,b,p,w,u);else{if(typeof l!="number")return;y=l}if(y!==void 0)return y}}},{"./globalState":4}],10:[function(n,r,i){function o(m){return function(C){if(Array.isArray(C)){for(var b=0,p=new Array(C.length);b<C.length;b++)p[b]=C[b];return p}}(m)||function(C){if(Symbol.iterator in Object(C)||Object.prototype.toString.call(C)==="[object Arguments]")return Array.from(C)}(m)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(m){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(m)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(m,C){return C.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(m){return m.output==="byte"}},characteristic:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(m){return 0<=m},message:"value must be positive"},{restriction:function(m,C){return!C.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(m,C){return C.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(m){return m.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(m){return!!a.unformat(m)}function d(m,C,b){var p=3<arguments.length&&arguments[3]!==void 0&&arguments[3],w=Object.keys(m).map(function(y){if(!C[y])return console.error("".concat(b," Invalid key: ").concat(y)),!1;var E=m[y],T=C[y];if(typeof T=="string"&&(T={type:T}),T.type==="format"){if(!d(E,u,"[Validate ".concat(y,"]"),!0))return!1}else if(s(E)!==T.type)return console.error("".concat(b," ").concat(y,' type mismatched: "').concat(T.type,'" expected, "').concat(s(E),'" provided')),!1;if(T.restrictions&&T.restrictions.length)for(var x=T.restrictions.length,A=0;A<x;A++){var W=T.restrictions[A],B=W.restriction,U=W.message;if(!B(E,m))return console.error("".concat(b," ").concat(y," invalid value: ").concat(U)),!1}return T.restriction&&!T.restriction(E,m)?(console.error("".concat(b," ").concat(y," invalid value: ").concat(T.message)),!1):T.validValues&&T.validValues.indexOf(E)===-1?(console.error("".concat(b," ").concat(y," invalid value: must be among ").concat(JSON.stringify(T.validValues),', "').concat(E,'" provided')),!1):!(T.children&&!d(E,T.children,"[Validate ".concat(y,"]")))});return p||w.push.apply(w,o(Object.keys(C).map(function(y){var E=C[y];if(typeof E=="string"&&(E={type:E}),E.mandatory){var T=E.mandatory;if(typeof T=="function"&&(T=T(m)),T&&m[y]===void 0)return console.error("".concat(b,' Missing mandatory key "').concat(y,'"')),!1}return!0}))),w.reduce(function(y,E){return y&&E},!0)}function f(m){return d(m,u,"[Validate format]")}r.exports={validate:function(m,C){var b=h(m),p=f(C);return b&&p},validateFormat:f,validateInput:h,validateLanguage:function(m){return d(m,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})($U);var nue=$U.exports;const bl=Av(nue),rue="numeric";function dx(t,e,n,r,i,o,s){let a=o;if(wr(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,h=s.className||"",d=h.length?h.split(" "):[];if(typeof u<"u"&&!bl.languages()[u]){const f=u.replace("-",""),m=bl.allLanguages?bl.allLanguages[u]:bl[f];m&&bl.registerLanguage(m)}bl.setLanguage(u),a=bl(a).format(c||"0"),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),s.className=d.join(" "),e.dir="ltr"}qs(t,e,n,r,i,a,s)}dx.RENDERER_TYPE=rue;const iue="password";function fx(t,e,n,r,i,o,s){qs.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";Se(a-1,()=>{u+=l}),Ru(e,u)}fx.RENDERER_TYPE=iue;const oue="select";function gx(t,e,n,r,i,o,s){qs.apply(this,[t,e,n,r,i,o,s])}gx.RENDERER_TYPE=oue;const sue="time";function mx(t,e,n,r,i,o,s){qs.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}mx.RENDERER_TYPE=sue;function aue(){Yr(_h),Yr(Tg),Yr(ux),Yr(lx),Yr(hx),Yr(ax),Yr(dx),Yr(fx),Yr(gx),Yr(qs),Yr(mx)}const lue="autocomplete";function GC(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,VI(n,e)):VI(n,e)(this.source):e(!0)}GC.VALIDATOR_TYPE=lue;function VI(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function FU(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const uue=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:FU},Symbol.toStringTag,{value:"Module"})),cue="date";function px(t,e){const n=B2(AU,this.instance);let r=t,i=!0;r==null&&(r="");let o=Z(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Z(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=hue(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}px.VALIDATOR_TYPE=cue;function hue(t,e){const n=Z(FU(t)),r=Z(t,e),i=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const due="dropdown";function wx(t,e){GC.apply(this,[t,e])}wx.VALIDATOR_TYPE=due;const fue="numeric";function vx(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:wr(t))}vx.VALIDATOR_TYPE=fue;const gue=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],mue="time";function Cx(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Z(i,gue,!0).isValid()?Z(i):Z(i,n);let a=s.isValid(),l=Z(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,h,u,"timeValidator"),r=!0}else r=!1;e(r)}Cx.VALIDATOR_TYPE=mue;function pue(){Gl(GC),Gl(wx),Gl(px),Gl(vx),Gl(Cx)}const wue="autocomplete",vue={CELL_TYPE:wue,editor:ix,renderer:_h,validator:GC},Cue="checkbox",yue={CELL_TYPE:Cue,editor:OU,renderer:ux},Sue="date";function WU(t,e,n,r,i,o,s){_h.apply(this,[t,e,n,r,i,o,s])}WU.RENDERER_TYPE=Sue;const bue="date",Rue={CELL_TYPE:bue,editor:IU,renderer:WU,validator:px},Eue="dropdown",Tue={CELL_TYPE:Eue,editor:sx,renderer:lx,validator:wx},_ue="handsontable",Mue={CELL_TYPE:_ue,editor:rx,renderer:hx},xue="numeric",Pue={CELL_TYPE:xue,editor:HU,renderer:dx,validator:vx,dataType:"number"},Oue="password",Aue={CELL_TYPE:Oue,editor:DU,renderer:fx,copyable:!1},Iue="select",Hue={CELL_TYPE:Iue,editor:NU,renderer:gx},Due="time",Nue={CELL_TYPE:Due,editor:kU,renderer:mx,validator:Cx};function kue(){gi(vue),gi(yue),gi(Rue),gi(Tue),gi(Mue),gi(Pue),gi(Aue),gi(Hue),gi(hU),gi(Nue)}function Lue(t,e){VU(t,e),e.add(t)}function $ue(t,e,n){VU(t,e),e.set(t,n)}function VU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vu(t,e,n){return e=Fue(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fue(t){var e=Wue(t,"string");return typeof e=="symbol"?e:String(e)}function Wue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vue(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Bu(t,e){var n=Bue(t,e,"get");return Uue(t,n)}function Bue(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Uue(t,e){return e.get?e.get.call(t):e.value}const BI=new Map([["plugin",_J],["cell-type",tU],["editor",V2],["renderer",q2],["validator",Q2]]),zue="base",JS=[];let bo=null;var Rl=new WeakMap,UI=new WeakSet;class ut{static get PLUGIN_KEY(){return zue}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){Lue(this,UI),Vu(this,"eventManager",new Oi(this)),Vu(this,"pluginName",null),Vu(this,"pluginsInitializedCallbacks",[]),Vu(this,"isPluginsReady",!1),Vu(this,"enabled",!1),Vu(this,"initialized",!1),$ue(this,Rl,{writable:!0,value:{}}),Qo(this,"hot",e,{writable:!1}),bo=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!BI.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);BI.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");JS.push(o)}}if(bo||(bo=G1()),bo.indexOf("UndoRedo")>=0&&bo.splice(bo.indexOf("UndoRedo"),1),bo.indexOf(this.pluginName)>=0&&bo.splice(bo.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),bo.length===0){if(JS.length>0){const i=[`${JS.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){Bu(this,Rl)[e]=Bu(this,Rl)[e]||[];const r=Bu(this,Rl)[e];this.hot.addHook(e,n),r.push(n),Bu(this,Rl)[e]=r}removeHooks(e){M(Bu(this,Rl)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Bu(this,Rl);Ke(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){M(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=Vue(this,UI,jue).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ke(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function jue(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function El(t,e,n){return e=Gue(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gue(t){var e=Yue(t,"string");return typeof e=="symbol"?e:String(e)}function Yue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Kue=class{constructor(e){El(this,"hot",null),El(this,"container",null),El(this,"injected",!1),El(this,"rows",[]),El(this,"columns",[]),El(this,"samples",null),El(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),M(this.rows,n=>{e(n.row,Ut(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),M(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{M(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{M(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{M(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),M(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{M(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),J(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return J(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const yx=Kue;function $m(t,e,n){return e=Xue(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xue(t){var e=que(t,"string");return typeof e=="symbol"?e:String(e)}function que(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sx{static get SAMPLE_COUNT(){return 3}constructor(e){$m(this,"samples",null),$m(this,"dataFactory",null),$m(this,"customSampleCount",null),$m(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Sx.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return Se(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return Se(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:je(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Zt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}const BU=Sx;function Uu(t,e){UU(t,e),e.add(t)}function Que(t,e,n){UU(t,e),e.set(t,n)}function UU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zu(t,e,n){return e=Zue(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zue(t){var e=Jue(t,"string");return typeof e=="symbol"?e:String(e)}function Jue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ece(t,e,n){var r=zU(t,e,"set");return tce(t,r,n),n}function tce(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Fm(t,e){var n=zU(t,e,"get");return nce(t,n)}function zU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function nce(t,e){return e.get?e.get.call(t):e.value}function Tl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}we.getSingleton().register("modifyAutoColumnSizeSeed");const od="autoColumnSize",rce=10,ice="autoColumnSize";var Sc=new WeakMap,zI=new WeakSet,jI=new WeakSet,GI=new WeakSet,eb=new WeakSet,YI=new WeakSet,KI=new WeakSet;class of extends ut{static get PLUGIN_KEY(){return od}static get PLUGIN_PRIORITY(){return rce}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Uu(this,KI),Uu(this,YI),Uu(this,eb),Uu(this,GI),Uu(this,jI),Uu(this,zI),zu(this,"ghostTable",new yx(this.hot)),zu(this,"samplesGenerator",new BU((n,r)=>{const i=this.hot.getCellMeta(n,r);let o="";i.spanned||(o=this.hot.getDataAtCell(n,r));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}})),zu(this,"firstCalculation",!0),zu(this,"inProgress",!1),zu(this,"measuredColumns",0),zu(this,"columnWidthsMap",new cl),Que(this,Sc,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(ice,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Tl(this,eb,XI).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[od]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[od];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Tl(e,jI,sce).call(e,...i)}),this.addHook("beforeChangeRender",r=>Tl(this,GI,ace).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>Tl(this,KI,uce).call(this,r)),this.addHook("beforeViewRender",r=>Tl(this,zI,oce).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>Tl(this,YI,lce).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Tl(this,eb,XI).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;Se(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(s,o);M(l,u=>{let[c,h]=u;return this.ghostTable.addColumn(c,h)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){Uf(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+of.CALCULATION_STEP,r)},e),n=n+of.CALCULATION_STEP+1,n<r?i=RC(o):(Uf(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[od],n=e&&Bt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Bt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[od];let n=of.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return je(e)&&(n=e.syncLimit,b1(n)?n=z1(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,Sg.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader();return an(e,(r,i,o)=>{const s=Fm(this,Sc).length;return(s-1<o||Fm(this,Sc)[o]!==i)&&r.push(o),s-1<o?Fm(this,Sc).push(i):Fm(this,Sc)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{M(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!oi(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function oce(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function sce(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function ace(t){const e=Ye(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function XI(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function lce(){ece(this,Sc,this.hot.getColHeader())}function uce(t){const e=oi(t,r=>{var i;return fe((i=r.address)===null||i===void 0?void 0:i.col)}),n=Ye(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}const Zl={horizontal:"horizontal",vertical:"vertical"};function cce(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function hce(t){const e={};return t===!0?(e.directions=Object.keys(Zl),e.autoInsertRow=!0):je(t)?(fe(t.autoInsertRow)?t.direction===Zl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,fe(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Zl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function sd(t,e){dce(t,e),e.add(t)}function dce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ju(t,e,n){return e=fce(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fce(t){var e=gce(t,"string");return typeof e=="symbol"?e:String(e)}function gce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ad(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}we.getSingleton().register("modifyAutofillRange");we.getSingleton().register("beforeAutofill");we.getSingleton().register("afterAutofill");const qI="autofill",mce=20,pce=["fillHandle"],wce="insert_row_below",vce=200;var QI=new WeakSet,ZI=new WeakSet,JI=new WeakSet,eH=new WeakSet,tH=new WeakSet;class Cce extends ut{constructor(){super(...arguments),sd(this,tH),sd(this,eH),sd(this,JI),sd(this,ZI),sd(this,QI),ju(this,"addingStarted",!1),ju(this,"mouseDownOnCellCorner",!1),ju(this,"mouseDragOutside",!1),ju(this,"handleDraggedCells",0),ju(this,"directions",[]),ju(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return qI}static get PLUGIN_PRIORITY(){return mce}static get SETTING_KEYS(){return[qI,...pce]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>ad(this,ZI,Sce).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>ad(this,QI,yce).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>ad(this,JI,bce).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return M(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),M(a,c=>{const h=[];M(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=cce(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),m=o.clone(),C=this.hot._createCellRange(h,h,d),b=this.hot.runHooks("beforeAutofill",f,m,C,c);if(b===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let p=b;const w=b;if(["up","left"].indexOf(c)>-1&&!(w.length===1&&w[0].length===0))if(p=[],c==="up"){const y=d.row-h.row+1,E=y%w.length;for(let T=0;T<y;T++)p.push(w[(T+(w.length-E))%w.length])}else{const y=d.col-h.col+1,E=y%w[0].length;for(let T=0;T<w.length;T++){p.push([]);for(let x=0;x<y;x++)p[T].push(w[T][(x+(w[T].length-E))%w[T].length])}}this.hot.populateFromArray(h.row,h.col,p,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",p,m,C,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Zl.vertical)&&this.directions.includes(Zl.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Zl.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Zl.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(wce,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},vce)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;const s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ye(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=yn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Ut(this.hot.table),i=yn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+vt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>ad(this,eH,Rce).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>ad(this,tH,Ece).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=hce(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function yce(){this.selectAdjacent()&&this.fillIn()}function Sce(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function bce(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Rce(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Ece(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Wm(t,e){Tce(t,e),e.add(t)}function Tce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _l(t,e,n){return e=_ce(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ce(t){var e=Mce(t,"string");return typeof e=="symbol"?e:String(e)}function Mce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ld(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Vm="autoRowSize",xce=40,Pce="autoRowSize";var nH=new WeakSet,tb=new WeakSet,rH=new WeakSet,iH=new WeakSet;class sf extends ut{static get PLUGIN_KEY(){return Vm}static get PLUGIN_PRIORITY(){return xce}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Wm(this,iH),Wm(this,rH),Wm(this,tb),Wm(this,nH),_l(this,"headerHeight",null),_l(this,"ghostTable",new yx(this.hot)),_l(this,"samplesGenerator",new BU((n,r)=>{if(n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let i;return n>=0?i=this.hot.getDataAtCell(n,r):n===-1&&(i=this.hot.getColHeader(r)),{value:i}})),_l(this,"firstCalculation",!0),_l(this,"inProgress",!1),_l(this,"measuredRows",0),_l(this,"rowHeightsMap",new cl),this.hot.rowIndexMapper.registerMap(Pce,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>ld(this,tb,oH).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[Vm];return e===!0||je(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ld(e,rH,Ace).call(e,...r)}),this.addHook("beforeChangeRender",n=>ld(this,iH,Ice).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>ld(this,nH,Oce).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>ld(this,tb,oH).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}Se(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const a=this.samplesGenerator.generateRowSamples(s,o);M(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){Uf(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+sf.CALCULATION_STEP,r)},e),n=n+sf.CALCULATION_STEP+1,n<r?i=RC(o):(Uf(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[Vm],n=e&&Bt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Bt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){Za(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Vm];let n=sf.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return je(e)&&(n=e.syncLimit,b1(n)?n=z1(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Se(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!oi(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Oce(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function oH(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function Ace(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function Ice(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}const{getListWithInsertedItems:Hce,getListWithRemovedItems:Dce}=HB("physicallyIndexed");class Nce extends Eu{constructor(){super(e=>e)}insert(e,n){const r=v_(this.indexedValues,n);this.indexedValues=Hce(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=Dce(this.indexedValues,e);this.indexedValues=w_(n,e),super.remove(e)}}const kce=Nce,{getListWithInsertedItems:Lce,getListWithRemovedItems:$ce}=HB("physicallyIndexed");class Fce extends Eu{constructor(){super(e=>e)}insert(e,n){this.indexedValues=Lce(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=$ce(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const Wce=Fce;function Vce(t,e){Bce(t,e),e.add(t)}function Bce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uce(t,e,n){return e=zce(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zce(t){var e=jce(t,"string");return typeof e=="symbol"?e:String(e)}function jce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gce(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const nb="bindRowsWithHeaders",Yce=210,Kce="loose",Xce=new Map([["loose",kce],["strict",Wce]]);var sH=new WeakSet;class qce extends ut{constructor(){super(...arguments),Vce(this,sH),Uce(this,"headerIndexes",null)}static get PLUGIN_KEY(){return nb}static get PLUGIN_PRIORITY(){return Yce}isEnabled(){return!!this.hot.getSettings()[nb]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[nb];typeof e!="string"&&(e=Kce);const n=Xce.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>Gce(this,sH,Qce).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Qce(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Bm(t,e){jU(t,e),e.add(t)}function Zce(t,e,n){jU(t,e),e.set(t,n)}function jU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aH(t,e,n){return e=Jce(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jce(t){var e=ehe(t,"string");return typeof e=="symbol"?e:String(e)}function ehe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lH(t,e){var n=GU(t,e,"get");return the(t,n)}function the(t,e){return e.get?e.get.call(t):e.value}function Um(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function rb(t,e,n){var r=GU(t,e,"set");return nhe(t,r,n),n}function GU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function nhe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const qp="collapsibleColumns",rhe=290,ihe=["nestedHeaders"],qc="collapsibleIndicator",uH=qp,cH=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Gu=new WeakMap,hH=new WeakSet,dH=new WeakSet,fH=new WeakSet,gH=new WeakSet;class ohe extends ut{constructor(){super(...arguments),Bm(this,gH),Bm(this,fH),Bm(this,dH),Bm(this,hH),aH(this,"nestedHeadersPlugin",null),aH(this,"headerStateManager",null),Zce(this,Gu,{writable:!0,value:null})}static get PLUGIN_KEY(){return qp}static get PLUGIN_PRIORITY(){return rhe}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[qp,...ihe]}isEnabled(){return!!this.hot.getSettings()[qp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||yt("You need to configure the Nested Headers plugin in order to use collapsible headers."),rb(this,Gu,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Um(this,fH,lhe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Um(e,gH,uhe).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Um(e,hH,she).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Um(this,dH,ahe).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),rb(this,Gu,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:uH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uH)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};Se(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;Se(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${qc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${qc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${qc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!cH.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=oi(e,d=>{let{row:f}=d;return f<0});let i=r.length>0;M(r,d=>{var f;let{row:m,col:C}=d;const{collapsible:b,isCollapsed:p}=(f=this.headerStateManager.getHeaderSettings(m,C))!==null&&f!==void 0?f:{};if(!b||p&&n==="collapse"||!p&&n==="expand")return i=!1,!1});const o=[],s=[];i&&M(r,d=>{let{row:f,col:m}=d;const{colspanCompensation:C,affectedColumns:b,rollbackModification:p}=this.headerStateManager.triggerNodeModification(n,f,m);C>0&&(s.push(...b),o.push(p))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=y1([...a,...s]):n==="expand"&&(l=oi(a,d=>!s.includes(d)));const u=cH.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){M(o,d=>{d()});return}this.hot.batchExecution(()=>{M(s,d=>{lH(this,Gu).setValueAtIndex(this.hot.toPhysicalColumn(d),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return lH(this,Gu).getHiddenIndexes()}destroy(){rb(this,Gu,null),super.destroy()}}function she(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${qc}`);if(bu(e,[_i("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),J(u,qc),e.querySelector("div:first-child").appendChild(u)),We(u,["collapsed","expanded"]),s?(J(u,"collapsed"),Qa(u,"+"),l&&Pe(e,..._i(!1))):(J(u,"expanded"),Qa(u,"-"),l&&Pe(e,..._i(!0))),l&&Pe(u,...Gs());else{var c;(c=u)===null||c===void 0||c.remove()}}function ahe(t,e){He(t.target,qc)&&(He(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):He(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Di(t))}function lhe(){this.updatePlugin()}function uhe(t,e){e||this.updatePlugin()}function Ml(t,e,n){return e=che(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function che(t){var e=hhe(t,"string");return typeof e=="symbol"?e:String(e)}function hhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const dhe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],fhe=!1,ghe=!0,mhe=!0;class phe{constructor(e,n){Ml(this,"hot",void 0),Ml(this,"sortingStates",new OC),Ml(this,"sortEmptyCells",fhe),Ml(this,"indicator",ghe),Ml(this,"headerAction",mhe),Ml(this,"compareFunctionFactory",void 0),Ml(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){je(e)&&Ke(e,(n,r)=>{dhe.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return je(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(fe(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const sv="asc",av="desc",YU="colHeader";function whe(t){if(je(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[sv,av].includes(n)}function vhe(t){if(t.some(n=>whe(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function mH(t){if(t!==av)return t===sv?av:sv}function KU(t){return t.querySelector(`.${YU}`)}function XU(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function bx(t,e,n){return t===-1&&e>=0&&Ja(n)===!1}const Che="ascending",yhe="descending",qU="indicatorDisabled",QU="columnSorting",ZU="sortAction",JU=new Map([[sv,Che],[av,yhe]]);function She(t,e,n,r){const i=[QU];if(r&&i.push(ZU),n===!1)return i.push(qU),i;const o=t.getSortOrderOfColumn(e);return fe(o)&&i.push(JU.get(o)),i}function bhe(){return Array.from(JU.values()).concat(ZU,qU,QU)}function ez(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?jo:pn(i)?pn(o)?jo:s&&t==="asc"?qt:Qt:pn(o)?s&&t==="asc"?Qt:qt:isNaN(i)&&!isNaN(o)?t==="asc"?Qt:qt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?qt:Qt:i>o?t==="asc"?Qt:qt:jo}}const tz="default";function Rhe(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return jo;if(a){if(pn(r))return t==="asc"?qt:Qt;if(pn(i))return t==="asc"?Qt:qt}return isNaN(o)?Qt:isNaN(s)?qt:o<s?t==="asc"?qt:Qt:o>s?t==="asc"?Qt:qt:jo}}const Ehe="numeric";function The(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=pn(s),u=pn(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Qt;if(l===!1&&u)return qt}return d===!1&&f?t==="asc"?qt:Qt:d&&f===!1?t==="asc"?Qt:qt:d===!1&&f===!1?ez(t,e,n)(s,a):c===i&&h===r?t==="asc"?qt:Qt:c===r&&h===i?t==="asc"?Qt:qt:jo}}const _he="checkbox";function Mhe(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return jo;if(pn(r))return pn(i)?jo:o&&t==="asc"?qt:Qt;if(pn(i))return o&&t==="asc"?Qt:qt;const s=e.dateFormat,a=Z(r,s),l=Z(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?qt:Qt:l.isBefore(a)?t==="asc"?Qt:qt:jo:qt:Qt}}const xhe="date",{register:YC,getItem:pH,hasItem:Phe}=go("sorting.compareFunctionFactory"),{register:nz,getItem:Ohe}=go("sorting.mainSortComparator");function rz(t){return Phe(t)?pH(t):pH(tz)}YC(Ehe,Rhe);YC(_he,The);YC(xhe,Mhe);YC(tz,ez);const jo=0,qt=-1,Qt=1;function Ahe(t,e){const n=Ohe(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function Ihe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:rz(u.type))(l,u,d)(c,h)}(0)}}function zm(t,e){Hhe(t,e),e.add(t)}function Hhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jm(t,e,n){return e=Dhe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dhe(t){var e=Nhe(t,"string");return typeof e=="symbol"?e:String(e)}function Nhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bc(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const lv="columnSorting",khe=50,uv="append",Lhe="replace",wH=lv;nz(lv,Ihe);we.getSingleton().register("beforeColumnSort");we.getSingleton().register("afterColumnSort");var Qp=new WeakSet,vH=new WeakSet,CH=new WeakSet,yH=new WeakSet;class iz extends ut{constructor(){super(...arguments),zm(this,yH),zm(this,CH),zm(this,vH),zm(this,Qp),jm(this,"columnStatesManager",null),jm(this,"columnMetaCache",null),jm(this,"pluginKey",lv),jm(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return lv}static get PLUGIN_PRIORITY(){return khe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new phe(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new cl(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>bc(this,vH,$he).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bc(e,yH,Whe).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>bc(this,Qp,wE).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return bc(e,CH,Fhe).call(e,...r)}),this.hot.view&&bc(this,Qp,wE).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=KU(r);XU(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:wH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wH)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new DB),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return fe(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return vhe(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ye(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return fe(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ye(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(fe(n)){const i=mH(n);return fe(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:mH()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uv;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(_t(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===uv)return[...o.slice(0,r),...o.slice(r+1),s];if(n===Lhe)return[...o.slice(0,r),s,...o.slice(r+1)]}return fe(s)?o.concat(s):o}getPluginColumnConfig(e){if(je(e)){const n=e[this.pluginKey];if(je(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):Tt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),i=u=>Ye(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ye(n,u=>u[0]);Ahe(n,this.pluginKey,Ye(e,u=>u.sortOrder),Ye(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ye(n,u=>u[0]),a=new Map(Ye(o,(u,c)=>[u,s[c]])),l=Ye(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(je(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||je(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(We(e,bhe()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];J(e,She(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),fe(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&He(e.target,YU)}onAfterOnCellMouseDown(e,n){bx(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function wE(){const t=this.getAllSavedSortSettings();if(je(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function $he(t,e){const n=KU(e);if(XU(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Pe(e,...KQ(s?`${s}ending`:"none"))}}function Fhe(t){t===!0&&this.hot.view&&bc(this,Qp,wE).call(this)}function Whe(t,e,n,r){bx(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function xl(t,e,n){return e=Vhe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vhe(t){var e=Bhe(t,"string");return typeof e=="symbol"?e:String(e)}function Bhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uhe{constructor(e,n){xl(this,"plugin",void 0),xl(this,"hot",void 0),xl(this,"endpoints",[]),xl(this,"settings",void 0),xl(this,"settingsType","array"),xl(this,"currentEndpoint",null),xl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),M(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();M(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;M(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?M(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):M(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){M(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];M(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),M(i,o=>{let s=[];M(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,M(e.ranges,r=>{M(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],M(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],M(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],M(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&M(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),M(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){yt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const zhe=Uhe;function ib(t){return t==null||isNaN(t)}function ob(t,e){jhe(t,e),e.add(t)}function jhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ghe(t,e,n){return e=Yhe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yhe(t){var e=Khe(t,"string");return typeof e=="symbol"?e:String(e)}function Khe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sb(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const ab="columnSummary",Xhe=220;var SH=new WeakSet,bH=new WeakSet,RH=new WeakSet;class qhe extends ut{constructor(){super(...arguments),ob(this,RH),ob(this,bH),ob(this,SH),Ghe(this,"endpoints",null)}static get PLUGIN_KEY(){return ab}static get PLUGIN_PRIORITY(){return Xhe}isEnabled(){return!!this.hot.getSettings()[ab]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[ab],this.endpoints=new zhe(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return sb(e,SH,Qhe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return sb(e,bH,Zhe).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return sb(e,RH,Jhe).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ke(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=ib(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ke(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=ib(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=ib(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ke(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(pt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function Qhe(){this.endpoints.initEndpoints()}function Zhe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function Jhe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Yu(t,e,n){return e=ede(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ede(t){var e=tde(t,"string");return typeof e=="symbol"?e:String(e)}function tde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wc{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){Yu(this,"rootDocument",void 0),Yu(this,"isRtl",!1),Yu(this,"container",null),Yu(this,"editor",void 0),Yu(this,"editorStyle",void 0),Yu(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:vt(this.getInputElement()),height:Ut(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),J(this.container,Wc.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),J(e,Wc.CLASS_EDITOR),J(n,Wc.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${Wc.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const nde=Wc;function lb(t,e,n){return e=rde(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rde(t){var e=ide(t,"string");return typeof e=="symbol"?e:String(e)}function ide(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ode=250,sde=250;class oz{constructor(e){lb(this,"wasLastActionShow",!0),lb(this,"showDebounced",null),lb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},sde)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ode;this.showDebounced=yC(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}bt(oz,zr);const ade=oz;function lde(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function ude(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Pl(t,e){const n={};return M(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function ga(t,e,n,r,i){M(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&cde(s,a,e,n,r,i)})})}function cde(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=lde(s.className,r):a=ude(s.className,r)),o(t,e,"className",a)}function ws(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function ko(t,e){let n=!1;return Array.isArray(t)&&M(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function KC(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const qe="---------";function hde(){return{name:qe}}const vi="alignment";function dde(){return{key:vi,name(){return this.getTranslatedPhrase(z_)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${vi}:left`,name(){let t=this.getTranslatedPhrase(j_);return ko(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=ws(t)),t},callback(){const t=this.getSelectedRange(),e=Pl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),ga(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${vi}:center`,name(){let t=this.getTranslatedPhrase(G_);return ko(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=ws(t)),t},callback(){const t=this.getSelectedRange(),e=Pl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),ga(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${vi}:right`,name(){let t=this.getTranslatedPhrase(Y_);return ko(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=ws(t)),t},callback(){const t=this.getSelectedRange(),e=Pl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),ga(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${vi}:justify`,name(){let t=this.getTranslatedPhrase(K_);return ko(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=ws(t)),t},callback(){const t=this.getSelectedRange(),e=Pl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),ga(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:qe},{key:`${vi}:top`,name(){let t=this.getTranslatedPhrase(X_);return ko(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=ws(t)),t},callback(){const t=this.getSelectedRange(),e=Pl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),ga(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${vi}:middle`,name(){let t=this.getTranslatedPhrase(q_);return ko(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=ws(t)),t},callback(){const t=this.getSelectedRange(),e=Pl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),ga(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${vi}:bottom`,name(){let t=this.getTranslatedPhrase(Q_);return ko(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=ws(t)),t},callback(){const t=this.getSelectedRange(),e=Pl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),ga(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const XC="clear_column";function fde(){return{key:XC,name(){return this.getTranslatedPhrase(O_)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const _g="col_left";function gde(){return{key:_g,name(){return this.getTranslatedPhrase(R_)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Mg="col_right";function mde(){return{key:Mg,name(){return this.getTranslatedPhrase(E_)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const xg="make_read_only";function pde(){return{key:xg,name(){let t=this.getTranslatedPhrase(P_);return ko(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=ws(t)),t},callback(){const t=this.getSelectedRange(),e=ko(t,(n,r)=>this.getCellMeta(n,r).readOnly);M(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const qC="redo";function wde(){return{key:qC,name(){return this.getTranslatedPhrase(x_)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Pg="remove_col";function vde(){return{key:Pg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(__,e)},callback(){this.alter("remove_col",Iie(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const QC="remove_row";function Cde(){return{key:QC,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(T_,e)},callback(){this.alter("remove_row",Hie(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const ZC="row_above";function yde(){return{key:ZC,name(){return this.getTranslatedPhrase(S_)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const JC="row_below";function Sde(){return{key:JC,name(){return this.getTranslatedPhrase(b_)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const qf="no_items";function bde(){return{key:qf,name(){return this.getTranslatedPhrase(y_)},disabled:!0,isCommand:!1}}const ey="undo";function Rde(){return{key:ey,name(){return this.getTranslatedPhrase(M_)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Ede=[ZC,JC,_g,Mg,XC,QC,Pg,ey,qC,xg,vi,qe,qf],Tde={[qe]:hde,[qf]:bde,[ZC]:yde,[JC]:Sde,[_g]:gde,[Mg]:mde,[XC]:fde,[QC]:Cde,[Pg]:vde,[ey]:Rde,[qC]:wde,[xg]:pde,[vi]:dde};function sz(){const t={};return Ke(Tde,(e,n)=>{t[n]=e()}),t}function _de(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(V_):this.getTranslatedPhrase(W_)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Mde(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(B_)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function xde(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(U_);return ko(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Zp))?ws(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Zp);t.updateCommentMeta(n,r,{[Zp]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Ro(t,e){az(t,e),e.add(t)}function Ol(t,e,n){az(t,e),e.set(t,n)}function az(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pde(t,e,n){return e=Ode(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ode(t){var e=Ade(t,"string");return typeof e=="symbol"?e:String(e)}function Ade(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Eo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ms(t,e,n){var r=lz(t,e,"set");return Ide(t,r,n),n}function Ide(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function tt(t,e){var n=lz(t,e,"get");return Hde(t,n)}function lz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Hde(t,e){return e.get?e.get.call(t):e.value}const af="comments",Dde=60,vs="comment",$d="value",uz="style",Zp="readOnly",Gm=af,vE=`plugin:${af}`;var It=new WeakMap,Ki=new WeakMap,ty=new WeakMap,Jp=new WeakMap,cv=new WeakMap,CE=new WeakMap,hv=new WeakMap,EH=new WeakSet,TH=new WeakSet,_H=new WeakSet,MH=new WeakSet,xH=new WeakSet,PH=new WeakSet,OH=new WeakSet,AH=new WeakSet,IH=new WeakSet,HH=new WeakSet;class Nde extends ut{constructor(){super(...arguments),Ro(this,HH),Ro(this,IH),Ro(this,AH),Ro(this,OH),Ro(this,PH),Ro(this,xH),Ro(this,MH),Ro(this,_H),Ro(this,TH),Ro(this,EH),Pde(this,"range",{}),Ol(this,It,{writable:!0,value:null}),Ol(this,Ki,{writable:!0,value:null}),Ol(this,ty,{writable:!0,value:!1}),Ol(this,Jp,{writable:!0,value:!1}),Ol(this,cv,{writable:!0,value:{}}),Ol(this,CE,{writable:!0,value:null}),Ol(this,hv,{writable:!0,value:""})}static get PLUGIN_KEY(){return af}static get PLUGIN_PRIORITY(){return Dde}isEnabled(){return!!this.hot.getSettings()[af]}enablePlugin(){this.enabled||(tt(this,It)||Ms(this,It,new nde(this.hot.rootDocument,this.hot.isRtl())),tt(this,Ki)||Ms(this,Ki,new ade(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>Eo(this,MH,Fde).call(this,e,s)),this.addHook("afterScroll",()=>Eo(this,HH,jde).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>Eo(this,IH,zde).call(this,e)),tt(this,Ki).addLocalHook("hide",()=>this.hide()),tt(this,Ki).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){tt(this,Ki).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(vE);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Ms(this,Jp,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(vE),this.hot._registerTimeout(()=>{Ms(this,Jp,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!tt(this,It).isVisible()},group:Gm}),r.addShortcut({keys:[["Escape"]],callback:()=>{tt(this,It).setValue(tt(this,hv)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&tt(this,It).isVisible()},group:Gm}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&tt(this,It).isVisible()},group:Gm})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Gm)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Eo(this,TH,Lde).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Eo(this,EH,kde).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Eo(this,_H,$de).call(this)),this.eventManager.addEventListener(n,"focus",()=>Eo(this,PH,Vde).call(this)),this.eventManager.addEventListener(n,"blur",()=>Eo(this,xH,Wde).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>Eo(this,OH,Bde).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>Eo(this,AH,Ude).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=qa(e.target,"TD","TBODY");return!!(n&&He(n,"htCommentCell")&&qa(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=tt(this,It).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[$d]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,vs),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,$d)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,$d)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return tt(this,Ki).cancelHiding(),tt(this,It).setValue((e=i[vs]?i[vs][$d]:null)!==null&&e!==void 0?e:""),tt(this,It).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){tt(this,It).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!tt(this,It).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;tt(this,It).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const h=l===null,d=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:f,view:{_wt:m}}=this.hot,{wtTable:C}=m,b=m.getCell({row:l,col:u},!0),p=this.getCommentMeta(s,a,uz);p?tt(this,It).setSize(p.width,p.height):tt(this,It).resetSize();const w=d?0:C.getStretchedColumnWidth(u),y=c&&!h?Ut(b):0,{left:E,top:T,width:x,height:A}=b.getBoundingClientRect(),{width:W,height:B}=tt(this,It).getSize(),{innerWidth:U,innerHeight:Q}=this.hot.rootWindow,te=this.hot.rootDocument.documentElement;let ee=E+f.scrollX+w,he=T+f.scrollY+y;this.hot.isRtl()&&(ee-=W+w),this.hot.isLtr()&&E+x+W>U?ee=E+f.scrollX-W-1:this.hot.isRtl()&&ee<-(te.scrollWidth-te.clientWidth)&&(ee=E+f.scrollX+w+1),T+B>Q&&(he-=B-A+1),tt(this,It).setPosition(ee,he),tt(this,It).setReadOnlyState(this.getCommentMeta(s,a,Zp))}focusEditor(){tt(this,It).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[vs];let o;i?(o=tr(i),Cg(o,r)):o=r,this.hot.setCellMeta(e,n,vs,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[vs])return i[vs][r]}addToContextMenu(e){e.items.push({name:qe},_de(this),Mde(this),xde(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[af];if(je(e))return e.displayDelay}getEditorInputElement(){return tt(this,It).getInputElement()}destroy(){tt(this,It)&&tt(this,It).destroy(),tt(this,Ki)&&tt(this,Ki).destroy(),super.destroy()}}function kde(t){if(!(!this.hot.view||!this.hot.view._wt)&&!tt(this,ty)&&!this.targetIsCommentTextArea(t)){const e=qa(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function Lde(t){const{rootDocument:e}=this.hot;if(!(tt(this,ty)||tt(this,It).isFocused()||He(t.target,"wtBorder")||tt(this,CE)===t.target||!tt(this,It)))if(Ms(this,CE,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));tt(this,Ki).show(n)}else Ua(t.target,e)&&!this.targetIsCommentTextArea(t)&&tt(this,Ki).hide()}function $de(){Ms(this,ty,!1)}function Fde(t,e){e[vs]&&e[vs][$d]&&J(t,e.commentedCellClassName)}function Wde(){Ms(this,hv,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Vde(){Ms(this,hv,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(vE)}function Bde(t){Ms(this,cv,{width:vt(t.target),height:Ut(t.target)})}function Ude(t){const e=vt(t.target),n=Ut(t.target);(e!==tt(this,cv).width+1||n!==tt(this,cv).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[uz]:{width:e,height:n}})}function zde(t){tt(this,It).isVisible()&&Di(t)}function jde(){tt(this,Jp)||this.hide()}var DH=Zv,Gde=TypeError,Yde=function(t,e){if(!delete t[e])throw new Gde("Cannot delete property "+DH(e)+" of "+DH(t))},Kde=ul,Xde=eC,qde=cg,Qde=UW,Zde=Yde,Jde=zW,efe=[].unshift(0)!==1,tfe=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},nfe=efe||!tfe();Kde({target:"Array",proto:!0,arity:1,forced:nfe},{unshift:function(e){var n=Xde(this),r=qde(n),i=arguments.length;if(i){Jde(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:Zde(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return Qde(n,r+i)}});function ub(t,e,n){return e=rfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rfe(t){var e=ife(t,"string");return typeof e=="symbol"?e:String(e)}function ife(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cz{constructor(e){ub(this,"hot",void 0),ub(this,"commands",{}),ub(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=ofe(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Bt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),M(u,c=>c.apply(this.hot,r))}}function ofe(t,e){let n;return M(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function cb(t,e,n){return e=sfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sfe(t){var e=afe(t,"string");return typeof e=="symbol"?e:String(e)}function afe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hz{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;cb(this,"hot",void 0),cb(this,"predefinedItems",sz()),cb(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ke(e,(r,i)=>{let o="";r.name===qe?(n[qe]=r,o=qe):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return lfe(e,this.defaultOrderPattern,this.predefinedItems)}}function lfe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),je(i)?Ke(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),je(o)?hn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):M(i,(o,s)=>{let a=n[o];!a&&Ede.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),je(o)&&hn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ra(t,e,n){return e=ufe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ufe(t){var e=cfe(t,"string");return typeof e=="symbol"?e:String(e)}function cfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hfe{constructor(e,n){ra(this,"top",void 0),ra(this,"topRelative",void 0),ra(this,"left",void 0),ra(this,"leftRelative",void 0),ra(this,"scrollTop",void 0),ra(this,"scrollLeft",void 0),ra(this,"cellHeight",void 0),ra(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function ud(t,e,n){dfe(t,e),e.set(t,n)}function dfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ze(t,e){var n=dz(t,e,"get");return ffe(t,n)}function ffe(t,e){return e.get?e.get.call(t):e.value}function Ym(t,e,n){var r=dz(t,e,"set");return gfe(t,r,n),n}function dz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gfe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ur=new WeakMap,ia=new WeakMap,Nn=new WeakMap,hb=new WeakMap,Ku=new WeakMap;class mfe{constructor(e){ud(this,ur,{writable:!0,value:void 0}),ud(this,ia,{writable:!0,value:void 0}),ud(this,Nn,{writable:!0,value:void 0}),ud(this,hb,{writable:!0,value:!1}),ud(this,Ku,{writable:!0,value:{above:0,below:0,left:0,right:0}}),Ym(this,hb,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ze(this,Ku)[e]=n,this}setElement(e){return Ym(this,ur,e),this}setParentElement(e){return Ym(this,ia,e),this}updatePosition(e){Ym(this,Nn,new hfe(e,Ze(this,ur).ownerDocument.defaultView)),Ze(this,hb)?(Ze(this,Nn).fitsBelow(Ze(this,ur))?this.setPositionBelowCursor():Ze(this,Nn).fitsAbove(Ze(this,ur))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ze(this,ur).dir==="rtl"?Ze(this,Nn).fitsOnLeft(Ze(this,ur))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ze(this,Nn).fitsOnRight(Ze(this,ur))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ze(this,Ku).above+Ze(this,Nn).top-Ze(this,ur).offsetHeight;Ze(this,ia)&&(e=Ze(this,Nn).top+Ze(this,Nn).cellHeight-Ze(this,ur).offsetHeight+3),Ze(this,ur).style.top=`${e}px`}setPositionBelowCursor(){let e=Ze(this,Ku).below+Ze(this,Nn).top+1;Ze(this,ia)&&(e=Ze(this,Nn).top-1),Ze(this,ur).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ze(this,Nn).left;if(Ze(this,ia)){const{right:n}=Ze(this,ia).getBoundingClientRect();e+=Ze(this,Nn).cellWidth+n-(Ze(this,Nn).left+Ze(this,Nn).cellWidth)}else e+=Ze(this,Ku).right;Ze(this,ur).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ze(this,Ku).left+Ze(this,Nn).left-Ze(this,ur).offsetWidth;if(Ze(this,ia)){const{left:n}=Ze(this,ia).getBoundingClientRect();e-=Ze(this,Nn).left-n}Ze(this,ur).style.left=`${e}px`}}function fz(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Fr(e,-1,m()-1);function a(b,p){const w=m()-1;return b<0&&(b=w),b>w&&(b=0),o.has(b)?-1:(o.add(b),r(b,!1)===!1&&(b=a(p===1?++b:--b,p)),b)}function l(b){b>-1&&b<m()&&r(b,!0)!==!1&&(s=b)}function u(){return s}function c(){m()>0&&(o.clear(),s=a(0,1))}function h(){m()>0&&(o.clear(),s=a(m()-1,-1))}function d(){m()>0&&(o.clear(),s=a(++s,1))}function f(){m()>0&&(o.clear(),s=a(--s,-1))}function m(){return Math.max(n(),0)}function C(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:m,clear:C}}function pfe(t){return Ye(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function yE(t){return Bt(t,"submenu")}function SE(t){return new RegExp(qe,"i").test(t.name)}function ew(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function NH(t){return Bt(t,"disableSelection")}function wfe(t){return He(t,"htSeparator")}function vfe(t){return He(t,"htSubmenu")}function Cfe(t){return He(t,"htDisabled")}function yfe(t){return He(t,"htSelectionDisabled")}function Sfe(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function gz(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function bfe(t,e){let n=t.slice(0);return n.reverse(),n=gz(n,e),n.reverse(),n}function Rfe(t){const e=[];return M(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Efe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qe,n=t.slice(0);return n=gz(n,e),n=bfe(n,e),n=Rfe(n),n}function Tfe(t){return fz({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||wfe(r)||Cfe(r)||yfe(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function _fe(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const mz="menu",kH=mz;function Mfe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(_fe(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:mz})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(m=>h.removeShortcutsByKeys(m))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${kH}:${u}`:kH}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function xfe(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s;if(ho(n),J(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!ew(a,t)&&!NH(a)&&!SE(a);Pe(n,[FQ(),E1(u),...c?[Sh(-1)]:[],...ew(a,t)?[GQ()]:[],...yE(a)?[_i(!1)]:[]])}n.className="",n.appendChild(l),SE(a)?J(n,"htSeparator"):typeof a.renderer=="function"?(J(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Ru(l,u),ew(a,t)?J(n,"htDisabled"):NH(a)?J(n,"htSelectionDisabled"):yE(a)&&J(n,"htSubmenu")}}function LH(t,e,n){Pfe(t,e),e.set(t,n)}function Pfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function To(t,e,n){return e=Ofe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ofe(t){var e=Afe(t,"string");return typeof e=="symbol"?e:String(e)}function Afe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $H(t,e,n){var r=pz(t,e,"set");return Ife(t,r,n),n}function Ife(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function cd(t,e){var n=pz(t,e,"get");return Hfe(t,n)}function pz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Hfe(t,e){return e.get?e.get.call(t):e.value}const FH=215;var hd=new WeakMap,Km=new WeakMap;class Mh{constructor(e,n){var r=this;To(this,"hot",void 0),To(this,"options",void 0),To(this,"eventManager",new Oi(this)),To(this,"container",void 0),To(this,"positioner",void 0),To(this,"hotMenu",null),To(this,"hotSubMenus",{}),To(this,"parentMenu",void 0),To(this,"menuItems",null),To(this,"origOutsideClickDeselects",null),LH(this,hd,{writable:!0,value:void 0}),LH(this,Km,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:FH,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new mfe(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Vf(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return cd(this,hd)}getKeyboardShortcutsCtrl(){return cd(this,Km)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=yC(a=>this.openSubMenu(a),300),n=this.options.minWidth||FH;let r=!1,i=oi(this.menuItems,a=>(a.key===qf&&(r=!0),Sfe(a,this.hot)));if(i.length<1&&!r)i.push(sz()[qf]);else if(i.length===0)return;i=Efe(i,qe);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return fe(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:xfe(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{cd(this,hd).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===qe?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),zR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!zR()||!Ja(a))&&o&&this.hasSelectedItem()&&(_s()||W1()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),$H(this,hd,Tfe(this.hotMenu)),$H(this,Km,Mfe(this)),cd(this,Km).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(cd(this,hd).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Pe(r,[_i(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!vfe(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Mh(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Pe(n,[_i(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Pe(i,[_i(!1)])}}closeAllSubMenus(){M(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?pfe(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||SE(e)||ew(e,this.hot)||yE(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(Tt(r)&&(r=r.call(this.hot),r===null||_t(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),J(i,`htMenu ${this.options.className}`),r&&J(i,r),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=an(n,(a,l)=>a+(l.name===qe?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&Pe(this.hotMenu.rootElement,[$Q(),Sh(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Ua(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Ua(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&He(e.target,"htCore")&&Ua(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}bt(Mh,zr);function Xm(t,e){Dfe(t,e),e.add(t)}function Dfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function db(t,e,n){return e=Nfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nfe(t){var e=kfe(t,"string");return typeof e=="symbol"?e:String(e)}function kfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qm(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Fd="contextMenu",Lfe=70,WH=Fd;we.getSingleton().register("afterContextMenuDefaultOptions");we.getSingleton().register("beforeContextMenuShow");we.getSingleton().register("afterContextMenuShow");we.getSingleton().register("afterContextMenuHide");we.getSingleton().register("afterContextMenuExecute");var VH=new WeakSet,BH=new WeakSet,UH=new WeakSet,zH=new WeakSet;class ny extends ut{constructor(){super(...arguments),Xm(this,zH),Xm(this,UH),Xm(this,BH),Xm(this,VH),db(this,"commandExecutor",new cz(this.hot)),db(this,"itemsFactory",null),db(this,"menu",null)}static get PLUGIN_KEY(){return Fd}static get PLUGIN_PRIORITY(){return Lfe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[ZC,JC,qe,_g,Mg,qe,QC,Pg,qe,ey,qC,qe,xg,qe,vi]}isEnabled(){return!!this.hot.getSettings()[Fd]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Fd];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Mh(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>qm(this,BH,Ffe).call(this)),this.menu.addLocalHook("afterOpen",()=>qm(this,UH,Wfe).call(this)),this.menu.addLocalHook("afterClose",()=>qm(this,zH,Vfe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>qm(this,VH,$fe).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=KC(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:WH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(WH)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ke(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new hz(this.hot,ny.DEFAULT_ITEMS);const e=this.hot.getSettings()[Fd],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),M(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function $fe(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),He(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(He(o,"current")&&He(o,"wtBorder"))))return;const s=KC(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Ffe(){this.hot.runHooks("beforeContextMenuShow",this)}function Wfe(){this.hot.runHooks("afterContextMenuShow",this)}function Vfe(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ny.SEPARATOR={name:qe};function Bfe(t){return{key:"copy",name(){return this.getTranslatedPhrase(A_)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Ufe(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Fr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(D_,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function zfe(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Fr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(H_,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function jfe(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Fr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(I_,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Gfe(t){return{key:"cut",name(){return this.getTranslatedPhrase(N_)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class Yfe{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class Kfe{constructor(){this.clipboardData=new Yfe}}function jH(t,e){wz(t,e),e.add(t)}function Xu(t,e,n){wz(t,e),e.set(t,n)}function wz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qm(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function dr(t,e){var n=vz(t,e,"get");return Xfe(t,n)}function Xfe(t,e){return e.get?e.get.call(t):e.value}function qu(t,e,n){var r=vz(t,e,"set");return qfe(t,r,n),n}function vz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qfe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var oa=new WeakMap,fb=new WeakMap,dd=new WeakMap,bE=new WeakMap,RE=new WeakMap,fd=new WeakMap,Zm=new WeakSet,GH=new WeakSet;class Qfe{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;jH(this,GH),jH(this,Zm),Xu(this,oa,{writable:!0,value:void 0}),Xu(this,fb,{writable:!0,value:void 0}),Xu(this,dd,{writable:!0,value:void 0}),Xu(this,bE,{writable:!0,value:void 0}),Xu(this,RE,{writable:!0,value:void 0}),Xu(this,fd,{writable:!0,value:void 0}),qu(this,fb,n),qu(this,dd,r),qu(this,bE,i),qu(this,RE,o),qu(this,fd,s)}setSelectedRange(e){qu(this,oa,e)}getCellsRange(){if(dr(this,fb).call(this)===0||dr(this,dd).call(this)===0)return null;const{row:e,col:n}=dr(this,oa).getTopStartCorner(),{row:r,col:i}=dr(this,oa).getBottomEndCorner(),o=Qm(this,GH,Zfe).call(this,e,r),s=Qm(this,Zm,gb).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(dr(this,dd).call(this)===0||dr(this,fd).call(this)===0)return null;const{col:e}=dr(this,oa).getTopStartCorner(),{col:n}=dr(this,oa).getBottomEndCorner(),r=Qm(this,Zm,gb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(dr(this,dd).call(this)===0||dr(this,fd).call(this)===0)return null;const{col:e}=dr(this,oa).getTopStartCorner(),{col:n}=dr(this,oa).getBottomEndCorner(),r=Qm(this,Zm,gb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-dr(this,fd).call(this),startCol:e,endRow:-1,endCol:r}}}function gb(t,e){return Math.min(e,Math.max(t+dr(this,RE).call(this)-1,t))}function Zfe(t,e){return Math.min(e,Math.max(t+dr(this,bE).call(this)-1,t))}function Cz(t){const e=[],n=[];return M(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);Se(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);Se(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function _o(t,e){yz(t,e),e.add(t)}function sa(t,e,n){yz(t,e),e.set(t,n)}function yz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gd(t,e,n){return e=Jfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jfe(t){var e=ege(t,"string");return typeof e=="symbol"?e:String(e)}function ege(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nr(t,e){var n=Sz(t,e,"get");return tge(t,n)}function tge(t,e){return e.get?e.get.call(t):e.value}function mi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Yi(t,e,n){var r=Sz(t,e,"set");return nge(t,r,n),n}function Sz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function nge(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}we.getSingleton().register("afterCopyLimit");we.getSingleton().register("modifyCopyableRange");we.getSingleton().register("beforeCut");we.getSingleton().register("afterCut");we.getSingleton().register("beforePaste");we.getSingleton().register("afterPaste");we.getSingleton().register("beforeCopy");we.getSingleton().register("afterCopy");const Jm="copyPaste",rge=80,ige=["fragmentSelection"],YH=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var EE=new WeakMap,TE=new WeakMap,_E=new WeakMap,Qu=new WeakMap,ep=new WeakMap,tp=new WeakMap,Zu=new WeakMap,dv=new WeakMap,mb=new WeakSet,KH=new WeakSet,bz=new WeakSet,Rx=new WeakSet,XH=new WeakSet,qH=new WeakSet,QH=new WeakSet,ZH=new WeakSet,JH=new WeakSet,eD=new WeakSet;class oge extends ut{constructor(){super(...arguments),_o(this,eD),_o(this,JH),_o(this,ZH),_o(this,QH),_o(this,qH),_o(this,XH),_o(this,Rx),_o(this,bz),_o(this,KH),_o(this,mb),gd(this,"columnsLimit",1/0),gd(this,"rowsLimit",1/0),gd(this,"pasteMode","overwrite"),gd(this,"uiContainer",this.hot.rootDocument.body),sa(this,EE,{writable:!0,value:!1}),sa(this,TE,{writable:!0,value:!1}),sa(this,_E,{writable:!0,value:!1}),sa(this,Qu,{writable:!0,value:"cells-only"}),sa(this,ep,{writable:!0,value:!1}),sa(this,tp,{writable:!0,value:!1}),sa(this,Zu,{writable:!0,value:new Qfe({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),sa(this,dv,{writable:!0,value:!1}),gd(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Jm}static get SETTING_KEYS(){return[Jm,...ige]}static get PLUGIN_PRIORITY(){return rge}isEnabled(){return!!this.hot.getSettings()[Jm]}enablePlugin(){var e=this;if(this.enabled)return;const{[Jm]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,Yi(this,EE,!!n.copyColumnHeaders),Yi(this,TE,!!n.copyColumnGroupHeaders),Yi(this,_E,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>mi(this,XH,lge).call(this,o)),this.addHook("afterSelection",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return mi(e,qH,uge).call(e,...s)}),this.addHook("afterSelectionEnd",()=>mi(this,QH,cge).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),$1()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return mi(e,ZH,hge).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return mi(e,JH,dge).call(e,...s)}),this.addHook("afterSelection",()=>mi(this,eD,fge).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Yi(this,Qu,e),Yi(this,ep,!0),mi(this,mb,tD).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Yi(this,tp,!0),mi(this,mb,tD).call(this,"cut")}getRangedCopyableData(e){return rf(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=Cz(e);return M(r,o=>{const s=[];M(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new Kfe;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Nr(this,Zu).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Nr(this,Qu)==="column-headers-only"?n.set("headers",Nr(this,Zu).getMostBottomColumnHeadersRange()):(Nr(this,Qu)==="with-column-headers"?n.set("headers",Nr(this,Zu).getMostBottomColumnHeadersRange()):Nr(this,Qu)==="with-column-group-headers"&&n.set("headers",Nr(this,Zu).getAllColumnHeadersRange()),n.set("cells",Nr(this,Zu).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:m,visualRow:C}=this.hot.getCellMeta(c,a);if(c=C+1,m===!0)continue;d=C,h=a;const b=[],p=o.length%r;for(;b.length<i||h<=u;){const{skipColumnOnPaste:w,visualCol:y}=this.hot.getCellMeta(s,h);if(h=y+1,w===!0)continue;f=y;const E=b.length%i;b.push(e[p][E])}o.push(b)}return Yi(this,dv,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){if(!this.hot.isListening()&&!Nr(this,ep)||this.isEditorOpened())return;this.setCopyableText(),Yi(this,ep,!1);const n=this.getRangedData(this.copyableRanges),r=mi(this,KH,sge).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=rf(n);if(e&&e.clipboardData){const s=KR(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[YH,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}Yi(this,Qu,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!Nr(this,tp)||this.isEditorOpened())return;this.setCopyableText(),Yi(this,tp,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=rf(n);if(e&&e.clipboardData){const o=KR(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[YH,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=gC(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=G2(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=Bie(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function tD(t){if($1()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&S2(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function sge(t){const{rows:e}=Cz(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function age(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&H1(r)}}}function Rz(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&D1(r)}}}function lge(t){t.items.push({name:"---------"},Bfe(this)),Nr(this,EE)&&t.items.push(jfe(this)),Nr(this,TE)&&t.items.push(zfe(this)),Nr(this,_E)&&t.items.push(Ufe(this)),t.items.push(Gfe(this))}function uge(t,e,n,r,i){Nr(this,dv)&&(i.value=!0),Yi(this,dv,!1)}function cge(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function hge(){mi(this,Rx,Rz).call(this)}function dge(){mi(this,bz,age).call(this)}function fge(){mi(this,Rx,Rz).call(this)}function Ez(t,e){return`border_row${t}col${e}`}function Wd(){return{width:1,color:"#000"}}function xs(){return{hide:!0}}function gge(){return{width:1,color:"#000",cornerVisible:!1}}function pb(t){if(fe(t.start)||fe(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(fe(t.end)||fe(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function md(t){return fe(t.start)&&(t.left=t.start),fe(t.end)&&(t.right=t.end),t}function wb(t,e){return{id:Ez(t,e),border:gge(),row:t,col:e,top:xs(),bottom:xs(),start:xs(),end:xs()}}function mge(t,e){return Bt(e,"border")&&e.border&&(t.border=e.border),Bt(e,"top")&&fe(e.top)&&(e.top?(je(e.top)||(e.top=Wd()),t.top=e.top):(e.top=xs(),t.top=e.top)),Bt(e,"bottom")&&fe(e.bottom)&&(e.bottom?(je(e.bottom)||(e.bottom=Wd()),t.bottom=e.bottom):(e.bottom=xs(),t.bottom=e.bottom)),Bt(e,"start")&&fe(e.start)&&(e.start?(je(e.start)||(e.start=Wd()),t.start=e.start):(e.start=xs(),t.start=e.start)),Bt(e,"end")&&fe(e.end)&&(e.end?(je(e.end)||(e.end=Wd()),t.end=e.end):(e.end=xs(),t.end=e.end)),t}function Ws(t,e){let n=!1;return M(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Bt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function ry(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function pge(t){return t.some(e=>fe(e.left)||fe(e.right))}function wge(t){return t.some(e=>fe(e.start)||fe(e.end))}const vge=new Map([["left","start"],["right","end"]]);function Cge(t){var e;return(e=vge.get(t))!==null&&e!==void 0?e:t}function yge(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(tM);return Ws(this,"bottom")&&(e=ry(e)),e},callback(e,n){const r=Ws(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function Sge(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(nM);return Ws(this,e)&&(n=ry(n)),n},callback(n,r){const i=Ws(this,e);t.prepareBorder(r,e,i)}}}function bge(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(rM)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Ws(this)}}}function Rge(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(eM);return Ws(this,e)&&(n=ry(n)),n},callback(n,r){const i=Ws(this,e);t.prepareBorder(r,e,i)}}}function Ege(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(J_);return Ws(this,"top")&&(e=ry(e)),e},callback(e,n){const r=Ws(this,"top");t.prepareBorder(n,"top",r)}}}function nD(t,e){Tge(t,e),e.add(t)}function Tge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _ge(t,e,n){return e=Mge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mge(t){var e=xge(t,"string");return typeof e=="symbol"?e:String(e)}function xge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rD(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const tw="customBorders",Pge=90;var iD=new WeakSet,oD=new WeakSet;class Oge extends ut{constructor(){super(...arguments),nD(this,oD),nD(this,iD),_ge(this,"savedBorders",[])}static get PLUGIN_KEY(){return tw}static get PLUGIN_PRIORITY(){return Pge}isEnabled(){return!!this.hot.getSettings()[tw]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>rD(this,iD,Age).call(this,e)),this.addHook("init",()=>rD(this,oD,Ige).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=pb(n));const o=uh(e),s=Gf(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});M(e,a=>{s(a).forAll((l,u)=>{M(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,Cge(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=uh(e),r=Gf(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return M(e,o=>{r(o).forAll((s,a)=>{M(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(md(l))})})}),i}clearBorders(e){e?this.setBorders(e):(M(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=wb(e,n);r&&(a=mge(a,r),M(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",md(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);Se(e.from.row,r,o=>{Se(e.from.col,i,s=>{const a=wb(o,s);let l=0;o===e.from.row&&Bt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Bt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Bt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Bt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",md(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=Ez(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=wb(e,n):o=pb(o),i?(o[r]=xs(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",md(o)))):(o[r]=Wd(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",md(o)))}prepareBorder(e,n,r){M(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":Se(o.col,s.col,a=>{Se(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":Se(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":Se(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":Se(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":Se(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){M(e,n=>{const r=pb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return an([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ye(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){M(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){M(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ye(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):M(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return M(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return M(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):M(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);M(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[tw];if(Array.isArray(e)){const n=tr(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=pge(e),r=wge(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Age(t){this.hot.getSettings()[tw]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Z_)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Ege(this),Rge(this),yge(this),Sge(this),bge(this)]}})}function Ige(){this.changeBorderSettings()}function Hge(t,e){Dge(t,e),e.add(t)}function Dge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vb(t,e,n){return e=Nge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nge(t){var e=kge(t,"string");return typeof e=="symbol"?e:String(e)}function kge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sD(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const aD="dragToScroll",Lge=100;var Cb=new WeakSet;class $ge extends ut{constructor(){super(...arguments),Hge(this,Cb),vb(this,"boundaries",null),vb(this,"callback",null),vb(this,"listening",!1)}static get PLUGIN_KEY(){return aD}static get PLUGIN_PRIORITY(){return Lge}isEnabled(){return!!this.hot.getSettings()[aD]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>sD(this,Cb,lD).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>sD(this,Cb,lD).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=Vf(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function lD(t){if(Ja(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function Al(t,e){Fge(t,e),e.add(t)}function Fge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yb(t,e,n){return e=Wge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wge(t){var e=Vge(t,"string");return typeof e=="symbol"?e:String(e)}function Vge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function va(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}we.getSingleton().register("afterDropdownMenuDefaultOptions");we.getSingleton().register("beforeDropdownMenuShow");we.getSingleton().register("afterDropdownMenuShow");we.getSingleton().register("afterDropdownMenuHide");we.getSingleton().register("afterDropdownMenuExecute");const nw="dropdownMenu",Bge=230,ME="changeType",Sb=nw;var Ex=new WeakSet,uD=new WeakSet,cD=new WeakSet,hD=new WeakSet,dD=new WeakSet,fD=new WeakSet,gD=new WeakSet;class iy extends ut{static get PLUGIN_KEY(){return nw}static get PLUGIN_PRIORITY(){return Bge}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[_g,Mg,qe,Pg,qe,XC,qe,xg,qe,vi]}constructor(e){super(e),Al(this,gD),Al(this,fD),Al(this,dD),Al(this,hD),Al(this,cD),Al(this,uD),Al(this,Ex),yb(this,"commandExecutor",new cz(this.hot)),yb(this,"itemsFactory",null),yb(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>va(this,cD,zge).call(this,n,r))}isEnabled(){return this.hot.getSettings()[nw]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new hz(this.hot,iy.DEFAULT_ITEMS);const n=this.hot.getSettings()[nw],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Mh(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>va(this,hD,jge).call(this)),this.menu.addLocalHook("afterOpen",()=>va(this,dD,Gge).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>va(this,fD,Yge).call(this,o)),this.menu.addLocalHook("afterClose",()=>va(this,gD,Kge).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),M(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=KC(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Sb},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Sb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Sb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>va(this,uD,Uge).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ke(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Tz(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Uge(t){if(t.stopPropagation(),He(t.target,ME)){const e=KC(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function zge(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${ME}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=ME,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Pe(s,[Gs(),E1(" ")]),Pe(e,[a2("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function jge(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Gge(){this.hot.runHooks("afterDropdownMenuShow",this),va(this,Ex,Tz).call(this,this.menu)}function Yge(t){va(this,Ex,Tz).call(this,t)}function Kge(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}iy.SEPARATOR={name:qe};function mD(t,e,n){return e=Xge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xge(t){var e=qge(t,"string");return typeof e=="symbol"?e:String(e)}function qge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qge{constructor(e){mD(this,"hot",void 0),mD(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return Se(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(Se(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();Se(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();Se(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const Zge=Qge;function pD(t,e,n){return e=Jge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jge(t){var e=eme(t,"string");return typeof e=="symbol"?e:String(e)}function eme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tx{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){pD(this,"dataProvider",void 0),pD(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Cr(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=hn(Cr(Tx.DEFAULT_OPTIONS),n),n=hn(n,e),n.filename=R1(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const tme=Tx,nme=String.fromCharCode(13),rme=String.fromCharCode(34),ime=String.fromCharCode(10);class ome extends tme{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=Ye(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),M(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Zt(e);return r!==""&&(n||r.indexOf(nme)>=0||r.indexOf(rme)>=0||r.indexOf(ime)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const sme=ome,ame="csv",xE={[ame]:sme};function lme(t,e,n){return typeof xE[t]=="function"?new xE[t](e,n):null}const ume="exportFile",cme=240;class hme extends ut{static get PLUGIN_KEY(){return ume}static get PLUGIN_PRIORITY(){return cme}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!xE[e])throw new Error(`Export format type "${e}" is not supported.`);return lme(e,new Zge(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Ju(t,e,n){return e=dme(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dme(t){var e=fme(t,"string");return typeof e=="symbol"?e:String(e)}function fme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Og{constructor(e,n){let{id:r,stateless:i=!0}=n;Ju(this,"hot",void 0),Ju(this,"id",void 0),Ju(this,"elements",[]),Ju(this,"hidden",!1),Ju(this,"stateId",""),Ju(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new OC)}getElements(){return this.elements}reset(){M(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),M(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}bt(Og,zr);const Qf={};function tl(t,e){if(!Qf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Qf[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Jl(t){if(!Qf[t])throw Error(`Filter condition "${t}" does not exist.`);return Qf[t].descriptor}function dn(t,e,n){n.key=t,Qf[t]={condition:e,descriptor:n}}const On="none";function gme(){return!0}dn(On,gme,{name:AC,inputsCount:0,showOperators:!1});const lf="empty";function mme(t){return pn(t.value)}dn(lf,mme,{name:cM,inputsCount:0,showOperators:!0});const rw="not_empty";function pme(t,e){return!tl(lf,e)(t)}dn(rw,pme,{name:hM,inputsCount:0,showOperators:!0});const uf="eq";function wme(t,e){let[n]=e;return Zt(t.value).toLocaleLowerCase(t.meta.locale)===Zt(n)}dn(uf,wme,{name:dM,inputsCount:1,showOperators:!0});const iw="neq";function vme(t,e){return!tl(uf,e)(t)}dn(iw,vme,{name:fM,inputsCount:1,showOperators:!0});const _z="gt";function Cme(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}dn(_z,Cme,{name:vM,inputsCount:1,showOperators:!0});const Mz="gte";function yme(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}dn(Mz,yme,{name:CM,inputsCount:1,showOperators:!0});const xz="lt";function Sme(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}dn(xz,Sme,{name:yM,inputsCount:1,showOperators:!0});const Pz="lte";function bme(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}dn(Pz,bme,{name:SM,inputsCount:1,showOperators:!0});const _x="date_after";function Rme(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}dn(_x,Rme,{name:EM,inputsCount:1,showOperators:!0});const Mx="date_before";function Eme(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}dn(Mx,Eme,{name:TM,inputsCount:1,showOperators:!0});const fv="between";function Tme(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=tl(Mx,[o]),a=tl(_x,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}dn(fv,Tme,{name:bM,inputsCount:2,showOperators:!0});const Oz="not_between";function _me(t,e){return!tl(fv,e)(t)}dn(Oz,_me,{name:RM,inputsCount:2,showOperators:!0});const Az="begins_with";function Mme(t,e){let[n]=e;return Zt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Zt(n))}dn(Az,Mme,{name:gM,inputsCount:1,showOperators:!0});const Iz="ends_with";function xme(t,e){let[n]=e;return Zt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Zt(n))}dn(Iz,xme,{name:mM,inputsCount:1,showOperators:!0});const xx="contains";function Pme(t,e){let[n]=e;return Zt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Zt(n))>=0}dn(xx,Pme,{name:pM,inputsCount:1,showOperators:!0});const Hz="not_contains";function Ome(t,e){return!tl(xx,e)(t)}dn(Hz,Ome,{name:wM,inputsCount:1,showOperators:!0});const Dz="date_tomorrow";function Ame(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(-1,"days").startOf("day"),"d"):!1}dn(Dz,Ame,{name:MM,inputsCount:0});const Nz="date_today";function Ime(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().startOf("day"),"d"):!1}dn(Nz,Ime,{name:_M,inputsCount:0});const kz="date_yesterday";function Hme(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(1,"days").startOf("day"),"d"):!1}dn(kz,Hme,{name:xM,inputsCount:0});O2();function Dme(t,e){let n=t;return n===""&&(n=`(${e})`),n}const PE=new Set([1]).has(1),Nme=PE&&typeof Array.from=="function";function Ag(t){let e=t;return PE&&(e=new Set(e)),function(n){let r;return PE?r=e.has(n):r=!!~e.indexOf(n),r}}function Lz(t){return t??""}function OE(t){let e=t;return Nme?e=Array.from(new Set(e)):e=y1(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function wD(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Ag(e)),M(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Dme(a,n)};r&&r(u),i.push(u)}),i}const eu="by_value";function kme(t,e){let[n]=e;return n(t.value)}dn(eu,kme,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Ag(e)]},showOperators:!1});const Zf={};function Lme(t){if(!Zf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Zf[t].func;return function(n,r){return e(n,r)}}function $me(t){return Zf[t].name}function Px(t,e,n){Zf[t]={name:e,func:n}}const Ga="conjunction",Fme=AM;function Wme(t,e){return t.every(n=>n.func(e))}Px(Ga,Fme,Wme);const gv="disjunction",Vme=IC;function Bme(t,e){return t.some(n=>n.func(e))}Px(gv,Vme,Bme);const Ox="disjunctionWithExtraCondition",Ume=IC;function zme(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}Px(Ox,Ume,zme);const jme="numeric",$z="text",Gme="date",vD={[jme]:[On,qe,lf,rw,qe,uf,iw,qe,_z,Mz,xz,Pz,fv,Oz],[$z]:[On,qe,lf,rw,qe,uf,iw,qe,Az,Iz,qe,xx,Hz],[Gme]:[On,qe,lf,rw,qe,uf,iw,qe,Mx,_x,fv,qe,Dz,Nz,kz]};function Yme(t){const e=[];let n=t;return vD[n]||(n=$z),M(vD[n],r=>{let i;r===qe?i={name:qe}:i=Cr(Jl(r)),e.push(i)}),e}function pd(t,e,n){return e=Kme(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kme(t){var e=Xme(t,"string");return typeof e=="symbol"?e:String(e)}function Xme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bb="built",Rb="building",CD=["click","input","keydown","keypress","keyup","focus","blur","change"];let so=class Fz{static get DEFAULTS(){return Cr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){pd(this,"hot",void 0),pd(this,"eventManager",new Oi(this)),pd(this,"options",void 0),pd(this,"_element",void 0),pd(this,"buildState",void 0),this.hot=e,this.options=hn(Fz.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Rb?this._element:this.buildState===bb?(this.update(),this._element):(this.buildState=Rb,this.build(),this.buildState=bb,this._element)}isBuilt(){return this.buildState===bb}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Er)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Rb),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&J(this._element,this.options.className),this.options.children.length)M(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ke(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),M(CD,r=>e(n,r))}else M(CD,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};bt(so,zr);function qme(t,e){Wz(t,e),e.add(t)}function Qme(t,e,n){Wz(t,e),e.set(t,n)}function Wz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function np(t,e){var n=Vz(t,e,"get");return Zme(t,n)}function Zme(t,e){return e.get?e.get.call(t):e.value}function Jme(t,e,n){var r=Vz(t,e,"set");return epe(t,r,n),n}function Vz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function epe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function tpe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var ec=new WeakMap,yD=new WeakSet;class Ya extends so{static get DEFAULTS(){return Cr({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,hn(Ya.DEFAULTS,n)),qme(this,yD),Qme(this,ec,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>tpe(this,yD,npe).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Jme(this,ec,this._element.firstChild),J(this._element,"htUIInput"),J(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(np(this,ec).type=this.options.type,np(this,ec).placeholder=this.translateIfPossible(this.options.placeholder),np(this,ec).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&np(this,ec).focus()}}function npe(t){this.options.value=t.target.value}function Eb(t,e){Bz(t,e),e.add(t)}function wd(t,e,n){Bz(t,e),e.set(t,n)}function Bz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tc(t,e,n){var r=Uz(t,e,"set");return rpe(t,r,n),n}function rpe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Tb(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function zt(t,e){var n=Uz(t,e,"get");return ipe(t,n)}function Uz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ipe(t,e){return e.get?e.get.call(t):e.value}var vn=new WeakMap,rp=new WeakMap,ip=new WeakMap,_b=new WeakMap,op=new WeakMap,SD=new WeakSet,bD=new WeakSet,RD=new WeakSet;class Jf extends so{static get DEFAULTS(){return Cr({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,hn(Jf.DEFAULTS,n)),Eb(this,RD),Eb(this,bD),Eb(this,SD),wd(this,vn,{writable:!0,value:null}),wd(this,rp,{writable:!0,value:[]}),wd(this,ip,{writable:!0,value:void 0}),wd(this,_b,{writable:!0,value:void 0}),wd(this,op,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return zt(this,vn)}registerHooks(){this.addLocalHook("click",()=>Tb(this,RD,ape).call(this))}setItems(e){tc(this,rp,this.translateNames(e)),zt(this,vn)&&zt(this,vn).setMenuItems(zt(this,rp))}translateNames(e){return M(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),tc(this,vn,new Mh(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),zt(this,vn).setMenuItems(zt(this,rp));const e=new so(this.hot,{className:"htUISelectCaption"}),n=new so(this.hot,{className:"htUISelectDropdown"});tc(this,ip,e),tc(this,_b,e.element),tc(this,op,n),this.hot.getSettings().ariaTags&&(Pe(n.element,[Gs()]),Pe(this._element,[s2()])),M([e,n],r=>this._element.appendChild(r.element)),zt(this,vn).addLocalHook("select",r=>Tb(this,SD,ope).call(this,r)),zt(this,vn).addLocalHook("afterClose",()=>Tb(this,bD,spe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=zt(this,vn).hot.getTranslatedPhrase(AC),zt(this,_b).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();zt(this,vn)&&(zt(this,vn).open(),zt(this,vn).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),zt(this,vn).getNavigator().toFirstItem(),zt(this,vn).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){zt(this,vn)&&zt(this,vn).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){zt(this,vn)&&(zt(this,vn).destroy(),tc(this,vn,null)),zt(this,ip)&&zt(this,ip).destroy(),zt(this,op)&&zt(this,op).destroy(),super.destroy()}}function ope(t){t.name!==qe&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function spe(){this.runLocalHooks("afterClose")}function ape(){this.openOptions()}function ED(t,e){lpe(t,e),e.add(t)}function lpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TD(t,e,n){return e=upe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function upe(t){var e=cpe(t,"string");return typeof e=="symbol"?e:String(e)}function cpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _D(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var MD=new WeakSet,xD=new WeakSet;class AE extends Og{constructor(e,n){super(e,{id:n.id,stateless:!1}),ED(this,xD),ED(this,MD),TD(this,"name",""),TD(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Jf(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Ya(this.hot,{placeholder:LM})),this.elements.push(new Ya(this.hot,{placeholder:$M})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>_D(this,MD,hpe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),M(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>_D(this,xD,dpe).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Cr(e.command);n.name.startsWith(tn)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),M(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Jl(On),n=[];return M(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Jl(e?e.name:On);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||M(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Jf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Ya)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{J(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&J(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return J(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),M(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Jl(On)];if(e!==null){const{visualIndex:r}=e;n=Yme(this.hot.getDataType(0,r,this.hot.countRows(),r))}M(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function hpe(t){M(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function dpe(t){Rh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Di(t))}function PD(t,e,n){fpe(t,e),e.set(t,n)}function fpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vd(t,e){var n=zz(t,e,"get");return gpe(t,n)}function gpe(t,e){return e.get?e.get.call(t):e.value}function OD(t,e,n){var r=zz(t,e,"set");return mpe(t,r,n),n}function zz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function mpe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var nc=new WeakMap,Mb=new WeakMap;class mv extends so{static get DEFAULTS(){return Cr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,hn(mv.DEFAULTS,n)),PD(this,nc,{writable:!0,value:void 0}),PD(this,Mb,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),OD(this,Mb,e),OD(this,nc,this._element.firstChild),vd(this,nc).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(vd(this,Mb).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?vd(this,nc).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(vd(this,nc).checked=e)}focus(){this.isBuilt()&&vd(this,nc).focus()}}function ppe(t,e){wpe(t,e),e.add(t)}function wpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vpe(t,e,n){return e=Cpe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cpe(t){var e=ype(t,"string");return typeof e=="symbol"?e:String(e)}function ype(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Spe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const AD=0;var ID=new WeakSet;class bpe extends Og{constructor(e,n){super(e,{id:n.id,stateless:!1}),ppe(this,ID),vpe(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(J(n.parentNode,"htFiltersMenuOperators"),M(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[Ga,gv];M(e,n=>{const r=new mv(this.hot,{name:"operator",label:{htmlFor:n,textContent:$me(n)},value:n,checked:n===e[AD],id:n});r.addLocalHook("change",i=>Spe(this,ID,Rpe).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(pt`Radio button with index ${e} doesn't exist.`);M(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof mv&&n.isChecked());return e?e.getValue():Ga}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&M(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ga,n=arguments.length>1?arguments[1]:void 0,r=e;r===Ox&&(r=gv),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(AD)}}function Rpe(t){this.setState(t.target.value)}function Epe(t,e,n){Tpe(t,e),e.set(t,n)}function Tpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xb(t,e){var n=jz(t,e,"get");return _pe(t,n)}function _pe(t,e){return e.get?e.get.call(t):e.value}function Mpe(t,e,n){var r=jz(t,e,"set");return xpe(t,r,n),n}function jz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function xpe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Cd=new WeakMap;class eg extends so{static get DEFAULTS(){return Cr({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,hn(eg.DEFAULTS,n)),Epe(this,Cd,{writable:!0,value:void 0})}build(){super.build(),Mpe(this,Cd,this._element.firstChild)}update(){this.isBuilt()&&(xb(this,Cd).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&xb(this,Cd).focus()}activate(){xb(this,Cd).click()}}function sp(t,e){Gz(t,e),e.add(t)}function rc(t,e,n){Gz(t,e),e.set(t,n)}function Gz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ap(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Fe(t,e){var n=Yz(t,e,"get");return Ppe(t,n)}function Ppe(t,e){return e.get?e.get.call(t):e.value}function Bi(t,e,n){var r=Yz(t,e,"set");return Ope(t,r,n),n}function Yz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ope(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const HD="multipleSelect.itemBox";var Xi=new WeakMap,$t=new WeakMap,Pb=new WeakMap,as=new WeakMap,aa=new WeakMap,la=new WeakMap,DD=new WeakSet,ND=new WeakSet,kD=new WeakSet,LD=new WeakSet;class tg extends so{static get DEFAULTS(){return Cr({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,hn(tg.DEFAULTS,n)),sp(this,LD),sp(this,kD),sp(this,ND),sp(this,DD),rc(this,Xi,{writable:!0,value:[]}),rc(this,$t,{writable:!0,value:void 0}),rc(this,Pb,{writable:!0,value:void 0}),rc(this,as,{writable:!0,value:void 0}),rc(this,aa,{writable:!0,value:void 0}),rc(this,la,{writable:!0,value:void 0}),Bi(this,as,new Ya(this.hot,{placeholder:kM,className:"htUIMultipleSelectSearch"})),Bi(this,aa,new eg(this.hot,{textContent:IM,className:"htUISelectAll"})),Bi(this,la,new eg(this.hot,{textContent:HM,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Fe(this,$t)}registerHooks(){Fe(this,as).addLocalHook("keydown",e=>ap(this,ND,Ipe).call(this,e)),Fe(this,as).addLocalHook("input",e=>ap(this,DD,Ape).call(this,e)),Fe(this,aa).addLocalHook("click",e=>ap(this,kD,Hpe).call(this,e)),Fe(this,la).addLocalHook("click",e=>ap(this,LD,Dpe).call(this,e))}setItems(e){Bi(this,Xi,e),Fe(this,$t)&&Fe(this,$t).loadData(Fe(this,Xi))}setLocale(e){Bi(this,Pb,e)}getLocale(){return Fe(this,Pb)}getItems(){return[...Fe(this,Xi)]}getValue(){return kpe(Fe(this,Xi))}getSearchInputElement(){return Fe(this,as)}getSelectAllElement(){return Fe(this,aa)}getClearAllElement(){return Fe(this,la)}isSelectedAllValues(){return Fe(this,Xi).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new so(this.hot,{className:"htUISelectionControls",children:[Fe(this,aa),Fe(this,la)]});this._element.appendChild(Fe(this,as).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{if(!this._element)return;Fe(this,$t)&&Fe(this,$t).destroy(),J(o,"htUIMultipleSelectHot"),Bi(this,$t,new this.hot.constructor(o,{data:Fe(this,Xi),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,h,d,f)=>{l.title=f.instance.getDataAtRowProp(u,f.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Fe(this,$t).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>Fe(this,$t).container.scrollWidth-Rn(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Fe(this,$t).init();const a=Fe(this,$t).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:HD}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{Fe(this,$t).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:HD})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Fe(this,$t).listen()}reset(){Fe(this,as).reset(),Fe(this,aa).reset(),Fe(this,la).reset()}update(){this.isBuilt()&&(Fe(this,$t).loadData(Npe(Fe(this,Xi),this.options.value)),super.update())}destroy(){Fe(this,$t)&&Fe(this,$t).destroy(),Fe(this,as).destroy(),Fe(this,la).destroy(),Fe(this,aa).destroy(),Bi(this,as,null),Bi(this,la,null),Bi(this,aa,null),Bi(this,$t,null),Bi(this,Xi,null),super.destroy()}}function Ape(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Fe(this,Xi)]:n=oi(Fe(this,Xi),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Fe(this,$t).loadData(n)}function Ipe(t){this.runLocalHooks("keydown",t,this),N1(Rh,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Di(t),Fe(this,$t).listen(),Fe(this,$t).selectCell(0,0))}function Hpe(t){const e=[];t.preventDefault(),M(Fe(this,$t).getSourceData(),(n,r)=>{n.checked=!0,e.push(d_(n,r)[0])}),Fe(this,$t).setSourceDataAtCell(e)}function Dpe(t){const e=[];t.preventDefault(),M(Fe(this,$t).getSourceData(),(n,r)=>{n.checked=!1,e.push(d_(n,r)[0])}),Fe(this,$t).setSourceDataAtCell(e)}function Npe(t,e){const n=Ag(e);return Ye(t,r=>(r.checked=n(r.value),r))}function kpe(t){const e=[];return M(t,n=>{n.checked&&e.push(n.value)}),e}function Lpe(t,e){$pe(t,e),e.add(t)}function $pe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fpe(t,e,n){return e=Wpe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wpe(t){var e=Vpe(t,"string");return typeof e=="symbol"?e:String(e)}function Vpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bpe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var $D=new WeakSet;class Upe extends Og{constructor(e,n){super(e,{id:n.id,stateless:!1}),Lpe(this,$D),Fpe(this,"name",""),this.name=n.name,this.elements.push(new tg(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Bpe(this,$D,zpe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===eu){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?On:eu},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=oi(i,h=>h.name===eu),u={},c=this.hot.getTranslatedPhrase(tv);if(l){const h=OE(Ye(s(r,a),C=>C.value));o&&(l.args[0]=o);const d=[],f=wD(h,l.args[0],c,C=>{C.checked&&d.push(C.value)}),m=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,m).locale,u.args=[d],u.command=Jl(eu),u.itemsSnapshot=f}else u.args=[],u.command=Jl(On);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof tg)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{J(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return J(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),M(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(tv),n=OE(this._getColumnVisibleValues()),r=wD(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ye(this.hot.getDataAtCol(e.visualIndex),n=>Lz(n))}}function zpe(t){Rh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Di(t))}var Kz;function jpe(t,e){Gpe(t,e),e.add(t)}function Gpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ype(t,e,n){return e=Kpe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kpe(t){var e=Xpe(t,"string");return typeof e=="symbol"?e:String(e)}function Xpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qpe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var FD=new WeakSet;class ng extends Og{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),jpe(this,FD),Ype(this,"name",""),this.name=n.name,this.elements.push(new Ya(this.hot,{type:"button",value:DM,className:"htUIButton htUIButtonOK",identifier:ng.BUTTON_OK})),this.elements.push(new Ya(this.hot,{type:"button",value:NM,className:"htUIButton htUIButtonCancel",identifier:ng.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){M(this.elements,e=>{e.addLocalHook("click",(n,r)=>qpe(this,FD,Qpe).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(J(n.parentNode,"htFiltersMenuActionBar"),M(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}Kz=ng;function Qpe(t,e){e.options.identifier===Kz.BUTTON_OK?this.accept():this.cancel()}function Ob(t,e,n){return e=Zpe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zpe(t){var e=Jpe(t,"string");return typeof e=="symbol"?e:String(e)}function Jpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const WD="ConditionCollection.filteringStates";class Xz{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Ob(this,"hot",void 0),Ob(this,"isMapRegistrable",void 0),Ob(this,"filteringStates",new OC),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(WD,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ga;return e.length?Lme(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ga,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=Ye(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(pt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(_t(Zf[r]))throw new Error(pt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:tl(a,s)}]},i):u.push({name:a,args:s,func:tl(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return an(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:Ye(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),M(e,n=>{M(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(WD),this.filteringStates=null,this.clearLocalHooks()}}bt(Xz,zr);const qz=Xz;function VD(t,e,n){return e=ewe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ewe(t){var e=twe(t,"string");return typeof e=="symbol"?e:String(e)}function twe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nwe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];VD(this,"conditionCollection",void 0),VD(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return M(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return M(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return M(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}const Qz=nwe;function Ab(t,e){rwe(t,e),e.add(t)}function rwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Il(t,e,n){return e=iwe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iwe(t){var e=owe(t,"string");return typeof e=="symbol"?e:String(e)}function owe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ib(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var BD=new WeakSet,UD=new WeakSet,zD=new WeakSet;class Zz{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Ab(this,zD),Ab(this,UD),Ab(this,BD),Il(this,"hot",void 0),Il(this,"conditionCollection",void 0),Il(this,"columnDataFactory",void 0),Il(this,"changes",[]),Il(this,"grouping",!1),Il(this,"latestEditedColumnPosition",-1),Il(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Ib(this,BD,swe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Ib(this,UD,awe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Ib(this,zD,lwe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,M(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=R2(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new qz(r.hot,!1),m=[].concat(c,d);f.importAllConditions(m);const C=r.columnDataFactory(h);let b;f.isEmpty()?b=C:b=new Qz(f,w=>r.columnDataFactory(w)).filter(),b=Ye(b,w=>w.meta.visualRow);const p=Ag(b);return f.destroy(),oi(C,w=>p(w.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ke(this,(e,n)=>{this[n]=null})}}function swe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function awe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function lwe(){M(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}bt(Zz,zr);const uwe=Zz;function cwe(t){return fz({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof tg)return r;if(i.element&&!Za(i.element))return!1;i.focus()}})}const yd="filters";function hwe(t,e){let n=-1;const r=cwe(e),i=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(yd),r.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof so&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||r.clear()});function o(l){const u=t.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();r.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(yd),callback:()=>{l.isSubMenu()&&l.close(),u.listen(yd)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:h=>{const d=t.getNavigator();d.getCurrentPage()>-1&&(n=d.getCurrentPage()),d.clear(),h.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:h=>{const d=e[r.getCurrentPage()];d instanceof Jf&&(d.openOptions(),h.preventDefault()),d instanceof eg&&(d.activate(),h.preventDefault()),d instanceof so||h.preventDefault()}}],yd)}t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o);function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(yd)}function a(){return n}return{...r,listen:s,getLastMenuPage:a}}function ls(t,e){Jz(t,e),e.add(t)}function dwe(t,e,n){Jz(t,e),e.set(t,n)}function Jz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sd(t,e,n){return e=fwe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fwe(t){var e=gwe(t,"string");return typeof e=="symbol"?e:String(e)}function gwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mwe(t,e,n){var r=ej(t,e,"set");return pwe(t,r,n),n}function pwe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function bd(t,e){var n=ej(t,e,"get");return wwe(t,n)}function ej(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function wwe(t,e){return e.get?e.get.call(t):e.value}function Ui(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const IE="filters",vwe=250,jD=IE;var Hl=new WeakMap,GD=new WeakSet,YD=new WeakSet,KD=new WeakSet,XD=new WeakSet,Hb=new WeakSet,qD=new WeakSet,Db=new WeakSet,QD=new WeakSet,ZD=new WeakSet;class Cwe extends ut{static get PLUGIN_KEY(){return IE}static get PLUGIN_PRIORITY(){return vwe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),ls(this,ZD),ls(this,QD),ls(this,Db),ls(this,qD),ls(this,Hb),ls(this,XD),ls(this,KD),ls(this,YD),ls(this,GD),Sd(this,"dropdownMenuPlugin",null),Sd(this,"conditionCollection",null),Sd(this,"conditionUpdateObserver",null),Sd(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Sd(this,"filtersRowsMap",null),dwe(this,Hl,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>Ui(this,QD,Twe).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[IE]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Eg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>Ui(this,Hb,JD).call(this,"accept")),s.addLocalHook("cancel",()=>Ui(this,Hb,JD).call(this,"cancel")),s.addLocalHook("change",a=>Ui(this,qD,Ewe).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(PM)}:`,o=()=>`${this.hot.getTranslatedPhrase(OM)}:`;if(!this.components.get("filter_by_condition")){const s=new AE(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>Ui(this,Db,eN).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new bpe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new AE(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>Ui(this,Db,eN).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new Upe(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new ng(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new qz(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new uwe(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>Ui(this,ZD,_we).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>Ui(this,XD,Rwe).call(this,s)),this.addHook("afterDropdownMenuShow",()=>Ui(this,YD,Swe).call(this)),this.addHook("afterDropdownMenuHide",()=>Ui(this,KD,bwe).call(this)),this.addHook("afterChange",s=>Ui(this,GD,ywe).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!bd(this,Hl)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=s.getNavigator(),c=bd(this,Hl).getLastMenuPage();s.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];mwe(this,Hl,hwe(s,a));const l=u=>{bd(this,Hl).listen(),u.preventDefault(),Rh(u.keyCode,"TAB")&&(u.shiftKey?bd(this,Hl).toPreviousItem():bd(this,Hl).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:jD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jD)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ga;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ye(n.filter(),u=>u.meta.visualRow);const l=Ag(i);Se(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),M(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return M(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(o,n),C=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m},value:Lz(C)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=OE(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===gv&&n.command.key!==On&&r.command.key!==On&&i.command.key!==On?o=Ox:i.command.key!==On&&(n.command.key===On||r.command.key===On)&&(o=Ga),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new Qz(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return M(i,s=>{M(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function ywe(t){t&&M(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Swe(){this.restoreComponents(Array.from(this.components.values()))}function bwe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Rwe(t){t.items.push({name:qe}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function JD(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==On&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==On&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==On&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Ewe(t,e){this.updateDependentComponentsVisibility(),t.constructor===AE&&!e.inputsCount&&this.setListeningDropdownMenu()}function eN(){this.setListeningDropdownMenu()}function Twe(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?J(e,"htFiltersActive"):We(e,"htFiltersActive")}function _we(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===eu),o=n.filter(s=>s.name!==eu);if(i.length>=2||o.length>=3)yt(pt`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}const tj="internal-use-in-handsontable",HE={licenseKey:tj,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function nj(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Qn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function rj(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Mwe(t){var e;const n=t[Qn],r=rj(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=nj(t);return{...HE,...r,...i}}function xwe(t){var e;const n=t[Qn],r=rj(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=nj(t);return{...r,...i}}function Pwe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function oy(){const t="engine_relationship",e=go(Qn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Ax(){const t="shared_engine_usage",e=go(Qn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Owe(t){const e=t.getSettings(),n=e[Qn],r=n==null?void 0:n.engine;if(n===!0||_t(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Awe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&_t(r.hyperformula)){const o=oy(),s=Ax().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:tj}),(r.getConfig().leapYear1900!==HE.leapYear1900||SC(r.getConfig().nullDate,HE.nullDate)===!1)&&yt(pt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Awe(t,e,n){const r=e[Qn],i=Mwe(e),o=oy(),s=Ax();Iwe(t,r.functions),Hwe(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Dwe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function tN(t){var e;const n=oy(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function nN(t,e){if(t){const n=oy(),r=n.get(t),i=Ax(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Iwe(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){yt(s.message)}})}function Hwe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){yt(r.message)}}}function Dwe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){yt(a.message)}}),t.resumeEvaluation())}function Nwe(t,e){return(_t(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const ij="DD/MM/YYYY";function oj(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function kwe(t){return oj(t)?t.substr(1):t}function Lwe(t){return typeof t=="string"&&t.startsWith("=")}function Ix(t,e){return typeof t=="string"&&e==="date"}function sj(t,e){return Z(t,e,!0).isValid()}function aj(t,e){return Z(t,e,!0).format(ij)}function $we(t,e){return Z(t,ij,!0).format(e)}function lj(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Z(r).format(e)}function Dl(t,e,n){Fwe(t,e),e.set(t,n)}function Fwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ot(t,e){var n=uj(t,e,"get");return Wwe(t,n)}function Wwe(t,e){return e.get?e.get.call(t):e.value}function ua(t,e,n){var r=uj(t,e,"set");return Vwe(t,r,n),n}function uj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Vwe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Rd=new WeakMap,ca=new WeakMap,jr=new WeakMap,lp=new WeakMap,Nb=new WeakMap,kb=new WeakMap,up=new WeakMap;class Bwe{constructor(e,n,r){Dl(this,Rd,{writable:!0,value:void 0}),Dl(this,ca,{writable:!0,value:void 0}),Dl(this,jr,{writable:!0,value:void 0}),Dl(this,lp,{writable:!0,value:[]}),Dl(this,Nb,{writable:!0,value:[]}),Dl(this,kb,{writable:!0,value:void 0}),Dl(this,up,{writable:!0,value:[]}),ua(this,Rd,e),ua(this,ca,n),ua(this,jr,r)}setRemovedHfIndexes(e){return ua(this,up,e.map(n=>{const r=Ot(this,ca).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Ot(this,up)}getRemovedHfIndexes(){return Ot(this,up)}getHfIndexFromVisualIndex(e){const n=Ot(this,ca).getIndexesSequence(),r=Ot(this,ca).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${er(Ot(this,Rd))}s`;Ot(this,jr).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Ot(this,jr).getEngine()[r](Ot(this,jr).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(ua(this,Nb,e.map(i=>this.getHfIndexFromVisualIndex(i))),ua(this,kb,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=Ot(this,ca).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const i=[];return e.forEach(o=>{const s={from:o,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=s.from;a.from>s.from&&u&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{const s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(Ot(this,jr).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(Ot(this,Nb),Ot(this,kb)));Ot(this,jr).getSheetId()===null?Ot(this,jr).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${er(Ot(this,Rd))}Order`;return n=>{if(Ot(this,jr).isPerformingUndoRedo())return;const r=Ot(this,ca).getIndexesSequence();if(n==="update"){const i=Ot(this,lp).map(l=>r.indexOf(l)),o=Ot(this,jr).getEngine().getSheetDimensions(Ot(this,jr).getSheetId());let s;Ot(this,Rd)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);Ot(this,jr).getEngine()[e](Ot(this,jr).getSheetId(),i)}ua(this,lp,r)}}init(){ua(this,lp,Ot(this,ca).getIndexesSequence())}}const rN=Bwe;function Nl(t,e,n){Uwe(t,e),e.set(t,n)}function Uwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function us(t,e){var n=cj(t,e,"get");return zwe(t,n)}function zwe(t,e){return e.get?e.get.call(t):e.value}function kl(t,e,n){var r=cj(t,e,"set");return jwe(t,r,n),n}function cj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function jwe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var cp=new WeakMap,hp=new WeakMap,Lb=new WeakMap,$b=new WeakMap,Fb=new WeakMap,Wb=new WeakMap,Vb=new WeakMap;class Gwe{constructor(e,n,r){Nl(this,cp,{writable:!0,value:void 0}),Nl(this,hp,{writable:!0,value:void 0}),Nl(this,Lb,{writable:!0,value:void 0}),Nl(this,$b,{writable:!0,value:!1}),Nl(this,Fb,{writable:!0,value:!1}),Nl(this,Wb,{writable:!0,value:null}),Nl(this,Vb,{writable:!0,value:null}),kl(this,cp,new rN("row",e,this)),kl(this,hp,new rN("column",n,this)),kl(this,Lb,r)}getForAxis(e){return e==="row"?us(this,cp):us(this,hp)}setPerformUndo(e){kl(this,$b,e)}setPerformRedo(e){kl(this,Fb,e)}isPerformingUndoRedo(){return us(this,$b)||us(this,Fb)}getSheetId(){return us(this,Vb)}getEngine(){return us(this,Wb)}getPostponeAction(){return us(this,Lb)}setupSyncEndpoint(e,n){kl(this,Wb,e),kl(this,Vb,n),us(this,cp).init(),us(this,hp).init()}}const Ywe=Gwe;function Lt(t,e){hj(t,e),e.add(t)}function ic(t,e,n){return e=Kwe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kwe(t){var e=Xwe(t,"string");return typeof e=="symbol"?e:String(e)}function Xwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bb(t,e,n){hj(t,e),e.set(t,n)}function hj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nl(t,e,n){var r=dj(t,e,"set");return qwe(t,r,n),n}function qwe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Qc(t,e){var n=dj(t,e,"get");return Qwe(t,n)}function dj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Qwe(t,e){return e.get?e.get.call(t):e.value}function Et(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Qn="formulas",Zwe=["maxRows","maxColumns","language"],Jwe=260;we.getSingleton().register("afterNamedExpressionAdded");we.getSingleton().register("afterNamedExpressionRemoved");we.getSingleton().register("afterSheetAdded");we.getSingleton().register("afterSheetRemoved");we.getSingleton().register("afterSheetRenamed");we.getSingleton().register("afterFormulasValuesUpdate");const xh=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Vs=new WeakMap,Hx=new WeakMap,Ed=new WeakMap,iN=new WeakSet,oN=new WeakSet,Ub=new WeakSet,sN=new WeakSet,zb=new WeakSet,aN=new WeakSet,lN=new WeakSet,jb=new WeakSet,uN=new WeakSet,cN=new WeakSet,hN=new WeakSet,dN=new WeakSet,fN=new WeakSet,gN=new WeakSet,mN=new WeakSet,pN=new WeakSet,wN=new WeakSet,vN=new WeakSet,CN=new WeakSet,yN=new WeakSet,SN=new WeakSet,bN=new WeakSet,RN=new WeakSet,EN=new WeakSet;class eve extends ut{constructor(){var e;super(...arguments),e=this,Lt(this,EN),Lt(this,RN),Lt(this,bN),Lt(this,SN),Lt(this,yN),Lt(this,CN),Lt(this,vN),Lt(this,wN),Lt(this,pN),Lt(this,mN),Lt(this,gN),Lt(this,fN),Lt(this,dN),Lt(this,hN),Lt(this,cN),Lt(this,uN),Lt(this,jb),Lt(this,lN),Lt(this,aN),Lt(this,zb),Lt(this,sN),Lt(this,Ub),Lt(this,oN),Lt(this,iN),Bb(this,Vs,{writable:!0,value:!1}),Bb(this,Hx,{writable:!0,value:!1}),Bb(this,Ed,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Et(e,CN,pve).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Et(e,yN,wve).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Et(e,SN,vve).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Et(e,bN,Cve).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Et(e,RN,yve).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Et(e,EN,Sve).call(e,...r)}]]}),ic(this,"staticRegister",go("formulas")),ic(this,"engine",null),ic(this,"sheetName",null),ic(this,"indexSyncer",null),ic(this,"rowAxisSyncer",null),ic(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Qn}static get PLUGIN_PRIORITY(){return Jwe}static get SETTING_KEYS(){return[Qn,...Zwe]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Qn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Owe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){yt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,Ub,TN).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,zb,_N).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,Ub,TN).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,zb,_N).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,aN,ive).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,lN,ove).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,iN,tve).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,uN,sve).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,jb,MN).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,jb,MN).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,cN,ave).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,hN,lve).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,gN,hve).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,mN,dve).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,dN,uve).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,fN,cve).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,pN,fve).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,wN,gve).call(n,...i)}),this.indexSyncer=new Ywe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,sN,rve).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,vN,mve).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Et(n,oN,nve).call(n,...i)}),Qc(this,Ed).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){Qc(this,Ed).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),nN(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=xwe(this.hot.getSettings());Pwe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Qn];if(fe(r)&&fe(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Qn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Qc(this,Ed).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),nl(this,Ed,null),nN(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(fe(n)&&!AB(n))return yt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return yt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return yt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){B1(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${er(Qn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),tN(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return fe(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(fe(l)===!1||fe(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=tN(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){yt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return Ix(r,o.type)&&(sj(r,o.dateFormat)?r=aj(r,o.dateFormat):Lwe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function tve(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&wr(s)&&(s=lj(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function nve(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:m,col:C}=h.start,{row:b,col:p}=h.end,w=b-m+1,y=p-C+1;for(let E=0;E<f.length;E+=1)for(let T=0;T<f[E].length;T+=1){const x=f[E][T],A=E%w,W=T%y,B=this.hot.getCellMeta(A,W);Ix(x,B.type)&&(x.startsWith("'")?f[E][T]=x.slice(1):this.isFormulaCellType(A,W,this.sheetId)===!1&&(f[E][T]=$we(x,B.dateFormat)))}return f}function TN(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(er(Qn))||nl(this,Hx,_t(this.hot.getSettings().data))}function rve(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o),a=s.dateFormat;Ix(i,s.type)&&(e=!0,sj(i,a)?t[r][o]=aj(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(nl(this,Vs,!0),this.engine.setSheetContent(this.sheetId,t),nl(this,Vs,!1))}function _N(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(er(Qn)))if(this.sheetName=Nwe(this.engine,this.hot.getSettings()[Qn].sheetName),Qc(this,Hx))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){nl(this,Vs,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),nl(this,Vs,!1)}}}function ive(t,e,n,r){if(r!=="get"||Qc(this,Vs)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){oj(n.value)&&(n.value=kwe(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e);l.type==="date"&&wr(a)&&(a=lj(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function ove(t,e,n,r){if(r!=="get"||Qc(this,Vs)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function MN(t,e){if(xh(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function sve(t,e){if(xh(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!wr(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){yt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function ave(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function lve(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function uve(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function cve(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function hve(t,e,n){if(xh(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function dve(t,e,n){if(xh(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function fve(t,e,n,r){if(xh(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function gve(t,e,n,r){if(xh(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function mve(t,e,n){var r;nl(this,Vs,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());nl(this,Vs,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function pve(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function wve(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function vve(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Cve(t){this.hot.runHooks("afterSheetAdded",t)}function yve(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function Sve(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function bve(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(sM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Rve(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(aM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ye(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return M(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function oc(t,e){fj(t,e),e.add(t)}function xN(t,e,n){fj(t,e),e.set(t,n)}function fj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sc(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Jr(t,e){var n=gj(t,e,"get");return Eve(t,n)}function Eve(t,e){return e.get?e.get.call(t):e.value}function Td(t,e,n){var r=gj(t,e,"set");return Tve(t,r,n),n}function gj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Tve(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}we.getSingleton().register("beforeHideColumns");we.getSingleton().register("afterHideColumns");we.getSingleton().register("beforeUnhideColumns");we.getSingleton().register("afterUnhideColumns");const Gb="hiddenColumns",_ve=310;var Bo=new WeakMap,Mo=new WeakMap,PN=new WeakSet,ON=new WeakSet,AN=new WeakSet,IN=new WeakSet,HN=new WeakSet,DN=new WeakSet;class Mve extends ut{constructor(){super(...arguments),oc(this,DN),oc(this,HN),oc(this,IN),oc(this,AN),oc(this,ON),oc(this,PN),xN(this,Bo,{writable:!0,value:{}}),xN(this,Mo,{writable:!0,value:null})}static get PLUGIN_KEY(){return Gb}static get PLUGIN_PRIORITY(){return _ve}isEnabled(){return!!this.hot.getSettings()[Gb]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Gb];je(n)&&(Td(this,Bo,n),_t(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Td(this,Mo,new PC),Jr(this,Mo).addLocalHook("init",()=>sc(this,DN,Hve).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Jr(this,Mo)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return sc(e,HN,Ive).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>sc(this,ON,Pve).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>sc(this,PN,xve).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return sc(e,IN,Ave).call(e,...i)}),this.addHook("modifyCopyableRange",r=>sc(this,AN,Ove).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Td(this,Bo,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Jr(this,Mo).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));M(l,u=>{o[u]=!1}),i=an(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Jr(this,Mo).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{M(e,s=>{Jr(this,Mo).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ye(Jr(this,Mo).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Jr(this,Mo).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Td(this,Bo,null),Td(this,Mo,null),super.destroy()}}function xve(t,e){if(this.isHidden(e))return 0;if(Jr(this,Bo).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Pve(t,e,n){if(Jr(this,Bo).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Ove(t){if(Jr(this,Bo).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return M(t,r=>{let i=!0,o=0;Se(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Ave(t,e){if(!Jr(this,Bo).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),J(e,n)}function Ive(t){t.items.push({name:qe},bve(this),Rve(this))}function Hve(){Array.isArray(Jr(this,Bo).columns)&&this.hideColumns(Jr(this,Bo).columns)}function Dve(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(lM,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Nve(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(uM,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ye(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return M(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function ac(t,e){mj(t,e),e.add(t)}function NN(t,e,n){mj(t,e),e.set(t,n)}function mj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lc(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function yi(t,e){var n=pj(t,e,"get");return kve(t,n)}function kve(t,e){return e.get?e.get.call(t):e.value}function _d(t,e,n){var r=pj(t,e,"set");return Lve(t,r,n),n}function pj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Lve(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}we.getSingleton().register("beforeHideRows");we.getSingleton().register("afterHideRows");we.getSingleton().register("beforeUnhideRows");we.getSingleton().register("afterUnhideRows");const Yb="hiddenRows",$ve=320;var Ps=new WeakMap,xo=new WeakMap,kN=new WeakSet,LN=new WeakSet,$N=new WeakSet,FN=new WeakSet,WN=new WeakSet,VN=new WeakSet;class Fve extends ut{constructor(){super(...arguments),ac(this,VN),ac(this,WN),ac(this,FN),ac(this,$N),ac(this,LN),ac(this,kN),NN(this,Ps,{writable:!0,value:{}}),NN(this,xo,{writable:!0,value:null})}static get PLUGIN_KEY(){return Yb}static get PLUGIN_PRIORITY(){return $ve}isEnabled(){return!!this.hot.getSettings()[Yb]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Yb];je(n)&&(_d(this,Ps,n),_t(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),_d(this,xo,new PC),yi(this,xo).addLocalHook("init",()=>lc(this,VN,jve).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,yi(this,xo)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return lc(e,WN,zve).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>lc(this,LN,Vve).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>lc(this,kN,Wve).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return lc(e,FN,Uve).call(e,...i)}),this.addHook("modifyCopyableRange",r=>lc(this,$N,Bve).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),_d(this,Ps,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=yi(this,xo).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));M(l,u=>{o[u]=!1}),i=an(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&yi(this,xo).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{M(e,s=>{yi(this,xo).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ye(yi(this,xo).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return yi(this,xo).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){_d(this,Ps,null),_d(this,xo,null),super.destroy()}}function Wve(t,e){return this.isHidden(e)?0:t}function Vve(t,e,n){if(yi(this,Ps).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Bve(t){if(yi(this,Ps).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return M(t,r=>{let i=!0,o=0;Se(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Uve(t,e){if(!yi(this,Ps).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),J(e,n)}function zve(t){t.items.push({name:qe},Dve(this),Nve(this))}function jve(){Array.isArray(yi(this,Ps).rows)&&this.hideRows(yi(this,Ps).rows)}function Gve(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(k_)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Yve(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(L_)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function BN(t,e){wj(t,e),e.add(t)}function Kve(t,e,n){wj(t,e),e.set(t,n)}function wj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DE(t,e){var n=vj(t,e,"get");return Xve(t,n)}function Xve(t,e){return e.get?e.get.call(t):e.value}function Kb(t,e,n){var r=vj(t,e,"set");return qve(t,r,n),n}function vj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qve(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function UN(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}we.getSingleton().register("beforeColumnFreeze");we.getSingleton().register("afterColumnFreeze");we.getSingleton().register("beforeColumnUnfreeze");we.getSingleton().register("afterColumnUnfreeze");const zN="manualColumnFreeze",Qve=110;var jl=new WeakMap,jN=new WeakSet,GN=new WeakSet;class Zve extends ut{constructor(){super(...arguments),BN(this,GN),BN(this,jN),Kve(this,jl,{writable:!0,value:!1})}static get PLUGIN_KEY(){return zN}static get PLUGIN_PRIORITY(){return Qve}isEnabled(){return!!this.hot.getSettings()[zN]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>UN(this,jN,Jve).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>UN(this,GN,eCe).call(this,e,n)),super.enablePlugin())}disablePlugin(){Kb(this,jl,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;DE(this,jl)||Kb(this,jl,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;DE(this,jl)||Kb(this,jl,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Jve(t){t.items.push({name:"---------"},Gve(this),Yve(this))}function eCe(t,e){if(DE(this,jl)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function dp(t,e,n){return e=tCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tCe(t){var e=nCe(t,"string");return typeof e=="symbol"?e:String(e)}function nCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Xb=0,YN=1,KN=2,uc="px";let rCe=class{constructor(e){dp(this,"hot",void 0),dp(this,"_element",null),dp(this,"state",Xb),dp(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=KN}build(){this.state===Xb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=YN)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Xb}isAppended(){return this.state===KN}isBuilt(){return this.state>=YN}setPosition(e,n){wr(e)&&(this._element.style.top=e+uc),wr(n)&&(this._element.style[this.inlineProperty]=n+uc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){wr(e)&&(this._element.style.width=e+uc),wr(n)&&(this._element.style.height=n+uc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){wr(e)&&(this._element.style.marginTop=e+uc),wr(n)&&(this._element.style[`margin${er(this.inlineProperty)}`]=n+uc)}getOffset(){const e=this._element.style,n=`margin${er(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Cj=rCe,iCe="ht__manualColumnMove--backlight";let oCe=class extends Cj{build(){super.build(),J(this._element,iCe)}};const sCe=oCe,aCe="ht__manualColumnMove--guideline";let lCe=class extends Cj{build(){super.build(),J(this._element,aCe)}};const uCe=lCe;function cc(t,e){yj(t,e),e.add(t)}function zi(t,e,n){yj(t,e),e.set(t,n)}function yj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kr(t,e,n){var r=Sj(t,e,"set");return cCe(t,r,n),n}function cCe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ye(t,e){var n=Sj(t,e,"get");return hCe(t,n)}function Sj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function hCe(t,e){return e.get?e.get.call(t):e.value}function hc(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}we.getSingleton().register("beforeColumnMove");we.getSingleton().register("afterColumnMove");const qb="manualColumnMove",dCe=120,XN="ht__manualColumnMove",pv="show-ui",NE="on-moving--columns",kE="after-selection--columns";var mr=new WeakMap,Ra=new WeakMap,Os=new WeakMap,ow=new WeakMap,Ia=new WeakMap,gr=new WeakMap,fp=new WeakMap,pi=new WeakMap,Rc=new WeakMap,wv=new WeakMap,cf=new WeakMap,qN=new WeakSet,QN=new WeakSet,ZN=new WeakSet,JN=new WeakSet,ek=new WeakSet,tk=new WeakSet;class fCe extends ut{constructor(){super(...arguments),cc(this,tk),cc(this,ek),cc(this,JN),cc(this,ZN),cc(this,QN),cc(this,qN),zi(this,mr,{writable:!0,value:new sCe(this.hot)}),zi(this,Ra,{writable:!0,value:new uCe(this.hot)}),zi(this,Os,{writable:!0,value:[]}),zi(this,ow,{writable:!0,value:0}),zi(this,Ia,{writable:!0,value:!1}),zi(this,gr,{writable:!0,value:{}}),zi(this,fp,{writable:!0,value:void 0}),zi(this,pi,{writable:!0,value:void 0}),zi(this,Rc,{writable:!0,value:void 0}),zi(this,wv,{writable:!0,value:void 0}),zi(this,cf,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return qb}static get PLUGIN_PRIORITY(){return dCe}isEnabled(){return!!this.hot.getSettings()[qb]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hc(e,qN,gCe).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hc(e,ZN,pCe).call(e,...r)}),this.addHook("afterScrollVertically",()=>hc(this,ek,vCe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hc(e,tk,CCe).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),J(this.hot.rootElement,XN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){We(this.hot.rootElement,XN),this.unregisterEvents(),ye(this,mr).destroy(),ye(this,Ra).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=ye(this,fp),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(kr(this,fp,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return kr(this,fp,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=an(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[qb];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return Se(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(ye(this,pi))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,ye(this,pi)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=ye(this,mr).getOffset().start,u=ye(this,mr).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,C=vt(this.hot.rootElement),b=m.innerWidth-ye(this,Rc)-C;h=m.innerWidth-ye(this,gr).eventPageX-b-(r.scrollX===void 0?i:0)}else h=ye(this,gr).eventPageX-(ye(this,Rc)-(r.scrollX===void 0?i:0));if(ye(this,wv)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(ye(this,pi))&&(o+=i),o+=c,ye(this,pi)<0)ye(this,cf)>0?ye(this,gr).col=0:ye(this,gr).col=e>0?e-1:e;else if(ye(this,gr).TD.offsetWidth/2+o<=h){const m=ye(this,pi)>=ye(this,ow)?ye(this,ow)-1:ye(this,pi);ye(this,gr).col=m+1,o+=ye(this,gr).TD.offsetWidth}else ye(this,gr).col=ye(this,pi);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&ye(this,pi)<ye(this,cf)&&(f-=ye(this,Rc)<=r.scrollX?ye(this,Rc):0),ye(this,mr).setPosition(null,d),ye(this,Ra).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>hc(this,QN,mCe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>hc(this,JN,wCe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ye(this,mr).build(),ye(this,Ra).build()}destroy(){ye(this,mr).destroy(),ye(this,Ra).destroy(),super.destroy()}}function gCe(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=He(t.target,"sortAction");if(!s||!o||ye(this,Ia)||t.button!==0||a){kr(this,Ia,!1),ye(this,Os).length=0,We(this.hot.rootElement,[NE,pv]);return}const l=ye(this,Ra).isBuilt()&&!ye(this,Ra).isAppended(),u=ye(this,mr).isBuilt()&&!ye(this,mr).isAppended();l&&u&&(ye(this,Ra).appendTo(i.hider),ye(this,mr).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,kr(this,Ia,!0);const m=n.firstChild?$2(t,n.firstChild).x:t.offsetX;ye(this,gr).eventPageX=t.pageX,kr(this,pi,e.col),ye(this,gr).TD=n,ye(this,gr).col=e.col,kr(this,Os,this.prepareColumnsToMoving(d,f)),kr(this,wv,!!this.hot.getSettings().rowHeaders),kr(this,ow,this.hot.countCols()),kr(this,cf,this.hot.getSettings().fixedColumnsStart),kr(this,Rc,yn(this.hot.rootElement).left);const C=ye(this,wv)?-1:0,b=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,p=e.col<ye(this,cf),w=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),y=Math.abs(m-(this.hot.isRtl()?n.offsetWidth:0)),E=this.getColumnsWidth(d,e.col-1)+y,T=this.getColumnsWidth(C,d-1)+(p?w:0)+E;ye(this,mr).setPosition(b,T),ye(this,mr).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-b),ye(this,mr).setOffset(null,-E),J(this.hot.rootElement,NE)}else We(this.hot.rootElement,kE),kr(this,Ia,!1),ye(this,Os).length=0}function mCe(t){ye(this,Ia)&&(ye(this,gr).eventPageX=t.pageX,this.refreshPositions())}function pCe(t,e,n,r){!this.hot.getSelectedRangeLast()||!ye(this,Ia)||(ye(this,Os).indexOf(e.col)>-1?We(this.hot.rootElement,pv):J(this.hot.rootElement,pv),r.row=!0,r.column=!0,r.cell=!0,kr(this,pi,e.col),ye(this,gr).TD=n)}function wCe(){const t=ye(this,gr).col,e=ye(this,Os).length;if(kr(this,pi,void 0),kr(this,Ia,!1),We(this.hot.rootElement,[NE,pv,kE]),this.hot.selection.isSelectedByColumnHeader()&&J(this.hot.rootElement,kE),e<1||t===void 0)return;const n=ye(this,Os)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(ye(this,Os),t);if(ye(this,Os).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function vCe(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;ye(this,mr).setPosition(r),ye(this,mr).setSize(null,t.hider.offsetHeight-r)}function CCe(){this.moveBySettingsOrLoad()}function cs(t,e){bj(t,e),e.add(t)}function jn(t,e,n){bj(t,e),e.set(t,n)}function bj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hs(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function on(t,e,n){var r=Rj(t,e,"set");return yCe(t,r,n),n}function yCe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ce(t,e){var n=Rj(t,e,"get");return SCe(t,n)}function Rj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function SCe(t,e){return e.get?e.get.call(t):e.value}const vv="manualColumnResize",bCe=130,nk="manualColumnWidths";var Cs=new WeakMap,gp=new WeakMap,Xr=new WeakMap,Cv=new WeakMap,Wo=new WeakMap,RCe=new WeakMap,Zc=new WeakMap,mp=new WeakMap,Ar=new WeakMap,gs=new WeakMap,mu=new WeakMap,yv=new WeakMap,hf=new WeakMap,df=new WeakMap,Zr=new WeakMap,ff=new WeakMap,rk=new WeakSet,ik=new WeakSet,ok=new WeakSet,sk=new WeakSet,ak=new WeakSet,lk=new WeakSet,uk=new WeakSet,ck=new WeakSet,hk=new WeakSet;class ECe extends ut{static get PLUGIN_KEY(){return vv}static get PLUGIN_PRIORITY(){return bCe}constructor(e){super(e),cs(this,hk),cs(this,ck),cs(this,uk),cs(this,lk),cs(this,ak),cs(this,sk),cs(this,ok),cs(this,ik),cs(this,rk),jn(this,Cs,{writable:!0,value:null}),jn(this,gp,{writable:!0,value:null}),jn(this,Xr,{writable:!0,value:[]}),jn(this,Cv,{writable:!0,value:null}),jn(this,Wo,{writable:!0,value:null}),jn(this,RCe,{writable:!0,value:null}),jn(this,Zc,{writable:!0,value:null}),jn(this,mp,{writable:!0,value:null}),jn(this,Ar,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),jn(this,gs,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),jn(this,mu,{writable:!0,value:null}),jn(this,yv,{writable:!0,value:!1}),jn(this,hf,{writable:!0,value:0}),jn(this,df,{writable:!0,value:null}),jn(this,Zr,{writable:!0,value:void 0}),jn(this,ff,{writable:!0,value:void 0}),J(ce(this,Ar),"manualColumnResizer"),J(ce(this,gs),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[vv]}enablePlugin(){this.enabled||(on(this,Zr,new cl),ce(this,Zr).addLocalHook("init",()=>hs(this,rk,TCe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ce(this,Zr)),this.addHook("modifyColWidth",(e,n)=>hs(this,uk,ACe).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>hs(this,ck,ICe).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>hs(this,hk,HCe).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){on(this,ff,ce(this,Zr).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",nk,ce(this,Zr).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",nk,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return ce(this,Zr).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ce(this,Zr).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;on(this,Cs,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(ce(this,Cs)),i=r.col;if(i<0)return;const o=Ut(ce(this,Cs)),s=ce(this,Cs).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ce(this,Cs),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ce(this,Cs),r.row,r.col)),on(this,gp,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),on(this,Xr,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();M(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;Se(d,f,m=>{ce(this,Xr).includes(m)||ce(this,Xr).push(m)})})}ce(this,Xr).includes(ce(this,gp))||on(this,Xr,[ce(this,gp)]),on(this,mp,l.start-6),on(this,Zc,parseInt(s.width,10)),ce(this,Ar).style.top=`${l.top}px`,ce(this,Ar).style[this.inlineDir]=`${ce(this,mp)+ce(this,Zc)}px`,ce(this,Ar).style.height=`${o}px`,this.hot.rootElement.appendChild(ce(this,Ar))}refreshHandlePosition(){ce(this,Ar).style[this.inlineDir]=`${ce(this,mp)+ce(this,Cv)}px`}setupGuidePosition(){const e=parseInt(Ut(ce(this,Ar)),10),n=parseInt(ce(this,Ar).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);J(ce(this,Ar),"active"),J(ce(this,gs),"active"),ce(this,gs).style.top=`${n}px`,this.refreshGuidePosition(),ce(this,gs).style.height=`${r-e}px`,this.hot.rootElement.appendChild(ce(this,gs))}refreshGuidePosition(){ce(this,gs).style[this.inlineDir]=ce(this,Ar).style[this.inlineDir]}hideHandleAndGuide(){We(ce(this,Ar),"active"),We(ce(this,gs),"active")}checkIfColumnHeader(e){const n=qa(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",ce(this,Wo),r,!0);o!==void 0&&on(this,Wo,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,ce(this,Wo)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ce(this,Wo),r,!0),i&&e()};ce(this,hf)>=2&&(ce(this,Xr).length>1?(M(ce(this,Xr),i=>{n(i)}),e()):M(ce(this,Xr),i=>{n(i,!0)})),on(this,hf,0),on(this,df,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>hs(this,ik,_Ce).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>hs(this,ok,MCe).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>hs(this,sk,xCe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>hs(this,ak,PCe).call(this)),this.eventManager.addEventListener(ce(this,Ar),"contextmenu",()=>hs(this,lk,OCe).call(this))}destroy(){super.destroy()}}function TCe(){const t=this.hot.getSettings()[vv],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{ce(this,Zr).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{ce(this,Zr).setValueAtIndex(r,n)})},!0),on(this,ff,t)):t===!0&&Array.isArray(ce(this,ff))&&this.hot.batchExecution(()=>{ce(this,ff).forEach((n,r)=>{ce(this,Zr).setValueAtIndex(r,n)})},!0)}function _Ce(t){if(!I1(t.target)&&ce(this,yv)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ce(this,mu)||this.setupHandlePosition(e))}}function MCe(t){He(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ce(this,Cs)),this.setupGuidePosition(),on(this,mu,!0),ce(this,df)===null&&(on(this,df,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ce(this,df))),on(this,hf,ce(this,hf)+1),this.startX=t.pageX,on(this,Wo,ce(this,Zc)))}function xCe(t){if(ce(this,mu)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();on(this,Cv,ce(this,Zc)+e),M(ce(this,Xr),n=>{on(this,Wo,this.setManualSize(n,ce(this,Cv)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function PCe(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",ce(this,Wo),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ce(this,Wo),n,!1)};ce(this,mu)&&(this.hideHandleAndGuide(),on(this,mu,!1),ce(this,Wo)!==ce(this,Zc)&&(ce(this,Xr).length>1?(M(ce(this,Xr),r=>{e(r)}),t()):M(ce(this,Xr),r=>{e(r,!0)})),this.setupHandlePosition(ce(this,Cs)))}function OCe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ce(this,Ar)),this.hot.rootElement.removeChild(ce(this,gs)),on(this,mu,!1),on(this,yv,!0),this.hot._registerImmediate(()=>{on(this,yv,!1)})}function ACe(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=ce(this,Zr).getValueAtIndex(r);this.hot.getSettings()[vv]&&i&&(n=i)}return n}function ICe(t,e){let n=ce(this,Zr).getValueAtIndex(e);return n===null&&(n=t),n}function HCe(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Qb(t,e,n){return e=DCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DCe(t){var e=NCe(t,"string");return typeof e=="symbol"?e:String(e)}function NCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Zb=0,dk=1,fk=2,dc="px";let kCe=class{constructor(e){Qb(this,"hot",void 0),Qb(this,"_element",null),Qb(this,"state",Zb),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=fk}build(){this.state===Zb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=dk)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Zb}isAppended(){return this.state===fk}isBuilt(){return this.state>=dk}setPosition(e,n){e!==void 0&&(this._element.style.top=e+dc),n!==void 0&&(this._element.style.left=n+dc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+dc),n&&(this._element.style.height=n+dc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+dc),n&&(this._element.style.marginLeft=n+dc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Ej=kCe,LCe="ht__manualRowMove--backlight";class $Ce extends Ej{build(){super.build(),J(this._element,LCe)}}const FCe=$Ce,WCe="ht__manualRowMove--guideline";class VCe extends Ej{build(){super.build(),J(this._element,WCe)}}const BCe=VCe;function fc(t,e){Tj(t,e),e.add(t)}function gc(t,e,n){Tj(t,e),e.set(t,n)}function Tj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tu(t,e,n){var r=_j(t,e,"set");return UCe(t,r,n),n}function UCe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ve(t,e){var n=_j(t,e,"get");return zCe(t,n)}function _j(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function zCe(t,e){return e.get?e.get.call(t):e.value}function mc(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}we.getSingleton().register("beforeRowMove");we.getSingleton().register("afterRowMove");const Jb="manualRowMove",jCe=140,gk="ht__manualRowMove",Sv="show-ui",LE="on-moving--rows",$E="after-selection--rows";var pr=new WeakMap,Ea=new WeakMap,As=new WeakMap,Ha=new WeakMap,Lr=new WeakMap,pp=new WeakMap,mk=new WeakSet,pk=new WeakSet,wk=new WeakSet,vk=new WeakSet,Ck=new WeakSet,yk=new WeakSet;class GCe extends ut{constructor(){super(...arguments),fc(this,yk),fc(this,Ck),fc(this,vk),fc(this,wk),fc(this,pk),fc(this,mk),gc(this,pr,{writable:!0,value:new FCe(this.hot)}),gc(this,Ea,{writable:!0,value:new BCe(this.hot)}),gc(this,As,{writable:!0,value:[]}),gc(this,Ha,{writable:!0,value:void 0}),gc(this,Lr,{writable:!0,value:{}}),gc(this,pp,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Jb}static get PLUGIN_PRIORITY(){return jCe}isEnabled(){return!!this.hot.getSettings()[Jb]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mc(e,mk,YCe).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mc(e,wk,XCe).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>mc(this,Ck,QCe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mc(e,yk,ZCe).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),J(this.hot.rootElement,gk),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){We(this.hot.rootElement,gk),this.unregisterEvents(),Ve(this,pr).destroy(),Ve(this,Ea).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Ve(this,pp),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(tu(this,pp,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return tu(this,pp,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=an(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Jb];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return Se(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Ve(this,Lr).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Ve(this,Lr).TD,a=this.hot.rootElement,l=yn(a),u=hu(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Ve(this,Lr).eventPageY-d+c,m=o.hider.offsetHeight,C=o.TBODY.offsetTop,b=Ve(this,pr).getOffset().top,p=Ve(this,pr).getSize().height,w=s.offsetHeight/2,y=s.offsetHeight;let E=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const T=f>=E+w;this.isFixedRowTop(e.row)&&(E+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Ve(this,Lr).row=n>0?n-1:n:T?(Ve(this,Lr).row=e.row+1,E+=e.row===0?y-1:y):Ve(this,Lr).row=e.row;let x=f,A=E;f+p+b>=m?x=m-p-b:f+b<C&&(x=C+Math.abs(b)),E>=m-1&&(A=m-1),Ve(this,pr).setPosition(x),Ve(this,Ea).setPosition(A)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>mc(this,pk,KCe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>mc(this,vk,qCe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ve(this,pr).build(),Ve(this,Ea).build()}destroy(){Ve(this,pr).destroy(),Ve(this,Ea).destroy(),super.destroy()}}function YCe(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Ve(this,Ha)||t.button!==0){tu(this,Ha,!1),Ve(this,As).length=0,We(this.hot.rootElement,[LE,Sv]);return}const l=Ve(this,Ea).isBuilt()&&!Ve(this,Ea).isAppended(),u=Ve(this,pr).isBuilt()&&!Ve(this,pr).isAppended();l&&u&&(Ve(this,Ea).appendTo(i.hider),Ve(this,pr).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,tu(this,Ha,!0),Ve(this,Lr).eventPageY=t.pageY,Ve(this,Lr).coords=e,Ve(this,Lr).TD=n,tu(this,As,this.prepareRowsToMoving());const m=i.holder.scrollLeft+o.getRowHeaderWidth(),C=this.getRowsHeight(d,e.row-1)+t.offsetY;Ve(this,pr).setPosition(null,m),Ve(this,pr).setSize(i.hider.offsetWidth-m,this.getRowsHeight(d,f)),Ve(this,pr).setOffset(-C,null),J(this.hot.rootElement,LE),this.refreshPositions()}else We(this.hot.rootElement,$E),tu(this,Ha,!1),Ve(this,As).length=0}function KCe(t){Ve(this,Ha)&&(Ve(this,Lr).eventPageY=t.pageY,this.refreshPositions())}function XCe(t,e,n,r){!this.hot.getSelectedRangeLast()||!Ve(this,Ha)||(Ve(this,As).indexOf(e.row)>-1?We(this.hot.rootElement,Sv):J(this.hot.rootElement,Sv),r.row=!0,r.column=!0,r.cell=!0,Ve(this,Lr).coords=e,Ve(this,Lr).TD=n)}function qCe(){const t=Ve(this,Lr).row,e=Ve(this,As).length;if(tu(this,Ha,!1),We(this.hot.rootElement,[LE,Sv,$E]),this.hot.selection.isSelectedByRowHeader()&&J(this.hot.rootElement,$E),e<1||t===void 0)return;const n=Ve(this,As)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Ve(this,As),t);if(Ve(this,As).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function QCe(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Ve(this,pr).setPosition(null,r),Ve(this,pr).setSize(t.hider.offsetWidth-r)}function ZCe(){this.moveBySettingsOrLoad()}function Ll(t,e){Mj(t,e),e.add(t)}function Gn(t,e,n){Mj(t,e),e.set(t,n)}function Mj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $l(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Kt(t,e,n){var r=xj(t,e,"set");return JCe(t,r,n),n}function JCe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ue(t,e){var n=xj(t,e,"get");return eye(t,n)}function xj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function eye(t,e){return e.get?e.get.call(t):e.value}const bv="manualRowResize",tye=30,Sk="manualRowHeights";var Do=new WeakMap,wp=new WeakMap,qr=new WeakMap,Rv=new WeakMap,Ta=new WeakMap,Dx=new WeakMap,Jc=new WeakMap,vp=new WeakMap,hr=new WeakMap,Ao=new WeakMap,pu=new WeakMap,Ev=new WeakMap,gf=new WeakMap,mf=new WeakMap,Zi=new WeakMap,pf=new WeakMap,bk=new WeakSet,Rk=new WeakSet,Ek=new WeakSet,Tk=new WeakSet,_k=new WeakSet,Mk=new WeakSet,xk=new WeakSet;class nye extends ut{static get PLUGIN_KEY(){return bv}static get PLUGIN_PRIORITY(){return tye}constructor(e){super(e),Ll(this,xk),Ll(this,Mk),Ll(this,_k),Ll(this,Tk),Ll(this,Ek),Ll(this,Rk),Ll(this,bk),Gn(this,Do,{writable:!0,value:null}),Gn(this,wp,{writable:!0,value:null}),Gn(this,qr,{writable:!0,value:[]}),Gn(this,Rv,{writable:!0,value:null}),Gn(this,Ta,{writable:!0,value:null}),Gn(this,Dx,{writable:!0,value:null}),Gn(this,Jc,{writable:!0,value:null}),Gn(this,vp,{writable:!0,value:null}),Gn(this,hr,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Gn(this,Ao,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Gn(this,pu,{writable:!0,value:!1}),Gn(this,Ev,{writable:!0,value:!1}),Gn(this,gf,{writable:!0,value:0}),Gn(this,mf,{writable:!0,value:null}),Gn(this,Zi,{writable:!0,value:void 0}),Gn(this,pf,{writable:!0,value:void 0}),J(ue(this,hr),"manualRowResizer"),J(ue(this,Ao),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[bv]}enablePlugin(){this.enabled||(Kt(this,Zi,new cl),ue(this,Zi).addLocalHook("init",()=>$l(this,xk,uye).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ue(this,Zi)),this.addHook("modifyRowHeight",(e,n)=>$l(this,Mk,lye).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Kt(this,pf,ue(this,Zi).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",Sk,ue(this,Zi).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",Sk,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,MC.DEFAULT_HEIGHT);return ue(this,Zi).setValueAtIndex(r,i),i}setupHandlePosition(e){Kt(this,Do,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ue(this,Do)),o=i.row;if(o<0)return;const s=vt(ue(this,Do)),a=ue(this,Do).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ue(this,Do),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ue(this,Do),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ue(this,Do),i.row,i.col)),Kt(this,wp,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Kt(this,qr,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();M(d,f=>{const m=f.getTopStartCorner().row,C=f.getBottomStartCorner().row;Se(m,C,b=>{ue(this,qr).includes(b)||ue(this,qr).push(b)})})}ue(this,qr).includes(ue(this,wp))||Kt(this,qr,[ue(this,wp)]),Kt(this,vp,c.top-6),Kt(this,Jc,parseInt(a.height,10)),ue(this,hr).style.top=`${ue(this,vp)+ue(this,Jc)}px`,ue(this,hr).style[this.inlineDir]=`${c.start}px`,ue(this,hr).style.width=`${s}px`,this.hot.rootElement.appendChild(ue(this,hr))}refreshHandlePosition(){ue(this,hr).style.top=`${ue(this,vp)+ue(this,Rv)}px`}setupGuidePosition(){const e=parseInt(vt(ue(this,hr)),10),n=parseInt(ue(this,hr).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);J(ue(this,hr),"active"),J(ue(this,Ao),"active"),ue(this,Ao).style.top=ue(this,hr).style.top,ue(this,Ao).style[this.inlineDir]=`${n}px`,ue(this,Ao).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ue(this,Ao))}refreshGuidePosition(){ue(this,Ao).style.top=ue(this,hr).style.top}hideHandleAndGuide(){We(ue(this,hr),"active"),We(ue(this,Ao),"active")}checkIfRowHeader(e){const n=qa(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ue(this,Ta)<n?n:ue(this,Ta)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Kt(this,Ta,o),this.setManualSize(r,ue(this,Ta)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ue(this,gf)>=2&&(ue(this,qr).length>1?(M(ue(this,qr),i=>{n(i)}),e()):M(ue(this,qr),i=>{n(i,!0)})),Kt(this,gf,0),Kt(this,mf,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>$l(this,bk,rye).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>$l(this,Rk,iye).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>$l(this,Ek,oye).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>$l(this,Tk,sye).call(this)),this.eventManager.addEventListener(ue(this,hr),"contextmenu",()=>$l(this,_k,aye).call(this))}destroy(){super.destroy()}}function rye(t){if(!I1(t.target)&&ue(this,Ev)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ue(this,pu)||this.setupHandlePosition(e))}}function iye(t){He(t.target,"manualRowResizer")&&(this.setupHandlePosition(ue(this,Do)),this.setupGuidePosition(),Kt(this,pu,!0),ue(this,mf)===null&&(Kt(this,mf,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ue(this,mf))),Kt(this,gf,ue(this,gf)+1),Kt(this,Dx,t.pageY),Kt(this,Ta,ue(this,Jc)))}function oye(t){ue(this,pu)&&(Kt(this,Rv,ue(this,Jc)+(t.pageY-ue(this,Dx))),M(ue(this,qr),e=>{Kt(this,Ta,this.setManualSize(e,ue(this,Rv)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function sye(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ue(this,pu)&&(this.hideHandleAndGuide(),Kt(this,pu,!1),ue(this,Ta)!==ue(this,Jc)&&(ue(this,qr).length>1?(M(ue(this,qr),r=>{e(r)}),t()):M(ue(this,qr),r=>{e(r,!0)})),this.setupHandlePosition(ue(this,Do)))}function aye(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ue(this,hr)),this.hot.rootElement.removeChild(ue(this,Ao)),Kt(this,pu,!1),Kt(this,Ev,!0),this.hot._registerImmediate(()=>{Kt(this,Ev,!1)})}function lye(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ue(this,Zi).getValueAtIndex(r);this.hot.getSettings()[bv]&&i&&(n=i)}return n}function uye(){const t=this.hot.getSettings()[bv],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ue(this,Zi).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ue(this,Zi).setValueAtIndex(r,n)}),Kt(this,pf,t)):t===!0&&Array.isArray(ue(this,pf))&&ue(this,pf).forEach((n,r)=>{ue(this,Zi).setValueAtIndex(r,n)})},!0)}function Fl(t,e,n){return e=cye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cye(t){var e=hye(t,"string");return typeof e=="symbol"?e:String(e)}function hye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dye{constructor(e,n,r,i,o,s){Fl(this,"row",void 0),Fl(this,"col",void 0),Fl(this,"rowspan",void 0),Fl(this,"colspan",void 0),Fl(this,"removed",!1),Fl(this,"cellCoordsFactory",void 0),Fl(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return pt`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return pt`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return pt`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return pt`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const No=dye;function FE(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function e0(t,e,n){return e=fye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fye(t){var e=gye(t,"string");return typeof e=="symbol"?e:String(e)}function gye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nx{constructor(e){e0(this,"plugin",void 0),e0(this,"mergedCells",[]),e0(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return pt`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let i=!1;return M(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){const n=this.mergedCells;let r=!1;return M(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let o=e;if(!o.includesRange){const s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return M(r,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);n?o.overlaps(u)&&i.push(s):o.includesRange(u)&&i.push(s)}),i.length?i:!1}add(e){const n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new No(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),n.push(a),a):(yt(Nx.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){const e=this.mergedCells,n=[],r=[];M(e,i=>{const o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,M(n,(i,o)=>{Se(0,i.rowspan-1,s=>{Se(0,i.colspan-1,a=>{if(a!==0||s!==0){const l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),M(n,i=>{FE(...i)}),M(r,i=>{FE(...i)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return M(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}M(this.mergedCells,o=>{o.shift(i,n)}),Xw(this.mergedCells.length-1,0,o=>{const s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const mye=Nx;function t0(t,e,n){return e=pye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pye(t){var e=wye(t,"string");return typeof e=="symbol"?e:String(e)}function wye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vye{constructor(e){t0(this,"plugin",void 0),t0(this,"mergedCellsCollection",void 0),t0(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,m=s-f,C=this.getFarthestCollection(e,n,r,i);if(C){if(r==="down"){const b=C.row+C.rowspan-a-m;o[2]+b>=this.plugin.hot.countRows()?o[2]-=m:o[2]+=m?b:0}else if(r==="right"){const b=C.col+C.colspan-l-m;o[3]+b>=this.plugin.hot.countCols()?o[3]-=m:o[3]+=m?b:0}else if(r==="up"){const b=u-m-C.row+1;o[0]+b<0?o[0]+=m:o[0]-=m?b:0}else if(r==="left"){const b=c-m-C.col+1;o[1]+b<0?o[1]+=m:o[1]-=m?b:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),hn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[i,a+1,c,h];default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,m=Math.floor(d/f)*f,C=d-m;let b=null,p=null,w=null;switch(r){case"up":b="includesVertically",w=c-C+1;break;case"left":b="includesHorizontally",w=c-C+1;break;case"down":b="includesVertically",w=h+C-1;break;case"right":b="includesHorizontally",w=h+C-1;break}return M(i,y=>{y[b](w)&&y.isFarther(p,r)&&(p=y)}),p}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return M(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}const Cye=vye;function n0(t,e,n){return e=yye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yye(t){var e=Sye(t,"string");return typeof e=="symbol"?e:String(e)}function Sye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bye{constructor(e){n0(this,"plugin",void 0),n0(this,"hot",void 0),n0(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){const i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const Rye=bye;function Eye(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(F_)}return this.getTranslatedPhrase($_)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?No.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function rn(t,e){Pj(t,e),e.add(t)}function Tye(t,e,n){Pj(t,e),e.set(t,n)}function Pj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r0(t,e,n){return e=_ye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ye(t){var e=Mye(t,"string");return typeof e=="symbol"?e:String(e)}function Mye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function i0(t,e,n){var r=Oj(t,e,"set");return xye(t,r,n),n}function xye(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function pc(t,e){var n=Oj(t,e,"get");return Pye(t,n)}function Oj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Pye(t,e){return e.get?e.get.call(t):e.value}function jt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}we.getSingleton().register("beforeMergeCells");we.getSingleton().register("afterMergeCells");we.getSingleton().register("beforeUnmergeCells");we.getSingleton().register("afterUnmergeCells");const wf="mergeCells",Oye=150,Pk=wf;var Io=new WeakMap,Ok=new WeakSet,Ak=new WeakSet,Ik=new WeakSet,Hk=new WeakSet,Dk=new WeakSet,Nk=new WeakSet,kk=new WeakSet,o0=new WeakSet,Lk=new WeakSet,$k=new WeakSet,Fk=new WeakSet,Wk=new WeakSet,Vk=new WeakSet,Bk=new WeakSet,Uk=new WeakSet,zk=new WeakSet,jk=new WeakSet,Gk=new WeakSet,Yk=new WeakSet,Kk=new WeakSet,Xk=new WeakSet,qk=new WeakSet;class Aye extends ut{constructor(){super(...arguments),rn(this,qk),rn(this,Xk),rn(this,Kk),rn(this,Yk),rn(this,Gk),rn(this,jk),rn(this,zk),rn(this,Uk),rn(this,Bk),rn(this,Vk),rn(this,Wk),rn(this,Fk),rn(this,$k),rn(this,Lk),rn(this,o0),rn(this,kk),rn(this,Nk),rn(this,Dk),rn(this,Hk),rn(this,Ik),rn(this,Ak),rn(this,Ok),r0(this,"mergedCellsCollection",null),r0(this,"autofillCalculations",null),r0(this,"selectionCalculations",null),Tye(this,Io,{writable:!0,value:null})}static get PLUGIN_KEY(){return wf}static get PLUGIN_PRIORITY(){return Oye}isEnabled(){return!!this.hot.getSettings()[wf]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new mye(this),this.autofillCalculations=new Cye(this),this.selectionCalculations=new Rye(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Ok,Iye).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Ik,Dye).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Kk,qye).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Hk,Nye).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Dk,kye).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,o0,Qk).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,o0,Qk).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Lk,Fye).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Ak,Hye).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,kk,$ye).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Nk,Lye).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,$k,Wye).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Fk,Vye).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Wk,Bye).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Vk,Uye).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Bk,zye).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Uk,jye).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,zk,Gye).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,jk,Yye).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Gk,Kye).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Yk,Xye).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,Xk,Qye).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return jt(e,qk,Zye).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[wf];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!L1())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=ah(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=ah(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(No.containsNegativeValues(e)?(yt(No.NEGATIVE_VALUES_WARNING(e)),n=!1):No.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(yt(No.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):No.isSingleCell(e)?(yt(No.IS_SINGLE_CELL(e)),n=!1):No.containsZeroSpan(e)&&(yt(No.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(M(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),Se(r.row,r.row+r.rowspan-1,a=>{Se(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),Se(0,s.rowspan-1,c=>{Se(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),M(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),Se(0,i.rowspan-1,o=>{Se(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:Pk})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Pk)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(je(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(je(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(je(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(je(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Iye(){this.generateFromSettings(this.hot.getSettings()[wf]),this.hot.render()}function Hye(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function Dye(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},r=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if(pc(this,Io)||i0(this,Io,this.hot._createCellCoords(null,null)),o){const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes(pc(this,Io))||i0(this,Io,this.hot._createCellCoords(null,null)),n.row=pc(this,Io).row?pc(this,Io).row-i.row:n.row,n.col=pc(this,Io).col?pc(this,Io).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(r.row,r.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);i0(this,Io,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function Nye(t){const e=this.hot.getSelectedRangeLast(),n=Cr(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=Cr(n);const o=this.mergedCellsCollection.getWithinRange(r,!0);do i=Cr(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),M(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function kye(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function Lye(t){t.items.push({name:"---------"},Eye(this))}function $ye(t,e,n){const r=this.mergedCellsCollection.get(e,n),i=je(r)?Cr(r):void 0;if(je(i)){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[h,d]=this.translateMergedCellToRenderable(a,c,l,u),f=o.getRenderableFromVisualIndex(e),m=s.getRenderableFromVisualIndex(n),C=h-f+1,b=d-m+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,C),i.colspan=Math.min(i.colspan,b)}FE(t,i,e,n)}function Qk(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function Fye(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){const o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function Wye(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Vye(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Bye(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Uye(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function zye(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function jye(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Gye(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Yye(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Kye(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Xye(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);M(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function qye(t,e,n){if(!this.enabled)return;const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,u=r.row===0,c=r.col+r.colspan-1===this.hot.countCols()-1,h=r.col===0;(i&&l||o&&u||a&&c||s&&h)&&(t.row=r.row,t.col=r.col)}function Qye(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Zye(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Jye(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:rz(u.type))(l,u,d)(c,h);if(m===jo){const C=a+1;if(typeof e[C]<"u")return s(C)}return m}(0)}}function Zk(){yt(pt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const Aj="sort";function eSe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${Aj}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function tSe(t){const e=t.className.split(" "),n=new RegExp(`^${Aj}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function nSe(t,e,n){return e=rSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rSe(t){var e=iSe(t,"string");return typeof e=="symbol"?e:String(e)}function iSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Tv="multiColumnSorting",oSe=170,Jk="columnSorting",eL=Tv;nz(Tv,Jye);class sSe extends iz{constructor(){super(...arguments),nSe(this,"pluginKey",Tv)}static get PLUGIN_KEY(){return Tv}static get PLUGIN_PRIORITY(){return oSe}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Jk]&&Zk(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,uv))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:eL})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(eL)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),We(e,tSe(e)),this.enabled!==!1&&J(e,eSe(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Jk]&&Zk(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){bx(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,uv))):this.sort(this.getColumnNextConfig(n.col)))}}function tL(t,e,n){return e=aSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aSe(t){var e=lSe(t,"string");return typeof e=="symbol"?e:String(e)}function lSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uSe="multipleSelectionHandles",cSe=160;class hSe extends ut{constructor(){super(...arguments),tL(this,"dragged",[]),tL(this,"lastSetCell",null)}static get PLUGIN_KEY(){return uSe}static get PLUGIN_PRIORITY(){return cSe}isEnabled(){return _s()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(He(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(He(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(He(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(He(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function WE(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function Ij(){return{label:"",isPlaceholder:!0}}function dSe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;M(t,i=>{const o=[];let s=0;n.push(o),M(i,a=>{const l=WE();if(je(a)){const{label:c,colspan:h}=a;l.label=Zt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h)}else l.label=Zt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(Ij());return!u})});const r=Math.max(...Ye(n,i=>i.length));return M(n,i=>{if(i.length<r){const o=Ye(new Array(r-i.length),()=>WE());i.splice(i.length,0,...o)}}),n}function s0(t,e,n){fSe(t,e),e.set(t,n)}function fSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ji(t,e){var n=Hj(t,e,"get");return gSe(t,n)}function gSe(t,e){return e.get?e.get.call(t):e.value}function Md(t,e,n){var r=Hj(t,e,"set");return mSe(t,r,n),n}function Hj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function mSe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const nL=["label","collapsible"];var ds=new WeakMap,Wl=new WeakMap,a0=new WeakMap;class pSe{constructor(){s0(this,ds,{writable:!0,value:[]}),s0(this,Wl,{writable:!0,value:0}),s0(this,a0,{writable:!0,value:1/0})}setColumnsLimit(e){Md(this,a0,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Md(this,ds,dSe(e,ji(this,a0))),Md(this,Wl,ji(this,ds).length)}getData(){return ji(this,ds)}mergeWith(e){M(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&hn(s,o,nL)})}map(e){M(ji(this,ds),n=>{M(n,r=>{const i=e({...r});je(i)&&hn(r,i,nL)})})}getHeaderSettings(e,n){var r;if(e>=ji(this,Wl)||e<0)return null;const i=ji(this,ds)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=ji(this,Wl)||e<0)return i;const o=ji(this,ds)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return ji(this,Wl)}getColumnsCount(){return ji(this,Wl)>0?ji(this,ds)[0].length:0}clear(){Md(this,ds,[]),Md(this,Wl,0)}}function l0(t,e,n){return e=wSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wSe(t){var e=vSe(t,"string");return typeof e=="symbol"?e:String(e)}function vSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Dj="DF-pre-order";function Nj(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=Nj.call(this.childs[r],t,e)}return n}const CSe="DF-post-order";function kj(t,e){for(let n=0;n<this.childs.length;n++)if(kj.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const Lj="BF";function ySe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const SSe=Lj,rL=new Map([[Dj,Nj],[CSe,kj],[Lj,ySe]]);class _v{constructor(e){l0(this,"data",{}),l0(this,"parent",null),l0(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new _v({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:SSe;if(!rL.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);rL.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function u0(t,e,n){bSe(t,e),e.set(t,n)}function bSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cr(t,e){var n=$j(t,e,"get");return RSe(t,n)}function RSe(t,e){return e.get?e.get.call(t):e.value}function ESe(t,e,n){var r=$j(t,e,"set");return TSe(t,r,n),n}function $j(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function TSe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var wc=new WeakMap,Vl=new WeakMap,vc=new WeakMap;class _Se{constructor(e){u0(this,wc,{writable:!0,value:new Map}),u0(this,Vl,{writable:!0,value:new Map}),u0(this,vc,{writable:!0,value:null}),ESe(this,vc,e)}getRoots(){return Array.from(cr(this,wc).values())}getRootByColumn(e){let n;return cr(this,Vl).has(e)&&(n=cr(this,wc).get(cr(this,Vl).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-cr(this,Vl).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;cr(this,Vl).clear(),M(cr(this,wc),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)cr(this,Vl).set(i,e);e+=r})}buildTree(){this.clear();const e=cr(this,vc).getColumnsCount();let n=0;for(;n<e;){const r=cr(this,vc).getHeaderSettings(0,n),i=new _v;cr(this,wc).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=cr(this,vc).getHeadersSettings(r,n,i);r+=1,M(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new _v(a),e.addChild(l)),r<cr(this,vc).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){cr(this,wc).clear(),cr(this,Vl).clear()}}function Fj(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function Mv(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function xv(t){return Mv(t,"origColspan")===t.data.origColspan}function kx(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(xv(t))return kx(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)M(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,Fj(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):xv(a)&&(l.isCollapsed=Mv(a,"isCollapsed"))}),{rollbackModification:()=>Lx(t),affectedColumns:Array.from(o),colspanCompensation:s}}function Lx(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(xv(t))return Lx(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)M(o,l=>{Fj(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=Mv(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):xv(l)&&(u.isCollapsed=Mv(l,"isCollapsed"))}),{rollbackModification:()=>kx(t),affectedColumns:Array.from(s),colspanCompensation:a}}function MSe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(pt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function xSe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(pt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const iL=new Map([["collapse",Lx],["expand",kx],["hide-column",MSe],["show-column",xSe]]);function PSe(t,e,n){if(!iL.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return iL.get(t)(e,n)}function Cp(t){const e=[];return M(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=ASe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(Ij());else{const f=OSe(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function OSe(t){const{crossHiddenColumns:e,...n}=WE(t);return n}function ASe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function c0(t,e,n){ISe(t,e),e.set(t,n)}function ISe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xd(t,e,n){var r=Wj(t,e,"set");return HSe(t,r,n),n}function HSe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Gt(t,e){var n=Wj(t,e,"get");return DSe(t,n)}function Wj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function DSe(t,e){return e.get?e.get.call(t):e.value}var Po=new WeakMap,xr=new WeakMap,Bl=new WeakMap;class NSe{constructor(){c0(this,Po,{writable:!0,value:new pSe}),c0(this,xr,{writable:!0,value:new _Se(Gt(this,Po))}),c0(this,Bl,{writable:!0,value:[[]]})}setState(e){Gt(this,Po).setData(e);let n=!1;try{Gt(this,xr).buildTree()}catch{Gt(this,xr).clear(),Gt(this,Po).clear(),n=!0}return xd(this,Bl,Cp(Gt(this,xr).getRoots())),n}setColumnsLimit(e){Gt(this,Po).setColumnsLimit(e)}mergeStateWith(e){const n=Ye(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Gt(this,Po).mergeWith(n),Gt(this,xr).buildTree(),xd(this,Bl,Cp(Gt(this,xr).getRoots()))}mapState(e){Gt(this,Po).map(e),Gt(this,xr).buildTree(),xd(this,Bl,Cp(Gt(this,xr).getRoots()))}mapNodes(e){return an(Gt(this,xr).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Gt(this,xr).getNode(n,r);let o;return i&&(o=PSe(e,i,r),xd(this,Bl,Cp(Gt(this,xr).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Gt(this,Bl)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Gt(this,xr).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,s=null;for(let a=e;a<=r;a++){const l=Gt(this,xr).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:d,isHidden:f}=u.data;f||d<=i&&c>=e&&c+d-1<=r&&(s===null||h<s)&&(s=h)},Dj)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Gt(this,Po).getLayersCount()}getColumnsCount(){return Gt(this,Po).getColumnsCount()}clear(){xd(this,Bl,[]),Gt(this,Po).clear(),Gt(this,xr).clear()}}function Pd(t,e,n){return e=kSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kSe(t){var e=LSe(t,"string");return typeof e=="symbol"?e:String(e)}function LSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $Se{constructor(e,n){Pd(this,"hot",void 0),Pd(this,"nestedHeaderSettingsGetter",void 0),Pd(this,"layersCount",0),Pd(this,"container",void 0),Pd(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;s&&(m+='<button class="changeType"></button>'),Ru(d,m),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const FSe=$Se;function xn(t,e){Vj(t,e),e.add(t)}function oL(t,e,n){return e=WSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WSe(t){var e=VSe(t,"string");return typeof e=="symbol"?e:String(e)}function VSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yp(t,e,n){Vj(t,e),e.set(t,n)}function Vj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nu(t,e,n){var r=Bj(t,e,"set");return BSe(t,r,n),n}function BSe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ot(t,e){var n=Bj(t,e,"get");return USe(t,n)}function Bj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function USe(t,e){return e.get?e.get.call(t):e.value}function fn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const sL="nestedHeaders",zSe=280;var wt=new WeakMap,ha=new WeakMap,vf=new WeakMap,sy=new WeakMap,Sp=new WeakSet,aL=new WeakSet,lL=new WeakSet,uL=new WeakSet,cL=new WeakSet,hL=new WeakSet,dL=new WeakSet,fL=new WeakSet,gL=new WeakSet,mL=new WeakSet,pL=new WeakSet,wL=new WeakSet,vL=new WeakSet,CL=new WeakSet,yL=new WeakSet,SL=new WeakSet,bL=new WeakSet,RL=new WeakSet;class jSe extends ut{constructor(){super(...arguments),xn(this,RL),xn(this,bL),xn(this,SL),xn(this,yL),xn(this,CL),xn(this,vL),xn(this,wL),xn(this,pL),xn(this,mL),xn(this,gL),xn(this,fL),xn(this,dL),xn(this,hL),xn(this,cL),xn(this,uL),xn(this,lL),xn(this,aL),xn(this,Sp),yp(this,wt,{writable:!0,value:new NSe}),yp(this,ha,{writable:!0,value:null}),yp(this,vf,{writable:!0,value:null}),yp(this,sy,{writable:!0,value:!1}),oL(this,"ghostTable",new FSe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),oL(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return sL}static get PLUGIN_PRIORITY(){return zSe}isEnabled(){return!!this.hot.getSettings()[sL]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&yt(pt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>fn(this,bL,abe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,RL,lbe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,cL,XSe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,hL,qSe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,dL,QSe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,fL,ZSe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,gL,JSe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,mL,ebe).call(e,...i)}),this.addHook("afterSelection",()=>fn(this,Sp,h0).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,aL,GSe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>fn(this,wL,nbe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,CL,ibe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,yL,obe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,lL,YSe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,uL,KSe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,pL,tbe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,vL,rbe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,SL,sbe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>fn(this,Sp,h0).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>fn(this,Sp,h0).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();ot(this,wt).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=ot(this,wt).setState(e)),this.detectedOverlappedHeaders&&yt(pt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";ot(this,wt).triggerColumnModification(i,r)}),!ot(this,ha)&&this.enabled&&nu(this,ha,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";ot(this,wt).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),ot(this,wt).clear(),ot(this,ha).unsubscribe(),nu(this,ha,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return ot(this,wt)}getLayersCount(){return ot(this,wt).getLayersCount()}getHeaderSettings(e,n){return ot(this,wt).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),We(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),We(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),We(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),We(o,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:d}=(s=ot(this,wt).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(d||h)J(o,"hiddenHeader");else if(c>1){var f,m;const{wtOverlays:C}=l._wt,b=(f=C.topInlineStartCornerOverlay)===null||f===void 0?void 0:f.clone.wtTable.THEAD.contains(o),p=(m=C.inlineStartOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(o),w=b||p?Math.min(c,r-i):c;w>1&&o.setAttribute("colspan",w)}this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=ot(this,wt).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){nu(this,wt,null),ot(this,ha)!==null&&(ot(this,ha).unsubscribe(),nu(this,ha,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return ot(this,wt).getHeaderTreeNodeData(e.row,e.col)}}function h0(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=ot(this,wt).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function GSe(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=ot(this,wt).findLeftMostColumnIndex(n.row,n.col),a=ot(this,wt).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function YSe(t,e,n){const r=ot(this,wt).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=ot(this,wt).getHeaderSettings(e,t);if(o===r_){if(!a)return r.columnIndex}else if(o===CB&&(l>s-i||!a))return null;return t}function KSe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const m=c+f,C=d-a;if(C===0)continue;((i=ot(this,wt).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[m][C]="")}}}function XSe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function qSe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;nu(this,vf,e.clone()),nu(this,sy,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(EC(t)||Ja(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function QSe(t,e,n,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=Fr(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function ZSe(){nu(this,sy,!1)}function JSe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!ot(this,sy)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=ot(this,wt).getHeaderTreeNodeData(ot(this,vf).row,ot(this,vf).col);if(e.setHighlight(ot(this,vf)),o>e.getWidth()||i<n||i+o-1>r){const s=ot(this,wt).findTopMostEntireHeaderLevel(Fr(n,i,i+o-1),Fr(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function ebe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=ot(this,wt).findLeftMostColumnIndex(n.row,n.col),o=ot(this,wt).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function tbe(t,e){const n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function nbe(t){t.length=0;for(let e=0;e<ot(this,wt).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function rbe(t){const e=ot(this,wt).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=ot(this,wt).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),wr(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?ot(this,wt).getHeaderTreeNodeData(0,n).columnIndex:n}function ibe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function obe(t,e,n){var r;const{label:i}=(r=ot(this,wt).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function sbe(t,e){if(t<0)return this.hot.getCell(t,ot(this,wt).findLeftMostColumnIndex(t,e),!0)}function abe(){this.updatePlugin()}function lbe(t,e){e||this.updatePlugin()}function Od(t,e,n){return e=ube(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ube(t){var e=cbe(t,"string");return typeof e=="symbol"?e:String(e)}function cbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hbe{constructor(e,n){Od(this,"hot",void 0),Od(this,"data",null),Od(this,"plugin",void 0),Od(this,"parentReference",new WeakMap),Od(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Se(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&M(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&M(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ke(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(M(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(Se(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),Se(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];M(r,o=>{i.push(this.getDataObject(o))}),M(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const dbe=hbe;function EL(t,e,n){return e=fbe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fbe(t){var e=gbe(t,"string");return typeof e=="symbol"?e:String(e)}function gbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mbe{constructor(e,n){EL(this,"hot",void 0),EL(this,"plugin",void 0),this.hot=n,this.plugin=e}}const $x=mbe;class ys extends $x{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(M(l,c=>{c&&s.removeChild(c)}),J(n,ys.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",Se(0,i-1,()=>{const d=c.createElement("SPAN");J(d,ys.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Pe(c,[Gs()]),J(n,ys.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(J(c,`${ys.CSS_CLASSES.button} ${ys.CSS_CLASSES.expandButton}`),u&&Pe(n,[_i(!1)])):(J(c,`${ys.CSS_CLASSES.button} ${ys.CSS_CLASSES.collapseButton}`),u&&Pe(n,[_i(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const Uj=ys;class pbe extends $x{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),M(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{Se(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&M(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];M(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return M(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);M(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return M(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);M(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&M(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];M(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];M(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];M(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{M(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{M(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&M(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);He(e.target,Uj.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Di(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const wbe=pbe;function vbe(t,e,n){Cbe(t,e),e.set(t,n)}function Cbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ybe(t,e,n){return e=Sbe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sbe(t){var e=bbe(t,"string");return typeof e=="symbol"?e:String(e)}function bbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rbe(t,e){var n=Ebe(t,e,"get");return Tbe(t,n)}function Ebe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Tbe(t,e){return e.get?e.get.call(t):e.value}var TL=new WeakMap;class _be extends $x{constructor(){super(...arguments),ybe(this,"dataManager",this.plugin.dataManager),vbe(this,TL,{writable:!0,value:{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(iM)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(oM)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Se(0,e.items.length-1,r=>{if(r===0)return M(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Se(0,e.items.length-1,n=>{const r=Rbe(this,TL)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}const Mbe=_be;function bp(t,e,n){return e=xbe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xbe(t){var e=Pbe(t,"string");return typeof e=="symbol"?e:String(e)}function Pbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Obe{constructor(e){bp(this,"plugin",void 0),bp(this,"hot",void 0),bp(this,"dataManager",void 0),bp(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(m=>{if(!l)return!1;const C=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(C,a),C}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return _t(i)&&(yt(pt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function Yn(t,e){zj(t,e),e.add(t)}function _L(t,e,n){zj(t,e),e.set(t,n)}function zj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d0(t,e,n){return e=Abe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Abe(t){var e=Ibe(t,"string");return typeof e=="symbol"?e:String(e)}function Ibe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sw(t,e){var n=jj(t,e,"get");return Hbe(t,n)}function Hbe(t,e){return e.get?e.get.call(t):e.value}function Pv(t,e,n){var r=jj(t,e,"set");return Dbe(t,r,n),n}function jj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Dbe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function kn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Ov="nestedRows",Nbe=300,ML=Ov,kbe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var ay=new WeakMap,Cc=new WeakMap,xL=new WeakSet,PL=new WeakSet,OL=new WeakSet,AL=new WeakSet,IL=new WeakSet,HL=new WeakSet,DL=new WeakSet,NL=new WeakSet,kL=new WeakSet,LL=new WeakSet,$L=new WeakSet,FL=new WeakSet,WL=new WeakSet,VL=new WeakSet,BL=new WeakSet,f0=new WeakSet;class Lbe extends ut{constructor(){super(...arguments),Yn(this,f0),Yn(this,BL),Yn(this,VL),Yn(this,WL),Yn(this,FL),Yn(this,$L),Yn(this,LL),Yn(this,kL),Yn(this,NL),Yn(this,DL),Yn(this,HL),Yn(this,IL),Yn(this,AL),Yn(this,OL),Yn(this,PL),Yn(this,xL),d0(this,"dataManager",null),d0(this,"headersUI",null),d0(this,"collapsedRowsMap",null),_L(this,ay,{writable:!0,value:!1}),_L(this,Cc,{writable:!0,value:!1})}static get PLUGIN_KEY(){return Ov}static get PLUGIN_PRIORITY(){return Nbe}isEnabled(){return!!this.hot.getSettings()[Ov]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Eg),this.dataManager=new dbe(this,this.hot),this.collapsingUI=new wbe(this,this.hot),this.headersUI=new Uj(this,this.hot),this.contextMenuUI=new Mbe(this,this.hot),this.rowMoveController=new Obe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,VL,Qbe).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,BL,Zbe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,OL,Wbe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,AL,Vbe).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,IL,Bbe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,PL,Fbe).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,NL,jbe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,DL,zbe).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,kL,Gbe).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,LL,Ybe).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,$L,Kbe).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,FL,Xbe).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,HL,Ube).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,WL,qbe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return kn(e,xL,$be).call(e,...r)}),this.addHook("beforeLoadData",n=>kn(this,f0,UL).call(this,n)),this.addHook("beforeUpdateData",n=>kn(this,f0,UL).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:ML})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ML)}disableCoreAPIModifiers(){Pv(this,Cc,!0)}enableCoreAPIModifiers(){Pv(this,Cc,!1)}onModifyRowData(e){if(!sw(this,Cc))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!sw(this,Cc))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return sw(this,Cc)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function $be(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Fbe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Wbe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),Pv(this,ay,!0),this.dataManager.getData().slice()}function Vbe(t){return this.contextMenuUI.appendOptions(t)}function Bbe(t,e){this.headersUI.appendLevelIndicators(t,e)}function Ube(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function zbe(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{Pv(this,ay,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function jbe(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Gbe(){this.collapsingUI.collapsedRowsStash.stash()}function Ybe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Kbe(){this.collapsingUI.collapsedRowsStash.stash()}function Xbe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function qbe(){this.dataManager.rewriteCache()}function Qbe(){this.headersUI.updateRowHeaderWidth()}function Zbe(t,e){sw(this,ay)&&(e.skipRender=!0)}function UL(t){if(!IB(t)){B1(kbe),this.hot.getSettings()[Ov]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function g0(t,e,n){return e=Jbe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jbe(t){var e=e0e(t,"string");return typeof e=="symbol"?e:String(e)}function e0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class t0e{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;g0(this,"rootWindow",void 0),g0(this,"prefix",void 0),g0(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){M(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const n0e=t0e;function r0e(t,e,n){return e=i0e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i0e(t){var e=o0e(t,"string");return typeof e=="symbol"?e:String(e)}function o0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}we.getSingleton().register("persistentStateSave");we.getSingleton().register("persistentStateLoad");we.getSingleton().register("persistentStateReset");const zL="persistentState",s0e=0;class a0e extends ut{constructor(){super(...arguments),r0e(this,"storage",void 0)}static get PLUGIN_KEY(){return zL}static get PLUGIN_PRIORITY(){return s0e}isEnabled(){return!!this.hot.getSettings()[zL]}enablePlugin(){this.enabled||(this.storage||(this.storage=new n0e(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function l0e(t,e){u0e(t,e),e.add(t)}function u0e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function m0(t,e,n){return e=c0e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c0e(t){var e=h0e(t,"string");return typeof e=="symbol"?e:String(e)}function h0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jL(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const p0="search",d0e=190,f0e="htSearchResult",g0e=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},m0e=function(t,e,n){return _t(t)||t===null||!t.toLocaleLowerCase||t.length===0||_t(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var w0=new WeakSet;class p0e extends ut{constructor(){super(...arguments),l0e(this,w0),m0(this,"callback",g0e),m0(this,"queryMethod",m0e),m0(this,"searchResultClass",f0e)}static get PLUGIN_KEY(){return p0}static get PLUGIN_PRIORITY(){return d0e}isEnabled(){return this.hot.getSettings()[p0]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[p0];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jL(e,w0,GL).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jL(e,w0,GL).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return Se(0,i-1,l=>{Se(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,m=(h.search.queryMethod||r)(e,c,h);if(m){const C={row:l,col:u,data:c};s.push(C)}d&&d(a,l,u,c,m)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){je(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function GL(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function v0(t,e){w0e(t,e),e.add(t)}function w0e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rp(t,e,n){return e=v0e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v0e(t){var e=C0e(t,"string");return typeof e=="symbol"?e:String(e)}function C0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function C0(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const y0e="touchScroll",S0e=200;var YL=new WeakSet,KL=new WeakSet,XL=new WeakSet;class b0e extends ut{constructor(){super(...arguments),v0(this,XL),v0(this,KL),v0(this,YL),Rp(this,"scrollbars",[]),Rp(this,"clones",[]),Rp(this,"lockedCollection",!1),Rp(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return y0e}static get PLUGIN_PRIORITY(){return S0e}static get SETTING_KEYS(){return!0}isEnabled(){return k1()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>C0(this,YL,R0e).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>C0(this,KL,E0e).call(this)),this.addHook("afterMomentumScroll",()=>C0(this,XL,T0e).call(this))}}function R0e(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function E0e(){this.freezeOverlays=!0,M(this.clones,t=>{J(t,"hide-tween")})}function T0e(){this.freezeOverlays=!1,M(this.clones,t=>{We(t,"hide-tween"),J(t,"show-tween")}),this.hot._registerTimeout(()=>{M(this.clones,t=>{We(t,"show-tween")})},400),M(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function _0e(t,e){M0e(t,e),e.add(t)}function M0e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function x0e(t,e,n){return e=P0e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P0e(t){var e=O0e(t,"string");return typeof e=="symbol"?e:String(e)}function O0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function A0e(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const aw="trimRows",I0e=330;var qL=new WeakSet;class H0e extends ut{constructor(){super(...arguments),_0e(this,qL),x0e(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return aw}static get PLUGIN_PRIORITY(){return I0e}isEnabled(){return!!this.hot.getSettings()[aw]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Eg),this.trimmedRowsMap.addLocalHook("init",()=>A0e(this,qL,D0e).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[aw];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),M(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{M(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(M(e,l=>{o[l]=!1}),i=an(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function D0e(){const t=this.hot.getSettings()[aw];Array.isArray(t)&&this.hot.batchExecution(()=>{M(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var Gj={},N0e=vh,k0e=Gj,L0e=N0e("iterator"),$0e=Array.prototype,F0e=function(t){return t!==void 0&&(k0e.Array===t||$0e[L0e]===t)},W0e=KW,QL=VT,V0e=kT,B0e=Gj,U0e=vh,z0e=U0e("iterator"),Yj=function(t){if(!V0e(t))return QL(t,z0e)||QL(t,"@@iterator")||B0e[W0e(t)]},j0e=Cu,G0e=Jv,Y0e=ll,K0e=Zv,X0e=Yj,q0e=TypeError,Q0e=function(t,e){var n=arguments.length<2?X0e(t):e;if(G0e(n))return Y0e(j0e(n,t));throw new q0e(K0e(t)+" is not iterable")},Z0e=Cu,ZL=ll,J0e=VT,eRe=function(t,e,n){var r,i;ZL(t);try{if(r=J0e(t,"return"),!r){if(e==="throw")throw n;return n}r=Z0e(r,t)}catch(o){i=!0,r=o}if(e==="throw")throw n;if(i)throw r;return ZL(r),n},tRe=eV,nRe=Cu,rRe=ll,iRe=Zv,oRe=F0e,sRe=cg,JL=LT,aRe=Q0e,lRe=Yj,e$=eRe,uRe=TypeError,lw=function(t,e){this.stopped=t,this.result=e},t$=lw.prototype,cRe=function(t,e,n){var r=n&&n.that,i=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=tRe(e,r),u,c,h,d,f,m,C,b=function(w){return u&&e$(u,"normal",w),new lw(!0,w)},p=function(w){return i?(rRe(w),a?l(w[0],w[1],b):l(w[0],w[1])):a?l(w,b):l(w)};if(o)u=t.iterator;else if(s)u=t;else{if(c=lRe(t),!c)throw new uRe(iRe(t)+" is not iterable");if(oRe(c)){for(h=0,d=sRe(t);d>h;h++)if(f=p(t[h]),f&&JL(t$,f))return f;return new lw(!1)}u=aRe(t,c)}for(m=o?t.next:u.next;!(C=nRe(m,u)).done;){try{f=p(C.value)}catch(w){e$(u,"throw",w)}if(typeof f=="object"&&f&&JL(t$,f))return f}return new lw(!1)},hRe=zT,dRe=al,fRe=qv,gRe=function(t,e,n){var r=hRe(e);r in t?dRe.f(t,r,fRe(0,n)):t[r]=n},mRe=ul,pRe=cRe,wRe=gRe;mRe({target:"Object",stat:!0},{fromEntries:function(e){var n={};return pRe(e,function(r,i){wRe(n,r,i)},{AS_ENTRIES:!0}),n}});const Kj="undoRedo",vRe="undoRedo";function ge(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);M(l,c=>{c[1]=t.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new ge.ChangeAction(l,u)};e.done(a,i)}),t.addHook("afterCreateRow",(r,i,o)=>{e.done(()=>new ge.CreateRowAction(r,i),o)});const n=(r,i,o,s)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,u=[];return Se(o,s,c=>{Se(r,i,h=>{const d=t.getCellMeta(h,c);if(Object.keys(d).length!==l){const f=Object.fromEntries(Object.entries(d).filter(m=>{let[C]=m;return a.includes(C)===!1}));u.push([d.visualRow,d.visualCol,f])}})}),u};t.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=t.toPhysicalRow(r),u=l+i-1,c=tr(e.instance.getSourceData(l,0,l+i-1,e.instance.countSourceCols()-1));return new ge.RemoveRowAction(l,c,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),n(l,u,0,t.countCols()-1))};e.done(a,s)}),t.addHook("afterCreateCol",(r,i,o)=>{e.done(()=>new ge.CreateColumnAction(r,i),o)}),t.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+r)%e.instance.countCols(),c=u+i-1,h=[],d=[],f=[];Se(l.length-1,b=>{const p=[],w=l[b];Se(u,c,y=>{p.push(w[t.toPhysicalColumn(y)])}),h.push(p)}),Se(i-1,b=>{f.push(t.toPhysicalColumn(u+b))}),Array.isArray(t.getSettings().colHeaders)&&Se(i-1,b=>{d.push(t.getSettings().colHeaders[t.toPhysicalColumn(u+b)]||null)});const m=t.columnIndexMapper.getIndexesSequence(),C=t.rowIndexMapper.getIndexesSequence();return new ge.RemoveColumnAction(u,f,h,d,m,C,t.getSettings().fixedColumnsStart,n(0,t.countRows(),u,c))};e.done(a,s)}),t.addHook("beforeCellAlignment",(r,i,o,s)=>{e.done(()=>new ge.CellAlignmentAction(r,i,o,s))}),t.addHook("beforeFilter",r=>{e.done(()=>new ge.FiltersAction(r))}),t.addHook("beforeRowMove",(r,i)=>{r!==!1&&e.done(()=>new ge.RowMoveAction(r,i))}),t.addHook("beforeMergeCells",(r,i)=>{i||e.done(()=>new ge.MergeCellsAction(t,r))}),t.addHook("afterUnmergeCells",(r,i)=>{i||e.done(()=>new ge.UnmergeCellsAction(t,r))}),t.addHook("afterInit",()=>{e.init()})}ge.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};ge.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=tr(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};ge.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=tr(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};ge.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ge.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ge.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ge.prototype.isEnabled=function(){return this.enabled};ge.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,SRe(t),this.registerShortcuts(),t.addHook("afterChange",Xj)};ge.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,bRe(t),this.unregisterShortcuts(),t.removeHook("afterChange",Xj)};ge.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ge.Action=function(){};ge.Action.prototype.undo=function(){};ge.Action.prototype.redo=function(){};ge.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Ys(ge.ChangeAction,ge.Action);ge.ChangeAction.prototype.undo=function(t,e){const n=tr(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let s=0,a=n.length;s<a;s++)n[s].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let s=0,a=n.length;s<a;s++){const[l,u]=n[s];t.getSettings().minSpareRows&&l+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(l+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&u+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(u+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const o=t.getSelectedLast();if(o!==void 0){const[s,a]=n[0],[l,u]=o,c=t.view.getFirstFullyVisibleRow(),h=t.view.getFirstFullyVisibleColumn(),d=s>=c,f=a>=h;if((d&&f)===!1&&(l!==s||u!==a)===!0){const b={row:s,col:a};d===!1&&(b.verticalSnap="top"),f===!1&&(b.horizontalSnap="start"),t.scrollViewportTo(b)}}t.selectCells(this.selected,!1,!1)};ge.ChangeAction.prototype.redo=function(t,e){const n=tr(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};ge.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Ys(ge.CreateRowAction,ge.Action);ge.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ge.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ge.RemoveRowAction=function(t,e,n,r,i,o){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i,this.removedCellMetas=o};Ys(ge.RemoveRowAction,ge.Action);ge.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(i=>{let[o,s,a]=i;t.setCellMetaObject(o,s,a)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ge.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ge.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Ys(ge.CreateColumnAction,ge.Action);ge.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ge.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ge.RemoveColumnAction=function(t,e,n,r,i,o,s,a){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=a};Ys(ge.RemoveColumnAction,ge.Action);ge.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,h)=>h[this.indexes.indexOf(r[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(Ye(this.data[u],i));const a=Ye(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),M(t.getSourceDataArray(),(u,c)=>{M(r,(h,d)=>{u[h]=s[c][d],l.push([c,h,u[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&M(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),this.removedCellMetas.forEach(u=>{let[c,h,d]=u;t.setCellMetaObject(c,h,d)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};ge.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ge.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};ge.CellAlignmentAction.prototype.undo=function(t,e){M(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};ge.CellAlignmentAction.prototype.redo=function(t,e){ga(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()};ge.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};Ys(ge.FiltersAction,ge.Action);ge.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};ge.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class CRe extends ge.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}ge.MergeCellsAction=CRe;class yRe extends ge.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}ge.UnmergeCellsAction=yRe;ge.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};Ys(ge.RowMoveAction,ge.Action);ge.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ge.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ge.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ge.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:Kj};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};ge.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(Kj)};function Xj(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function SRe(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function bRe(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const Ig=we.getSingleton();Ig.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});Ig.register("beforeUndo");Ig.register("afterUndo");Ig.register("beforeRedo");Ig.register("afterRedo");ge.PLUGIN_KEY=vRe;ge.SETTING_KEYS=!0;function RRe(){st(of),st(Cce),st(sf),st(qce),st(ohe),st(iz),st(qhe),st(Nde),st(ny),st(oge),st(Oge),st($ge),st(iy),st(hme),st(Cwe),st(eve),st(Mve),st(Fve),st(Zve),st(fCe),st(ECe),st(GCe),st(nye),st(Aye),st(sSe),st(hSe),st(jSe),st(Lbe),st(a0e),st(p0e),st(b0e),st(H0e),st(ge)}function ERe(){Ule(),aue(),pue(),kue(),RRe()}function TRe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var y0,S0,b0,R0,E0;ERe();TRe(le);le.__GhostTable=yx;le._getListenersCounter=eJ;le._getRegisteredMapsCounter=xre;le.EventManager=Oi;const _Re=[MQ,NZ,gre,uue,IZ,mZ,AQ,pJ,AZ,HQ,$Z,mJ],MRe=[hZ,FZ];le.helper={};le.dom={};M(_Re,t=>{M(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(le.helper[e]=t[e])})});M(MRe,t=>{M(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(le.dom[e]=t[e])})});le.cellTypes=(y0=le.cellTypes)!==null&&y0!==void 0?y0:{};M(Kie(),t=>{le.cellTypes[t]=zM(t)});le.cellTypes.registerCellType=gi;le.cellTypes.getCellType=zM;le.editors=(S0=le.editors)!==null&&S0!==void 0?S0:{};M(YZ(),t=>{le.editors[`${er(t)}Editor`]=Yw(t)});le.editors.registerEditor=Hr;le.editors.getEditor=Yw;le.renderers=(b0=le.renderers)!==null&&b0!==void 0?b0:{};M(AJ(),t=>{const e=qw(t);t==="base"&&(le.renderers.cellDecorator=e),le.renderers[`${er(t)}Renderer`]=e});le.renderers.registerRenderer=Yr;le.renderers.getRenderer=qw;le.validators=(R0=le.validators)!==null&&R0!==void 0?R0:{};M(DJ(),t=>{le.validators[`${er(t)}Validator`]=Y1(t)});le.validators.registerValidator=Gl;le.validators.getValidator=Y1;le.plugins=(E0=le.plugins)!==null&&E0!==void 0?E0:{};M(G1(),t=>{le.plugins[t]=yg(t)});le.plugins[`${er(ut.PLUGIN_KEY)}Plugin`]=ut;le.plugins.registerPlugin=st;le.plugins.getPlugin=yg;const n$=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]);function xRe(t,e){if(t<0)return;const n=this.isRtl()?"htRight":"htLeft";e.firstChild&&(n$.has(t.toString())?(le.dom.removeClass(e.firstChild,n),le.dom.addClass(e.firstChild,n$.get(t.toString()))):le.dom.addClass(e.firstChild,n))}const PRe={data:PU,height:464,colWidths:[140,165,100,100,100,110,178],colHeaders:["Company name","Product name","Sell date","In stock","Qty","Order ID","Country"],dropdownMenu:!0,hiddenColumns:{indicators:!0},multiColumnSorting:!0,filters:!0,rowHeaders:!0,manualRowMove:!0,afterGetColHeader:xRe,licenseKey:"non-commercial-and-evaluation"};function ORe(){const[t,e]=Hv.useState({tabNavigation:!0,navigableHeaders:!0,renderAllRows:!1,enterBeginsEditing:!0,autoWrapRow:!0,autoWrapCol:!0,enterMoves:{col:0,row:1}});return pe.jsxs(pe.Fragment,{children:[pe.jsx(mle,{changeToggleOptions:e,...t}),pe.jsx("input",{className:"placeholder-input",type:"text",placeholder:"Focusable text input"}),pe.jsxs(RU,{...PRe,...t,children:[pe.jsx(fa,{data:"companyName",type:"text"}),pe.jsx(fa,{data:"productName",type:"text"}),pe.jsx(fa,{data:"sellDate",dateFormat:"DD/MM/YYYY",correctFormat:!0,type:"date",allowInvalid:!1}),pe.jsx(fa,{data:"inStock",type:"checkbox",className:"htCenter"}),pe.jsx(fa,{data:"qty",type:"numeric"}),pe.jsx(fa,{data:"orderId",type:"text"}),pe.jsx(fa,{data:"country",type:"dropdown",source:gle})]},String(t.renderAllRows)),pe.jsx("input",{className:"placeholder-input",type:"text",placeholder:"Focusable text input"})]})}T0.createRoot(document.getElementById("root")).render(pe.jsx(Wt.StrictMode,{children:pe.jsx(ORe,{})}))});export default ARe();
